description: Validates that AZURE compute ebs has public snapshot, azure sql instance
  no public access, azure aks endpoints not publicly accessible, azure virtual network
  endpoint for ec2 enabled, azure storage account level public access blocks, azure
  awslambda function not publicly accessible, azure hdinsight cluster master nodes
  no public ip, azure compute instance public ip, azure sql snapshots public access,
  azure search service domains not publicly accessible, azure synapse cluster public
  access, azure awslambda function inside vpc, azure database migration instance no
  public access, azure machine learning notebook instance without direct internet
  access configured, azure storage bucket policy public write access, azure compute
  securitygroup allow ingress from internet to tcp port 22, azure storage bucket public
  write acl, azure compute securitygroup allow ingress from internet to all ports,
  azure compute networkacl allow ingress tcp port 22, azure compute networkacl allow
  ingress tcp port 3389, azure compute securitygroup default restrict traffic configured
  according to security best practices. Proper configuration reduces security risks,
  prevents unauthorized access, and ensures compliance with industry standards and
  regulations.
domain: storage_and_database_security
rationale: Ensures AZURE compute ebs has public snapshot, azure sql instance no public
  access, azure aks endpoints not publicly accessible, azure virtual network endpoint
  for ec2 enabled, azure storage account level public access blocks, azure awslambda
  function not publicly accessible, azure hdinsight cluster master nodes no public
  ip, azure compute instance public ip, azure sql snapshots public access, azure search
  service domains not publicly accessible, azure synapse cluster public access, azure
  awslambda function inside vpc, azure database migration instance no public access,
  azure machine learning notebook instance without direct internet access configured,
  azure storage bucket policy public write access, azure compute securitygroup allow
  ingress from internet to tcp port 22, azure storage bucket public write acl, azure
  compute securitygroup allow ingress from internet to all ports, azure compute networkacl
  allow ingress tcp port 22, azure compute networkacl allow ingress tcp port 3389,
  azure compute securitygroup default restrict traffic properly configured for security
  compliance. This control is essential for maintaining a strong security posture
  and meeting regulatory requirements.
references:
- https://docs.microsoft.com/azure/compute
- https://docs.microsoft.com/azure/security-center
requirement: Public Snapshot, Azure Sql Instance No Public Access, Azure Aks Endpoints
  Not Publicly Accessible, Azure Virtual Network Endpoint For Ec2 Enabled, Azure Storage
  Account Level Public Access Blocks, Azure Awslambda Function Not Publicly Accessible,
  Azure Hdinsight Cluster Master Nodes No Public Ip, Azure Compute Instance Public
  Ip, Azure Sql Snapshots Public Access, Azure Search Service Domains Not Publicly
  Accessible, Azure Synapse Cluster Public Access, Azure Awslambda Function Inside
  Vpc, Azure Database Migration Instance No Public Access, Azure Machine Learning
  Notebook Instance Without Direct Internet Access Configured, Azure Storage Bucket
  Policy Public Write Access, Azure Compute Securitygroup Allow Ingress From Internet
  To Tcp Port 22, Azure Storage Bucket Public Write Acl, Azure Compute Securitygroup
  Allow Ingress From Internet To All Ports, Azure Compute Networkacl Allow Ingress
  Tcp Port 22, Azure Compute Networkacl Allow Ingress Tcp Port 3389, Azure Compute
  Securitygroup Default Restrict Traffic
resource: ebs
rule_id: azure.compute.ebs.public.snapshot,.azure.sql.instance.no.public.access,.azure.aks.endpoints.not.publicly.accessible,.azure.virtual.network.endpoint.for.ec2.enabled,.azure.storage.account.level.public.access.blocks,.azure.awslambda.function.not.publicly.accessible,.azure.hdinsight.cluster.master.nodes.no.public.ip,.azure.compute.instance.public.ip,.azure.sql.snapshots.public.access,.azure.search.service.domains.not.publicly.accessible,.azure.synapse.cluster.public.access,.azure.awslambda.function.inside.vpc,.azure.database.migration.instance.no.public.access,.azure.machine.learning.notebook.instance.without.direct.internet.access.configured,.azure.storage.bucket.policy.public.write.access,.azure.compute.securitygroup.allow.ingress.from.internet.to.tcp.port.22,.azure.storage.bucket.public.write.acl,.azure.compute.securitygroup.allow.ingress.from.internet.to.all.ports,.azure.compute.networkacl.allow.ingress.tcp.port.22,.azure.compute.networkacl.allow.ingress.tcp.port.3389,.azure.compute.securitygroup.default.restrict.traffic
scope: compute.ebs.backup_recovery
service: compute
severity: critical
subcategory: storage_encryption
title: 'AZURE COMPUTE Ebs: Public Snapshot, Azure Sql Instance No Public Access, Azure
  Aks Endpoints Not Publicly Accessible, Azure Virtual Network Endpoint For Ec2 Enabled,
  Azure Storage Account Level Public Access Blocks, Azure Awslambda Function Not Publicly
  Accessible, Azure Hdinsight Cluster Master Nodes No Public Ip, Azure Compute Instance
  Public Ip, Azure Sql Snapshots Public Access, Azure Search Service Domains Not Publicly
  Accessible, Azure Synapse Cluster Public Access, Azure Awslambda Function Inside
  Vpc, Azure Database Migration Instance No Public Access, Azure Machine Learning
  Notebook Instance Without Direct Internet Access Configured, Azure Storage Bucket
  Policy Public Write Access, Azure Compute Securitygroup Allow Ingress From Internet
  To Tcp Port 22, Azure Storage Bucket Public Write Acl, Azure Compute Securitygroup
  Allow Ingress From Internet To All Ports, Azure Compute Networkacl Allow Ingress
  Tcp Port 22, Azure Compute Networkacl Allow Ingress Tcp Port 3389, Azure Compute
  Securitygroup Default Restrict Traffic'
