# Azure Service Grouping by Python Package
# This file maps your service folders to Azure SDK packages for efficient client management

service_groups:
  # Group 1: Microsoft Graph Services (Identity & AAD)
  msgraph_services:
    package: msgraph-sdk
    client: GraphServiceClient
    services:
      - aad
      - ad
      - entra
      - entrad
      - graph
      - user
      - password
      - intune
    description: "All Azure AD/Entra ID and user management services"
    auth_scope: "https://graph.microsoft.com/.default"

  # Group 2: Core Management (Resource Manager)
  resource_management:
    package: azure-mgmt-resource
    client: Multiple (ResourceManagementClient, PolicyClient, etc.)
    services:
      - resource
      - subscription
      - managementgroup
      - policy
      - management
    description: "Core Azure Resource Manager services"
    
  # Group 3: Identity & Access Management
  authorization:
    package: azure-mgmt-authorization
    client: AuthorizationManagementClient
    services:
      - rbac
      - iam  # partial - combines RBAC + AAD
    description: "Role-based access control"

  # Group 4: Compute Services
  compute:
    package: azure-mgmt-compute
    client: ComputeManagementClient
    services:
      - compute
      - vm
      - virtualmachines
      - disk
    description: "Virtual machines and compute resources"

  # Group 5: Container Services
  containers:
    packages:
      - azure-mgmt-containerservice
      - azure-mgmt-containerinstance
      - azure-mgmt-containerregistry
    clients:
      - ContainerServiceClient
      - ContainerInstanceManagementClient
      - ContainerRegistryManagementClient
    services:
      - aks
      - kubernetes
      - container
      - containerregistry
    description: "Kubernetes, AKS, and container services"

  # Group 6: Storage Management
  storage_management:
    package: azure-mgmt-storage
    client: StorageManagementClient
    services:
      - storage
    description: "Storage account management (control plane)"

  # Group 7: Storage Data Plane
  storage_dataplane:
    packages:
      - azure-storage-blob
      - azure-storage-file-share
    clients:
      - BlobServiceClient
      - ShareServiceClient
    services:
      - blob
      - files
    description: "Direct storage access (data plane)"
    note: "Requires connection string or account URL"

  # Group 8: Networking
  networking:
    package: azure-mgmt-network
    client: NetworkManagementClient
    services:
      - network
      - networksecuritygroup
      - vpn
      - loadbalancer
      - load
    description: "Core networking services"

  # Group 9: Network Edge Services
  network_edge:
    packages:
      - azure-mgmt-dns
      - azure-mgmt-cdn
      - azure-mgmt-frontdoor
      - azure-mgmt-trafficmanager
    clients:
      - DnsManagementClient
      - CdnManagementClient
      - FrontDoorManagementClient
      - TrafficManagerManagementClient
    services:
      - dns
      - cdn
      - front
      - traffic
    description: "DNS, CDN, and traffic management"

  # Group 10: SQL Databases
  sql:
    package: azure-mgmt-sql
    client: SqlManagementClient
    services:
      - sql
      - sqlserver
      - server  # partial
    description: "Azure SQL Database and SQL Server"

  # Group 11: Open Source Databases
  rdbms:
    package: azure-mgmt-rdbms
    clients:
      - MySQLManagementClient
      - PostgreSQLManagementClient
      - MariaDBManagementClient
    services:
      - mysql
      - postgresql
      - mariadb
    description: "MySQL, PostgreSQL, MariaDB"

  # Group 12: NoSQL Databases
  nosql:
    packages:
      - azure-mgmt-cosmosdb
      - azure-mgmt-redis
    clients:
      - CosmosDBManagementClient
      - RedisManagementClient
    services:
      - cosmosdb
      - cosmos
      - redis
      - cache
    description: "Cosmos DB and Redis Cache"

  # Group 13: Security Services
  security:
    package: azure-mgmt-security
    client: SecurityCenter
    services:
      - security
      - securitycenter
      - defender
    description: "Microsoft Defender and Security Center"

  # Group 14: Monitoring & Logging
  monitoring:
    packages:
      - azure-mgmt-monitor
      - azure-mgmt-loganalytics
    clients:
      - MonitorManagementClient
      - LogAnalyticsManagementClient
    services:
      - monitor
      - log
      - audit
    description: "Azure Monitor and Log Analytics"

  # Group 15: Key Vault Management
  keyvault_management:
    package: azure-mgmt-keyvault
    client: KeyVaultManagementClient
    services:
      - keyvault
    description: "Key Vault management (control plane)"

  # Group 16: Key Vault Data Plane
  keyvault_dataplane:
    packages:
      - azure-keyvault-keys
      - azure-keyvault-secrets
      - azure-keyvault-certificates
    clients:
      - KeyClient
      - SecretClient
      - CertificateClient
    services:
      - key
      - certificates
    description: "Key Vault secrets, keys, and certificates access"
    note: "Requires vault URL at runtime"

  # Group 17: App Services
  web_services:
    package: azure-mgmt-web
    client: WebSiteManagementClient
    services:
      - app
      - appservice
      - webapp
      - function
      - functionapp
      - functions
      - site
      - application  # partial
    description: "Web Apps and Azure Functions"

  # Group 18: API & Integration
  api_integration:
    packages:
      - azure-mgmt-apimanagement
      - azure-mgmt-logic
      - azure-mgmt-eventgrid
      - azure-mgmt-eventhub
    clients:
      - ApiManagementClient
      - LogicManagementClient
      - EventGridManagementClient
      - EventHubManagementClient
    services:
      - api
      - logic
      - event
    description: "API Management, Logic Apps, Event services"

  # Group 19: Data & Analytics
  analytics:
    packages:
      - azure-mgmt-datafactory
      - azure-mgmt-databricks
      - azure-mgmt-synapse
      - azure-mgmt-hdinsight
      - azure-mgmt-search
      - azure-mgmt-purview
    clients:
      - DataFactoryManagementClient
      - AzureDatabricksManagementClient
      - SynapseManagementClient
      - HDInsightManagementClient
      - SearchManagementClient
      - PurviewManagementClient
    services:
      - data
      - databricks
      - synapse
      - hdinsight
      - search
      - aisearch
      - purview
    description: "Big data and analytics services"

  # Group 20: Machine Learning
  ml:
    package: azure-mgmt-machinelearningservices
    client: MachineLearningServicesManagementClient
    services:
      - machine
    description: "Azure Machine Learning"

  # Group 21: Backup & Recovery
  backup_recovery:
    packages:
      - azure-mgmt-recoveryservices
      - azure-mgmt-dataprotection
    clients:
      - RecoveryServicesClient
      - DataProtectionClient
    services:
      - backup
      - recoveryservices
      - dataprotection
    description: "Backup and disaster recovery"

  # Group 22: Automation & Management
  automation:
    packages:
      - azure-mgmt-automation
      - azure-mgmt-batch
    clients:
      - AutomationClient
      - BatchManagementClient
    services:
      - automation
      - patch
      - batch
    description: "Automation and batch processing"

  # Group 23: Billing & Cost
  billing:
    packages:
      - azure-mgmt-billing
      - azure-mgmt-costmanagement
    clients:
      - BillingManagementClient
      - CostManagementClient
    services:
      - billing
      - cost
    description: "Billing and cost management"

  # Group 24: Other Services
  misc_services:
    packages:
      - azure-mgmt-iothub
      - azure-mgmt-notificationhubs
      - azure-mgmt-netapp
      - azure-mgmt-elastic
      - azure-mgmt-powerbiembedded
    clients:
      - IotHubClient
      - NotificationHubsManagementClient
      - NetAppManagementClient
      - ElasticManagementClient
      - PowerBIEmbeddedManagementClient
    services:
      - iot
      - notification
      - netappfiles
      - elastic
      - power
    description: "IoT, notifications, and specialized services"

# Services that need cleanup/removal
invalid_services:
  aws_services:
    - eks  # AWS EKS, not Azure
    - lambda  # AWS Lambda, not Azure
    - s3  # AWS S3, not Azure
    action: "Remove these folders"

  unclear_services:
    - active  # Needs clarification
    - enabled  # Not a service
    - encryption  # Cross-cutting concern
    - rotate  # Action, not service
    - managed  # Too generic
    - azure  # Too generic - 205 rules need redistribution
    - region  # Use subscription client
    - devops  # Needs azure-devops package
    action: "Review and redistribute rules to proper services"

# Consolidation needed
duplicate_services:
  compute_group:
    keep: compute
    merge_from: [vm, virtualmachines, disk]
  
  function_group:
    keep: function
    merge_from: [functionapp, functions]
  
  webapp_group:
    keep: webapp
    merge_from: [app, appservice, application, site]
  
  security_group:
    keep: security
    merge_from: [securitycenter, defender]
  
  identity_group:
    keep: aad
    merge_from: [ad, entra, entrad]
  
  cosmos_group:
    keep: cosmosdb
    merge_from: [cosmos]
  
  cache_group:
    keep: redis
    merge_from: [cache]
  
  sql_group:
    keep: sql
    merge_from: [sqlserver]
  
  loadbalancer_group:
    keep: loadbalancer
    merge_from: [load]

# Estimated rules distribution
estimated_rules_by_package:
  msgraph_services: 50  # aad + ad + entra + user + password
  compute: 92  # compute + vm + disk
  containers: 29  # aks + kubernetes + container
  storage: 108  # storage + blob + files
  networking: 87  # network + nsg + vpn + loadbalancer + dns + cdn + front + traffic
  databases: 101  # sql + mysql + postgresql + mariadb + cosmosdb + redis
  security: 70  # security + defender
  monitoring: 78  # monitor + log + audit
  keyvault: 29  # keyvault + key + certificates
  web_services: 97  # app + webapp + function + site
  api_integration: 27  # api + logic + event
  analytics: 340  # data + databricks + synapse + hdinsight + search + purview + machine
  backup: 47  # backup + recoveryservices + dataprotection
  core_management: 60  # resource + subscription + managementgroup + policy + rbac
  other: 154  # automation + batch + billing + cost + iot + notification + etc
  needs_cleanup: 462  # azure folder + invalid services

total_rules: 1831

