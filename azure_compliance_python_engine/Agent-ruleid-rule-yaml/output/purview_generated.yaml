version: '1.0'
provider: azure
service: purview
discovery:
- discovery_id: azure.purview.list_by_resource_group
  calls:
  - action: list_by_resource_group
    save_as: list_by_resource_group_response
  emit:
    items_for: '{{ list_by_resource_group_response.value }}'
    as: item
    item:
      id: '{{ item.id }}'
      name: '{{ item.name }}'
      type: '{{ item.type }}'
      location: '{{ item.location }}'
      tags: '{{ item.tags }}'
      group_short_name: '{{ item.group_short_name }}'
      enabled: '{{ item.enabled }}'
      email_receivers: '{{ item.email_receivers }}'
      sms_receivers: '{{ item.sms_receivers }}'
      webhook_receivers: '{{ item.webhook_receivers }}'
      itsm_receivers: '{{ item.itsm_receivers }}'
      azure_app_push_receivers: '{{ item.azure_app_push_receivers }}'
      automation_runbook_receivers: '{{ item.automation_runbook_receivers }}'
      voice_receivers: '{{ item.voice_receivers }}'
      logic_app_receivers: '{{ item.logic_app_receivers }}'
      azure_function_receivers: '{{ item.azure_function_receivers }}'
      arm_role_receivers: '{{ item.arm_role_receivers }}'
      event_hub_receivers: '{{ item.event_hub_receivers }}'
checks:
- rule_id: azure.purview.breach_detection.alert_destinations
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality.data_governance_quality_logs_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.schema.lineage_version_immutability_enforced
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.rule.lineage_source_trusted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_rule.data_quality_recommendation_run_metadata_logging_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ruleset.lineage_encrypted_at_rest
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality.data_catalog_logs_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.connection.lineage_private_networking_enforced
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ml_transform.lineage_network_private_only
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.audit_log.retention_days_minimum
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.compliance.data_governance_reports_storage_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.trigger.data_catalog_targets_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.classification.data_governance_auto_classification_enabled_where_supported
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.database.lineage_policy_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.schema.data_catalog_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.database.lineage_cross_account_sharing_restricted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.data_governance_change_audit_logging_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.breach_detection.integrations_authenticated
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.registry.lineage_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.schema.data_catalog_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality.lineage_output_location_private_and_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.governance.data_policy_admin_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.lifecycle.data_governance_expiration_rules_defined
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.audit_log.logs_centralized_and_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.workflow.data_catalog_cross_account_trusts_restricted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_ruleset.version_immutable
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.job.lineage_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality.data_governance_quality_jobs_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.connection.data_catalog_tls_required
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.connection.data_catalog_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_rule.definition_version_pinned
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.job.data_catalog_script_location_private_and_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ml_transform.data_catalog_network_private_only
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.governance.data_policy_admin_change_audit_logging_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.classifier.lineage_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.classifier.data_catalog_source_trusted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.connection.lineage_tls_required
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.trigger.data_catalog_event_sources_restricted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.classifier.lineage_source_trusted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ruleset.lineage_version_pinned
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.governance.data_policy_admin_mfa_required
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.data_catalog_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ml_transform.lineage_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.partition.lineage_catalog_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.registry.lineage_cross_account_sharing_restricted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.table.lineage_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_rule.data_quality_recommendation_run_logs_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.partition.lineage_access_policies_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.data_catalog_cross_account_sharing_restricted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_rule.data_quality_recommendation_run_output_encrypted_private
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.connection.lineage_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.workflow.lineage_cross_account_trusts_restricted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.database.data_catalog_cross_account_sharing_restricted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.database.lineage_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.scan.data_catalog_crawler_scope_restricted_to_allowlist
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.schema.lineage_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality.data_catalog_output_location_private_and_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.classification.data_governance_policy_blocks_public_for_sensitive
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.lifecycle.data_governance_versioning_enabled_where_supported
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.workflow.data_catalog_execution_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_rule.data_quality_recommendation_run_execution_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality.lineage_logs_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.schema.lineage_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.job.lineage_network_private_only
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.trigger.lineage_targets_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.registry.data_catalog_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ml_transform.data_catalog_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.scan.lineage_crawler_logs_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ruleset.data_catalog_version_pinned
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ml_transform.data_catalog_logs_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_policy.workflow_storage_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.classification.data_governance_required_sensitivity_tags_present
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.job.lineage_logs_and_metrics_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.trigger.lineage_event_sources_restricted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_rule.source_trusted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.registry.lineage_metadata_encryption_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.lineage_cross_account_sharing_restricted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.lineage_audit_logging_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.job.data_catalog_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.connection.data_catalog_private_networking_enforced
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.compliance.data_governance_access_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.connection.lineage_credentials_in_secrets_manager
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.classifier.data_catalog_definition_version_pinned
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.database.data_catalog_policy_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.data_governance_update_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_policy.execution_roles_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.database.data_catalog_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.scan.lineage_crawler_network_private_only
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_rule.data_quality_recommendation_outputs_encrypted_and_private
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.trigger.data_catalog_logs_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.lineage.data_governance_access_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_masking.policies_present_for_sensitive_fields
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.data_catalog_audit_logging_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality.lineage_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ruleset.data_catalog_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.table.data_catalog_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ml_transform.lineage_logs_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_ruleset.rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.connection.data_catalog_credentials_in_secrets_manager
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ruleset.data_catalog_encrypted_at_rest
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality.data_catalog_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.data_governance_cross_account_sharing_review_required
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.scan.data_catalog_crawler_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.lineage.data_governance_capture_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality.data_governance_quality_outputs_encrypted_and_private
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.classifier.data_catalog_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.workflow.lineage_execution_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.compliance.data_governance_export_destinations_private
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.scan.lineage_crawler_scope_restricted_to_allowlist
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.lifecycle.data_governance_immutable_retention_locked_where_required
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.table.lineage_public_sharing_disabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.schema.data_catalog_version_immutability_enforced
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.rule.lineage_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ruleset.lineage_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.retention_policy.data_governance_retention_policies_defined
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.scan.lineage_crawler_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.retention_policy.data_governance_retention_protected_from_public_override
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.job.data_catalog_network_private_only
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_masking.execution_roles_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.job.data_catalog_logs_and_metrics_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.job.lineage_script_location_private_and_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_rule.parameters_no_plaintext_secrets
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.lineage.data_governance_export_destination_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.data_catalog_metadata_encryption_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.registry.data_catalog_cross_account_sharing_restricted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.partition.data_catalog_access_policies_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.workflow.data_catalog_kms_encryption_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.trigger.lineage_logs_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.lineage_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_ruleset.encrypted_at_rest
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.registry.data_catalog_metadata_encryption_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.scan.data_catalog_crawler_logs_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.lineage_store_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.workflow.lineage_kms_encryption_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.table.lineage_access_policies_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.table.data_catalog_public_sharing_disabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_rule.data_quality_recommendation_access_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.table.data_catalog_access_policies_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.retention_policy.data_governance_retention_enforced_on_sensitive_datasets
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.scan.data_catalog_crawler_network_private_only
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.partition.data_catalog_catalog_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.rule.lineage_definition_version_pinned
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.classifier.lineage_definition_version_pinned
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
