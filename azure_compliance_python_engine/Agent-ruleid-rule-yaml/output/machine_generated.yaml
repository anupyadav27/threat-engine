version: '1.0'
provider: azure
service: machine
discovery:
- discovery_id: azure.machine.list
  calls:
  - action: list
    save_as: list_response
  emit:
    items_for: '{{ list_response.value }}'
    as: item
    item:
      id: '{{ item.id }}'
      name: '{{ item.name }}'
      type: '{{ item.type }}'
      system_data: '{{ item.system_data }}'
      tags: '{{ item.tags }}'
      location: '{{ item.location }}'
      sku: '{{ item.sku }}'
      platform_update_domain_count: '{{ item.platform_update_domain_count }}'
      platform_fault_domain_count: '{{ item.platform_fault_domain_count }}'
      virtual_machines: '{{ item.virtual_machines }}'
      proximity_placement_group: '{{ item.proximity_placement_group }}'
      statuses: '{{ item.statuses }}'
      scheduled_events_policy: '{{ item.scheduled_events_policy }}'
      virtual_machine_scale_set_migration_info: '{{ item.virtual_machine_scale_set_migration_info
        }}'
checks:
- rule_id: azure.machine.learning_model.data_governance_ai_model_registry_rbac_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_feature_store.ai_services_feature_store_offline_store_s3_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_job.ai_services_training_job_volume_encryption_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_online_endpoint.data_privacy_ai_endpoint_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model.data_privacy_ai_model_registry_rbac_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_endpoint.ai_services_prompt_gateway_token_scopes_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model.data_governance_ai_model_registry_artifact_encryption_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_workspace.ai_services_workspace_iam_role_least_privileged
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model_package.data_governance_ai_model_package_artifact_signed_and_verified
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model.data_privacy_ai_model_registry_artifact_encryption_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_online_endpoint.data_governance_ai_endpoint_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_feature_store.ai_services_vector_index_rbac_tenant_isolation_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.logging_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_feature_store.ai_services_vector_index_authn_required
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.data_privacy_ai_pipeline_logging_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_hyperdrive_run.learning_hpo_roles_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_dataset.ai_services_ai_dataset_encrypted_at_rest_cmek
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.ai_services_pipeline_kms_encryption_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_job.learning_training_job_input_output_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_online_endpoint.data_governance_ai_endpoint_logging_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_hyperdrive_run.learning_hpo_logs_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model_package.artifact_signed_and_verified
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_batch_endpoint.data_privacy_ai_transform_job_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_job.data_governance_ai_training_job_roles_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_deployment.data_privacy_ai_endpoint_config_content_type_whitelist_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model_package.not_publicly_shared
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model.registry_artifact_encryption_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.ai_services_agent_orchestrator_data_exfiltration_policies_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_auto_ml_job.learning_automl_logs_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_deployment.learning_endpoint_config_data_capture_bucket_encrypted_private
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_endpoint.ai_services_prompt_gateway_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model_version.ai_services_model_artifact_encrypted_at_rest_cmek
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_compute_instance.data_privacy_ai_notebook_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_endpoint.ai_services_ai_endpoint_waf_attached
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_hyperdrive_run.learning_hpo_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_endpoint.ai_services_model_deployment_endpoint_in_vpc
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model_version.ai_services_supply_chain_model_artifact_sbom_present
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.data_governance_ai_pipeline_roles_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.data_governance_ai_pipeline_artifacts_private_and_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_auto_ml_job.learning_automl_roles_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.ai_services_agent_orchestrator_tool_use_allowlist_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_online_endpoint.learning_endpoint_authz_policies_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_job.ai_services_training_job_output_encryption_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_batch_endpoint.learning_transform_job_logs_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_job.ai_services_training_job_inter_container_traffic_encryption_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_experiment.metadata_store_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_workspace.ai_services_workspace_encryption_at_rest_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.ai_services_data_pipeline_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_experiment.logs_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_hyperdrive_run.data_governance_ai_hpo_roles_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_endpoint.ai_services_prompt_gateway_authn_required
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_feature_store.ai_services_vector_index_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_online_endpoint.data_privacy_ai_endpoint_authn_required
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.data_privacy_ai_pipeline_artifacts_private_and_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_endpoint.ai_services_inference_endpoint_kms_encryption_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_experiment.data_privacy_ai_experiment_rbac_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_batch_endpoint.learning_transform_job_input_output_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model_package.data_privacy_ai_model_package_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_job.data_governance_ai_training_job_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_deployment.data_governance_ai_endpoint_config_content_type_whitelist_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_auto_ml_job.data_privacy_ai_automl_roles_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_online_endpoint.data_privacy_ai_endpoint_authz_policies_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_endpoint.ai_services_ai_endpoint_authn_required
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_batch_endpoint.data_governance_ai_transform_job_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_workspace.ai_services_secrets_vault_no_plaintext_secrets_in_config
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_experiment.data_governance_ai_experiment_logs_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_deployment.data_governance_ai_endpoint_config_data_capture_bucket_encrypted_private
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_online_endpoint.learning_endpoint_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_batch_endpoint.data_governance_ai_transform_job_roles_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.learning_human_review_ui_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_feature_store.ai_services_feature_store_rbac_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_dataset.ai_services_dataset_lifecycle_policy_configured
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_job.data_governance_ai_training_job_logs_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.ml_workspace.ml_ops_monitoring_logs_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.artifacts_private_and_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_hyperdrive_run.data_governance_ai_hpo_logs_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_endpoint.ai_services_model_deployment_logging_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_compute_instance.data_privacy_ai_notebook_execution_role_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.ai_services_pipeline_logging_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_auto_ml_job.learning_automl_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_experiment.rbac_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_auto_ml_job.data_privacy_ai_automl_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model.registry_cross_account_sharing_restricted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_batch_endpoint.data_privacy_ai_transform_job_input_output_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.data_governance_ai_human_review_artifacts_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.data_governance_ai_pipeline_kms_encryption_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_batch_endpoint.learning_transform_job_roles_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_compute_instance.data_governance_ai_notebook_execution_role_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_experiment.data_privacy_ai_experiment_logs_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_auto_ml_job.data_privacy_ai_automl_logs_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model_package.data_governance_ai_model_package_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_online_endpoint.learning_endpoint_authn_required
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_job.data_privacy_ai_training_job_roles_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model_package.data_governance_ai_model_package_not_publicly_shared
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.kms_encryption_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_experiment.data_governance_ai_experiment_metadata_store_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model_version.ai_services_supply_chain_model_artifact_signed_and_verified
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_endpoint.ai_services_inference_endpoint_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_batch_endpoint.data_governance_ai_transform_job_input_output_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_job.data_privacy_ai_training_job_input_output_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_feature_store.ai_services_feature_store_online_store_kms_encryption_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_online_endpoint.learning_endpoint_logging_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_endpoint.ai_services_model_deployment_kms_encryption_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_endpoint.ai_services_ai_endpoint_rate_limiting_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model.ai_services_model_image_scan_passed
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_dataset.ai_services_dataset_s3_encrypted_at_rest
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_job.learning_training_job_roles_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_batch_endpoint.learning_transform_job_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_workspace.ai_services_secrets_vault_access_rbac_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_compute_instance.data_privacy_ai_notebook_idle_shutdown_configured
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_feature_store.ai_services_vector_index_encrypted_at_rest_cmek
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_deployment.learning_endpoint_config_content_type_whitelist_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model_version.ai_services_model_version_kms_encryption_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_experiment.data_governance_ai_experiment_rbac_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_online_endpoint.data_privacy_ai_endpoint_logging_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model.data_governance_ai_model_registry_cross_account_sharing_restricted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model.ai_services_model_kms_cmk_used
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model.data_privacy_ai_model_registry_cross_account_sharing_restricted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_compute_instance.data_governance_ai_notebook_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_job.ai_services_training_job_network_isolation_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_online_endpoint.data_governance_ai_endpoint_kms_encryption_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.ai_services_pipeline_iam_role_least_privileged
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.learning_human_review_workteam_access_rbac_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_endpoint.ai_services_inference_endpoint_group_restrictive
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_online_endpoint.data_governance_ai_endpoint_authn_required
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.ai_services_agent_orchestrator_secrets_isolation_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.ai_services_data_pipeline_access_controls_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_dataset.ai_services_dataset_s3_block_public_access
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model_version.ai_services_model_version_package_approved
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.data_governance_ai_pipeline_logging_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model_version.ai_services_model_version_image_scan_passed
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model_package.data_privacy_ai_model_package_not_publicly_shared
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model_package.encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_hyperdrive_run.data_privacy_ai_hpo_logs_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.ml_workspace.ml_ops_monitoring_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_deployment.learning_endpoint_config_kms_keys_restricted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_deployment.data_governance_ai_endpoint_config_kms_keys_restricted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.data_privacy_ai_human_review_artifacts_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model.registry_rbac_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_experiment.data_privacy_ai_experiment_metadata_store_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_auto_ml_job.data_governance_ai_automl_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_hyperdrive_run.data_privacy_ai_hpo_roles_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_job.data_privacy_ai_training_job_logs_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_compute_instance.learning_notebook_execution_role_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_feature_store.ai_services_feature_store_offline_store_block_public_access
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_compute_instance.data_governance_ai_notebook_no_public_access
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.data_privacy_ai_pipeline_roles_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_compute_instance.data_privacy_ai_notebook_no_public_access
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_auto_ml_job.data_governance_ai_automl_logs_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.learning_human_review_artifacts_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_job.learning_training_job_logs_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_online_endpoint.learning_endpoint_kms_encryption_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_compute_instance.learning_notebook_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.data_governance_ai_human_review_ui_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_batch_endpoint.data_privacy_ai_transform_job_logs_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_dataset.ai_services_ai_dataset_public_access_blocked
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_hyperdrive_run.data_governance_ai_hpo_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_workspace.ai_services_secrets_vault_kms_encryption_and_rotation_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.data_privacy_ai_pipeline_kms_encryption_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model.ai_services_model_artifact_encrypted_at_rest
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_job.ai_services_training_pipeline_secrets_from_vault_only
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_batch_endpoint.data_governance_ai_transform_job_logs_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.roles_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.data_privacy_ai_human_review_workteam_access_rbac_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_auto_ml_job.data_governance_ai_automl_roles_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_dataset.ai_services_dataset_access_logging_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model.ai_services_model_execution_role_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_job.learning_training_job_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_workspace.ai_services_workspace_idle_shutdown_configured
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_hyperdrive_run.data_privacy_ai_hpo_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.data_governance_ai_human_review_workteam_access_rbac_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.ml_workspace.ml_ops_monitoring_roles_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_job.data_governance_ai_training_job_input_output_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_compute_instance.learning_notebook_no_public_access
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_online_endpoint.data_governance_ai_endpoint_authz_policies_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_endpoint.ai_services_ai_endpoint_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_job.data_privacy_ai_training_job_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_endpoint.ai_services_inference_endpoint_data_capture_s3_encrypted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_compute_instance.learning_notebook_idle_shutdown_configured
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_compute_instance.data_governance_ai_notebook_idle_shutdown_configured
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_online_endpoint.data_privacy_ai_endpoint_kms_encryption_enabled
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_deployment.data_privacy_ai_endpoint_config_kms_keys_restricted
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.ml_workspace.ml_ops_monitoring_outputs_encrypted_and_private
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_endpoint.ai_services_ai_endpoint_authz_policies_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model_version.ai_services_supply_chain_model_artifact_image_scanned_no_critical
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model_package.data_privacy_ai_model_package_artifact_signed_and_verified
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_job.ai_services_training_pipeline_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_batch_endpoint.data_privacy_ai_transform_job_roles_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_pipeline.data_privacy_ai_human_review_ui_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_workspace.ai_services_workspace_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_deployment.data_privacy_ai_endpoint_config_capture_store_encrypted_and_private
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_job.ai_services_training_job_vpc_configured
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_model.ai_services_model_registry_access_rbac_least_privilege
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
- rule_id: azure.machine.learning_feature_store.ai_services_feature_store_private_networking_enforced
  for_each: azure.machine.list
  conditions:
    var: item.id
    op: exists
