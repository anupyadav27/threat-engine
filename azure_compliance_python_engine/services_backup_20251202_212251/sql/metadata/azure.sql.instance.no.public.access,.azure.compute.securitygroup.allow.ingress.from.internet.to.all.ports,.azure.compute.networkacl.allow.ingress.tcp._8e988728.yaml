description: Validates that AZURE sql instance has no public access, azure compute
  securitygroup allow ingress from internet to all ports, azure compute networkacl
  allow ingress tcp port 22, azure awslambda function not publicly accessible, azure
  compute networkacl allow ingress tcp port 3389, azure synapse cluster public access,
  azure search service domains not publicly accessible, azure storage bucket policy
  public write access, azure awslambda function inside vpc, azure storage bucket public
  write acl, azure database migration instance no public access, azure machine learning
  notebook instance without direct internet access configured configured according
  to security best practices. Proper configuration reduces security risks, prevents
  unauthorized access, and ensures compliance with industry standards and regulations.
domain: network_security_and_connectivity
rationale: Ensures AZURE sql instance has no public access, azure compute securitygroup
  allow ingress from internet to all ports, azure compute networkacl allow ingress
  tcp port 22, azure awslambda function not publicly accessible, azure compute networkacl
  allow ingress tcp port 3389, azure synapse cluster public access, azure search service
  domains not publicly accessible, azure storage bucket policy public write access,
  azure awslambda function inside vpc, azure storage bucket public write acl, azure
  database migration instance no public access, azure machine learning notebook instance
  without direct internet access configured properly configured for security compliance.
  This control is essential for maintaining a strong security posture and meeting
  regulatory requirements.
references:
- https://docs.microsoft.com/azure/sql
- https://docs.microsoft.com/azure/security-center
requirement: No Public Access, Azure Compute Securitygroup Allow Ingress From Internet
  To All Ports, Azure Compute Networkacl Allow Ingress Tcp Port 22, Azure Awslambda
  Function Not Publicly Accessible, Azure Compute Networkacl Allow Ingress Tcp Port
  3389, Azure Synapse Cluster Public Access, Azure Search Service Domains Not Publicly
  Accessible, Azure Storage Bucket Policy Public Write Access, Azure Awslambda Function
  Inside Vpc, Azure Storage Bucket Public Write Acl, Azure Database Migration Instance
  No Public Access, Azure Machine Learning Notebook Instance Without Direct Internet
  Access Configured
resource: instance
rule_id: azure.sql.instance.no.public.access,.azure.compute.securitygroup.allow.ingress.from.internet.to.all.ports,.azure.compute.networkacl.allow.ingress.tcp.port.22,.azure.awslambda.function.not.publicly.accessible,.azure.compute.networkacl.allow.ingress.tcp.port.3389,.azure.synapse.cluster.public.access,.azure.search.service.domains.not.publicly.accessible,.azure.storage.bucket.policy.public.write.access,.azure.awslambda.function.inside.vpc,.azure.storage.bucket.public.write.acl,.azure.database.migration.instance.no.public.access,.azure.machine.learning.notebook.instance.without.direct.internet.access.configured
scope: sql.instance.network_security
service: sql
severity: critical
subcategory: network_access_control
title: 'AZURE SQL Instance: No Public Access, Azure Compute Securitygroup Allow Ingress
  From Internet To All Ports, Azure Compute Networkacl Allow Ingress Tcp Port 22,
  Azure Awslambda Function Not Publicly Accessible, Azure Compute Networkacl Allow
  Ingress Tcp Port 3389, Azure Synapse Cluster Public Access, Azure Search Service
  Domains Not Publicly Accessible, Azure Storage Bucket Policy Public Write Access,
  Azure Awslambda Function Inside Vpc, Azure Storage Bucket Public Write Acl, Azure
  Database Migration Instance No Public Access, Azure Machine Learning Notebook Instance
  Without Direct Internet Access Configured'
