description: Validates that AZURE compute ebs has public snapshot, azure sql instance
  no public access, azure aks endpoints not publicly accessible, azure storage account
  level public access blocks, azure awslambda function not publicly accessible, azure
  hdinsight cluster master nodes no public ip, azure compute instance public ip, azure
  monitor log metric filter root usage, azure sql snapshots public access, azure search
  service domains not publicly accessible, azure synapse cluster public access, azure
  storage bucket policy public write access, azure storage bucket public write acl,
  azure database migration instance no public access, azure machine learning notebook
  instance without direct internet access configured configured according to security
  best practices. Proper configuration reduces security risks, prevents unauthorized
  access, and ensures compliance with industry standards and regulations.
domain: logging_monitoring_and_alerting
rationale: Ensures AZURE compute ebs has public snapshot, azure sql instance no public
  access, azure aks endpoints not publicly accessible, azure storage account level
  public access blocks, azure awslambda function not publicly accessible, azure hdinsight
  cluster master nodes no public ip, azure compute instance public ip, azure monitor
  log metric filter root usage, azure sql snapshots public access, azure search service
  domains not publicly accessible, azure synapse cluster public access, azure storage
  bucket policy public write access, azure storage bucket public write acl, azure
  database migration instance no public access, azure machine learning notebook instance
  without direct internet access configured properly configured for security compliance.
  This control is essential for maintaining a strong security posture and meeting
  regulatory requirements.
references:
- https://docs.microsoft.com/azure/compute
- https://docs.microsoft.com/azure/security-center
requirement: Public Snapshot, Azure Sql Instance No Public Access, Azure Aks Endpoints
  Not Publicly Accessible, Azure Storage Account Level Public Access Blocks, Azure
  Awslambda Function Not Publicly Accessible, Azure Hdinsight Cluster Master Nodes
  No Public Ip, Azure Compute Instance Public Ip, Azure Monitor Log Metric Filter
  Root Usage, Azure Sql Snapshots Public Access, Azure Search Service Domains Not
  Publicly Accessible, Azure Synapse Cluster Public Access, Azure Storage Bucket Policy
  Public Write Access, Azure Storage Bucket Public Write Acl, Azure Database Migration
  Instance No Public Access, Azure Machine Learning Notebook Instance Without Direct
  Internet Access Configured
resource: ebs
rule_id: azure.compute.ebs.public.snapshot,.azure.sql.instance.no.public.access,.azure.aks.endpoints.not.publicly.accessible,.azure.storage.account.level.public.access.blocks,.azure.awslambda.function.not.publicly.accessible,.azure.hdinsight.cluster.master.nodes.no.public.ip,.azure.compute.instance.public.ip,.azure.monitor.log.metric.filter.root.usage,.azure.sql.snapshots.public.access,.azure.search.service.domains.not.publicly.accessible,.azure.synapse.cluster.public.access,.azure.storage.bucket.policy.public.write.access,.azure.storage.bucket.public.write.acl,.azure.database.migration.instance.no.public.access,.azure.machine.learning.notebook.instance.without.direct.internet.access.configured
scope: compute.ebs.logging
service: compute
severity: critical
subcategory: audit_logging
title: 'AZURE COMPUTE Ebs: Public Snapshot, Azure Sql Instance No Public Access, Azure
  Aks Endpoints Not Publicly Accessible, Azure Storage Account Level Public Access
  Blocks, Azure Awslambda Function Not Publicly Accessible, Azure Hdinsight Cluster
  Master Nodes No Public Ip, Azure Compute Instance Public Ip, Azure Monitor Log Metric
  Filter Root Usage, Azure Sql Snapshots Public Access, Azure Search Service Domains
  Not Publicly Accessible, Azure Synapse Cluster Public Access, Azure Storage Bucket
  Policy Public Write Access, Azure Storage Bucket Public Write Acl, Azure Database
  Migration Instance No Public Access, Azure Machine Learning Notebook Instance Without
  Direct Internet Access Configured'
