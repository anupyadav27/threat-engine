description: Validates that AZURE compute ebs has public snapshot, azure sql instance
  no public access, azure compute securitygroup default restrict traffic, azure compute
  securitygroup allow ingress from internet to all ports, azure compute networkacl
  allow ingress tcp port 22, azure awslambda function not publicly accessible, azure
  sql snapshots public access, azure search service domains not publicly accessible,
  azure synapse cluster public access, azure storage bucket policy public write access,
  azure awslambda function inside vpc, azure compute securitygroup allow ingress from
  internet to tcp port 22, azure storage bucket public write acl, azure database migration
  instance no public access, azure machine learning notebook instance without direct
  internet access configured, azure compute networkacl allow ingress tcp port 3389
  configured according to security best practices. Proper configuration reduces security
  risks, prevents unauthorized access, and ensures compliance with industry standards
  and regulations.
domain: storage_and_database_security
rationale: Ensures AZURE compute ebs has public snapshot, azure sql instance no public
  access, azure compute securitygroup default restrict traffic, azure compute securitygroup
  allow ingress from internet to all ports, azure compute networkacl allow ingress
  tcp port 22, azure awslambda function not publicly accessible, azure sql snapshots
  public access, azure search service domains not publicly accessible, azure synapse
  cluster public access, azure storage bucket policy public write access, azure awslambda
  function inside vpc, azure compute securitygroup allow ingress from internet to
  tcp port 22, azure storage bucket public write acl, azure database migration instance
  no public access, azure machine learning notebook instance without direct internet
  access configured, azure compute networkacl allow ingress tcp port 3389 properly
  configured for security compliance. This control is essential for maintaining a
  strong security posture and meeting regulatory requirements.
references:
- https://docs.microsoft.com/azure/compute
- https://docs.microsoft.com/azure/security-center
requirement: Public Snapshot, Azure Sql Instance No Public Access, Azure Compute Securitygroup
  Default Restrict Traffic, Azure Compute Securitygroup Allow Ingress From Internet
  To All Ports, Azure Compute Networkacl Allow Ingress Tcp Port 22, Azure Awslambda
  Function Not Publicly Accessible, Azure Sql Snapshots Public Access, Azure Search
  Service Domains Not Publicly Accessible, Azure Synapse Cluster Public Access, Azure
  Storage Bucket Policy Public Write Access, Azure Awslambda Function Inside Vpc,
  Azure Compute Securitygroup Allow Ingress From Internet To Tcp Port 22, Azure Storage
  Bucket Public Write Acl, Azure Database Migration Instance No Public Access, Azure
  Machine Learning Notebook Instance Without Direct Internet Access Configured, Azure
  Compute Networkacl Allow Ingress Tcp Port 3389
resource: ebs
rule_id: azure.compute.ebs.public.snapshot,.azure.sql.instance.no.public.access,.azure.compute.securitygroup.default.restrict.traffic,.azure.compute.securitygroup.allow.ingress.from.internet.to.all.ports,.azure.compute.networkacl.allow.ingress.tcp.port.22,.azure.awslambda.function.not.publicly.accessible,.azure.sql.snapshots.public.access,.azure.search.service.domains.not.publicly.accessible,.azure.synapse.cluster.public.access,.azure.storage.bucket.policy.public.write.access,.azure.awslambda.function.inside.vpc,.azure.compute.securitygroup.allow.ingress.from.internet.to.tcp.port.22,.azure.storage.bucket.public.write.acl,.azure.database.migration.instance.no.public.access,.azure.machine.learning.notebook.instance.without.direct.internet.access.configured,.azure.compute.networkacl.allow.ingress.tcp.port.3389
scope: compute.ebs.backup_recovery
service: compute
severity: critical
subcategory: storage_encryption
title: 'AZURE COMPUTE Ebs: Public Snapshot, Azure Sql Instance No Public Access, Azure
  Compute Securitygroup Default Restrict Traffic, Azure Compute Securitygroup Allow
  Ingress From Internet To All Ports, Azure Compute Networkacl Allow Ingress Tcp Port
  22, Azure Awslambda Function Not Publicly Accessible, Azure Sql Snapshots Public
  Access, Azure Search Service Domains Not Publicly Accessible, Azure Synapse Cluster
  Public Access, Azure Storage Bucket Policy Public Write Access, Azure Awslambda
  Function Inside Vpc, Azure Compute Securitygroup Allow Ingress From Internet To
  Tcp Port 22, Azure Storage Bucket Public Write Acl, Azure Database Migration Instance
  No Public Access, Azure Machine Learning Notebook Instance Without Direct Internet
  Access Configured, Azure Compute Networkacl Allow Ingress Tcp Port 3389'
