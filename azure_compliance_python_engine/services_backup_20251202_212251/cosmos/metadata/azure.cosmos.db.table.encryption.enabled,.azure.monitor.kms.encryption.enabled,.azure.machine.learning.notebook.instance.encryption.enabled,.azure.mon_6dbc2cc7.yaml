description: Validates that AZURE cosmos db has table encryption enabled, azure monitor
  kms encryption enabled, azure machine learning notebook instance encryption enabled,
  azure monitor log group kms encryption enabled, azure storage bucket kms encryption,
  azure aks cluster kms cmk encryption in secrets enabled, azure sql snapshots encrypted,
  azure storage bucket default encryption, azure files encryption at rest enabled,
  azure compute ebs default encryption, azure search service domains encryption at
  rest enabled, azure notification hubs topics kms encryption at rest enabled, azure
  cosmos db accelerator cluster encryption enabled, azure cosmos db tables kms cmk
  encryption enabled, azure compute ebs volume encryption, azure sql instance storage
  encrypted, azure synapse cluster audit logging, azure search service domains audit
  logging enabled, azure load balancer logging enabled, azure load balancer logging
  enabled, azure api management restapi logging enabled, azure monitor multi region
  enabled, azure wafv2 web acl logging enabled, azure monitor cloudwatch logging enabled
  configured according to security best practices. Proper configuration reduces security
  risks, prevents unauthorized access, and ensures compliance with industry standards
  and regulations.
domain: data_protection_and_privacy
rationale: Ensures AZURE cosmos db has table encryption enabled, azure monitor kms
  encryption enabled, azure machine learning notebook instance encryption enabled,
  azure monitor log group kms encryption enabled, azure storage bucket kms encryption,
  azure aks cluster kms cmk encryption in secrets enabled, azure sql snapshots encrypted,
  azure storage bucket default encryption, azure files encryption at rest enabled,
  azure compute ebs default encryption, azure search service domains encryption at
  rest enabled, azure notification hubs topics kms encryption at rest enabled, azure
  cosmos db accelerator cluster encryption enabled, azure cosmos db tables kms cmk
  encryption enabled, azure compute ebs volume encryption, azure sql instance storage
  encrypted, azure synapse cluster audit logging, azure search service domains audit
  logging enabled, azure load balancer logging enabled, azure load balancer logging
  enabled, azure api management restapi logging enabled, azure monitor multi region
  enabled, azure wafv2 web acl logging enabled, azure monitor cloudwatch logging enabled
  properly configured for security compliance. This control is essential for maintaining
  a strong security posture and meeting regulatory requirements.
references:
- https://docs.microsoft.com/azure/cosmos
- https://docs.microsoft.com/azure/security-center
requirement: Table Encryption Enabled, Azure Monitor KMS Encryption Enabled, Azure
  Machine Learning Notebook Instance Encryption Enabled, Azure Monitor Log Group KMS
  Encryption Enabled, Azure Storage Bucket KMS Encryption, Azure Aks Cluster KMS CMK
  Encryption In Secrets Enabled, Azure Sql Snapshots Encrypted, Azure Storage Bucket
  Default Encryption, Azure Files Encryption At Rest Enabled, Azure Compute Ebs Default
  Encryption, Azure Search Service Domains Encryption At Rest Enabled, Azure Notification
  Hubs Topics KMS Encryption At Rest Enabled, Azure Cosmos Db Accelerator Cluster
  Encryption Enabled, Azure Cosmos Db Tables KMS CMK Encryption Enabled, Azure Compute
  Ebs Volume Encryption, Azure Sql Instance Storage Encrypted, Azure Synapse Cluster
  Audit Logging, Azure Search Service Domains Audit Logging Enabled, Azure Load Balancer
  Logging Enabled, Azure Load Balancer Logging Enabled, Azure API Management Restapi
  Logging Enabled, Azure Monitor Multi Region Enabled, Azure Wafv2 Web ACL Logging
  Enabled, Azure Monitor Cloudwatch Logging Enabled
resource: db
rule_id: azure.cosmos.db.table.encryption.enabled,.azure.monitor.kms.encryption.enabled,.azure.machine.learning.notebook.instance.encryption.enabled,.azure.monitor.log.group.kms.encryption.enabled,.azure.storage.bucket.kms.encryption,.azure.aks.cluster.kms.cmk.encryption.in.secrets.enabled,.azure.sql.snapshots.encrypted,.azure.storage.bucket.default.encryption,.azure.files.encryption.at.rest.enabled,.azure.compute.ebs.default.encryption,.azure.search.service.domains.encryption.at.rest.enabled,.azure.notification.hubs.topics.kms.encryption.at.rest.enabled,.azure.cosmos.db.accelerator.cluster.encryption.enabled,.azure.cosmos.db.tables.kms.cmk.encryption.enabled,.azure.compute.ebs.volume.encryption,.azure.sql.instance.storage.encrypted,.azure.synapse.cluster.audit.logging,.azure.search.service.domains.audit.logging.enabled,.azure.load.balancer.logging.enabled,.azure.load.balancer.logging.enabled,.azure.api.management.restapi.logging.enabled,.azure.monitor.multi.region.enabled,.azure.wafv2.web.acl.logging.enabled,.azure.monitor.cloudwatch.logging.enabled
scope: cosmos.db.encryption
service: cosmos
severity: high
subcategory: encryption_at_rest
title: 'AZURE COSMOS Db: Table Encryption Enabled, Azure Monitor KMS Encryption Enabled,
  Azure Machine Learning Notebook Instance Encryption Enabled, Azure Monitor Log Group
  KMS Encryption Enabled, Azure Storage Bucket KMS Encryption, Azure Aks Cluster KMS
  CMK Encryption In Secrets Enabled, Azure Sql Snapshots Encrypted, Azure Storage
  Bucket Default Encryption, Azure Files Encryption At Rest Enabled, Azure Compute
  Ebs Default Encryption, Azure Search Service Domains Encryption At Rest Enabled,
  Azure Notification Hubs Topics KMS Encryption At Rest Enabled, Azure Cosmos Db Accelerator
  Cluster Encryption Enabled, Azure Cosmos Db Tables KMS CMK Encryption Enabled, Azure
  Compute Ebs Volume Encryption, Azure Sql Instance Storage Encrypted, Azure Synapse
  Cluster Audit Logging, Azure Search Service Domains Audit Logging Enabled, Azure
  Load Balancer Logging Enabled, Azure Load Balancer Logging Enabled, Azure API Management
  Restapi Logging Enabled, Azure Monitor Multi Region Enabled, Azure Wafv2 Web ACL
  Logging Enabled, Azure Monitor Cloudwatch Logging Enabled'
