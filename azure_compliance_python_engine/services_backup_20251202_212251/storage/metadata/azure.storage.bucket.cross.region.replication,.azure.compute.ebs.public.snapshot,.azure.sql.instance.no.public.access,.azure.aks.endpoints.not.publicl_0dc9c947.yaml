description: Validates that AZURE storage bucket has cross region replication, azure
  compute ebs public snapshot, azure sql instance no public access, azure aks endpoints
  not publicly accessible, azure virtual network endpoint for ec2 enabled, azure storage
  account level public access blocks, azure awslambda function not publicly accessible,
  azure hdinsight cluster master nodes no public ip, azure compute instance public
  ip, azure sql snapshots public access, azure search service domains not publicly
  accessible, azure synapse cluster public access, azure awslambda function inside
  vpc, azure compute securitygroup allow ingress from internet to tcp port 22, azure
  database migration instance no public access, azure machine learning notebook instance
  without direct internet access configured, azure automation managed compliant patching,
  azure sql cluster default admin, azure sql instance default admin configured according
  to security best practices. Proper configuration reduces security risks, prevents
  unauthorized access, and ensures compliance with industry standards and regulations.
domain: storage_and_database_security
rationale: Ensures AZURE storage bucket has cross region replication, azure compute
  ebs public snapshot, azure sql instance no public access, azure aks endpoints not
  publicly accessible, azure virtual network endpoint for ec2 enabled, azure storage
  account level public access blocks, azure awslambda function not publicly accessible,
  azure hdinsight cluster master nodes no public ip, azure compute instance public
  ip, azure sql snapshots public access, azure search service domains not publicly
  accessible, azure synapse cluster public access, azure awslambda function inside
  vpc, azure compute securitygroup allow ingress from internet to tcp port 22, azure
  database migration instance no public access, azure machine learning notebook instance
  without direct internet access configured, azure automation managed compliant patching,
  azure sql cluster default admin, azure sql instance default admin properly configured
  for security compliance. This control is essential for maintaining a strong security
  posture and meeting regulatory requirements.
references:
- https://docs.microsoft.com/azure/storage
- https://docs.microsoft.com/azure/security-center
requirement: Cross Region Replication, Azure Compute Ebs Public Snapshot, Azure Sql
  Instance No Public Access, Azure Aks Endpoints Not Publicly Accessible, Azure Virtual
  Network Endpoint For Ec2 Enabled, Azure Storage Account Level Public Access Blocks,
  Azure Awslambda Function Not Publicly Accessible, Azure Hdinsight Cluster Master
  Nodes No Public Ip, Azure Compute Instance Public Ip, Azure Sql Snapshots Public
  Access, Azure Search Service Domains Not Publicly Accessible, Azure Synapse Cluster
  Public Access, Azure Awslambda Function Inside Vpc, Azure Compute Securitygroup
  Allow Ingress From Internet To Tcp Port 22, Azure Database Migration Instance No
  Public Access, Azure Machine Learning Notebook Instance Without Direct Internet
  Access Configured, Azure Automation Managed Compliant Patching, Azure Sql Cluster
  Default Admin, Azure Sql Instance Default Admin
resource: bucket
rule_id: azure.storage.bucket.cross.region.replication,.azure.compute.ebs.public.snapshot,.azure.sql.instance.no.public.access,.azure.aks.endpoints.not.publicly.accessible,.azure.virtual.network.endpoint.for.ec2.enabled,.azure.storage.account.level.public.access.blocks,.azure.awslambda.function.not.publicly.accessible,.azure.hdinsight.cluster.master.nodes.no.public.ip,.azure.compute.instance.public.ip,.azure.sql.snapshots.public.access,.azure.search.service.domains.not.publicly.accessible,.azure.synapse.cluster.public.access,.azure.awslambda.function.inside.vpc,.azure.compute.securitygroup.allow.ingress.from.internet.to.tcp.port.22,.azure.database.migration.instance.no.public.access,.azure.machine.learning.notebook.instance.without.direct.internet.access.configured,.azure.automation.managed.compliant.patching,.azure.sql.cluster.default.admin,.azure.sql.instance.default.admin
scope: storage.bucket.backup_recovery
service: storage
severity: critical
subcategory: storage_encryption
title: 'AZURE STORAGE Bucket: Cross Region Replication, Azure Compute Ebs Public Snapshot,
  Azure Sql Instance No Public Access, Azure Aks Endpoints Not Publicly Accessible,
  Azure Virtual Network Endpoint For Ec2 Enabled, Azure Storage Account Level Public
  Access Blocks, Azure Awslambda Function Not Publicly Accessible, Azure Hdinsight
  Cluster Master Nodes No Public Ip, Azure Compute Instance Public Ip, Azure Sql Snapshots
  Public Access, Azure Search Service Domains Not Publicly Accessible, Azure Synapse
  Cluster Public Access, Azure Awslambda Function Inside Vpc, Azure Compute Securitygroup
  Allow Ingress From Internet To Tcp Port 22, Azure Database Migration Instance No
  Public Access, Azure Machine Learning Notebook Instance Without Direct Internet
  Access Configured, Azure Automation Managed Compliant Patching, Azure Sql Cluster
  Default Admin, Azure Sql Instance Default Admin'
