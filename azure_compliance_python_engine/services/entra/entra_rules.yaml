entra:
  scope: tenant
  discovery:
    - discovery_id: applications
      calls:
        - method: GET
          path: /v1.0/applications
          fields:
            - path: value[]
              var: app
            - path: value[].appId
              var: app_id
  checks:
    - check_id: has_any_applications
      title: Tenant has at least one application registration
      severity: low
      for_each: applications
      param: app
      calls:
        - method: GET
          path: /v1.0/applications
          fields:
            - path: value[]
              operator: exists
              expected: true 