notification:
  version: '1.0'
  provider: azure
  service: notification
  package: azure-mgmt-notificationhubs
  client_class: NotificationHubsManagementClient
  scope: subscription
  discovery:
  - discovery_id: azure.notification.namespaces
    calls:
    - client: notification
      action: namespaces.list
      save_as: namespaces
  - discovery_id: azure.notification.hubs
    calls:
    - client: notification
      action: notification_hubs.list
      save_as: hubs
  - discovery_id: azure.notification.authorization_rules
    calls:
    - client: notification
      action: namespaces.list_authorization_rules
      save_as: authorization_rules
  checks:
  - check_id: azure.notification.hub.topic_subscription_configured
    title: 'AZURE NOTIFICATION Hub: Topic Subscription Configured'
    severity: low
    for_each: azure.notification.hubs
    calls:
    - action: notification_hubs.get
      params:
        resource_group_name: '{{resource_group}}'
        namespace_name: '{{namespace_name}}'
        notification_hub_name: '{{name}}'
      fields:
      - path: apns_credential
        operator: exists
      - path: gcm_credential
        operator: exists
