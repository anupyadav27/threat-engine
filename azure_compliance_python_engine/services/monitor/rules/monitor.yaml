version: '1.0'
provider: azure
service: monitor
discovery:
- discovery_id: azure.billing.list_by_resource_group
  calls:
  - action: list_by_resource_group
    save_as: list_by_resource_group_response
  emit:
    items_for: '{{ list_by_resource_group_response.value }}'
    as: item
    item:
      id: '{{ item.id }}'
      name: '{{ item.name }}'
      type: '{{ item.type }}'
      location: '{{ item.location }}'
      tags: '{{ item.tags }}'
      group_short_name: '{{ item.group_short_name }}'
      enabled: '{{ item.enabled }}'
      email_receivers: '{{ item.email_receivers }}'
      sms_receivers: '{{ item.sms_receivers }}'
      webhook_receivers: '{{ item.webhook_receivers }}'
      itsm_receivers: '{{ item.itsm_receivers }}'
      azure_app_push_receivers: '{{ item.azure_app_push_receivers }}'
      automation_runbook_receivers: '{{ item.automation_runbook_receivers }}'
      voice_receivers: '{{ item.voice_receivers }}'
      logic_app_receivers: '{{ item.logic_app_receivers }}'
      azure_function_receivers: '{{ item.azure_function_receivers }}'
      arm_role_receivers: '{{ item.arm_role_receivers }}'
      event_hub_receivers: '{{ item.event_hub_receivers }}'
- discovery_id: azure.cost.list_by_resource_group
  calls:
  - action: list_by_resource_group
    save_as: list_by_resource_group_response
  emit:
    items_for: '{{ list_by_resource_group_response.value }}'
    as: item
    item:
      id: '{{ item.id }}'
      name: '{{ item.name }}'
      type: '{{ item.type }}'
      location: '{{ item.location }}'
      tags: '{{ item.tags }}'
      group_short_name: '{{ item.group_short_name }}'
      enabled: '{{ item.enabled }}'
      email_receivers: '{{ item.email_receivers }}'
      sms_receivers: '{{ item.sms_receivers }}'
      webhook_receivers: '{{ item.webhook_receivers }}'
      itsm_receivers: '{{ item.itsm_receivers }}'
      azure_app_push_receivers: '{{ item.azure_app_push_receivers }}'
      automation_runbook_receivers: '{{ item.automation_runbook_receivers }}'
      voice_receivers: '{{ item.voice_receivers }}'
      logic_app_receivers: '{{ item.logic_app_receivers }}'
      azure_function_receivers: '{{ item.azure_function_receivers }}'
      arm_role_receivers: '{{ item.arm_role_receivers }}'
      event_hub_receivers: '{{ item.event_hub_receivers }}'
- discovery_id: azure.data.list_by_resource_group
  calls:
  - action: list_by_resource_group
    save_as: list_by_resource_group_response
  emit:
    items_for: '{{ list_by_resource_group_response.value }}'
    as: item
    item:
      id: '{{ item.id }}'
      name: '{{ item.name }}'
      type: '{{ item.type }}'
      location: '{{ item.location }}'
      tags: '{{ item.tags }}'
      group_short_name: '{{ item.group_short_name }}'
      enabled: '{{ item.enabled }}'
      email_receivers: '{{ item.email_receivers }}'
      sms_receivers: '{{ item.sms_receivers }}'
      webhook_receivers: '{{ item.webhook_receivers }}'
      itsm_receivers: '{{ item.itsm_receivers }}'
      azure_app_push_receivers: '{{ item.azure_app_push_receivers }}'
      automation_runbook_receivers: '{{ item.automation_runbook_receivers }}'
      voice_receivers: '{{ item.voice_receivers }}'
      logic_app_receivers: '{{ item.logic_app_receivers }}'
      azure_function_receivers: '{{ item.azure_function_receivers }}'
      arm_role_receivers: '{{ item.arm_role_receivers }}'
      event_hub_receivers: '{{ item.event_hub_receivers }}'
- discovery_id: azure.devops.list_by_resource_group
  calls:
  - action: list_by_resource_group
    save_as: list_by_resource_group_response
  emit:
    items_for: '{{ list_by_resource_group_response.value }}'
    as: item
    item:
      id: '{{ item.id }}'
      name: '{{ item.name }}'
      type: '{{ item.type }}'
      location: '{{ item.location }}'
      tags: '{{ item.tags }}'
      scopes: '{{ item.scopes }}'
      condition: '{{ item.condition }}'
      actions: '{{ item.actions }}'
      enabled: '{{ item.enabled }}'
      description: '{{ item.description }}'
- discovery_id: azure.intune.list_by_resource_group
  calls:
  - action: list_by_resource_group
    save_as: list_by_resource_group_response
  emit:
    items_for: '{{ list_by_resource_group_response.value }}'
    as: item
    item:
      id: '{{ item.id }}'
      name: '{{ item.name }}'
      type: '{{ item.type }}'
      location: '{{ item.location }}'
      tags: '{{ item.tags }}'
      scopes: '{{ item.scopes }}'
      condition: '{{ item.condition }}'
      actions: '{{ item.actions }}'
      enabled: '{{ item.enabled }}'
      description: '{{ item.description }}'
- discovery_id: azure.iot.list_by_resource_group
  calls:
  - action: list_by_resource_group
    save_as: list_by_resource_group_response
  emit:
    items_for: '{{ list_by_resource_group_response.value }}'
    as: item
    item:
      id: '{{ item.id }}'
      name: '{{ item.name }}'
      type: '{{ item.type }}'
      location: '{{ item.location }}'
      tags: '{{ item.tags }}'
      group_short_name: '{{ item.group_short_name }}'
      enabled: '{{ item.enabled }}'
      email_receivers: '{{ item.email_receivers }}'
      sms_receivers: '{{ item.sms_receivers }}'
      webhook_receivers: '{{ item.webhook_receivers }}'
      itsm_receivers: '{{ item.itsm_receivers }}'
      azure_app_push_receivers: '{{ item.azure_app_push_receivers }}'
      automation_runbook_receivers: '{{ item.automation_runbook_receivers }}'
      voice_receivers: '{{ item.voice_receivers }}'
      logic_app_receivers: '{{ item.logic_app_receivers }}'
      azure_function_receivers: '{{ item.azure_function_receivers }}'
      arm_role_receivers: '{{ item.arm_role_receivers }}'
      event_hub_receivers: '{{ item.event_hub_receivers }}'
- discovery_id: azure.log.list_by_resource_group
  calls:
  - action: list_by_resource_group
    save_as: list_by_resource_group_response
  emit:
    items_for: '{{ list_by_resource_group_response.value }}'
    as: item
    item:
      id: '{{ item.id }}'
      name: '{{ item.name }}'
      type: '{{ item.type }}'
      location: '{{ item.location }}'
      tags: '{{ item.tags }}'
      group_short_name: '{{ item.group_short_name }}'
      enabled: '{{ item.enabled }}'
      email_receivers: '{{ item.email_receivers }}'
      sms_receivers: '{{ item.sms_receivers }}'
      webhook_receivers: '{{ item.webhook_receivers }}'
      itsm_receivers: '{{ item.itsm_receivers }}'
      azure_app_push_receivers: '{{ item.azure_app_push_receivers }}'
      automation_runbook_receivers: '{{ item.automation_runbook_receivers }}'
      voice_receivers: '{{ item.voice_receivers }}'
      logic_app_receivers: '{{ item.logic_app_receivers }}'
      azure_function_receivers: '{{ item.azure_function_receivers }}'
      arm_role_receivers: '{{ item.arm_role_receivers }}'
      event_hub_receivers: '{{ item.event_hub_receivers }}'
- discovery_id: azure.monitor.list_by_resource_group
  calls:
  - action: list_by_resource_group
    save_as: list_by_resource_group_response
  emit:
    items_for: '{{ list_by_resource_group_response.value }}'
    as: item
    item:
      id: '{{ item.id }}'
      name: '{{ item.name }}'
      type: '{{ item.type }}'
      location: '{{ item.location }}'
      tags: '{{ item.tags }}'
      scopes: '{{ item.scopes }}'
      condition: '{{ item.condition }}'
      actions: '{{ item.actions }}'
      enabled: '{{ item.enabled }}'
      description: '{{ item.description }}'
- discovery_id: azure.monitor.list
  calls:
  - action: list
    save_as: list_response
  emit:
    items_for: '{{ list_response.value }}'
    as: item
    item:
      authorization: '{{ item.authorization }}'
      claims: '{{ item.claims }}'
      caller: '{{ item.caller }}'
      description: '{{ item.description }}'
      id: '{{ item.id }}'
      event_data_id: '{{ item.event_data_id }}'
      correlation_id: '{{ item.correlation_id }}'
      event_name: '{{ item.event_name }}'
      category: '{{ item.category }}'
      http_request: '{{ item.http_request }}'
      level: '{{ item.level }}'
      resource_group_name: '{{ item.resource_group_name }}'
      resource_provider_name: '{{ item.resource_provider_name }}'
      resource_id: '{{ item.resource_id }}'
      resource_type: '{{ item.resource_type }}'
      operation_id: '{{ item.operation_id }}'
      operation_name: '{{ item.operation_name }}'
      properties: '{{ item.properties }}'
      status: '{{ item.status }}'
      sub_status: '{{ item.sub_status }}'
- discovery_id: azure.power.list_by_resource_group
  calls:
  - action: list_by_resource_group
    save_as: list_by_resource_group_response
  emit:
    items_for: '{{ list_by_resource_group_response.value }}'
    as: item
    item:
      id: '{{ item.id }}'
      name: '{{ item.name }}'
      type: '{{ item.type }}'
      location: '{{ item.location }}'
      tags: '{{ item.tags }}'
      scopes: '{{ item.scopes }}'
      condition: '{{ item.condition }}'
      actions: '{{ item.actions }}'
      enabled: '{{ item.enabled }}'
      description: '{{ item.description }}'
- discovery_id: azure.purview.list_by_resource_group
  calls:
  - action: list_by_resource_group
    save_as: list_by_resource_group_response
  emit:
    items_for: '{{ list_by_resource_group_response.value }}'
    as: item
    item:
      id: '{{ item.id }}'
      name: '{{ item.name }}'
      type: '{{ item.type }}'
      location: '{{ item.location }}'
      tags: '{{ item.tags }}'
      group_short_name: '{{ item.group_short_name }}'
      enabled: '{{ item.enabled }}'
      email_receivers: '{{ item.email_receivers }}'
      sms_receivers: '{{ item.sms_receivers }}'
      webhook_receivers: '{{ item.webhook_receivers }}'
      itsm_receivers: '{{ item.itsm_receivers }}'
      azure_app_push_receivers: '{{ item.azure_app_push_receivers }}'
      automation_runbook_receivers: '{{ item.automation_runbook_receivers }}'
      voice_receivers: '{{ item.voice_receivers }}'
      logic_app_receivers: '{{ item.logic_app_receivers }}'
      azure_function_receivers: '{{ item.azure_function_receivers }}'
      arm_role_receivers: '{{ item.arm_role_receivers }}'
      event_hub_receivers: '{{ item.event_hub_receivers }}'
- discovery_id: azure.redis.list_by_resource_group
  calls:
  - action: list_by_resource_group
    save_as: list_by_resource_group_response
  emit:
    items_for: '{{ list_by_resource_group_response.value }}'
    as: item
    item:
      id: '{{ item.id }}'
      name: '{{ item.name }}'
      type: '{{ item.type }}'
      location: '{{ item.location }}'
      tags: '{{ item.tags }}'
      group_short_name: '{{ item.group_short_name }}'
      enabled: '{{ item.enabled }}'
      email_receivers: '{{ item.email_receivers }}'
      sms_receivers: '{{ item.sms_receivers }}'
      webhook_receivers: '{{ item.webhook_receivers }}'
      itsm_receivers: '{{ item.itsm_receivers }}'
      azure_app_push_receivers: '{{ item.azure_app_push_receivers }}'
      automation_runbook_receivers: '{{ item.automation_runbook_receivers }}'
      voice_receivers: '{{ item.voice_receivers }}'
      logic_app_receivers: '{{ item.logic_app_receivers }}'
      azure_function_receivers: '{{ item.azure_function_receivers }}'
      arm_role_receivers: '{{ item.arm_role_receivers }}'
      event_hub_receivers: '{{ item.event_hub_receivers }}'
- discovery_id: azure.search.list_by_resource_group
  calls:
  - action: list_by_resource_group
    save_as: list_by_resource_group_response
  emit:
    items_for: '{{ list_by_resource_group_response.value }}'
    as: item
    item:
      id: '{{ item.id }}'
      name: '{{ item.name }}'
      type: '{{ item.type }}'
      location: '{{ item.location }}'
      tags: '{{ item.tags }}'
      group_short_name: '{{ item.group_short_name }}'
      enabled: '{{ item.enabled }}'
      email_receivers: '{{ item.email_receivers }}'
      sms_receivers: '{{ item.sms_receivers }}'
      webhook_receivers: '{{ item.webhook_receivers }}'
      itsm_receivers: '{{ item.itsm_receivers }}'
      azure_app_push_receivers: '{{ item.azure_app_push_receivers }}'
      automation_runbook_receivers: '{{ item.automation_runbook_receivers }}'
      voice_receivers: '{{ item.voice_receivers }}'
      logic_app_receivers: '{{ item.logic_app_receivers }}'
      azure_function_receivers: '{{ item.azure_function_receivers }}'
      arm_role_receivers: '{{ item.arm_role_receivers }}'
      event_hub_receivers: '{{ item.event_hub_receivers }}'
checks:
- rule_id: azure.billing.savings_plan.cost_admins_mfa_required
  for_each: azure.billing.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.billing.reservation.cost_admins_mfa_required
  for_each: azure.billing.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.billing.savings_plan.cost_approval_workflow_required
  for_each: azure.billing.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.billing.reservation.cost_purchase_permissions_restricted
  for_each: azure.billing.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.billing.savings_plan.cost_purchase_permissions_restricted
  for_each: azure.billing.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.billing.reservation.cost_approval_workflow_required
  for_each: azure.billing.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.cost.management_category.access_billing_console_rbac_least_privilege
  for_each: azure.cost.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.cost.management_budget.budget_alert_destinations_configured
  for_each: azure.cost.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.cost.management_allocation_rule.allocation_cost_tag_policy_enforced
  for_each: azure.cost.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.cost.management_allocation_rule.allocation_required_cost_tags_present
  for_each: azure.cost.list_by_resource_group
  conditions:
    var: item.tags
    op: exists
- rule_id: azure.cost.management_budget.budget_budgets_defined_for_accounts_or_projects
  for_each: azure.cost.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.cost.management_category.access_cost_data_exports_private_and_encrypted
  for_each: azure.cost.list_by_resource_group
  conditions:
    var: item.type
    op: exists
- rule_id: azure.cost.management_category.access_billing_admins_mfa_required
  for_each: azure.cost.list_by_resource_group
  conditions:
    var: item.type
    op: exists
- rule_id: azure.cost.management_anomaly.anomaly_severity_thresholds_configured
  for_each: azure.cost.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.cost.management_budget.budget_modify_permissions_restricted
  for_each: azure.cost.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.cost.management_allocation_rule.allocation_untagged_resource_alerts_enabled
  for_each: azure.cost.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.cost.management_category.access_cost_export_destinations_least_privilege
  for_each: azure.cost.list_by_resource_group
  conditions:
    var: item.type
    op: exists
- rule_id: azure.cost.management_anomaly.anomaly_detectors_enabled
  for_each: azure.cost.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.cost.management_budget.budget_alert_thresholds_configured
  for_each: azure.cost.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.cost.management_anomaly.anomaly_alert_destinations_configured
  for_each: azure.cost.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_job.datalake_crawler_scope_restricted_to_allowlist
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_classifier.datalake_classifier_source_trusted
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.factory_pipeline_parameter.pipeline_parameter_max_length_defined_where_applicable
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_quality.datalake_quality_role_least_privilege
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.data.factory_pipeline_parameter.pipeline_parameter_constraint_allowlist_defined_when_applicable
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.factory_dataset.pipeline_object_environment_no_plaintext_secrets
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_job.datalake_job_script_location_private_and_encrypted
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.location
    op: exists
- rule_id: azure.data.factory_pipeline_parameter.pipeline_parameter_constraint_min_length_defined_when_applicable
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_schema.datalake_schema_rbac_least_privilege
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.data.lake_analytics_compute_policy.datalake_dev_endpoint_role_least_privilege
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.data.lake_analytics_job.datalake_job_network_private_only
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_catalog.datalake_catalog_rbac_least_privilege
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.data.factory_dataset.pipeline_object_network_private_only
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_ml_transform.datalake_ml_transform_network_private_only
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_workflow.datalake_workflow_kms_encryption_enabled
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_quality.datalake_quality_output_location_private_and_encrypted
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.location
    op: exists
- rule_id: azure.data.factory_pipeline_parameter.pipeline_parameter_type_set
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.type
    op: exists
- rule_id: azure.data.lake_analytics_job.datalake_crawler_network_private_only
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.factory_pipeline_parameter.pipeline_parameter_default_not_sensitive
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_compute_policy.datalake_dev_endpoint_no_public_access
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.data.lake_analytics_ml_transform.datalake_ml_transform_logs_enabled
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_partition.datalake_partition_catalog_encrypted
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.logic_app_receivers
    op: exists
- rule_id: azure.data.stream_analytics_job.streaming_analytics_checkpoints_and_outputs_encrypted
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_classifier.datalake_classifier_rbac_least_privilege
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.data.lake_analytics_workflow.datalake_workflow_execution_role_least_privilege
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.data.lake_analytics_catalog.datalake_catalog_cross_account_sharing_restricted
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.logic_app_receivers
    op: exists
- rule_id: azure.data.factory_pipeline.pipeline_pipeline_artifacts_private_and_encrypted
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_job.datalake_job_role_least_privilege
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.data.lake_analytics_connection.datalake_connection_credentials_in_secrets_manager
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.stream_analytics.logging_enabled
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.factory_pipeline.pipeline_pipeline_execution_roles_least_privilege
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.data.lake_analytics_ml_transform.datalake_ml_transform_role_least_privilege
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.data.factory_pipeline_parameter.pipeline_parameter_constraint_pattern_defined_when_applicable
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.factory_pipeline_parameter.pipeline_parameter_metadata_disallowed_attribute_keys_blocked
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.tags
    op: exists
- rule_id: azure.data.factory_dataset.pipeline_object_logging_enabled
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.factory_pipeline_parameter.pipeline_parameter_binding_secret_refs_resolved_at_runtime
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.factory_pipeline_parameter.pipeline_parameter_allowed_values_defined_where_applicable
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.media_stream.streaming_video_retention_days_minimum
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_job.datalake_crawler_role_least_privilege
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.data.factory_pipeline_parameter.pipeline_parameter_constraint_max_length_defined_when_applicable
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.factory_pipeline_parameter.pipeline_parameter_value_from_secrets_manager_when_sensitive
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_database.datalake_database_policy_least_privilege
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.data.lake_analytics_workflow.datalake_workflow_cross_account_trusts_restricted
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.factory_dataset.pipeline_object_execution_role_least_privilege
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.data.lake_analytics_compute_policy.datalake_dev_endpoint_encrypted
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.data.factory_pipeline.pipeline_pipeline_kms_encryption_enabled
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.factory_pipeline.pipeline_pipeline_private_networking_enforced
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_trigger.datalake_trigger_targets_least_privilege
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_registry.datalake_registry_cross_account_sharing_restricted
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_lineage.datalake_lineage_access_rbac_least_privilege
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.data.factory_pipeline_parameter.pipeline_parameter_metadata_sensitive_keys_require_secret_type
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.tags
    op: exists
- rule_id: azure.data.factory_pipeline_parameter.pipeline_parameter_attributes_no_plaintext_secrets
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.media_stream.streaming_video_encryption_at_rest_enabled
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_table.datalake_table_access_policies_least_privilege
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_registry.datalake_registry_rbac_least_privilege
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.data.stream_analytics.destination_least_privilege
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.media_stream.streaming_video_encryption_in_transit_required
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_trigger.datalake_trigger_event_sources_restricted
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.stream_analytics_job.streaming_analytics_network_private_only
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_schema.datalake_schema_version_immutability_enforced
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.factory_pipeline_parameter.pipeline_parameter_binding_sensitive_params_not_logged
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.logic_app_receivers
    op: exists
- rule_id: azure.data.lake_analytics_schema.datalake_schema_encrypted
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.factory_pipeline_parameter.pipeline_parameter_min_length_defined_where_applicable
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_partition.datalake_partition_access_policies_least_privilege
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.factory_pipeline_parameter.pipeline_parameter_metadata_values_not_plaintext_secret
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.tags
    op: exists
- rule_id: azure.data.factory_pipeline_run.analytics_snapshot_encrypted_at_rest_cmek
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_database.datalake_database_encrypted
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.factory_pipeline_parameter.pipeline_parameter_binding_only_expected_params_bound
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_registry.datalake_registry_metaencryption_enabled
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.stream_analytics.destination_encrypted
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_classifier.datalake_classifier_definition_version_pinned
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.factory_pipeline_run.analytics_snapshot_not_publicly_shared
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_lineage.datalake_lineage_export_destination_encrypted
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.factory_pipeline.pipeline_definition_version_immutability_enforced
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_job.datalake_crawler_logs_enabled
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_table.datalake_table_public_sharing_disabled
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.factory_pipeline.pipeline_definition_storage_private
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_catalog.datalake_catalog_metaencryption_enabled
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_lineage.datalake_lineage_capture_enabled
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.factory_pipeline.pipeline_definition_signed_and_verified
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_connection.datalake_connection_tls_required
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_catalog.datalake_catalog_audit_logging_enabled
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_table.datalake_table_encrypted
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.stream_analytics_job.streaming_analytics_role_least_privilege
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.data.lake_analytics_trigger.datalake_trigger_logs_enabled
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.factory_pipeline_run.analytics_snapshot_kms_key_policy_least_privilege
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.data.factory_pipeline_parameter.pipeline_parameter_pattern_defined_where_applicable
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_quality.datalake_quality_logs_enabled
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_connection.datalake_connection_role_least_privilege
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.data.lake_analytics_database.datalake_database_cross_account_sharing_restricted
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.factory_pipeline.pipeline_pipeline_logs_and_metrics_enabled
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.factory_pipeline.pipeline_definition_storage_encrypted
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_job.datalake_job_logs_and_metrics_enabled
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_connection.datalake_connection_private_networking_enforced
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.data.lake_analytics_table.datalake_table_column_level_access_controls_enabled
  for_each: azure.data.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.devops.project.source.repo.url.no.sensitive.credentials,.azure.devops.project.no.secrets.in.variables
  for_each: azure.devops.list_by_resource_group
  conditions:
    var: item.description
    op: not_contains
    value:
    - http://
    - https://
- rule_id: azure.intune.diagnostic.settings.log.analytics.check
  for_each: azure.intune.list_by_resource_group
  conditions:
    var: item.actions
    op: not_empty
- rule_id: azure.iot.hub.defender.for.iot.status.check
  for_each: azure.iot.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.monitor.log.multi_region_enabled
  for_each: azure.log.list_by_resource_group
  conditions:
    var: item.location
    op: contains
    value: ','
- rule_id: azure.monitor.log.enabled
  for_each: azure.log.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.log.file_validation_enabled
  for_each: azure.log.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.logging_store.access_rbac_least_privilege
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.scopes
    op: not_empty
- rule_id: azure.monitor.activity.log.alert.create.or.update.public.ip.address
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.condition
    op: not_empty
- rule_id: azure.monitor.sampling_rule.access_rbac_least_privilege
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.scopes
    op: not_empty
- rule_id: azure.monitor.logging_log_stream.logging_stream_encryption_at_rest_enabled
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.log.file_integrity_enabled
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.activity.log.alert.delete.policy.assignment.exists
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.actions
    op: not_empty
- rule_id: azure.monitor.log_analytics_workspace.logging_destination_tls_min_1_2_enforced
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.condition
    op: contains
    value: TLS1_2
- rule_id: azure.monitor.alert.delete_public_ip
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.condition
    op: not_empty
- rule_id: azure.monitor.action_group.incident_notification_endpoints_authenticated
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.actions
    op: not_empty
- rule_id: azure.monitor.admin.account.usage.check
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.logging_sink.destination_encrypted
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.description
    op: contains
    value: encrypted
- rule_id: azure.monitor.alert_rule.dr_monitoring_alert_destinations_configured
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.actions
    op: not_empty
- rule_id: azure.monitor.alert.create_update_public_ip
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.condition
    op: contains
    value: PublicIpAddress
- rule_id: azure.monitor.group.kms_encryption_enabled
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.dashboard.public_embeds_disabled
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: false
- rule_id: azure.monitor.log.metric.filter.policy.changes,.azure.active.directory.password.policy.reuse.24,.azure.active.directory.user.accesskey.unused,.azure.active.directory.user.console.access.unused
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.condition
    op: not_empty
- rule_id: azure.monitor.action_group.incident_notification_destinations_configured
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.actions
    op: not_empty
- rule_id: azure.monitor.activity.log.alert.sql.server.firewall.rule.exists
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.actions
    op: not_empty
- rule_id: azure.monitor.vm.cpu_alerts
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.network.route_tables_alarm_configured
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.actions
    op: not_empty
- rule_id: azure.monitor.action_group.incident_escalation_change_audit_logging_enabled
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.action_group.incident_notification_no_public_webhooks
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.actions
    op: not_contains
    value: public_webhook
- rule_id: azure.monitor.action_group.incident_escalation_policy_exists_for_critical_severity
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.actions
    op: not_empty
- rule_id: azure.monitor.diagnostic.settings_exists
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.description
    op: not_empty
- rule_id: azure.monitor.alert.create_update_sqlserver_fr
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.alert.delete_sqlserver_fr
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.actions
    op: not_empty
- rule_id: azure.monitor.alert.vnet_changes_configured
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.condition
    op: not_empty
- rule_id: azure.monitor.log.group.retention.policy.specific.days.enabled,.azure.storage.bucket.lifecycle.enabled
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.logging_log_stream.logging_stream_ingestion_auth_required
  for_each: azure.monitor.list
  conditions:
    var: item.authorization
    op: not_empty
- rule_id: azure.monitor.log.multi_region_enabled
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.location
    op: contains
    value: ','
- rule_id: azure.monitor.alert.capacity_alerts_configured
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.condition
    op: not_empty
- rule_id: azure.monitor.alert.alarm_configured
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.vm.memory_alerts
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.condition
    op: not_empty
- rule_id: azure.monitor.resource.logging.enabled.check
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.log.metric_filter_alarm_configured
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.condition
    op: not_empty
- rule_id: azure.monitor.policy.specific_days_enabled
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.log.kms_encryption_enabled
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.logging_sink.cross_account_destinations_restricted
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.scopes
    op: not_empty
- rule_id: azure.monitor.dashboard.sso_required
  for_each: azure.monitor.list
  conditions:
    var: item.authorization
    op: contains
    value: SSO
- rule_id: azure.monitor.activity.log.alert.service.health.exists
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.description
    op: not_empty
- rule_id: azure.monitor.alert.create_update_nsg
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.actions
    op: not_empty
- rule_id: azure.monitor.activity.log.alert.sql.server.firewall.rule.deletion.check
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.condition
    op: not_empty
- rule_id: azure.monitor.anomaly_detector.anomaly_detectors_enabled
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.logging_store.encryption_at_rest_cmek
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.description
    op: contains
    value: encryption at rest cmek
- rule_id: azure.monitor.network.acls_alarm_configured
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.actions
    op: not_empty
- rule_id: azure.monitor.paas_app.logging_enabled
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.alert.delete_security_solution
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.metric_alert.logging_metric_filter_kms_key_deletion_or_disable_detected_filter_present
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.condition
    op: not_empty
- rule_id: azure.monitor.metric_alert.logging_metric_filter_network_acl_or_sg_change_detected_filter_present
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.condition
    op: not_empty
- rule_id: azure.monitor.log.analysis_enabled
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.diagnostic.setting.categories.compliance.check
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.activity.log.alert.delete.nsg.exists
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.description
    op: contains
    value: delete nsg
- rule_id: azure.monitor.alert.destinations_authenticated
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.actions
    op: not_empty
- rule_id: azure.monitor.anomaly_detector.anomaly_alerts
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.activity.log.alert.exists.delete.security.solution
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.description
    op: contains
    value: delete security solution
- rule_id: azure.monitor.alert.create_update_security_solution
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.metric.filter.root.usage
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.condition
    op: not_empty
- rule_id: azure.monitor.network.gateways_alarm_configured
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.metrics.data_analytics_monitoring_query_access_logging_enabled
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.dashboard.sharing_restricted_to_org
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.scopes
    op: contains
    value: organization
- rule_id: azure.monitor.alert_rule.dr_monitoring_alerts_for_rpo_rto_breach_configured
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.description
    op: contains
    value: RPO RTO breach
- rule_id: azure.monitor.policy.assignment
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.log_analytics_workspace.logging_destination_iam_policy_least_privilege
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.actions
    op: not_empty
- rule_id: azure.monitor.logging_log_stream.logging_stream_retention_days_minimum
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.description
    op: contains
    value: retention
- rule_id: azure.monitor.logging_store.immutability_or_object_lock_where_supported
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.activity.log.alert.public.ip.delete.check
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.condition
    op: not_empty
- rule_id: azure.monitor.activity.log.alert.nsg.operation.condition.check
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.condition
    op: not_empty
- rule_id: azure.monitor.storage.read_events_enabled
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.metric_alert.logging_metric_filter_console_root_login_detected_filter_present
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.description
    op: contains
    value: console root login detected
- rule_id: azure.monitor.sampling_rule.storage_encrypted
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.trace.retention_days_minimum
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.description
    op: not_empty
- rule_id: azure.monitor.trace.access_rbac_least_privilege
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.scopes
    op: not_empty
- rule_id: azure.monitor.alert.critical_alarms_enabled
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.logging_store.retention_days_minimum
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.description
    op: not_empty
- rule_id: azure.monitor.log.retention_configured
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.storage.account_with_activity_logs_cmk_encrypted
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.description
    op: contains
    value: CMK Encrypted
- rule_id: azure.monitor.trace.store_encrypted
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.diagnostic.settings.compliance.check
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.action_group.incident_notification_message_encryption_in_transit
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.actions
    op: not_empty
- rule_id: azure.monitor.alert_rule.dr_monitoring_alerts_for_backup_failures_configured
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.description
    op: contains
    value: backup failure
- rule_id: azure.monitor.alert.alarm_actions
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.actions
    op: not_empty
- rule_id: azure.monitor.storage.write_events_enabled
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.log.logging_enabled
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.logging_query_definition.access_rbac_least_privilege
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.scopes
    op: not_empty
- rule_id: azure.monitor.logging_query_definition.storage_encrypted
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.sampling_rule.rules_present
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.condition
    op: not_empty
- rule_id: azure.monitor.log_analytics_workspace.logging_destination_endpoint_private_networking
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.logging_sink.destination_least_privilege
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.scopes
    op: not_empty
- rule_id: azure.monitor.activity.log.alert.policy.assignment.check
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.diagnostic.setting_appropriate_categories
  for_each: azure.monitor.list
  conditions:
    var: item.category
    op: not_empty
- rule_id: azure.monitor.action_group.incident_escalation_oncall_contacts_verified
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.actions
    op: not_empty
- rule_id: azure.monitor.metrics.data_analytics_monitoring_logs_retention_days_minimum
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.description
    op: contains
    value: retention
- rule_id: azure.monitor.activity.log.alert.security.solution.update.check
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.metrics.data_analytics_monitoring_admin_activity_logging_enabled
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.storage.account_with_activity_logs_is_private
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.tags
    op: contains
    value: private
- rule_id: azure.monitor.alert.delete_nsg
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.actions
    op: not_empty
- rule_id: azure.monitor.application.insights.configuration.check
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.metric_alert.logging_metric_filter_iam_policy_change_detected_filter_present
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.description
    op: contains
    value: IAM Policy Change Detected
- rule_id: azure.monitor.vulnerability_automation.vuln_automation_change_audit_logging_enabled
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.monitor.anomaly_detector.anomaly_training_data_sources_approved
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.scopes
    op: not_empty
- rule_id: azure.monitor.alert_rule.dr_monitoring_alerts_for_replication_lag_configured
  for_each: azure.monitor.list_by_resource_group
  conditions:
    var: item.condition
    op: not_empty
- rule_id: azure.power.bi_user.data_analytics_user_roles_minimal
  for_each: azure.power.list_by_resource_group
  conditions:
    var: item.scopes
    op: not_empty
- rule_id: azure.power.bi_user.data_analytics_user_sso_required
  for_each: azure.power.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.power.bi_dataset.data_analytics_dataset_public_sharing_disabled
  for_each: azure.power.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: false
- rule_id: azure.power.bi_dataset.data_analytics_dataset_access_policies_least_privilege
  for_each: azure.power.list_by_resource_group
  conditions:
    var: item.scopes
    op: not_empty
- rule_id: azure.power.bi_dashboard.data_analytics_dashboard_public_embeds_disabled
  for_each: azure.power.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: false
- rule_id: azure.power.bi_dashboard.data_analytics_dashboard_sharing_restricted_to_org
  for_each: azure.power.list_by_resource_group
  conditions:
    var: item.scopes
    op: contains
    value: organization
- rule_id: azure.power.bi_dashboard.data_analytics_dashboard_export_controls_enabled
  for_each: azure.power.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.power.bi_dataset.data_analytics_dataset_row_level_security_enabled
  for_each: azure.power.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.power.bi_user.data_analytics_user_external_user_access_reviewed
  for_each: azure.power.list_by_resource_group
  conditions:
    var: item.description
    op: contains
    value: external user access reviewed
- rule_id: azure.power.bi_dataset.data_analytics_dataset_encrypted_at_rest_cmek
  for_each: azure.power.list_by_resource_group
  conditions:
    var: item.description
    op: contains
    value: encrypted at rest cmek
- rule_id: azure.power.bi_workspace.data_analytics_group_external_group_sharing_restricted
  for_each: azure.power.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: false
- rule_id: azure.power.bi_dashboard.data_analytics_dashboard_sso_required
  for_each: azure.power.list_by_resource_group
  conditions:
    var: item.enabled
    op: equals
    value: true
- rule_id: azure.power.bi_workspace.data_analytics_group_roles_minimal
  for_each: azure.power.list_by_resource_group
  conditions:
    var: item.actions
    op: not_empty
- rule_id: azure.purview.breach_detection.alert_destinations
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality.data_governance_quality_logs_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.schema.lineage_version_immutability_enforced
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.rule.lineage_source_trusted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_rule.data_quality_recommendation_run_metadata_logging_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ruleset.lineage_encrypted_at_rest
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality.data_catalog_logs_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.connection.lineage_private_networking_enforced
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ml_transform.lineage_network_private_only
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.audit_log.retention_days_minimum
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.compliance.data_governance_reports_storage_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.trigger.data_catalog_targets_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.classification.data_governance_auto_classification_enabled_where_supported
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.database.lineage_policy_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.schema.data_catalog_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.database.lineage_cross_account_sharing_restricted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.data_governance_change_audit_logging_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.breach_detection.integrations_authenticated
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.registry.lineage_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.schema.data_catalog_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality.lineage_output_location_private_and_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.governance.data_policy_admin_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.lifecycle.data_governance_expiration_rules_defined
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.audit_log.logs_centralized_and_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.workflow.data_catalog_cross_account_trusts_restricted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_ruleset.version_immutable
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.job.lineage_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality.data_governance_quality_jobs_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.connection.data_catalog_tls_required
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.connection.data_catalog_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_rule.definition_version_pinned
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.job.data_catalog_script_location_private_and_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ml_transform.data_catalog_network_private_only
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.governance.data_policy_admin_change_audit_logging_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.classifier.lineage_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.classifier.data_catalog_source_trusted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.connection.lineage_tls_required
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.trigger.data_catalog_event_sources_restricted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.classifier.lineage_source_trusted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ruleset.lineage_version_pinned
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.governance.data_policy_admin_mfa_required
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.data_catalog_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ml_transform.lineage_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.partition.lineage_catalog_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.registry.lineage_cross_account_sharing_restricted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.table.lineage_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_rule.data_quality_recommendation_run_logs_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.partition.lineage_access_policies_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.data_catalog_cross_account_sharing_restricted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_rule.data_quality_recommendation_run_output_encrypted_private
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.connection.lineage_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.workflow.lineage_cross_account_trusts_restricted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.database.data_catalog_cross_account_sharing_restricted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.database.lineage_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.scan.data_catalog_crawler_scope_restricted_to_allowlist
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.schema.lineage_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality.data_catalog_output_location_private_and_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.classification.data_governance_policy_blocks_public_for_sensitive
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.lifecycle.data_governance_versioning_enabled_where_supported
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.workflow.data_catalog_execution_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_rule.data_quality_recommendation_run_execution_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality.lineage_logs_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.schema.lineage_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.job.lineage_network_private_only
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.trigger.lineage_targets_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.registry.data_catalog_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ml_transform.data_catalog_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.scan.lineage_crawler_logs_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ruleset.data_catalog_version_pinned
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ml_transform.data_catalog_logs_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_policy.workflow_storage_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.classification.data_governance_required_sensitivity_tags_present
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.job.lineage_logs_and_metrics_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.trigger.lineage_event_sources_restricted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_rule.source_trusted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.registry.lineage_metadata_encryption_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.lineage_cross_account_sharing_restricted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.lineage_audit_logging_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.job.data_catalog_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.connection.data_catalog_private_networking_enforced
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.compliance.data_governance_access_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.connection.lineage_credentials_in_secrets_manager
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.classifier.data_catalog_definition_version_pinned
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.database.data_catalog_policy_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.data_governance_update_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_policy.execution_roles_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.database.data_catalog_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.scan.lineage_crawler_network_private_only
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_rule.data_quality_recommendation_outputs_encrypted_and_private
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.trigger.data_catalog_logs_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.lineage.data_governance_access_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_masking.policies_present_for_sensitive_fields
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.data_catalog_audit_logging_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality.lineage_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ruleset.data_catalog_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.table.data_catalog_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ml_transform.lineage_logs_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_ruleset.rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.connection.data_catalog_credentials_in_secrets_manager
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ruleset.data_catalog_encrypted_at_rest
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality.data_catalog_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.data_governance_cross_account_sharing_review_required
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.scan.data_catalog_crawler_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.lineage.data_governance_capture_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality.data_governance_quality_outputs_encrypted_and_private
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.classifier.data_catalog_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.workflow.lineage_execution_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.compliance.data_governance_export_destinations_private
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.scan.lineage_crawler_scope_restricted_to_allowlist
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.lifecycle.data_governance_immutable_retention_locked_where_required
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.table.lineage_public_sharing_disabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.schema.data_catalog_version_immutability_enforced
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.rule.lineage_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.ruleset.lineage_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.retention_policy.data_governance_retention_policies_defined
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.scan.lineage_crawler_role_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.retention_policy.data_governance_retention_protected_from_public_override
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.job.data_catalog_network_private_only
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_masking.execution_roles_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.job.data_catalog_logs_and_metrics_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.job.lineage_script_location_private_and_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_rule.parameters_no_plaintext_secrets
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.lineage.data_governance_export_destination_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.data_catalog_metadata_encryption_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.registry.data_catalog_cross_account_sharing_restricted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.partition.data_catalog_access_policies_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.workflow.data_catalog_kms_encryption_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.trigger.lineage_logs_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.lineage_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_ruleset.encrypted_at_rest
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.registry.data_catalog_metadata_encryption_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.scan.data_catalog_crawler_logs_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.catalog.lineage_store_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.workflow.lineage_kms_encryption_enabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.table.lineage_access_policies_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.table.data_catalog_public_sharing_disabled
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.id
    op: exists
- rule_id: azure.purview.data_quality_rule.data_quality_recommendation_access_rbac_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.purview.table.data_catalog_access_policies_least_privilege
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.logic_app_receivers
    op: exists
- rule_id: azure.purview.retention_policy.data_governance_retention_enforced_on_sensitive_datasets
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.arm_role_receivers
    op: exists
- rule_id: azure.purview.scan.data_catalog_crawler_network_private_only
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.logic_app_receivers
    op: exists
- rule_id: azure.purview.partition.data_catalog_catalog_encrypted
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.logic_app_receivers
    op: exists
- rule_id: azure.purview.rule.lineage_definition_version_pinned
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.purview.classifier.lineage_definition_version_pinned
  for_each: azure.purview.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.redis.minimum.tls.version.check
  for_each: azure.redis.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.cache.redis.microsoft.entra.authentication.enabled
  for_each: azure.redis.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.cache.redis.ssl.only.access
  for_each: azure.redis.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.cache.redis.public.network.access.disabled
  for_each: azure.redis.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.redis.cache.system.assigned.identity.check
  for_each: azure.redis.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.search.service.domains_encryption_at_rest_enabled
  for_each: azure.search.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.search.service.domains_access_control_enabled
  for_each: azure.search.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.search.service.domains_node_to_node_encryption_enabled
  for_each: azure.search.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.aisearch.service.not_publicly_accessible
  for_each: azure.search.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
- rule_id: azure.search.service.domains_logging_enabled
  for_each: azure.search.list_by_resource_group
  conditions:
    var: item.enabled
    op: exists
