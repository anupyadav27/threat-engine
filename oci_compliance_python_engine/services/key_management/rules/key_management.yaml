key_management:
  version: '1.0'
  provider: oci
  service: key_management
  scope: regional
  discovery: []
  checks:
  - check_id: oci.key_management.vault.secrets_security_kms_default_keys_disabled_required
    title: 'OCI KEY_MANAGEMENT Vault: Secrets Security KMS Default Keys Disabled Required'
    severity: high
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.vault.secrets_security_kms_logging_enabled
    title: 'OCI KEY_MANAGEMENT Vault: Secrets Security KMS Logging Enabled'
    severity: high
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.vault.hsm_configuration_present
    title: 'OCI KEY_MANAGEMENT Vault: Hsm Configuration Present'
    severity: medium
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.key.hsm_keys_in_only
    title: 'OCI KEY_MANAGEMENT Key: Hsm Keys In Only'
    severity: high
    for_each: list_keys
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.vault.hsm_only_approved_endpoints
    title: 'OCI KEY_MANAGEMENT Vault: Hsm Only Approved Endpoints'
    severity: medium
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.key.hsm_client_cert_key_length_minimum
    title: 'OCI KEY_MANAGEMENT Key: Hsm Client Cert Key Length Minimum'
    severity: high
    for_each: list_keys
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.vault.hsm_client_cert_not_expired
    title: 'OCI KEY_MANAGEMENT Vault: Hsm Client Cert Not Expired'
    severity: medium
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.vault.hsm_client_cert_trusted_issuer
    title: 'OCI KEY_MANAGEMENT Vault: Hsm Client Cert Trusted Issuer'
    severity: medium
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.key.secrets_security_cmk_deletion_requires_waiting_period_enabled
    title: 'OCI KEY_MANAGEMENT Key: Secrets Security CMK Deletion Requires Waiting Period Enabled'
    severity: high
    for_each: list_keys
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.key.secrets_security_cmk_not_publicly_accessible_enabled
    title: 'OCI KEY_MANAGEMENT Key: Secrets Security CMK Not Publicly Accessible Enabled'
    severity: critical
    for_each: list_keys
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.key.secrets_security_cmk_policy_least_privilege_enabled_enforced
    title: 'OCI KEY_MANAGEMENT Key: Secrets Security CMK Policy Least Privilege Enabled Enforced'
    severity: high
    for_each: list_keys
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.vault.secrets_security_cmk_rotation_enabled
    title: 'OCI KEY_MANAGEMENT Vault: Secrets Security CMK Rotation Enabled'
    severity: high
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.vault.encryption_cmek_enabled
    title: 'OCI KEY_MANAGEMENT Vault: Encryption Cmek Enabled'
    severity: high
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.vault.tls_min_1_2_enabled
    title: 'OCI KEY_MANAGEMENT Vault: TLS Min 1 2 Enabled'
    severity: medium
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.key.secrets_security_secret_cmk_enabled
    title: 'OCI KEY_MANAGEMENT Key: Secrets Security Secret CMK Enabled'
    severity: high
    for_each: list_keys
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.key.secrets_security_secret_no_plaintext_exposed_tags
    title: 'OCI KEY_MANAGEMENT Key: Secrets Security Secret No Plaintext Exposed Tags'
    severity: critical
    for_each: list_keys
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.key.secrets_security_secret_rotation_configured_where_applicable
    title: 'OCI KEY_MANAGEMENT Key: Secrets Security Secret Rotation Configured Where Applicable'
    severity: high
    for_each: list_keys
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.key.secrets_security_store_access_rbac_least_privilege_required
    title: 'OCI KEY_MANAGEMENT Key: Secrets Security Store Access RBAC Least Privilege Required'
    severity: high
    for_each: list_keys
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.vault.secrets_security_store_kms_encryption_enabled
    title: 'OCI KEY_MANAGEMENT Vault: Secrets Security Store KMS Encryption Enabled'
    severity: high
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.vault.secrets_security_store_rotation_enabled_for_rotatable
    title: 'OCI KEY_MANAGEMENT Vault: Secrets Security Store Rotation Enabled For Rotatable'
    severity: high
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.key.secrets_security_alias_points_to_active_key
    title: 'OCI KEY_MANAGEMENT Key: Secrets Security Alias Points To Active Key'
    severity: high
    for_each: list_keys
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.key.secrets_security_alias_key_has
    title: 'OCI KEY_MANAGEMENT Key: Secrets Security Alias Key Has'
    severity: high
    for_each: list_keys
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.key.secrets_security_kms_grant_constraints_enabled
    title: 'OCI KEY_MANAGEMENT Key: Secrets Security KMS Grant Constraints Enabled'
    severity: high
    for_each: list_keys
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.key.secrets_security_kms_grant_grantee_principal_valid_enabled
    title: 'OCI KEY_MANAGEMENT Key: Secrets Security KMS Grant Grantee Principal Valid Enabled'
    severity: high
    for_each: list_keys
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.key.secrets_security_kms_grant_lessthan_wildcard_permissions_enabled
    title: 'OCI KEY_MANAGEMENT Key: Secrets Security KMS Grant Lessthan Wildcard Permissions Enabled'
    severity: high
    for_each: list_keys
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.vault.logging_enabled
    title: 'OCI KEY_MANAGEMENT Vault: Logging Enabled'
    severity: medium
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.vault.private_endpoints
    title: 'OCI KEY_MANAGEMENT Vault: Private Endpoints'
    severity: low
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.key.cmk_rotation_enabled
    title: 'OCI KEY_MANAGEMENT Key: CMK Rotation Enabled'
    severity: medium
    for_each: list_keys
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.key.key_cmk_rotation_annual_compliance
    title: 'OCI KEY_MANAGEMENT Key: Key CMK Rotation Annual Compliance'
    severity: high
    for_each: list_keys
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.key.key_not_scheduled_for_deletion
    title: 'OCI KEY_MANAGEMENT Key: Key Not Scheduled For Deletion'
    severity: high
    for_each: list_keys
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.vault.cmk_rotation_enabled
    title: 'OCI KEY_MANAGEMENT Vault: CMK Rotation Enabled'
    severity: medium
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.vault.key_expiration_set
    title: 'OCI KEY_MANAGEMENT Vault: Key Expiration Set'
    severity: high
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.vault.key_lifecycle_policy
    title: 'OCI KEY_MANAGEMENT Vault: Key Lifecycle Policy'
    severity: high
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.vault.key_rotation_enabled
    title: 'OCI KEY_MANAGEMENT Vault: Key Rotation Enabled'
    severity: high
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.key.key_public_access_blocked
    title: 'OCI KEY_MANAGEMENT Key: Key Public Access Blocked'
    severity: critical
    for_each: list_keys
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.key.key_rotation_enabled
    title: 'OCI KEY_MANAGEMENT Key: Key Rotation Enabled'
    severity: high
    for_each: list_keys
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.vault.cmk_are_used
    title: 'OCI KEY_MANAGEMENT Vault: CMK Are Used'
    severity: medium
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.vault.cmk_not_deleted_unintentionally
    title: 'OCI KEY_MANAGEMENT Vault: CMK Not Deleted Unintentionally'
    severity: medium
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.vault.cmk_not_multi_region
    title: 'OCI KEY_MANAGEMENT Vault: CMK Not Multi Region'
    severity: medium
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.vault.key_public_access_blocked
    title: 'OCI KEY_MANAGEMENT Vault: Key Public Access Blocked'
    severity: critical
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.key_management.vault.secret_rotation_enabled
    title: 'OCI KEY_MANAGEMENT Vault: Secret Rotation Enabled'
    severity: high
    for_each: list_vaults
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
