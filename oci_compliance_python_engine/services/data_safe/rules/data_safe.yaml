data_safe:
  version: '1.0'
  provider: oci
  service: data_safe
  scope: regional
  discovery: []
  checks:
  - check_id: oci.data_safe.data_safe_configuration.compliance_access_rbac_least_privilege_required
    title: 'OCI DATA_SAFE Data_safe_configuration: Compliance Access RBAC Least Privilege Required'
    severity: high
    for_each: list_data_safe_configurations
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.data_safe.data_safe_configuration.compliance_export_destinations_private_enforced
    title: 'OCI DATA_SAFE Data_safe_configuration: Compliance Export Destinations Private Enforced'
    severity: low
    for_each: list_data_safe_configurations
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.data_safe.target_database.compliance_reports_storage_encrypted
    title: 'OCI DATA_SAFE Target_database: Compliance Reports Storage Encrypted'
    severity: medium
    for_each: list_target_databases
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.data_safe.data_safe_configuration.anonymization_jobs_private_networking_enforced
    title: 'OCI DATA_SAFE Data_safe_configuration: Anonymization Jobs Private Networking Enforced'
    severity: medium
    for_each: list_data_safe_configurations
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.data_safe.security_assessment.anonymization_outputs_encrypted
    title: 'OCI DATA_SAFE Security_assessment: Anonymization Outputs Encrypted'
    severity: medium
    for_each: list_security_assessments
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.data_safe.masking_policy.masking_execution_roles_least_privilege_required
    title: 'OCI DATA_SAFE Masking_policy: Masking Execution Roles Least Privilege Required'
    severity: high
    for_each: list_masking_policys
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.data_safe.masking_policy.masking_policies_present_for_sensitive_fields
    title: 'OCI DATA_SAFE Masking_policy: Masking Policies Present For Sensitive Fields'
    severity: medium
    for_each: list_masking_policys
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.data_safe.security_assessment.classification_auto_enabled
    title: 'OCI DATA_SAFE Security_assessment: Classification Auto Enabled'
    severity: medium
    for_each: list_security_assessments
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.data_safe.data_safe_configuration.classification_policy_blocks_public_for_sensitive_blocked
    title: 'OCI DATA_SAFE Data_safe_configuration: Classification Policy Blocks Public For Sensitive Blocked'
    severity: critical
    for_each: list_data_safe_configurations
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.data_safe.security_assessment.classification_required_sensitivity_tags_present
    title: 'OCI DATA_SAFE Security_assessment: Classification Required Sensitivity Tags Present'
    severity: medium
    for_each: list_security_assessments
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
