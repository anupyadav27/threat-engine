container_engine:
  version: '1.0'
  provider: oci
  service: container_engine
  scope: regional
  discovery:
  - discovery_id: list_clusters
    resource_type: cluster
    calls:
    - action: list
      client: ContainerEngineClient
      method: list_clusters
      fields:
      - path: id
        var: cluster_id
      - path: display_name
        var: display_name
      - path: lifecycle_state
        var: lifecycle_state
      - path: compartment_id
        var: compartment_id
  - discovery_id: get_cluster_details
    resource_type: cluster
    for_each: list_clusters
    calls:
    - action: get
      client: ContainerEngineClient
      method: get_cluster
      fields:
      - path: kms_key_id
        var: kms_key_id
      - path: options
        var: options
      - path: endpoint_config
        var: endpoint_config
  - discovery_id: list_node_pools
    resource_type: node_pool
    calls:
    - action: list
      client: ContainerEngineClient
      method: list_node_pools
      fields:
      - path: id
        var: node_pool_id
      - path: display_name
        var: display_name
      - path: lifecycle_state
        var: lifecycle_state
      - path: compartment_id
        var: compartment_id
  - discovery_id: get_node_pool_details
    resource_type: node_pool
    for_each: list_node_pools
    calls:
    - action: get
      client: ContainerEngineClient
      method: get_node_pool
      fields:
      - path: node_config_details
        var: node_config_details
      - path: ssh_public_key
        var: ssh_public_key
  checks:
  - check_id: oci.container_engine.cluster.cni_version_required
    title: 'OCI CONTAINER_ENGINE Cluster: Cni Version Required'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.kubelet_client_ca_file_configured
    title: 'OCI CONTAINER_ENGINE Cluster: Kubelet Client Ca File Configured'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cis_2_3_2_needs_development.cis_2_3_needs_development
    title: 'OCI CONTAINER_ENGINE Cis_2_3_2_needs_development: Cis 2 3 Needs Development'
    severity: low
    for_each: list_cis_2_3_2_needs_developments
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cis_3_2_10_needs_development.cis_3_2_10_needs_development
    title: 'OCI CONTAINER_ENGINE Cis_3_2_10_needs_development: Cis 3 2 10 Needs Development'
    severity: low
    for_each: list_cis_3_2_10_needs_developments
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cis_3_2_2_needs_development.cis_3_2_needs_development
    title: 'OCI CONTAINER_ENGINE Cis_3_2_2_needs_development: Cis 3 2 Needs Development'
    severity: low
    for_each: list_cis_3_2_2_needs_developments
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cis_5_4_4_needs_development.cis_5_4_needs_development
    title: 'OCI CONTAINER_ENGINE Cis_5_4_4_needs_development: Cis 5 4 Needs Development'
    severity: low
    for_each: list_cis_5_4_4_needs_developments
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.fargate_profile_execution_role_least_privilege_required
    title: 'OCI CONTAINER_ENGINE Cluster: Fargate Profile Execution Role Least Privilege Required'
    severity: high
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.fargate_profile_logging_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Fargate Profile Logging Enabled'
    severity: medium
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.fargate_profile_private_subnets_only_enforced
    title: 'OCI CONTAINER_ENGINE Cluster: Fargate Profile Private Subnets Only Enforced'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.addon.addon_from_trusted_channel
    title: 'OCI CONTAINER_ENGINE Addon: Addon From Trusted Channel'
    severity: low
    for_each: list_addons
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.addon.addon_no_privileged_permissions
    title: 'OCI CONTAINER_ENGINE Addon: Addon No Privileged Permissions'
    severity: high
    for_each: list_addons
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.addon.addon_version_pinned_and_supported_required
    title: 'OCI CONTAINER_ENGINE Addon: Addon Version Pinned And Supported Required'
    severity: low
    for_each: list_addons
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.admission_host_namespace_usage_denied
    title: 'OCI CONTAINER_ENGINE Cluster: Admission Host Namespace Usage Denied'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.admission_image_registry_allowlist_enforced
    title: 'OCI CONTAINER_ENGINE Cluster: Admission Image Registry Allowlist Enforced'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.admission_image_signature_verification_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Admission Image Signature Verification Enabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.admission_pod_security_restricted_default_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Admission Pod Security Restricted Default Enabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.admission_privilege_escalation_denied
    title: 'OCI CONTAINER_ENGINE Cluster: Admission Privilege Escalation Denied'
    severity: high
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.networkpolicy_default_deny_egress_per_namespace_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Networkpolicy Default Deny Egress Per Namespace Enabled'
    severity: medium
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.networkpolicy_default_deny_ingress_per_namespace_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Networkpolicy Default Deny Ingress Per Namespace Enabled'
    severity: medium
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.networkpolicy_required_allowlist_for_namespace_services
    title: 'OCI CONTAINER_ENGINE Cluster: Networkpolicy Required Allowlist For Namespace Services'
    severity: medium
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.apiserver_anonymous_auth_disabled
    title: 'OCI CONTAINER_ENGINE Cluster: Apiserver Anonymous Auth Disabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.apiserver_audit_logging_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Apiserver Audit Logging Enabled'
    severity: medium
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.apiserver_authorization_mode_rbac_enforced
    title: 'OCI CONTAINER_ENGINE Cluster: Apiserver Authorization Mode RBAC Enforced'
    severity: medium
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.apiserver_etcd_connection_encrypted
    title: 'OCI CONTAINER_ENGINE Cluster: Apiserver Etcd Connection Encrypted'
    severity: medium
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.apiserver_insecure_port_disabled
    title: 'OCI CONTAINER_ENGINE Cluster: Apiserver Insecure Port Disabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.apiserver_tls_min_1_2_enforced
    title: 'OCI CONTAINER_ENGINE Cluster: Apiserver TLS Min 1 2 Enforced'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.k8s_apiserver_admission_psa_enforce_mode.k8s_apiserver_admission_psa_enforce_mode
    title: 'OCI CONTAINER_ENGINE K8s_apiserver_admission_psa_enforce_mode: K8s Apiserver Admission Psa Enforce Mode'
    severity: low
    for_each: list_k8s_apiserver_admission_psa_enforce_modes
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.k8s_apiserver_anonymous_auth_disabled
    title: 'OCI CONTAINER_ENGINE Cluster: K8s Apiserver Anonymous Auth Disabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.k8s_apiserver_audit_logging_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: K8s Apiserver Audit Logging Enabled'
    severity: medium
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.k8s_apiserver_tls_min_version_1_2.k8s_apiserver_tls_min_version_1_2_required
    title: 'OCI CONTAINER_ENGINE K8s_apiserver_tls_min_version_1_2: K8s Apiserver TLS Min Version 1 2 Required'
    severity: low
    for_each: list_k8s_apiserver_tls_min_version_1_2s
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.controller_manager_root_ca_file_configured
    title: 'OCI CONTAINER_ENGINE Cluster: Controller Manager Root Ca File Configured'
    severity: critical
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.controller_manager_secure_port_tls_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Controller Manager Secure Port TLS Enabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.controller_manager_use_service_account_credentials_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Controller Manager Use Service Account Credentials Enabled'
    severity: high
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.k8s_controllermanager_secure_port_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: K8s Controllermanager Secure Port Enabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.k8s_controllermanager_service_account_token_signing_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: K8s Controllermanager Service Account Token Signing Enabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.cluster_service_dns_and_metrics_from_approved_sources
    title: 'OCI CONTAINER_ENGINE Cluster: Cluster Service Dns And Metrics From Approved Sources'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.cluster_service_kube_system_services_not_public_blocked
    title: 'OCI CONTAINER_ENGINE Cluster: Cluster Service Kube System Services Not Public Blocked'
    severity: critical
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.workload_drop_net_raw_and_reduce_caps
    title: 'OCI CONTAINER_ENGINE Cluster: Workload Drop Net Raw And Reduce Caps'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.workload_env_no_plaintext_secrets
    title: 'OCI CONTAINER_ENGINE Cluster: Workload Env No Plaintext Secrets'
    severity: high
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.workload_host_network_pid_ipc_disabled
    title: 'OCI CONTAINER_ENGINE Cluster: Workload Host Network Pid Ipc Disabled'
    severity: medium
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.workload_image_tag_not_latest
    title: 'OCI CONTAINER_ENGINE Cluster: Workload Image Tag Not Latest'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.workload_no_hostpath_mounts
    title: 'OCI CONTAINER_ENGINE Cluster: Workload No Hostpath Mounts'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.workload_no_privileged_containers
    title: 'OCI CONTAINER_ENGINE Cluster: Workload No Privileged Containers'
    severity: high
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.workload_read_only_root_filesystem
    title: 'OCI CONTAINER_ENGINE Cluster: Workload Read Only Root Filesystem'
    severity: critical
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.workload_run_as_non_root
    title: 'OCI CONTAINER_ENGINE Cluster: Workload Run As Non Root'
    severity: critical
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.workload_seccomp_profile_runtime_default_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Workload Seccomp Profile Runtime Default Enabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.etcd_auth_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Etcd Auth Enabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.etcd_client_tls_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Etcd Client TLS Enabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.etcd_encryption_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Etcd Encryption Enabled'
    severity: high
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: kms_key_id
        operator: exists
        expected: true
        description: Verify KMS encryption key is configured
  - check_id: oci.container_engine.cluster.etcd_peer_tls_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Etcd Peer TLS Enabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.k8s_etcd_client_cert_auth_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: K8s Etcd Client Cert Auth Enabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.k8s_etcd_encryption_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: K8s Etcd Encryption Enabled'
    severity: high
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: kms_key_id
        operator: exists
        expected: true
        description: Verify KMS encryption key is configured
  - check_id: oci.container_engine.cluster.namespace_default_service_account_automount_disabled
    title: 'OCI CONTAINER_ENGINE Cluster: Namespace Default Service Account Automount Disabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.namespace_network_policies_present
    title: 'OCI CONTAINER_ENGINE Cluster: Namespace Network Policies Present'
    severity: medium
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.namespace_pod_security_level_restricted
    title: 'OCI CONTAINER_ENGINE Cluster: Namespace Pod Security Level Restricted'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.node_pool_disk_encryption_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Node Pool Disk Encryption Enabled'
    severity: high
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: kms_key_id
        operator: exists
        expected: true
        description: Verify KMS encryption key is configured
  - check_id: oci.container_engine.node_pool.node_pool_nodes_no_public_ip_blocked
    title: 'OCI CONTAINER_ENGINE Node_pool: Node Pool Nodes No Public Ip Blocked'
    severity: critical
    for_each: list_node_pools
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.node_pool.node_pool_shielded_secure_boot_enabled
    title: 'OCI CONTAINER_ENGINE Node_pool: Node Pool Shielded Secure Boot Enabled'
    severity: low
    for_each: list_node_pools
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.node_pool.node_pool_workload_identity_enabled
    title: 'OCI CONTAINER_ENGINE Node_pool: Node Pool Workload Identity Enabled'
    severity: medium
    for_each: list_node_pools
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.rbac_authorization_mode_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: RBAC Authorization Mode Enabled'
    severity: medium
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.rbac_no_cluster_admin_bindings_to_users_enforced
    title: 'OCI CONTAINER_ENGINE Cluster: RBAC No Cluster Admin Bindings To Users Enforced'
    severity: critical
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.rbac_no_wildcard_rules_in_clusterroles_enforced
    title: 'OCI CONTAINER_ENGINE Cluster: RBAC No Wildcard Rules In Clusterroles Enforced'
    severity: medium
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.rbac_subjects_scoped_to_namespaces_enforced
    title: 'OCI CONTAINER_ENGINE Cluster: RBAC Subjects Scoped To Namespaces Enforced'
    severity: medium
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.k8s_rbac_default_sa_not_cluster_admin.k8s_rbac_default_sa_not_cluster_admin_enforced
    title: 'OCI CONTAINER_ENGINE K8s_rbac_default_sa_not_cluster_admin: K8s RBAC Default Sa Not Cluster Admin Enforced'
    severity: critical
    for_each: list_k8s_rbac_default_sa_not_cluster_admins
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.k8s_rbac_no_cluster_admin_to_authenticated.k8s_rbac_no_cluster_admin_to_authenticated_enforced
    title: 'OCI CONTAINER_ENGINE K8s_rbac_no_cluster_admin_to_authenticated: K8s RBAC No Cluster Admin To Authenticated Enforced'
    severity: critical
    for_each: list_k8s_rbac_no_cluster_admin_to_authenticateds
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.k8s_rbac_wildcard_verbs_disallowed.k8s_rbac_wildcard_verbs_disallowed_enforced
    title: 'OCI CONTAINER_ENGINE K8s_rbac_wildcard_verbs_disallowed: K8s RBAC Wildcard Verbs Disallowed Enforced'
    severity: medium
    for_each: list_k8s_rbac_wildcard_verbs_disalloweds
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.scheduler_authentication_kubeconfig_configured
    title: 'OCI CONTAINER_ENGINE Cluster: Scheduler Authentication Kubeconfig Configured'
    severity: high
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.scheduler_authorization_kubeconfig_configured
    title: 'OCI CONTAINER_ENGINE Cluster: Scheduler Authorization Kubeconfig Configured'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.scheduler_secure_port_tls_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Scheduler Secure Port TLS Enabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.k8s_scheduler_leader_election_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: K8s Scheduler Leader Election Enabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.k8s_scheduler_profiling_disabled
    title: 'OCI CONTAINER_ENGINE Cluster: K8s Scheduler Profiling Disabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.k8s_scheduler_secure_port_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: K8s Scheduler Secure Port Enabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.service_account_keys_not_used_or_restricted
    title: 'OCI CONTAINER_ENGINE Cluster: Service Account Keys Not Used Or Restricted'
    severity: high
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.service_account_no_user_managed_long_restricted
    title: 'OCI CONTAINER_ENGINE Cluster: Service Account No User Managed Long Restricted'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.service_account_scopes_or_roles_least_privilege_required
    title: 'OCI CONTAINER_ENGINE Cluster: Service Account Scopes Or Roles Least Privilege Required'
    severity: high
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.service_account_workload_identity_federation_used_restricted
    title: 'OCI CONTAINER_ENGINE Cluster: Service Account Workload Identity Federation Used Restricted'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.service_external_ips_not_used
    title: 'OCI CONTAINER_ENGINE Cluster: Service External Ips Not Used'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.node_pool.service_nodeport_usage_restricted
    title: 'OCI CONTAINER_ENGINE Node_pool: Service Nodeport Usage Restricted'
    severity: low
    for_each: list_node_pools
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.service_type_loadbalancer_internal_only_where_required
    title: 'OCI CONTAINER_ENGINE Cluster: Service Type Loadbalancer Internal Only Where Required'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.kubelet_anonymous_auth_disabled
    title: 'OCI CONTAINER_ENGINE Cluster: Kubelet Anonymous Auth Disabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.kubelet_authz_webhook_or_rbac_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Kubelet Authz Webhook Or RBAC Enabled'
    severity: medium
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.kubelet_read_only_port_disabled
    title: 'OCI CONTAINER_ENGINE Cluster: Kubelet Read Only Port Disabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.kubelet_tls_min_1_2_enforced
    title: 'OCI CONTAINER_ENGINE Cluster: Kubelet TLS Min 1 2 Enforced'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.k8s_kubelet_anonymous_auth_disabled
    title: 'OCI CONTAINER_ENGINE Cluster: K8s Kubelet Anonymous Auth Disabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.k8s_kubelet_client_cert_rotation_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: K8s Kubelet Client Cert Rotation Enabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.k8s_kubelet_protect_kernel_defaults_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: K8s Kubelet Protect Kernel Defaults Enabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.k8s_kubelet_read_only_port_disabled
    title: 'OCI CONTAINER_ENGINE Cluster: K8s Kubelet Read Only Port Disabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.cluster_audit_logging_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Cluster Audit Logging Enabled'
    severity: medium
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.cluster_default_service_account_automount_disabled
    title: 'OCI CONTAINER_ENGINE Cluster: Cluster Default Service Account Automount Disabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.cluster_private_control_plane_endpoint_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Cluster Private Control Plane Endpoint Enabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.cluster_secrets_encryption_kms_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Cluster Secrets Encryption KMS Enabled'
    severity: high
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: kms_key_id
        operator: exists
        expected: true
        description: Verify KMS encryption key is configured
  - check_id: oci.container_engine.cluster.clusters_created_with_private_nodes
    title: 'OCI CONTAINER_ENGINE Cluster: Clusters Created With Private Nodes'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.clusters_public_access_disabled
    title: 'OCI CONTAINER_ENGINE Cluster: Clusters Public Access Disabled'
    severity: critical
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.engine_kubernetes_rotate_server_certificates
    title: 'OCI CONTAINER_ENGINE Cluster: Engine Kubernetes Rotate Server Certificates'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.node_pool.instances_managed_updates_enabled
    title: 'OCI CONTAINER_ENGINE Node_pool: Instances Managed Updates Enabled'
    severity: low
    for_each: list_node_pools
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.cluster_kms_cmk_encryption_in_secrets_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Cluster KMS CMK Encryption In Secrets Enabled'
    severity: high
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: kms_key_id
        operator: exists
        expected: true
        description: Verify KMS encryption key is configured
  - check_id: oci.container_engine.cluster.cluster_public_access_blocked
    title: 'OCI CONTAINER_ENGINE Cluster: Cluster Public Access Blocked'
    severity: critical
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.service_account
    title: 'OCI CONTAINER_ENGINE Cluster: Service Account'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.audit_service_log_access
    title: 'OCI CONTAINER_ENGINE Cluster: Audit Service Log Access'
    severity: medium
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.kubelet_configuration
    title: 'OCI CONTAINER_ENGINE Cluster: Kubelet Configuration'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.kubelet_streaming_connection_idle_timeout
    title: 'OCI CONTAINER_ENGINE Cluster: Kubelet Streaming Connection Idle Timeout'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.namespace_network_policy_configured
    title: 'OCI CONTAINER_ENGINE Cluster: Namespace Network Policy Configured'
    severity: medium
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.node_pool_private_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Node Pool Private Enabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.pod_service_account_token_mount_disabled
    title: 'OCI CONTAINER_ENGINE Cluster: Pod Service Account Token Mount Disabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.private_endpoint_enabled_public_access_disabled
    title: 'OCI CONTAINER_ENGINE Cluster: Private Endpoint Enabled Public Access Disabled'
    severity: critical
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.network_policy_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Network Policy Enabled'
    severity: medium
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.instances_task_definition_logging_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Instances Task Definition Logging Enabled'
    severity: medium
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.registry_image_scan_on_push_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Registry Image Scan On Push Enabled'
    severity: low
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.container_engine.cluster.registry_repository_encryption_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Registry Repository Encryption Enabled'
    severity: high
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: kms_key_id
        operator: exists
        expected: true
        description: Verify KMS encryption key is configured
  - check_id: oci.container_engine.cluster.cluster_vault_cmk_encryption_in_secrets_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Cluster Vault CMK Encryption In Secrets Enabled'
    severity: high
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: kms_key_id
        operator: exists
        expected: true
        description: Verify KMS encryption key is configured
  - check_id: oci.container_engine.cluster.control_plane_logging_all_types_enabled
    title: 'OCI CONTAINER_ENGINE Cluster: Control Plane Logging All Types Enabled'
    severity: medium
    for_each: list_clusters
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
