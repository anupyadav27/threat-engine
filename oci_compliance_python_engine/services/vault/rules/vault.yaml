vault:
  version: '1.0'
  provider: oci
  service: vault
  scope: regional
  discovery:
  - discovery_id: list_secrets
    resource_type: secret
    calls:
    - action: list
      client: VaultsClient
      method: list_secrets
      fields:
      - path: id
        var: secret_id
      - path: secret_name
        var: secret_name
      - path: lifecycle_state
        var: lifecycle_state
  checks:
  - check_id: oci.vault.secret.automatic_rotation_enabled
    title: 'OCI VAULT Secret: Automatic Rotation Enabled'
    severity: medium
    for_each: list_secrets
    logic: AND
    calls:
    - action: get
      client: VaultsClient
      method: get_secret
      fields:
      - path: rotation_config.rotation_interval
        operator: exists
        expected: null
        description: Check if automatic rotation is configured for the secret
