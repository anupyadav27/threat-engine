mysql:
  version: '1.0'
  provider: oci
  service: mysql
  scope: regional
  discovery:
  - discovery_id: list_db_systems
    resource_type: db_system
    calls:
    - action: list
      client: DatabaseClient
      method: list_db_systems
      fields:
      - path: id
        var: db_system_id
      - path: display_name
        var: display_name
      - path: lifecycle_state
        var: lifecycle_state
      - path: compartment_id
        var: compartment_id
  - discovery_id: get_db_system_details
    resource_type: db_system
    for_each: list_db_systems
    calls:
    - action: get
      client: DatabaseClient
      method: get_db_system
      fields:
      - path: kms_key_id
        var: kms_key_id
      - path: backup_network_nsg_ids
        var: backup_network_nsg_ids
  checks:
  - check_id: oci.mysql.db_system.db_encryption_enabled
    title: 'OCI MYSQL Db_system: Db Encryption Enabled'
    severity: high
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: kms_key_id
        operator: exists
        expected: true
        description: Verify KMS encryption key is configured
  - check_id: oci.mysql.db_system.db_public_access_disabled
    title: 'OCI MYSQL Db_system: Db Public Access Disabled'
    severity: critical
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.db_require_tls_in_transit_required
    title: 'OCI MYSQL Db_system: Db Require TLS In Transit Required'
    severity: medium
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.instance_automated_backups
    title: 'OCI MYSQL Db_system: Instance Automated Backups'
    severity: medium
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.instance_postgres_log_connections_flag
    title: 'OCI MYSQL Db_system: Instance Postgres Log Connections Flag'
    severity: low
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.instance_postgres_log_disconnections_flag
    title: 'OCI MYSQL Db_system: Instance Postgres Log Disconnections Flag'
    severity: low
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.instance_postgres_log_error_verbosity_flag
    title: 'OCI MYSQL Db_system: Instance Postgres Log Error Verbosity Flag'
    severity: low
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.instance_postgres_log_min_duration_statement_flag
    title: 'OCI MYSQL Db_system: Instance Postgres Log Min Duration Statement Flag'
    severity: low
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.instance_postgres_log_min_error_statement_flag
    title: 'OCI MYSQL Db_system: Instance Postgres Log Min Error Statement Flag'
    severity: low
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.instance_postgres_log_min_messages_flag
    title: 'OCI MYSQL Db_system: Instance Postgres Log Min Messages Flag'
    severity: low
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.instance_postgres_log_statement_flag
    title: 'OCI MYSQL Db_system: Instance Postgres Log Statement Flag'
    severity: low
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.flexible_server_audit_log_connection_activated
    title: 'OCI MYSQL Db_system: Flexible Server Audit Log Connection Activated'
    severity: medium
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.flexible_server_audit_log_enabled
    title: 'OCI MYSQL Db_system: Flexible Server Audit Log Enabled'
    severity: medium
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.flexible_server_minimum_tls_version_12
    title: 'OCI MYSQL Db_system: Flexible Server Minimum TLS Version 12'
    severity: medium
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.flexible_server_ssl_connection_enabled
    title: 'OCI MYSQL Db_system: Flexible Server SSL Connection Enabled'
    severity: medium
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.flexible_server_enforce_ssl_enabled
    title: 'OCI MYSQL Db_system: Flexible Server Enforce SSL Enabled'
    severity: medium
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.flexible_server_log_checkpoints_on
    title: 'OCI MYSQL Db_system: Flexible Server Log Checkpoints On'
    severity: low
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.flexible_server_log_connections_on
    title: 'OCI MYSQL Db_system: Flexible Server Log Connections On'
    severity: low
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.flexible_server_log_disconnections_on
    title: 'OCI MYSQL Db_system: Flexible Server Log Disconnections On'
    severity: low
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.flexible_server_log_retention_days_greater_3
    title: 'OCI MYSQL Db_system: Flexible Server Log Retention Days Greater 3'
    severity: low
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.instance_public_access
    title: 'OCI MYSQL Db_system: Instance Public Access'
    severity: critical
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.instance_public_ip
    title: 'OCI MYSQL Db_system: Instance Public Ip'
    severity: critical
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.instance_ssl_connections
    title: 'OCI MYSQL Db_system: Instance SSL Connections'
    severity: medium
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
  - check_id: oci.mysql.db_system.flexible_server_allow_access_services_disabled
    title: 'OCI MYSQL Db_system: Flexible Server Allow Access Services Disabled'
    severity: medium
    for_each: list_db_systems
    logic: AND
    calls:
    - action: eval
      fields:
      - path: lifecycle_state
        operator: equals
        expected: ACTIVE
        description: Verify resource is in active state (placeholder check)
