version: '1.0'
provider: aws
service: account
services:
  client: account
  module: boto3.client
discovery:
- discovery_id: aws.account.alternate_contacts
  calls:
  - action: get_alternate_contact
    save_as: response
  emit:
    item:
      AlternateContactType: '{{ response.AlternateContact.AlternateContactType }}'
      EmailAddress: '{{ response.AlternateContact.EmailAddress }}'
      Name: '{{ response.AlternateContact.Name }}'
      PhoneNumber: '{{ response.AlternateContact.PhoneNumber }}'
      Title: '{{ response.AlternateContact.Title }}'
checks:
- rule_id: aws.account.security.contact_information_configured
  for_each: aws.account.alternate_contacts
  conditions:
    var: item.security_contact.exists
    op: equals
    value: true
- rule_id: aws.account.resource.security_contact_configured
  for_each: aws.account.alternate_contacts
  conditions:
    var: item.security_contact.exists
    op: equals
    value: true
