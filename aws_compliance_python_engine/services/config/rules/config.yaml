version: '1.0'
provider: aws
service: config
discovery:
- discovery_id: aws.config.remediation_configurations
  calls:
  - client: config
    action: describe_configuration_recorders
    save_as: remediation_configuration_list
    on_error: continue
    fields:
    - Configs
  emit:
    items_for: remediation_configuration_list[]
    as: remediation_configuration
    item:
      id: '{{ remediation_configuration.Id }}'
      name: '{{ remediation_configuration.Name }}'
- discovery_id: aws.config.remediation_configuration_encryption
  for_each: aws.config.remediation_configurations
  calls:
  - client: config
    action: describe_configuration_recorders
    params:
      Remediation_configurationId: '{{ item.id }}'
    save_as: encryption
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      encryption_enabled: '{{ encryption.Encrypted if encryption.Encrypted is defined else false }}'
- discovery_id: aws.config.deliverychannels
  for_each: aws.config.deliverychannel
  calls:
  - client: config
    action: describe_delivery_channel_status
    save_as: deliverychannels
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.config.deliverychannel_encryption
  calls:
  - client: config
    action: list_aggregate_discovered_resources
    save_as: deliverychannel_encryption
    on_error: continue
  emit:
    items_for: deliverychannel_encryption[]
    as: deliverychannel_encryption
    item:
      id: '{{ deliverychannel_encryption.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.config.configuration_recorders
  for_each: aws.config.configuration_recorder
  calls:
  - client: config
    action: describe_configuration_recorders
    save_as: configuration_recorders
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.config.configuration_aggregators
  for_each: aws.config.configuration_aggregator
  calls:
  - client: config
    action: describe_configuration_aggregators
    save_as: configuration_aggregators
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.config.aggregation_authorizations
  for_each: aws.config.aggregation_authorization
  calls:
  - client: config
    action: describe_aggregation_authorizations
    save_as: aggregation_authorizations
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.config.recorders
  for_each: aws.config.recorder
  calls:
  - client: config
    action: describe_aggregate_compliance_by_config_rules
    save_as: recorders
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.config.resources
  for_each: aws.config.resource
  calls:
  - client: config
    action: describe_aggregate_compliance_by_config_rules
    save_as: resources
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.config.configrules
  for_each: aws.config.configrule
  calls:
  - client: config
    action: describe_config_rules
    save_as: configrules
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
checks:
- title: 'CONFIG configuration aggregator: Configuration Present And Valid'
  severity: medium
  rule_id: aws.config.configuration_aggregator.configuration_present_and_valid
  for_each:
    discovery: aws.config.configuration_aggregators
    as: configuration_aggregator
    item: configuration_aggregator
  conditions:
    var: configuration_aggregator.compliant
    op: equals
    value: true
  remediation: "Configure config configuration_aggregator for compliance:\n\nRequirement: Configuration Present And Valid\n\
    \nDescription: Verifies security configuration for AWS Config configuration aggregator to ensure alignment with AWS security\
    \ best practices and compliance requirements. Proper configuration reduces security risks, maintains defense in depth,\
    \ and supports overall security posture.\n\nSteps:\n1. Open CONFIG console\n2. Select the configuration_aggregator\n3.\
    \ Review security configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\
    \nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\
    \u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG remediation configuration: Manual Runbooks Enabled'
  severity: medium
  rule_id: aws.config.remediation_configuration.manual_runbooks_enabled
  for_each:
    discovery: aws.config.remediation_configurations
    as: remediation_configuration
    item: remediation_configuration
  conditions:
    var: remediation_configuration.compliant
    op: equals
    value: true
  remediation: "Configure config remediation_configuration for compliance:\n\nRequirement: Manual Runbooks Enabled\n\nDescription:\
    \ Verifies security configuration for AWS Config remediation configuration to ensure alignment with AWS security best\
    \ practices and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and\
    \ supports overall security posture.\n\nSteps:\n1. Open CONFIG console\n2. Select the remediation_configuration\n3. Review\
    \ security configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\
    \nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\
    \u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG configrule: Remediation Rule Remediation Targets Bound Configured'
  severity: medium
  rule_id: aws.config.configrule.remediation_rule_remediation_targets_bound_configured
  for_each:
    discovery: aws.config.configrules
    as: configrule
    item: configrule
  conditions:
    var: configrule.compliant
    op: equals
    value: true
  remediation: "Configure config configrule for compliance:\n\nRequirement: Remediation Rule Remediation Targets Bound Configuration\n\
    \nDescription: Verifies security configuration for AWS Config configrule to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open CONFIG console\n2. Select the configrule\n3. Review security configuration\n4.\
    \ Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG aggregation authorization: Certificate Not Expired Or Revoked Valid'
  severity: medium
  rule_id: aws.config.aggregation_authorization.certificate_not_expired_or_revoked_valid
  for_each:
    discovery: aws.config.aggregation_authorizations
    as: aggregation_authorization
    item: aggregation_authorization
  conditions:
    var: aggregation_authorization.compliant
    op: equals
    value: true
  remediation: "Configure config aggregation_authorization for compliance:\n\nRequirement: Certificate Not Expired Or Revoked\
    \ Valid\n\nDescription: Verifies security configuration for AWS Config aggregation authorization to ensure alignment with\
    \ AWS security best practices and compliance requirements. Proper configuration reduces security risks, maintains defense\
    \ in depth, and supports overall security posture.\n\nSteps:\n1. Open CONFIG console\n2. Select the aggregation_authorization\n\
    3. Review security configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save\
    \ changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense\
    \ in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG remediation configuration: Auto Remediation Enabled For High'
  severity: medium
  rule_id: aws.config.remediation_configuration.auto_remediation_enabled_for_high
  for_each:
    discovery: aws.config.remediation_configurations
    as: remediation_configuration
    item: remediation_configuration
  conditions:
    var: remediation_configuration.compliant
    op: equals
    value: true
  remediation: "Configure config remediation_configuration for compliance:\n\nRequirement: Auto Remediation Enabled For High\n\
    \nDescription: Verifies security configuration for AWS Config remediation configuration to ensure alignment with AWS security\
    \ best practices and compliance requirements. Proper configuration reduces security risks, maintains defense in depth,\
    \ and supports overall security posture.\n\nSteps:\n1. Open CONFIG console\n2. Select the remediation_configuration\n\
    3. Review security configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save\
    \ changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense\
    \ in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG configrule: Config Rule Evidence Export Configured'
  severity: medium
  rule_id: aws.config.configrule.config_rule_evidence_export_configured
  for_each:
    discovery: aws.config.configrules
    as: configrule
    item: configrule
  conditions:
    var: configrule.compliant
    op: equals
    value: true
  remediation: "Configure config configrule for compliance:\n\nRequirement: Config Rule Evidence Export Configuration\n\n\
    Description: Verifies security configuration for AWS Config configrule to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open CONFIG console\n2. Select the configrule\n3. Review security configuration\n4.\
    \ Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG configuration aggregator: Configuration Auto Enroll New Accounts Configured'
  severity: medium
  rule_id: aws.config.configuration_aggregator.configuration_auto_enroll_new_accounts_configured
  for_each:
    discovery: aws.config.configuration_aggregators
    as: configuration_aggregator
    item: configuration_aggregator
  conditions:
    var: configuration_aggregator.compliant
    op: equals
    value: true
  remediation: "Configure config configuration_aggregator for compliance:\n\nRequirement: Configuration Auto Enroll New Accounts\
    \ Configuration\n\nDescription: Verifies security configuration for AWS Config configuration aggregator to ensure alignment\
    \ with AWS security best practices and compliance requirements. Proper configuration reduces security risks, maintains\
    \ defense in depth, and supports overall security posture.\n\nSteps:\n1. Open CONFIG console\n2. Select the configuration_aggregator\n\
    3. Review security configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save\
    \ changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense\
    \ in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG configrule: Alerts Configured'
  severity: medium
  rule_id: aws.config.configrule.alerts_configured
  for_each:
    discovery: aws.config.configrules
    as: configrule
    item: configrule
  conditions:
    var: configrule.monitoring_enabled
    op: equals
    value: true
  remediation: "Enable monitoring for config configrule:\n\n1. Open CloudWatch console\n2. Create alarm for configrule\n3.\
    \ Configure metrics to monitor\n4. Set alarm thresholds\n5. Configure SNS notifications\n6. Enable detailed monitoring\
    \ (if available)\n7. Create dashboard for visualization\n\nMonitoring Best Practices:\n\u2022 Monitor security-relevant\
    \ metrics\n\u2022 Set up automated alerting\n\u2022 Integrate with SIEM/SOC\n\u2022 Regular review of metrics\n\u2022\
    \ Implement automated remediation"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG deliverychannel: Kms Encryption Enabled'
  severity: high
  rule_id: aws.config.deliverychannel.kms_encryption_enabled
  for_each:
    discovery: aws.config.deliverychannel_encryption
    as: deliverychannel
    item: deliverychannel
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for config deliverychannel:\n\n1. Open CONFIG console\n2. Select the deliverychannel\n3.\
    \ Navigate to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed\
    \ key (default)\n   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws config modify-deliverychannel\
    \ --deliverychannel-id <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed\
    \ KMS keys for sensitive data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022\
    \ Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG resource: Config Recorder All Regions Enabled'
  severity: medium
  rule_id: aws.config.resource.config_recorder_all_regions_enabled
  for_each:
    discovery: aws.config.resources
    as: resource
    item: resource
  conditions:
    var: resource.compliant
    op: equals
    value: true
  remediation: "Configure config resource for compliance:\n\nRequirement: Config Recorder All Regions Enabled\n\nDescription:\
    \ Verifies security configuration for AWS Config resource to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open CONFIG console\n2. Select the resource\n3. Review security configuration\n4. Apply required\
    \ settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022\
    \ Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022\
    \ Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG deliverychannel: Destination Access Least Privilege'
  severity: high
  rule_id: aws.config.deliverychannel.destination_access_least_privilege
  for_each:
    discovery: aws.config.deliverychannels
    as: deliverychannel
    item: deliverychannel
  conditions:
    var: deliverychannel.is_public
    op: equals
    value: false
  remediation: "Restrict public access for config deliverychannel:\n\n1. Open CONFIG console\n2. Select the deliverychannel\n\
    3. Go to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG configrule: Config Rule Reporting Dashboards Enabled'
  severity: medium
  rule_id: aws.config.configrule.config_rule_reporting_dashboards_enabled
  for_each:
    discovery: aws.config.configrules
    as: configrule
    item: configrule
  conditions:
    var: configrule.compliant
    op: equals
    value: true
  remediation: "Configure config configrule for compliance:\n\nRequirement: Config Rule Reporting Dashboards Enabled\n\nDescription:\
    \ Verifies security configuration for AWS Config configrule to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open CONFIG console\n2. Select the configrule\n3. Review security configuration\n4. Apply required\
    \ settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022\
    \ Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022\
    \ Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG recorder: Config All Regions Enabled'
  severity: medium
  rule_id: aws.config.recorder.config_all_regions_enabled
  for_each:
    discovery: aws.config.recorders
    as: recorder
    item: recorder
  conditions:
    var: recorder.compliant
    op: equals
    value: true
  remediation: "Configure config recorder for compliance:\n\nRequirement: Config All Regions Enabled\n\nDescription: Verifies\
    \ security configuration for AWS Config recorder to ensure alignment with AWS security best practices and compliance requirements.\
    \ Proper configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\n\
    Steps:\n1. Open CONFIG console\n2. Select the recorder\n3. Review security configuration\n4. Apply required settings per\
    \ organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS\
    \ Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption\
    \ where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG configuration recorder: Configuration Global Resource Types Tracked Configured'
  severity: medium
  rule_id: aws.config.configuration_recorder.configuration_global_resource_types_tracked_configured
  for_each:
    discovery: aws.config.configuration_recorders
    as: configuration_recorder
    item: configuration_recorder
  conditions:
    var: configuration_recorder.compliant
    op: equals
    value: true
  remediation: "Configure config configuration_recorder for compliance:\n\nRequirement: Configuration Global Resource Types\
    \ Tracked Configuration\n\nDescription: Verifies security configuration for AWS Config configuration recorder to ensure\
    \ alignment with AWS security best practices and compliance requirements. Proper configuration reduces security risks,\
    \ maintains defense in depth, and supports overall security posture.\n\nSteps:\n1. Open CONFIG console\n2. Select the\
    \ configuration_recorder\n3. Review security configuration\n4. Apply required settings per organizational policy\n5. Verify\
    \ compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022\
    \ Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular\
    \ security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG configrule: Rule Config Rules Enabled'
  severity: medium
  rule_id: aws.config.configrule.rule_config_rules_enabled
  for_each:
    discovery: aws.config.configrules
    as: configrule
    item: configrule
  conditions:
    var: configrule.compliant
    op: equals
    value: true
  remediation: "Configure config configrule for compliance:\n\nRequirement: Rule Config Rules Enabled\n\nDescription: Verifies\
    \ security configuration for AWS Config configrule to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open CONFIG console\n2. Select the configrule\n3. Review security configuration\n4. Apply required\
    \ settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022\
    \ Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022\
    \ Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG configuration recorder: Configuration Secure Destination Configured'
  severity: medium
  rule_id: aws.config.configuration_recorder.configuration_secure_destination_configured
  for_each:
    discovery: aws.config.configuration_recorders
    as: configuration_recorder
    item: configuration_recorder
  conditions:
    var: configuration_recorder.compliant
    op: equals
    value: true
  remediation: "Configure config configuration_recorder for compliance:\n\nRequirement: Configuration Secure Destination Configuration\n\
    \nDescription: Verifies security configuration for AWS Config configuration recorder to ensure alignment with AWS security\
    \ best practices and compliance requirements. Proper configuration reduces security risks, maintains defense in depth,\
    \ and supports overall security posture.\n\nSteps:\n1. Open CONFIG console\n2. Select the configuration_recorder\n3. Review\
    \ security configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\
    \nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\
    \u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG aggregation authorization: Config Trusts Least Privilege'
  severity: high
  rule_id: aws.config.aggregation_authorization.config_trusts_least_privilege
  for_each:
    discovery: aws.config.aggregation_authorizations
    as: aggregation_authorization
    item: aggregation_authorization
  conditions:
    var: aggregation_authorization.is_public
    op: equals
    value: false
  remediation: "Restrict public access for config aggregation_authorization:\n\n1. Open CONFIG console\n2. Select the aggregation_authorization\n\
    3. Go to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG configuration aggregator: Configuration Org Aggregator Enabled'
  severity: medium
  rule_id: aws.config.configuration_aggregator.configuration_org_aggregator_enabled
  for_each:
    discovery: aws.config.configuration_aggregators
    as: configuration_aggregator
    item: configuration_aggregator
  conditions:
    var: configuration_aggregator.compliant
    op: equals
    value: true
  remediation: "Configure config configuration_aggregator for compliance:\n\nRequirement: Configuration Org Aggregator Enabled\n\
    \nDescription: Verifies security configuration for AWS Config configuration aggregator to ensure alignment with AWS security\
    \ best practices and compliance requirements. Proper configuration reduces security risks, maintains defense in depth,\
    \ and supports overall security posture.\n\nSteps:\n1. Open CONFIG console\n2. Select the configuration_aggregator\n3.\
    \ Review security configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\
    \nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\
    \u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG resource: Config Lambda Config Recording Enabled'
  severity: medium
  rule_id: aws.config.resource.config_lambda_config_recording_enabled
  for_each:
    discovery: aws.config.resources
    as: resource
    item: resource
  conditions:
    var: resource.compliant
    op: equals
    value: true
  remediation: "Configure config resource for compliance:\n\nRequirement: Config Lambda Config Recording Enabled\n\nDescription:\
    \ Verifies security configuration for AWS Config resource to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open CONFIG console\n2. Select the resource\n3. Review security configuration\n4. Apply required\
    \ settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022\
    \ Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022\
    \ Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG configrule: Config Rule Critical Resources Drift Detection Enabled'
  severity: medium
  rule_id: aws.config.configrule.config_rule_critical_resources_drift_detection_enabled
  for_each:
    discovery: aws.config.configrules
    as: configrule
    item: configrule
  conditions:
    var: configrule.compliant
    op: equals
    value: true
  remediation: "Configure config configrule for compliance:\n\nRequirement: Config Rule Critical Resources Drift Detection\
    \ Enabled\n\nDescription: Verifies security configuration for AWS Config configrule to ensure alignment with AWS security\
    \ best practices and compliance requirements. Proper configuration reduces security risks, maintains defense in depth,\
    \ and supports overall security posture.\n\nSteps:\n1. Open CONFIG console\n2. Select the configrule\n3. Review security\
    \ configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral\
    \ Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable\
    \ logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG configuration recorder: Configuration Config Recorder Enabled'
  severity: medium
  rule_id: aws.config.configuration_recorder.configuration_config_recorder_enabled
  for_each:
    discovery: aws.config.configuration_recorders
    as: configuration_recorder
    item: configuration_recorder
  conditions:
    var: configuration_recorder.compliant
    op: equals
    value: true
  remediation: "Configure config configuration_recorder for compliance:\n\nRequirement: Configuration Config Recorder Enabled\n\
    \nDescription: Verifies security configuration for AWS Config configuration recorder to ensure alignment with AWS security\
    \ best practices and compliance requirements. Proper configuration reduces security risks, maintains defense in depth,\
    \ and supports overall security posture.\n\nSteps:\n1. Open CONFIG console\n2. Select the configuration_recorder\n3. Review\
    \ security configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\
    \nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\
    \u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG aggregation authorization: Config Target Accounts Correct Configured'
  severity: medium
  rule_id: aws.config.aggregation_authorization.config_target_accounts_correct_configured
  for_each:
    discovery: aws.config.aggregation_authorizations
    as: aggregation_authorization
    item: aggregation_authorization
  conditions:
    var: aggregation_authorization.compliant
    op: equals
    value: true
  remediation: "Configure config aggregation_authorization for compliance:\n\nRequirement: Config Target Accounts Correct\
    \ Configuration\n\nDescription: Verifies security configuration for AWS Config aggregation authorization to ensure alignment\
    \ with AWS security best practices and compliance requirements. Proper configuration reduces security risks, maintains\
    \ defense in depth, and supports overall security posture.\n\nSteps:\n1. Open CONFIG console\n2. Select the aggregation_authorization\n\
    3. Review security configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save\
    \ changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense\
    \ in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'CONFIG configrule: Config Rule Required Rules Present'
  severity: medium
  rule_id: aws.config.configrule.config_rule_required_rules_present
  for_each:
    discovery: aws.config.configrules
    as: configrule
    item: configrule
  conditions:
    var: configrule.compliant
    op: equals
    value: true
  remediation: "Configure config configrule for compliance:\n\nRequirement: Config Rule Required Rules Present\n\nDescription:\
    \ Verifies security configuration for AWS Config configrule to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open CONFIG console\n2. Select the configrule\n3. Review security configuration\n4. Apply required\
    \ settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022\
    \ Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022\
    \ Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
