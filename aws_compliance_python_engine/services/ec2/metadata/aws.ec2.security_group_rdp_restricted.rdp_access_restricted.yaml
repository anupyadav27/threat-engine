rule_id: aws.ec2.security_group_rdp_restricted.rdp_access_restricted
service: ec2
resource: security_group_rdp_restricted
requirement: Rdp Access Restricted
title: 'EC2 security group rdp restricted: Rdp Access Restricted'
scope: ec2.security_group_rdp_restricted.configuration
domain: configuration_and_change_management
subcategory: configuration_baseline
rationale: Ensures ec2 security_group_rdp_restricted has rdp access restricted properly
  configured for security compliance.
severity: medium
assertion_id: security.configuration.ec2_security_group_rdp_restricted_rdp_access_restricted
source: expert_generated
description: Verifies security configuration for Amazon EC2 security group rdp restricted
  to ensure alignment with AWS security best practices and compliance requirements.
  Proper configuration reduces security risks, maintains defense in depth, and supports
  overall security posture.
references:
- https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
- https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
- https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
remediation: "Restrict public access for ec2 security_group_rdp_restricted:\n\n1.\
  \ Open EC2 console\n2. Select the security_group_rdp_restricted\n3. Go to Permissions/Access\
  \ Control\n4. Review current permissions:\n   - Remove public access grants\n  \
  \ - Remove wildcard (*) principals\n   - Implement least privilege\n5. Update resource\
  \ policy or IAM policies\n6. Enable resource-level access control\n7. Save changes\n\
  \nSecurity Recommendations:\n• Use IAM roles instead of access keys\n• Implement\
  \ condition keys for additional security\n• Enable MFA for sensitive operations\n\
  • Regularly audit access permissions\n• Use AWS Organizations SCPs for guardrails"
