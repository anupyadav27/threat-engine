version: '1.0'
provider: aws
service: ec2
discovery:
- discovery_id: aws.ec2.spotinstances
  calls:
  - client: ec2
    action: describe_db_instances
    save_as: spotinstance_list
    on_error: continue
    fields:
    - Instances
  emit:
    items_for: spotinstance_list[]
    as: spotinstance
    item:
      id: '{{ spotinstance.InstanceId }}'
      name: '{{ spotinstance.InstanceId }}'
- discovery_id: aws.ec2.spotinstance_encryption
  for_each: aws.ec2.spotinstances
  calls:
  - client: ec2
    action: describe_volumes
    params:
      SpotinstanceId: '{{ item.id }}'
    save_as: encryption
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      encryption_enabled: '{{ encryption.Encrypted if encryption.Encrypted is defined else false }}'
- discovery_id: aws.ec2.spotinstance_logging
  for_each: aws.ec2.spotinstances
  calls:
  - client: ec2
    action: null
    params:
      SpotinstanceId: '{{ item.id }}'
    save_as: logging
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      logging_enabled: '{{ logging.LoggingEnabled is defined if logging else false }}'
- discovery_id: aws.ec2.transitgateways
  for_each: aws.ec2.transitgateway
  calls:
  - client: ec2
    action: describe_transit_gateways
    save_as: transitgateways
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.customergateway_encryption
  calls:
  - client: ec2
    action: list_images_in_recycle_bin
    save_as: customergateway_encryption
    on_error: continue
  emit:
    items_for: customergateway_encryption[]
    as: customergateway_encryption
    item:
      id: '{{ customergateway_encryption.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.autoscalinggroups
  for_each: aws.ec2.autoscalinggroup
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: autoscalinggroups
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_rdp_restricteds
  for_each: aws.ec2.security_group_rdp_restricted
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: security_group_rdp_restricteds
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.groups
  for_each: aws.ec2.group
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: groups
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_internet_ingress_ftp_20_21s
  for_each: aws.ec2.security_group_internet_ingress_ftp_20_21
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: security_group_internet_ingress_ftp_20_21s
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.dedicatedhosts
  for_each: aws.ec2.dedicatedhost
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: dedicatedhosts
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.vpnconnections
  for_each: aws.ec2.vpnconnection
  calls:
  - client: ec2
    action: describe_vpn_connections
    save_as: vpnconnections
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.vpnconnection_encryption
  calls:
  - client: ec2
    action: list_images_in_recycle_bin
    save_as: vpnconnection_encryption
    on_error: continue
  emit:
    items_for: vpnconnection_encryption[]
    as: vpnconnection_encryption
    item:
      id: '{{ vpnconnection_encryption.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.resource_encryption
  calls:
  - client: ec2
    action: list_images_in_recycle_bin
    save_as: resource_encryption
    on_error: continue
  emit:
    items_for: resource_encryption[]
    as: resource_encryption
    item:
      id: '{{ resource_encryption.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_internet_ingress_postgres_5432s
  for_each: aws.ec2.security_group_internet_ingress_postgres_5432
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: security_group_internet_ingress_postgres_5432s
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.customergateways
  for_each: aws.ec2.customergateway
  calls:
  - client: ec2
    action: describe_customer_gateways
    save_as: customergateways
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.launch_template_no_secretss
  for_each: aws.ec2.launch_template_no_secret
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: launch_template_no_secretss
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_common_ports_restricteds
  for_each: aws.ec2.security_group_common_ports_restricted
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: security_group_common_ports_restricteds
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.volume_encryption
  calls:
  - client: ec2
    action: list_images_in_recycle_bin
    save_as: volume_encryption
    on_error: continue
  emit:
    items_for: volume_encryption[]
    as: volume_encryption
    item:
      id: '{{ volume_encryption.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.accounts
  for_each: aws.ec2.account
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: accounts
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.vpcendpoints
  for_each: aws.ec2.vpcendpoint
  calls:
  - client: ec2
    action: describe_vpc_endpoint_service_configurations
    save_as: vpcendpoints
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_not_useds
  for_each: aws.ec2.security_group_not_used
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: security_group_not_useds
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_encryption
  calls:
  - client: ec2
    action: list_images_in_recycle_bin
    save_as: security_group_encryption
    on_error: continue
  emit:
    items_for: security_group_encryption[]
    as: security_group_encryption
    item:
      id: '{{ security_group_encryption.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_from_launch_wizards
  for_each: aws.ec2.security_group_from_launch_wizard
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: security_group_from_launch_wizards
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.snapshot_encryption
  calls:
  - client: ec2
    action: list_images_in_recycle_bin
    save_as: snapshot_encryption
    on_error: continue
  emit:
    items_for: snapshot_encryption[]
    as: snapshot_encryption
    item:
      id: '{{ snapshot_encryption.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_internet_ingress_high_risk_portss
  for_each: aws.ec2.security_group_internet_ingress_high_risk_port
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: security_group_internet_ingress_high_risk_portss
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.amipublics
  for_each: aws.ec2.amipublic
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: amipublics
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.reserved_instances
  for_each: aws.ec2.reserved_instance
  calls:
  - client: ec2
    action: describe_reserved_instances
    save_as: reserved_instances
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_internet_ingress_elasticsearch_kibana_9200_9300_5601s
  for_each: aws.ec2.security_group_internet_ingress_elasticsearch_kibana_9200_9300_5601
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: security_group_internet_ingress_elasticsearch_kibana_9200_9300_5601s
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.launchtemplate_encryption
  calls:
  - client: ec2
    action: list_images_in_recycle_bin
    save_as: launchtemplate_encryption
    on_error: continue
  emit:
    items_for: launchtemplate_encryption[]
    as: launchtemplate_encryption
    item:
      id: '{{ launchtemplate_encryption.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_internet_ingress_oracle_1521_2483s
  for_each: aws.ec2.security_group_internet_ingress_oracle_1521_2483
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: security_group_internet_ingress_oracle_1521_2483s
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_default_restrict_traffics
  for_each: aws.ec2.security_group_default_restrict_traffic
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: security_group_default_restrict_traffics
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.instance_encryption
  calls:
  - client: ec2
    action: list_images_in_recycle_bin
    save_as: instance_encryption
    on_error: continue
  emit:
    items_for: instance_encryption[]
    as: instance_encryption
    item:
      id: '{{ instance_encryption.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_internet_ingress_mysql_3306s
  for_each: aws.ec2.security_group_internet_ingress_mysql_3306
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: security_group_internet_ingress_mysql_3306s
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.snapshots
  for_each: aws.ec2.snapshot
  calls:
  - client: ec2
    action: describe_snapshots
    save_as: snapshots
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_with_many_ingress_egress_ruless
  for_each: aws.ec2.security_group_with_many_ingress_egress_rule
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: security_group_with_many_ingress_egress_ruless
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_internet_ingress_redis_6379s
  for_each: aws.ec2.security_group_internet_ingress_redis_6379
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: security_group_internet_ingress_redis_6379s
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_groups
  for_each: aws.ec2.security_group
  calls:
  - client: ec2
    action: describe_security_groups
    save_as: security_groups
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_internet_ingress_kafka_9092s
  for_each: aws.ec2.security_group_internet_ingress_kafka_9092
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: security_group_internet_ingress_kafka_9092s
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_internet_ingress_sql_server_1433_1434s
  for_each: aws.ec2.security_group_internet_ingress_sql_server_1433_1434
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: security_group_internet_ingress_sql_server_1433_1434s
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.ebs_public_snapshots
  for_each: aws.ec2.ebs_public_snapshot
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: ebs_public_snapshots
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.network_interfaces
  for_each: aws.ec2.network_interface
  calls:
  - client: ec2
    action: describe_network_interfaces
    save_as: network_interfaces
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.amis
  for_each: aws.ec2.ami
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: amis
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.launch_template_no_public_ips
  for_each: aws.ec2.launch_template_no_public_ip
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: launch_template_no_public_ips
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_internet_ingress_mongodb_27017_27018s
  for_each: aws.ec2.security_group_internet_ingress_mongodb_27017_27018
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: security_group_internet_ingress_mongodb_27017_27018s
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.networkacls
  for_each: aws.ec2.networkacl
  calls:
  - client: ec2
    action: describe_network_acls
    save_as: networkacls
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_internet_ingress_all_portss
  for_each: aws.ec2.security_group_internet_ingress_all_port
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: security_group_internet_ingress_all_portss
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.subnets
  for_each: aws.ec2.subnet
  calls:
  - client: ec2
    action: describe_subnets
    save_as: subnets
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_ssh_restricteds
  for_each: aws.ec2.security_group_ssh_restricted
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: security_group_ssh_restricteds
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.eips
  for_each: aws.ec2.eip
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: eips
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.ebs_encryption
  calls:
  - client: ec2
    action: list_images_in_recycle_bin
    save_as: ebs_encryption
    on_error: continue
  emit:
    items_for: ebs_encryption[]
    as: ebs_encryption
    item:
      id: '{{ ebs_encryption.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_internet_ingress_cassandra_7199_9160_8888s
  for_each: aws.ec2.security_group_internet_ingress_cassandra_7199_9160_8888
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: security_group_internet_ingress_cassandra_7199_9160_8888s
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.autoscalinggroup_encryption
  calls:
  - client: ec2
    action: list_images_in_recycle_bin
    save_as: autoscalinggroup_encryption
    on_error: continue
  emit:
    items_for: autoscalinggroup_encryption[]
    as: autoscalinggroup_encryption
    item:
      id: '{{ autoscalinggroup_encryption.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.ami_encryption
  calls:
  - client: ec2
    action: list_images_in_recycle_bin
    save_as: ami_encryption
    on_error: continue
  emit:
    items_for: ami_encryption[]
    as: ami_encryption
    item:
      id: '{{ ami_encryption.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.instances
  for_each: aws.ec2.instance
  calls:
  - client: ec2
    action: describe_db_instances
    save_as: instances
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.resource_logging
  calls:
  - client: ec2
    action: list_images_in_recycle_bin
    save_as: resource_logging
    on_error: continue
  emit:
    items_for: resource_logging[]
    as: resource_logging
    item:
      id: '{{ resource_logging.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.keypairs
  for_each: aws.ec2.keypair
  calls:
  - client: ec2
    action: describe_key_pairs
    save_as: keypairs
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_internet_ingress_memcached_11211s
  for_each: aws.ec2.security_group_internet_ingress_memcached_11211
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: security_group_internet_ingress_memcached_11211s
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.volumes
  for_each: aws.ec2.volume
  calls:
  - client: ec2
    action: describe_volumes
    save_as: volumes
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.routetables
  for_each: aws.ec2.routetable
  calls:
  - client: ec2
    action: describe_route_tables
    save_as: routetables
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.ebss
  for_each: aws.ec2.eb
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: ebss
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.security_group_internet_ingress_telnet_23s
  for_each: aws.ec2.security_group_internet_ingress_telnet_23
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: security_group_internet_ingress_telnet_23s
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.vpcs
  for_each: aws.ec2.vpc
  calls:
  - client: ec2
    action: describe_vpcs
    save_as: vpcs
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.launchtemplates
  for_each: aws.ec2.launchtemplate
  calls:
  - client: ec2
    action: describe_launch_templates
    save_as: launchtemplates
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.vpc_logging
  calls:
  - client: ec2
    action: list_images_in_recycle_bin
    save_as: vpc_logging
    on_error: continue
  emit:
    items_for: vpc_logging[]
    as: vpc_logging
    item:
      id: '{{ vpc_logging.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.ec2.resources
  for_each: aws.ec2.resource
  calls:
  - client: ec2
    action: describe_account_attributes
    save_as: resources
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
checks:
- title: 'EC2 group: Cifs Access Restriction Tcp Port 445 Configured'
  severity: medium
  rule_id: aws.ec2.group.cifs_access_restriction_tcp_port_445_configured
  for_each:
    discovery: aws.ec2.groups
    as: group
    item: group
  conditions:
    var: group.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 group:\n\n1. Open EC2 console\n2. Select the group\n3. Go to Permissions/Access\
    \ Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*) principals\n   -\
    \ Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access control\n7. Save\
    \ changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement condition keys for\
    \ additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\u2022 Use\
    \ AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Port Ldap Exposed To Internet Configured'
  severity: medium
  rule_id: aws.ec2.instance.port_ldap_exposed_to_internet_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Port Ldap Exposed To Internet Configuration\n\nDescription:\
    \ Verifies security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required\
    \ settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022\
    \ Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022\
    \ Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 resource: Ebs Encryption By Default Enabled'
  severity: high
  rule_id: aws.ec2.resource.ebs_encryption_by_default_enabled
  for_each:
    discovery: aws.ec2.resource_encryption
    as: resource
    item: resource
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for ec2 resource:\n\n1. Open EC2 console\n2. Select the resource\n3. Navigate to Properties/Configuration\
    \ > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n   - Customer managed\
    \ key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws ec2 modify-resource --resource-id <id> --encrypted\
    \ --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive data\n\u2022 Enable\
    \ automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Vtpm Enabled'
  severity: medium
  rule_id: aws.ec2.instance.vtpm_enabled
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Vtpm Enabled\n\nDescription: Verifies security configuration\
    \ for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance requirements. Proper configuration\
    \ reduces security risks, maintains defense in depth, and supports overall security posture.\n\nSteps:\n1. Open EC2 console\n\
    2. Select the instance\n3. Review security configuration\n4. Apply required settings per organizational policy\n5. Verify\
    \ compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022\
    \ Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular\
    \ security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: User Data No Secrets Configured'
  severity: medium
  rule_id: aws.ec2.instance.user_data_no_secrets_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: User Data No Secrets Configuration\n\nDescription:\
    \ Verifies security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required\
    \ settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022\
    \ Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022\
    \ Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group: Default Deny Between Network Tiers Enforced'
  severity: high
  rule_id: aws.ec2.security_group.default_deny_between_network_tiers_enforced
  for_each:
    discovery: aws.ec2.security_groups
    as: security_group
    item: security_group
  conditions:
    var: security_group.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group:\n\n1. Ensure security_group is deployed in VPC\n2. Configure\
    \ security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n\
    3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 autoscalinggroup: Instance Profile Least Privilege'
  severity: high
  rule_id: aws.ec2.autoscalinggroup.instance_profile_least_privilege
  for_each:
    discovery: aws.ec2.autoscalinggroups
    as: autoscalinggroup
    item: autoscalinggroup
  conditions:
    var: autoscalinggroup.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 autoscalinggroup:\n\n1. Open EC2 console\n2. Select the autoscalinggroup\n\
    3. Go to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'EC2 launchtemplate: No Public Ip Default Configured'
  severity: high
  rule_id: aws.ec2.launchtemplate.no_public_ip_default_configured
  for_each:
    discovery: aws.ec2.launchtemplates
    as: launchtemplate
    item: launchtemplate
  conditions:
    var: launchtemplate.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 launchtemplate:\n\n1. Open EC2 console\n2. Select the launchtemplate\n3. Go\
    \ to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group internet ingress mysql 3306: Port Mysql Blocked'
  severity: medium
  rule_id: aws.ec2.security_group_internet_ingress_mysql_3306.port_mysql_blocked
  for_each:
    discovery: aws.ec2.security_group_internet_ingress_mysql_3306s
    as: security_group_internet_ingress_mysql_3306
    item: security_group_internet_ingress_mysql_3306
  conditions:
    var: security_group_internet_ingress_mysql_3306.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group_internet_ingress_mysql_3306:\n\n1. Ensure security_group_internet_ingress_mysql_3306\
    \ is deployed in VPC\n2. Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source\
    \ IP ranges\n   - Use least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for\
    \ network monitoring\n5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork\
    \ Security Best Practices:\n\u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet\
    \ access\n\u2022 Implement defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 networkacl: Network Egress Restricted'
  severity: high
  rule_id: aws.ec2.networkacl.network_egress_restricted
  for_each:
    discovery: aws.ec2.networkacls
    as: networkacl
    item: networkacl
  conditions:
    var: networkacl.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 networkacl:\n\n1. Ensure networkacl is deployed in VPC\n2. Configure security\
    \ groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3.\
    \ Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 launch template no secrets: Launch Template No Secrets Configured'
  severity: medium
  rule_id: aws.ec2.launch_template_no_secrets.launch_template_no_secrets_configured
  for_each:
    discovery: aws.ec2.launch_template_no_secretss
    as: launch_template_no_secrets
    item: launch_template_no_secrets
  conditions:
    var: launch_template_no_secrets.compliant
    op: equals
    value: true
  remediation: "Configure ec2 launch_template_no_secrets for compliance:\n\nRequirement: Launch Template No Secrets Configuration\n\
    \nDescription: Verifies security configuration for Amazon EC2 launch template no secrets to ensure alignment with AWS\
    \ security best practices and compliance requirements. Proper configuration reduces security risks, maintains defense\
    \ in depth, and supports overall security posture.\n\nSteps:\n1. Open EC2 console\n2. Select the launch_template_no_secrets\n\
    3. Review security configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save\
    \ changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense\
    \ in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 resource: Backup Enabled'
  severity: medium
  rule_id: aws.ec2.resource.backup_enabled
  for_each:
    discovery: aws.ec2.resources
    as: resource
    item: resource
  conditions:
    var: resource.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for ec2 resource:\n\n1. Open EC2 console\n2. Select the resource\n3. Go to Properties >\
    \ Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'EC2 ami: Not Publicly Shared Configured'
  severity: high
  rule_id: aws.ec2.ami.not_publicly_shared_configured
  for_each:
    discovery: aws.ec2.amis
    as: ami
    item: ami
  conditions:
    var: ami.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 ami:\n\n1. Open EC2 console\n2. Select the ami\n3. Go to Permissions/Access\
    \ Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*) principals\n   -\
    \ Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access control\n7. Save\
    \ changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement condition keys for\
    \ additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\u2022 Use\
    \ AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 networkacl: Network No Allow All Rules Configured'
  severity: high
  rule_id: aws.ec2.networkacl.network_no_allow_all_rules_configured
  for_each:
    discovery: aws.ec2.networkacls
    as: networkacl
    item: networkacl
  conditions:
    var: networkacl.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 networkacl:\n\n1. Ensure networkacl is deployed in VPC\n2. Configure security\
    \ groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3.\
    \ Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Serial Console Access Restricted'
  severity: medium
  rule_id: aws.ec2.instance.serial_console_access_restricted
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 instance:\n\n1. Open EC2 console\n2. Select the instance\n3. Go to Permissions/Access\
    \ Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*) principals\n   -\
    \ Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access control\n7. Save\
    \ changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement condition keys for\
    \ additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\u2022 Use\
    \ AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Port Mysql Exposed To Internet Configured'
  severity: medium
  rule_id: aws.ec2.instance.port_mysql_exposed_to_internet_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Port Mysql Exposed To Internet Configuration\n\nDescription:\
    \ Verifies security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required\
    \ settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022\
    \ Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022\
    \ Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 vpcendpoint: Policy Least Privilege'
  severity: high
  rule_id: aws.ec2.vpcendpoint.policy_least_privilege
  for_each:
    discovery: aws.ec2.vpcendpoints
    as: vpcendpoint
    item: vpcendpoint
  conditions:
    var: vpcendpoint.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 vpcendpoint:\n\n1. Open EC2 console\n2. Select the vpcendpoint\n3. Go to Permissions/Access\
    \ Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*) principals\n   -\
    \ Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access control\n7. Save\
    \ changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement condition keys for\
    \ additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\u2022 Use\
    \ AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'EC2 vpc: Exception Approvals Required'
  severity: medium
  rule_id: aws.ec2.vpc.exception_approvals_required
  for_each:
    discovery: aws.ec2.vpcs
    as: vpc
    item: vpc
  conditions:
    var: vpc.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 vpc:\n\n1. Ensure vpc is deployed in VPC\n2. Configure security groups:\n\
    \   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3. Configure\
    \ network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC Endpoints\
    \ where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy in private\
    \ subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\u2022\
    \ Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 resource: Vpc Peering Route Table Least Access Configured'
  severity: high
  rule_id: aws.ec2.resource.vpc_peering_route_table_least_access_configured
  for_each:
    discovery: aws.ec2.resources
    as: resource
    item: resource
  conditions:
    var: resource.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 resource:\n\n1. Open EC2 console\n2. Select the resource\n3. Go to Permissions/Access\
    \ Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*) principals\n   -\
    \ Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access control\n7. Save\
    \ changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement condition keys for\
    \ additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\u2022 Use\
    \ AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group internet ingress all ports: Internet Ingress All Ports Blocked'
  severity: medium
  rule_id: aws.ec2.security_group_internet_ingress_all_ports.internet_ingress_all_ports_blocked
  for_each:
    discovery: aws.ec2.security_group_internet_ingress_all_portss
    as: security_group_internet_ingress_all_ports
    item: security_group_internet_ingress_all_ports
  conditions:
    var: security_group_internet_ingress_all_ports.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group_internet_ingress_all_ports:\n\n1. Ensure security_group_internet_ingress_all_ports\
    \ is deployed in VPC\n2. Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source\
    \ IP ranges\n   - Use least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for\
    \ network monitoring\n5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork\
    \ Security Best Practices:\n\u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet\
    \ access\n\u2022 Implement defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group ssh restricted: Ssh Access Restricted'
  severity: medium
  rule_id: aws.ec2.security_group_ssh_restricted.ssh_access_restricted
  for_each:
    discovery: aws.ec2.security_group_ssh_restricteds
    as: security_group_ssh_restricted
    item: security_group_ssh_restricted
  conditions:
    var: security_group_ssh_restricted.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 security_group_ssh_restricted:\n\n1. Open EC2 console\n2. Select the security_group_ssh_restricted\n\
    3. Go to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 ebs: Public Snapshot Configured'
  severity: high
  rule_id: aws.ec2.ebs.public_snapshot_configured
  for_each:
    discovery: aws.ec2.ebss
    as: ebs
    item: ebs
  conditions:
    var: ebs.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 ebs:\n\n1. Open EC2 console\n2. Select the ebs\n3. Go to Permissions/Access\
    \ Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*) principals\n   -\
    \ Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access control\n7. Save\
    \ changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement condition keys for\
    \ additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\u2022 Use\
    \ AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Port Elasticsearch Kibana Exposed To Internet Configured'
  severity: medium
  rule_id: aws.ec2.instance.port_elasticsearch_kibana_exposed_to_internet_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Port Elasticsearch Kibana Exposed To Internet Configuration\n\
    \nDescription: Verifies security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply\
    \ required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Older Than Specific Days Configured'
  severity: medium
  rule_id: aws.ec2.instance.older_than_specific_days_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Older Than Specific Days Configuration\n\nDescription:\
    \ Verifies security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required\
    \ settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022\
    \ Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022\
    \ Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Port Kerberos Exposed To Internet Configured'
  severity: medium
  rule_id: aws.ec2.instance.port_kerberos_exposed_to_internet_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Port Kerberos Exposed To Internet Configuration\n\n\
    Description: Verifies security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply\
    \ required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 resource: Client Vpn Endpoint Connection Logging Enabled'
  severity: medium
  rule_id: aws.ec2.resource.client_vpn_endpoint_connection_logging_enabled
  for_each:
    discovery: aws.ec2.resource_logging
    as: resource
    item: resource
  conditions:
    var: logging.logging_enabled
    op: equals
    value: true
  remediation: "Enable logging for ec2 resource:\n\n1. Open EC2 console\n2. Select the resource\n3. Go to Logging/Monitoring\
    \ settings\n4. Enable logging\n5. Configure log destination:\n   - CloudWatch Logs\n   - S3 bucket (for long-term retention)\n\
    6. Set log level (INFO, DEBUG, ERROR)\n7. Save changes\n\nAWS CLI:\naws ec2 update-resource-logging --resource-id <id>\
    \ --logging-enabled\n\nBest Practices:\n\u2022 Enable all security-relevant log types\n\u2022 Send logs to centralized\
    \ logging service\n\u2022 Set appropriate retention periods\n\u2022 Configure log encryption\n\u2022 Set up log monitoring\
    \ and alerting"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'EC2 amipublic: Ami Public Configured'
  severity: high
  rule_id: aws.ec2.amipublic.ami_public_configured
  for_each:
    discovery: aws.ec2.amipublics
    as: amipublic
    item: amipublic
  conditions:
    var: amipublic.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 amipublic:\n\n1. Open EC2 console\n2. Select the amipublic\n3. Go to Permissions/Access\
    \ Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*) principals\n   -\
    \ Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access control\n7. Save\
    \ changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement condition keys for\
    \ additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\u2022 Use\
    \ AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Port Redis Exposed To Internet Configured'
  severity: medium
  rule_id: aws.ec2.instance.port_redis_exposed_to_internet_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Port Redis Exposed To Internet Configuration\n\nDescription:\
    \ Verifies security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required\
    \ settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022\
    \ Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022\
    \ Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 networkacl: Ingress Restrict All Traffic'
  severity: medium
  rule_id: aws.ec2.networkacl.ingress_restrict_all_traffic
  for_each:
    discovery: aws.ec2.networkacls
    as: networkacl
    item: networkacl
  conditions:
    var: networkacl.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 networkacl:\n\n1. Ensure networkacl is deployed in VPC\n2. Configure security\
    \ groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3.\
    \ Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 vpc: Quarantine Network Configured'
  severity: high
  rule_id: aws.ec2.vpc.quarantine_network_configured
  for_each:
    discovery: aws.ec2.vpcs
    as: vpc
    item: vpc
  conditions:
    var: vpc.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 vpc:\n\n1. Ensure vpc is deployed in VPC\n2. Configure security groups:\n\
    \   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3. Configure\
    \ network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC Endpoints\
    \ where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy in private\
    \ subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\u2022\
    \ Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 subnet: Public S Use Nacl Restrictions Configured'
  severity: high
  rule_id: aws.ec2.subnet.public_s_use_nacl_restrictions_configured
  for_each:
    discovery: aws.ec2.subnets
    as: subnet
    item: subnet
  conditions:
    var: subnet.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 subnet:\n\n1. Open EC2 console\n2. Select the subnet\n3. Go to Permissions/Access\
    \ Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*) principals\n   -\
    \ Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access control\n7. Save\
    \ changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement condition keys for\
    \ additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\u2022 Use\
    \ AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 vpcendpoint: Private Dns Enabled If Supported'
  severity: high
  rule_id: aws.ec2.vpcendpoint.private_dns_enabled_if_supported
  for_each:
    discovery: aws.ec2.vpcendpoints
    as: vpcendpoint
    item: vpcendpoint
  conditions:
    var: vpcendpoint.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 vpcendpoint:\n\n1. Ensure vpcendpoint is deployed in VPC\n2. Configure\
    \ security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n\
    3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 vpc: Dns Hostnames And Support Configured'
  severity: medium
  rule_id: aws.ec2.vpc.dns_hostnames_and_support_configured
  for_each:
    discovery: aws.ec2.vpcs
    as: vpc
    item: vpc
  conditions:
    var: vpc.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 vpc:\n\n1. Ensure vpc is deployed in VPC\n2. Configure security groups:\n\
    \   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3. Configure\
    \ network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC Endpoints\
    \ where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy in private\
    \ subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\u2022\
    \ Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 subnet: Route Table Association Present'
  severity: medium
  rule_id: aws.ec2.subnet.route_table_association_present
  for_each:
    discovery: aws.ec2.subnets
    as: subnet
    item: subnet
  conditions:
    var: subnet.compliant
    op: equals
    value: true
  remediation: "Configure ec2 subnet for compliance:\n\nRequirement: Route Table Association Present\n\nDescription: Verifies\
    \ security configuration for Amazon EC2 subnet to ensure alignment with AWS security best practices and compliance requirements.\
    \ Proper configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\n\
    Steps:\n1. Open EC2 console\n2. Select the subnet\n3. Review security configuration\n4. Apply required settings per organizational\
    \ policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected\
    \ Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\
    \u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Port Ftp Exposed To Internet Configured'
  severity: medium
  rule_id: aws.ec2.instance.port_ftp_exposed_to_internet_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Port Ftp Exposed To Internet Configuration\n\nDescription:\
    \ Verifies security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required\
    \ settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022\
    \ Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022\
    \ Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 subnet: Quarantine Network Configured'
  severity: high
  rule_id: aws.ec2.subnet.quarantine_network_configured
  for_each:
    discovery: aws.ec2.subnets
    as: subnet
    item: subnet
  conditions:
    var: subnet.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 subnet:\n\n1. Ensure subnet is deployed in VPC\n2. Configure security groups:\n\
    \   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3. Configure\
    \ network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC Endpoints\
    \ where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy in private\
    \ subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\u2022\
    \ Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Port Memcached Exposed To Internet Configured'
  severity: medium
  rule_id: aws.ec2.instance.port_memcached_exposed_to_internet_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Port Memcached Exposed To Internet Configuration\n\n\
    Description: Verifies security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply\
    \ required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 resource: Ami Public Visibility Configured'
  severity: high
  rule_id: aws.ec2.resource.ami_public_visibility_configured
  for_each:
    discovery: aws.ec2.resources
    as: resource
    item: resource
  conditions:
    var: resource.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 resource:\n\n1. Open EC2 console\n2. Select the resource\n3. Go to Permissions/Access\
    \ Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*) principals\n   -\
    \ Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access control\n7. Save\
    \ changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement condition keys for\
    \ additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\u2022 Use\
    \ AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 resource: Ebs Snapshots Encrypted'
  severity: high
  rule_id: aws.ec2.resource.ebs_snapshots_encrypted
  for_each:
    discovery: aws.ec2.resource_encryption
    as: resource
    item: resource
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for ec2 resource:\n\n1. Open EC2 console\n2. Select the resource\n3. Navigate to Properties/Configuration\
    \ > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n   - Customer managed\
    \ key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws ec2 modify-resource --resource-id <id> --encrypted\
    \ --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive data\n\u2022 Enable\
    \ automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 launchtemplate: No Public Ip Assigned Configured'
  severity: high
  rule_id: aws.ec2.launchtemplate.no_public_ip_assigned_configured
  for_each:
    discovery: aws.ec2.launchtemplates
    as: launchtemplate
    item: launchtemplate
  conditions:
    var: launchtemplate.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 launchtemplate:\n\n1. Open EC2 console\n2. Select the launchtemplate\n3. Go\
    \ to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 networkacl: Unused Network Acl Configured'
  severity: high
  rule_id: aws.ec2.networkacl.unused_network_acl_configured
  for_each:
    discovery: aws.ec2.networkacls
    as: networkacl
    item: networkacl
  conditions:
    var: networkacl.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 networkacl:\n\n1. Ensure networkacl is deployed in VPC\n2. Configure security\
    \ groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3.\
    \ Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group: Network Policies Configured'
  severity: high
  rule_id: aws.ec2.security_group.network_policies_configured
  for_each:
    discovery: aws.ec2.security_groups
    as: security_group
    item: security_group
  conditions:
    var: security_group.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group:\n\n1. Ensure security_group is deployed in VPC\n2. Configure\
    \ security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n\
    3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 eip: Not In Use'
  severity: medium
  rule_id: aws.ec2.eip.not_in_use
  for_each:
    discovery: aws.ec2.eips
    as: eip
    item: eip
  conditions:
    var: eip.compliant
    op: equals
    value: true
  remediation: "Configure ec2 eip for compliance:\n\nRequirement: Not In Use\n\nDescription: Verifies security configuration\
    \ for Amazon EC2 eip to ensure alignment with AWS security best practices and compliance requirements. Proper configuration\
    \ reduces security risks, maintains defense in depth, and supports overall security posture.\n\nSteps:\n1. Open EC2 console\n\
    2. Select the eip\n3. Review security configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n\
    6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense\
    \ in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 subnet: Automated Isolation Supported Configured'
  severity: medium
  rule_id: aws.ec2.subnet.automated_isolation_supported_configured
  for_each:
    discovery: aws.ec2.subnets
    as: subnet
    item: subnet
  conditions:
    var: subnet.compliant
    op: equals
    value: true
  remediation: "Configure ec2 subnet for compliance:\n\nRequirement: Automated Isolation Supported Configuration\n\nDescription:\
    \ Verifies security configuration for Amazon EC2 subnet to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open EC2 console\n2. Select the subnet\n3. Review security configuration\n4. Apply required settings\
    \ per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow\
    \ AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use\
    \ encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Uses Single Eni Configured'
  severity: medium
  rule_id: aws.ec2.instance.uses_single_eni_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Uses Single Eni Configuration\n\nDescription: Verifies\
    \ security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance requirements.\
    \ Proper configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\n\
    Steps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required settings per\
    \ organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS\
    \ Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption\
    \ where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 keypair: Key Max Age Days Configured'
  severity: medium
  rule_id: aws.ec2.keypair.key_max_age_days_configured
  for_each:
    discovery: aws.ec2.keypairs
    as: keypair
    item: keypair
  conditions:
    var: keypair.compliant
    op: equals
    value: true
  remediation: "Configure ec2 keypair for compliance:\n\nRequirement: Key Max Age Days Configuration\n\nDescription: Verifies\
    \ security configuration for Amazon EC2 keypair to ensure alignment with AWS security best practices and compliance requirements.\
    \ Proper configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\n\
    Steps:\n1. Open EC2 console\n2. Select the keypair\n3. Review security configuration\n4. Apply required settings per organizational\
    \ policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected\
    \ Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\
    \u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 subnet: Public Subnets Use Nacl Restrictions Configured'
  severity: high
  rule_id: aws.ec2.subnet.public_subnets_use_nacl_restrictions_configured
  for_each:
    discovery: aws.ec2.subnets
    as: subnet
    item: subnet
  conditions:
    var: subnet.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 subnet:\n\n1. Open EC2 console\n2. Select the subnet\n3. Go to Permissions/Access\
    \ Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*) principals\n   -\
    \ Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access control\n7. Save\
    \ changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement condition keys for\
    \ additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\u2022 Use\
    \ AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group: Exception Approvals Required'
  severity: medium
  rule_id: aws.ec2.security_group.exception_approvals_required
  for_each:
    discovery: aws.ec2.security_groups
    as: security_group
    item: security_group
  conditions:
    var: security_group.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group:\n\n1. Ensure security_group is deployed in VPC\n2. Configure\
    \ security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n\
    3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 volume: Encryption At Rest Enabled'
  severity: high
  rule_id: aws.ec2.volume.encryption_at_rest_enabled
  for_each:
    discovery: aws.ec2.volume_encryption
    as: volume
    item: volume
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for ec2 volume:\n\n1. Open EC2 console\n2. Select the volume\n3. Navigate to Properties/Configuration\
    \ > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n   - Customer managed\
    \ key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws ec2 modify-volume --volume-id <id> --encrypted --kms-key-id\
    \ <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive data\n\u2022 Enable automatic\
    \ key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 resource: Vpc Flow Logging Reject Enabled'
  severity: medium
  rule_id: aws.ec2.resource.vpc_flow_logging_reject_enabled
  for_each:
    discovery: aws.ec2.resource_logging
    as: resource
    item: resource
  conditions:
    var: logging.logging_enabled
    op: equals
    value: true
  remediation: "Enable logging for ec2 resource:\n\n1. Open EC2 console\n2. Select the resource\n3. Go to Logging/Monitoring\
    \ settings\n4. Enable logging\n5. Configure log destination:\n   - CloudWatch Logs\n   - S3 bucket (for long-term retention)\n\
    6. Set log level (INFO, DEBUG, ERROR)\n7. Save changes\n\nAWS CLI:\naws ec2 update-resource-logging --resource-id <id>\
    \ --logging-enabled\n\nBest Practices:\n\u2022 Enable all security-relevant log types\n\u2022 Send logs to centralized\
    \ logging service\n\u2022 Set appropriate retention periods\n\u2022 Configure log encryption\n\u2022 Set up log monitoring\
    \ and alerting"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'EC2 spotinstance: No Public Ip Assigned Configured'
  severity: high
  rule_id: aws.ec2.spotinstance.no_public_ip_assigned_configured
  for_each:
    discovery: aws.ec2.spotinstances
    as: spotinstance
    item: spotinstance
  conditions:
    var: spotinstance.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 spotinstance:\n\n1. Open EC2 console\n2. Select the spotinstance\n3. Go to\
    \ Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*)\
    \ principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access\
    \ control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 subnet: Tier To Tier Policies Configured'
  severity: medium
  rule_id: aws.ec2.subnet.tier_to_tier_policies_configured
  for_each:
    discovery: aws.ec2.subnets
    as: subnet
    item: subnet
  conditions:
    var: subnet.compliant
    op: equals
    value: true
  remediation: "Configure ec2 subnet for compliance:\n\nRequirement: Tier To Tier Policies Configuration\n\nDescription: Verifies\
    \ security configuration for Amazon EC2 subnet to ensure alignment with AWS security best practices and compliance requirements.\
    \ Proper configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\n\
    Steps:\n1. Open EC2 console\n2. Select the subnet\n3. Review security configuration\n4. Apply required settings per organizational\
    \ policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected\
    \ Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\
    \u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 network interface: Security Groups Present'
  severity: high
  rule_id: aws.ec2.network_interface.security_groups_present
  for_each:
    discovery: aws.ec2.network_interfaces
    as: network_interface
    item: network_interface
  conditions:
    var: network_interface.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 network_interface:\n\n1. Ensure network_interface is deployed in VPC\n\
    2. Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use\
    \ least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n\
    5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\
    \u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement\
    \ defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group: Tier To Tier Policies Configured'
  severity: medium
  rule_id: aws.ec2.security_group.tier_to_tier_policies_configured
  for_each:
    discovery: aws.ec2.security_groups
    as: security_group
    item: security_group
  conditions:
    var: security_group.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group:\n\n1. Ensure security_group is deployed in VPC\n2. Configure\
    \ security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n\
    3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 networkacl: Endpoint Policies Applied Configured'
  severity: medium
  rule_id: aws.ec2.networkacl.endpoint_policies_applied_configured
  for_each:
    discovery: aws.ec2.networkacls
    as: networkacl
    item: networkacl
  conditions:
    var: networkacl.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 networkacl:\n\n1. Ensure networkacl is deployed in VPC\n2. Configure security\
    \ groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3.\
    \ Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Public Ip Configured'
  severity: high
  rule_id: aws.ec2.instance.public_ip_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 instance:\n\n1. Open EC2 console\n2. Select the instance\n3. Go to Permissions/Access\
    \ Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*) principals\n   -\
    \ Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access control\n7. Save\
    \ changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement condition keys for\
    \ additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\u2022 Use\
    \ AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 ebs: Volume Encryption Configured'
  severity: high
  rule_id: aws.ec2.ebs.volume_encryption_configured
  for_each:
    discovery: aws.ec2.ebs_encryption
    as: ebs
    item: ebs
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for ec2 ebs:\n\n1. Open EC2 console\n2. Select the ebs\n3. Navigate to Properties/Configuration\
    \ > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n   - Customer managed\
    \ key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws ec2 modify-ebs --ebs-id <id> --encrypted --kms-key-id\
    \ <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive data\n\u2022 Enable automatic\
    \ key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group rdp restricted: Rdp Access Restricted'
  severity: medium
  rule_id: aws.ec2.security_group_rdp_restricted.rdp_access_restricted
  for_each:
    discovery: aws.ec2.security_group_rdp_restricteds
    as: security_group_rdp_restricted
    item: security_group_rdp_restricted
  conditions:
    var: security_group_rdp_restricted.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 security_group_rdp_restricted:\n\n1. Open EC2 console\n2. Select the security_group_rdp_restricted\n\
    3. Go to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Port Kafka Exposed To Internet Configured'
  severity: medium
  rule_id: aws.ec2.instance.port_kafka_exposed_to_internet_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Port Kafka Exposed To Internet Configuration\n\nDescription:\
    \ Verifies security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required\
    \ settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022\
    \ Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022\
    \ Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 autoscalinggroup: Uses Approved Launch Template Configured'
  severity: medium
  rule_id: aws.ec2.autoscalinggroup.uses_approved_launch_template_configured
  for_each:
    discovery: aws.ec2.autoscalinggroups
    as: autoscalinggroup
    item: autoscalinggroup
  conditions:
    var: autoscalinggroup.compliant
    op: equals
    value: true
  remediation: "Configure ec2 autoscalinggroup for compliance:\n\nRequirement: Uses Approved Launch Template Configuration\n\
    \nDescription: Verifies security configuration for Amazon EC2 autoscalinggroup to ensure alignment with AWS security best\
    \ practices and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and\
    \ supports overall security posture.\n\nSteps:\n1. Open EC2 console\n2. Select the autoscalinggroup\n3. Review security\
    \ configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral\
    \ Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable\
    \ logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group: Only Required Ports Allowed'
  severity: medium
  rule_id: aws.ec2.security_group.only_required_ports_allowed
  for_each:
    discovery: aws.ec2.security_groups
    as: security_group
    item: security_group
  conditions:
    var: security_group.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group:\n\n1. Ensure security_group is deployed in VPC\n2. Configure\
    \ security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n\
    3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 customergateway: No Public Management Interfaces Exposed Configured'
  severity: high
  rule_id: aws.ec2.customergateway.no_public_management_interfaces_exposed_configured
  for_each:
    discovery: aws.ec2.customergateways
    as: customergateway
    item: customergateway
  conditions:
    var: customergateway.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 customergateway:\n\n1. Open EC2 console\n2. Select the customergateway\n3.\
    \ Go to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group internet ingress mongodb 27017 27018: Port Mongodb Blocked'
  severity: medium
  rule_id: aws.ec2.security_group_internet_ingress_mongodb_27017_27018.port_mongodb_blocked
  for_each:
    discovery: aws.ec2.security_group_internet_ingress_mongodb_27017_27018s
    as: security_group_internet_ingress_mongodb_27017_27018
    item: security_group_internet_ingress_mongodb_27017_27018
  conditions:
    var: security_group_internet_ingress_mongodb_27017_27018.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group_internet_ingress_mongodb_27017_27018:\n\n1. Ensure security_group_internet_ingress_mongodb_27017_27018\
    \ is deployed in VPC\n2. Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source\
    \ IP ranges\n   - Use least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for\
    \ network monitoring\n5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork\
    \ Security Best Practices:\n\u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet\
    \ access\n\u2022 Implement defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group internet ingress sql server 1433 1434: Port Sql Server Blocked'
  severity: medium
  rule_id: aws.ec2.security_group_internet_ingress_sql_server_1433_1434.port_sql_server_blocked
  for_each:
    discovery: aws.ec2.security_group_internet_ingress_sql_server_1433_1434s
    as: security_group_internet_ingress_sql_server_1433_1434
    item: security_group_internet_ingress_sql_server_1433_1434
  conditions:
    var: security_group_internet_ingress_sql_server_1433_1434.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group_internet_ingress_sql_server_1433_1434:\n\n1. Ensure security_group_internet_ingress_sql_server_1433_1434\
    \ is deployed in VPC\n2. Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source\
    \ IP ranges\n   - Use least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for\
    \ network monitoring\n5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork\
    \ Security Best Practices:\n\u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet\
    \ access\n\u2022 Implement defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group not used: Unused Security Groups Removed'
  severity: high
  rule_id: aws.ec2.security_group_not_used.unused_security_groups_removed
  for_each:
    discovery: aws.ec2.security_group_not_useds
    as: security_group_not_used
    item: security_group_not_used
  conditions:
    var: security_group_not_used.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group_not_used:\n\n1. Ensure security_group_not_used is deployed\
    \ in VPC\n2. Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n\
    \   - Use least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n\
    5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\
    \u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement\
    \ defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 volume: Snapshots Exists Configured'
  severity: medium
  rule_id: aws.ec2.volume.snapshots_exists_configured
  for_each:
    discovery: aws.ec2.volumes
    as: volume
    item: volume
  conditions:
    var: volume.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for ec2 volume:\n\n1. Open EC2 console\n2. Select the volume\n3. Go to Properties > Versioning\n\
    4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\nBenefits:\n\
    \u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail of changes\n\
    \u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group: Zero Cidr Ingress Rules Blocked'
  severity: medium
  rule_id: aws.ec2.security_group.zero_cidr_ingress_rules_blocked
  for_each:
    discovery: aws.ec2.security_groups
    as: security_group
    item: security_group
  conditions:
    var: security_group.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group:\n\n1. Ensure security_group is deployed in VPC\n2. Configure\
    \ security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n\
    3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 volume: Protected By Backup Plan Configured'
  severity: medium
  rule_id: aws.ec2.volume.protected_by_backup_plan_configured
  for_each:
    discovery: aws.ec2.volumes
    as: volume
    item: volume
  conditions:
    var: volume.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for ec2 volume:\n\n1. Open EC2 console\n2. Select the volume\n3. Go to Properties > Versioning\n\
    4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\nBenefits:\n\
    \u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail of changes\n\
    \u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'EC2 launchtemplate: Instance Profile Least Privilege'
  severity: high
  rule_id: aws.ec2.launchtemplate.instance_profile_least_privilege
  for_each:
    discovery: aws.ec2.launchtemplates
    as: launchtemplate
    item: launchtemplate
  conditions:
    var: launchtemplate.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 launchtemplate:\n\n1. Open EC2 console\n2. Select the launchtemplate\n3. Go\
    \ to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'EC2 vpc: Automated Isolation Supported Configured'
  severity: medium
  rule_id: aws.ec2.vpc.automated_isolation_supported_configured
  for_each:
    discovery: aws.ec2.vpcs
    as: vpc
    item: vpc
  conditions:
    var: vpc.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 vpc:\n\n1. Ensure vpc is deployed in VPC\n2. Configure security groups:\n\
    \   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3. Configure\
    \ network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC Endpoints\
    \ where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy in private\
    \ subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\u2022\
    \ Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 spotinstance: Instance Uses Approved Launch Template Configured'
  severity: medium
  rule_id: aws.ec2.spotinstance.instance_uses_approved_launch_template_configured
  for_each:
    discovery: aws.ec2.spotinstances
    as: spotinstance
    item: spotinstance
  conditions:
    var: spotinstance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 spotinstance for compliance:\n\nRequirement: Instance Uses Approved Launch Template Configuration\n\
    \nDescription: Verifies security configuration for Amazon EC2 spotinstance to ensure alignment with AWS security best\
    \ practices and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and\
    \ supports overall security posture.\n\nSteps:\n1. Open EC2 console\n2. Select the spotinstance\n3. Review security configuration\n\
    4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 resource: Launch Template Imdsv2 Required'
  severity: medium
  rule_id: aws.ec2.resource.launch_template_imdsv2_required
  for_each:
    discovery: aws.ec2.resources
    as: resource
    item: resource
  conditions:
    var: resource.compliant
    op: equals
    value: true
  remediation: "Configure ec2 resource for compliance:\n\nRequirement: Launch Template Imdsv2 Required\n\nDescription: Verifies\
    \ security configuration for Amazon EC2 resource to ensure alignment with AWS security best practices and compliance requirements.\
    \ Proper configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\n\
    Steps:\n1. Open EC2 console\n2. Select the resource\n3. Review security configuration\n4. Apply required settings per\
    \ organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS\
    \ Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption\
    \ where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 dedicatedhost: Host Sharing Restricted'
  severity: medium
  rule_id: aws.ec2.dedicatedhost.host_sharing_restricted
  for_each:
    discovery: aws.ec2.dedicatedhosts
    as: dedicatedhost
    item: dedicatedhost
  conditions:
    var: dedicatedhost.compliant
    op: equals
    value: true
  remediation: "Configure ec2 dedicatedhost for compliance:\n\nRequirement: Host Sharing Restricted\n\nDescription: Verifies\
    \ security configuration for Amazon EC2 dedicatedhost to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open EC2 console\n2. Select the dedicatedhost\n3. Review security configuration\n4. Apply required\
    \ settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022\
    \ Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022\
    \ Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 dedicatedhost: Instance Auto Placement Controlled Configured'
  severity: medium
  rule_id: aws.ec2.dedicatedhost.instance_auto_placement_controlled_configured
  for_each:
    discovery: aws.ec2.dedicatedhosts
    as: dedicatedhost
    item: dedicatedhost
  conditions:
    var: dedicatedhost.compliant
    op: equals
    value: true
  remediation: "Configure ec2 dedicatedhost for compliance:\n\nRequirement: Instance Auto Placement Controlled Configuration\n\
    \nDescription: Verifies security configuration for Amazon EC2 dedicatedhost to ensure alignment with AWS security best\
    \ practices and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and\
    \ supports overall security posture.\n\nSteps:\n1. Open EC2 console\n2. Select the dedicatedhost\n3. Review security configuration\n\
    4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group: Permit All Egress Rules Blocked'
  severity: medium
  rule_id: aws.ec2.security_group.permit_all_egress_rules_blocked
  for_each:
    discovery: aws.ec2.security_groups
    as: security_group
    item: security_group
  conditions:
    var: security_group.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group:\n\n1. Ensure security_group is deployed in VPC\n2. Configure\
    \ security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n\
    3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 group: Ingress Ipv6 Restriction Configured'
  severity: medium
  rule_id: aws.ec2.group.ingress_ipv6_restriction_configured
  for_each:
    discovery: aws.ec2.groups
    as: group
    item: group
  conditions:
    var: group.compliant
    op: equals
    value: true
  remediation: "Configure ec2 group for compliance:\n\nRequirement: Ingress Ipv6 Restriction Configuration\n\nDescription:\
    \ Verifies security configuration for Amazon EC2 group to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open EC2 console\n2. Select the group\n3. Review security configuration\n4. Apply required settings\
    \ per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow\
    \ AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use\
    \ encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 spotinstance: Instance Profile Least Privilege'
  severity: high
  rule_id: aws.ec2.spotinstance.instance_profile_least_privilege
  for_each:
    discovery: aws.ec2.spotinstances
    as: spotinstance
    item: spotinstance
  conditions:
    var: spotinstance.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 spotinstance:\n\n1. Open EC2 console\n2. Select the spotinstance\n3. Go to\
    \ Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*)\
    \ principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access\
    \ control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'EC2 security group: Policy Store Encrypted Configured'
  severity: high
  rule_id: aws.ec2.security_group.policy_store_encrypted_configured
  for_each:
    discovery: aws.ec2.security_group_encryption
    as: security_group
    item: security_group
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for ec2 security_group:\n\n1. Open EC2 console\n2. Select the security_group\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws ec2 modify-security_group --security_group-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Ssh Key Based Auth Required'
  severity: medium
  rule_id: aws.ec2.instance.ssh_key_based_auth_required
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Ssh Key Based Auth Required\n\nDescription: Verifies\
    \ security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance requirements.\
    \ Proper configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\n\
    Steps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required settings per\
    \ organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS\
    \ Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption\
    \ where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 vpc: Tier To Tier Policies Configured'
  severity: medium
  rule_id: aws.ec2.vpc.tier_to_tier_policies_configured
  for_each:
    discovery: aws.ec2.vpcs
    as: vpc
    item: vpc
  conditions:
    var: vpc.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 vpc:\n\n1. Ensure vpc is deployed in VPC\n2. Configure security groups:\n\
    \   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3. Configure\
    \ network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC Endpoints\
    \ where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy in private\
    \ subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\u2022\
    \ Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Data Volumes Encrypted Cmek'
  severity: high
  rule_id: aws.ec2.instance.data_volumes_encrypted_cmek
  for_each:
    discovery: aws.ec2.instance_encryption
    as: instance
    item: instance
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for ec2 instance:\n\n1. Open EC2 console\n2. Select the instance\n3. Navigate to Properties/Configuration\
    \ > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n   - Customer managed\
    \ key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws ec2 modify-instance --instance-id <id> --encrypted\
    \ --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive data\n\u2022 Enable\
    \ automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Paravirtual Type Configured'
  severity: medium
  rule_id: aws.ec2.instance.paravirtual_type_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Paravirtual Type Configuration\n\nDescription: Verifies\
    \ security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance requirements.\
    \ Proper configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\n\
    Steps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required settings per\
    \ organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS\
    \ Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption\
    \ where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 keypair: Disable Unused Keys Configured'
  severity: medium
  rule_id: aws.ec2.keypair.disable_unused_keys_configured
  for_each:
    discovery: aws.ec2.keypairs
    as: keypair
    item: keypair
  conditions:
    var: keypair.compliant
    op: equals
    value: true
  remediation: "Configure ec2 keypair for compliance:\n\nRequirement: Disable Unused Keys Configuration\n\nDescription: Verifies\
    \ security configuration for Amazon EC2 keypair to ensure alignment with AWS security best practices and compliance requirements.\
    \ Proper configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\n\
    Steps:\n1. Open EC2 console\n2. Select the keypair\n3. Review security configuration\n4. Apply required settings per organizational\
    \ policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected\
    \ Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\
    \u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Managed By Ssm Configured'
  severity: medium
  rule_id: aws.ec2.instance.managed_by_ssm_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Managed By Ssm Configuration\n\nDescription: Verifies\
    \ security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance requirements.\
    \ Proper configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\n\
    Steps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required settings per\
    \ organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS\
    \ Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption\
    \ where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 vpnconnection: Tunnel Health Monitoring Enabled'
  severity: medium
  rule_id: aws.ec2.vpnconnection.tunnel_health_monitoring_enabled
  for_each:
    discovery: aws.ec2.vpnconnections
    as: vpnconnection
    item: vpnconnection
  conditions:
    var: vpnconnection.monitoring_enabled
    op: equals
    value: true
  remediation: "Enable monitoring for ec2 vpnconnection:\n\n1. Open CloudWatch console\n2. Create alarm for vpnconnection\n\
    3. Configure metrics to monitor\n4. Set alarm thresholds\n5. Configure SNS notifications\n6. Enable detailed monitoring\
    \ (if available)\n7. Create dashboard for visualization\n\nMonitoring Best Practices:\n\u2022 Monitor security-relevant\
    \ metrics\n\u2022 Set up automated alerting\n\u2022 Integrate with SIEM/SOC\n\u2022 Regular review of metrics\n\u2022\
    \ Implement automated remediation"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group: Identity Aware Network Policies Enabled'
  severity: high
  rule_id: aws.ec2.security_group.identity_aware_network_policies_enabled
  for_each:
    discovery: aws.ec2.security_groups
    as: security_group
    item: security_group
  conditions:
    var: security_group.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group:\n\n1. Ensure security_group is deployed in VPC\n2. Configure\
    \ security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n\
    3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group from launch wizard: Launch Wizard Created Configured'
  severity: medium
  rule_id: aws.ec2.security_group_from_launch_wizard.launch_wizard_created_configured
  for_each:
    discovery: aws.ec2.security_group_from_launch_wizards
    as: security_group_from_launch_wizard
    item: security_group_from_launch_wizard
  conditions:
    var: security_group_from_launch_wizard.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group_from_launch_wizard:\n\n1. Ensure security_group_from_launch_wizard\
    \ is deployed in VPC\n2. Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source\
    \ IP ranges\n   - Use least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for\
    \ network monitoring\n5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork\
    \ Security Best Practices:\n\u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet\
    \ access\n\u2022 Implement defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 autoscalinggroup: No Public Ip Assigned Configured'
  severity: high
  rule_id: aws.ec2.autoscalinggroup.no_public_ip_assigned_configured
  for_each:
    discovery: aws.ec2.autoscalinggroups
    as: autoscalinggroup
    item: autoscalinggroup
  conditions:
    var: autoscalinggroup.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 autoscalinggroup:\n\n1. Open EC2 console\n2. Select the autoscalinggroup\n\
    3. Go to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Port Cassandra Exposed To Internet Configured'
  severity: medium
  rule_id: aws.ec2.instance.port_cassandra_exposed_to_internet_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Port Cassandra Exposed To Internet Configuration\n\n\
    Description: Verifies security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply\
    \ required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group: Allow Ingress From Internet To Tcp Port 22 Configured'
  severity: medium
  rule_id: aws.ec2.security_group.allow_ingress_from_internet_to_tcp_port_22_configured
  for_each:
    discovery: aws.ec2.security_groups
    as: security_group
    item: security_group
  conditions:
    var: security_group.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group:\n\n1. Ensure security_group is deployed in VPC\n2. Configure\
    \ security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n\
    3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Port Sqlserver Exposed To Internet Configured'
  severity: medium
  rule_id: aws.ec2.instance.port_sqlserver_exposed_to_internet_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Port Sqlserver Exposed To Internet Configuration\n\n\
    Description: Verifies security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply\
    \ required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group internet ingress oracle 1521 2483: Port Oracle Blocked'
  severity: medium
  rule_id: aws.ec2.security_group_internet_ingress_oracle_1521_2483.port_oracle_blocked
  for_each:
    discovery: aws.ec2.security_group_internet_ingress_oracle_1521_2483s
    as: security_group_internet_ingress_oracle_1521_2483
    item: security_group_internet_ingress_oracle_1521_2483
  conditions:
    var: security_group_internet_ingress_oracle_1521_2483.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group_internet_ingress_oracle_1521_2483:\n\n1. Ensure security_group_internet_ingress_oracle_1521_2483\
    \ is deployed in VPC\n2. Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source\
    \ IP ranges\n   - Use least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for\
    \ network monitoring\n5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork\
    \ Security Best Practices:\n\u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet\
    \ access\n\u2022 Implement defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 eip: Shodan Exposure Detected'
  severity: medium
  rule_id: aws.ec2.eip.shodan_exposure_detected
  for_each:
    discovery: aws.ec2.eips
    as: eip
    item: eip
  conditions:
    var: eip.compliant
    op: equals
    value: true
  remediation: "Configure ec2 eip for compliance:\n\nRequirement: Shodan Exposure Detected\n\nDescription: Verifies security\
    \ configuration for Amazon EC2 eip to ensure alignment with AWS security best practices and compliance requirements. Proper\
    \ configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\nSteps:\n\
    1. Open EC2 console\n2. Select the eip\n3. Review security configuration\n4. Apply required settings per organizational\
    \ policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected\
    \ Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\
    \u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 reserved instance: Instance Approval Workflow Required'
  severity: medium
  rule_id: aws.ec2.reserved_instance.instance_approval_workflow_required
  for_each:
    discovery: aws.ec2.reserved_instances
    as: reserved_instance
    item: reserved_instance
  conditions:
    var: reserved_instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 reserved_instance for compliance:\n\nRequirement: Instance Approval Workflow Required\n\nDescription:\
    \ Verifies security configuration for Amazon EC2 reserved instance to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open EC2 console\n2. Select the reserved_instance\n3. Review security configuration\n\
    4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Secrets User Data Configured'
  severity: medium
  rule_id: aws.ec2.instance.secrets_user_data_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Secrets User Data Configuration\n\nDescription: Verifies\
    \ security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance requirements.\
    \ Proper configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\n\
    Steps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required settings per\
    \ organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS\
    \ Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption\
    \ where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group: Egress Access Restricted'
  severity: medium
  rule_id: aws.ec2.security_group.egress_access_restricted
  for_each:
    discovery: aws.ec2.security_groups
    as: security_group
    item: security_group
  conditions:
    var: security_group.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 security_group:\n\n1. Open EC2 console\n2. Select the security_group\n3. Go\
    \ to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 launchtemplate: User Data No Secrets Configured'
  severity: medium
  rule_id: aws.ec2.launchtemplate.user_data_no_secrets_configured
  for_each:
    discovery: aws.ec2.launchtemplates
    as: launchtemplate
    item: launchtemplate
  conditions:
    var: launchtemplate.compliant
    op: equals
    value: true
  remediation: "Configure ec2 launchtemplate for compliance:\n\nRequirement: User Data No Secrets Configuration\n\nDescription:\
    \ Verifies security configuration for Amazon EC2 launchtemplate to ensure alignment with AWS security best practices and\
    \ compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open EC2 console\n2. Select the launchtemplate\n3. Review security configuration\n4.\
    \ Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 networkacl: Unrestricted Ingress Blocked'
  severity: medium
  rule_id: aws.ec2.networkacl.unrestricted_ingress_blocked
  for_each:
    discovery: aws.ec2.networkacls
    as: networkacl
    item: networkacl
  conditions:
    var: networkacl.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 networkacl:\n\n1. Ensure networkacl is deployed in VPC\n2. Configure security\
    \ groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3.\
    \ Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 subnet: Default Deny Between Tiers Configured'
  severity: medium
  rule_id: aws.ec2.subnet.default_deny_between_tiers_configured
  for_each:
    discovery: aws.ec2.subnets
    as: subnet
    item: subnet
  conditions:
    var: subnet.compliant
    op: equals
    value: true
  remediation: "Configure ec2 subnet for compliance:\n\nRequirement: Default Deny Between Tiers Configuration\n\nDescription:\
    \ Verifies security configuration for Amazon EC2 subnet to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open EC2 console\n2. Select the subnet\n3. Review security configuration\n4. Apply required settings\
    \ per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow\
    \ AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use\
    \ encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 networkacl: Ssh Port 22 Restricted'
  severity: medium
  rule_id: aws.ec2.networkacl.ssh_port_22_restricted
  for_each:
    discovery: aws.ec2.networkacls
    as: networkacl
    item: networkacl
  conditions:
    var: networkacl.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 networkacl:\n\n1. Ensure networkacl is deployed in VPC\n2. Configure security\
    \ groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3.\
    \ Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 reserved instance: Purchase Permissions Restricted'
  severity: high
  rule_id: aws.ec2.reserved_instance.purchase_permissions_restricted
  for_each:
    discovery: aws.ec2.reserved_instances
    as: reserved_instance
    item: reserved_instance
  conditions:
    var: reserved_instance.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 reserved_instance:\n\n1. Open EC2 console\n2. Select the reserved_instance\n\
    3. Go to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 routetable: No 0 From Private Subnets Configured'
  severity: high
  rule_id: aws.ec2.routetable.no_0_from_private_subnets_configured
  for_each:
    discovery: aws.ec2.routetables
    as: routetable
    item: routetable
  conditions:
    var: routetable.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 routetable:\n\n1. Ensure routetable is deployed in VPC\n2. Configure security\
    \ groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3.\
    \ Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Port Mongodb Exposed To Internet Configured'
  severity: medium
  rule_id: aws.ec2.instance.port_mongodb_exposed_to_internet_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Port Mongodb Exposed To Internet Configuration\n\n\
    Description: Verifies security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply\
    \ required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group default restrict traffic: Default Deny All Traffic Enforced'
  severity: medium
  rule_id: aws.ec2.security_group_default_restrict_traffic.default_deny_all_traffic_enforced
  for_each:
    discovery: aws.ec2.security_group_default_restrict_traffics
    as: security_group_default_restrict_traffic
    item: security_group_default_restrict_traffic
  conditions:
    var: security_group_default_restrict_traffic.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group_default_restrict_traffic:\n\n1. Ensure security_group_default_restrict_traffic\
    \ is deployed in VPC\n2. Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source\
    \ IP ranges\n   - Use least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for\
    \ network monitoring\n5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork\
    \ Security Best Practices:\n\u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet\
    \ access\n\u2022 Implement defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 vpc: Flow Logging Enabled'
  severity: medium
  rule_id: aws.ec2.vpc.flow_logging_enabled
  for_each:
    discovery: aws.ec2.vpc_logging
    as: vpc
    item: vpc
  conditions:
    var: logging.logging_enabled
    op: equals
    value: true
  remediation: "Enable logging for ec2 vpc:\n\n1. Open EC2 console\n2. Select the vpc\n3. Go to Logging/Monitoring settings\n\
    4. Enable logging\n5. Configure log destination:\n   - CloudWatch Logs\n   - S3 bucket (for long-term retention)\n6. Set\
    \ log level (INFO, DEBUG, ERROR)\n7. Save changes\n\nAWS CLI:\naws ec2 update-vpc-logging --vpc-id <id> --logging-enabled\n\
    \nBest Practices:\n\u2022 Enable all security-relevant log types\n\u2022 Send logs to centralized logging service\n\u2022\
    \ Set appropriate retention periods\n\u2022 Configure log encryption\n\u2022 Set up log monitoring and alerting"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'EC2 snapshot: Encryption At Rest Enabled'
  severity: high
  rule_id: aws.ec2.snapshot.encryption_at_rest_enabled
  for_each:
    discovery: aws.ec2.snapshot_encryption
    as: snapshot
    item: snapshot
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for ec2 snapshot:\n\n1. Open EC2 console\n2. Select the snapshot\n3. Navigate to Properties/Configuration\
    \ > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n   - Customer managed\
    \ key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws ec2 modify-snapshot --snapshot-id <id> --encrypted\
    \ --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive data\n\u2022 Enable\
    \ automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Port Rdp Exposed To Internet Configured'
  severity: medium
  rule_id: aws.ec2.instance.port_rdp_exposed_to_internet_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Port Rdp Exposed To Internet Configuration\n\nDescription:\
    \ Verifies security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required\
    \ settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022\
    \ Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022\
    \ Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Detailed Monitoring Enabled'
  severity: medium
  rule_id: aws.ec2.instance.detailed_monitoring_enabled
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.monitoring_enabled
    op: equals
    value: true
  remediation: "Enable monitoring for ec2 instance:\n\n1. Open CloudWatch console\n2. Create alarm for instance\n3. Configure\
    \ metrics to monitor\n4. Set alarm thresholds\n5. Configure SNS notifications\n6. Enable detailed monitoring (if available)\n\
    7. Create dashboard for visualization\n\nMonitoring Best Practices:\n\u2022 Monitor security-relevant metrics\n\u2022\
    \ Set up automated alerting\n\u2022 Integrate with SIEM/SOC\n\u2022 Regular review of metrics\n\u2022 Implement automated\
    \ remediation"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 ami: Encryption At Rest Enabled'
  severity: high
  rule_id: aws.ec2.ami.encryption_at_rest_enabled
  for_each:
    discovery: aws.ec2.ami_encryption
    as: ami
    item: ami
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for ec2 ami:\n\n1. Open EC2 console\n2. Select the ami\n3. Navigate to Properties/Configuration\
    \ > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n   - Customer managed\
    \ key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws ec2 modify-ami --ami-id <id> --encrypted --kms-key-id\
    \ <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive data\n\u2022 Enable automatic\
    \ key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 routetable: Vpc Endpoints Used For Saas If Supported'
  severity: high
  rule_id: aws.ec2.routetable.vpc_endpoints_used_for_saas_if_supported
  for_each:
    discovery: aws.ec2.routetables
    as: routetable
    item: routetable
  conditions:
    var: routetable.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 routetable:\n\n1. Ensure routetable is deployed in VPC\n2. Configure security\
    \ groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3.\
    \ Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 ami: Image Signed And Verified'
  severity: medium
  rule_id: aws.ec2.ami.image_signed_and_verified
  for_each:
    discovery: aws.ec2.amis
    as: ami
    item: ami
  conditions:
    var: ami.compliant
    op: equals
    value: true
  remediation: "Configure ec2 ami for compliance:\n\nRequirement: Image Signed And Verified\n\nDescription: Verifies security\
    \ configuration for Amazon EC2 ami to ensure alignment with AWS security best practices and compliance requirements. Proper\
    \ configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\nSteps:\n\
    1. Open EC2 console\n2. Select the ami\n3. Review security configuration\n4. Apply required settings per organizational\
    \ policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected\
    \ Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\
    \u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 networkacl: Network No Unrestricted Ingress Configured'
  severity: high
  rule_id: aws.ec2.networkacl.network_no_unrestricted_ingress_configured
  for_each:
    discovery: aws.ec2.networkacls
    as: networkacl
    item: networkacl
  conditions:
    var: networkacl.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 networkacl:\n\n1. Ensure networkacl is deployed in VPC\n2. Configure security\
    \ groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3.\
    \ Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 vpc: Default Deny Between Tiers Configured'
  severity: medium
  rule_id: aws.ec2.vpc.default_deny_between_tiers_configured
  for_each:
    discovery: aws.ec2.vpcs
    as: vpc
    item: vpc
  conditions:
    var: vpc.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 vpc:\n\n1. Ensure vpc is deployed in VPC\n2. Configure security groups:\n\
    \   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3. Configure\
    \ network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC Endpoints\
    \ where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy in private\
    \ subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\u2022\
    \ Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group internet ingress cassandra 7199 9160 8888: Port Cassandra 7199 Blocked'
  severity: medium
  rule_id: aws.ec2.security_group_internet_ingress_cassandra_7199_9160_8888.port_cassandra_7199_blocked
  for_each:
    discovery: aws.ec2.security_group_internet_ingress_cassandra_7199_9160_8888s
    as: security_group_internet_ingress_cassandra_7199_9160_8888
    item: security_group_internet_ingress_cassandra_7199_9160_8888
  conditions:
    var: security_group_internet_ingress_cassandra_7199_9160_8888.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group_internet_ingress_cassandra_7199_9160_8888:\n\n1. Ensure\
    \ security_group_internet_ingress_cassandra_7199_9160_8888 is deployed in VPC\n2. Configure security groups:\n   - Restrict\
    \ inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3. Configure network ACLs\
    \ for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC Endpoints where available\n\
    6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy in private subnets when possible\n\
    \u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\u2022 Enable encryption in transit\n\
    \u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 launchtemplate: Imds Hardened Configured'
  severity: medium
  rule_id: aws.ec2.launchtemplate.imds_hardened_configured
  for_each:
    discovery: aws.ec2.launchtemplates
    as: launchtemplate
    item: launchtemplate
  conditions:
    var: launchtemplate.compliant
    op: equals
    value: true
  remediation: "Configure ec2 launchtemplate for compliance:\n\nRequirement: Imds Hardened Configuration\n\nDescription: Verifies\
    \ security configuration for Amazon EC2 launchtemplate to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open EC2 console\n2. Select the launchtemplate\n3. Review security configuration\n4. Apply required\
    \ settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022\
    \ Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022\
    \ Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group common ports restricted: Common Ports Ingress Restricted'
  severity: medium
  rule_id: aws.ec2.security_group_common_ports_restricted.common_ports_ingress_restricted
  for_each:
    discovery: aws.ec2.security_group_common_ports_restricteds
    as: security_group_common_ports_restricted
    item: security_group_common_ports_restricted
  conditions:
    var: security_group_common_ports_restricted.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group_common_ports_restricted:\n\n1. Ensure security_group_common_ports_restricted\
    \ is deployed in VPC\n2. Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source\
    \ IP ranges\n   - Use least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for\
    \ network monitoring\n5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork\
    \ Security Best Practices:\n\u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet\
    \ access\n\u2022 Implement defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 launchtemplate: Uses Approved Configured'
  severity: medium
  rule_id: aws.ec2.launchtemplate.uses_approved_configured
  for_each:
    discovery: aws.ec2.launchtemplates
    as: launchtemplate
    item: launchtemplate
  conditions:
    var: launchtemplate.compliant
    op: equals
    value: true
  remediation: "Configure ec2 launchtemplate for compliance:\n\nRequirement: Uses Approved Configuration\n\nDescription: Verifies\
    \ security configuration for Amazon EC2 launchtemplate to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open EC2 console\n2. Select the launchtemplate\n3. Review security configuration\n4. Apply required\
    \ settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022\
    \ Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022\
    \ Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 snapshot: Cross Region Copy Encrypted'
  severity: high
  rule_id: aws.ec2.snapshot.cross_region_copy_encrypted
  for_each:
    discovery: aws.ec2.snapshot_encryption
    as: snapshot
    item: snapshot
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for ec2 snapshot:\n\n1. Open EC2 console\n2. Select the snapshot\n3. Navigate to Properties/Configuration\
    \ > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n   - Customer managed\
    \ key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws ec2 modify-snapshot --snapshot-id <id> --encrypted\
    \ --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive data\n\u2022 Enable\
    \ automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group internet ingress ftp 20 21: Port Ftp Blocked'
  severity: medium
  rule_id: aws.ec2.security_group_internet_ingress_ftp_20_21.port_ftp_blocked
  for_each:
    discovery: aws.ec2.security_group_internet_ingress_ftp_20_21s
    as: security_group_internet_ingress_ftp_20_21
    item: security_group_internet_ingress_ftp_20_21
  conditions:
    var: security_group_internet_ingress_ftp_20_21.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group_internet_ingress_ftp_20_21:\n\n1. Ensure security_group_internet_ingress_ftp_20_21\
    \ is deployed in VPC\n2. Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source\
    \ IP ranges\n   - Use least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for\
    \ network monitoring\n5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork\
    \ Security Best Practices:\n\u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet\
    \ access\n\u2022 Implement defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 launchtemplate: Security Groups Restrictive Configured'
  severity: high
  rule_id: aws.ec2.launchtemplate.security_groups_restrictive_configured
  for_each:
    discovery: aws.ec2.launchtemplates
    as: launchtemplate
    item: launchtemplate
  conditions:
    var: launchtemplate.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 launchtemplate:\n\n1. Ensure launchtemplate is deployed in VPC\n2. Configure\
    \ security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n\
    3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Imds Hardened Configured'
  severity: medium
  rule_id: aws.ec2.instance.imds_hardened_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Imds Hardened Configuration\n\nDescription: Verifies\
    \ security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance requirements.\
    \ Proper configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\n\
    Steps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required settings per\
    \ organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS\
    \ Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption\
    \ where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group internet ingress high risk ports: Internet Ingress High Risk Ports Blocked'
  severity: medium
  rule_id: aws.ec2.security_group_internet_ingress_high_risk_ports.internet_ingress_high_risk_ports_blocked
  for_each:
    discovery: aws.ec2.security_group_internet_ingress_high_risk_portss
    as: security_group_internet_ingress_high_risk_ports
    item: security_group_internet_ingress_high_risk_ports
  conditions:
    var: security_group_internet_ingress_high_risk_ports.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group_internet_ingress_high_risk_ports:\n\n1. Ensure security_group_internet_ingress_high_risk_ports\
    \ is deployed in VPC\n2. Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source\
    \ IP ranges\n   - Use least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for\
    \ network monitoring\n5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork\
    \ Security Best Practices:\n\u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet\
    \ access\n\u2022 Implement defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 ami: Vuln Scanned No Critical Configured'
  severity: medium
  rule_id: aws.ec2.ami.vuln_scanned_no_critical_configured
  for_each:
    discovery: aws.ec2.amis
    as: ami
    item: ami
  conditions:
    var: ami.compliant
    op: equals
    value: true
  remediation: "Configure ec2 ami for compliance:\n\nRequirement: Vuln Scanned No Critical Configuration\n\nDescription: Verifies\
    \ security configuration for Amazon EC2 ami to ensure alignment with AWS security best practices and compliance requirements.\
    \ Proper configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\n\
    Steps:\n1. Open EC2 console\n2. Select the ami\n3. Review security configuration\n4. Apply required settings per organizational\
    \ policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected\
    \ Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\
    \u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 autoscalinggroup: Volumes Encrypted'
  severity: high
  rule_id: aws.ec2.autoscalinggroup.volumes_encrypted
  for_each:
    discovery: aws.ec2.autoscalinggroup_encryption
    as: autoscalinggroup
    item: autoscalinggroup
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for ec2 autoscalinggroup:\n\n1. Open EC2 console\n2. Select the autoscalinggroup\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws ec2 modify-autoscalinggroup --autoscalinggroup-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Secure Boot Enabled'
  severity: medium
  rule_id: aws.ec2.instance.secure_boot_enabled
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Secure Boot Enabled\n\nDescription: Verifies security\
    \ configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance requirements.\
    \ Proper configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\n\
    Steps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required settings per\
    \ organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS\
    \ Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption\
    \ where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 customergateway: Api Ip Addresses Valid And Owned Configured'
  severity: medium
  rule_id: aws.ec2.customergateway.api_ip_addresses_valid_and_owned_configured
  for_each:
    discovery: aws.ec2.customergateway_encryption
    as: customergateway
    item: customergateway
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for ec2 customergateway:\n\n1. Open EC2 console\n2. Select the customergateway\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws ec2 modify-customergateway --customergateway-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 snapshot: Not Public Configured'
  severity: high
  rule_id: aws.ec2.snapshot.not_public_configured
  for_each:
    discovery: aws.ec2.snapshots
    as: snapshot
    item: snapshot
  conditions:
    var: snapshot.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 snapshot:\n\n1. Open EC2 console\n2. Select the snapshot\n3. Go to Permissions/Access\
    \ Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*) principals\n   -\
    \ Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access control\n7. Save\
    \ changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement condition keys for\
    \ additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\u2022 Use\
    \ AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 volume: Cmk Cmek Configured'
  severity: medium
  rule_id: aws.ec2.volume.cmk_cmek_configured
  for_each:
    discovery: aws.ec2.volume_encryption
    as: volume
    item: volume
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for ec2 volume:\n\n1. Open EC2 console\n2. Select the volume\n3. Navigate to Properties/Configuration\
    \ > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n   - Customer managed\
    \ key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws ec2 modify-volume --volume-id <id> --encrypted --kms-key-id\
    \ <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive data\n\u2022 Enable automatic\
    \ key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Port Telnet Exposed To Internet Configured'
  severity: medium
  rule_id: aws.ec2.instance.port_telnet_exposed_to_internet_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Port Telnet Exposed To Internet Configuration\n\nDescription:\
    \ Verifies security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required\
    \ settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022\
    \ Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022\
    \ Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Security Group Inbound Restricted'
  severity: high
  rule_id: aws.ec2.instance.security_group_inbound_restricted
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 instance:\n\n1. Ensure instance is deployed in VPC\n2. Configure security\
    \ groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3.\
    \ Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 volume: In Use Configured'
  severity: medium
  rule_id: aws.ec2.volume.in_use_configured
  for_each:
    discovery: aws.ec2.volumes
    as: volume
    item: volume
  conditions:
    var: volume.compliant
    op: equals
    value: true
  remediation: "Configure ec2 volume for compliance:\n\nRequirement: In Use Configuration\n\nDescription: Verifies security\
    \ configuration for Amazon EC2 volume to ensure alignment with AWS security best practices and compliance requirements.\
    \ Proper configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\n\
    Steps:\n1. Open EC2 console\n2. Select the volume\n3. Review security configuration\n4. Apply required settings per organizational\
    \ policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected\
    \ Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\
    \u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 vpc: Route Tables No Unintended Internet Paths Configured'
  severity: medium
  rule_id: aws.ec2.vpc.route_tables_no_unintended_internet_paths_configured
  for_each:
    discovery: aws.ec2.vpcs
    as: vpc
    item: vpc
  conditions:
    var: vpc.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 vpc:\n\n1. Ensure vpc is deployed in VPC\n2. Configure security groups:\n\
    \   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3. Configure\
    \ network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC Endpoints\
    \ where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy in private\
    \ subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\u2022\
    \ Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Imdsv2 Enabled'
  severity: medium
  rule_id: aws.ec2.instance.imdsv2_enabled
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Imdsv2 Enabled\n\nDescription: Verifies security configuration\
    \ for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance requirements. Proper configuration\
    \ reduces security risks, maintains defense in depth, and supports overall security posture.\n\nSteps:\n1. Open EC2 console\n\
    2. Select the instance\n3. Review security configuration\n4. Apply required settings per organizational policy\n5. Verify\
    \ compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022\
    \ Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular\
    \ security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group internet ingress elasticsearch kibana 9200 9300 5601: Port Elasticsearch Kibana 9200 Blocked'
  severity: medium
  rule_id: aws.ec2.security_group_internet_ingress_elasticsearch_kibana_9200_9300_5601.port_elasticsearch_kibana_9200_blocked
  for_each:
    discovery: aws.ec2.security_group_internet_ingress_elasticsearch_kibana_9200_9300_5601s
    as: security_group_internet_ingress_elasticsearch_kibana_9200_9300_5601
    item: security_group_internet_ingress_elasticsearch_kibana_9200_9300_5601
  conditions:
    var: security_group_internet_ingress_elasticsearch_kibana_9200_9300_5601.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group_internet_ingress_elasticsearch_kibana_9200_9300_5601:\n\n\
    1. Ensure security_group_internet_ingress_elasticsearch_kibana_9200_9300_5601 is deployed in VPC\n2. Configure security\
    \ groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3.\
    \ Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 transitgateway: Auto Cross Account Attachment Disabled'
  severity: medium
  rule_id: aws.ec2.transitgateway.auto_cross_account_attachment_disabled
  for_each:
    discovery: aws.ec2.transitgateways
    as: transitgateway
    item: transitgateway
  conditions:
    var: transitgateway.compliant
    op: equals
    value: true
  remediation: "Configure ec2 transitgateway for compliance:\n\nRequirement: Auto Cross Account Attachment Disabled\n\nDescription:\
    \ Verifies security configuration for Amazon EC2 transitgateway to ensure alignment with AWS security best practices and\
    \ compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open EC2 console\n2. Select the transitgateway\n3. Review security configuration\n4.\
    \ Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 volume: Snapshots Encrypted'
  severity: high
  rule_id: aws.ec2.volume.snapshots_encrypted
  for_each:
    discovery: aws.ec2.volume_encryption
    as: volume
    item: volume
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for ec2 volume:\n\n1. Open EC2 console\n2. Select the volume\n3. Navigate to Properties/Configuration\
    \ > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n   - Customer managed\
    \ key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws ec2 modify-volume --volume-id <id> --encrypted --kms-key-id\
    \ <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive data\n\u2022 Enable automatic\
    \ key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 group: Cifs Unrestricted Access Configured'
  severity: medium
  rule_id: aws.ec2.group.cifs_unrestricted_access_configured
  for_each:
    discovery: aws.ec2.groups
    as: group
    item: group
  conditions:
    var: group.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 group:\n\n1. Open EC2 console\n2. Select the group\n3. Go to Permissions/Access\
    \ Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*) principals\n   -\
    \ Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access control\n7. Save\
    \ changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement condition keys for\
    \ additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\u2022 Use\
    \ AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 vpnconnection: Ike Phase Encryption Strong Configured'
  severity: high
  rule_id: aws.ec2.vpnconnection.ike_phase_encryption_strong_configured
  for_each:
    discovery: aws.ec2.vpnconnection_encryption
    as: vpnconnection
    item: vpnconnection
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for ec2 vpnconnection:\n\n1. Open EC2 console\n2. Select the vpnconnection\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws ec2 modify-vpnconnection --vpnconnection-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 networkacl: Network Allow Ingress Any Port Configured'
  severity: high
  rule_id: aws.ec2.networkacl.network_allow_ingress_any_port_configured
  for_each:
    discovery: aws.ec2.networkacls
    as: networkacl
    item: networkacl
  conditions:
    var: networkacl.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 networkacl:\n\n1. Ensure networkacl is deployed in VPC\n2. Configure security\
    \ groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3.\
    \ Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 launch template no public ip: Launch Template No Public Ip Configured'
  severity: high
  rule_id: aws.ec2.launch_template_no_public_ip.launch_template_no_public_ip_configured
  for_each:
    discovery: aws.ec2.launch_template_no_public_ips
    as: launch_template_no_public_ip
    item: launch_template_no_public_ip
  conditions:
    var: launch_template_no_public_ip.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 launch_template_no_public_ip:\n\n1. Open EC2 console\n2. Select the launch_template_no_public_ip\n\
    3. Go to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Port Ssh Exposed To Internet Configured'
  severity: medium
  rule_id: aws.ec2.instance.port_ssh_exposed_to_internet_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Port Ssh Exposed To Internet Configuration\n\nDescription:\
    \ Verifies security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required\
    \ settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022\
    \ Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022\
    \ Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group with many ingress egress rules: Ingress Egress Rules Limited Configured'
  severity: medium
  rule_id: aws.ec2.security_group_with_many_ingress_egress_rules.ingress_egress_rules_limited_configured
  for_each:
    discovery: aws.ec2.security_group_with_many_ingress_egress_ruless
    as: security_group_with_many_ingress_egress_rules
    item: security_group_with_many_ingress_egress_rules
  conditions:
    var: security_group_with_many_ingress_egress_rules.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group_with_many_ingress_egress_rules:\n\n1. Ensure security_group_with_many_ingress_egress_rules\
    \ is deployed in VPC\n2. Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source\
    \ IP ranges\n   - Use least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for\
    \ network monitoring\n5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork\
    \ Security Best Practices:\n\u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet\
    \ access\n\u2022 Implement defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Port Oracle Exposed To Internet Configured'
  severity: medium
  rule_id: aws.ec2.instance.port_oracle_exposed_to_internet_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Port Oracle Exposed To Internet Configuration\n\nDescription:\
    \ Verifies security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required\
    \ settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022\
    \ Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022\
    \ Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 launchtemplate: Root Volume Encrypted By Default'
  severity: high
  rule_id: aws.ec2.launchtemplate.root_volume_encrypted_by_default
  for_each:
    discovery: aws.ec2.launchtemplate_encryption
    as: launchtemplate
    item: launchtemplate
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for ec2 launchtemplate:\n\n1. Open EC2 console\n2. Select the launchtemplate\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws ec2 modify-launchtemplate --launchtemplate-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: No Public Ip Assigned Configured'
  severity: high
  rule_id: aws.ec2.instance.no_public_ip_assigned_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 instance:\n\n1. Open EC2 console\n2. Select the instance\n3. Go to Permissions/Access\
    \ Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*) principals\n   -\
    \ Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access control\n7. Save\
    \ changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement condition keys for\
    \ additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\u2022 Use\
    \ AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Port Postgresql Exposed To Internet Configured'
  severity: medium
  rule_id: aws.ec2.instance.port_postgresql_exposed_to_internet_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Port Postgresql Exposed To Internet Configuration\n\
    \nDescription: Verifies security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply\
    \ required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 ami: Approved Image Allowlist Enforced'
  severity: medium
  rule_id: aws.ec2.ami.approved_image_allowlist_enforced
  for_each:
    discovery: aws.ec2.amis
    as: ami
    item: ami
  conditions:
    var: ami.compliant
    op: equals
    value: true
  remediation: "Configure ec2 ami for compliance:\n\nRequirement: Approved Image Allowlist Enforcement\n\nDescription: Verifies\
    \ security configuration for Amazon EC2 ami to ensure alignment with AWS security best practices and compliance requirements.\
    \ Proper configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\n\
    Steps:\n1. Open EC2 console\n2. Select the ami\n3. Review security configuration\n4. Apply required settings per organizational\
    \ policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected\
    \ Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\
    \u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 ebs: Default Encryption Configured'
  severity: high
  rule_id: aws.ec2.ebs.default_encryption_configured
  for_each:
    discovery: aws.ec2.ebs_encryption
    as: ebs
    item: ebs
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for ec2 ebs:\n\n1. Open EC2 console\n2. Select the ebs\n3. Navigate to Properties/Configuration\
    \ > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n   - Customer managed\
    \ key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws ec2 modify-ebs --ebs-id <id> --encrypted --kms-key-id\
    \ <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive data\n\u2022 Enable automatic\
    \ key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group: Vpc Endpoint Policies Applied'
  severity: high
  rule_id: aws.ec2.security_group.vpc_endpoint_policies_applied
  for_each:
    discovery: aws.ec2.security_groups
    as: security_group
    item: security_group
  conditions:
    var: security_group.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group:\n\n1. Ensure security_group is deployed in VPC\n2. Configure\
    \ security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n\
    3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Root Volume Encrypted Cmek'
  severity: high
  rule_id: aws.ec2.instance.root_volume_encrypted_cmek
  for_each:
    discovery: aws.ec2.instance_encryption
    as: instance
    item: instance
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for ec2 instance:\n\n1. Open EC2 console\n2. Select the instance\n3. Navigate to Properties/Configuration\
    \ > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n   - Customer managed\
    \ key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws ec2 modify-instance --instance-id <id> --encrypted\
    \ --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive data\n\u2022 Enable\
    \ automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Internet Facing With Instance Profile Configured'
  severity: medium
  rule_id: aws.ec2.instance.internet_facing_with_instance_profile_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Internet Facing With Instance Profile Configuration\n\
    \nDescription: Verifies security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply\
    \ required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 networkacl: Network Identity Aware Policies Enabled'
  severity: high
  rule_id: aws.ec2.networkacl.network_identity_aware_policies_enabled
  for_each:
    discovery: aws.ec2.networkacls
    as: networkacl
    item: networkacl
  conditions:
    var: networkacl.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 networkacl:\n\n1. Ensure networkacl is deployed in VPC\n2. Configure security\
    \ groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3.\
    \ Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Port Cifs Exposed To Internet Configured'
  severity: medium
  rule_id: aws.ec2.instance.port_cifs_exposed_to_internet_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Port Cifs Exposed To Internet Configuration\n\nDescription:\
    \ Verifies security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance\
    \ requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall security\
    \ posture.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required\
    \ settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022\
    \ Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022\
    \ Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 networkacl: Rdp Port 3389 Restricted'
  severity: medium
  rule_id: aws.ec2.networkacl.rdp_port_3389_restricted
  for_each:
    discovery: aws.ec2.networkacls
    as: networkacl
    item: networkacl
  conditions:
    var: networkacl.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 networkacl:\n\n1. Ensure networkacl is deployed in VPC\n2. Configure security\
    \ groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3.\
    \ Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Ssh Password Auth Disabled'
  severity: critical
  rule_id: aws.ec2.instance.ssh_password_auth_disabled
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Ssh Password Auth Disabled\n\nDescription: Validates\
    \ critical security configuration for Amazon EC2 instance to prevent security incidents that could result in significant\
    \ data breaches, compliance violations, or business disruption. This control addresses high-risk vulnerabilities that\
    \ require immediate remediation.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n\
    4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 vpnconnection: Pre Shared Keys Key Rotation Policy Configured'
  severity: high
  rule_id: aws.ec2.vpnconnection.pre_shared_keys_key_rotation_policy_configured
  for_each:
    discovery: aws.ec2.vpnconnections
    as: vpnconnection
    item: vpnconnection
  conditions:
    var: vpnconnection.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 vpnconnection:\n\n1. Open EC2 console\n2. Select the vpnconnection\n3. Go to\
    \ Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*)\
    \ principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access\
    \ control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 subnet: Exception Approvals Required'
  severity: medium
  rule_id: aws.ec2.subnet.exception_approvals_required
  for_each:
    discovery: aws.ec2.subnets
    as: subnet
    item: subnet
  conditions:
    var: subnet.compliant
    op: equals
    value: true
  remediation: "Configure ec2 subnet for compliance:\n\nRequirement: Exception Approvals Required\n\nDescription: Verifies\
    \ security configuration for Amazon EC2 subnet to ensure alignment with AWS security best practices and compliance requirements.\
    \ Proper configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\n\
    Steps:\n1. Open EC2 console\n2. Select the subnet\n3. Review security configuration\n4. Apply required settings per organizational\
    \ policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected\
    \ Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\
    \u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 launchtemplate: Volumes Encrypted'
  severity: high
  rule_id: aws.ec2.launchtemplate.volumes_encrypted
  for_each:
    discovery: aws.ec2.launchtemplate_encryption
    as: launchtemplate
    item: launchtemplate
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for ec2 launchtemplate:\n\n1. Open EC2 console\n2. Select the launchtemplate\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws ec2 modify-launchtemplate --launchtemplate-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Patch Compliance Status Check'
  severity: medium
  rule_id: aws.ec2.instance.patch_compliance_status_check
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Patch Compliance Status Check\n\nDescription: Verifies\
    \ security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance requirements.\
    \ Proper configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\n\
    Steps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required settings per\
    \ organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS\
    \ Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption\
    \ where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Ssh Key Authentication Configured'
  severity: critical
  rule_id: aws.ec2.instance.ssh_key_authentication_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Ssh Key Authentication Configuration\n\nDescription:\
    \ Validates critical security configuration for Amazon EC2 instance to prevent security incidents that could result in\
    \ significant data breaches, compliance violations, or business disruption. This control addresses high-risk vulnerabilities\
    \ that require immediate remediation.\n\nSteps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n\
    4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group internet ingress telnet 23: Port Telnet Blocked'
  severity: medium
  rule_id: aws.ec2.security_group_internet_ingress_telnet_23.port_telnet_blocked
  for_each:
    discovery: aws.ec2.security_group_internet_ingress_telnet_23s
    as: security_group_internet_ingress_telnet_23
    item: security_group_internet_ingress_telnet_23
  conditions:
    var: security_group_internet_ingress_telnet_23.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group_internet_ingress_telnet_23:\n\n1. Ensure security_group_internet_ingress_telnet_23\
    \ is deployed in VPC\n2. Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source\
    \ IP ranges\n   - Use least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for\
    \ network monitoring\n5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork\
    \ Security Best Practices:\n\u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet\
    \ access\n\u2022 Implement defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 reserved instance: Billing Admins Mfa Required'
  severity: critical
  rule_id: aws.ec2.reserved_instance.billing_admins_mfa_required
  for_each:
    discovery: aws.ec2.reserved_instances
    as: reserved_instance
    item: reserved_instance
  conditions:
    var: reserved_instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 reserved_instance for compliance:\n\nRequirement: Multi-Factor Authentication\n\nDescription:\
    \ Checks that Amazon EC2 reserved instance requires multi-factor authentication (MFA) for access, combining something\
    \ you know (password) with something you have (token/device). MFA significantly reduces account compromise risk from phishing,\
    \ credential stuffing, and password reuse attacks.\n\nSteps:\n1. Open EC2 console\n2. Select the reserved_instance\n3.\
    \ Review security configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\
    \nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\
    \u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group internet ingress postgres 5432: Port Postgres Blocked'
  severity: medium
  rule_id: aws.ec2.security_group_internet_ingress_postgres_5432.port_postgres_blocked
  for_each:
    discovery: aws.ec2.security_group_internet_ingress_postgres_5432s
    as: security_group_internet_ingress_postgres_5432
    item: security_group_internet_ingress_postgres_5432
  conditions:
    var: security_group_internet_ingress_postgres_5432.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group_internet_ingress_postgres_5432:\n\n1. Ensure security_group_internet_ingress_postgres_5432\
    \ is deployed in VPC\n2. Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source\
    \ IP ranges\n   - Use least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for\
    \ network monitoring\n5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork\
    \ Security Best Practices:\n\u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet\
    \ access\n\u2022 Implement defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Stopped Instances Removed'
  severity: medium
  rule_id: aws.ec2.instance.stopped_instances_removed
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Stopped Instances Removed\n\nDescription: Verifies\
    \ security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance requirements.\
    \ Proper configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\n\
    Steps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required settings per\
    \ organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS\
    \ Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption\
    \ where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Iam Role Compliance Configured'
  severity: high
  rule_id: aws.ec2.instance.iam_role_compliance_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 instance:\n\n1. Open EC2 console\n2. Select the instance\n3. Go to Permissions/Access\
    \ Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*) principals\n   -\
    \ Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access control\n7. Save\
    \ changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement condition keys for\
    \ additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\u2022 Use\
    \ AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group internet ingress memcached 11211: Port Memcached Blocked'
  severity: medium
  rule_id: aws.ec2.security_group_internet_ingress_memcached_11211.port_memcached_blocked
  for_each:
    discovery: aws.ec2.security_group_internet_ingress_memcached_11211s
    as: security_group_internet_ingress_memcached_11211
    item: security_group_internet_ingress_memcached_11211
  conditions:
    var: security_group_internet_ingress_memcached_11211.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group_internet_ingress_memcached_11211:\n\n1. Ensure security_group_internet_ingress_memcached_11211\
    \ is deployed in VPC\n2. Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source\
    \ IP ranges\n   - Use least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for\
    \ network monitoring\n5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork\
    \ Security Best Practices:\n\u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet\
    \ access\n\u2022 Implement defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group internet ingress redis 6379: Port Redis Blocked'
  severity: medium
  rule_id: aws.ec2.security_group_internet_ingress_redis_6379.port_redis_blocked
  for_each:
    discovery: aws.ec2.security_group_internet_ingress_redis_6379s
    as: security_group_internet_ingress_redis_6379
    item: security_group_internet_ingress_redis_6379
  conditions:
    var: security_group_internet_ingress_redis_6379.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group_internet_ingress_redis_6379:\n\n1. Ensure security_group_internet_ingress_redis_6379\
    \ is deployed in VPC\n2. Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source\
    \ IP ranges\n   - Use least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for\
    \ network monitoring\n5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork\
    \ Security Best Practices:\n\u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet\
    \ access\n\u2022 Implement defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Ssm Association Compliant'
  severity: medium
  rule_id: aws.ec2.instance.ssm_association_compliant
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Ssm Association Compliant\n\nDescription: Verifies\
    \ security configuration for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance requirements.\
    \ Proper configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\n\
    Steps:\n1. Open EC2 console\n2. Select the instance\n3. Review security configuration\n4. Apply required settings per\
    \ organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS\
    \ Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption\
    \ where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 security group internet ingress kafka 9092: Port Kafka Blocked'
  severity: medium
  rule_id: aws.ec2.security_group_internet_ingress_kafka_9092.port_kafka_blocked
  for_each:
    discovery: aws.ec2.security_group_internet_ingress_kafka_9092s
    as: security_group_internet_ingress_kafka_9092
    item: security_group_internet_ingress_kafka_9092
  conditions:
    var: security_group_internet_ingress_kafka_9092.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 security_group_internet_ingress_kafka_9092:\n\n1. Ensure security_group_internet_ingress_kafka_9092\
    \ is deployed in VPC\n2. Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source\
    \ IP ranges\n   - Use least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for\
    \ network monitoring\n5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork\
    \ Security Best Practices:\n\u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet\
    \ access\n\u2022 Implement defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: No Public Ip Configured'
  severity: high
  rule_id: aws.ec2.instance.no_public_ip_configured
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 instance:\n\n1. Open EC2 console\n2. Select the instance\n3. Go to Permissions/Access\
    \ Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*) principals\n   -\
    \ Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access control\n7. Save\
    \ changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement condition keys for\
    \ additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\u2022 Use\
    \ AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 subnet: Private S No Igw Route Configured'
  severity: high
  rule_id: aws.ec2.subnet.private_s_no_igw_route_configured
  for_each:
    discovery: aws.ec2.subnets
    as: subnet
    item: subnet
  conditions:
    var: subnet.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 subnet:\n\n1. Ensure subnet is deployed in VPC\n2. Configure security groups:\n\
    \   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3. Configure\
    \ network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC Endpoints\
    \ where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy in private\
    \ subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\u2022\
    \ Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 account: Block Public Access Configured'
  severity: high
  rule_id: aws.ec2.account.block_public_access_configured
  for_each:
    discovery: aws.ec2.accounts
    as: account
    item: account
  conditions:
    var: account.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 account:\n\n1. Open EC2 console\n2. Select the account\n3. Go to Permissions/Access\
    \ Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*) principals\n   -\
    \ Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access control\n7. Save\
    \ changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement condition keys for\
    \ additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\u2022 Use\
    \ AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 ebs public snapshot: Ebs Public Snapshot Configured'
  severity: high
  rule_id: aws.ec2.ebs_public_snapshot.ebs_public_snapshot_configured
  for_each:
    discovery: aws.ec2.ebs_public_snapshots
    as: ebs_public_snapshot
    item: ebs_public_snapshot
  conditions:
    var: ebs_public_snapshot.is_public
    op: equals
    value: false
  remediation: "Restrict public access for ec2 ebs_public_snapshot:\n\n1. Open EC2 console\n2. Select the ebs_public_snapshot\n\
    3. Go to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 instance: Profile Enabled'
  severity: medium
  rule_id: aws.ec2.instance.profile_enabled
  for_each:
    discovery: aws.ec2.instances
    as: instance
    item: instance
  conditions:
    var: instance.compliant
    op: equals
    value: true
  remediation: "Configure ec2 instance for compliance:\n\nRequirement: Profile Enabled\n\nDescription: Verifies security configuration\
    \ for Amazon EC2 instance to ensure alignment with AWS security best practices and compliance requirements. Proper configuration\
    \ reduces security risks, maintains defense in depth, and supports overall security posture.\n\nSteps:\n1. Open EC2 console\n\
    2. Select the instance\n3. Review security configuration\n4. Apply required settings per organizational policy\n5. Verify\
    \ compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022\
    \ Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular\
    \ security audits"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
- title: 'EC2 network interface: Security Groups Restrictive Configured'
  severity: high
  rule_id: aws.ec2.network_interface.security_groups_restrictive_configured
  for_each:
    discovery: aws.ec2.network_interfaces
    as: network_interface
    item: network_interface
  conditions:
    var: network_interface.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for ec2 network_interface:\n\n1. Ensure network_interface is deployed in VPC\n\
    2. Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use\
    \ least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n\
    5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\
    \u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement\
    \ defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html
  - https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html
