version: 1.0
provider: aws
service: fis
discovery:
  discovery_id: aws.fis.resources
  calls:
    - client: fis
      action: describe_fiss
      paginate: true
  fields:
    - name: id
      save_as: resource_id
  emit:
    items_for:
      as: resource
      item: resource_id
checks:
  - title: Dr Drills Conducted
    severity: low
    rule_id: aws.fis.chaos_engineering.dr_drills_conducted
    assertion_id: resilience_recovery.recovery_testing.dr_drills_conducted
    for_each:
      as: resource
      item: resource_id
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement dr drills conducted for fis"
    references:
      - "https://docs.aws.amazon.com/fis/"
  - title: Backup Restoration Tested
    severity: low
    rule_id: aws.fis.chaos_engineering.backup_restoration_tested
    assertion_id: resilience_recovery.recovery_testing.backup_restoration_tested
    for_each:
      as: resource
      item: resource_id
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement backup restoration tested for fis"
    references:
      - "https://docs.aws.amazon.com/fis/"
