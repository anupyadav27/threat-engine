rule_id: aws.vpc.resource.flow_log_active_rejects_enabled
service: vpc
resource: resource
requirement: Flow Log Active Rejects Enabled
title: 'VPC resource: Flow Log Active Rejects Enabled'
scope: vpc.resource.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
rationale: Ensures vpc resource has flow log active rejects enabled properly configured
  for security compliance.
severity: medium
assertion_id: logging_monitoring.logging.vpc_resource_flow_log_active_rejects_enabled
source: expert_generated
description: Verifies security configuration for Amazon VPC resource to ensure alignment
  with AWS security best practices and compliance requirements. Proper configuration
  reduces security risks, maintains defense in depth, and supports overall security
  posture.
references:
- https://docs.aws.amazon.com/vpc/latest/userguide/vpc-security-best-practices.html
- https://docs.aws.amazon.com/securityhub/latest/userguide/vpc-controls.html
- https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
remediation: "Enable logging for vpc resource:\n\n1. Open VPC console\n2. Select the\
  \ resource\n3. Go to Logging/Monitoring settings\n4. Enable logging\n5. Configure\
  \ log destination:\n   - CloudWatch Logs\n   - S3 bucket (for long-term retention)\n\
  6. Set log level (INFO, DEBUG, ERROR)\n7. Save changes\n\nAWS CLI:\naws vpc update-resource-logging\
  \ --resource-id <id> --logging-enabled\n\nBest Practices:\n• Enable all security-relevant\
  \ log types\n• Send logs to centralized logging service\n• Set appropriate retention\
  \ periods\n• Configure log encryption\n• Set up log monitoring and alerting"
