rule_id: aws.vpc.subnet_no_public_ip_by_default.subnet_no_public_ip_by_default_configured
service: vpc
resource: subnet_no_public_ip_by_default
requirement: Subnet No Public Ip By Default Configuration
title: 'VPC subnet no public ip by default: Subnet No Public Ip By Default Configured'
scope: vpc.subnet_no_public_ip_by_default.network
domain: network_security_and_connectivity
subcategory: network_access_control
rationale: Ensures vpc subnet_no_public_ip_by_default has subnet no public ip by default
  configured properly configured for security compliance.
severity: high
assertion_id: network_security.network_access.vpc_subnet_no_public_ip_by_default_subnet_no_public_ip_by_default_configured
source: expert_generated
description: Checks high-priority security configuration for Amazon VPC subnet no
  public ip by default to mitigate significant security risks. This control addresses
  vulnerabilities that could lead to unauthorized access, data exposure, or regulatory
  non-compliance if exploited.
references:
- https://docs.aws.amazon.com/vpc/latest/userguide/vpc-security-best-practices.html
- https://docs.aws.amazon.com/securityhub/latest/userguide/vpc-controls.html
- https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
remediation: "Restrict public access for vpc subnet_no_public_ip_by_default:\n\n1.\
  \ Open VPC console\n2. Select the subnet_no_public_ip_by_default\n3. Go to Permissions/Access\
  \ Control\n4. Review current permissions:\n   - Remove public access grants\n  \
  \ - Remove wildcard (*) principals\n   - Implement least privilege\n5. Update resource\
  \ policy or IAM policies\n6. Enable resource-level access control\n7. Save changes\n\
  \nSecurity Recommendations:\n• Use IAM roles instead of access keys\n• Implement\
  \ condition keys for additional security\n• Enable MFA for sensitive operations\n\
  • Regularly audit access permissions\n• Use AWS Organizations SCPs for guardrails"
