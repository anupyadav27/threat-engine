version: '1.0'
provider: aws
service: backup
discovery:
- discovery_id: aws.backup.backupplans
  calls:
  - client: backup
    action: list_backup_plans
    save_as: backupplan_list
    on_error: continue
    fields:
    - Backups
  emit:
    items_for: backupplan_list[]
    as: backupplan
    item:
      id: '{{ backupplan.Id }}'
      name: '{{ backupplan.Name }}'
- discovery_id: aws.backup.backupplan_encryption
  for_each: aws.backup.backupplans
  calls:
  - client: backup
    action: list_backup_plans
    params:
      BackupplanId: '{{ item.id }}'
    save_as: encryption
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      encryption_enabled: '{{ encryption.Encrypted if encryption.Encrypted is defined else false }}'
- discovery_id: aws.backup.backupplan_logging
  for_each: aws.backup.backupplans
  calls:
  - client: backup
    action: describe_backup_job
    params:
      BackupplanId: '{{ item.id }}'
    save_as: logging
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      logging_enabled: '{{ logging.LoggingEnabled is defined if logging else false }}'
- discovery_id: aws.backup.backupvault_encryption
  calls:
  - client: backup
    action: list_backup_job_summaries
    save_as: backupvault_encryption
    on_error: continue
  emit:
    items_for: backupvault_encryption[]
    as: backupvault_encryption
    item:
      id: '{{ backupvault_encryption.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.backup.reportplans
  for_each: aws.backup.reportplan
  calls:
  - client: backup
    action: describe_backup_job
    save_as: reportplans
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.backup.resource_encryption
  calls:
  - client: backup
    action: list_backup_job_summaries
    save_as: resource_encryption
    on_error: continue
  emit:
    items_for: resource_encryption[]
    as: resource_encryption
    item:
      id: '{{ resource_encryption.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.backup.backupjob_encryption
  calls:
  - client: backup
    action: list_backup_job_summaries
    save_as: backupjob_encryption
    on_error: continue
  emit:
    items_for: backupjob_encryption[]
    as: backupjob_encryption
    item:
      id: '{{ backupjob_encryption.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.backup.backupjobs
  for_each: aws.backup.backupjob
  calls:
  - client: backup
    action: describe_backup_job
    save_as: backupjobs
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.backup.recoverypoints
  for_each: aws.backup.recoverypoint
  calls:
  - client: backup
    action: describe_backup_job
    save_as: recoverypoints
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.backup.restorejobs
  for_each: aws.backup.restorejob
  calls:
  - client: backup
    action: describe_backup_job
    save_as: restorejobs
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.backup.restorejob_encryption
  calls:
  - client: backup
    action: list_backup_job_summaries
    save_as: restorejob_encryption
    on_error: continue
  emit:
    items_for: restorejob_encryption[]
    as: restorejob_encryption
    item:
      id: '{{ restorejob_encryption.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.backup.recoverypoint_encryption
  calls:
  - client: backup
    action: list_backup_job_summaries
    save_as: recoverypoint_encryption
    on_error: continue
  emit:
    items_for: recoverypoint_encryption[]
    as: recoverypoint_encryption
    item:
      id: '{{ recoverypoint_encryption.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.backup.backupjob_logging
  calls:
  - client: backup
    action: list_backup_job_summaries
    save_as: backupjob_logging
    on_error: continue
  emit:
    items_for: backupjob_logging[]
    as: backupjob_logging
    item:
      id: '{{ backupjob_logging.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.backup.backupvaults
  for_each: aws.backup.backupvault
  calls:
  - client: backup
    action: describe_backup_job
    save_as: backupvaults
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.backup.resources
  for_each: aws.backup.resource
  calls:
  - client: backup
    action: describe_backup_job
    save_as: resources
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
checks:
- title: 'BACKUP reportplan: Backup Plans Configured'
  severity: medium
  rule_id: aws.backup.reportplan.backup_plans_configured
  for_each:
    discovery: aws.backup.reportplans
    as: reportplan
    item: reportplan
  conditions:
    var: reportplan.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup reportplan:\n\n1. Open BACKUP console\n2. Select the reportplan\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupplan: Failed Jobs Alerting Enabled'
  severity: medium
  rule_id: aws.backup.backupplan.failed_jobs_alerting_enabled
  for_each:
    discovery: aws.backup.backupplans
    as: backupplan
    item: backupplan
  conditions:
    var: backupplan.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP restorejob: Role Least Privilege'
  severity: high
  rule_id: aws.backup.restorejob.role_least_privilege
  for_each:
    discovery: aws.backup.restorejobs
    as: restorejob
    item: restorejob
  conditions:
    var: restorejob.is_public
    op: equals
    value: false
  remediation: "Restrict public access for backup restorejob:\n\n1. Open BACKUP console\n2. Select the restorejob\n3. Go to\
    \ Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*)\
    \ principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access\
    \ control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP resource: Vault Encryption Enabled'
  severity: high
  rule_id: aws.backup.resource.vault_encryption_enabled
  for_each:
    discovery: aws.backup.resource_encryption
    as: resource
    item: resource
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for backup resource:\n\n1. Open BACKUP console\n2. Select the resource\n3. Navigate to Properties/Configuration\
    \ > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n   - Customer managed\
    \ key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws backup modify-resource --resource-id <id> --encrypted\
    \ --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive data\n\u2022 Enable\
    \ automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP restorejob: Backup Logs And Artifacts Encrypted'
  severity: high
  rule_id: aws.backup.restorejob.backup_logs_and_artifacts_encrypted
  for_each:
    discovery: aws.backup.restorejob_encryption
    as: restorejob
    item: restorejob
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for backup restorejob:\n\n1. Open BACKUP console\n2. Select the restorejob\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws backup modify-restorejob --restorejob-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupplan: Lag Monitoring Alerts Enabled'
  severity: medium
  rule_id: aws.backup.backupplan.lag_monitoring_alerts_enabled
  for_each:
    discovery: aws.backup.backupplans
    as: backupplan
    item: backupplan
  conditions:
    var: backupplan.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupplan: Backup Keys Access Least Privilege'
  severity: high
  rule_id: aws.backup.backupplan.backup_keys_access_least_privilege
  for_each:
    discovery: aws.backup.backupplans
    as: backupplan
    item: backupplan
  conditions:
    var: backupplan.is_public
    op: equals
    value: false
  remediation: "Restrict public access for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Go to\
    \ Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*)\
    \ principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access\
    \ control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupplan: Backup Cross Region Replication Encrypted'
  severity: high
  rule_id: aws.backup.backupplan.backup_cross_region_replication_encrypted
  for_each:
    discovery: aws.backup.backupplan_encryption
    as: backupplan
    item: backupplan
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws backup modify-backupplan --backupplan-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP recoverypoint: Encryption At Rest Cmek If Supported'
  severity: high
  rule_id: aws.backup.recoverypoint.encryption_at_rest_cmek_if_supported
  for_each:
    discovery: aws.backup.recoverypoint_encryption
    as: recoverypoint
    item: recoverypoint
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for backup recoverypoint:\n\n1. Open BACKUP console\n2. Select the recoverypoint\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws backup modify-recoverypoint --recoverypoint-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupvault: Backup Vaults Exist Configured'
  severity: medium
  rule_id: aws.backup.backupvault.backup_vaults_exist_configured
  for_each:
    discovery: aws.backup.backupvaults
    as: backupvault
    item: backupvault
  conditions:
    var: backupvault.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupvault:\n\n1. Open BACKUP console\n2. Select the backupvault\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupplan: Backup Approvals Required For Changes'
  severity: medium
  rule_id: aws.backup.backupplan.backup_approvals_required_for_changes
  for_each:
    discovery: aws.backup.backupplans
    as: backupplan
    item: backupplan
  conditions:
    var: backupplan.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP recoverypoint: Backup Point Encrypted'
  severity: high
  rule_id: aws.backup.recoverypoint.backup_point_encrypted
  for_each:
    discovery: aws.backup.recoverypoint_encryption
    as: recoverypoint
    item: recoverypoint
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for backup recoverypoint:\n\n1. Open BACKUP console\n2. Select the recoverypoint\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws backup modify-recoverypoint --recoverypoint-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupvault: Backup Schedule Defined Min Frequency Configured'
  severity: medium
  rule_id: aws.backup.backupvault.backup_schedule_defined_min_frequency_configured
  for_each:
    discovery: aws.backup.backupvaults
    as: backupvault
    item: backupvault
  conditions:
    var: backupvault.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupvault:\n\n1. Open BACKUP console\n2. Select the backupvault\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP restorejob: From Encrypted Backups Only'
  severity: high
  rule_id: aws.backup.restorejob.from_encrypted_backups_only
  for_each:
    discovery: aws.backup.restorejob_encryption
    as: restorejob
    item: restorejob
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for backup restorejob:\n\n1. Open BACKUP console\n2. Select the restorejob\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws backup modify-restorejob --restorejob-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupplan: Backup Plan Configured'
  severity: medium
  rule_id: aws.backup.backupplan.backup_plan_configured
  for_each:
    discovery: aws.backup.backupplans
    as: backupplan
    item: backupplan
  conditions:
    var: backupplan.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupvault: Backup Vault Configured'
  severity: medium
  rule_id: aws.backup.backupvault.backup_vault_configured
  for_each:
    discovery: aws.backup.backupvaults
    as: backupvault
    item: backupvault
  conditions:
    var: backupvault.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupvault:\n\n1. Open BACKUP console\n2. Select the backupvault\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupjob: Alerts For Backup Failures Configured'
  severity: medium
  rule_id: aws.backup.backupjob.alerts_for_backup_failures_configured
  for_each:
    discovery: aws.backup.backupjobs
    as: backupjob
    item: backupjob
  conditions:
    var: backupjob.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupjob:\n\n1. Open BACKUP console\n2. Select the backupjob\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupplan: Backup Vault Rbac Least Privilege'
  severity: high
  rule_id: aws.backup.backupplan.backup_vault_rbac_least_privilege
  for_each:
    discovery: aws.backup.backupplans
    as: backupplan
    item: backupplan
  conditions:
    var: backupplan.is_public
    op: equals
    value: false
  remediation: "Restrict public access for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Go to\
    \ Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*)\
    \ principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access\
    \ control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP reportplan: Backup Report Plan Configured'
  severity: medium
  rule_id: aws.backup.reportplan.backup_report_plan_configured
  for_each:
    discovery: aws.backup.reportplans
    as: reportplan
    item: reportplan
  conditions:
    var: reportplan.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup reportplan:\n\n1. Open BACKUP console\n2. Select the reportplan\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupplan: Backup Retention Minimum Configured'
  severity: medium
  rule_id: aws.backup.backupplan.backup_retention_minimum_configured
  for_each:
    discovery: aws.backup.backupplans
    as: backupplan
    item: backupplan
  conditions:
    var: backupplan.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupjob: Alert Destinations Configured'
  severity: medium
  rule_id: aws.backup.backupjob.alert_destinations_configured
  for_each:
    discovery: aws.backup.backupjobs
    as: backupjob
    item: backupjob
  conditions:
    var: backupjob.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupjob:\n\n1. Open BACKUP console\n2. Select the backupjob\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupvault: Backup Immutable Or Worm Enabled If Supported'
  severity: medium
  rule_id: aws.backup.backupvault.backup_immutable_or_worm_enabled_if_supported
  for_each:
    discovery: aws.backup.backupvaults
    as: backupvault
    item: backupvault
  conditions:
    var: backupvault.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupvault:\n\n1. Open BACKUP console\n2. Select the backupvault\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupjob: Alerts For Rpo Rto Breach Configured'
  severity: medium
  rule_id: aws.backup.backupjob.alerts_for_rpo_rto_breach_configured
  for_each:
    discovery: aws.backup.backupjobs
    as: backupjob
    item: backupjob
  conditions:
    var: backupjob.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupjob:\n\n1. Open BACKUP console\n2. Select the backupjob\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: Create immutable backup copies
  severity: medium
  rule_id: aws.backup.backupvault.key_rotation_enabled
  for_each:
    discovery: aws.backup.backupvaults
    as: backupvault
    item: backupvault
  conditions:
    var: backupvault.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupvault:\n\n1. Open BACKUP console\n2. Select the backupvault\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: RTO and RPO are defined and monitored
  severity: low
  rule_id: aws.backup.backupplan.change_audit_logging_enabled
  for_each:
    discovery: aws.backup.backupplan_logging
    as: backupplan
    item: backupplan
  conditions:
    var: logging.logging_enabled
    op: equals
    value: true
  remediation: "Enable logging for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Go to Logging/Monitoring\
    \ settings\n4. Enable logging\n5. Configure log destination:\n   - CloudWatch Logs\n   - S3 bucket (for long-term retention)\n\
    6. Set log level (INFO, DEBUG, ERROR)\n7. Save changes\n\nAWS CLI:\naws backup update-backupplan-logging --backupplan-id\
    \ <id> --logging-enabled\n\nBest Practices:\n\u2022 Enable all security-relevant log types\n\u2022 Send logs to centralized\
    \ logging service\n\u2022 Set appropriate retention periods\n\u2022 Configure log encryption\n\u2022 Set up log monitoring\
    \ and alerting"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupplan: Last Backup Recency Within Days'
  severity: medium
  rule_id: aws.backup.backupplan.last_backup_recency_within_days
  for_each:
    discovery: aws.backup.backupplans
    as: backupplan
    item: backupplan
  conditions:
    var: backupplan.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupjob: Logging Enabled'
  severity: medium
  rule_id: aws.backup.backupjob.logging_enabled
  for_each:
    discovery: aws.backup.backupjob_logging
    as: backupjob
    item: backupjob
  conditions:
    var: logging.logging_enabled
    op: equals
    value: true
  remediation: "Enable logging for backup backupjob:\n\n1. Open BACKUP console\n2. Select the backupjob\n3. Go to Logging/Monitoring\
    \ settings\n4. Enable logging\n5. Configure log destination:\n   - CloudWatch Logs\n   - S3 bucket (for long-term retention)\n\
    6. Set log level (INFO, DEBUG, ERROR)\n7. Save changes\n\nAWS CLI:\naws backup update-backupjob-logging --backupjob-id\
    \ <id> --logging-enabled\n\nBest Practices:\n\u2022 Enable all security-relevant log types\n\u2022 Send logs to centralized\
    \ logging service\n\u2022 Set appropriate retention periods\n\u2022 Configure log encryption\n\u2022 Set up log monitoring\
    \ and alerting"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupvault: Backup Destination Private Only Configured'
  severity: high
  rule_id: aws.backup.backupvault.backup_destination_private_only_configured
  for_each:
    discovery: aws.backup.backupvaults
    as: backupvault
    item: backupvault
  conditions:
    var: backupvault.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for backup backupvault:\n\n1. Ensure backupvault is deployed in VPC\n2. Configure\
    \ security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n\
    3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupjob: Alerts For Replication Lag Configured'
  severity: medium
  rule_id: aws.backup.backupjob.alerts_for_replication_lag_configured
  for_each:
    discovery: aws.backup.backupjobs
    as: backupjob
    item: backupjob
  conditions:
    var: backupjob.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupjob:\n\n1. Open BACKUP console\n2. Select the backupjob\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupjob: Role Least Privilege'
  severity: high
  rule_id: aws.backup.backupjob.role_least_privilege
  for_each:
    discovery: aws.backup.backupjobs
    as: backupjob
    item: backupjob
  conditions:
    var: backupjob.is_public
    op: equals
    value: false
  remediation: "Restrict public access for backup backupjob:\n\n1. Open BACKUP console\n2. Select the backupjob\n3. Go to\
    \ Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*)\
    \ principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access\
    \ control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP recoverypoint: Security Groups Restrictive Configured'
  severity: high
  rule_id: aws.backup.recoverypoint.security_groups_restrictive_configured
  for_each:
    discovery: aws.backup.recoverypoints
    as: recoverypoint
    item: recoverypoint
  conditions:
    var: recoverypoint.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for backup recoverypoint:\n\n1. Ensure recoverypoint is deployed in VPC\n2. Configure\
    \ security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n\
    3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupplan: Backup Ec2 Resources Included Configured'
  severity: medium
  rule_id: aws.backup.backupplan.backup_ec2_resources_included_configured
  for_each:
    discovery: aws.backup.backupplans
    as: backupplan
    item: backupplan
  conditions:
    var: backupplan.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP resource: Backup Replication Enabled'
  severity: medium
  rule_id: aws.backup.resource.backup_replication_enabled
  for_each:
    discovery: aws.backup.resources
    as: resource
    item: resource
  conditions:
    var: resource.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup resource:\n\n1. Open BACKUP console\n2. Select the resource\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupplan: No Public Access To Backup Vault Configured'
  severity: high
  rule_id: aws.backup.backupplan.no_public_access_to_backup_vault_configured
  for_each:
    discovery: aws.backup.backupplans
    as: backupplan
    item: backupplan
  conditions:
    var: backupplan.is_public
    op: equals
    value: false
  remediation: "Restrict public access for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Go to\
    \ Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*)\
    \ principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access\
    \ control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP resource: Backup Vaults Encrypted'
  severity: high
  rule_id: aws.backup.resource.backup_vaults_encrypted
  for_each:
    discovery: aws.backup.resource_encryption
    as: resource
    item: resource
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for backup resource:\n\n1. Open BACKUP console\n2. Select the resource\n3. Navigate to Properties/Configuration\
    \ > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n   - Customer managed\
    \ key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws backup modify-resource --resource-id <id> --encrypted\
    \ --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive data\n\u2022 Enable\
    \ automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupvault: Backup Cross Region Replication Enabled'
  severity: medium
  rule_id: aws.backup.backupvault.backup_cross_region_replication_enabled
  for_each:
    discovery: aws.backup.backupvaults
    as: backupvault
    item: backupvault
  conditions:
    var: backupvault.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupvault:\n\n1. Open BACKUP console\n2. Select the backupvault\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupplan: Unprotected Assets Alerting Enabled'
  severity: medium
  rule_id: aws.backup.backupplan.unprotected_assets_alerting_enabled
  for_each:
    discovery: aws.backup.backupplan_encryption
    as: backupplan
    item: backupplan
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws backup modify-backupplan --backupplan-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupplan: Backup Storage Encrypted And Private'
  severity: high
  rule_id: aws.backup.backupplan.backup_storage_encrypted_and_private
  for_each:
    discovery: aws.backup.backupplan_encryption
    as: backupplan
    item: backupplan
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws backup modify-backupplan --backupplan-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupplan: Backup Admins Mfa Required'
  severity: medium
  rule_id: aws.backup.backupplan.backup_admins_mfa_required
  for_each:
    discovery: aws.backup.backupplans
    as: backupplan
    item: backupplan
  conditions:
    var: backupplan.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP resource: Backup Recovery Point Encrypted'
  severity: high
  rule_id: aws.backup.resource.backup_recovery_point_encrypted
  for_each:
    discovery: aws.backup.resource_encryption
    as: resource
    item: resource
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for backup resource:\n\n1. Open BACKUP console\n2. Select the resource\n3. Navigate to Properties/Configuration\
    \ > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n   - Customer managed\
    \ key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws backup modify-resource --resource-id <id> --encrypted\
    \ --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive data\n\u2022 Enable\
    \ automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupjob: Alert Rules For Job Failures Configured'
  severity: medium
  rule_id: aws.backup.backupjob.alert_rules_for_job_failures_configured
  for_each:
    discovery: aws.backup.backupjobs
    as: backupjob
    item: backupjob
  conditions:
    var: backupjob.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupjob:\n\n1. Open BACKUP console\n2. Select the backupjob\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP recoverypoint: Private Network Only Configured'
  severity: high
  rule_id: aws.backup.recoverypoint.private_network_only_configured
  for_each:
    discovery: aws.backup.recoverypoints
    as: recoverypoint
    item: recoverypoint
  conditions:
    var: recoverypoint.is_public
    op: equals
    value: false
  remediation: "Restrict public access for backup recoverypoint:\n\n1. Open BACKUP console\n2. Select the recoverypoint\n\
    3. Go to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupjob: Alert Rules For Sla Breach Configured'
  severity: medium
  rule_id: aws.backup.backupjob.alert_rules_for_sla_breach_configured
  for_each:
    discovery: aws.backup.backupjobs
    as: backupjob
    item: backupjob
  conditions:
    var: backupjob.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupjob:\n\n1. Open BACKUP console\n2. Select the backupjob\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP recoverypoint: Backup Volumes Encrypted'
  severity: high
  rule_id: aws.backup.recoverypoint.backup_volumes_encrypted
  for_each:
    discovery: aws.backup.recoverypoint_encryption
    as: recoverypoint
    item: recoverypoint
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for backup recoverypoint:\n\n1. Open BACKUP console\n2. Select the recoverypoint\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws backup modify-recoverypoint --recoverypoint-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupplan: Policy Assignment Complete'
  severity: high
  rule_id: aws.backup.backupplan.policy_assignment_complete
  for_each:
    discovery: aws.backup.backupplans
    as: backupplan
    item: backupplan
  conditions:
    var: backupplan.is_public
    op: equals
    value: false
  remediation: "Restrict public access for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Go to\
    \ Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*)\
    \ principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access\
    \ control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupplan: Retention Days Minimum'
  severity: low
  rule_id: aws.backup.backupplan.retention_days_minimum
  for_each:
    discovery: aws.backup.backupplans
    as: backupplan
    item: backupplan
  conditions:
    var: backupplan.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP restorejob: Cross Account Restore Blocked By Policy Configured'
  severity: high
  rule_id: aws.backup.restorejob.cross_account_restore_blocked_by_policy_configured
  for_each:
    discovery: aws.backup.restorejobs
    as: restorejob
    item: restorejob
  conditions:
    var: restorejob.is_public
    op: equals
    value: false
  remediation: "Restrict public access for backup restorejob:\n\n1. Open BACKUP console\n2. Select the restorejob\n3. Go to\
    \ Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*)\
    \ principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access\
    \ control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: Create immutable backup copies
  severity: medium
  rule_id: aws.backup.backupvault.encryption_at_rest_enabled
  for_each:
    discovery: aws.backup.backupvault_encryption
    as: backupvault
    item: backupvault
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for backup backupvault:\n\n1. Open BACKUP console\n2. Select the backupvault\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws backup modify-backupvault --backupvault-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupvault: Key Policy Least Privilege'
  severity: high
  rule_id: aws.backup.backupvault.key_policy_least_privilege
  for_each:
    discovery: aws.backup.backupvaults
    as: backupvault
    item: backupvault
  conditions:
    var: backupvault.is_public
    op: equals
    value: false
  remediation: "Restrict public access for backup backupvault:\n\n1. Open BACKUP console\n2. Select the backupvault\n3. Go\
    \ to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP recoverypoint: Recovery Point Retention Configured'
  severity: medium
  rule_id: aws.backup.recoverypoint.recovery_point_retention_configured
  for_each:
    discovery: aws.backup.recoverypoints
    as: recoverypoint
    item: recoverypoint
  conditions:
    var: recoverypoint.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup recoverypoint:\n\n1. Open BACKUP console\n2. Select the recoverypoint\n3. Go\
    \ to Properties > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n\
    7. Save changes\n\nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\
    \u2022 Audit trail of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP recoverypoint: Backup Min Telemtry Required No Pii'
  severity: medium
  rule_id: aws.backup.recoverypoint.backup_min_telemtry_required_no_pii
  for_each:
    discovery: aws.backup.recoverypoints
    as: recoverypoint
    item: recoverypoint
  conditions:
    var: recoverypoint.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup recoverypoint:\n\n1. Open BACKUP console\n2. Select the recoverypoint\n3. Go\
    \ to Properties > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n\
    7. Save changes\n\nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\
    \u2022 Audit trail of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupplan: Backup Job Success Rate Minimum'
  severity: medium
  rule_id: aws.backup.backupplan.backup_job_success_rate_minimum
  for_each:
    discovery: aws.backup.backupplans
    as: backupplan
    item: backupplan
  conditions:
    var: backupplan.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP resource: Backup Enabled For Ec2'
  severity: medium
  rule_id: aws.backup.resource.backup_enabled_for_ec2
  for_each:
    discovery: aws.backup.resources
    as: resource
    item: resource
  conditions:
    var: resource.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup resource:\n\n1. Open BACKUP console\n2. Select the resource\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupplan: Auth Roles Least Privilege'
  severity: high
  rule_id: aws.backup.backupplan.auth_roles_least_privilege
  for_each:
    discovery: aws.backup.backupplans
    as: backupplan
    item: backupplan
  conditions:
    var: backupplan.is_public
    op: equals
    value: false
  remediation: "Restrict public access for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Go to\
    \ Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*)\
    \ principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access\
    \ control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupjob: Backup Metrics Export Enabled'
  severity: medium
  rule_id: aws.backup.backupjob.backup_metrics_export_enabled
  for_each:
    discovery: aws.backup.backupjobs
    as: backupjob
    item: backupjob
  conditions:
    var: backupjob.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupjob:\n\n1. Open BACKUP console\n2. Select the backupjob\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP recoverypoint: Agent To Service Tls Required'
  severity: high
  rule_id: aws.backup.recoverypoint.agent_to_service_tls_required
  for_each:
    discovery: aws.backup.recoverypoints
    as: recoverypoint
    item: recoverypoint
  conditions:
    var: recoverypoint.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for backup recoverypoint:\n\n1. Ensure recoverypoint is deployed in VPC\n2. Configure\
    \ security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n\
    3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP resource: Encryption Enabled'
  severity: high
  rule_id: aws.backup.resource.encryption_enabled
  for_each:
    discovery: aws.backup.resource_encryption
    as: resource
    item: resource
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for backup resource:\n\n1. Open BACKUP console\n2. Select the resource\n3. Navigate to Properties/Configuration\
    \ > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n   - Customer managed\
    \ key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws backup modify-resource --resource-id <id> --encrypted\
    \ --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive data\n\u2022 Enable\
    \ automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupvault: Encryption In Transit Tls Min 1 2 Configured'
  severity: high
  rule_id: aws.backup.backupvault.encryption_in_transit_tls_min_1_2_configured
  for_each:
    discovery: aws.backup.backupvault_encryption
    as: backupvault
    item: backupvault
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for backup backupvault:\n\n1. Open BACKUP console\n2. Select the backupvault\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws backup modify-backupvault --backupvault-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupplan: Backup Plans Configured'
  severity: medium
  rule_id: aws.backup.backupplan.backup_plans_configured
  for_each:
    discovery: aws.backup.backupplans
    as: backupplan
    item: backupplan
  conditions:
    var: backupplan.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupjob: Execution Roles Least Privilege'
  severity: high
  rule_id: aws.backup.backupjob.execution_roles_least_privilege
  for_each:
    discovery: aws.backup.backupjobs
    as: backupjob
    item: backupjob
  conditions:
    var: backupjob.is_public
    op: equals
    value: false
  remediation: "Restrict public access for backup backupjob:\n\n1. Open BACKUP console\n2. Select the backupjob\n3. Go to\
    \ Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*)\
    \ principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access\
    \ control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupvault: Backup Storage Immutability Enabled'
  severity: medium
  rule_id: aws.backup.backupvault.backup_storage_immutability_enabled
  for_each:
    discovery: aws.backup.backupvaults
    as: backupvault
    item: backupvault
  conditions:
    var: backupvault.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupvault:\n\n1. Open BACKUP console\n2. Select the backupvault\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupvault: Cmk Cmek Key Configured'
  severity: medium
  rule_id: aws.backup.backupvault.cmk_cmek_key_configured
  for_each:
    discovery: aws.backup.backupvault_encryption
    as: backupvault
    item: backupvault
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for backup backupvault:\n\n1. Open BACKUP console\n2. Select the backupvault\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws backup modify-backupvault --backupvault-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupplan: Backup Resource Discovery Synced Configured'
  severity: medium
  rule_id: aws.backup.backupplan.backup_resource_discovery_synced_configured
  for_each:
    discovery: aws.backup.backupplans
    as: backupplan
    item: backupplan
  conditions:
    var: backupplan.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupjob: Network Private Only Configured'
  severity: high
  rule_id: aws.backup.backupjob.network_private_only_configured
  for_each:
    discovery: aws.backup.backupjobs
    as: backupjob
    item: backupjob
  conditions:
    var: backupjob.is_public
    op: equals
    value: false
  remediation: "Restrict public access for backup backupjob:\n\n1. Open BACKUP console\n2. Select the backupjob\n3. Go to\
    \ Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*)\
    \ principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access\
    \ control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupjob: Backup Results Storage Encrypted And Private'
  severity: high
  rule_id: aws.backup.backupjob.backup_results_storage_encrypted_and_private
  for_each:
    discovery: aws.backup.backupjob_encryption
    as: backupjob
    item: backupjob
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for backup backupjob:\n\n1. Open BACKUP console\n2. Select the backupjob\n3. Navigate to\
    \ Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws backup modify-backupjob --backupjob-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'BACKUP backupplan: Encryption In Transit Tls Required'
  severity: high
  rule_id: aws.backup.backupplan.encryption_in_transit_tls_required
  for_each:
    discovery: aws.backup.backupplan_encryption
    as: backupplan
    item: backupplan
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for backup backupplan:\n\n1. Open BACKUP console\n2. Select the backupplan\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws backup modify-backupplan --backupplan-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
