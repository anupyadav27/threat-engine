rule_id: aws.athena.workgroup_encryption.at_rest_enabled
service: athena
resource: workgroup_encryption
requirement: At Rest Enabled
title: 'ATHENA workgroup encryption: At Rest Enabled'
scope: athena.workgroup_encryption.configuration
domain: configuration_and_change_management
subcategory: configuration_baseline
rationale: Ensures athena workgroup_encryption has at rest enabled properly configured
  for security compliance.
severity: medium
assertion_id: security.configuration.athena_workgroup_encryption_at_rest_enabled
source: expert_generated
compliance:
- iso27001_2022_multi_cloud_A.8.11_0066
- iso27001_2022_multi_cloud_A.8.24_0080
description: Verifies security configuration for AWS ATHENA workgroup encryption to
  ensure alignment with AWS security best practices and compliance requirements. Proper
  configuration reduces security risks, maintains defense in depth, and supports overall
  security posture.
references:
- https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
remediation: "Enable encryption for athena workgroup_encryption:\n\n1. Open ATHENA\
  \ console\n2. Select the workgroup_encryption\n3. Navigate to Properties/Configuration\
  \ > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed\
  \ key (default)\n   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\
  \nAWS CLI:\naws athena modify-workgroup_encryption --workgroup_encryption-id <id>\
  \ --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n• Use customer-managed\
  \ KMS keys for sensitive data\n• Enable automatic key rotation\n• Implement proper\
  \ key access policies\n• Audit key usage regularly"
