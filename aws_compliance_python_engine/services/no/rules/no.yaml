version: '1.0'
provider: aws
service: 'no'
discovery:
- discovery_id: aws.no.checkss
  calls:
  - client: 'no'
    action: list_nos
    save_as: checks_list
    on_error: continue
    fields:
    - Nos
  emit:
    items_for: checks_list[]
    as: checks
    item:
      id: '{{ checks.Id }}'
      name: '{{ checks.Name }}'
checks:
- title: 'NO checks: Security Checks Configured'
  severity: medium
  rule_id: aws.no.checks.security_checks_configured
  for_each:
    discovery: aws.no.checkss
    as: checks
    item: checks
  conditions:
    var: checks.compliant
    op: equals
    value: true
