version: '1.0'
provider: aws
service: rds
services:
  client: rds
  module: boto3.client
discovery:
- discovery_id: aws.rds.describe_d_b_proxies
  calls:
  - action: describe_db_proxies
    save_as: response
  emit:
    item:
      DBProxyName: '{{ response.DBProxies.DBProxyName }}'
      DBProxyArn: '{{ response.DBProxies.DBProxyArn }}'
      Status: '{{ response.DBProxies.Status }}'
      EngineFamily: '{{ response.DBProxies.EngineFamily }}'
      VpcId: '{{ response.DBProxies.VpcId }}'
      VpcSecurityGroupIds: '{{ response.DBProxies.VpcSecurityGroupIds }}'
      VpcSubnetIds: '{{ response.DBProxies.VpcSubnetIds }}'
      DefaultAuthScheme: '{{ response.DBProxies.DefaultAuthScheme }}'
      Auth: '{{ response.DBProxies.Auth }}'
      RoleArn: '{{ response.DBProxies.RoleArn }}'
      Endpoint: '{{ response.DBProxies.Endpoint }}'
      RequireTLS: '{{ response.DBProxies.RequireTLS }}'
      IdleClientTimeout: '{{ response.DBProxies.IdleClientTimeout }}'
      DebugLogging: '{{ response.DBProxies.DebugLogging }}'
      CreatedDate: '{{ response.DBProxies.CreatedDate }}'
      UpdatedDate: '{{ response.DBProxies.UpdatedDate }}'
      EndpointNetworkType: '{{ response.DBProxies.EndpointNetworkType }}'
      TargetConnectionNetworkType: '{{ response.DBProxies.TargetConnectionNetworkType
        }}'
- discovery_id: aws.rds.describe_d_b_cluster_automated_backups
  calls:
  - action: describe_db_cluster_automated_backups
    save_as: response
  emit:
    item:
      Engine: '{{ response.DBClusterAutomatedBackups.Engine }}'
      VpcId: '{{ response.DBClusterAutomatedBackups.VpcId }}'
      DBClusterAutomatedBackupsArn: '{{ response.DBClusterAutomatedBackups.DBClusterAutomatedBackupsArn
        }}'
      DBClusterIdentifier: '{{ response.DBClusterAutomatedBackups.DBClusterIdentifier
        }}'
      RestoreWindow: '{{ response.DBClusterAutomatedBackups.RestoreWindow }}'
      MasterUsername: '{{ response.DBClusterAutomatedBackups.MasterUsername }}'
      DbClusterResourceId: '{{ response.DBClusterAutomatedBackups.DbClusterResourceId
        }}'
      Region: '{{ response.DBClusterAutomatedBackups.Region }}'
      LicenseModel: '{{ response.DBClusterAutomatedBackups.LicenseModel }}'
      Status: '{{ response.DBClusterAutomatedBackups.Status }}'
      IAMDatabaseAuthenticationEnabled: '{{ response.DBClusterAutomatedBackups.IAMDatabaseAuthenticationEnabled
        }}'
      ClusterCreateTime: '{{ response.DBClusterAutomatedBackups.ClusterCreateTime
        }}'
      StorageEncrypted: '{{ response.DBClusterAutomatedBackups.StorageEncrypted }}'
      AllocatedStorage: '{{ response.DBClusterAutomatedBackups.AllocatedStorage }}'
      EngineVersion: '{{ response.DBClusterAutomatedBackups.EngineVersion }}'
      DBClusterArn: '{{ response.DBClusterAutomatedBackups.DBClusterArn }}'
      BackupRetentionPeriod: '{{ response.DBClusterAutomatedBackups.BackupRetentionPeriod
        }}'
      EngineMode: '{{ response.DBClusterAutomatedBackups.EngineMode }}'
      AvailabilityZones: '{{ response.DBClusterAutomatedBackups.AvailabilityZones
        }}'
      Port: '{{ response.DBClusterAutomatedBackups.Port }}'
      KmsKeyId: '{{ response.DBClusterAutomatedBackups.KmsKeyId }}'
      StorageType: '{{ response.DBClusterAutomatedBackups.StorageType }}'
      Iops: '{{ response.DBClusterAutomatedBackups.Iops }}'
      StorageThroughput: '{{ response.DBClusterAutomatedBackups.StorageThroughput
        }}'
      AwsBackupRecoveryPointArn: '{{ response.DBClusterAutomatedBackups.AwsBackupRecoveryPointArn
        }}'
      Enabled: '{{ resource.Enabled }}'
      Vpc: '{{ resource.Vpc }}'
- discovery_id: aws.rds.describe_d_b_clusters
  calls:
  - action: describe_db_clusters
    save_as: response
  emit:
    item:
      AllocatedStorage: '{{ response.DBClusters.AllocatedStorage }}'
      AvailabilityZones: '{{ response.DBClusters.AvailabilityZones }}'
      BackupRetentionPeriod: '{{ response.DBClusters.BackupRetentionPeriod }}'
      CharacterSetName: '{{ response.DBClusters.CharacterSetName }}'
      DatabaseName: '{{ response.DBClusters.DatabaseName }}'
      DBClusterIdentifier: '{{ response.DBClusters.DBClusterIdentifier }}'
      DBClusterParameterGroup: '{{ response.DBClusters.DBClusterParameterGroup }}'
      DBSubnetGroup: '{{ response.DBClusters.DBSubnetGroup }}'
      Status: '{{ response.DBClusters.Status }}'
      PercentProgress: '{{ response.DBClusters.PercentProgress }}'
      EarliestRestorableTime: '{{ response.DBClusters.EarliestRestorableTime }}'
      Endpoint: '{{ response.DBClusters.Endpoint }}'
      ReaderEndpoint: '{{ response.DBClusters.ReaderEndpoint }}'
      CustomEndpoints: '{{ response.DBClusters.CustomEndpoints }}'
      MultiAZ: '{{ response.DBClusters.MultiAZ }}'
      Engine: '{{ response.DBClusters.Engine }}'
      EngineVersion: '{{ response.DBClusters.EngineVersion }}'
      LatestRestorableTime: '{{ response.DBClusters.LatestRestorableTime }}'
      Port: '{{ response.DBClusters.Port }}'
      MasterUsername: '{{ response.DBClusters.MasterUsername }}'
      DBClusterOptionGroupMemberships: '{{ response.DBClusters.DBClusterOptionGroupMemberships
        }}'
      PreferredBackupWindow: '{{ response.DBClusters.PreferredBackupWindow }}'
      PreferredMaintenanceWindow: '{{ response.DBClusters.PreferredMaintenanceWindow
        }}'
      UpgradeRolloutOrder: '{{ response.DBClusters.UpgradeRolloutOrder }}'
      ReplicationSourceIdentifier: '{{ response.DBClusters.ReplicationSourceIdentifier
        }}'
      ReadReplicaIdentifiers: '{{ response.DBClusters.ReadReplicaIdentifiers }}'
      StatusInfos: '{{ response.DBClusters.StatusInfos }}'
      DBClusterMembers: '{{ response.DBClusters.DBClusterMembers }}'
      VpcSecurityGroups: '{{ response.DBClusters.VpcSecurityGroups }}'
      HostedZoneId: '{{ response.DBClusters.HostedZoneId }}'
      StorageEncrypted: '{{ response.DBClusters.StorageEncrypted }}'
      KmsKeyId: '{{ response.DBClusters.KmsKeyId }}'
      DbClusterResourceId: '{{ response.DBClusters.DbClusterResourceId }}'
      DBClusterArn: '{{ response.DBClusters.DBClusterArn }}'
      AssociatedRoles: '{{ response.DBClusters.AssociatedRoles }}'
      IAMDatabaseAuthenticationEnabled: '{{ response.DBClusters.IAMDatabaseAuthenticationEnabled
        }}'
      CloneGroupId: '{{ response.DBClusters.CloneGroupId }}'
      ClusterCreateTime: '{{ response.DBClusters.ClusterCreateTime }}'
      EarliestBacktrackTime: '{{ response.DBClusters.EarliestBacktrackTime }}'
      BacktrackWindow: '{{ response.DBClusters.BacktrackWindow }}'
      BacktrackConsumedChangeRecords: '{{ response.DBClusters.BacktrackConsumedChangeRecords
        }}'
      EnabledCloudwatchLogsExports: '{{ response.DBClusters.EnabledCloudwatchLogsExports
        }}'
      Capacity: '{{ response.DBClusters.Capacity }}'
      PendingModifiedValues: '{{ response.DBClusters.PendingModifiedValues }}'
      EngineMode: '{{ response.DBClusters.EngineMode }}'
      ScalingConfigurationInfo: '{{ response.DBClusters.ScalingConfigurationInfo }}'
      RdsCustomClusterConfiguration: '{{ response.DBClusters.RdsCustomClusterConfiguration
        }}'
      DBClusterInstanceClass: '{{ response.DBClusters.DBClusterInstanceClass }}'
      StorageType: '{{ response.DBClusters.StorageType }}'
      Iops: '{{ response.DBClusters.Iops }}'
      StorageThroughput: '{{ response.DBClusters.StorageThroughput }}'
      IOOptimizedNextAllowedModificationTime: '{{ response.DBClusters.IOOptimizedNextAllowedModificationTime
        }}'
      PubliclyAccessible: '{{ response.DBClusters.PubliclyAccessible }}'
      AutoMinorVersionUpgrade: '{{ response.DBClusters.AutoMinorVersionUpgrade }}'
      DeletionProtection: '{{ response.DBClusters.DeletionProtection }}'
      HttpEndpointEnabled: '{{ response.DBClusters.HttpEndpointEnabled }}'
      ActivityStreamMode: '{{ response.DBClusters.ActivityStreamMode }}'
      ActivityStreamStatus: '{{ response.DBClusters.ActivityStreamStatus }}'
      ActivityStreamKmsKeyId: '{{ response.DBClusters.ActivityStreamKmsKeyId }}'
      ActivityStreamKinesisStreamName: '{{ response.DBClusters.ActivityStreamKinesisStreamName
        }}'
      CopyTagsToSnapshot: '{{ response.DBClusters.CopyTagsToSnapshot }}'
      CrossAccountClone: '{{ response.DBClusters.CrossAccountClone }}'
      DomainMemberships: '{{ response.DBClusters.DomainMemberships }}'
      TagList: '{{ response.DBClusters.TagList }}'
      GlobalClusterIdentifier: '{{ response.DBClusters.GlobalClusterIdentifier }}'
      GlobalWriteForwardingStatus: '{{ response.DBClusters.GlobalWriteForwardingStatus
        }}'
      GlobalWriteForwardingRequested: '{{ response.DBClusters.GlobalWriteForwardingRequested
        }}'
      NetworkType: '{{ response.DBClusters.NetworkType }}'
      AutomaticRestartTime: '{{ response.DBClusters.AutomaticRestartTime }}'
      ServerlessV2ScalingConfiguration: '{{ response.DBClusters.ServerlessV2ScalingConfiguration
        }}'
      ServerlessV2PlatformVersion: '{{ response.DBClusters.ServerlessV2PlatformVersion
        }}'
      MonitoringInterval: '{{ response.DBClusters.MonitoringInterval }}'
      MonitoringRoleArn: '{{ response.DBClusters.MonitoringRoleArn }}'
      DatabaseInsightsMode: '{{ response.DBClusters.DatabaseInsightsMode }}'
      PerformanceInsightsEnabled: '{{ response.DBClusters.PerformanceInsightsEnabled
        }}'
      PerformanceInsightsKMSKeyId: '{{ response.DBClusters.PerformanceInsightsKMSKeyId
        }}'
      PerformanceInsightsRetentionPeriod: '{{ response.DBClusters.PerformanceInsightsRetentionPeriod
        }}'
      DBSystemId: '{{ response.DBClusters.DBSystemId }}'
      MasterUserSecret: '{{ response.DBClusters.MasterUserSecret }}'
      LocalWriteForwardingStatus: '{{ response.DBClusters.LocalWriteForwardingStatus
        }}'
      AwsBackupRecoveryPointArn: '{{ response.DBClusters.AwsBackupRecoveryPointArn
        }}'
      LimitlessDatabase: '{{ response.DBClusters.LimitlessDatabase }}'
      ClusterScalabilityType: '{{ response.DBClusters.ClusterScalabilityType }}'
      CertificateDetails: '{{ response.DBClusters.CertificateDetails }}'
      EngineLifecycleSupport: '{{ response.DBClusters.EngineLifecycleSupport }}'
- discovery_id: aws.rds.describe_d_b_snapshot_tenant_databases
  calls:
  - action: describe_db_snapshot_tenant_databases
    save_as: response
  emit:
    item:
      DBSnapshotIdentifier: '{{ response.DBSnapshotTenantDatabases.DBSnapshotIdentifier
        }}'
      DBInstanceIdentifier: '{{ response.DBSnapshotTenantDatabases.DBInstanceIdentifier
        }}'
      DbiResourceId: '{{ response.DBSnapshotTenantDatabases.DbiResourceId }}'
      EngineName: '{{ response.DBSnapshotTenantDatabases.EngineName }}'
      SnapshotType: '{{ response.DBSnapshotTenantDatabases.SnapshotType }}'
      TenantDatabaseCreateTime: '{{ response.DBSnapshotTenantDatabases.TenantDatabaseCreateTime
        }}'
      TenantDBName: '{{ response.DBSnapshotTenantDatabases.TenantDBName }}'
      MasterUsername: '{{ response.DBSnapshotTenantDatabases.MasterUsername }}'
      TenantDatabaseResourceId: '{{ response.DBSnapshotTenantDatabases.TenantDatabaseResourceId
        }}'
      CharacterSetName: '{{ response.DBSnapshotTenantDatabases.CharacterSetName }}'
      DBSnapshotTenantDatabaseARN: '{{ response.DBSnapshotTenantDatabases.DBSnapshotTenantDatabaseARN
        }}'
      NcharCharacterSetName: '{{ response.DBSnapshotTenantDatabases.NcharCharacterSetName
        }}'
      TagList: '{{ response.DBSnapshotTenantDatabases.TagList }}'
- discovery_id: aws.rds.describe_option_group_options
  calls:
  - action: describe_option_group_options
    save_as: response
    params:
      EngineName: '{{ item.EngineName }}'
  for_each: aws.rds.describe_d_b_snapshot_tenant_databases
  on_error: continue
  emit:
    item:
      Name: '{{ response.OptionGroupOptions.Name }}'
      Description: '{{ response.OptionGroupOptions.Description }}'
      EngineName: '{{ response.OptionGroupOptions.EngineName }}'
      MajorEngineVersion: '{{ response.OptionGroupOptions.MajorEngineVersion }}'
      MinimumRequiredMinorEngineVersion: '{{ response.OptionGroupOptions.MinimumRequiredMinorEngineVersion
        }}'
      PortRequired: '{{ response.OptionGroupOptions.PortRequired }}'
      DefaultPort: '{{ response.OptionGroupOptions.DefaultPort }}'
      OptionsDependedOn: '{{ response.OptionGroupOptions.OptionsDependedOn }}'
      OptionsConflictsWith: '{{ response.OptionGroupOptions.OptionsConflictsWith }}'
      Persistent: '{{ response.OptionGroupOptions.Persistent }}'
      Permanent: '{{ response.OptionGroupOptions.Permanent }}'
      RequiresAutoMinorEngineVersionUpgrade: '{{ response.OptionGroupOptions.RequiresAutoMinorEngineVersionUpgrade
        }}'
      VpcOnly: '{{ response.OptionGroupOptions.VpcOnly }}'
      SupportsOptionVersionDowngrade: '{{ response.OptionGroupOptions.SupportsOptionVersionDowngrade
        }}'
      OptionGroupOptionSettings: '{{ response.OptionGroupOptions.OptionGroupOptionSettings
        }}'
      OptionGroupOptionVersions: '{{ response.OptionGroupOptions.OptionGroupOptionVersions
        }}'
      CopyableCrossAccount: '{{ response.OptionGroupOptions.CopyableCrossAccount }}'
- discovery_id: aws.rds.describe_d_b_instance_automated_backups
  calls:
  - action: describe_db_instance_automated_backups
    save_as: response
  emit:
    item:
      DBInstanceArn: '{{ response.DBInstanceAutomatedBackups.DBInstanceArn }}'
      DbiResourceId: '{{ response.DBInstanceAutomatedBackups.DbiResourceId }}'
      Region: '{{ response.DBInstanceAutomatedBackups.Region }}'
      DBInstanceIdentifier: '{{ response.DBInstanceAutomatedBackups.DBInstanceIdentifier
        }}'
      RestoreWindow: '{{ response.DBInstanceAutomatedBackups.RestoreWindow }}'
      AllocatedStorage: '{{ response.DBInstanceAutomatedBackups.AllocatedStorage }}'
      Status: '{{ response.DBInstanceAutomatedBackups.Status }}'
      Port: '{{ response.DBInstanceAutomatedBackups.Port }}'
      AvailabilityZone: '{{ response.DBInstanceAutomatedBackups.AvailabilityZone }}'
      VpcId: '{{ response.DBInstanceAutomatedBackups.VpcId }}'
      InstanceCreateTime: '{{ response.DBInstanceAutomatedBackups.InstanceCreateTime
        }}'
      MasterUsername: '{{ response.DBInstanceAutomatedBackups.MasterUsername }}'
      Engine: '{{ response.DBInstanceAutomatedBackups.Engine }}'
      EngineVersion: '{{ response.DBInstanceAutomatedBackups.EngineVersion }}'
      LicenseModel: '{{ response.DBInstanceAutomatedBackups.LicenseModel }}'
      Iops: '{{ response.DBInstanceAutomatedBackups.Iops }}'
      StorageThroughput: '{{ response.DBInstanceAutomatedBackups.StorageThroughput
        }}'
      OptionGroupName: '{{ response.DBInstanceAutomatedBackups.OptionGroupName }}'
      TdeCredentialArn: '{{ response.DBInstanceAutomatedBackups.TdeCredentialArn }}'
      Encrypted: '{{ response.DBInstanceAutomatedBackups.Encrypted }}'
      StorageType: '{{ response.DBInstanceAutomatedBackups.StorageType }}'
      KmsKeyId: '{{ response.DBInstanceAutomatedBackups.KmsKeyId }}'
      Timezone: '{{ response.DBInstanceAutomatedBackups.Timezone }}'
      IAMDatabaseAuthenticationEnabled: '{{ response.DBInstanceAutomatedBackups.IAMDatabaseAuthenticationEnabled
        }}'
      BackupRetentionPeriod: '{{ response.DBInstanceAutomatedBackups.BackupRetentionPeriod
        }}'
      DBInstanceAutomatedBackupsArn: '{{ response.DBInstanceAutomatedBackups.DBInstanceAutomatedBackupsArn
        }}'
      DBInstanceAutomatedBackupsReplications: '{{ response.DBInstanceAutomatedBackups.DBInstanceAutomatedBackupsReplications
        }}'
      BackupTarget: '{{ response.DBInstanceAutomatedBackups.BackupTarget }}'
      MultiTenant: '{{ response.DBInstanceAutomatedBackups.MultiTenant }}'
      AwsBackupRecoveryPointArn: '{{ response.DBInstanceAutomatedBackups.AwsBackupRecoveryPointArn
        }}'
      DedicatedLogVolume: '{{ response.DBInstanceAutomatedBackups.DedicatedLogVolume
        }}'
      DBInstanceAutomatedBackups: '{{ resource.DBInstanceAutomatedBackups }}'
- discovery_id: aws.rds.describe_orderable_d_b_instance_options
  calls:
  - action: describe_orderable_db_instance_options
    save_as: response
  emit:
    item:
      Engine: '{{ response.OrderableDBInstanceOptions.Engine }}'
      EngineVersion: '{{ response.OrderableDBInstanceOptions.EngineVersion }}'
      DBInstanceClass: '{{ response.OrderableDBInstanceOptions.DBInstanceClass }}'
      LicenseModel: '{{ response.OrderableDBInstanceOptions.LicenseModel }}'
      AvailabilityZoneGroup: '{{ response.OrderableDBInstanceOptions.AvailabilityZoneGroup
        }}'
      AvailabilityZones: '{{ response.OrderableDBInstanceOptions.AvailabilityZones
        }}'
      MultiAZCapable: '{{ response.OrderableDBInstanceOptions.MultiAZCapable }}'
      ReadReplicaCapable: '{{ response.OrderableDBInstanceOptions.ReadReplicaCapable
        }}'
      Vpc: '{{ response.OrderableDBInstanceOptions.Vpc }}'
      SupportsStorageEncryption: '{{ response.OrderableDBInstanceOptions.SupportsStorageEncryption
        }}'
      StorageType: '{{ response.OrderableDBInstanceOptions.StorageType }}'
      SupportsIops: '{{ response.OrderableDBInstanceOptions.SupportsIops }}'
      SupportsStorageThroughput: '{{ response.OrderableDBInstanceOptions.SupportsStorageThroughput
        }}'
      SupportsEnhancedMonitoring: '{{ response.OrderableDBInstanceOptions.SupportsEnhancedMonitoring
        }}'
      SupportsIAMDatabaseAuthentication: '{{ response.OrderableDBInstanceOptions.SupportsIAMDatabaseAuthentication
        }}'
      SupportsPerformanceInsights: '{{ response.OrderableDBInstanceOptions.SupportsPerformanceInsights
        }}'
      MinStorageSize: '{{ response.OrderableDBInstanceOptions.MinStorageSize }}'
      MaxStorageSize: '{{ response.OrderableDBInstanceOptions.MaxStorageSize }}'
      MinIopsPerDbInstance: '{{ response.OrderableDBInstanceOptions.MinIopsPerDbInstance
        }}'
      MaxIopsPerDbInstance: '{{ response.OrderableDBInstanceOptions.MaxIopsPerDbInstance
        }}'
      MinIopsPerGib: '{{ response.OrderableDBInstanceOptions.MinIopsPerGib }}'
      MaxIopsPerGib: '{{ response.OrderableDBInstanceOptions.MaxIopsPerGib }}'
      MinStorageThroughputPerDbInstance: '{{ response.OrderableDBInstanceOptions.MinStorageThroughputPerDbInstance
        }}'
      MaxStorageThroughputPerDbInstance: '{{ response.OrderableDBInstanceOptions.MaxStorageThroughputPerDbInstance
        }}'
      MinStorageThroughputPerIops: '{{ response.OrderableDBInstanceOptions.MinStorageThroughputPerIops
        }}'
      MaxStorageThroughputPerIops: '{{ response.OrderableDBInstanceOptions.MaxStorageThroughputPerIops
        }}'
      AvailableProcessorFeatures: '{{ response.OrderableDBInstanceOptions.AvailableProcessorFeatures
        }}'
      SupportedEngineModes: '{{ response.OrderableDBInstanceOptions.SupportedEngineModes
        }}'
      SupportsStorageAutoscaling: '{{ response.OrderableDBInstanceOptions.SupportsStorageAutoscaling
        }}'
      SupportsKerberosAuthentication: '{{ response.OrderableDBInstanceOptions.SupportsKerberosAuthentication
        }}'
      OutpostCapable: '{{ response.OrderableDBInstanceOptions.OutpostCapable }}'
      SupportedActivityStreamModes: '{{ response.OrderableDBInstanceOptions.SupportedActivityStreamModes
        }}'
      SupportsGlobalDatabases: '{{ response.OrderableDBInstanceOptions.SupportsGlobalDatabases
        }}'
      SupportedNetworkTypes: '{{ response.OrderableDBInstanceOptions.SupportedNetworkTypes
        }}'
      SupportsClusters: '{{ response.OrderableDBInstanceOptions.SupportsClusters }}'
      SupportsDedicatedLogVolume: '{{ response.OrderableDBInstanceOptions.SupportsDedicatedLogVolume
        }}'
      SupportsHttpEndpoint: '{{ response.OrderableDBInstanceOptions.SupportsHttpEndpoint
        }}'
- discovery_id: aws.rds.describe_d_b_proxy_endpoints
  calls:
  - action: describe_db_proxy_endpoints
    save_as: response
  emit:
    item:
      DBProxyEndpointName: '{{ response.DBProxyEndpoints.DBProxyEndpointName }}'
      DBProxyEndpointArn: '{{ response.DBProxyEndpoints.DBProxyEndpointArn }}'
      DBProxyName: '{{ response.DBProxyEndpoints.DBProxyName }}'
      Status: '{{ response.DBProxyEndpoints.Status }}'
      VpcId: '{{ response.DBProxyEndpoints.VpcId }}'
      VpcSecurityGroupIds: '{{ response.DBProxyEndpoints.VpcSecurityGroupIds }}'
      VpcSubnetIds: '{{ response.DBProxyEndpoints.VpcSubnetIds }}'
      Endpoint: '{{ response.DBProxyEndpoints.Endpoint }}'
      CreatedDate: '{{ response.DBProxyEndpoints.CreatedDate }}'
      TargetRole: '{{ response.DBProxyEndpoints.TargetRole }}'
      IsDefault: '{{ response.DBProxyEndpoints.IsDefault }}'
      EndpointNetworkType: '{{ response.DBProxyEndpoints.EndpointNetworkType }}'
- discovery_id: aws.rds.describe_d_b_instances
  calls:
  - action: describe_db_instances
    save_as: response
  emit:
    item:
      DBInstanceIdentifier: '{{ response.DBInstances.DBInstanceIdentifier }}'
      DBInstanceClass: '{{ response.DBInstances.DBInstanceClass }}'
      Engine: '{{ response.DBInstances.Engine }}'
      DBInstanceStatus: '{{ response.DBInstances.DBInstanceStatus }}'
      MasterUsername: '{{ response.DBInstances.MasterUsername }}'
      DBName: '{{ response.DBInstances.DBName }}'
      Endpoint: '{{ response.DBInstances.Endpoint }}'
      AllocatedStorage: '{{ response.DBInstances.AllocatedStorage }}'
      InstanceCreateTime: '{{ response.DBInstances.InstanceCreateTime }}'
      PreferredBackupWindow: '{{ response.DBInstances.PreferredBackupWindow }}'
      BackupRetentionPeriod: '{{ response.DBInstances.BackupRetentionPeriod }}'
      DBSecurityGroups: '{{ response.DBInstances.DBSecurityGroups }}'
      VpcSecurityGroups: '{{ response.DBInstances.VpcSecurityGroups }}'
      DBParameterGroups: '{{ response.DBInstances.DBParameterGroups }}'
      AvailabilityZone: '{{ response.DBInstances.AvailabilityZone }}'
      DBSubnetGroup: '{{ response.DBInstances.DBSubnetGroup }}'
      PreferredMaintenanceWindow: '{{ response.DBInstances.PreferredMaintenanceWindow
        }}'
      UpgradeRolloutOrder: '{{ response.DBInstances.UpgradeRolloutOrder }}'
      PendingModifiedValues: '{{ response.DBInstances.PendingModifiedValues }}'
      LatestRestorableTime: '{{ response.DBInstances.LatestRestorableTime }}'
      MultiAZ: '{{ response.DBInstances.MultiAZ }}'
      EngineVersion: '{{ response.DBInstances.EngineVersion }}'
      AutoMinorVersionUpgrade: '{{ response.DBInstances.AutoMinorVersionUpgrade }}'
      ReadReplicaSourceDBInstanceIdentifier: '{{ response.DBInstances.ReadReplicaSourceDBInstanceIdentifier
        }}'
      ReadReplicaDBInstanceIdentifiers: '{{ response.DBInstances.ReadReplicaDBInstanceIdentifiers
        }}'
      ReadReplicaDBClusterIdentifiers: '{{ response.DBInstances.ReadReplicaDBClusterIdentifiers
        }}'
      ReplicaMode: '{{ response.DBInstances.ReplicaMode }}'
      LicenseModel: '{{ response.DBInstances.LicenseModel }}'
      Iops: '{{ response.DBInstances.Iops }}'
      StorageThroughput: '{{ response.DBInstances.StorageThroughput }}'
      OptionGroupMemberships: '{{ response.DBInstances.OptionGroupMemberships }}'
      CharacterSetName: '{{ response.DBInstances.CharacterSetName }}'
      NcharCharacterSetName: '{{ response.DBInstances.NcharCharacterSetName }}'
      SecondaryAvailabilityZone: '{{ response.DBInstances.SecondaryAvailabilityZone
        }}'
      PubliclyAccessible: '{{ response.DBInstances.PubliclyAccessible }}'
      StatusInfos: '{{ response.DBInstances.StatusInfos }}'
      StorageType: '{{ response.DBInstances.StorageType }}'
      TdeCredentialArn: '{{ response.DBInstances.TdeCredentialArn }}'
      DbInstancePort: '{{ response.DBInstances.DbInstancePort }}'
      DBClusterIdentifier: '{{ response.DBInstances.DBClusterIdentifier }}'
      StorageEncrypted: '{{ response.DBInstances.StorageEncrypted }}'
      KmsKeyId: '{{ response.DBInstances.KmsKeyId }}'
      DbiResourceId: '{{ response.DBInstances.DbiResourceId }}'
      CACertificateIdentifier: '{{ response.DBInstances.CACertificateIdentifier }}'
      DomainMemberships: '{{ response.DBInstances.DomainMemberships }}'
      CopyTagsToSnapshot: '{{ response.DBInstances.CopyTagsToSnapshot }}'
      MonitoringInterval: '{{ response.DBInstances.MonitoringInterval }}'
      EnhancedMonitoringResourceArn: '{{ response.DBInstances.EnhancedMonitoringResourceArn
        }}'
      MonitoringRoleArn: '{{ response.DBInstances.MonitoringRoleArn }}'
      PromotionTier: '{{ response.DBInstances.PromotionTier }}'
      DBInstanceArn: '{{ response.DBInstances.DBInstanceArn }}'
      Timezone: '{{ response.DBInstances.Timezone }}'
      IAMDatabaseAuthenticationEnabled: '{{ response.DBInstances.IAMDatabaseAuthenticationEnabled
        }}'
      DatabaseInsightsMode: '{{ response.DBInstances.DatabaseInsightsMode }}'
      PerformanceInsightsEnabled: '{{ response.DBInstances.PerformanceInsightsEnabled
        }}'
      PerformanceInsightsKMSKeyId: '{{ response.DBInstances.PerformanceInsightsKMSKeyId
        }}'
      PerformanceInsightsRetentionPeriod: '{{ response.DBInstances.PerformanceInsightsRetentionPeriod
        }}'
      EnabledCloudwatchLogsExports: '{{ response.DBInstances.EnabledCloudwatchLogsExports
        }}'
      ProcessorFeatures: '{{ response.DBInstances.ProcessorFeatures }}'
      DeletionProtection: '{{ response.DBInstances.DeletionProtection }}'
      AssociatedRoles: '{{ response.DBInstances.AssociatedRoles }}'
      ListenerEndpoint: '{{ response.DBInstances.ListenerEndpoint }}'
      MaxAllocatedStorage: '{{ response.DBInstances.MaxAllocatedStorage }}'
      TagList: '{{ response.DBInstances.TagList }}'
      AutomationMode: '{{ response.DBInstances.AutomationMode }}'
      ResumeFullAutomationModeTime: '{{ response.DBInstances.ResumeFullAutomationModeTime
        }}'
      CustomerOwnedIpEnabled: '{{ response.DBInstances.CustomerOwnedIpEnabled }}'
      NetworkType: '{{ response.DBInstances.NetworkType }}'
      ActivityStreamStatus: '{{ response.DBInstances.ActivityStreamStatus }}'
      ActivityStreamKmsKeyId: '{{ response.DBInstances.ActivityStreamKmsKeyId }}'
      ActivityStreamKinesisStreamName: '{{ response.DBInstances.ActivityStreamKinesisStreamName
        }}'
      ActivityStreamMode: '{{ response.DBInstances.ActivityStreamMode }}'
      ActivityStreamEngineNativeAuditFieldsIncluded: '{{ response.DBInstances.ActivityStreamEngineNativeAuditFieldsIncluded
        }}'
      AwsBackupRecoveryPointArn: '{{ response.DBInstances.AwsBackupRecoveryPointArn
        }}'
      DBInstanceAutomatedBackupsReplications: '{{ response.DBInstances.DBInstanceAutomatedBackupsReplications
        }}'
      BackupTarget: '{{ response.DBInstances.BackupTarget }}'
      AutomaticRestartTime: '{{ response.DBInstances.AutomaticRestartTime }}'
      CustomIamInstanceProfile: '{{ response.DBInstances.CustomIamInstanceProfile
        }}'
      ActivityStreamPolicyStatus: '{{ response.DBInstances.ActivityStreamPolicyStatus
        }}'
      CertificateDetails: '{{ response.DBInstances.CertificateDetails }}'
      DBSystemId: '{{ response.DBInstances.DBSystemId }}'
      MasterUserSecret: '{{ response.DBInstances.MasterUserSecret }}'
      ReadReplicaSourceDBClusterIdentifier: '{{ response.DBInstances.ReadReplicaSourceDBClusterIdentifier
        }}'
      PercentProgress: '{{ response.DBInstances.PercentProgress }}'
      MultiTenant: '{{ response.DBInstances.MultiTenant }}'
      DedicatedLogVolume: '{{ response.DBInstances.DedicatedLogVolume }}'
      IsStorageConfigUpgradeAvailable: '{{ response.DBInstances.IsStorageConfigUpgradeAvailable
        }}'
      EngineLifecycleSupport: '{{ response.DBInstances.EngineLifecycleSupport }}'
- discovery_id: aws.rds.describe_reserved_d_b_instances
  calls:
  - action: describe_reserved_db_instances
    save_as: response
  emit:
    item:
      ReservedDBInstanceId: '{{ response.ReservedDBInstances.ReservedDBInstanceId
        }}'
      ReservedDBInstancesOfferingId: '{{ response.ReservedDBInstances.ReservedDBInstancesOfferingId
        }}'
      DBInstanceClass: '{{ response.ReservedDBInstances.DBInstanceClass }}'
      StartTime: '{{ response.ReservedDBInstances.StartTime }}'
      Duration: '{{ response.ReservedDBInstances.Duration }}'
      FixedPrice: '{{ response.ReservedDBInstances.FixedPrice }}'
      UsagePrice: '{{ response.ReservedDBInstances.UsagePrice }}'
      CurrencyCode: '{{ response.ReservedDBInstances.CurrencyCode }}'
      DBInstanceCount: '{{ response.ReservedDBInstances.DBInstanceCount }}'
      ProductDescription: '{{ response.ReservedDBInstances.ProductDescription }}'
      OfferingType: '{{ response.ReservedDBInstances.OfferingType }}'
      MultiAZ: '{{ response.ReservedDBInstances.MultiAZ }}'
      State: '{{ response.ReservedDBInstances.State }}'
      RecurringCharges: '{{ response.ReservedDBInstances.RecurringCharges }}'
      ReservedDBInstanceArn: '{{ response.ReservedDBInstances.ReservedDBInstanceArn
        }}'
      LeaseId: '{{ response.ReservedDBInstances.LeaseId }}'
      ReservedDBInstances: '{{ resource.ReservedDBInstances }}'
checks:
- rule_id: aws.rds.securitygroup.security_egress_restricted
  for_each: aws.rds.describe_d_b_proxies
  conditions:
    var: item.VpcSecurityGroupIds
    op: not_equals
    value: 'null'
- rule_id: aws.rds.instance.storage_encrypted
  for_each: aws.rds.describe_d_b_cluster_automated_backups
  conditions:
    var: item.StorageEncrypted
    op: equals
    value: 'true'
- rule_id: aws.rds.instance.public_access_disabled
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.PubliclyAccessible
    op: equals
    value: 'false'
- rule_id: aws.rds.securitygroup.security_only_required_ports_open_restricted
  for_each: aws.rds.describe_option_group_options
  conditions:
    var: item.PortRequired
    op: not_equals
    value: 'null'
- rule_id: aws.rds.snapshot.not_publicly_shared_configured
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.PubliclyAccessible
    op: equals
    value: 'false'
- rule_id: aws.rds.cluster.public_access_disabled
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.PubliclyAccessible
    op: equals
    value: 'false'
- rule_id: aws.rds.optiongroup.insecure_extensions_not_enabled
  for_each: aws.rds.describe_d_b_cluster_automated_backups
  conditions:
    var: item.Enabled
    op: equals
    value: false
- rule_id: aws.rds.parametergroup.insecure_features_disabled_if_applicable_configured
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.GlobalWriteForwardingStatus
    op: not_equals
    value: enabled
- rule_id: aws.rds.resource.dynamodb_table_encryption_enabled
  for_each: aws.rds.describe_d_b_instance_automated_backups
  conditions:
    var: item.Encrypted
    op: equals
    value: 'true'
- rule_id: aws.rds.instance.iam_authentication_enabled
  for_each: aws.rds.describe_d_b_cluster_automated_backups
  conditions:
    var: item.IAMDatabaseAuthenticationEnabled
    op: equals
    value: 'true'
- rule_id: aws.rds.instance.auto_minor_version_upgrade_configured
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.AutoMinorVersionUpgrade
    op: equals
    value: 'true'
- rule_id: aws.rds.instance.backup_encrypted
  for_each: aws.rds.describe_d_b_instance_automated_backups
  conditions:
    var: item.Encrypted
    op: equals
    value: 'true'
- rule_id: aws.rds.instance.enhanced_monitoring_enabled
  for_each: aws.rds.describe_orderable_d_b_instance_options
  conditions:
    var: item.SupportsEnhancedMonitoring
    op: equals
    value: 'true'
- rule_id: aws.rds.instance.encryption_at_rest_enabled
  for_each: aws.rds.describe_d_b_instance_automated_backups
  conditions:
    var: item.Encrypted
    op: equals
    value: 'true'
- rule_id: aws.rds.instance.integration_cloudwatch_logs_configured
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.EnabledCloudwatchLogsExports
    op: equals
    value: 'true'
- rule_id: aws.rds.dbuser.approved_list_of_superusers_only_configured
  for_each: aws.rds.describe_d_b_proxies
  conditions:
    var: item.VpcSecurityGroupIds
    op: not_equals
    value: 'null'
- rule_id: aws.rds.instance.performance_insights_enabled
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.PerformanceInsightsEnabled
    op: equals
    value: true
- rule_id: aws.rds.dbuser.no_unused_or_default_superusers_configured
  for_each: aws.rds.describe_d_b_proxy_endpoints
  conditions:
    var: item.IsDefault
    op: equals
    value: 'false'
- rule_id: aws.rds.instance.security_configuration_review_configured
  for_each: aws.rds.describe_d_b_instances
  conditions:
    var: item.DBInstanceStatus
    op: equals
    value: available
- rule_id: aws.rds.instance.deletion_protection_enabled
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.DeletionProtection
    op: equals
    value: 'true'
- rule_id: aws.rds.snapshots.public_access_configured
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.PubliclyAccessible
    op: equals
    value: 'false'
- rule_id: aws.rds.cluster.encryption_at_rest_cmek_configured
  for_each: aws.rds.describe_d_b_instance_automated_backups
  conditions:
    var: item.Encrypted
    op: equals
    value: 'true'
- rule_id: aws.rds.backup_retention_period.backup_retention_period_configured
  for_each: aws.rds.describe_d_b_cluster_automated_backups
  conditions:
    var: item.BackupRetentionPeriod
    op: not_equals
    value: 'null'
- rule_id: aws.rds.instance.backup_enabled
  for_each: aws.rds.describe_d_b_instance_automated_backups
  conditions:
    var: item.DBInstanceAutomatedBackups
    op: equals
    value: 'true'
- rule_id: aws.rds.cluster.multi_az_configured
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.MultiAZ
    op: equals
    value: 'true'
- rule_id: aws.rds.reserved_instance.billing_admins_mfa_required
  for_each: aws.rds.describe_reserved_d_b_instances
  conditions:
    var: item.ReservedDBInstances
    op: not_equals
    value: 'null'
- rule_id: aws.rds.snapshot.encryption_at_rest_enabled
  for_each: aws.rds.describe_d_b_instance_automated_backups
  conditions:
    var: item.Encrypted
    op: equals
    value: 'true'
- rule_id: aws.rds.snapshot.cross_account_sharing_restricted
  for_each: aws.rds.describe_option_group_options
  conditions:
    var: item.CopyableCrossAccount
    op: not_equals
    value: 'true'
- rule_id: aws.rds.reserved_instance.purchase_permissions_restricted
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.PubliclyAccessible
    op: equals
    value: 'false'
- rule_id: aws.rds.clustersnapshot.not_publicly_shared_configured
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.PubliclyAccessible
    op: equals
    value: 'false'
- rule_id: aws.rds.snapshot.storage_encrypted
  for_each: aws.rds.describe_d_b_cluster_automated_backups
  conditions:
    var: item.StorageEncrypted
    op: equals
    value: 'true'
- rule_id: aws.rds.reserved_instance.instance_approval_workflow_required
  for_each: aws.rds.describe_reserved_d_b_instances
  conditions:
    var: item.ReservedDBInstances
    op: not_equals
    value: 'null'
- rule_id: aws.rds.resource.snapshots_encrypted
  for_each: aws.rds.describe_d_b_instance_automated_backups
  conditions:
    var: item.Encrypted
    op: equals
    value: 'true'
- rule_id: aws.rds.cluster.audit_logging_enabled
  for_each: aws.rds.describe_d_b_cluster_automated_backups
  conditions:
    var: item.Enabled
    op: equals
    value: 'true'
- rule_id: aws.rds.cluster.iam_or_managed_identity_auth_enabled_if_supported
  for_each: aws.rds.describe_d_b_proxies
  conditions:
    var: item.Auth
    op: not_equals
    value: 'null'
- rule_id: aws.rds.cluster.storage_encrypted
  for_each: aws.rds.describe_d_b_cluster_automated_backups
  conditions:
    var: item.StorageEncrypted
    op: equals
    value: 'true'
- rule_id: aws.rds.cluster.private_networking_enforced
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.PubliclyAccessible
    op: equals
    value: 'false'
- rule_id: aws.rds.securitygroup.security_no_0_ingress_on_db_ports_configured
  for_each: aws.rds.describe_d_b_proxies
  conditions:
    var: item.VpcSecurityGroupIds
    op: not_equals
    value: 'null'
- rule_id: aws.rds.cluster.deletion_protection_enabled
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.DeletionProtection
    op: equals
    value: 'true'
- rule_id: aws.rds.instance.no_public_access_configured
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.PubliclyAccessible
    op: equals
    value: 'false'
- rule_id: aws.rds.parametergroup.audit_logging_enabled
  for_each: aws.rds.describe_d_b_cluster_automated_backups
  conditions:
    var: item.Enabled
    op: equals
    value: true
- rule_id: aws.rds.optiongroup.only_approved_extensions_enabled
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.VpcSecurityGroups
    op: not_equals
    value: 'null'
- rule_id: aws.rds.snapshot.cross_region_copy_encrypted
  for_each: aws.rds.describe_d_b_instance_automated_backups
  conditions:
    var: item.Encrypted
    op: equals
    value: 'true'
- rule_id: aws.rds.cluster.encryption_at_rest_enabled
  for_each: aws.rds.describe_d_b_instance_automated_backups
  conditions:
    var: item.Encrypted
    op: equals
    value: 'true'
- rule_id: aws.rds.subnetgroup.private_subnets_only_configured
  for_each: aws.rds.describe_d_b_cluster_automated_backups
  conditions:
    var: item.Vpc
    op: not_equals
    value: 'null'
- rule_id: aws.rds.clustersnapshot.snapshot_cross_account_sharing_restricted
  for_each: aws.rds.describe_option_group_options
  conditions:
    var: item.CopyableCrossAccount
    op: equals
    value: 'false'
- rule_id: aws.rds.dbuser.iam_auth_preferred_configured
  for_each: aws.rds.describe_d_b_proxies
  conditions:
    var: item.Auth
    op: equals
    value: IAM
- rule_id: aws.rds.parametergroup.require_ssl_configured
  for_each: aws.rds.describe_d_b_proxies
  conditions:
    var: item.RequireTLS
    op: equals
    value: 'true'
- rule_id: aws.rds.cluster.require_tls_in_transit_configured
  for_each: aws.rds.describe_d_b_proxies
  conditions:
    var: item.RequireTLS
    op: equals
    value: 'true'
- rule_id: aws.rds.instance.multi_az_configured
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.MultiAZ
    op: equals
    value: 'true'
- rule_id: aws.rds.cluster.copy_tags_to_snapshots_configured
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.CopyTagsToSnapshot
    op: not_empty
- rule_id: aws.rds.clustersnapshot.snapshot_cross_region_copy_encrypted
  for_each: aws.rds.describe_d_b_instance_automated_backups
  conditions:
    var: item.Encrypted
    op: equals
    value: 'true'
- rule_id: aws.rds.instance.iam_or_managed_identity_auth_enabled_if_supported
  for_each: aws.rds.describe_d_b_proxies
  conditions:
    var: item.Auth
    op: equals
    value: IAM
- rule_id: aws.rds.instance.inside_vpc_configured
  for_each: aws.rds.describe_d_b_cluster_automated_backups
  conditions:
    var: item.Vpc
    op: not_equals
    value: 'null'
- rule_id: aws.rds.instance.deletion_protection_configured
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.DeletionProtection
    op: equals
    value: 'true'
- rule_id: aws.rds.instance.require_tls_in_transit_configured
  for_each: aws.rds.describe_d_b_proxies
  conditions:
    var: item.RequireTLS
    op: equals
    value: 'true'
- rule_id: aws.rds.clustersnapshot.encryption_at_rest_enabled
  for_each: aws.rds.describe_d_b_instance_automated_backups
  conditions:
    var: item.Encrypted
    op: equals
    value: 'true'
- rule_id: aws.rds.snapshot.not_public_configured
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.PubliclyAccessible
    op: equals
    value: 'false'
- rule_id: aws.rds.instance.transport_encrypted
  for_each: aws.rds.describe_d_b_instance_automated_backups
  conditions:
    var: item.Encrypted
    op: equals
    value: 'true'
- rule_id: aws.rds.cluster.integration_cloudwatch_logs_configured
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.EnabledCloudwatchLogsExports
    op: equals
    value: 'null'
- rule_id: aws.rds.instance.copy_tags_to_snapshots_configured
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.CopyTagsToSnapshot
    op: not_empty
- rule_id: aws.rds.snapshots_public_access.snapshots_public_access_configured
  for_each: aws.rds.describe_d_b_clusters
  conditions:
    var: item.PubliclyAccessible
    op: equals
    value: 'false'
