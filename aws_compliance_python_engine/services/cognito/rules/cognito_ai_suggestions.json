[
  {
    "rule_id": "aws.cognito.userpool.access_keys_rotated_90_days_or_less_when_present",
    "success": false,
    "error": "Connection error after 5 attempts: Connection error."
  },
  {
    "rule_id": "aws.cognito.userpoolgroup.cognito_no_inline_policies_configured",
    "suggested_condition": {
      "var": "item.Policies",
      "op": "not_equals",
      "value": "null",
      "reasoning": "The Policies field is used to check if any inline policies are configured for the Cognito userpoolgroup. A value of 'null' indicates that no inline policies are present, which aligns with the security rule's requirement.",
      "confidence": 1.0
    },
    "fields_analyzed": 25,
    "total_fields": 154,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.cognito.userpool.console_password_present_only_if_required",
    "suggested_condition": {
      "var": "item.UseCognitoProvidedValues",
      "op": "equals",
      "value": "true",
      "reasoning": "The rule requires checking if the console password is present only if required, which relates to whether Cognito is configured to use provided values. The field 'UseCognitoProvidedValues' allows us to check this configuration.",
      "confidence": 1.0
    },
    "fields_analyzed": 24,
    "total_fields": 154,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.cognito.userpool.mfa_required",
    "suggested_condition": {
      "var": "item.MfaConfiguration",
      "op": "equals",
      "value": "ENABLED",
      "reasoning": "The MfaConfiguration field is used to check if multi-factor authentication is enabled for the Cognito user pool, which aligns with the security rule's requirement for MFA.",
      "confidence": 1.0
    },
    "fields_analyzed": 14,
    "total_fields": 154,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.cognito.userpool.cognito_store_encrypted",
    "suggested_condition": {
      "var": "item.Enabled",
      "op": "equals",
      "value": "true",
      "reasoning": "The 'Enabled' field indicates whether the Cognito store encryption is enabled for the user pool. Checking if it equals 'true' ensures that the encryption is properly configured.",
      "confidence": 1.0
    },
    "fields_analyzed": 28,
    "total_fields": 154,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.cognito.userpool.cognito_inactive_90_days_disabled",
    "suggested_condition": {
      "var": "item.Status",
      "op": "equals",
      "value": "Disabled",
      "reasoning": "The Status field is used to check if the Cognito user pool has the inactive status properly configured. Using 'equals' with the value 'Disabled' ensures that the user pool does not allow inactive users for more than 90 days.",
      "confidence": 1.0
    },
    "fields_analyzed": 25,
    "total_fields": 154,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.cognito.userpool.rbac_least_privilege",
    "suggested_condition": {
      "var": "item.UserPool",
      "op": "not_equals",
      "value": "null",
      "reasoning": "The UserPool field is relevant for ensuring that the Cognito user pool is properly configured. Checking if it is not null helps confirm that there is a user pool in place to review permissions.",
      "confidence": 1.0
    },
    "fields_analyzed": 9,
    "total_fields": 154,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.cognito.userpool.cognito_no_inline_policies_enabled",
    "suggested_condition": {
      "var": "item.Policies",
      "op": "not_equals",
      "value": "null",
      "reasoning": "The Policies field can be checked to ensure that there are no inline policies configured for the Cognito user pool. Using 'not_equals' with 'null' checks that the Policies field is not empty, which indicates that inline policies are not present.",
      "confidence": 1.0
    },
    "fields_analyzed": 26,
    "total_fields": 154,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.cognito.userpoolgroup.cognito_attached_policies_not_admin_star_configured",
    "suggested_condition": {
      "var": "item.Policies",
      "op": "not_equals",
      "value": "arn:aws:iam::aws:policy/AdministratorAccess",
      "reasoning": "The Policies field is used to check the attached policies for the Cognito userpoolgroup. We want to ensure that it does not include the AdministratorAccess policy, which is represented by the ARN.",
      "confidence": 1.0
    },
    "fields_analyzed": 25,
    "total_fields": 154,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.cognito.userpool.cognito_workflow_storage_encrypted",
    "suggested_condition": {
      "var": "item.Enabled",
      "op": "equals",
      "value": "true",
      "reasoning": "The 'Enabled' field is relevant for checking if the Cognito user pool has encryption enabled, which is essential for the compliance rule regarding Cognito Workflow Storage Encryption.",
      "confidence": 1.0
    },
    "fields_analyzed": 11,
    "total_fields": 154,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.cognito.userpool.execution_roles_least_privilege",
    "suggested_condition": {
      "var": "item.UserPool",
      "op": "not_equals",
      "value": "null",
      "reasoning": "The UserPool field is relevant for checking the configuration of Cognito user pools, ensuring that it is not null indicates that a user pool exists and can be evaluated for execution roles.",
      "confidence": 1.0
    },
    "fields_analyzed": 9,
    "total_fields": 154,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.cognito.userpoolgroup.cognito_membership_review_enabled_if_supported",
    "suggested_condition": {
      "var": "item.Enabled",
      "op": "equals",
      "value": "true",
      "reasoning": "The field 'Enabled' is relevant for checking if Cognito Membership Review is enabled, which aligns with the security compliance rule.",
      "confidence": 1.0
    },
    "fields_analyzed": 25,
    "total_fields": 154,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.cognito.userpool.access_keys_rotated_90_days_or_less_when_present",
    "error": "Operator 'less_than_or_equal' not allowed for field 'AccessTokenValidity'. Allowed operators from direct_vars.json: ['equals', 'not_equals', 'contains', 'in']. Please use one of these operators instead.",
    "success": false
  }
]