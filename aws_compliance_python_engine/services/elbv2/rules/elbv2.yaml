version: '1.0'
provider: aws
service: elbv2
discovery:
- discovery_id: aws.elbv2.targetgroups
  calls:
  - client: elbv2
    action: describe_load_balancers
    save_as: targetgroup_list
    on_error: continue
    fields:
    - Elbv2s
  emit:
    items_for: targetgroup_list[]
    as: targetgroup
    item:
      id: '{{ targetgroup.Id }}'
      name: '{{ targetgroup.Name }}'
- discovery_id: aws.elbv2.targetgroup_logging
  for_each: aws.elbv2.targetgroups
  calls:
  - client: elbv2
    action: describe_account_limits
    params:
      TargetgroupId: '{{ item.id }}'
    save_as: logging
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      logging_enabled: '{{ logging.LoggingEnabled is defined if logging else false }}'
- discovery_id: aws.elbv2.isinmultipleazs
  for_each: aws.elbv2.isinmultipleaz
  calls:
  - client: elbv2
    action: describe_account_limits
    save_as: isinmultipleazs
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.elbv2.alb_https_redirects
  for_each: aws.elbv2.alb_https_redirect
  calls:
  - client: elbv2
    action: describe_account_limits
    save_as: alb_https_redirects
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.elbv2.groups
  for_each: aws.elbv2.group
  calls:
  - client: elbv2
    action: describe_account_limits
    save_as: groups
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.elbv2.wafaclattacheds
  for_each: aws.elbv2.wafaclattached
  calls:
  - client: elbv2
    action: describe_account_limits
    save_as: wafaclattacheds
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.elbv2.resource_logging
  calls:
  - client: elbv2
    action: describe_load_balancers
    save_as: resource_logging
    on_error: continue
  emit:
    items_for: resource_logging[]
    as: resource_logging
    item:
      id: '{{ resource_logging.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.elbv2.insecure_ssl_cipherss
  for_each: aws.elbv2.insecure_ssl_cipher
  calls:
  - client: elbv2
    action: describe_account_limits
    save_as: insecure_ssl_cipherss
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.elbv2.loadbalancer_logging
  calls:
  - client: elbv2
    action: describe_load_balancer_attributes
    save_as: loadbalancer_logging
    on_error: continue
  emit:
    items_for: loadbalancer_logging[]
    as: loadbalancer_logging
    item:
      id: '{{ loadbalancer_logging.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.elbv2.internetfacings
  for_each: aws.elbv2.internetfacing
  calls:
  - client: elbv2
    action: describe_account_limits
    save_as: internetfacings
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.elbv2.loadbalancers
  for_each: aws.elbv2.loadbalancer
  calls:
  - client: elbv2
    action: describe_load_balancers
    save_as: loadbalancers
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.elbv2.deletion_protections
  for_each: aws.elbv2.deletion_protection
  calls:
  - client: elbv2
    action: describe_account_limits
    save_as: deletion_protections
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.elbv2.listeners
  for_each: aws.elbv2.listener
  calls:
  - client: elbv2
    action: describe_listeners
    save_as: listeners
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.elbv2.logging_logging
  calls:
  - client: elbv2
    action: list_logging_logging
    save_as: logging_logging
    on_error: continue
  emit:
    items_for: logging_logging[]
    as: logging_logging
    item:
      id: '{{ logging_logging.Id }}'
      compliant: '{{ true }}'
checks:
- title: 'ELBV2 listener: Cipher Policy Secure Configured'
  severity: high
  rule_id: aws.elbv2.listener.cipher_policy_secure_configured
  for_each:
    discovery: aws.elbv2.listeners
    as: listener
    item: listener
  conditions:
    var: listener.is_public
    op: equals
    value: false
  remediation: "Restrict public access for elbv2 listener:\n\n1. Open ELBV2 console\n2. Select the listener\n3. Go to Permissions/Access\
    \ Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*) principals\n   -\
    \ Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access control\n7. Save\
    \ changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement condition keys for\
    \ additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\u2022 Use\
    \ AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'ELBV2 isinmultipleaz: Elbv2 Is In Multiple Az Configured'
  severity: medium
  rule_id: aws.elbv2.isinmultipleaz.elbv2_is_in_multiple_az_configured
  for_each:
    discovery: aws.elbv2.isinmultipleazs
    as: isinmultipleaz
    item: isinmultipleaz
  conditions:
    var: isinmultipleaz.compliant
    op: equals
    value: true
  remediation: "Configure elbv2 isinmultipleaz for compliance:\n\nRequirement: Elbv2 Is In Multiple Az Configuration\n\nDescription:\
    \ Verifies security configuration for Application Load Balancer isinmultipleaz to ensure alignment with AWS security best\
    \ practices and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and\
    \ supports overall security posture.\n\nSteps:\n1. Open ELBV2 console\n2. Select the isinmultipleaz\n3. Review security\
    \ configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral\
    \ Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable\
    \ logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'ELBV2 loadbalancer: Waf Attached If Supported'
  severity: medium
  rule_id: aws.elbv2.loadbalancer.waf_attached_if_supported
  for_each:
    discovery: aws.elbv2.loadbalancers
    as: loadbalancer
    item: loadbalancer
  conditions:
    var: loadbalancer.compliant
    op: equals
    value: true
  remediation: "Configure elbv2 loadbalancer for compliance:\n\nRequirement: Waf Attached If Supported\n\nDescription: Verifies\
    \ security configuration for Application Load Balancer loadbalancer to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open ELBV2 console\n2. Select the loadbalancer\n3. Review security configuration\n4.\
    \ Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'ELBV2 internetfacing: Elbv2 Internet Facing Configured'
  severity: medium
  rule_id: aws.elbv2.internetfacing.elbv2_internet_facing_configured
  for_each:
    discovery: aws.elbv2.internetfacings
    as: internetfacing
    item: internetfacing
  conditions:
    var: internetfacing.compliant
    op: equals
    value: true
  remediation: "Configure elbv2 internetfacing for compliance:\n\nRequirement: Elbv2 Internet Facing Configuration\n\nDescription:\
    \ Verifies security configuration for Application Load Balancer internetfacing to ensure alignment with AWS security best\
    \ practices and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and\
    \ supports overall security posture.\n\nSteps:\n1. Open ELBV2 console\n2. Select the internetfacing\n3. Review security\
    \ configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral\
    \ Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable\
    \ logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'ELBV2 listener: Tls Min 1 2 Configured'
  severity: high
  rule_id: aws.elbv2.listener.tls_min_1_2_configured
  for_each:
    discovery: aws.elbv2.listeners
    as: listener
    item: listener
  conditions:
    var: listener.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for elbv2 listener:\n\n1. Ensure listener is deployed in VPC\n2. Configure security\
    \ groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3.\
    \ Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'ELBV2 deletion protection: Deletion Protection Configured'
  severity: medium
  rule_id: aws.elbv2.deletion_protection.deletion_protection_configured
  for_each:
    discovery: aws.elbv2.deletion_protections
    as: deletion_protection
    item: deletion_protection
  conditions:
    var: deletion_protection.compliant
    op: equals
    value: true
  remediation: "Configure elbv2 deletion_protection for compliance:\n\nRequirement: Deletion Protection Configuration\n\n\
    Description: Ensures Application Load Balancer deletion protection has deletion protection enabled to prevent accidental\
    \ or malicious removal. Deletion protection provides a safety mechanism requiring explicit disablement before deletion,\
    \ preventing service disruption and data loss.\n\nSteps:\n1. Open ELBV2 console\n2. Select the deletion_protection\n3.\
    \ Review security configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\
    \nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\
    \u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'ELBV2 group: Security Check Health Check Enabled'
  severity: medium
  rule_id: aws.elbv2.group.security_check_health_check_enabled
  for_each:
    discovery: aws.elbv2.groups
    as: group
    item: group
  conditions:
    var: group.compliant
    op: equals
    value: true
  remediation: "Configure elbv2 group for compliance:\n\nRequirement: Security Check Health Check Enabled\n\nDescription:\
    \ Verifies security configuration for Application Load Balancer group to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open ELBV2 console\n2. Select the group\n3. Review security configuration\n4. Apply\
    \ required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'ELBV2 loadbalancer: Valid Certificate Enabled'
  severity: medium
  rule_id: aws.elbv2.loadbalancer.valid_certificate_enabled
  for_each:
    discovery: aws.elbv2.loadbalancers
    as: loadbalancer
    item: loadbalancer
  conditions:
    var: loadbalancer.compliant
    op: equals
    value: true
  remediation: "Configure elbv2 loadbalancer for compliance:\n\nRequirement: Valid Certificate Enabled\n\nDescription: Verifies\
    \ security configuration for Application Load Balancer loadbalancer to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open ELBV2 console\n2. Select the loadbalancer\n3. Review security configuration\n4.\
    \ Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'ELBV2 targetgroup: Health Checks Tls If Supported Configured'
  severity: high
  rule_id: aws.elbv2.targetgroup.health_checks_tls_if_supported_configured
  for_each:
    discovery: aws.elbv2.targetgroups
    as: targetgroup
    item: targetgroup
  conditions:
    var: targetgroup.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for elbv2 targetgroup:\n\n1. Ensure targetgroup is deployed in VPC\n2. Configure\
    \ security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n\
    3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'ELBV2 targetgroup: Elbv2 Targets In Private Subnets Configured'
  severity: high
  rule_id: aws.elbv2.targetgroup.elbv2_targets_in_private_subnets_configured
  for_each:
    discovery: aws.elbv2.targetgroups
    as: targetgroup
    item: targetgroup
  conditions:
    var: targetgroup.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for elbv2 targetgroup:\n\n1. Ensure targetgroup is deployed in VPC\n2. Configure\
    \ security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n\
    3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'ELBV2 resource: Logging Enabled'
  severity: medium
  rule_id: aws.elbv2.resource.logging_enabled
  for_each:
    discovery: aws.elbv2.resource_logging
    as: resource
    item: resource
  conditions:
    var: logging.logging_enabled
    op: equals
    value: true
  remediation: "Enable logging for elbv2 resource:\n\n1. Open ELBV2 console\n2. Select the resource\n3. Go to Logging/Monitoring\
    \ settings\n4. Enable logging\n5. Configure log destination:\n   - CloudWatch Logs\n   - S3 bucket (for long-term retention)\n\
    6. Set log level (INFO, DEBUG, ERROR)\n7. Save changes\n\nAWS CLI:\naws elbv2 update-resource-logging --resource-id <id>\
    \ --logging-enabled\n\nBest Practices:\n\u2022 Enable all security-relevant log types\n\u2022 Send logs to centralized\
    \ logging service\n\u2022 Set appropriate retention periods\n\u2022 Configure log encryption\n\u2022 Set up log monitoring\
    \ and alerting"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'ELBV2 loadbalancer: Deletion Protection Enabled'
  severity: medium
  rule_id: aws.elbv2.loadbalancer.deletion_protection_enabled
  for_each:
    discovery: aws.elbv2.loadbalancers
    as: loadbalancer
    item: loadbalancer
  conditions:
    var: loadbalancer.compliant
    op: equals
    value: true
  remediation: "Configure elbv2 loadbalancer for compliance:\n\nRequirement: Deletion Protection\n\nDescription: Ensures Application\
    \ Load Balancer loadbalancer has deletion protection enabled to prevent accidental or malicious removal. Deletion protection\
    \ provides a safety mechanism requiring explicit disablement before deletion, preventing service disruption and data loss.\n\
    \nSteps:\n1. Open ELBV2 console\n2. Select the loadbalancer\n3. Review security configuration\n4. Apply required settings\
    \ per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow\
    \ AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use\
    \ encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'ELBV2 logging: Access Logging Enabled'
  severity: medium
  rule_id: aws.elbv2.logging.access_logging_enabled
  for_each:
    discovery: aws.elbv2.logging_logging
    as: logging
    item: logging
  conditions:
    var: logging.logging_enabled
    op: equals
    value: true
  remediation: "Enable logging for elbv2 logging:\n\n1. Open ELBV2 console\n2. Select the logging\n3. Go to Logging/Monitoring\
    \ settings\n4. Enable logging\n5. Configure log destination:\n   - CloudWatch Logs\n   - S3 bucket (for long-term retention)\n\
    6. Set log level (INFO, DEBUG, ERROR)\n7. Save changes\n\nAWS CLI:\naws elbv2 update-logging-logging --logging-id <id>\
    \ --logging-enabled\n\nBest Practices:\n\u2022 Enable all security-relevant log types\n\u2022 Send logs to centralized\
    \ logging service\n\u2022 Set appropriate retention periods\n\u2022 Configure log encryption\n\u2022 Set up log monitoring\
    \ and alerting"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'ELBV2 insecure ssl ciphers: Insecure Ssl Ciphers Configured'
  severity: high
  rule_id: aws.elbv2.insecure_ssl_ciphers.insecure_ssl_ciphers_configured
  for_each:
    discovery: aws.elbv2.insecure_ssl_cipherss
    as: insecure_ssl_ciphers
    item: insecure_ssl_ciphers
  conditions:
    var: insecure_ssl_ciphers.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for elbv2 insecure_ssl_ciphers:\n\n1. Ensure insecure_ssl_ciphers is deployed in\
    \ VPC\n2. Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n\
    \   - Use least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n\
    5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\
    \u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement\
    \ defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'ELBV2 wafaclattached: Waf Acl Enabled'
  severity: medium
  rule_id: aws.elbv2.wafaclattached.waf_acl_enabled
  for_each:
    discovery: aws.elbv2.wafaclattacheds
    as: wafaclattached
    item: wafaclattached
  conditions:
    var: wafaclattached.compliant
    op: equals
    value: true
  remediation: "Configure elbv2 wafaclattached for compliance:\n\nRequirement: Waf Acl Enabled\n\nDescription: Verifies security\
    \ configuration for Application Load Balancer wafaclattached to ensure alignment with AWS security best practices and\
    \ compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open ELBV2 console\n2. Select the wafaclattached\n3. Review security configuration\n\
    4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'ELBV2 loadbalancer: Access Logs Enabled'
  severity: medium
  rule_id: aws.elbv2.loadbalancer.access_logs_enabled
  for_each:
    discovery: aws.elbv2.loadbalancer_logging
    as: loadbalancer
    item: loadbalancer
  conditions:
    var: logging.logging_enabled
    op: equals
    value: true
  remediation: "Enable logging for elbv2 loadbalancer:\n\n1. Open ELBV2 console\n2. Select the loadbalancer\n3. Go to Logging/Monitoring\
    \ settings\n4. Enable logging\n5. Configure log destination:\n   - CloudWatch Logs\n   - S3 bucket (for long-term retention)\n\
    6. Set log level (INFO, DEBUG, ERROR)\n7. Save changes\n\nAWS CLI:\naws elbv2 update-loadbalancer-logging --loadbalancer-id\
    \ <id> --logging-enabled\n\nBest Practices:\n\u2022 Enable all security-relevant log types\n\u2022 Send logs to centralized\
    \ logging service\n\u2022 Set appropriate retention periods\n\u2022 Configure log encryption\n\u2022 Set up log monitoring\
    \ and alerting"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'ELBV2 loadbalancer: Listener Tls Min 1 2 Configured'
  severity: high
  rule_id: aws.elbv2.loadbalancer.listener_tls_min_1_2_configured
  for_each:
    discovery: aws.elbv2.loadbalancers
    as: loadbalancer
    item: loadbalancer
  conditions:
    var: loadbalancer.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for elbv2 loadbalancer:\n\n1. Ensure loadbalancer is deployed in VPC\n2. Configure\
    \ security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n\
    3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'ELBV2 alb https redirect: Elbv2 Alb Https Redirect Configured'
  severity: medium
  rule_id: aws.elbv2.alb_https_redirect.elbv2_alb_https_redirect_configured
  for_each:
    discovery: aws.elbv2.alb_https_redirects
    as: alb_https_redirect
    item: alb_https_redirect
  conditions:
    var: alb_https_redirect.compliant
    op: equals
    value: true
  remediation: "Configure elbv2 alb_https_redirect for compliance:\n\nRequirement: Elbv2 Alb Https Redirect Configuration\n\
    \nDescription: Verifies security configuration for Application Load Balancer alb https redirect to ensure alignment with\
    \ AWS security best practices and compliance requirements. Proper configuration reduces security risks, maintains defense\
    \ in depth, and supports overall security posture.\n\nSteps:\n1. Open ELBV2 console\n2. Select the alb_https_redirect\n\
    3. Review security configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save\
    \ changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense\
    \ in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
