rule_id: aws.lambda.function.environment_variables_kms_encryption_enabled
service: lambda
resource: function
requirement: KMS Encryption
title: Environment variables are encrypted in serverless functions
scope: lambda.function.function
domain: serverless_and_faas_security
subcategory: credential_storage
rationale: Encrypting environment variables protects sensitive data.
severity: high
assertion_id: serverless_paas.secret_management.environment_variables_encrypted
compliance:
- cis_aws_aws_12.12_0081
description: Checks that AWS Lambda function uses AWS KMS customer managed keys for encryption, providing enhanced control
  over key rotation, access policies, and audit trails. KMS encryption enables granular access control and comprehensive CloudTrail
  logging of key usage.
references:
- https://docs.aws.amazon.com/lambda/latest/dg/security-dataprotection.html
- https://docs.aws.amazon.com/lambda/latest/dg/lambda-security.html
- https://docs.aws.amazon.com/securityhub/latest/userguide/lambda-controls.html
