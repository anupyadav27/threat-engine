rule_id: aws.cloudtrail.route_table_changes_metric_filter_alarm.route_table_changes_metric_filter_alarm_configured
service: cloudtrail
resource: route_table_changes_metric_filter_alarm
requirement: Route Table Changes Metric Filter Alarm Configuration
title: 'CLOUDTRAIL route table changes metric filter alarm: Route Table Changes Metric
  Filter Alarm Configured'
scope: cloudtrail.route_table_changes_metric_filter_alarm.configuration
domain: configuration_and_change_management
subcategory: configuration_baseline
rationale: Ensures cloudtrail route_table_changes_metric_filter_alarm has route table
  changes metric filter alarm configured properly configured for security compliance.
severity: medium
assertion_id: security.configuration.cloudtrail_route_table_changes_metric_filter_alarm_route_table_changes_metric_filter_alarm_configured
source: expert_generated
compliance:
- cis_aws_aws_4.13_0151
description: Verifies security configuration for AWS CloudTrail route table changes
  metric filter alarm to ensure alignment with AWS security best practices and compliance
  requirements. Proper configuration reduces security risks, maintains defense in
  depth, and supports overall security posture.
references:
- https://docs.aws.amazon.com/awscloudtrail/latest/userguide/best-practices-security.html
- https://docs.aws.amazon.com/securityhub/latest/userguide/cloudtrail-controls.html
- https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
remediation: "Enable logging for cloudtrail route_table_changes_metric_filter_alarm:\n\
  \n1. Open CLOUDTRAIL console\n2. Select the route_table_changes_metric_filter_alarm\n\
  3. Go to Logging/Monitoring settings\n4. Enable logging\n5. Configure log destination:\n\
  \   - CloudWatch Logs\n   - S3 bucket (for long-term retention)\n6. Set log level\
  \ (INFO, DEBUG, ERROR)\n7. Save changes\n\nAWS CLI:\naws cloudtrail update-route_table_changes_metric_filter_alarm-logging\
  \ --route_table_changes_metric_filter_alarm-id <id> --logging-enabled\n\nBest Practices:\n\
  • Enable all security-relevant log types\n• Send logs to centralized logging service\n\
  • Set appropriate retention periods\n• Configure log encryption\n• Set up log monitoring\
  \ and alerting"
