[
  {
    "rule_id": "aws.ssm.managed.ssm_compliant_patching_configured",
    "suggested_condition": {
      "var": "item.InstancesWithCriticalNonCompliantPatches",
      "op": "greater_than",
      "value": 0,
      "reasoning": "The field 'InstancesWithCriticalNonCompliantPatches' checks for the number of instances that have critical non-compliant patches. A value greater than 0 indicates non-compliance, which aligns with the security rule's focus on ensuring compliant patching configurations.",
      "confidence": 1.0
    },
    "fields_analyzed": 23,
    "total_fields": 399,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.patchbaseline.ssm_required_controls_present",
    "suggested_condition": {
      "var": "item.ApprovedPatchesComplianceLevel",
      "op": "equals",
      "value": "CRITICAL",
      "reasoning": "The ApprovedPatchesComplianceLevel field is relevant for ensuring that the SSM patch baseline has the required controls present. Checking if it equals 'CRITICAL' aligns with the security compliance requirements.",
      "confidence": 1.0
    },
    "fields_analyzed": 17,
    "total_fields": 399,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.patchbaseline.ssm_approval_rules_configured",
    "suggested_condition": {
      "var": "item.ApprovalRules",
      "op": "not_equals",
      "value": "null",
      "reasoning": "The ApprovalRules field is relevant for checking if SSM approval rules are configured. Using 'not_equals' with 'null' checks if there are any approval rules configured.",
      "confidence": 1.0
    },
    "fields_analyzed": 18,
    "total_fields": 399,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.patchbaseline.ssm_baseline_defined_for_os_families_configured",
    "suggested_condition": {
      "var": "item.BaselineId",
      "op": "not_equals",
      "value": "null",
      "reasoning": "The BaselineId field is relevant for checking if an SSM patch baseline is defined. Using 'not_equals' with 'null' checks if a baseline ID exists, which is essential for compliance.",
      "confidence": 1.0
    },
    "fields_analyzed": 23,
    "total_fields": 399,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.maintenance_window.ssm_window_configured",
    "suggested_condition": {
      "var": "item.WindowId",
      "op": "not_equals",
      "value": "null",
      "reasoning": "The WindowId field is relevant for checking if an SSM maintenance window is configured. Using 'not_equals' with 'null' ensures that a valid WindowId exists.",
      "confidence": 1.0
    },
    "fields_analyzed": 26,
    "total_fields": 399,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.patchgroup.ssm_approval_rules_configured",
    "suggested_condition": {
      "var": "item.ApprovalRules",
      "op": "not_equals",
      "value": "null",
      "reasoning": "The ApprovalRules field is relevant for checking if SSM approval rules are configured. Using 'not_equals' with 'null' checks if there are any approval rules set.",
      "confidence": 1.0
    },
    "fields_analyzed": 19,
    "total_fields": 399,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.restapi.public_access_restricted",
    "suggested_condition": {
      "var": "item.AccessType",
      "op": "not_equals",
      "value": "Public",
      "reasoning": "The AccessType field can be used to check if the SSM restapi is not publicly accessible by ensuring its value is not 'Public'.",
      "confidence": 1.0
    },
    "fields_analyzed": 16,
    "total_fields": 399,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.patchbaseline.ssm_exemptions_have_expiry_and_owner_configured",
    "suggested_condition": {
      "var": "item.Owner",
      "op": "not_equals",
      "value": "null",
      "reasoning": "The field 'Owner' is relevant for checking if an owner is configured for the SSM patch baseline. Using 'not_equals' with 'null' checks if there is an owner specified.",
      "confidence": 1.0
    },
    "fields_analyzed": 19,
    "total_fields": 399,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.maintenance_window.execution_roles_least_privilege",
    "suggested_condition": {
      "var": "item.WindowExecutionTaskInvocationIdentities",
      "op": "not_equals",
      "value": "null",
      "reasoning": "The field 'WindowExecutionTaskInvocationIdentities' can be used to check if there are any invocation identities associated with the maintenance window execution roles, ensuring that they are not left empty, which could indicate a lack of least privilege configuration.",
      "confidence": 0.8
    },
    "fields_analyzed": 43,
    "total_fields": 399,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.baseline.ssm_conformance_pack_deployed_configured",
    "suggested_condition": {
      "var": "item.BaselineId",
      "op": "not_equals",
      "value": "null",
      "reasoning": "Checking if the BaselineId is set, which is essential for verifying the deployment of the SSM conformance pack.",
      "confidence": 1.0
    },
    "fields_analyzed": 23,
    "total_fields": 399,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.automation.ssm_storage_encrypted_and_private",
    "suggested_condition": {
      "var": "item.AutomationExecutionMetadataList",
      "op": "equals",
      "value": "false",
      "reasoning": "The field 'AutomationExecutionMetadataList' can be used to check if the automation execution metadata is not present, which aligns with the requirement for SSM automation to be private.",
      "confidence": 0.8
    },
    "fields_analyzed": 27,
    "total_fields": 399,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.document.ssm_storage_encrypted_and_private",
    "suggested_condition": {
      "var": "item.Enabled",
      "op": "equals",
      "value": true,
      "reasoning": "The 'Enabled' field is appropriate to check if the SSM document's encryption is enabled, as it directly relates to the requirement for storage encryption.",
      "confidence": 1.0
    },
    "fields_analyzed": 24,
    "total_fields": 399,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.automation.remediation_roles_least_privilege",
    "suggested_condition": {
      "var": "item.AutomationType",
      "op": "not_equals",
      "value": "CrossAccount",
      "reasoning": "The AutomationType field is relevant for checking if the automation is not using CrossAccount, which aligns with the principle of least privilege by ensuring that only local automation is allowed.",
      "confidence": 1.0
    },
    "fields_analyzed": 25,
    "total_fields": 399,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.automation.ssm_artifacts_encrypted_and_private",
    "suggested_condition": {
      "var": "item.AutomationExecutionMetadataList",
      "op": "equals",
      "value": "true",
      "reasoning": "The field 'AutomationExecutionMetadataList' can be checked to ensure that the automation execution metadata includes the necessary encryption settings, which is relevant to the compliance rule.",
      "confidence": 0.8
    },
    "fields_analyzed": 27,
    "total_fields": 399,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.automation.change_audit_logging_enabled",
    "suggested_condition": {
      "var": "item.LoggingInfo",
      "op": "not_equals",
      "value": "null",
      "reasoning": "The LoggingInfo field can be used to check if logging is enabled for SSM automation. Using 'not_equals' with 'null' checks if logging information is present, indicating that logging is enabled.",
      "confidence": 1.0
    },
    "fields_analyzed": 42,
    "total_fields": 399,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.document.change_audit_logging_enabled",
    "suggested_condition": {
      "var": "item.LoggingInfo",
      "op": "not_equals",
      "value": "null",
      "reasoning": "The LoggingInfo field is relevant for checking if audit logging is enabled for the SSM document. Using 'not_equals' with 'null' checks if logging information is present, indicating that logging is enabled.",
      "confidence": 1.0
    },
    "fields_analyzed": 40,
    "total_fields": 399,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.patchbaseline.ssm_maintenance_windows_configured",
    "suggested_condition": {
      "var": "item.Enabled",
      "op": "equals",
      "value": true,
      "reasoning": "The 'Enabled' field is relevant for checking if the SSM patch baseline maintenance windows are configured properly, as it indicates whether the configuration is active.",
      "confidence": 1.0
    },
    "fields_analyzed": 17,
    "total_fields": 399,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.automation.execution_roles_least_privilege",
    "success": false,
    "error": "Connection error after 5 attempts: Connection error."
  },
  {
    "rule_id": "aws.ssm.document.rbac_least_privilege",
    "success": false,
    "error": "Connection error after 5 attempts: Connection error."
  },
  {
    "rule_id": "aws.ssm.automation.versioning_and_immutability_enabled",
    "suggested_condition": {
      "var": "item.Enabled",
      "op": "equals",
      "value": "true",
      "reasoning": "The field 'Enabled' is relevant for checking if versioning is enabled for SSM automation, which aligns with the security rule's requirement for versioning and immutability.",
      "confidence": 1.0
    },
    "fields_analyzed": 43,
    "total_fields": 399,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.automation.rbac_least_privilege",
    "success": false,
    "error": "Connection error after 5 attempts: Connection error."
  },
  {
    "rule_id": "aws.ssm.patchgroup.ssm_baseline_defined_for_os_families_configured",
    "suggested_condition": {
      "var": "item.BaselineId",
      "op": "exists",
      "value": null,
      "reasoning": "The BaselineId field is relevant for checking if a baseline is defined for the SSM patch group, ensuring compliance with security requirements.",
      "confidence": 1.0
    },
    "fields_analyzed": 24,
    "total_fields": 399,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.patchgroup.ssm_maintenance_windows_configured",
    "suggested_condition": {
      "var": "item.SyncCompliance",
      "op": "equals",
      "value": "AUTO",
      "reasoning": "The field SyncCompliance is relevant for ensuring that maintenance windows are configured correctly, as it indicates whether the compliance is automatically managed. The operator 'equals' is appropriate to check for the specific compliance state, and 'AUTO' is one of the possible values.",
      "confidence": 1.0
    },
    "fields_analyzed": 18,
    "total_fields": 399,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.baseline.ssm_parameters_configured",
    "suggested_condition": {
      "var": "item.Parameters",
      "op": "not_equals",
      "value": "null",
      "reasoning": "The field 'Parameters' is relevant for checking if SSM parameters are configured, and using 'not_equals' with 'null' checks for the existence of parameters.",
      "confidence": 1.0
    },
    "fields_analyzed": 28,
    "total_fields": 399,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.document.ssm_secrets_encrypted",
    "suggested_condition": {
      "var": "item.Document",
      "op": "not_equals",
      "value": "null",
      "reasoning": "The Document field is relevant for checking if the SSM document is configured properly, and we want to ensure it is not null to confirm its existence.",
      "confidence": 1.0
    },
    "fields_analyzed": 25,
    "total_fields": 399,
    "confidence": 0.7999999999999999,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.ssm.automation.execution_roles_least_privilege",
    "error": "Value '['Pending', 'InProgress', 'PendingApproval', 'Approved']' not in possible_values for enum field 'AutomationExecutionStatus'. Possible values: ['Pending', 'InProgress', 'Waiting', 'Success', 'TimedOut']...",
    "success": false
  },
  {
    "rule_id": "aws.ssm.document.rbac_least_privilege",
    "error": "Value '['Policy']' not in possible_values for enum field 'DocumentType'. Possible values: ['Command', 'Policy', 'Automation', 'Session', 'Package']...",
    "success": false
  },
  {
    "rule_id": "aws.ssm.automation.rbac_least_privilege",
    "error": "Value '['PendingApproval', 'Approved', 'Success', 'InProgress', 'Pending', 'TimedOut', 'Cancelling', 'Cancelled', 'Failed']' not in possible_values for enum field 'AutomationExecutionStatus'. Possible values: ['Pending', 'InProgress', 'Waiting', 'Success', 'TimedOut']...",
    "success": false
  }
]