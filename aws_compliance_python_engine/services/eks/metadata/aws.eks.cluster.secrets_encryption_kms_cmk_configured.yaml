rule_id: aws.eks.cluster.secrets_encryption_kms_cmk_configured
service: eks
resource: cluster
requirement: KMS Encryption
title: 'EKS cluster: Secrets Encryption Kms Cmk Configured'
scope: eks.cluster.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
rationale: Ensures eks cluster has secrets encryption kms cmk configured properly
  configured for security compliance.
severity: high
assertion_id: data_protection.encryption_rest.eks_cluster_secrets_encryption_kms_cmk_configured
source: expert_generated
description: Checks that Amazon EKS cluster uses AWS KMS customer managed keys for
  encryption, providing enhanced control over key rotation, access policies, and audit
  trails. KMS encryption enables granular access control and comprehensive CloudTrail
  logging of key usage.
references:
- https://docs.aws.amazon.com/eks/latest/userguide/enable-kms.html
- https://docs.aws.amazon.com/eks/latest/userguide/security.html
- https://docs.aws.amazon.com/securityhub/latest/userguide/eks-controls.html
remediation: "Enable encryption for eks cluster:\n\n1. Open EKS console\n2. Select\
  \ the cluster\n3. Navigate to Properties/Configuration > Encryption\n4. Enable encryption\n\
  5. Choose encryption key:\n   - AWS managed key (default)\n   - Customer managed\
  \ key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws eks modify-cluster\
  \ --cluster-id <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\
  • Use customer-managed KMS keys for sensitive data\n• Enable automatic key rotation\n\
  • Implement proper key access policies\n• Audit key usage regularly"
