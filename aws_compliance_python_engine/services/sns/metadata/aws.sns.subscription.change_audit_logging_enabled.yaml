rule_id: aws.sns.subscription.change_audit_logging_enabled
service: sns
resource: subscription
requirement: Change Logging
title: Security alerting and notification systems are configured
scope: sns.subscription.threat_detection
domain: threat_detection_and_incident_response
subcategory: alerting
rationale: Proper alerting ensures security teams are notified of incidents in real-time.
severity: high
assertion_id: incident_response.notification.alerting_configured
description: Checks that Amazon SNS subscription has comprehensive audit logging enabled
  to capture API calls, configuration changes, and administrative actions. Logging
  is essential for security monitoring, incident investigation, compliance auditing,
  and establishing accountability through non-repudiation.
references:
- https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
remediation: "Enable logging for sns subscription:\n\n1. Open SNS console\n2. Select\
  \ the subscription\n3. Go to Logging/Monitoring settings\n4. Enable logging\n5.\
  \ Configure log destination:\n   - CloudWatch Logs\n   - S3 bucket (for long-term\
  \ retention)\n6. Set log level (INFO, DEBUG, ERROR)\n7. Save changes\n\nAWS CLI:\n\
  aws sns update-subscription-logging --subscription-id <id> --logging-enabled\n\n\
  Best Practices:\n• Enable all security-relevant log types\n• Send logs to centralized\
  \ logging service\n• Set appropriate retention periods\n• Configure log encryption\n\
  • Set up log monitoring and alerting"
