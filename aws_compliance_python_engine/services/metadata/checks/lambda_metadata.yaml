# LAMBDA Service - Check Metadata
# This file contains titles, descriptions, and severity for all checks
# The main YAML file only contains the logic

version: '1.0'
service: lambda
checks:
  aws.lambda.function.execution_role_existence_configured:
    title: 'LAMBDA function: Execution Role Existence Configured'
    severity: high
  aws.lambda.function.runtime_support_configured:
    title: 'LAMBDA function: Runtime Support Configured'
    severity: medium
  aws.lambda.function.vpc_private_networking_enabled:
    title: 'LAMBDA function: Vpc Private Networking Enabled'
    severity: high
  aws.lambda.function.env_no_plaintext_secrets_configured:
    title: 'LAMBDA function: Env No Plaintext Secrets Configured'
    severity: medium
  aws.lambda.function.restrict_public_access_configured:
    title: 'LAMBDA function: Restrict Public Access Configured'
    severity: high
  aws.lambda.function.execution_roles_least_privilege:
    title: 'LAMBDA function: Execution Roles Least Privilege'
    severity: high
  aws.lambda.version.published_and_immutable_configured:
    title: 'LAMBDA version: Published And Immutable Configured'
    severity: medium
  aws.lambda.function.environment_variables_kms_encryption_enabled:
    title: Environment variables are encrypted in serverless functions
    severity: high
  aws.lambda.function.logging_and_tracing_enabled:
    title: 'LAMBDA function: Logging And Tracing Enabled'
    severity: medium
  aws.lambda.function.url_cors_policy_configured:
    title: 'LAMBDA function: Url Cors Policy Configured'
    severity: high
  aws.lambda.function.dead_letter_queue_configured:
    title: 'LAMBDA function: Dead Letter Queue Configured'
    severity: medium
  aws.lambda.function.outputs_encrypted:
    title: 'LAMBDA function: Outputs Encrypted'
    severity: high
  aws.lambda.function.vpc_multi_az_configured:
    title: 'LAMBDA function: Vpc Multi Az Configured'
    severity: high
  aws.lambda.function.unique_iam_role_configured:
    title: 'LAMBDA function: Unique Iam Role Configured'
    severity: high
  aws.lambda.function.execution_role_no_admin_privileges_configured:
    title: 'LAMBDA function: Execution Role No Admin Privileges Configured'
    severity: high
  aws.lambda.function.reserved_concurrency_configured:
    title: 'LAMBDA function: Reserved Concurrency Configured'
    severity: medium
  aws.lambda.function.cloudwatch_lambda_insights_enabled:
    title: 'LAMBDA function: Cloudwatch Lambda Insights Enabled'
    severity: medium
  aws.lambda.function.not_publicly_accessible_configured:
    title: 'LAMBDA function: Not Publicly Accessible Configured'
    severity: high
  aws.lambda.function.inside_vpc_configured:
    title: 'LAMBDA function: Inside Vpc Configured'
    severity: high
  aws.lambda.function.code_signing_config_present:
    title: 'LAMBDA function: Code Signing Config Present'
    severity: medium
  aws.lambda.provisioned_concurrency.execution_role_least_privilege:
    title: 'LAMBDA provisioned concurrency: Execution Role Least Privilege'
    severity: high
  aws.lambda.layer.version_immutable_configured:
    title: 'LAMBDA layer: Version Immutable Configured'
    severity: low
  aws.lambda.function.invoke_api_operations_cloudtrail_logging_enabled:
    title: 'LAMBDA function: Invoke Api Operations Cloudtrail Logging Enabled'
    severity: medium
  aws.lambda.function.change_audit_logging_enabled:
    title: Audit secret access by functions
    severity: medium
  aws.lambda.function.url_authentication_configured:
    title: 'LAMBDA function: Url Authentication Configured'
    severity: critical
  aws.lambda.version.rollforward_rollback_controls_present:
    title: 'LAMBDA version: Rollforward Rollback Controls Present'
    severity: medium
  aws.lambda.function.remediation_roles_least_privilege:
    title: 'LAMBDA function: Remediation Roles Least Privilege'
    severity: high
  aws.lambda.layer.source_trusted_configured:
    title: 'LAMBDA layer: Source Trusted Configured'
    severity: medium
  aws.lambda.function.url_public_configured:
    title: 'LAMBDA function: Url Public Configured'
    severity: high
  aws.lambda.event_source_mapping.permissions_least_privilege:
    title: 'LAMBDA event source mapping: Permissions Least Privilege'
    severity: high
  aws.lambda.function.artifacts_encrypted_and_private:
    title: 'LAMBDA function: Artifacts Encrypted And Private'
    severity: high
  aws.lambda.function.role_least_privilege:
    title: 'LAMBDA function: Role Least Privilege'
    severity: high
  aws.lambda.function.policies_present_for_sensitive_fields_configured:
    title: 'LAMBDA function: Policies Present For Sensitive Fields Configured'
    severity: medium
  aws.lambda.function.jobs_private_networking_configured:
    title: 'LAMBDA function: Jobs Private Networking Configured'
    severity: high
  aws.lambda.event_source_mapping.source_authenticated_configured:
    title: 'LAMBDA event source mapping: Source Authenticated Configured'
    severity: medium
  aws.lambda.function.resource_policy_cross_account_access_configured:
    title: 'LAMBDA function: Resource Policy Cross Account Access Configured'
    severity: high
