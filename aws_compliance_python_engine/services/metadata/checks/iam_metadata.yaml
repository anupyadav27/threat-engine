# IAM Service - Check Metadata
# This file contains titles, descriptions, and severity for all checks
# The main YAML file only contains the logic

version: '1.0'
service: iam
checks:
  aws.iam.password.policy_lowercase_configured:
    title: 'IAM password: Policy Lowercase Configured'
    severity: high
  aws.iam.instanceprofile.no_instance_profile_with_admin_star_configured:
    title: 'IAM instanceprofile: No Instance Profile With Admin Star Configured'
    severity: medium
  aws.iam.policy.security_check_full_admin_privileges_configured:
    title: 'IAM policy: Security Check Full Admin Privileges Configured'
    severity: high
  aws.iam.password.policy_minimum_length_14_configured:
    title: 'IAM password: Policy Minimum Length 14 Configured'
    severity: high
  aws.iam.role.session_duration_reasonable_if_applicable_configured:
    title: 'IAM role: Session Duration Reasonable If Applicable Configured'
    severity: medium
  aws.iam.user.inactive_90_days_disabled:
    title: 'IAM user: Inactive 90 Days Disabled'
    severity: medium
  aws.iam.policy.conditions_used_if_applicable_configured:
    title: 'IAM policy: Conditions Used If Applicable Configured'
    severity: medium
  aws.iam.instanceprofile.role_policies_least_privilege:
    title: 'IAM instanceprofile: Role Policies Least Privilege'
    severity: high
  aws.iam.user.no_inline_policies_enabled:
    title: 'IAM user: No Inline Policies Enabled'
    severity: medium
  aws.iam.role.scopes_or_s_least_privilege:
    title: 'IAM role: Scopes Or S Least Privilege'
    severity: high
  aws.iam.policy.no_full_access_to_cloudtrail_configured:
    title: 'IAM policy: No Full Access To Cloudtrail Configured'
    severity: medium
  aws.iam.policy.versioning_and_change_audit_enabled:
    title: 'IAM policy: Versioning And Change Audit Enabled'
    severity: medium
  aws.iam.policy.reuse_24_configured:
    title: 'IAM policy: Reuse 24 Configured'
    severity: medium
  aws.iam.user.console_access_unused_configured:
    title: 'IAM user: Console Access Unused Configured'
    severity: medium
  aws.iam.role.attached_policies_not_admin_star_configured:
    title: 'IAM role: Attached Policies Not Admin Star Configured'
    severity: medium
  aws.iam.samlprovider.idp_metadata_signed_configured:
    title: 'IAM samlprovider: Idp Metadata Signed Configured'
    severity: medium
  aws.iam.policy.no_wildcard_admin_actions_configured:
    title: 'IAM policy: No Wildcard Admin Actions Configured'
    severity: medium
  aws.iam.resource.access_analyzer_external_all_regions_configured:
    title: 'IAM resource: Access Analyzer External All Regions Configured'
    severity: medium
  aws.iam.policy.least_privilege_audit_configured:
    title: 'IAM policy: Least Privilege Audit Configured'
    severity: medium
  aws.iam.certificate.expired_removal_monitored:
    title: 'IAM certificate: Expired Removal Monitored'
    severity: medium
  aws.iam.role.keys_not_used_or_rotated_90_days_or_less_configured:
    title: 'IAM role: Keys Not Used Or Rotated 90 Days Or Less Configured'
    severity: medium
  aws.iam.customer.attached_policy_no_administrative_privileges_configured:
    title: 'IAM customer: Attached Policy No Administrative Privileges Configured'
    severity: high
  aws.iam.password.policy_reuse_24_configured:
    title: 'IAM password: Policy Reuse 24 Configured'
    severity: high
  aws.iam.policy.no_action_star_on_resource_star_configured:
    title: 'IAM policy: No Action Star On Resource Star Configured'
    severity: medium
  aws.iam.policy.attached_only_to_group_or_roles_configured:
    title: 'IAM policy: Attached Only To Group Or Roles Configured'
    severity: high
  aws.iam.certificate.expiration_removal_monitored:
    title: 'IAM certificate: Expiration Removal Monitored'
    severity: medium
  aws.iam.managedpolicy.editors_rbac_least_privilege:
    title: 'IAM managedpolicy: Editors Rbac Least Privilege'
    severity: high
  aws.iam.user.access_keys_rotated_90_days_or_less_when_present:
    title: Legacy authentication protocols are disabled
    severity: medium
  aws.iam.support.role_created_configured:
    title: 'IAM support: Role Created Configured'
    severity: high
  aws.iam.user.single_active_access_key_audit_configured:
    title: 'IAM user: Single Active Access Key Audit Configured'
    severity: medium
  aws.iam.policy.allows_privilege_escalation_configured:
    title: 'IAM policy: Allows Privilege Escalation Configured'
    severity: high
  aws.iam.resource.root_mfa_enabled:
    title: 'IAM resource: Root Mfa Enabled'
    severity: critical
  aws.iam.no.root_access_key_configured:
    title: 'IAM no: Root Access Key Configured'
    severity: medium
  aws.iam.user.policy_elastic_disaster_recovery_configured:
    title: 'IAM user: Policy Elastic Disaster Recovery Configured'
    severity: high
  aws.iam.rotate.access_key_90_days_configured:
    title: 'IAM rotate: Access Key 90 Days Configured'
    severity: medium
  aws.iam.policy.no_full_admin_privileges_enabled:
    title: 'IAM policy: No Full Admin Privileges Enabled'
    severity: high
  aws.iam.policy.no_administrative_privileges_configured:
    title: 'IAM policy: No Administrative Privileges Configured'
    severity: high
  aws.iam.group.has_users_configured:
    title: 'IAM group: Has Users Configured'
    severity: medium
  aws.iam.policy.minimum_length_14_configured:
    title: 'IAM policy: Minimum Length 14 Configured'
    severity: medium
  aws.iam.password.policy_uppercase_configured:
    title: 'IAM password: Policy Uppercase Configured'
    severity: high
  aws.iam.user.centralization_monitored:
    title: 'IAM user: Centralization Monitored'
    severity: medium
  aws.iam.user.accesskey_unused_configured:
    title: 'IAM user: Accesskey Unused Configured'
    severity: medium
  aws.iam.instanceprofile.role_enabled:
    title: 'IAM instanceprofile: Role Enabled'
    severity: high
  aws.iam.user.password_policy_complex_configured:
    title: 'IAM user: Password Policy Complex Configured'
    severity: high
  aws.iam.role.no_user_managed_long_lived_keys_configured:
    title: 'IAM role: No User Managed Long Lived Keys Configured'
    severity: medium
  aws.iam.policy.execution_roles_least_privilege:
    title: 'IAM policy: Execution Roles Least Privilege'
    severity: high
  aws.iam.samlprovider.assertion_lifetime_configured:
    title: 'IAM samlprovider: Assertion Lifetime Configured'
    severity: medium
  aws.iam.policy.monitored:
    title: 'IAM policy: Monitored'
    severity: medium
  aws.iam.access_analyzer_active_status_all_regions.access_analyzer_active_status_all_regions_configured:
    title: 'IAM access analyzer active status all regions: Access Analyzer Active
      Status All Regions Configured'
    severity: medium
  aws.iam.managedpolicy.no_policy_allows_without_constraints_configured:
    title: 'IAM managedpolicy: No Policy Allows Without Constraints Configured'
    severity: high
  aws.iam.policy.awscloudshell_full_access_restriction_configured:
    title: 'IAM policy: Awscloudshell Full Access Restriction Configured'
    severity: medium
  aws.iam.user.single_active_access_key_configured:
    title: 'IAM user: Single Active Access Key Configured'
    severity: medium
  aws.iam.role.no_inline_policies_configured:
    title: 'IAM role: No Inline Policies Configured'
    severity: medium
  aws.iam.managedpolicy.versioning_and_change_audit_enabled:
    title: 'IAM managedpolicy: Versioning And Change Audit Enabled'
    severity: medium
  aws.iam.managedpolicy.policy_no_wildcard_admin_actions_configured:
    title: 'IAM managedpolicy: Policy No Wildcard Admin Actions Configured'
    severity: high
  aws.iam.oidcprovider.certificate_issuer_https_and_matches_discovery_verified:
    title: 'IAM oidcprovider: Certificate Issuer Https And Matches Discovery Verified'
    severity: medium
  aws.iam.user.mfa_enabled_console_access:
    title: Legacy authentication protocols are disabled
    severity: medium
  aws.iam.group.attached_policies_not_admin_star_configured:
    title: 'IAM group: Attached Policies Not Admin Star Configured'
    severity: medium
  aws.iam.key.rotation_90_days_configured:
    title: 'IAM key: Rotation 90 Days Configured'
    severity: medium
  aws.iam.root.hardware_mfa_enabled:
    title: 'IAM root: Hardware Mfa Enabled'
    severity: critical
  aws.iam.resource.root_hardware_mfa_enabled:
    title: 'IAM resource: Root Hardware Mfa Enabled'
    severity: critical
  aws.iam.resource.console_mfa_enabled:
    title: 'IAM resource: Console Mfa Enabled'
    severity: critical
  aws.iam.managedpolicy.policy_no_action_star_on_resource_star_configured:
    title: 'IAM managedpolicy: Policy No Action Star On Resource Star Configured'
    severity: high
  aws.iam.aws.attached_policy_no_administrative_privileges_configured:
    title: 'IAM aws: Attached Policy No Administrative Privileges Configured'
    severity: high
  aws.iam.group.external_sharing_restricted_if_supported:
    title: 'IAM group: External Sharing Restricted If Supported'
    severity: medium
  aws.iam.oidcprovider.token_lifetime_configured:
    title: 'IAM oidcprovider: Token Lifetime Configured'
    severity: medium
  aws.iam.timestream_access_control_and_mfa_enforcement.timestream_access_control_mfa_enforcement_configured:
    title: 'IAM timestream access control and mfa enforcement: Timestream Access Control
      Mfa Enforcement Configured'
    severity: critical
  aws.iam.samlprovider.certificates_certificate_valid:
    title: 'IAM samlprovider: Certificates Certificate Valid'
    severity: medium
  aws.iam.managedpolicy.policy_conditions_used_if_applicable_configured:
    title: 'IAM managedpolicy: Policy Conditions Used If Applicable Configured'
    severity: high
  aws.iam.role.awssupport_access_policy_attachment_configured:
    title: 'IAM role: Awssupport Access Policy Attachment Configured'
    severity: high
  aws.iam.password.policy_number_configured:
    title: 'IAM password: Policy Number Configured'
    severity: high
  aws.iam.oidcprovider.thumbprints_or_jwks_pinning_configured:
    title: 'IAM oidcprovider: Thumbprints Or Jwks Pinning Configured'
    severity: medium
  aws.iam.role.least_privilege:
    title: Permission boundaries are enforced for privileged roles
    severity: high
  aws.iam.policy.workflow_storage_encrypted:
    title: 'IAM policy: Workflow Storage Encrypted'
    severity: high
  aws.iam.no_guest_accounts_with_permissions.no_guest_accounts_with_permissions_configured:
    title: 'IAM no guest accounts with permissions: No Guest Accounts With Permissions
      Configured'
    severity: high
  aws.iam.key.monitored:
    title: 'IAM key: Monitored'
    severity: medium
  aws.iam.policy.policy_enabled:
    title: 'IAM policy: Policy Enabled'
    severity: high
  aws.iam.user.console_password_present_only_if_required:
    title: 'IAM user: Console Password Present Only If Required'
    severity: critical
  aws.iam.managedpolicy.policy_resource_constraints_present:
    title: 'IAM managedpolicy: Policy Resource Constraints Present'
    severity: high
  aws.iam.user.mfa_required:
    title: 'IAM user: Mfa Required'
    severity: critical
  aws.iam.avoidrootusage.avoid_root_usage_configured:
    title: 'IAM avoidrootusage: Avoid Root Usage Configured'
    severity: medium
  aws.iam.group.membership_review_enabled_if_supported:
    title: 'IAM group: Membership Review Enabled If Supported'
    severity: medium
  aws.iam.root.mfa_enabled:
    title: 'IAM root: Mfa Enabled'
    severity: critical
  aws.iam.policy.resource_constraints_present:
    title: 'IAM policy: Resource Constraints Present'
    severity: medium
  aws.iam.password.policy_symbol_configured:
    title: 'IAM password: Policy Symbol Configured'
    severity: high
  aws.iam.role.workload_identity_federation_used_if_supported:
    title: 'IAM role: Workload Identity Federation Used If Supported'
    severity: medium
  aws.iam.samlprovider.audience_restriction_configured:
    title: 'IAM samlprovider: Audience Restriction Configured'
    severity: medium
  aws.iam.inline.policy_no_administrative_privileges_configured:
    title: 'IAM inline: Policy No Administrative Privileges Configured'
    severity: high
  aws.iam.role.trust_external_id_or_audience_required:
    title: 'IAM role: Trust External Id Or Audience Required'
    severity: medium
  aws.iam.group.no_inline_policies_configured:
    title: 'IAM group: No Inline Policies Configured'
    severity: medium
  aws.iam.policy.expires_passwords_within_90_days_or_less_configured:
    title: 'IAM policy: Expires Passwords Within 90 Days Or Less Configured'
    severity: critical
  aws.iam.role.max_session_duration_configured:
    title: 'IAM role: Max Session Duration Configured'
    severity: medium
  aws.iam.policy.overly_permissive_configured:
    title: 'IAM policy: Overly Permissive Configured'
    severity: medium
  aws.iam.user.hardware_mfa_enabled:
    title: Legacy authentication protocols are disabled
    severity: medium
  aws.iam.policy.awscloudshellfullaccess_attachment_configured:
    title: 'IAM policy: Awscloudshellfullaccess Attachment Configured'
    severity: medium
  aws.iam.oidcprovider.allowed_client_ids_audiences_restricted:
    title: 'IAM oidcprovider: Allowed Client Ids Audiences Restricted'
    severity: medium
  aws.iam.policy.editors_rbac_least_privilege:
    title: 'IAM policy: Editors Rbac Least Privilege'
    severity: high
  aws.iam.user.credentials_unused_45_days_disabled:
    title: 'IAM user: Credentials Unused 45 Days Disabled'
    severity: medium
  aws.iam.user.management_centralization_configured:
    title: 'IAM user: Management Centralization Configured'
    severity: medium
  aws.iam.user.no_inline_policies_configured:
    title: 'IAM user: No Inline Policies Configured'
    severity: medium
  aws.iam.user.in_group_configured:
    title: 'IAM user: In Group Configured'
    severity: medium
  aws.iam.role.trust_principals_allowlist_only_configured:
    title: 'IAM role: Trust Principals Allowlist Only Configured'
    severity: medium
  aws.iam.instanceprofile.no_admin_star_policies_configured:
    title: 'IAM instanceprofile: No Admin Star Policies Configured'
    severity: medium
  aws.iam.role.creation_monitored:
    title: 'IAM role: Creation Monitored'
    severity: medium
  aws.iam.policy.no_policies_without_constraints_configured:
    title: 'IAM policy: No Policies Without Constraints Configured'
    severity: medium
