# CLOUDWATCH Service - Check Metadata
# This file contains titles, descriptions, and severity for all checks
# The main YAML file only contains the logic

version: '1.0'
service: cloudwatch
checks:
  aws.cloudwatch.log_metric_filter_sign_in_without_mfa.log_metric_filter_sign_in_without_mfa_configured:
    title: 'CLOUDWATCH log metric filter sign in without mfa: Log Metric Filter Sign
      In Without Mfa Configured'
    severity: medium
  aws.cloudwatch.group.cloudwatch_log_edr_log_delivery_configured:
    title: 'CLOUDWATCH group: Cloudwatch Log Edr Log Delivery Configured'
    severity: medium
  aws.cloudwatch.metricfilter.metric_log_console_root_login_detected_filter_present:
    title: 'CLOUDWATCH metricfilter: Metric Log Console Root Login Detected Filter
      Present'
    severity: medium
  aws.cloudwatch.log_metric_filter_unauthorized_api_calls.log_metric_filter_unauthorized_api_calls_configured:
    title: 'CLOUDWATCH log metric filter unauthorized api calls: Log Metric Filter
      Unauthorized Api Calls Configured'
    severity: medium
  aws.cloudwatch.log_metric_filter_alarm_configured.log_metric_log_metric_filter_alarm_configured:
    title: 'CLOUDWATCH log metric filter alarm configured: Log Metric Log Metric Filter
      Alarm Configured'
    severity: medium
  aws.cloudwatch.log.metric_filter_for_s3_bucket_policy_changes_configured:
    title: 'CLOUDWATCH log: Metric Filter For S3 Bucket Policy Changes Configured'
    severity: high
  aws.cloudwatch.bucket.policy_changes_configured:
    title: 'CLOUDWATCH bucket: Policy Changes Configured'
    severity: high
  aws.cloudwatch.log.metric_alarm_kms_cmk_deletion_configured:
    title: 'CLOUDWATCH log: Metric Alarm Kms Cmk Deletion Configured'
    severity: high
  aws.cloudwatch.group.kms_encryption_enabled:
    title: 'CLOUDWATCH group: Kms Encryption Enabled'
    severity: high
  aws.cloudwatch.alarmconfigured.alarm_cloudwatch_alarm_configured:
    title: 'CLOUDWATCH alarmconfigured: Alarm Cloudwatch Alarm Configured'
    severity: medium
  aws.cloudwatch.metric.query_access_logging_enabled:
    title: API logging and monitoring are enabled
    severity: high
  ? aws.cloudwatch.log_metric_filter_aws_organizations_changes.log_metric_log_metric_filter_aws_organizations_changes_configured
  : title: 'CLOUDWATCH log metric filter aws organizations changes: Log Metric Log
      Metric Filter Aws Organizations Changes Configured'
    severity: medium
  aws.cloudwatch.alarm.cloudwatch_alarm_critical_s_enabled:
    title: 'CLOUDWATCH alarm: Cloudwatch Alarm Critical S Enabled'
    severity: medium
  aws.cloudwatch.metric.flow_logging_enabled:
    title: API logging and monitoring are enabled
    severity: high
  aws.cloudwatch.metric.api_logs_retention_days_minimum:
    title: 'CLOUDWATCH metric: Api Logs Retention Days Minimum'
    severity: medium
  aws.cloudwatch.alarm_cpu_utilization_configured.alarm_cloudwatch_alarm_cpu_utilization_configured:
    title: 'CLOUDWATCH alarm cpu utilization configured: Alarm Cloudwatch Alarm Cpu
      Utilization Configured'
    severity: medium
  aws.cloudwatch.metric.admin_activity_logging_enabled:
    title: API logging and monitoring are enabled
    severity: high
  aws.cloudwatch.anomalydetector.alerts_configured:
    title: 'CLOUDWATCH anomalydetector: Alerts Configured'
    severity: medium
  aws.cloudwatch.dashboard.public_embeds_disabled:
    title: 'CLOUDWATCH dashboard: Public Embeds Disabled'
    severity: high
  aws.cloudwatch.insightsquery.rbac_least_privilege:
    title: 'CLOUDWATCH insightsquery: Rbac Least Privilege'
    severity: high
  aws.cloudwatch.resource.log_cloudwatch_log_analysis_enabled:
    title: 'CLOUDWATCH resource: Log Cloudwatch Log Analysis Enabled'
    severity: medium
  aws.cloudwatch.log.metric_log_metric_filter_root_usage_configured:
    title: 'CLOUDWATCH log: Metric Log Metric Filter Root Usage Configured'
    severity: medium
  aws.cloudwatch.destination.endpoint_private_networking_configured:
    title: 'CLOUDWATCH destination: Endpoint Private Networking Configured'
    severity: high
  aws.cloudwatch.loggroup.rbac_least_privilege:
    title: 'CLOUDWATCH loggroup: Rbac Least Privilege'
    severity: high
  aws.cloudwatch.loggroup.log_destination_least_privilege:
    title: 'CLOUDWATCH loggroup: Log Destination Least Privilege'
    severity: medium
  aws.cloudwatch.metric.alerts_for_anomalies_configured:
    title: 'CLOUDWATCH metric: Alerts For Anomalies Configured'
    severity: medium
  aws.cloudwatch.group.cloudwatch_configuration_changes_monitored:
    title: 'CLOUDWATCH group: Cloudwatch Configuration Changes Monitored'
    severity: medium
  aws.cloudwatch.alarm.cloudwatch_alarm_actions_configured:
    title: Alerting rules are properly configured
    severity: low
  aws.cloudwatch.loggroup.log_destination_encrypted:
    title: 'CLOUDWATCH loggroup: Log Destination Encrypted'
    severity: high
  aws.cloudwatch.metricfilter.network_acl_or_sg_change_detected_filter_present:
    title: 'CLOUDWATCH metricfilter: Network Acl Or Sg Change Detected Filter Present'
    severity: high
  aws.cloudwatch.log.metric_filter_security_group_changes_configured:
    title: 'CLOUDWATCH log: Metric Filter Security Group Changes Configured'
    severity: high
  aws.cloudwatch.changes.to_vpcs_alarm_configured:
    title: 'CLOUDWATCH changes: To Vpcs Alarm Configured'
    severity: high
  aws.cloudwatch.insightsquery.cloudwatch_storage_encrypted:
    title: 'CLOUDWATCH insightsquery: Cloudwatch Storage Encrypted'
    severity: high
  aws.cloudwatch.logstream.encryption_at_rest_enabled:
    title: 'CLOUDWATCH logstream: Encryption At Rest Enabled'
    severity: high
  aws.cloudwatch.logstream.log_cross_account_destinations_restricted:
    title: 'CLOUDWATCH logstream: Log Cross Account Destinations Restricted'
    severity: medium
  aws.cloudwatch.group.not_publicly_accessible_configured:
    title: 'CLOUDWATCH group: Not Publicly Accessible Configured'
    severity: high
  aws.cloudwatch.metric.api_access_logging_enabled:
    title: API logging and monitoring are enabled
    severity: high
  aws.cloudwatch.alarm.destinations_authenticated_configured:
    title: 'CLOUDWATCH alarm: Destinations Authenticated Configured'
    severity: medium
  aws.cloudwatch.log.metric_filter_policy_changes_configured:
    title: 'CLOUDWATCH log: Metric Filter Policy Changes Configured'
    severity: high
  aws.cloudwatch.changes.to_network_route_tables_alarm_configured:
    title: 'CLOUDWATCH changes: To Network Route Tables Alarm Configured'
    severity: high
  aws.cloudwatch.destination.tls_min_1_2_enforced:
    title: 'CLOUDWATCH destination: Tls Min 1 2 Enforced'
    severity: high
  aws.cloudwatch.changes.to_network_gateways_alarm_configured:
    title: 'CLOUDWATCH changes: To Network Gateways Alarm Configured'
    severity: high
  aws.cloudwatch.dashboard.cloudwatch_sso_required:
    title: 'CLOUDWATCH dashboard: Cloudwatch Sso Required'
    severity: medium
  aws.cloudwatch.resource.metric_alarm_metric_alarm_cloudtrail_configuration_changes_configured:
    title: 'CLOUDWATCH resource: Metric Alarm Metric Alarm Cloudtrail Configuration
      Changes Configured'
    severity: medium
  aws.cloudwatch.logstream.log_destination_least_privilege:
    title: 'CLOUDWATCH logstream: Log Destination Least Privilege'
    severity: medium
  aws.cloudwatch.alarm.alerts_for_replication_lag_configured:
    title: 'CLOUDWATCH alarm: Alerts For Replication Lag Configured'
    severity: medium
  aws.cloudwatch.loggroup.log_cross_account_destinations_restricted:
    title: 'CLOUDWATCH loggroup: Log Cross Account Destinations Restricted'
    severity: medium
  aws.cloudwatch.log.metric_filter_sign_in_without_mfa_configured:
    title: 'CLOUDWATCH log: Metric Filter Sign In Without Mfa Configured'
    severity: critical
  aws.cloudwatch.network.cloudwatch_alarm_acls_alarm_configured:
    title: 'CLOUDWATCH network: Cloudwatch Alarm Acls Alarm Configured'
    severity: medium
  aws.cloudwatch.log.metric_filter_unauthorized_api_calls_configured:
    title: 'CLOUDWATCH log: Metric Filter Unauthorized Api Calls Configured'
    severity: medium
  aws.cloudwatch.loggroup.retention_days_minimum:
    title: 'CLOUDWATCH loggroup: Retention Days Minimum'
    severity: low
  aws.cloudwatch.logstream.ingestion_auth_required:
    title: 'CLOUDWATCH logstream: Ingestion Auth Required'
    severity: medium
  aws.cloudwatch.network.gateways_alarm_configured:
    title: 'CLOUDWATCH network: Gateways Alarm Configured'
    severity: medium
  aws.cloudwatch.logstream.log_destination_encrypted:
    title: 'CLOUDWATCH logstream: Log Destination Encrypted'
    severity: high
  aws.cloudwatch.metricfilter.iam_policy_change_detected_filter_present:
    title: 'CLOUDWATCH metricfilter: Iam Policy Change Detected Filter Present'
    severity: high
  aws.cloudwatch.metricfilter.kms_key_deletion_disable_detected_filter_present:
    title: 'CLOUDWATCH metricfilter: Kms Key Deletion Disable Detected Filter Present'
    severity: high
  aws.cloudwatch.resource.metric_alarm_metric_alarm_aws_config_configuration_changes_configured:
    title: 'CLOUDWATCH resource: Metric Alarm Metric Alarm Aws Config Configuration
      Changes Configured'
    severity: medium
  aws.cloudwatch.loggroup.log_immutability_or_object_lock_if_supported:
    title: 'CLOUDWATCH loggroup: Log Immutability Or Object Lock If Supported'
    severity: medium
  aws.cloudwatch.metric.api_access_log_fields_identity_configured:
    title: 'CLOUDWATCH metric: Api Access Log Fields Identity Configured'
    severity: medium
  aws.cloudwatch.alarm.alerts_for_rpo_rto_breach_configured:
    title: 'CLOUDWATCH alarm: Alerts For Rpo Rto Breach Configured'
    severity: medium
  aws.cloudwatch.dashboard.cloudwatch_sharing_restricted_to_org_configured:
    title: 'CLOUDWATCH dashboard: Cloudwatch Sharing Restricted To Org Configured'
    severity: medium
  aws.cloudwatch.alarm.alerts_for_backup_failures_configured:
    title: 'CLOUDWATCH alarm: Alerts For Backup Failures Configured'
    severity: medium
  aws.cloudwatch.destination.iam_policy_least_privilege:
    title: 'CLOUDWATCH destination: Iam Policy Least Privilege'
    severity: high
  aws.cloudwatch.network.route_tables_alarm_configured:
    title: 'CLOUDWATCH network: Route Tables Alarm Configured'
    severity: medium
  aws.cloudwatch.log.group_kms_encryption_enabled:
    title: 'CLOUDWATCH log: Group Kms Encryption Enabled'
    severity: high
  aws.cloudwatch.loggroup.encryption_at_rest_cmek_configured:
    title: 'CLOUDWATCH loggroup: Encryption At Rest Cmek Configured'
    severity: high
  aws.cloudwatch.alarm_memory_utilization_configured.alarm_cloudwatch_alarm_memory_utilization_configured:
    title: 'CLOUDWATCH alarm memory utilization configured: Alarm Cloudwatch Alarm
      Memory Utilization Configured'
    severity: medium
  aws.cloudwatch.log_metric_filter_root_usage.log_metric_log_metric_filter_root_usage_configured:
    title: 'CLOUDWATCH log metric filter root usage: Log Metric Log Metric Filter
      Root Usage Configured'
    severity: medium
  aws.cloudwatch.alarm.alert_destinations_configured:
    title: 'CLOUDWATCH alarm: Alert Destinations Configured'
    severity: medium
  aws.cloudwatch.anomalydetector.cloudwatch_training_data_sources_approved_configured:
    title: 'CLOUDWATCH anomalydetector: Cloudwatch Training Data Sources Approved
      Configured'
    severity: medium
  aws.cloudwatch.metric.api_execution_logging_level_minimum_error_configured:
    title: 'CLOUDWATCH metric: Api Execution Logging Level Minimum Error Configured'
    severity: medium
  aws.cloudwatch.metric.logs_retention_days_minimum:
    title: 'CLOUDWATCH metric: Logs Retention Days Minimum'
    severity: medium
  aws.cloudwatch.log.metric_log_metric_alarm_cloudtrail_configuration_changes_configured:
    title: 'CLOUDWATCH log: Metric Log Metric Alarm Cloudtrail Configuration Changes
      Configured'
    severity: medium
  aws.cloudwatch.log.metric_log_metric_alarm_aws_config_configuration_changes_configured:
    title: 'CLOUDWATCH log: Metric Log Metric Alarm Aws Config Configuration Changes
      Configured'
    severity: medium
  aws.cloudwatch.log_metric_filter_disable_or_scheduled_deletion_of_kms_cmk.metric_alarm_kms_cmk_deletion_configured:
    title: 'CLOUDWATCH log metric filter disable or scheduled deletion of kms cmk:
      Metric Alarm Kms Cmk Deletion Configured'
    severity: high
  aws.cloudwatch.anomalydetector.cloudwatch_detectors_enabled:
    title: 'CLOUDWATCH anomalydetector: Cloudwatch Detectors Enabled'
    severity: medium
  aws.cloudwatch.logstream.retention_days_minimum:
    title: 'CLOUDWATCH logstream: Retention Days Minimum'
    severity: low
  aws.cloudwatch.log.metric_filter_authentication_failures_configured:
    title: 'CLOUDWATCH log: Metric Filter Authentication Failures Configured'
    severity: critical
  aws.cloudwatch.log_metric_filter_authentication_failures.log_metric_filter_authentication_failures_configured:
    title: 'CLOUDWATCH log metric filter authentication failures: Log Metric Filter
      Authentication Failures Configured'
    severity: medium
  aws.cloudwatch.group.retention_policy_configured:
    title: 'CLOUDWATCH group: Retention Policy Configured'
    severity: high
  aws.cloudwatch.changes_to_vpcs_alarm_configured.changes_to_vpcs_alarm_configured_configured:
    title: 'CLOUDWATCH changes to vpcs alarm configured: Changes To Vpcs Alarm Configured
      Configured'
    severity: high
  aws.cloudwatch.log.group_retention_policy_specific_days_enabled:
    title: 'CLOUDWATCH log: Group Retention Policy Specific Days Enabled'
    severity: high
  aws.cloudwatch.metric.api_access_log_sink_configured:
    title: 'CLOUDWATCH metric: Api Access Log Sink Configured'
    severity: medium
  aws.cloudwatch.changes.to_network_acls_alarm_configured:
    title: 'CLOUDWATCH changes: To Network Acls Alarm Configured'
    severity: high
  aws.cloudwatch.policy.cloudwatch_configuration_changes_monitored:
    title: 'CLOUDWATCH policy: Cloudwatch Configuration Changes Monitored'
    severity: medium
  aws.cloudwatch.group.cloudwatch_log_no_secrets_in_logs_configured:
    title: 'CLOUDWATCH group: Cloudwatch Log No Secrets In Logs Configured'
    severity: medium
