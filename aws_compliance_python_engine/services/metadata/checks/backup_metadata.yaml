# BACKUP Service - Check Metadata
# This file contains titles, descriptions, and severity for all checks
# The main YAML file only contains the logic

version: '1.0'
service: backup
checks:
  aws.backup.reportplan.backup_plans_configured:
    title: 'BACKUP reportplan: Backup Plans Configured'
    severity: medium
  aws.backup.backupplan.failed_jobs_alerting_enabled:
    title: 'BACKUP backupplan: Failed Jobs Alerting Enabled'
    severity: medium
  aws.backup.restorejob.role_least_privilege:
    title: 'BACKUP restorejob: Role Least Privilege'
    severity: high
  aws.backup.resource.vault_encryption_enabled:
    title: 'BACKUP resource: Vault Encryption Enabled'
    severity: high
  aws.backup.restorejob.backup_logs_and_artifacts_encrypted:
    title: 'BACKUP restorejob: Backup Logs And Artifacts Encrypted'
    severity: high
  aws.backup.backupplan.lag_monitoring_alerts_enabled:
    title: 'BACKUP backupplan: Lag Monitoring Alerts Enabled'
    severity: medium
  aws.backup.backupplan.backup_keys_access_least_privilege:
    title: 'BACKUP backupplan: Backup Keys Access Least Privilege'
    severity: high
  aws.backup.backupplan.backup_cross_region_replication_encrypted:
    title: 'BACKUP backupplan: Backup Cross Region Replication Encrypted'
    severity: high
  aws.backup.recoverypoint.encryption_at_rest_cmek_if_supported:
    title: 'BACKUP recoverypoint: Encryption At Rest Cmek If Supported'
    severity: high
  aws.backup.backupvault.backup_vaults_exist_configured:
    title: 'BACKUP backupvault: Backup Vaults Exist Configured'
    severity: medium
  aws.backup.backupplan.backup_approvals_required_for_changes:
    title: 'BACKUP backupplan: Backup Approvals Required For Changes'
    severity: medium
  aws.backup.recoverypoint.backup_point_encrypted:
    title: 'BACKUP recoverypoint: Backup Point Encrypted'
    severity: high
  aws.backup.backupvault.backup_schedule_defined_min_frequency_configured:
    title: 'BACKUP backupvault: Backup Schedule Defined Min Frequency Configured'
    severity: medium
  aws.backup.restorejob.from_encrypted_backups_only:
    title: 'BACKUP restorejob: From Encrypted Backups Only'
    severity: high
  aws.backup.backupplan.backup_plan_configured:
    title: 'BACKUP backupplan: Backup Plan Configured'
    severity: medium
  aws.backup.backupvault.backup_vault_configured:
    title: 'BACKUP backupvault: Backup Vault Configured'
    severity: medium
  aws.backup.backupjob.alerts_for_backup_failures_configured:
    title: 'BACKUP backupjob: Alerts For Backup Failures Configured'
    severity: medium
  aws.backup.backupplan.backup_vault_rbac_least_privilege:
    title: 'BACKUP backupplan: Backup Vault Rbac Least Privilege'
    severity: high
  aws.backup.reportplan.backup_report_plan_configured:
    title: 'BACKUP reportplan: Backup Report Plan Configured'
    severity: medium
  aws.backup.backupplan.backup_retention_minimum_configured:
    title: 'BACKUP backupplan: Backup Retention Minimum Configured'
    severity: medium
  aws.backup.backupjob.alert_destinations_configured:
    title: 'BACKUP backupjob: Alert Destinations Configured'
    severity: medium
  aws.backup.backupvault.backup_immutable_or_worm_enabled_if_supported:
    title: 'BACKUP backupvault: Backup Immutable Or Worm Enabled If Supported'
    severity: medium
  aws.backup.backupjob.alerts_for_rpo_rto_breach_configured:
    title: 'BACKUP backupjob: Alerts For Rpo Rto Breach Configured'
    severity: medium
  aws.backup.backupvault.key_rotation_enabled:
    title: Create immutable backup copies
    severity: medium
  aws.backup.backupplan.change_audit_logging_enabled:
    title: RTO and RPO are defined and monitored
    severity: low
  aws.backup.backupplan.last_backup_recency_within_days:
    title: 'BACKUP backupplan: Last Backup Recency Within Days'
    severity: medium
  aws.backup.backupjob.logging_enabled:
    title: 'BACKUP backupjob: Logging Enabled'
    severity: medium
  aws.backup.backupvault.backup_destination_private_only_configured:
    title: 'BACKUP backupvault: Backup Destination Private Only Configured'
    severity: high
  aws.backup.backupjob.alerts_for_replication_lag_configured:
    title: 'BACKUP backupjob: Alerts For Replication Lag Configured'
    severity: medium
  aws.backup.backupjob.role_least_privilege:
    title: 'BACKUP backupjob: Role Least Privilege'
    severity: high
  aws.backup.recoverypoint.security_groups_restrictive_configured:
    title: 'BACKUP recoverypoint: Security Groups Restrictive Configured'
    severity: high
  aws.backup.backupplan.backup_ec2_resources_included_configured:
    title: 'BACKUP backupplan: Backup Ec2 Resources Included Configured'
    severity: medium
  aws.backup.resource.backup_replication_enabled:
    title: 'BACKUP resource: Backup Replication Enabled'
    severity: medium
  aws.backup.backupplan.no_public_access_to_backup_vault_configured:
    title: 'BACKUP backupplan: No Public Access To Backup Vault Configured'
    severity: high
  aws.backup.resource.backup_vaults_encrypted:
    title: 'BACKUP resource: Backup Vaults Encrypted'
    severity: high
  aws.backup.backupvault.backup_cross_region_replication_enabled:
    title: 'BACKUP backupvault: Backup Cross Region Replication Enabled'
    severity: medium
  aws.backup.backupplan.unprotected_assets_alerting_enabled:
    title: 'BACKUP backupplan: Unprotected Assets Alerting Enabled'
    severity: medium
  aws.backup.backupplan.backup_storage_encrypted_and_private:
    title: 'BACKUP backupplan: Backup Storage Encrypted And Private'
    severity: high
  aws.backup.backupplan.backup_admins_mfa_required:
    title: 'BACKUP backupplan: Backup Admins Mfa Required'
    severity: medium
  aws.backup.resource.backup_recovery_point_encrypted:
    title: 'BACKUP resource: Backup Recovery Point Encrypted'
    severity: high
  aws.backup.backupjob.alert_rules_for_job_failures_configured:
    title: 'BACKUP backupjob: Alert Rules For Job Failures Configured'
    severity: medium
  aws.backup.recoverypoint.private_network_only_configured:
    title: 'BACKUP recoverypoint: Private Network Only Configured'
    severity: high
  aws.backup.backupjob.alert_rules_for_sla_breach_configured:
    title: 'BACKUP backupjob: Alert Rules For Sla Breach Configured'
    severity: medium
  aws.backup.recoverypoint.backup_volumes_encrypted:
    title: 'BACKUP recoverypoint: Backup Volumes Encrypted'
    severity: high
  aws.backup.backupplan.policy_assignment_complete:
    title: 'BACKUP backupplan: Policy Assignment Complete'
    severity: high
  aws.backup.backupplan.retention_days_minimum:
    title: 'BACKUP backupplan: Retention Days Minimum'
    severity: low
  aws.backup.restorejob.cross_account_restore_blocked_by_policy_configured:
    title: 'BACKUP restorejob: Cross Account Restore Blocked By Policy Configured'
    severity: high
  aws.backup.backupvault.encryption_at_rest_enabled:
    title: Create immutable backup copies
    severity: medium
  aws.backup.backupvault.key_policy_least_privilege:
    title: 'BACKUP backupvault: Key Policy Least Privilege'
    severity: high
  aws.backup.recoverypoint.recovery_point_retention_configured:
    title: 'BACKUP recoverypoint: Recovery Point Retention Configured'
    severity: medium
  aws.backup.recoverypoint.backup_min_telemtry_required_no_pii:
    title: 'BACKUP recoverypoint: Backup Min Telemtry Required No Pii'
    severity: medium
  aws.backup.backupplan.backup_job_success_rate_minimum:
    title: 'BACKUP backupplan: Backup Job Success Rate Minimum'
    severity: medium
  aws.backup.resource.backup_enabled_for_ec2:
    title: 'BACKUP resource: Backup Enabled For Ec2'
    severity: medium
  aws.backup.backupplan.auth_roles_least_privilege:
    title: 'BACKUP backupplan: Auth Roles Least Privilege'
    severity: high
  aws.backup.backupjob.backup_metrics_export_enabled:
    title: 'BACKUP backupjob: Backup Metrics Export Enabled'
    severity: medium
  aws.backup.recoverypoint.agent_to_service_tls_required:
    title: 'BACKUP recoverypoint: Agent To Service Tls Required'
    severity: high
  aws.backup.resource.encryption_enabled:
    title: 'BACKUP resource: Encryption Enabled'
    severity: high
  aws.backup.backupvault.encryption_in_transit_tls_min_1_2_configured:
    title: 'BACKUP backupvault: Encryption In Transit Tls Min 1 2 Configured'
    severity: high
  aws.backup.backupplan.backup_plans_configured:
    title: 'BACKUP backupplan: Backup Plans Configured'
    severity: medium
  aws.backup.backupjob.execution_roles_least_privilege:
    title: 'BACKUP backupjob: Execution Roles Least Privilege'
    severity: high
  aws.backup.backupvault.backup_storage_immutability_enabled:
    title: 'BACKUP backupvault: Backup Storage Immutability Enabled'
    severity: medium
  aws.backup.backupvault.cmk_cmek_key_configured:
    title: 'BACKUP backupvault: Cmk Cmek Key Configured'
    severity: medium
  aws.backup.backupplan.backup_resource_discovery_synced_configured:
    title: 'BACKUP backupplan: Backup Resource Discovery Synced Configured'
    severity: medium
  aws.backup.backupjob.network_private_only_configured:
    title: 'BACKUP backupjob: Network Private Only Configured'
    severity: high
  aws.backup.backupjob.backup_results_storage_encrypted_and_private:
    title: 'BACKUP backupjob: Backup Results Storage Encrypted And Private'
    severity: high
  aws.backup.backupplan.encryption_in_transit_tls_required:
    title: 'BACKUP backupplan: Encryption In Transit Tls Required'
    severity: high
