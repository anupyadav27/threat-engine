# APIGATEWAY Service - Check Metadata
# This file contains titles, descriptions, and severity for all checks
# The main YAML file only contains the logic

version: '1.0'
service: apigateway
checks:
  aws.apigateway.usageplan.api_stage_rate_limit_configured:
    title: 'APIGATEWAY usageplan: Api Stage Rate Limit Configured'
    severity: medium
  aws.apigateway.resource.authorization_enabled:
    title: 'APIGATEWAY resource: Authorization Enabled'
    severity: medium
  aws.apigateway.apikey.key_rotation_policy_configured:
    title: 'APIGATEWAY apikey: Key Rotation Policy Configured'
    severity: high
  aws.apigateway.usageplan.api_quota_limit_configured:
    title: 'APIGATEWAY usageplan: Api Quota Limit Configured'
    severity: medium
  aws.apigateway.authorizer.cache_ttl_configured:
    title: 'APIGATEWAY authorizer: Cache Ttl Configured'
    severity: medium
  aws.apigateway.requestvalidator.api_required_security_headers_enforced:
    title: 'APIGATEWAY requestvalidator: Api Required Security Headers Enforced'
    severity: medium
  aws.apigateway.stage.logging_enabled:
    title: API logging and monitoring are enabled
    severity: high
  aws.apigateway.requestvalidator.api_content_type_whitelist_enforced:
    title: 'APIGATEWAY requestvalidator: Api Content Type Whitelist Enforced'
    severity: medium
  aws.apigateway.throttle.api_stage_overrides_bounded:
    title: 'APIGATEWAY throttle: Api Stage Overrides Bounded'
    severity: medium
  aws.apigateway.requestvalidator.api_request_schema_validation_enabled:
    title: API request validation is enabled
    severity: high
  aws.apigateway.restapi.waf_enabled:
    title: 'APIGATEWAY restapi: Waf Enabled'
    severity: medium
  aws.apigateway.resource.restapi_cache_encrypted:
    title: 'APIGATEWAY resource: Restapi Cache Encrypted'
    severity: high
  aws.apigateway.v2api.waf_enabled:
    title: 'APIGATEWAY v2api: Waf Enabled'
    severity: medium
  aws.apigateway.throttle.api_usage_plan_for_keys_required:
    title: 'APIGATEWAY throttle: Api Usage Plan For Keys Required'
    severity: medium
  aws.apigateway.v2api.authz_policies_enforced:
    title: 'APIGATEWAY v2api: Authz Policies Enforced'
    severity: medium
  aws.apigateway.authorizer.tls_min_1_2_enforced:
    title: 'APIGATEWAY authorizer: Tls Min 1 2 Enforced'
    severity: high
  aws.apigateway.stage.api_logs_retention_days_minimum:
    title: 'APIGATEWAY stage: Api Logs Retention Days Minimum'
    severity: medium
  aws.apigateway.stage.api_access_log_sink_configured:
    title: 'APIGATEWAY stage: Api Access Log Sink Configured'
    severity: medium
  aws.apigateway.resource.api_gateway_https_required:
    title: 'APIGATEWAY resource: Api Gateway Https Required'
    severity: medium
  aws.apigateway.usageplan.api_rate_limits_configured:
    title: 'APIGATEWAY usageplan: Api Rate Limits Configured'
    severity: medium
  aws.apigateway.usageplan.api_stage_throttle_overrides_bounded:
    title: 'APIGATEWAY usageplan: Api Stage Throttle Overrides Bounded'
    severity: medium
  aws.apigateway.apikey.scopes_least_privilege:
    title: 'APIGATEWAY apikey: Scopes Least Privilege'
    severity: high
  aws.apigateway.usageplan.api_stage_burst_limit_configured:
    title: API throttling and rate limiting are enabled
    severity: medium
  aws.apigateway.stage.api_access_log_fields_identity_configured:
    title: 'APIGATEWAY stage: Api Access Log Fields Identity Configured'
    severity: medium
  aws.apigateway.requestvalidator.api_parameters_validation_enabled:
    title: 'APIGATEWAY requestvalidator: Api Parameters Validation Enabled'
    severity: medium
  aws.apigateway.stage.throttling_enabled:
    title: 'APIGATEWAY stage: Throttling Enabled'
    severity: medium
  aws.apigateway.authorizer.api_token_audience_restricted:
    title: 'APIGATEWAY authorizer: Api Token Audience Restricted'
    severity: medium
  aws.apigateway.restapi.tracing_enabled:
    title: 'APIGATEWAY restapi: Tracing Enabled'
    severity: medium
  aws.apigateway.v2api.private_networking_enforced:
    title: 'APIGATEWAY v2api: Private Networking Enforced'
    severity: high
  aws.apigateway.throttle.api_stage_rate_limit_configured:
    title: 'APIGATEWAY throttle: Api Stage Rate Limit Configured'
    severity: medium
  aws.apigateway.apikey.key_expiration_required:
    title: 'APIGATEWAY apikey: Key Expiration Required'
    severity: medium
  aws.apigateway.usageplan.api_keys_required:
    title: 'APIGATEWAY usageplan: Api Keys Required'
    severity: medium
  aws.apigateway.restapi.authz_policies_enforced:
    title: 'APIGATEWAY restapi: Authz Policies Enforced'
    severity: medium
  aws.apigateway.restapi.public_access_restricted:
    title: 'APIGATEWAY restapi: Public Access Restricted'
    severity: high
  aws.apigateway.requestvalidator.api_request_body_size_limit_configured:
    title: 'APIGATEWAY requestvalidator: Api Request Body Size Limit Configured'
    severity: medium
  aws.apigateway.resource.restapi_logging_enabled:
    title: 'APIGATEWAY resource: Restapi Logging Enabled'
    severity: medium
  aws.apigateway.stage.api_execution_logging_level_minimum_error_configured:
    title: 'APIGATEWAY stage: Api Execution Logging Level Minimum Error Configured'
    severity: medium
  aws.apigateway.stage.api_access_logging_enabled:
    title: API logging and monitoring are enabled
    severity: high
  aws.apigateway.throttle.api_quota_limit_configured:
    title: 'APIGATEWAY throttle: Api Quota Limit Configured'
    severity: medium
  aws.apigateway.restapi.authn_required:
    title: 'APIGATEWAY restapi: Authn Required'
    severity: medium
  aws.apigateway.v2api.authn_required:
    title: 'APIGATEWAY v2api: Authn Required'
    severity: medium
  aws.apigateway.usageplan.api_quota_limits_configured:
    title: 'APIGATEWAY usageplan: Api Quota Limits Configured'
    severity: medium
  aws.apigateway.certificate.certificate_enabled:
    title: 'APIGATEWAY certificate: Certificate Enabled'
    severity: medium
  aws.apigateway.restapi.private_networking_enforced:
    title: 'APIGATEWAY restapi: Private Networking Enforced'
    severity: high
  aws.apigateway.requestvalidator.api_response_schema_validation_enabled:
    title: API request validation is enabled
    severity: high
  aws.apigateway.stage.usage_plan_for_api_keys_required:
    title: 'APIGATEWAY stage: Usage Plan For Api Keys Required'
    severity: medium
  aws.apigateway.throttle.api_stage_burst_limit_configured:
    title: API throttling and rate limiting are enabled
    severity: medium
  aws.apigateway.resource.api_resource_attached_enabled:
    title: 'APIGATEWAY resource: Api Resource Attached Enabled'
    severity: medium
  aws.apigateway.restapi.logging_enabled:
    title: Deprecation notices are monitored
    severity: low
