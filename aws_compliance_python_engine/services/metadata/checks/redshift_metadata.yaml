# REDSHIFT Service - Check Metadata
# This file contains titles, descriptions, and severity for all checks
# The main YAML file only contains the logic

version: '1.0'
service: redshift
checks:
  aws.redshift.hsm_configuration.redshift_configuration_present:
    title: 'REDSHIFT hsm configuration: Redshift Configuration Present'
    severity: medium
  aws.redshift.hsm_configuration.keys_in_hsm_only_configured:
    title: 'REDSHIFT hsm configuration: Keys In Hsm Only Configured'
    severity: medium
  aws.redshift.securitygroup.security_only_required_ports_open_restricted:
    title: 'REDSHIFT securitygroup: Security Only Required Ports Open Restricted'
    severity: medium
  aws.redshift.parametergroup.audit_logging_enabled:
    title: 'REDSHIFT parametergroup: Audit Logging Enabled'
    severity: medium
  aws.redshift.cluster.admin_access_least_privilege:
    title: 'REDSHIFT cluster: Admin Access Least Privilege'
    severity: high
  aws.redshift.endpointaccess.tls_required:
    title: 'REDSHIFT endpointaccess: Tls Required'
    severity: high
  aws.redshift.endpointaccess.access_allowed_cidrs_minimized_configured:
    title: 'REDSHIFT endpointaccess: Access Allowed Cidrs Minimized Configured'
    severity: medium
  aws.redshift.event_subscription.redshift_destination_encrypted:
    title: 'REDSHIFT event subscription: Redshift Destination Encrypted'
    severity: high
  aws.redshift.event_subscription.redshift_cross_account_sharing_restricted:
    title: 'REDSHIFT event subscription: Redshift Cross Account Sharing Restricted'
    severity: medium
  aws.redshift.cluster.audit_logging_enabled:
    title: 'REDSHIFT cluster: Audit Logging Enabled'
    severity: medium
  aws.redshift.hsm_client_certificate.key_length_minimum:
    title: 'REDSHIFT hsm client certificate: Key Length Minimum'
    severity: medium
  aws.redshift.parametergroup.require_ssl_configured:
    title: 'REDSHIFT parametergroup: Require Ssl Configured'
    severity: high
  aws.redshift.hsm_configuration.only_approved_hsm_endpoints_configured:
    title: 'REDSHIFT hsm configuration: Only Approved Hsm Endpoints Configured'
    severity: medium
  aws.redshift.endpoint_authorization.no_anonymous_access_configured:
    title: 'REDSHIFT endpoint authorization: No Anonymous Access Configured'
    severity: medium
  aws.redshift.user.redshift_approved_list_of_supers_only_configured:
    title: 'REDSHIFT user: Redshift Approved List Of Supers Only Configured'
    severity: medium
  aws.redshift.cluster.in_transit_encryption_enabled:
    title: Data warehouse encryption is enabled
    severity: high
  aws.redshift.resource.backup_enabled:
    title: 'REDSHIFT resource: Backup Enabled'
    severity: medium
  aws.redshift.securitygroup.security_no_0_configured:
    title: 'REDSHIFT securitygroup: Security No 0 Configured'
    severity: medium
  aws.redshift.cluster.enhanced_vpc_routing_configured:
    title: 'REDSHIFT cluster: Enhanced Vpc Routing Configured'
    severity: high
  aws.redshift.cluster.automated_snapshot_configured:
    title: 'REDSHIFT cluster: Automated Snapshot Configured'
    severity: medium
  aws.redshift.subnetgroup.redshift_private_subnets_only_configured:
    title: 'REDSHIFT subnetgroup: Redshift Private Subnets Only Configured'
    severity: high
  aws.redshift.cluster.deletion_protection_enabled:
    title: 'REDSHIFT cluster: Deletion Protection Enabled'
    severity: medium
  aws.redshift.cluster.multi_az_enabled:
    title: 'REDSHIFT cluster: Multi Az Enabled'
    severity: medium
  aws.redshift.cluster.minor_version_auto_upgrade_enabled:
    title: 'REDSHIFT cluster: Minor Version Auto Upgrade Enabled'
    severity: low
  aws.redshift.endpoint_authorization.rbac_least_privilege:
    title: 'REDSHIFT endpoint authorization: Rbac Least Privilege'
    severity: high
  aws.redshift.cluster.private_networking_enforced:
    title: 'REDSHIFT cluster: Private Networking Enforced'
    severity: high
  aws.redshift.hsm_client_certificate.certificate_trusted_issuer_verified:
    title: 'REDSHIFT hsm client certificate: Certificate Trusted Issuer Verified'
    severity: medium
  aws.redshift.cluster.tls_min_1_2_enforced:
    title: 'REDSHIFT cluster: Tls Min 1 2 Enforced'
    severity: high
  aws.redshift.securitygroup.security_egress_restricted:
    title: 'REDSHIFT securitygroup: Security Egress Restricted'
    severity: medium
  aws.redshift.securitygroup.security_no_0_ingress_configured:
    title: 'REDSHIFT securitygroup: Security No 0 Ingress Configured'
    severity: medium
  aws.redshift.securitygroup.security_no_0_ingress_on_db_ports_configured:
    title: 'REDSHIFT securitygroup: Security No 0 Ingress On Db Ports Configured'
    severity: medium
  aws.redshift.cluster.public_access_configured:
    title: 'REDSHIFT cluster: Public Access Configured'
    severity: high
  aws.redshift.user.iam_auth_preferred_configured:
    title: 'REDSHIFT user: Iam Auth Preferred Configured'
    severity: high
  aws.redshift.cluster.encryption_at_rest_cmek_configured:
    title: 'REDSHIFT cluster: Encryption At Rest Cmek Configured'
    severity: high
  aws.redshift.cluster.maintenance_settings_configured:
    title: 'REDSHIFT cluster: Maintenance Settings Configured'
    severity: medium
  aws.redshift.snapshot.encryption_at_rest_enabled:
    title: 'REDSHIFT snapshot: Encryption At Rest Enabled'
    severity: high
  aws.redshift.snapshot.redshift_cross_account_sharing_restricted:
    title: 'REDSHIFT snapshot: Redshift Cross Account Sharing Restricted'
    severity: medium
  aws.redshift.snapshot.not_publicly_shared_configured:
    title: 'REDSHIFT snapshot: Not Publicly Shared Configured'
    severity: high
  aws.redshift.event_subscription.redshift_destination_least_privilege:
    title: 'REDSHIFT event subscription: Redshift Destination Least Privilege'
    severity: high
  aws.redshift.parametergroup.tls_required:
    title: 'REDSHIFT parametergroup: Tls Required'
    severity: high
  aws.redshift.parametergroup.redshift_insecure_features_disabled_if_applicable_configured:
    title: 'REDSHIFT parametergroup: Redshift Insecure Features Disabled If Applicable
      Configured'
    severity: medium
  aws.redshift.cluster.audit_logging_configured:
    title: 'REDSHIFT cluster: Audit Logging Configured'
    severity: medium
  aws.redshift.cluster.encryption_at_rest_enabled:
    title: 'REDSHIFT cluster: Encryption At Rest Enabled'
    severity: high
  aws.redshift.user.redshift_no_unused_or_default_supers_configured:
    title: 'REDSHIFT user: Redshift No Unused Or Default Supers Configured'
    severity: medium
  aws.redshift.snapshot.redshift_cross_region_copy_encrypted:
    title: 'REDSHIFT snapshot: Redshift Cross Region Copy Encrypted'
    severity: high
  aws.redshift.parametergroup.logging_enabled:
    title: 'REDSHIFT parametergroup: Logging Enabled'
    severity: medium
  aws.redshift.endpointaccess.access_private_only_configured:
    title: 'REDSHIFT endpointaccess: Access Private Only Configured'
    severity: high
  aws.redshift.securitygroup.security_only_required_ports:
    title: 'REDSHIFT securitygroup: Security Only Required Ports'
    severity: medium
  aws.redshift.snapshot.kms_key_policy_least_privilege:
    title: 'REDSHIFT snapshot: Kms Key Policy Least Privilege'
    severity: high
  aws.redshift.cluster.automatic_upgrades_configured:
    title: 'REDSHIFT cluster: Automatic Upgrades Configured'
    severity: medium
  aws.redshift.hsm_client_certificate.certificate_valid:
    title: 'REDSHIFT hsm client certificate: Certificate Valid'
    severity: medium
