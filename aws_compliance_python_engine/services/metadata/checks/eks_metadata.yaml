# EKS Service - Check Metadata
# This file contains titles, descriptions, and severity for all checks
# The main YAML file only contains the logic

version: '1.0'
service: eks
checks:
  aws.eks.cluster.encryption_at_rest_enabled:
    title: 'EKS cluster: Encryption At Rest Enabled'
    severity: high
  aws.eks.cluster.anonymous_auth_disabled:
    title: 'EKS cluster: Anonymous Auth Disabled'
    severity: medium
  aws.eks.nodegroup.nodes_no_public_ip_configured:
    title: 'EKS nodegroup: Nodes No Public Ip Configured'
    severity: high
  aws.eks.api.image_signature_verification_enabled:
    title: 'EKS api: Image Signature Verification Enabled'
    severity: medium
  aws.eks.resource.control_plane_logging_all_types_enabled:
    title: 'EKS resource: Control Plane Logging All Types Enabled'
    severity: medium
  aws.eks.cluster.secrets_encryption_kms_cmk_configured:
    title: 'EKS cluster: Secrets Encryption Kms Cmk Configured'
    severity: high
  aws.eks.api.env_no_plaintext_secrets_configured:
    title: 'EKS api: Env No Plaintext Secrets Configured'
    severity: medium
  aws.eks.api.cluster_required_allowlist_for_namespace_services:
    title: 'EKS api: Cluster Required Allowlist For Namespace Services'
    severity: medium
  aws.eks.api.read_only_root_filesystem_configured:
    title: 'EKS api: Read Only Root Filesystem Configured'
    severity: medium
  aws.eks.nodegroup.node_shielded_secure_boot_enabled:
    title: 'EKS nodegroup: Node Shielded Secure Boot Enabled'
    severity: medium
  aws.eks.api.wildcard_verbs_disallowed_configured:
    title: 'EKS api: Wildcard Verbs Disallowed Configured'
    severity: medium
  aws.eks.api.tls_min_version_1_2_configured:
    title: 'EKS api: Tls Min Version 1 2 Configured'
    severity: high
  aws.eks.api.host_namespace_usage_denied_configured:
    title: 'EKS api: Host Namespace Usage Denied Configured'
    severity: medium
  aws.eks.resource.kubelet_event_record_qps_configured:
    title: 'EKS resource: Kubelet Event Record Qps Configured'
    severity: medium
  aws.eks.api.no_cluster_admin_to_authenticated_configured:
    title: 'EKS api: No Cluster Admin To Authenticated Configured'
    severity: medium
  aws.eks.api.default_service_account_automount_disabled:
    title: 'EKS api: Default Service Account Automount Disabled'
    severity: medium
  aws.eks.api.nodeport_usage_restricted:
    title: 'EKS api: Nodeport Usage Restricted'
    severity: medium
  aws.eks.cluster.private_control_plane_endpoint_enabled:
    title: 'EKS cluster: Private Control Plane Endpoint Enabled'
    severity: high
  aws.eks.fargateprofile.execution_role_least_privilege:
    title: 'EKS fargateprofile: Execution Role Least Privilege'
    severity: high
  aws.eks.api.image_registry_allowlist_enforced:
    title: 'EKS api: Image Registry Allowlist Enforced'
    severity: medium
  aws.eks.api.drop_net_raw_and_reduce_caps_configured:
    title: 'EKS api: Drop Net Raw And Reduce Caps Configured'
    severity: medium
  aws.eks.nodegroup.node_workload_identity_enabled:
    title: 'EKS nodegroup: Node Workload Identity Enabled'
    severity: medium
  aws.eks.cluster.audit_logging_enabled:
    title: Cluster monitoring is enabled
    severity: medium
  aws.eks.api.default_deny_egress_per_namespace_configured:
    title: 'EKS api: Default Deny Egress Per Namespace Configured'
    severity: medium
  aws.eks.api.pod_security_level_restricted:
    title: 'EKS api: Pod Security Level Restricted'
    severity: medium
  aws.eks.fargateprofile.client_cert_rotation_enabled:
    title: 'EKS fargateprofile: Client Cert Rotation Enabled'
    severity: medium
  aws.eks.cluster.profiling_disabled:
    title: 'EKS cluster: Profiling Disabled'
    severity: medium
  aws.eks.cluster.service_account_token_signing_enabled:
    title: 'EKS cluster: Service Account Token Signing Enabled'
    severity: medium
  aws.eks.certificate.monitored:
    title: 'EKS certificate: Monitored'
    severity: medium
  aws.eks.api.admission_psa_enforce_mode_configured:
    title: 'EKS api: Admission Psa Enforce Mode Configured'
    severity: medium
  aws.eks.fargateprofile.read_only_port_disabled:
    title: 'EKS fargateprofile: Read Only Port Disabled'
    severity: medium
  aws.eks.nodegroup.node_read_only_port_disabled:
    title: 'EKS nodegroup: Node Read Only Port Disabled'
    severity: medium
  aws.eks.addon.no_privileged_permissions_configured:
    title: 'EKS addon: No Privileged Permissions Configured'
    severity: high
  aws.eks.fargateprofile.logging_enabled:
    title: 'EKS fargateprofile: Logging Enabled'
    severity: medium
  aws.eks.api.default_deny_ingress_per_namespace_configured:
    title: 'EKS api: Default Deny Ingress Per Namespace Configured'
    severity: medium
  aws.eks.api.external_ips_not_used_configured:
    title: 'EKS api: External Ips Not Used Configured'
    severity: medium
  aws.eks.addon.version_pinned_and_supported_configured:
    title: 'EKS addon: Version Pinned And Supported Configured'
    severity: low
  aws.eks.cluster.leader_election_enabled:
    title: 'EKS cluster: Leader Election Enabled'
    severity: medium
  aws.eks.nodegroup.anonymous_auth_disabled:
    title: 'EKS nodegroup: Anonymous Auth Disabled'
    severity: medium
  aws.eks.cluster.client_cert_auth_enabled:
    title: 'EKS cluster: Client Cert Auth Enabled'
    severity: medium
  aws.eks.api.no_hostpath_mounts_configured:
    title: 'EKS api: No Hostpath Mounts Configured'
    severity: medium
  aws.eks.cluster.tls_min_version_1_2_configured:
    title: 'EKS cluster: Tls Min Version 1 2 Configured'
    severity: high
  aws.eks.api.read_only_port_disabled:
    title: 'EKS api: Read Only Port Disabled'
    severity: medium
  aws.eks.api.client_cert_rotation_enabled:
    title: 'EKS api: Client Cert Rotation Enabled'
    severity: medium
  aws.eks.cluster.default_service_account_automount_disabled:
    title: 'EKS cluster: Default Service Account Automount Disabled'
    severity: medium
  aws.eks.api.type_loadbalancer_internal_only_where_required:
    title: 'EKS api: Type Loadbalancer Internal Only Where Required'
    severity: medium
  aws.eks.api.network_policies_present:
    title: 'EKS api: Network Policies Present'
    severity: high
  aws.eks.api.leader_election_enabled:
    title: 'EKS api: Leader Election Enabled'
    severity: medium
  aws.eks.api.dns_and_metrics_from_approved_sources_configured:
    title: 'EKS api: Dns And Metrics From Approved Sources Configured'
    severity: medium
  aws.eks.api.privilege_escalation_denied_configured:
    title: 'EKS api: Privilege Escalation Denied Configured'
    severity: high
  aws.eks.api.no_privileged_containers_configured:
    title: 'EKS api: No Privileged Containers Configured'
    severity: high
  aws.eks.nodegroup.node_protect_kernel_defaults_enabled:
    title: 'EKS nodegroup: Node Protect Kernel Defaults Enabled'
    severity: medium
  aws.eks.cluster.kms_cmk_encryption_in_secrets_enabled:
    title: 'EKS cluster: Kms Cmk Encryption In Secrets Enabled'
    severity: high
  aws.eks.api.run_as_non_root_configured:
    title: 'EKS api: Run As Non Root Configured'
    severity: medium
  aws.eks.cluster.endpoint_access_configured:
    title: 'EKS cluster: Endpoint Access Configured'
    severity: medium
  aws.eks.cluster.private_nodes_configuration_configured:
    title: 'EKS cluster: Private Nodes Configuration Configured'
    severity: high
  aws.eks.nodegroup.disk_encryption_enabled:
    title: 'EKS nodegroup: Disk Encryption Enabled'
    severity: high
  aws.eks.api.host_network_pid_ipc_disabled:
    title: 'EKS api: Host Network Pid Ipc Disabled'
    severity: high
  aws.eks.api.service_account_token_signing_enabled:
    title: 'EKS api: Service Account Token Signing Enabled'
    severity: medium
  aws.eks.fargateprofile.anonymous_auth_disabled:
    title: 'EKS fargateprofile: Anonymous Auth Disabled'
    severity: medium
  aws.eks.cluster.admission_psa_enforce_mode_configured:
    title: 'EKS cluster: Admission Psa Enforce Mode Configured'
    severity: medium
  aws.eks.api.seccomp_profile_runtime_default_configured:
    title: 'EKS api: Seccomp Profile Runtime Default Configured'
    severity: medium
  aws.eks.api.default_sa_not_cluster_admin_configured:
    title: 'EKS api: Default Sa Not Cluster Admin Configured'
    severity: medium
  aws.eks.cluster.secure_port_enabled:
    title: 'EKS cluster: Secure Port Enabled'
    severity: medium
  aws.eks.cluster.secrets_encryption_kms_enabled:
    title: 'EKS cluster: Secrets Encryption Kms Enabled'
    severity: high
  aws.eks.resource.node_kubelet_read_only_port_configured:
    title: 'EKS resource: Node Kubelet Read Only Port Configured'
    severity: medium
  aws.eks.api.kube_system_services_not_public_configured:
    title: 'EKS api: Kube System Services Not Public Configured'
    severity: high
  aws.eks.api.profiling_disabled:
    title: 'EKS api: Profiling Disabled'
    severity: medium
  aws.eks.addon.from_trusted_channel_configured:
    title: 'EKS addon: From Trusted Channel Configured'
    severity: medium
  aws.eks.api.secure_port_enabled:
    title: 'EKS api: Secure Port Enabled'
    severity: medium
  aws.eks.fargateprofile.private_subnets_only_configured:
    title: 'EKS fargateprofile: Private Subnets Only Configured'
    severity: high
  aws.eks.api.anonymous_auth_disabled:
    title: 'EKS api: Anonymous Auth Disabled'
    severity: medium
  aws.eks.api.pod_security_admission_restricted_default_configured:
    title: 'EKS api: Pod Security Admission Restricted Default Configured'
    severity: medium
  aws.eks.fargateprofile.protect_kernel_defaults_enabled:
    title: 'EKS fargateprofile: Protect Kernel Defaults Enabled'
    severity: medium
  aws.eks.api.audit_logging_enabled:
    title: 'EKS api: Audit Logging Enabled'
    severity: medium
  aws.eks.api.image_tag_not_latest_configured:
    title: 'EKS api: Image Tag Not Latest Configured'
    severity: medium
  aws.eks.api.protect_kernel_defaults_enabled:
    title: 'EKS api: Protect Kernel Defaults Enabled'
    severity: medium
  aws.eks.nodegroup.client_cert_rotation_enabled:
    title: 'EKS nodegroup: Client Cert Rotation Enabled'
    severity: medium
