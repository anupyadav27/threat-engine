# GLUE Service - Check Metadata
# This file contains titles, descriptions, and severity for all checks
# The main YAML file only contains the logic

version: '1.0'
service: glue
checks:
  aws.glue.registry.metadata_encryption_enabled:
    title: 'GLUE registry: Metadata Encryption Enabled'
    severity: high
  aws.glue.table.access_logging_enabled:
    title: 'GLUE table: Access Logging Enabled'
    severity: medium
  aws.glue.devendpoint.no_public_access_configured:
    title: 'GLUE devendpoint: No Public Access Configured'
    severity: high
  aws.glue.job.policies_present_for_sensitive_fields_configured:
    title: 'GLUE job: Policies Present For Sensitive Fields Configured'
    severity: medium
  aws.glue.job.execution_roles_least_privilege:
    title: 'GLUE job: Execution Roles Least Privilege'
    severity: high
  aws.glue.trigger.targets_least_privilege:
    title: 'GLUE trigger: Targets Least Privilege'
    severity: high
  aws.glue.data_quality_ruleset.execution_role_least_privilege:
    title: 'GLUE data quality ruleset: Execution Role Least Privilege'
    severity: high
  aws.glue.mltransform.network_private_only_configured:
    title: 'GLUE mltransform: Network Private Only Configured'
    severity: high
  aws.glue.connection.credentials_in_secrets_manager_configured:
    title: 'GLUE connection: Credentials In Secrets Manager Configured'
    severity: medium
  aws.glue.data_quality_ruleset.output_encrypted_private:
    title: 'GLUE data quality ruleset: Output Encrypted Private'
    severity: high
  aws.glue.table.lifecycle_policy_configured:
    title: 'GLUE table: Lifecycle Policy Configured'
    severity: high
  aws.glue.data_quality_ruleset.output_location_private_and_encrypted:
    title: 'GLUE data quality ruleset: Output Location Private And Encrypted'
    severity: high
  aws.glue.database.rbac_least_privilege:
    title: 'GLUE database: Rbac Least Privilege'
    severity: high
  aws.glue.trigger.logging_enabled:
    title: 'GLUE trigger: Logging Enabled'
    severity: medium
  aws.glue.table.s3_encrypted_at_rest:
    title: 'GLUE table: S3 Encrypted At Rest'
    severity: high
  aws.glue.catalog.log_catalog_cross_account_sharing_review_required:
    title: 'GLUE catalog: Log Catalog Cross Account Sharing Review Required'
    severity: medium
  aws.glue.resource.dev_endpoints_logs_encrypted:
    title: 'GLUE resource: Dev Endpoints Logs Encrypted'
    severity: high
  aws.glue.job.network_private_only_configured:
    title: 'GLUE job: Network Private Only Configured'
    severity: high
  aws.glue.resource.etl_jobs_job_bookmark_encryption_enabled:
    title: 'GLUE resource: Etl Jobs Job Bookmark Encryption Enabled'
    severity: high
  aws.glue.devendpoint.encryption_at_rest_enabled:
    title: 'GLUE devendpoint: Encryption At Rest Enabled'
    severity: high
  aws.glue.resource.etl_jobs_cloudwatch_logs_encryption_enabled:
    title: 'GLUE resource: Etl Jobs Cloudwatch Logs Encryption Enabled'
    severity: high
  aws.glue.resource.dev_endpoints_bookmark_encrypted:
    title: 'GLUE resource: Dev Endpoints Bookmark Encrypted'
    severity: high
  aws.glue.crawler.scope_restricted_to_allowlist_configured:
    title: 'GLUE crawler: Scope Restricted To Allowlist Configured'
    severity: medium
  aws.glue.classifier.rbac_least_privilege:
    title: 'GLUE classifier: Rbac Least Privilege'
    severity: high
  aws.glue.data_quality_ruleset.rbac_least_privilege:
    title: 'GLUE data quality ruleset: Rbac Least Privilege'
    severity: high
  aws.glue.database.metadata_encryption_enabled:
    title: 'GLUE database: Metadata Encryption Enabled'
    severity: high
  aws.glue.datalineage.capture_enabled:
    title: 'GLUE datalineage: Capture Enabled'
    severity: medium
  aws.glue.job.logs_and_metrics_enabled:
    title: 'GLUE job: Logs And Metrics Enabled'
    severity: medium
  aws.glue.data_quality_ruleset.version_immutable_configured:
    title: 'GLUE data quality ruleset: Version Immutable Configured'
    severity: low
  aws.glue.schema.encryption_at_rest_enabled:
    title: 'GLUE schema: Encryption At Rest Enabled'
    severity: high
  aws.glue.workflow.private_networking_enforced:
    title: 'GLUE workflow: Private Networking Enforced'
    severity: high
  aws.glue.table.s3_block_public_access_configured:
    title: 'GLUE table: S3 Block Public Access Configured'
    severity: high
  aws.glue.catalog.change_audit_logging_enabled:
    title: 'GLUE catalog: Change Audit Logging Enabled'
    severity: medium
  aws.glue.job.role_least_privilege:
    title: 'GLUE job: Role Least Privilege'
    severity: high
  aws.glue.table.access_policies_least_privilege:
    title: 'GLUE table: Access Policies Least Privilege'
    severity: high
  aws.glue.catalog.log_catalog_store_encrypted:
    title: 'GLUE catalog: Log Catalog Store Encrypted'
    severity: high
  aws.glue.workflow.execution_roles_least_privilege:
    title: 'GLUE workflow: Execution Roles Least Privilege'
    severity: high
  aws.glue.classifier.source_trusted_configured:
    title: 'GLUE classifier: Source Trusted Configured'
    severity: medium
  aws.glue.schema.immutability_enforced:
    title: 'GLUE schema: Immutability Enforced'
    severity: medium
  aws.glue.job.outputs_encrypted:
    title: 'GLUE job: Outputs Encrypted'
    severity: high
  aws.glue.registry.rbac_least_privilege:
    title: 'GLUE registry: Rbac Least Privilege'
    severity: high
  aws.glue.database.cross_account_sharing_review_required:
    title: 'GLUE database: Cross Account Sharing Review Required'
    severity: medium
  aws.glue.partition.catalog_glue_catalog_encrypted:
    title: 'GLUE partition: Catalog Glue Catalog Encrypted'
    severity: high
  aws.glue.data_quality_ruleset.encryption_at_rest_enabled:
    title: 'GLUE data quality ruleset: Encryption At Rest Enabled'
    severity: high
  aws.glue.mltransform.role_least_privilege:
    title: 'GLUE mltransform: Role Least Privilege'
    severity: high
  aws.glue.database.update_rbac_least_privilege:
    title: 'GLUE database: Update Rbac Least Privilege'
    severity: high
  aws.glue.crawler.role_least_privilege:
    title: 'GLUE crawler: Role Least Privilege'
    severity: high
  aws.glue.data_quality_ruleset.role_least_privilege:
    title: 'GLUE data quality ruleset: Role Least Privilege'
    severity: high
  aws.glue.workflow.artifacts_private_and_encrypted:
    title: 'GLUE workflow: Artifacts Private And Encrypted'
    severity: high
  aws.glue.mltransform.logging_enabled:
    title: 'GLUE mltransform: Logging Enabled'
    severity: medium
  aws.glue.resource.etl_jobs_logging_enabled:
    title: 'GLUE resource: Etl Jobs Logging Enabled'
    severity: medium
  aws.glue.data_quality_ruleset.version_pinned_configured:
    title: 'GLUE data quality ruleset: Version Pinned Configured'
    severity: low
  aws.glue.registry.cross_account_sharing_restricted:
    title: 'GLUE registry: Cross Account Sharing Restricted'
    severity: medium
  aws.glue.classifier.definition_version_pinned_configured:
    title: 'GLUE classifier: Definition Version Pinned Configured'
    severity: low
  aws.glue.data_quality_ruleset.logging_enabled:
    title: 'GLUE data quality ruleset: Logging Enabled'
    severity: medium
  aws.glue.table.encryption_at_rest_enabled:
    title: 'GLUE table: Encryption At Rest Enabled'
    severity: high
  aws.glue.resource.data_catalogs_metadata_encryption_enabled:
    title: 'GLUE resource: Data Catalogs Metadata Encryption Enabled'
    severity: high
  aws.glue.database.audit_logging_enabled:
    title: Data lake catalog access is properly controlled
    severity: high
  aws.glue.data_quality_ruleset.definition_version_pinned_configured:
    title: 'GLUE data quality ruleset: Definition Version Pinned Configured'
    severity: low
  aws.glue.table.column_level_access_controls_enabled:
    title: 'GLUE table: Column Level Access Controls Enabled'
    severity: medium
  aws.glue.partition.access_policies_least_privilege:
    title: 'GLUE partition: Access Policies Least Privilege'
    severity: high
  aws.glue.database.change_audit_logging_enabled:
    title: Data lineage tracking is enabled for analytics
    severity: medium
  aws.glue.data_quality_ruleset.source_trusted_configured:
    title: 'GLUE data quality ruleset: Source Trusted Configured'
    severity: medium
  aws.glue.resource.development_endpoints_s3_encryption_enabled:
    title: 'GLUE resource: Development Endpoints S3 Encryption Enabled'
    severity: high
  aws.glue.resource.etl_jobs_amazon_s3_encryption_enabled:
    title: 'GLUE resource: Etl Jobs Amazon S3 Encryption Enabled'
    severity: high
  aws.glue.schema.rbac_least_privilege:
    title: 'GLUE schema: Rbac Least Privilege'
    severity: high
  aws.glue.datalineage.rbac_least_privilege:
    title: 'GLUE datalineage: Rbac Least Privilege'
    severity: high
  aws.glue.job.script_location_private_and_encrypted:
    title: 'GLUE job: Script Location Private And Encrypted'
    severity: high
  aws.glue.table.public_sharing_disabled:
    title: 'GLUE table: Public Sharing Disabled'
    severity: high
  aws.glue.database.cross_account_sharing_restricted:
    title: 'GLUE database: Cross Account Sharing Restricted'
    severity: medium
  aws.glue.workflow.logs_and_metrics_enabled:
    title: 'GLUE workflow: Logs And Metrics Enabled'
    severity: medium
  aws.glue.database.policy_least_privilege:
    title: 'GLUE database: Policy Least Privilege'
    severity: high
  aws.glue.workflow.kms_encryption_enabled:
    title: 'GLUE workflow: Kms Encryption Enabled'
    severity: high
  aws.glue.data_quality_ruleset.run_metadata_logging_enabled:
    title: 'GLUE data quality ruleset: Run Metadata Logging Enabled'
    severity: medium
  aws.glue.crawler.network_private_only_configured:
    title: 'GLUE crawler: Network Private Only Configured'
    severity: high
  aws.glue.job.s_private_networking_configured:
    title: 'GLUE job: S Private Networking Configured'
    severity: high
  aws.glue.connection.role_least_privilege:
    title: 'GLUE connection: Role Least Privilege'
    severity: high
  aws.glue.catalog.metadata_encryption_enabled:
    title: Data catalog encryption is enabled
    severity: medium
  aws.glue.data_quality_ruleset.parameters_no_plaintext_secrets_configured:
    title: 'GLUE data quality ruleset: Parameters No Plaintext Secrets Configured'
    severity: medium
  aws.glue.workflow.cross_account_trusts_restricted:
    title: 'GLUE workflow: Cross Account Trusts Restricted'
    severity: medium
  aws.glue.data_catalogs_not_publicly_accessible.data_catalogs_not_publicly_accessible_configured:
    title: 'GLUE data catalogs not publicly accessible: Data Catalogs Not Publicly
      Accessible Configured'
    severity: medium
  aws.glue.resource.ml_transform_encrypted_at_rest:
    title: 'GLUE resource: Ml Transform Encrypted At Rest'
    severity: high
  aws.glue.data_quality_ruleset.outputs_encrypted_and_private:
    title: 'GLUE data quality ruleset: Outputs Encrypted And Private'
    severity: high
  aws.glue.database.encryption_at_rest_enabled:
    title: 'GLUE database: Encryption At Rest Enabled'
    severity: high
  aws.glue.connection.private_networking_enforced:
    title: 'GLUE connection: Private Networking Enforced'
    severity: high
  aws.glue.trigger.event_sources_restricted:
    title: 'GLUE trigger: Event Sources Restricted'
    severity: medium
  aws.glue.catalog.log_catalog_cross_account_sharing_restricted:
    title: 'GLUE catalog: Log Catalog Cross Account Sharing Restricted'
    severity: medium
  aws.glue.catalog.update_rbac_least_privilege:
    title: 'GLUE catalog: Update Rbac Least Privilege'
    severity: high
  aws.glue.resource.catalog_passwords_encrypted:
    title: 'GLUE resource: Catalog Passwords Encrypted'
    severity: high
  aws.glue.datalineage.export_destination_encrypted:
    title: 'GLUE datalineage: Export Destination Encrypted'
    severity: high
  aws.glue.crawler.logging_enabled:
    title: 'GLUE crawler: Logging Enabled'
    severity: medium
  aws.glue.data_quality_ruleset.jobs_role_least_privilege:
    title: 'GLUE data quality ruleset: Jobs Role Least Privilege'
    severity: high
  aws.glue.catalog.rbac_least_privilege:
    title: 'GLUE catalog: Rbac Least Privilege'
    severity: high
  aws.glue.catalog.audit_logging_enabled:
    title: 'GLUE catalog: Audit Logging Enabled'
    severity: medium
  aws.glue.workflow.execution_role_least_privilege:
    title: 'GLUE workflow: Execution Role Least Privilege'
    severity: high
  aws.glue.connection.tls_required:
    title: 'GLUE connection: Tls Required'
    severity: high
  aws.glue.devendpoint.role_least_privilege:
    title: 'GLUE devendpoint: Role Least Privilege'
    severity: high
