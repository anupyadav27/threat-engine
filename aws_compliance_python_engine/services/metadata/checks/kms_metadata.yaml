# KMS Service - Check Metadata
# This file contains titles, descriptions, and severity for all checks
# The main YAML file only contains the logic

version: '1.0'
service: kms
checks:
  aws.kms.alias.points_to_active_key_configured:
    title: 'KMS alias: Points To Active Key Configured'
    severity: medium
  aws.kms.alias.logging_enabled:
    title: 'KMS alias: Logging Enabled'
    severity: medium
  aws.kms.key.state_change_monitoring_enabled:
    title: 'KMS key: State Change Monitoring Enabled'
    severity: medium
  aws.kms.key.certificate_expiration_configured:
    title: 'KMS key: Certificate Expiration Configured'
    severity: medium
  aws.kms.key.mtls_required_for_internal_services_if_supported:
    title: 'KMS key: Mtls Required For Internal Services If Supported'
    severity: high
  aws.kms.key.tls_min_1_2_enforced:
    title: 'KMS key: Tls Min 1 2 Enforced'
    severity: high
  aws.kms.key.multi_region_disabled:
    title: 'KMS key: Multi Region Disabled'
    severity: medium
  aws.kms.key.in_transit_tls_min_1_2_configured:
    title: 'KMS key: In Transit Tls Min 1 2 Configured'
    severity: high
  aws.kms.grant.lessthan_wildcard_permissions_configured:
    title: 'KMS grant: Lessthan Wildcard Permissions Configured'
    severity: high
  aws.kms.key.at_rest_cmek_enabled:
    title: 'KMS key: At Rest Cmek Enabled'
    severity: medium
  aws.kms.key.not_scheduled_for_deletion_configured:
    title: 'KMS key: Not Scheduled For Deletion Configured'
    severity: medium
  aws.kms.grant.ee_principal_valid:
    title: 'KMS grant: Ee Principal Valid'
    severity: medium
  aws.kms.key.rotation_enabled:
    title: Key Management Service is properly configured
    severity: low
  aws.kms.alias.default_keys_disabled_if_cmek_required:
    title: 'KMS alias: Default Keys Disabled If Cmek Required'
    severity: medium
  aws.kms.key.customer_managed_keys_in_use:
    title: 'KMS key: Customer Managed Keys In Use'
    severity: medium
  aws.kms.alias.key_has_alias_configured:
    title: 'KMS alias: Key Has Alias Configured'
    severity: medium
  aws.kms.key.deletion_requires_waiting_period_configured:
    title: 'KMS key: Deletion Requires Waiting Period Configured'
    severity: medium
  aws.kms.key.logging_enabled:
    title: 'KMS key: Logging Enabled'
    severity: medium
  aws.kms.key.not_pending_deletion:
    title: 'KMS key: Not Pending Deletion'
    severity: medium
  aws.kms.key.not_publicly_accessible_configured:
    title: 'KMS key: Not Publicly Accessible Configured'
    severity: high
  aws.kms.key.default_keys_disabled_if_cmek_required:
    title: 'KMS key: Default Keys Disabled If Cmek Required'
    severity: medium
  aws.kms.grant.constraints_present:
    title: 'KMS grant: Constraints Present'
    severity: medium
  aws.kms.key.lifecycle_policy_configured:
    title: 'KMS key: Lifecycle Policy Configured'
    severity: high
  aws.kms.key.policy_least_privilege:
    title: 'KMS key: Policy Least Privilege'
    severity: high
