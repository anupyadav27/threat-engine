# S3 Service - Check Metadata
# This file contains titles, descriptions, and severity for all checks
# The main YAML file only contains the logic

version: '1.0'
service: s3
checks:
  aws.s3.bucket.encryption_at_rest_enabled:
    title: S3 Bucket Encryption at Rest Enabled
    severity: high
  aws.s3.bucket.default_encryption_configured:
    title: S3 Bucket Default Encryption Configured
    severity: high
  aws.s3.bucket.kms_encryption_configured:
    title: S3 Bucket KMS Encryption Configured
    severity: medium
  aws.s3.bucket.versioning_enabled:
    title: S3 Bucket Versioning Enabled
    severity: medium
  aws.s3.bucket.access_logging_enabled:
    title: S3 Bucket Access Logging Enabled
    severity: medium
  aws.s3.bucket.block_public_access_enabled:
    title: S3 Bucket Block Public Access Enabled
    severity: critical
  aws.s3.bucket.block_public_access_configured:
    title: S3 Bucket Block Public Access Configured
    severity: critical
  aws.s3.bucket.immutability_or_object_lock_if_supported:
    title: S3 Bucket Object Lock Enabled
    severity: medium
  aws.s3.bucket.immutable_or_worm_enabled_if_supported:
    title: S3 Bucket Immutable or WORM Enabled
    severity: medium
  aws.s3.bucket.lifecycle_policy_configured:
    title: S3 Bucket Lifecycle Policy Configured
    severity: low
  aws.s3.bucket.lifecycle_enabled:
    title: S3 Bucket Lifecycle Enabled
    severity: low
  aws.s3.bucket.replication_enabled:
    title: S3 Bucket Replication Enabled
    severity: low
  aws.s3.account.level_public_access_blocks_configured:
    title: 'S3 account: Level Public Access Blocks Configured'
    severity: high
  aws.s3.bucket.backup_storage_immutability_enabled:
    title: 'S3 bucket: Backup Storage Immutability Enabled'
    severity: medium
  aws.s3.bucket.cmk_cmek_configured:
    title: 'S3 bucket: Cmk Cmek Configured'
    severity: medium
  aws.s3.bucket.cmk_cmek_key_configured:
    title: 'S3 bucket: Cmk Cmek Key Configured'
    severity: medium
  aws.s3.bucket.destination_private_only_configured:
    title: 'S3 bucket: Destination Private Only Configured'
    severity: high
  aws.s3.bucket.encryption_at_rest_cmek_configured:
    title: 'S3 bucket: Encryption At Rest Cmek Configured'
    severity: high
  aws.s3.bucket.encryption_enabled:
    title: Backup encryption is enabled
    severity: high
  aws.s3.bucket.encryption_in_transit_tls_min_1_2_configured:
    title: 'S3 bucket: Encryption In Transit Tls Min 1 2 Configured'
    severity: high
  aws.s3.bucket.key_policy_least_privilege:
    title: 'S3 bucket: Key Policy Least Privilege'
    severity: high
  aws.s3.bucket.key_rotation_enabled:
    title: Create immutable backup copies
    severity: medium
  aws.s3.bucket.metrics_enabled:
    title: 'S3 bucket: Metrics Enabled'
    severity: medium
  aws.s3.bucket.object_level_write_logging_enabled:
    title: Compliance logging is enabled
    severity: medium
  aws.s3.bucket.object_versioning_configured:
    title: 'S3 bucket: Object Versioning Configured'
    severity: low
  aws.s3.bucket.policy_denies_public_and_insecure_configured:
    title: 'S3 bucket: Policy Denies Public And Insecure Configured'
    severity: high
  aws.s3.bucket.policy_public_write_access_configured:
    title: 'S3 bucket: Policy Public Write Access Configured'
    severity: high
  aws.s3.bucket.public_access_configured:
    title: 'S3 bucket: Public Access Configured'
    severity: high
  aws.s3.bucket.public_read_prohibited_configured:
    title: 'S3 bucket: Public Read Prohibited Configured'
    severity: high
  aws.s3.bucket.public_write_prohibited_configured:
    title: 'S3 bucket: Public Write Prohibited Configured'
    severity: high
  aws.s3.bucket.rbac_least_privilege:
    title: 'S3 bucket: Rbac Least Privilege'
    severity: high
  aws.s3.bucket.require_tls_in_transit_configured:
    title: 'S3 bucket: Require Tls In Transit Configured'
    severity: high
  aws.s3.bucket.retention_days_minimum:
    title: 'S3 bucket: Retention Days Minimum'
    severity: low
  aws.s3.bucket.s3_encrypted_at_rest:
    title: 'S3 bucket: S3 Encrypted At Rest'
    severity: high
  aws.s3.bucket.schedule_defined_min_frequency_configured:
    title: 'S3 bucket: Schedule Defined Min Frequency Configured'
    severity: medium
  aws.s3.bucket.secure_transport_policy_configured:
    title: 'S3 bucket: Secure Transport Policy Configured'
    severity: high
  aws.s3.bucket.server_access_logging_enabled:
    title: Audit public access permissions
    severity: medium
  aws.s3.bucket.storage_encrypted_and_private:
    title: 'S3 bucket: Storage Encrypted And Private'
    severity: high
  aws.s3.bucket_encryption.bucket_at_rest_cmek_enabled:
    title: 'S3 bucket encryption: Bucket At Rest Cmek Enabled'
    severity: medium
  aws.s3.bucket_encryption.in_transit_tls_min_1_2_configured:
    title: 'S3 bucket encryption: In Transit Tls Min 1 2 Configured'
    severity: high
  aws.s3.bucket_notification.bucket_cross_account_destinations_restricted:
    title: 'S3 bucket notification: Bucket Cross Account Destinations Restricted'
    severity: medium
  aws.s3.bucket_notification.bucket_destination_encrypted:
    title: 'S3 bucket notification: Bucket Destination Encrypted'
    severity: high
  aws.s3.bucket_notification.bucket_destination_least_privilege:
    title: 'S3 bucket notification: Bucket Destination Least Privilege'
    severity: high
  aws.s3.bucketpolicy.bucket_deny_insecure_transport_configured:
    title: 'S3 bucketpolicy: Bucket Deny Insecure Transport Configured'
    severity: medium
  aws.s3.bucketpolicy.bucket_deny_unencrypted_puts:
    title: 'S3 bucketpolicy: Bucket Deny Unencrypted Puts'
    severity: high
  aws.s3.bucketpolicy.bucket_no_wildcards_on_actions_or_principals_configured:
    title: 'S3 bucketpolicy: Bucket No Wildcards On Actions Or Principals Configured'
    severity: medium
  aws.s3.bucketpolicy.no_public_principals_configured:
    title: 'S3 bucketpolicy: No Public Principals Configured'
    severity: high
  aws.s3.intelligent_tiering.bucket_enforced_on_sensitive_datasets_configured:
    title: 'S3 intelligent tiering: Bucket Enforced On Sensitive Datasets Configured'
    severity: medium
  aws.s3.intelligent_tiering.policies_configured:
    title: 'S3 intelligent tiering: Policies Configured'
    severity: medium
  aws.s3.intelligent_tiering.protected_from_public_override_configured:
    title: 'S3 intelligent tiering: Protected From Public Override Configured'
    severity: high
  aws.s3.lifecycle_configuration.bucket_enforced_on_sensitive_datasets_configured:
    title: 'S3 lifecycle configuration: Bucket Enforced On Sensitive Datasets Configured'
    severity: medium
  aws.s3.lifecycle_configuration.certificate_expiration_rules_configured:
    title: 'S3 lifecycle configuration: Certificate Expiration Rules Configured'
    severity: medium
  aws.s3.lifecycle_configuration.immutable_retention_locked_where_required:
    title: 'S3 lifecycle configuration: Immutable Retention Locked Where Required'
    severity: low
  aws.s3.lifecycle_configuration.policies_configured:
    title: 'S3 lifecycle configuration: Policies Configured'
    severity: medium
  aws.s3.lifecycle_configuration.protected_from_public_override_configured:
    title: 'S3 lifecycle configuration: Protected From Public Override Configured'
    severity: high
  aws.s3.lifecycle_configuration.versioning_enabled_if_supported:
    title: 'S3 lifecycle configuration: Versioning Enabled If Supported'
    severity: low
  aws.s3.macie_classification_jobs_status.macie_classification_jobs_status_configured:
    title: 'S3 macie classification jobs status: Macie Classification Jobs Status
      Configured'
    severity: medium
  aws.s3.object.encryption_at_rest_enabled:
    title: Encrypt data in public buckets
    severity: medium
  aws.s3.object.lock_or_immutability_enabled_if_supported:
    title: 'S3 object: Lock Or Immutability Enabled If Supported'
    severity: medium
  aws.s3.object.not_publicly_readable_configured:
    title: 'S3 object: Not Publicly Readable Configured'
    severity: high
  aws.s3.replication.auth_roles_least_privilege:
    title: 'S3 replication: Auth Roles Least Privilege'
    severity: high
  aws.s3.replication.encryption_in_transit_tls_required:
    title: 'S3 replication: Encryption In Transit Tls Required'
    severity: high
  aws.s3.replication.lag_monitoring_alerts_enabled:
    title: 'S3 replication: Lag Monitoring Alerts Enabled'
    severity: medium
  aws.s3.website_https_only.website_https_only_configured:
    title: 'S3 website https only: Website Https Only Configured'
    severity: medium
