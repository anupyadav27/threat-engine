version: '1.0'
provider: aws
service: glue
services:
  client: glue
  module: boto3.client
discovery:
- discovery_id: aws.glue.get_data_catalog_encryption_settings
  calls:
  - action: get_data_catalog_encryption_settings
    save_as: response
  emit:
    item:
      EncryptionAtRest: '{{ response.DataCatalogEncryptionSettings.EncryptionAtRest
        }}'
      ConnectionPasswordEncryption: '{{ response.DataCatalogEncryptionSettings.ConnectionPasswordEncryption
        }}'
      DataCatalogEncryptionSettings: '{{ resource.DataCatalogEncryptionSettings }}'
- discovery_id: aws.glue.list_data_quality_results
  calls:
  - action: list_data_quality_results
    save_as: response
  emit:
    items_for: '{{ response.Results }}'
    as: resource
    item:
      ResultId: '{{ resource.ResultId }}'
      DataSource: '{{ resource.DataSource }}'
      JobName: '{{ resource.JobName }}'
      JobRunId: '{{ resource.JobRunId }}'
      StartedOn: '{{ resource.StartedOn }}'
- discovery_id: aws.glue.get_data_quality_rule_recommendation_run
  calls:
  - action: get_data_quality_rule_recommendation_run
    save_as: response
  for_each: aws.glue.list_data_quality_results
  on_error: continue
  emit:
    item:
      GlueTable: '{{ response.DataSource.GlueTable }}'
      DataQualityGlueTable: '{{ response.DataSource.DataQualityGlueTable }}'
      DataQualitySecurityConfiguration: '{{ resource.DataQualitySecurityConfiguration
        }}'
- discovery_id: aws.glue.get_dev_endpoints
  calls:
  - action: get_dev_endpoints
    save_as: response
  emit:
    item:
      EndpointName: '{{ response.DevEndpoints.EndpointName }}'
      RoleArn: '{{ response.DevEndpoints.RoleArn }}'
      SecurityGroupIds: '{{ response.DevEndpoints.SecurityGroupIds }}'
      SubnetId: '{{ response.DevEndpoints.SubnetId }}'
      YarnEndpointAddress: '{{ response.DevEndpoints.YarnEndpointAddress }}'
      PrivateAddress: '{{ response.DevEndpoints.PrivateAddress }}'
      ZeppelinRemoteSparkInterpreterPort: '{{ response.DevEndpoints.ZeppelinRemoteSparkInterpreterPort
        }}'
      PublicAddress: '{{ response.DevEndpoints.PublicAddress }}'
      Status: '{{ response.DevEndpoints.Status }}'
      WorkerType: '{{ response.DevEndpoints.WorkerType }}'
      GlueVersion: '{{ response.DevEndpoints.GlueVersion }}'
      NumberOfWorkers: '{{ response.DevEndpoints.NumberOfWorkers }}'
      NumberOfNodes: '{{ response.DevEndpoints.NumberOfNodes }}'
      AvailabilityZone: '{{ response.DevEndpoints.AvailabilityZone }}'
      VpcId: '{{ response.DevEndpoints.VpcId }}'
      ExtraPythonLibsS3Path: '{{ response.DevEndpoints.ExtraPythonLibsS3Path }}'
      ExtraJarsS3Path: '{{ response.DevEndpoints.ExtraJarsS3Path }}'
      FailureReason: '{{ response.DevEndpoints.FailureReason }}'
      LastUpdateStatus: '{{ response.DevEndpoints.LastUpdateStatus }}'
      CreatedTimestamp: '{{ response.DevEndpoints.CreatedTimestamp }}'
      LastModifiedTimestamp: '{{ response.DevEndpoints.LastModifiedTimestamp }}'
      PublicKey: '{{ response.DevEndpoints.PublicKey }}'
      PublicKeys: '{{ response.DevEndpoints.PublicKeys }}'
      SecurityConfiguration: '{{ response.DevEndpoints.SecurityConfiguration }}'
      Arguments: '{{ response.DevEndpoints.Arguments }}'
- discovery_id: aws.glue.get_job_runs
  calls:
  - action: get_job_runs
    save_as: response
    params:
      JobName: '{{ item.JobName }}'
  for_each: aws.glue.list_data_quality_results
  on_error: continue
  emit:
    item:
      Id: '{{ response.JobRuns.Id }}'
      Attempt: '{{ response.JobRuns.Attempt }}'
      PreviousRunId: '{{ response.JobRuns.PreviousRunId }}'
      TriggerName: '{{ response.JobRuns.TriggerName }}'
      JobName: '{{ response.JobRuns.JobName }}'
      JobMode: '{{ response.JobRuns.JobMode }}'
      JobRunQueuingEnabled: '{{ response.JobRuns.JobRunQueuingEnabled }}'
      StartedOn: '{{ response.JobRuns.StartedOn }}'
      LastModifiedOn: '{{ response.JobRuns.LastModifiedOn }}'
      CompletedOn: '{{ response.JobRuns.CompletedOn }}'
      JobRunState: '{{ response.JobRuns.JobRunState }}'
      Arguments: '{{ response.JobRuns.Arguments }}'
      ErrorMessage: '{{ response.JobRuns.ErrorMessage }}'
      PredecessorRuns: '{{ response.JobRuns.PredecessorRuns }}'
      AllocatedCapacity: '{{ response.JobRuns.AllocatedCapacity }}'
      ExecutionTime: '{{ response.JobRuns.ExecutionTime }}'
      Timeout: '{{ response.JobRuns.Timeout }}'
      MaxCapacity: '{{ response.JobRuns.MaxCapacity }}'
      WorkerType: '{{ response.JobRuns.WorkerType }}'
      NumberOfWorkers: '{{ response.JobRuns.NumberOfWorkers }}'
      SecurityConfiguration: '{{ response.JobRuns.SecurityConfiguration }}'
      LogGroupName: '{{ response.JobRuns.LogGroupName }}'
      NotificationProperty: '{{ response.JobRuns.NotificationProperty }}'
      GlueVersion: '{{ response.JobRuns.GlueVersion }}'
      DPUSeconds: '{{ response.JobRuns.DPUSeconds }}'
      ExecutionClass: '{{ response.JobRuns.ExecutionClass }}'
      MaintenanceWindow: '{{ response.JobRuns.MaintenanceWindow }}'
      ProfileName: '{{ response.JobRuns.ProfileName }}'
      StateDetail: '{{ response.JobRuns.StateDetail }}'
      ExecutionRoleSessionPolicy: '{{ response.JobRuns.ExecutionRoleSessionPolicy
        }}'
- discovery_id: aws.glue.get_unfiltered_table_metadata
  calls:
  - action: get_unfiltered_table_metadata
    save_as: response
  emit:
    item:
      Permissions: '{{ response.Permissions }}'
- discovery_id: aws.glue.get_connections
  calls:
  - action: get_connections
    save_as: response
  emit:
    item:
      Name: '{{ response.ConnectionList.Name }}'
      Description: '{{ response.ConnectionList.Description }}'
      ConnectionType: '{{ response.ConnectionList.ConnectionType }}'
      MatchCriteria: '{{ response.ConnectionList.MatchCriteria }}'
      ConnectionProperties: '{{ response.ConnectionList.ConnectionProperties }}'
      SparkProperties: '{{ response.ConnectionList.SparkProperties }}'
      AthenaProperties: '{{ response.ConnectionList.AthenaProperties }}'
      PythonProperties: '{{ response.ConnectionList.PythonProperties }}'
      PhysicalConnectionRequirements: '{{ response.ConnectionList.PhysicalConnectionRequirements
        }}'
      CreationTime: '{{ response.ConnectionList.CreationTime }}'
      LastUpdatedTime: '{{ response.ConnectionList.LastUpdatedTime }}'
      LastUpdatedBy: '{{ response.ConnectionList.LastUpdatedBy }}'
      Status: '{{ response.ConnectionList.Status }}'
      StatusReason: '{{ response.ConnectionList.StatusReason }}'
      LastConnectionValidationTime: '{{ response.ConnectionList.LastConnectionValidationTime
        }}'
      AuthenticationConfiguration: '{{ response.ConnectionList.AuthenticationConfiguration
        }}'
      ConnectionSchemaVersion: '{{ response.ConnectionList.ConnectionSchemaVersion
        }}'
      CompatibleComputeEnvironments: '{{ response.ConnectionList.CompatibleComputeEnvironments
        }}'
- discovery_id: aws.glue.get_security_configurations
  calls:
  - action: get_security_configurations
    save_as: response
  emit:
    item:
      Name: '{{ response.SecurityConfigurations.Name }}'
      CreatedTimeStamp: '{{ response.SecurityConfigurations.CreatedTimeStamp }}'
      EncryptionConfiguration: '{{ response.SecurityConfigurations.EncryptionConfiguration
        }}'
- discovery_id: aws.glue.get_triggers
  calls:
  - action: get_triggers
    save_as: response
  emit:
    item:
      Name: '{{ response.Triggers.Name }}'
      WorkflowName: '{{ response.Triggers.WorkflowName }}'
      Id: '{{ response.Triggers.Id }}'
      Type: '{{ response.Triggers.Type }}'
      State: '{{ response.Triggers.State }}'
      Description: '{{ response.Triggers.Description }}'
      Schedule: '{{ response.Triggers.Schedule }}'
      Actions: '{{ response.Triggers.Actions }}'
      Predicate: '{{ response.Triggers.Predicate }}'
      EventBatchingCondition: '{{ response.Triggers.EventBatchingCondition }}'
- discovery_id: aws.glue.get_trigger
  calls:
  - action: get_trigger
    save_as: response
    params:
      Name: '{{ item.Name }}'
  for_each: aws.glue.get_triggers
  on_error: continue
  emit:
    item:
      Name: '{{ response.Trigger.Name }}'
      WorkflowName: '{{ response.Trigger.WorkflowName }}'
      Id: '{{ response.Trigger.Id }}'
      Type: '{{ response.Trigger.Type }}'
      State: '{{ response.Trigger.State }}'
      Description: '{{ response.Trigger.Description }}'
      Schedule: '{{ response.Trigger.Schedule }}'
      Actions: '{{ response.Trigger.Actions }}'
      Predicate: '{{ response.Trigger.Predicate }}'
      EventBatchingCondition: '{{ response.Trigger.EventBatchingCondition }}'
      Trigger: '{{ resource.Trigger }}'
- discovery_id: aws.glue.get_catalogs
  calls:
  - action: get_catalogs
    save_as: response
  emit:
    item:
      CatalogId: '{{ response.CatalogList.CatalogId }}'
      Name: '{{ response.CatalogList.Name }}'
      ResourceArn: '{{ response.CatalogList.ResourceArn }}'
      Description: '{{ response.CatalogList.Description }}'
      Parameters: '{{ response.CatalogList.Parameters }}'
      CreateTime: '{{ response.CatalogList.CreateTime }}'
      UpdateTime: '{{ response.CatalogList.UpdateTime }}'
      TargetRedshiftCatalog: '{{ response.CatalogList.TargetRedshiftCatalog }}'
      FederatedCatalog: '{{ response.CatalogList.FederatedCatalog }}'
      CatalogProperties: '{{ response.CatalogList.CatalogProperties }}'
      CreateTableDefaultPermissions: '{{ response.CatalogList.CreateTableDefaultPermissions
        }}'
      CreateDatabaseDefaultPermissions: '{{ response.CatalogList.CreateDatabaseDefaultPermissions
        }}'
      AllowFullTableExternalDataAccess: '{{ response.CatalogList.AllowFullTableExternalDataAccess
        }}'
- discovery_id: aws.glue.get_crawlers
  calls:
  - action: get_crawlers
    save_as: response
  emit:
    item:
      Name: '{{ response.Crawlers.Name }}'
      Role: '{{ response.Crawlers.Role }}'
      Targets: '{{ response.Crawlers.Targets }}'
      DatabaseName: '{{ response.Crawlers.DatabaseName }}'
      Description: '{{ response.Crawlers.Description }}'
      Classifiers: '{{ response.Crawlers.Classifiers }}'
      RecrawlPolicy: '{{ response.Crawlers.RecrawlPolicy }}'
      SchemaChangePolicy: '{{ response.Crawlers.SchemaChangePolicy }}'
      LineageConfiguration: '{{ response.Crawlers.LineageConfiguration }}'
      State: '{{ response.Crawlers.State }}'
      TablePrefix: '{{ response.Crawlers.TablePrefix }}'
      Schedule: '{{ response.Crawlers.Schedule }}'
      CrawlElapsedTime: '{{ response.Crawlers.CrawlElapsedTime }}'
      CreationTime: '{{ response.Crawlers.CreationTime }}'
      LastUpdated: '{{ response.Crawlers.LastUpdated }}'
      LastCrawl: '{{ response.Crawlers.LastCrawl }}'
      Version: '{{ response.Crawlers.Version }}'
      Configuration: '{{ response.Crawlers.Configuration }}'
      CrawlerSecurityConfiguration: '{{ response.Crawlers.CrawlerSecurityConfiguration
        }}'
      LakeFormationConfiguration: '{{ response.Crawlers.LakeFormationConfiguration
        }}'
- discovery_id: aws.glue.get_usage_profile
  calls:
  - action: get_usage_profile
    save_as: response
    params:
      Name: '{{ item.Name }}'
  for_each: aws.glue.get_security_configurations
  on_error: continue
  emit:
    item:
      SessionConfiguration: '{{ response.Configuration.SessionConfiguration }}'
      JobConfiguration: '{{ response.Configuration.JobConfiguration }}'
- discovery_id: aws.glue.get_jobs
  calls:
  - action: get_jobs
    save_as: response
  emit:
    item:
      Name: '{{ response.Jobs.Name }}'
      JobMode: '{{ response.Jobs.JobMode }}'
      JobRunQueuingEnabled: '{{ response.Jobs.JobRunQueuingEnabled }}'
      Description: '{{ response.Jobs.Description }}'
      LogUri: '{{ response.Jobs.LogUri }}'
      Role: '{{ response.Jobs.Role }}'
      CreatedOn: '{{ response.Jobs.CreatedOn }}'
      LastModifiedOn: '{{ response.Jobs.LastModifiedOn }}'
      ExecutionProperty: '{{ response.Jobs.ExecutionProperty }}'
      Command: '{{ response.Jobs.Command }}'
      DefaultArguments: '{{ response.Jobs.DefaultArguments }}'
      NonOverridableArguments: '{{ response.Jobs.NonOverridableArguments }}'
      Connections: '{{ response.Jobs.Connections }}'
      MaxRetries: '{{ response.Jobs.MaxRetries }}'
      AllocatedCapacity: '{{ response.Jobs.AllocatedCapacity }}'
      Timeout: '{{ response.Jobs.Timeout }}'
      MaxCapacity: '{{ response.Jobs.MaxCapacity }}'
      WorkerType: '{{ response.Jobs.WorkerType }}'
      NumberOfWorkers: '{{ response.Jobs.NumberOfWorkers }}'
      SecurityConfiguration: '{{ response.Jobs.SecurityConfiguration }}'
      NotificationProperty: '{{ response.Jobs.NotificationProperty }}'
      GlueVersion: '{{ response.Jobs.GlueVersion }}'
      CodeGenConfigurationNodes: '{{ response.Jobs.CodeGenConfigurationNodes }}'
      ExecutionClass: '{{ response.Jobs.ExecutionClass }}'
      SourceControlDetails: '{{ response.Jobs.SourceControlDetails }}'
      MaintenanceWindow: '{{ response.Jobs.MaintenanceWindow }}'
      ProfileName: '{{ response.Jobs.ProfileName }}'
- discovery_id: aws.glue.list_crawls
  calls:
  - action: list_crawls
    save_as: response
  emit:
    items_for: '{{ response.Crawls }}'
    as: resource
    item:
      CrawlId: '{{ resource.CrawlId }}'
      State: '{{ resource.State }}'
      StartTime: '{{ resource.StartTime }}'
      EndTime: '{{ resource.EndTime }}'
      Summary: '{{ resource.Summary }}'
      ErrorMessage: '{{ resource.ErrorMessage }}'
      LogGroup: '{{ resource.LogGroup }}'
      LogStream: '{{ resource.LogStream }}'
      MessagePrefix: '{{ resource.MessagePrefix }}'
      DPUHour: '{{ resource.DPUHour }}'
- discovery_id: aws.glue.get_databases
  calls:
  - action: get_databases
    save_as: response
  emit:
    item:
      Name: '{{ response.DatabaseList.Name }}'
      Description: '{{ response.DatabaseList.Description }}'
      LocationUri: '{{ response.DatabaseList.LocationUri }}'
      Parameters: '{{ response.DatabaseList.Parameters }}'
      CreateTime: '{{ response.DatabaseList.CreateTime }}'
      CreateTableDefaultPermissions: '{{ response.DatabaseList.CreateTableDefaultPermissions
        }}'
      TargetDatabase: '{{ response.DatabaseList.TargetDatabase }}'
      CatalogId: '{{ response.DatabaseList.CatalogId }}'
      FederatedDatabase: '{{ response.DatabaseList.FederatedDatabase }}'
      Database: '{{ resource.Database }}'
- discovery_id: aws.glue.get_workflow_run
  calls:
  - action: get_workflow_run
    save_as: response
  emit:
    item:
      Name: '{{ response.Run.Name }}'
      WorkflowRunId: '{{ response.Run.WorkflowRunId }}'
      PreviousRunId: '{{ response.Run.PreviousRunId }}'
      WorkflowRunProperties: '{{ response.Run.WorkflowRunProperties }}'
      StartedOn: '{{ response.Run.StartedOn }}'
      CompletedOn: '{{ response.Run.CompletedOn }}'
      Status: '{{ response.Run.Status }}'
      ErrorMessage: '{{ response.Run.ErrorMessage }}'
      Statistics: '{{ response.Run.Statistics }}'
      Graph: '{{ response.Run.Graph }}'
      StartingEventBatchCondition: '{{ response.Run.StartingEventBatchCondition }}'
- discovery_id: aws.glue.describe_connection_type
  calls:
  - action: describe_connection_type
    save_as: response
  emit:
    item:
      SupportedAuthenticationTypes: '{{ response.Capabilities.SupportedAuthenticationTypes
        }}'
      SupportedDataOperations: '{{ response.Capabilities.SupportedDataOperations }}'
      SupportedComputeEnvironments: '{{ response.Capabilities.SupportedComputeEnvironments
        }}'
      ConnectionOptions: '{{ resource.ConnectionOptions }}'
checks:
- rule_id: aws.glue.registry.metadata_encryption_enabled
  for_each: aws.glue.get_data_catalog_encryption_settings
  conditions:
    var: item.DataCatalogEncryptionSettings
    op: not_equals
    value: 'null'
- rule_id: aws.glue.table.access_logging_enabled
  for_each: aws.glue.get_data_quality_rule_recommendation_run
  conditions:
    var: item.GlueTable
    op: equals
    value: 'True'
- rule_id: aws.glue.devendpoint.no_public_access_configured
  for_each: aws.glue.get_dev_endpoints
  conditions:
    var: item.PublicAddress
    op: not_equals
    value: 'null'
- rule_id: aws.glue.job.policies_present_for_sensitive_fields_configured
  for_each: aws.glue.get_dev_endpoints
  conditions:
    var: item.SecurityConfiguration
    op: not_equals
    value: 'null'
- rule_id: aws.glue.job.execution_roles_least_privilege
  for_each: aws.glue.get_job_runs
  conditions:
    var: item.ExecutionRoleSessionPolicy
    op: not_equals
    value: 'null'
- rule_id: aws.glue.trigger.targets_least_privilege
  for_each: aws.glue.get_unfiltered_table_metadata
  conditions:
    var: item.Permissions
    op: not_equals
    value: 'null'
- rule_id: aws.glue.data_quality_ruleset.execution_role_least_privilege
  for_each: aws.glue.get_job_runs
  conditions:
    var: item.ExecutionRoleSessionPolicy
    op: not_equals
    value: 'null'
- rule_id: aws.glue.mltransform.network_private_only_configured
  for_each: aws.glue.get_dev_endpoints
  conditions:
    var: item.SecurityGroupIds
    op: not_equals
    value: 'null'
- rule_id: aws.glue.connection.credentials_in_secrets_manager_configured
  for_each: aws.glue.get_connections
  conditions:
    var: item.AuthenticationConfiguration
    op: not_equals
    value: 'null'
- rule_id: aws.glue.data_quality_ruleset.output_encrypted_private
  for_each: aws.glue.get_security_configurations
  conditions:
    var: item.EncryptionConfiguration
    op: not_equals
    value: 'null'
- rule_id: aws.glue.table.lifecycle_policy_configured
  for_each: aws.glue.get_unfiltered_table_metadata
  conditions:
    var: item.Permissions
    op: not_equals
    value: 'null'
- rule_id: aws.glue.data_quality_ruleset.output_location_private_and_encrypted
  for_each: aws.glue.get_data_catalog_encryption_settings
  conditions:
    var: item.EncryptionAtRest
    op: equals
    value: 'True'
- rule_id: aws.glue.database.rbac_least_privilege
  for_each: aws.glue.get_unfiltered_table_metadata
  conditions:
    var: item.Permissions
    op: not_equals
    value: 'null'
- rule_id: aws.glue.trigger.logging_enabled
  for_each: aws.glue.get_trigger
  conditions:
    var: item.Trigger
    op: not_equals
    value: 'null'
- rule_id: aws.glue.table.s3_encrypted_at_rest
  for_each: aws.glue.get_data_catalog_encryption_settings
  conditions:
    var: item.EncryptionAtRest
    op: equals
    value: 'True'
- rule_id: aws.glue.catalog.log_catalog_cross_account_sharing_review_required
  for_each: aws.glue.get_catalogs
  conditions:
    var: item.CatalogProperties
    op: not_equals
    value: 'null'
- rule_id: aws.glue.resource.dev_endpoints_logs_encrypted
  for_each: aws.glue.get_data_catalog_encryption_settings
  conditions:
    var: item.EncryptionAtRest
    op: equals
    value: 'true'
- rule_id: aws.glue.job.network_private_only_configured
  for_each: aws.glue.get_dev_endpoints
  conditions:
    var: item.SecurityConfiguration
    op: not_equals
    value: 'null'
- rule_id: aws.glue.resource.etl_jobs_job_bookmark_encryption_enabled
  for_each: aws.glue.get_security_configurations
  conditions:
    var: item.EncryptionConfiguration
    op: equals
    value: Enabled
- rule_id: aws.glue.devendpoint.encryption_at_rest_enabled
  for_each: aws.glue.get_data_catalog_encryption_settings
  conditions:
    var: item.EncryptionAtRest
    op: equals
    value: 'true'
- rule_id: aws.glue.resource.etl_jobs_cloudwatch_logs_encryption_enabled
  for_each: aws.glue.get_security_configurations
  conditions:
    var: item.EncryptionConfiguration
    op: not_equals
    value: 'null'
- rule_id: aws.glue.resource.dev_endpoints_bookmark_encrypted
  for_each: aws.glue.get_security_configurations
  conditions:
    var: item.EncryptionConfiguration
    op: not_equals
    value: 'null'
- rule_id: aws.glue.crawler.scope_restricted_to_allowlist_configured
  for_each: aws.glue.get_crawlers
  conditions:
    var: item.CrawlerSecurityConfiguration
    op: not_equals
    value: 'null'
- rule_id: aws.glue.classifier.rbac_least_privilege
  for_each: aws.glue.get_unfiltered_table_metadata
  conditions:
    var: item.Permissions
    op: not_equals
    value: 'null'
- rule_id: aws.glue.data_quality_ruleset.rbac_least_privilege
  for_each: aws.glue.get_unfiltered_table_metadata
  conditions:
    var: item.Permissions
    op: not_equals
    value: 'null'
- rule_id: aws.glue.database.metadata_encryption_enabled
  for_each: aws.glue.get_data_catalog_encryption_settings
  conditions:
    var: item.DataCatalogEncryptionSettings
    op: not_equals
    value: 'null'
- rule_id: aws.glue.datalineage.capture_enabled
  for_each: aws.glue.get_crawlers
  conditions:
    var: item.LineageConfiguration
    op: equals
    value: CaptureEnabled
- rule_id: aws.glue.job.logs_and_metrics_enabled
  for_each: aws.glue.get_usage_profile
  conditions:
    var: item.JobConfiguration
    op: not_equals
    value: 'null'
- rule_id: aws.glue.data_quality_ruleset.version_immutable_configured
  for_each: aws.glue.get_crawlers
  conditions:
    var: item.Version
    op: equals
    value: 'null'
- rule_id: aws.glue.schema.encryption_at_rest_enabled
  for_each: aws.glue.get_data_catalog_encryption_settings
  conditions:
    var: item.EncryptionAtRest
    op: equals
    value: 'true'
- rule_id: aws.glue.workflow.private_networking_enforced
  for_each: aws.glue.get_dev_endpoints
  conditions:
    var: item.SecurityGroupIds
    op: not_equals
    value: 'null'
- rule_id: aws.glue.table.s3_block_public_access_configured
  for_each: aws.glue.get_unfiltered_table_metadata
  conditions:
    var: item.Permissions
    op: not_equals
    value: 'null'
- rule_id: aws.glue.catalog.change_audit_logging_enabled
  for_each: aws.glue.get_catalogs
  conditions:
    var: item.CatalogProperties
    op: not_equals
    value: 'null'
- rule_id: aws.glue.job.role_least_privilege
  for_each: aws.glue.get_crawlers
  conditions:
    var: item.Role
    op: not_equals
    value: 'null'
- rule_id: aws.glue.table.access_policies_least_privilege
  for_each: aws.glue.get_unfiltered_table_metadata
  conditions:
    var: item.Permissions
    op: not_equals
    value: 'null'
- rule_id: aws.glue.catalog.log_catalog_store_encrypted
  for_each: aws.glue.get_data_catalog_encryption_settings
  conditions:
    var: item.DataCatalogEncryptionSettings
    op: contains
    value: ENCRYPTED
- rule_id: aws.glue.workflow.execution_roles_least_privilege
  for_each: aws.glue.get_unfiltered_table_metadata
  conditions:
    var: item.Permissions
    op: not_equals
    value: 'null'
- rule_id: aws.glue.classifier.source_trusted_configured
  for_each: aws.glue.get_dev_endpoints
  conditions:
    var: item.SecurityConfiguration
    op: not_equals
    value: 'null'
- rule_id: aws.glue.schema.immutability_enforced
  for_each: aws.glue.get_crawlers
  conditions:
    var: item.SchemaChangePolicy
    op: not_equals
    value: 'null'
- rule_id: aws.glue.job.outputs_encrypted
  for_each: aws.glue.get_security_configurations
  conditions:
    var: item.EncryptionConfiguration
    op: equals
    value: 'true'
- rule_id: aws.glue.registry.rbac_least_privilege
  for_each: aws.glue.get_unfiltered_table_metadata
  conditions:
    var: item.Permissions
    op: not_equals
    value: 'null'
- rule_id: aws.glue.database.cross_account_sharing_review_required
  for_each: aws.glue.get_dev_endpoints
  conditions:
    var: item.SecurityConfiguration
    op: not_equals
    value: 'null'
- rule_id: aws.glue.partition.catalog_glue_catalog_encrypted
  for_each: aws.glue.get_data_catalog_encryption_settings
  conditions:
    var: item.DataCatalogEncryptionSettings
    op: contains
    value: ENCRYPTED
- rule_id: aws.glue.data_quality_ruleset.encryption_at_rest_enabled
  for_each: aws.glue.get_data_catalog_encryption_settings
  conditions:
    var: item.EncryptionAtRest
    op: equals
    value: 'True'
- rule_id: aws.glue.mltransform.role_least_privilege
  for_each: aws.glue.get_crawlers
  conditions:
    var: item.Role
    op: not_equals
    value: 'null'
- rule_id: aws.glue.database.update_rbac_least_privilege
  for_each: aws.glue.get_unfiltered_table_metadata
  conditions:
    var: item.Permissions
    op: not_equals
    value: 'null'
- rule_id: aws.glue.crawler.role_least_privilege
  for_each: aws.glue.get_crawlers
  conditions:
    var: item.Role
    op: not_equals
    value: 'null'
- rule_id: aws.glue.data_quality_ruleset.role_least_privilege
  for_each: aws.glue.get_crawlers
  conditions:
    var: item.Role
    op: not_equals
    value: 'null'
- rule_id: aws.glue.workflow.artifacts_private_and_encrypted
  for_each: aws.glue.get_security_configurations
  conditions:
    var: item.EncryptionConfiguration
    op: equals
    value: ENABLED
- rule_id: aws.glue.mltransform.logging_enabled
  for_each: aws.glue.get_jobs
  conditions:
    var: item.JobRunQueuingEnabled
    op: equals
    value: 'true'
- rule_id: aws.glue.resource.etl_jobs_logging_enabled
  for_each: aws.glue.list_crawls
  conditions:
    var: item.LogGroup
    op: not_equals
    value: 'null'
- rule_id: aws.glue.data_quality_ruleset.version_pinned_configured
  for_each: aws.glue.get_crawlers
  conditions:
    var: item.Version
    op: not_equals
    value: 'null'
- rule_id: aws.glue.registry.cross_account_sharing_restricted
  for_each: aws.glue.get_dev_endpoints
  conditions:
    var: item.SecurityConfiguration
    op: not_equals
    value: 'null'
- rule_id: aws.glue.classifier.definition_version_pinned_configured
  for_each: aws.glue.get_crawlers
  conditions:
    var: item.Version
    op: not_equals
    value: 'null'
- rule_id: aws.glue.data_quality_ruleset.logging_enabled
  for_each: aws.glue.get_jobs
  conditions:
    var: item.JobRunQueuingEnabled
    op: equals
    value: 'True'
- rule_id: aws.glue.table.encryption_at_rest_enabled
  for_each: aws.glue.get_data_catalog_encryption_settings
  conditions:
    var: item.EncryptionAtRest
    op: equals
    value: 'True'
- rule_id: aws.glue.resource.data_catalogs_metadata_encryption_enabled
  for_each: aws.glue.get_data_catalog_encryption_settings
  conditions:
    var: item.DataCatalogEncryptionSettings
    op: not_equals
    value: 'null'
- rule_id: aws.glue.database.audit_logging_enabled
  for_each: aws.glue.get_databases
  conditions:
    var: item.Database
    op: not_equals
    value: 'null'
- rule_id: aws.glue.data_quality_ruleset.definition_version_pinned_configured
  for_each: aws.glue.get_crawlers
  conditions:
    var: item.Version
    op: equals
    value: 'null'
- rule_id: aws.glue.table.column_level_access_controls_enabled
  for_each: aws.glue.get_catalogs
  conditions:
    var: item.CreateTableDefaultPermissions
    op: not_equals
    value: 'null'
- rule_id: aws.glue.partition.access_policies_least_privilege
  for_each: aws.glue.get_unfiltered_table_metadata
  conditions:
    var: item.Permissions
    op: not_equals
    value: 'null'
- rule_id: aws.glue.database.change_audit_logging_enabled
  for_each: aws.glue.get_crawlers
  conditions:
    var: item.LineageConfiguration
    op: equals
    value: 'True'
- rule_id: aws.glue.data_quality_ruleset.source_trusted_configured
  for_each: aws.glue.get_dev_endpoints
  conditions:
    var: item.SecurityConfiguration
    op: not_equals
    value: 'null'
- rule_id: aws.glue.resource.development_endpoints_s3_encryption_enabled
  for_each: aws.glue.get_data_catalog_encryption_settings
  conditions:
    var: item.EncryptionAtRest
    op: equals
    value: 'True'
- rule_id: aws.glue.resource.etl_jobs_amazon_s3_encryption_enabled
  for_each: aws.glue.get_data_catalog_encryption_settings
  conditions:
    var: item.EncryptionAtRest
    op: equals
    value: 'True'
- rule_id: aws.glue.schema.rbac_least_privilege
  for_each: aws.glue.get_unfiltered_table_metadata
  conditions:
    var: item.Permissions
    op: not_equals
    value: 'null'
- rule_id: aws.glue.datalineage.rbac_least_privilege
  for_each: aws.glue.get_unfiltered_table_metadata
  conditions:
    var: item.Permissions
    op: not_equals
    value: 'null'
- rule_id: aws.glue.job.script_location_private_and_encrypted
  for_each: aws.glue.get_security_configurations
  conditions:
    var: item.EncryptionConfiguration
    op: not_equals
    value: 'null'
- rule_id: aws.glue.table.public_sharing_disabled
  for_each: aws.glue.get_unfiltered_table_metadata
  conditions:
    var: item.Permissions
    op: not_equals
    value: 'null'
- rule_id: aws.glue.database.cross_account_sharing_restricted
  for_each: aws.glue.get_catalogs
  conditions:
    var: item.CreateDatabaseDefaultPermissions
    op: not_equals
    value: 'null'
- rule_id: aws.glue.workflow.logs_and_metrics_enabled
  for_each: aws.glue.get_workflow_run
  conditions:
    var: item.WorkflowRunProperties
    op: not_equals
    value: 'null'
- rule_id: aws.glue.database.policy_least_privilege
  for_each: aws.glue.get_unfiltered_table_metadata
  conditions:
    var: item.Permissions
    op: not_equals
    value: 'null'
- rule_id: aws.glue.workflow.kms_encryption_enabled
  for_each: aws.glue.get_security_configurations
  conditions:
    var: item.EncryptionConfiguration
    op: not_equals
    value: 'null'
- rule_id: aws.glue.data_quality_ruleset.run_metadata_logging_enabled
  for_each: aws.glue.get_data_quality_rule_recommendation_run
  conditions:
    var: item.DataQualitySecurityConfiguration
    op: not_equals
    value: 'null'
- rule_id: aws.glue.crawler.network_private_only_configured
  for_each: aws.glue.get_dev_endpoints
  conditions:
    var: item.SecurityGroupIds
    op: not_equals
    value: 'null'
- rule_id: aws.glue.job.s_private_networking_configured
  for_each: aws.glue.get_dev_endpoints
  conditions:
    var: item.SecurityGroupIds
    op: not_equals
    value: 'null'
- rule_id: aws.glue.connection.role_least_privilege
  for_each: aws.glue.get_crawlers
  conditions:
    var: item.Role
    op: not_equals
    value: 'null'
- rule_id: aws.glue.catalog.metadata_encryption_enabled
  for_each: aws.glue.get_data_catalog_encryption_settings
  conditions:
    var: item.DataCatalogEncryptionSettings
    op: not_equals
    value: 'null'
- rule_id: aws.glue.data_quality_ruleset.parameters_no_plaintext_secrets_configured
  for_each: aws.glue.get_catalogs
  conditions:
    var: item.Parameters
    op: not_equals
    value: 'null'
- rule_id: aws.glue.workflow.cross_account_trusts_restricted
  for_each: aws.glue.get_dev_endpoints
  conditions:
    var: item.SecurityConfiguration
    op: not_equals
    value: 'null'
- rule_id: aws.glue.data_catalogs_not_publicly_accessible.data_catalogs_not_publicly_accessible_configured
  for_each: aws.glue.get_catalogs
  conditions:
    var: item.AllowFullTableExternalDataAccess
    op: equals
    value: 'False'
- rule_id: aws.glue.resource.ml_transform_encrypted_at_rest
  for_each: aws.glue.get_data_catalog_encryption_settings
  conditions:
    var: item.EncryptionAtRest
    op: equals
    value: 'true'
- rule_id: aws.glue.data_quality_ruleset.outputs_encrypted_and_private
  for_each: aws.glue.get_data_catalog_encryption_settings
  conditions:
    var: item.DataCatalogEncryptionSettings
    op: not_equals
    value: 'null'
- rule_id: aws.glue.database.encryption_at_rest_enabled
  for_each: aws.glue.get_data_catalog_encryption_settings
  conditions:
    var: item.EncryptionAtRest
    op: equals
    value: 'true'
- rule_id: aws.glue.connection.private_networking_enforced
  for_each: aws.glue.get_dev_endpoints
  conditions:
    var: item.SecurityGroupIds
    op: not_equals
    value: 'null'
- rule_id: aws.glue.trigger.event_sources_restricted
  for_each: aws.glue.get_trigger
  conditions:
    var: item.Trigger
    op: not_equals
    value: 'null'
- rule_id: aws.glue.catalog.log_catalog_cross_account_sharing_restricted
  for_each: aws.glue.get_catalogs
  conditions:
    var: item.CatalogProperties
    op: not_equals
    value: 'null'
- rule_id: aws.glue.catalog.update_rbac_least_privilege
  for_each: aws.glue.get_dev_endpoints
  conditions:
    var: item.SecurityConfiguration
    op: not_equals
    value: 'null'
- rule_id: aws.glue.resource.catalog_passwords_encrypted
  for_each: aws.glue.get_data_catalog_encryption_settings
  conditions:
    var: item.DataCatalogEncryptionSettings
    op: not_equals
    value: 'null'
- rule_id: aws.glue.datalineage.export_destination_encrypted
  for_each: aws.glue.get_data_catalog_encryption_settings
  conditions:
    var: item.EncryptionAtRest
    op: equals
    value: 'true'
- rule_id: aws.glue.crawler.logging_enabled
  for_each: aws.glue.get_crawlers
  conditions:
    var: item.CrawlerSecurityConfiguration
    op: not_equals
    value: 'null'
- rule_id: aws.glue.data_quality_ruleset.jobs_role_least_privilege
  for_each: aws.glue.get_unfiltered_table_metadata
  conditions:
    var: item.Permissions
    op: not_equals
    value: 'null'
- rule_id: aws.glue.catalog.rbac_least_privilege
  for_each: aws.glue.get_dev_endpoints
  conditions:
    var: item.SecurityConfiguration
    op: not_equals
    value: 'null'
- rule_id: aws.glue.catalog.audit_logging_enabled
  for_each: aws.glue.get_catalogs
  conditions:
    var: item.CatalogProperties
    op: not_equals
    value: 'null'
- rule_id: aws.glue.workflow.execution_role_least_privilege
  for_each: aws.glue.get_crawlers
  conditions:
    var: item.Role
    op: not_equals
    value: 'null'
- rule_id: aws.glue.connection.tls_required
  for_each: aws.glue.describe_connection_type
  conditions:
    var: item.ConnectionOptions
    op: contains
    value: tls=true
- rule_id: aws.glue.devendpoint.role_least_privilege
  for_each: aws.glue.get_crawlers
  conditions:
    var: item.Role
    op: not_equals
    value: 'null'
