version: '1.0'
provider: aws
service: kinesisanalytics
services:
  client: kinesisanalytics
  module: boto3.client
discovery:
- discovery_id: aws.kinesisanalytics.list_applications
  calls:
  - action: list_applications
    save_as: response
  emit:
    items_for: '{{ response.ApplicationSummaries }}'
    as: resource
    item:
      ApplicationName: '{{ resource.ApplicationName }}'
      ApplicationARN: '{{ resource.ApplicationARN }}'
      ApplicationStatus: '{{ resource.ApplicationStatus }}'
checks:
- rule_id: aws.kinesisanalytics.application.network_private_only_configured
  for_each: aws.kinesisanalytics.list_applications
  conditions:
    var: item.ApplicationStatus
    op: equals
    value: ACTIVE
