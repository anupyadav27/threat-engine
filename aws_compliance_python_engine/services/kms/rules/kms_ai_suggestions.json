[
  {
    "rule_id": "aws.kms.alias.points_to_active_key_configured",
    "suggested_condition": {
      "var": "item.KeyId",
      "op": "not_equals",
      "value": "null",
      "reasoning": "The KeyId field is used to verify that the KMS alias points to an active key. The 'not_equals' operator is appropriate here to ensure that the KeyId is not null, indicating that an active key is configured.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.alias.logging_enabled",
    "suggested_condition": {
      "var": "item.Enabled",
      "op": "equals",
      "value": true,
      "reasoning": "The 'Enabled' field is used to check if logging is enabled for the KMS alias, which aligns with the security rule's requirement for logging to be enabled.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.key.state_change_monitoring_enabled",
    "suggested_condition": {
      "var": "item.KeyRotationEnabled",
      "op": "equals",
      "value": true,
      "reasoning": "The KeyRotationEnabled field is relevant for ensuring that KMS key rotation is enabled, which is part of the monitoring and alerting configuration for security compliance.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.key.certificate_expiration_configured",
    "suggested_condition": {
      "var": "item.KeyRotationEnabled",
      "op": "equals",
      "value": true,
      "reasoning": "The KeyRotationEnabled field checks if key rotation is enabled for the KMS key, which aligns with ensuring proper security compliance for certificate expiration.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.key.mtls_required_for_internal_services_if_supported",
    "suggested_condition": {
      "var": "item.KeyUsage",
      "op": "equals",
      "value": "ENCRYPT_DECRYPT",
      "reasoning": "The KeyUsage field indicates the intended use of the KMS key, and for internal services, it should support encryption and decryption. The operator 'equals' is appropriate to check if the key is configured for this purpose.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.key.tls_min_1_2_enforced",
    "suggested_condition": {
      "var": "item.KeyRotationEnabled",
      "op": "equals",
      "value": true,
      "reasoning": "The KeyRotationEnabled field is relevant for ensuring that KMS keys have proper security configurations, including TLS settings. Enforcing TLS min 1.2 would typically be part of a broader security practice that includes key rotation.",
      "confidence": 0.8
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 0.8,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.key.multi_region_disabled",
    "suggested_condition": {
      "var": "item.MultiRegion",
      "op": "equals",
      "value": "false",
      "reasoning": "The field 'MultiRegion' is used to check if the KMS key is multi-region enabled or disabled. The operator 'equals' is appropriate to verify that it is set to 'false' for compliance with the security rule.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.key.in_transit_tls_min_1_2_configured",
    "suggested_condition": {
      "var": "item.KeyUsage",
      "op": "equals",
      "value": "ENCRYPT_DECRYPT",
      "reasoning": "The KeyUsage field is relevant as it specifies the intended use of the KMS key, and we are checking if it is configured for encryption and decryption, which is essential for TLS communication.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.grant.lessthan_wildcard_permissions_configured",
    "suggested_condition": {
      "var": "item.Constraints",
      "op": "not_equals",
      "value": "null",
      "reasoning": "The Constraints field is relevant for checking if there are any wildcard permissions configured for the KMS grant. Using 'not_equals' with 'null' checks if constraints are present, which is necessary for compliance.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.key.at_rest_cmek_enabled",
    "suggested_condition": {
      "var": "item.KeyManager",
      "op": "equals",
      "value": "CUSTOMER",
      "reasoning": "The KeyManager field indicates whether the key is managed by AWS or the customer. For at rest CMK (Customer Managed Key) to be enabled, it should be set to CUSTOMER.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.key.not_scheduled_for_deletion_configured",
    "suggested_condition": {
      "var": "item.KeyState",
      "op": "not_equals",
      "value": "PendingDeletion",
      "reasoning": "The KeyState field is relevant for checking if the KMS key is scheduled for deletion. Using 'not_equals' with the value 'PendingDeletion' ensures that the key is not in a state that indicates it is scheduled for deletion.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.grant.ee_principal_valid",
    "suggested_condition": {
      "var": "item.GranteePrincipal",
      "op": "not_equals",
      "value": "null",
      "reasoning": "The GranteePrincipal field is relevant to check if the principal is valid for the KMS grant. Using 'not_equals' with 'null' ensures that a principal is defined.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.key.rotation_enabled",
    "suggested_condition": {
      "var": "item.KeyRotationEnabled",
      "op": "equals",
      "value": true,
      "reasoning": "The field 'KeyRotationEnabled' is used to check if key rotation is enabled for the KMS key, which aligns with the security rule's requirement for proper configuration.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.alias.default_keys_disabled_if_cmek_required",
    "suggested_condition": {
      "var": "item.Enabled",
      "op": "equals",
      "value": false,
      "reasoning": "The field 'Enabled' is used to check if the KMS alias has default keys disabled, which is a requirement for the compliance rule.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.key.customer_managed_keys_in_use",
    "suggested_condition": {
      "var": "item.KeyManager",
      "op": "equals",
      "value": "CUSTOMER",
      "reasoning": "The KeyManager field indicates whether the key is managed by the customer or AWS. For the security rule to ensure customer-managed keys are in use, we check if KeyManager equals 'CUSTOMER'.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.alias.key_has_alias_configured",
    "suggested_condition": {
      "var": "item.KeyArn",
      "op": "exists",
      "value": null,
      "reasoning": "The KeyArn field is relevant for checking if a KMS alias has an associated key. The 'exists' operator is appropriate to verify the presence of a key.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.key.deletion_requires_waiting_period_configured",
    "suggested_condition": {
      "var": "item.PendingDeletionWindowInDays",
      "op": "not_equals",
      "value": "null",
      "reasoning": "The field 'PendingDeletionWindowInDays' is relevant to check if a KMS key has a deletion waiting period configured. Using 'not_equals' with 'null' checks if this configuration exists.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.key.logging_enabled",
    "suggested_condition": {
      "var": "item.Enabled",
      "op": "equals",
      "value": true,
      "reasoning": "The field 'Enabled' is used to check if logging is enabled for the KMS key, which is essential for compliance with the logging requirement.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.key.not_pending_deletion",
    "suggested_condition": {
      "var": "item.KeyState",
      "op": "not_equals",
      "value": "PendingDeletion",
      "reasoning": "The field 'KeyState' is used to check the state of the KMS key, and we want to ensure it is not in the 'PendingDeletion' state.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.key.not_publicly_accessible_configured",
    "suggested_condition": {
      "var": "item.KeyState",
      "op": "not_equals",
      "value": "Enabled",
      "reasoning": "The KeyState field is used to determine if the KMS key is publicly accessible. If the key state is not 'Enabled', it indicates that the key may not be properly configured for public access.",
      "confidence": 0.9
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 0.9,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.key.default_keys_disabled_if_cmek_required",
    "suggested_condition": {
      "var": "item.KeyManager",
      "op": "equals",
      "value": "CUSTOMER",
      "reasoning": "The KeyManager field indicates whether the key is customer-managed. The rule requires that default keys are disabled if customer-managed encryption keys (CMEK) are required, hence checking if the KeyManager is set to CUSTOMER.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.grant.constraints_present",
    "suggested_condition": {
      "var": "item.Constraints",
      "op": "not_equals",
      "value": "null",
      "reasoning": "The Constraints field is relevant for checking if the KMS grant has constraints present. Using 'not_equals' with 'null' checks if constraints are properly configured.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.key.lifecycle_policy_configured",
    "suggested_condition": {
      "var": "item.KeyRotationEnabled",
      "op": "equals",
      "value": true,
      "reasoning": "The KeyRotationEnabled field is relevant for checking if a KMS key has a lifecycle policy configured, as enabling key rotation is part of proper key management practices.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  },
  {
    "rule_id": "aws.kms.key.policy_least_privilege",
    "suggested_condition": {
      "var": "item.Policy",
      "op": "not_equals",
      "value": "null",
      "reasoning": "The Policy field is relevant for checking if the KMS key has a policy that adheres to the least privilege principle. Using 'not_equals' with 'null' checks if a policy is defined.",
      "confidence": 1.0
    },
    "fields_analyzed": 65,
    "total_fields": 65,
    "confidence": 1.0,
    "passes": 1,
    "success": true
  }
]