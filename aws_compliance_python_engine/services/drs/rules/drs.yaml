version: 1.0
provider: aws
service: drs
discovery:
  discovery_id: aws.drs.resources
  calls:
    - client: drs
      action: describe_drss
      paginate: true
  fields:
    - name: id
      save_as: resource_id
  emit:
    items_for:
      as: resource
      item: resource_id
checks:
  - title: Dr Plan Documented
    severity: low
    rule_id: aws.drs.replication.dr_plan_documented
    assertion_id: resilience_recovery.disaster_recovery.dr_plan_documented
    for_each:
      as: resource
      item: resource_id
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement dr plan documented for drs"
    references:
      - "https://docs.aws.amazon.com/drs/"
  - title: Dr Plan Documented
    severity: low
    rule_id: aws.drs.replication_configuration.dr_plan_documented
    assertion_id: resilience_recovery.disaster_recovery.dr_plan_documented
    for_each:
      as: resource
      item: resource_id
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement dr plan documented for drs"
    references:
      - "https://docs.aws.amazon.com/drs/"
  - title: Rto Rpo Defined
    severity: low
    rule_id: aws.drs.replication.rto_rpo_defined
    assertion_id: resilience_recovery.disaster_recovery.rto_rpo_defined
    for_each:
      as: resource
      item: resource_id
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement rto rpo defined for drs"
    references:
      - "https://docs.aws.amazon.com/drs/"
  - title: Rto Rpo Defined
    severity: low
    rule_id: aws.drs.replication_configuration.rto_rpo_defined
    assertion_id: resilience_recovery.disaster_recovery.rto_rpo_defined
    for_each:
      as: resource
      item: resource_id
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement rto rpo defined for drs"
    references:
      - "https://docs.aws.amazon.com/drs/"
  - title: Cross Region Replication Enabled
    severity: low
    rule_id: aws.drs.replication.cross_region_replication_enabled
    assertion_id: resilience_recovery.disaster_recovery.cross_region_replication_enabled
    for_each:
      as: resource
      item: resource_id
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement cross region replication enabled for drs"
    references:
      - "https://docs.aws.amazon.com/drs/"
  - title: Cross Region Replication Enabled
    severity: low
    rule_id: aws.drs.replication_configuration.cross_region_replication_enabled
    assertion_id: resilience_recovery.disaster_recovery.cross_region_replication_enabled
    for_each:
      as: resource
      item: resource_id
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement cross region replication enabled for drs"
    references:
      - "https://docs.aws.amazon.com/drs/"
  - title: Dr Drills Conducted
    severity: low
    rule_id: aws.drs.recovery_testing.dr_drills_conducted
    assertion_id: resilience_recovery.recovery_testing.dr_drills_conducted
    for_each:
      as: resource
      item: resource_id
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement dr drills conducted for drs"
    references:
      - "https://docs.aws.amazon.com/drs/"
  - title: Dr Drills Conducted
    severity: low
    rule_id: aws.drs.recovery.dr_drills_conducted
    assertion_id: resilience_recovery.recovery_testing.dr_drills_conducted
    for_each:
      as: resource
      item: resource_id
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement dr drills conducted for drs"
    references:
      - "https://docs.aws.amazon.com/drs/"
  - title: Backup Restoration Tested
    severity: low
    rule_id: aws.drs.recovery_testing.backup_restoration_tested
    assertion_id: resilience_recovery.recovery_testing.backup_restoration_tested
    for_each:
      as: resource
      item: resource_id
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement backup restoration tested for drs"
    references:
      - "https://docs.aws.amazon.com/drs/"
  - title: Backup Restoration Tested
    severity: low
    rule_id: aws.drs.recovery.backup_restoration_tested
    assertion_id: resilience_recovery.recovery_testing.backup_restoration_tested
    for_each:
      as: resource
      item: resource_id
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement backup restoration tested for drs"
    references:
      - "https://docs.aws.amazon.com/drs/"
