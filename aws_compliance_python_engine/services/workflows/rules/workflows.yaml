# WARNING: 'workflows' is not a valid standalone AWS service
# This service should be removed or merged with the correct service
# Generated: 2025-11-25 12:07:29
# Status: INVALID

version: '1.0'
provider: aws
service: workflows
discovery:
- discovery_id: aws.workflows.workflows
  calls:
  - client: workflows
    action: list_workflowss
    save_as: workflow_list
    on_error: continue
    fields:
    - Workflowss
  emit:
    items_for: workflow_list[]
    as: workflow
    item:
      id: '{{ workflow.Id }}'
      name: '{{ workflow.Name }}'
- discovery_id: aws.workflows.workflow_encryption
  for_each: aws.workflows.workflows
  calls:
  - client: workflows
    action: list_workflowss
    params:
      WorkflowId: '{{ item.id }}'
    save_as: encryption
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      encryption_enabled: '{{ encryption.Encrypted if encryption.Encrypted is defined else false }}'
- discovery_id: aws.workflows.workflow_logging
  for_each: aws.workflows.workflows
  calls:
  - client: workflows
    action: describe_workflow_logging
    params:
      WorkflowId: '{{ item.id }}'
    save_as: logging
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      logging_enabled: '{{ logging.LoggingEnabled is defined if logging else false }}'
checks:
- title: 'WORKFLOWS workflow: Workflows Integrations Least Privilege'
  severity: high
  rule_id: aws.workflows.workflow.workflows_integrations_least_privilege
  for_each:
    discovery: aws.workflows.workflows
    as: workflow
    item: workflow
  conditions:
    var: workflow.is_public
    op: equals
    value: false
  remediation: "Restrict public access for workflows workflow:\n\n1. Open WORKFLOWS console\n2. Select the workflow\n3. Go\
    \ to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n• Use IAM roles instead of access keys\n• Implement condition\
    \ keys for additional security\n• Enable MFA for sensitive operations\n• Regularly audit access permissions\n• Use AWS\
    \ Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'WORKFLOWS workflow: Kms Encryption Enabled'
  severity: high
  rule_id: aws.workflows.workflow.kms_encryption_enabled
  for_each:
    discovery: aws.workflows.workflow_encryption
    as: workflow
    item: workflow
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for workflows workflow:\n\n1. Open WORKFLOWS console\n2. Select the workflow\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws workflows modify-workflow --workflow-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n• Use customer-managed KMS keys for sensitive data\n\
    • Enable automatic key rotation\n• Implement proper key access policies\n• Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'WORKFLOWS workflow: Workflows Artifacts Encrypted And Private'
  severity: high
  rule_id: aws.workflows.workflow.workflows_artifacts_encrypted_and_private
  for_each:
    discovery: aws.workflows.workflow_encryption
    as: workflow
    item: workflow
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for workflows workflow:\n\n1. Open WORKFLOWS console\n2. Select the workflow\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws workflows modify-workflow --workflow-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n• Use customer-managed KMS keys for sensitive data\n\
    • Enable automatic key rotation\n• Implement proper key access policies\n• Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'WORKFLOWS workflow: Workflows Approval Steps Required For Destructive Actions'
  severity: medium
  rule_id: aws.workflows.workflow.workflows_approval_steps_required_for_destructive_actions
  for_each:
    discovery: aws.workflows.workflows
    as: workflow
    item: workflow
  conditions:
    var: workflow.compliant
    op: equals
    value: true
  remediation: 'Configure workflows workflow for compliance:


    Requirement: Workflows Approval Steps Required For Destructive Actions


    Description: Verifies security configuration for AWS WORKFLOWS workflow to ensure alignment with AWS security best practices
    and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall
    security posture.


    Steps:

    1. Open WORKFLOWS console

    2. Select the workflow

    3. Review security configuration

    4. Apply required settings per organizational policy

    5. Verify compliance

    6. Save changes


    General Security Recommendations:

    • Follow AWS Well-Architected Framework

    • Implement defense in depth

    • Enable logging and monitoring

    • Use encryption where applicable

    • Regular security audits'
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'WORKFLOWS workflow: Execution Roles Least Privilege'
  severity: high
  rule_id: aws.workflows.workflow.execution_roles_least_privilege
  for_each:
    discovery: aws.workflows.workflows
    as: workflow
    item: workflow
  conditions:
    var: workflow.is_public
    op: equals
    value: false
  remediation: "Restrict public access for workflows workflow:\n\n1. Open WORKFLOWS console\n2. Select the workflow\n3. Go\
    \ to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n• Use IAM roles instead of access keys\n• Implement condition\
    \ keys for additional security\n• Enable MFA for sensitive operations\n• Regularly audit access permissions\n• Use AWS\
    \ Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'WORKFLOWS workflow: Change Audit Logging Enabled'
  severity: medium
  rule_id: aws.workflows.workflow.change_audit_logging_enabled
  for_each:
    discovery: aws.workflows.workflow_logging
    as: workflow
    item: workflow
  conditions:
    var: logging.logging_enabled
    op: equals
    value: true
  remediation: "Enable logging for workflows workflow:\n\n1. Open WORKFLOWS console\n2. Select the workflow\n3. Go to Logging/Monitoring\
    \ settings\n4. Enable logging\n5. Configure log destination:\n   - CloudWatch Logs\n   - S3 bucket (for long-term retention)\n\
    6. Set log level (INFO, DEBUG, ERROR)\n7. Save changes\n\nAWS CLI:\naws workflows update-workflow-logging --workflow-id\
    \ <id> --logging-enabled\n\nBest Practices:\n• Enable all security-relevant log types\n• Send logs to centralized logging\
    \ service\n• Set appropriate retention periods\n• Configure log encryption\n• Set up log monitoring and alerting"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
