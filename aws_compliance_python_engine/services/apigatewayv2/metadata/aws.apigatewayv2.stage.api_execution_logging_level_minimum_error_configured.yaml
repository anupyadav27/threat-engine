rule_id: aws.apigatewayv2.stage.api_execution_logging_level_minimum_error_configured
service: apigatewayv2
resource: stage
requirement: Activity Logging
title: 'APIGATEWAYV2 stage: Api Execution Logging Level Minimum Error Configured'
scope: apigatewayv2.stage.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
rationale: Ensures apigatewayv2 stage has api execution logging level minimum error
  configured properly configured for security compliance.
severity: medium
assertion_id: logging_monitoring.logging.apigatewayv2_stage_api_execution_logging_level_minimum_error_configured
source: expert_generated
description: Checks that AWS APIGATEWAYV2 stage has comprehensive audit logging enabled
  to capture API calls, configuration changes, and administrative actions. Logging
  is essential for security monitoring, incident investigation, compliance auditing,
  and establishing accountability through non-repudiation.
references:
- https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
remediation: "Enable logging for apigatewayv2 stage:\n\n1. Open APIGATEWAYV2 console\n\
  2. Select the stage\n3. Go to Logging/Monitoring settings\n4. Enable logging\n5.\
  \ Configure log destination:\n   - CloudWatch Logs\n   - S3 bucket (for long-term\
  \ retention)\n6. Set log level (INFO, DEBUG, ERROR)\n7. Save changes\n\nAWS CLI:\n\
  aws apigatewayv2 update-stage-logging --stage-id <id> --logging-enabled\n\nBest\
  \ Practices:\n• Enable all security-relevant log types\n• Send logs to centralized\
  \ logging service\n• Set appropriate retention periods\n• Configure log encryption\n\
  • Set up log monitoring and alerting"
