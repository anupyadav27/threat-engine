version: '1.0'
provider: aws
service: eip
services:
  client: eip
  module: boto3.client
discovery:
- discovery_id: aws.eip.describe_address_transfers
  calls:
  - action: describe_address_transfers
    save_as: response
  emit:
    item:
      PublicIp: '{{ response.AddressTransfers.PublicIp }}'
      AllocationId: '{{ response.AddressTransfers.AllocationId }}'
      TransferAccountId: '{{ response.AddressTransfers.TransferAccountId }}'
      TransferOfferExpirationTimestamp: '{{ response.AddressTransfers.TransferOfferExpirationTimestamp
        }}'
      TransferOfferAcceptedTimestamp: '{{ response.AddressTransfers.TransferOfferAcceptedTimestamp
        }}'
      AddressTransferStatus: '{{ response.AddressTransfers.AddressTransferStatus }}'
checks:
- rule_id: aws.eip.address.address_enabled
  for_each: aws.eip.describe_address_transfers
  conditions:
    var: item.AddressTransferStatus
    op: equals
    value: accepted
