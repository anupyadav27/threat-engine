version: '1.0'
provider: aws
service: sagemaker
services:
  client: sagemaker
  module: boto3.client
discovery:
- discovery_id: aws.sagemaker.list_actions
  calls:
  - action: list_actions
    save_as: response
  emit:
    items_for: '{{ response.ActionSummaries }}'
    as: resource
    item:
      ActionArn: '{{ resource.ActionArn }}'
      ActionName: '{{ resource.ActionName }}'
      Source: '{{ resource.Source }}'
      ActionType: '{{ resource.ActionType }}'
      Status: '{{ resource.Status }}'
      CreationTime: '{{ resource.CreationTime }}'
      LastModifiedTime: '{{ resource.LastModifiedTime }}'
- discovery_id: aws.sagemaker.list_workteams
  calls:
  - action: list_workteams
    save_as: response
  emit:
    items_for: '{{ response.Workteams }}'
    as: resource
    item:
      WorkteamName: '{{ resource.WorkteamName }}'
      MemberDefinitions: '{{ resource.MemberDefinitions }}'
      WorkteamArn: '{{ resource.WorkteamArn }}'
      WorkforceArn: '{{ resource.WorkforceArn }}'
      ProductListingIds: '{{ resource.ProductListingIds }}'
      Description: '{{ resource.Description }}'
      SubDomain: '{{ resource.SubDomain }}'
      CreateDate: '{{ resource.CreateDate }}'
      LastUpdatedDate: '{{ resource.LastUpdatedDate }}'
      NotificationConfiguration: '{{ resource.NotificationConfiguration }}'
      WorkerAccessConfiguration: '{{ resource.WorkerAccessConfiguration }}'
- discovery_id: aws.sagemaker.describe_workteam
  calls:
  - action: describe_workteam
    save_as: response
    params:
      WorkteamName: '{{ item.WorkteamName }}'
  for_each: aws.sagemaker.list_workteams
  on_error: continue
  emit:
    item:
      WorkteamName: '{{ response.Workteam.WorkteamName }}'
      MemberDefinitions: '{{ response.Workteam.MemberDefinitions }}'
      WorkteamArn: '{{ response.Workteam.WorkteamArn }}'
      WorkforceArn: '{{ response.Workteam.WorkforceArn }}'
      ProductListingIds: '{{ response.Workteam.ProductListingIds }}'
      Description: '{{ response.Workteam.Description }}'
      SubDomain: '{{ response.Workteam.SubDomain }}'
      CreateDate: '{{ response.Workteam.CreateDate }}'
      LastUpdatedDate: '{{ response.Workteam.LastUpdatedDate }}'
      NotificationConfiguration: '{{ response.Workteam.NotificationConfiguration }}'
      WorkerAccessConfiguration: '{{ response.Workteam.WorkerAccessConfiguration }}'
      Workteam: '{{ resource.Workteam }}'
- discovery_id: aws.sagemaker.describe_auto_m_l_job_v2
  calls:
  - action: describe_auto_ml_job_v2
    save_as: response
  emit:
    item:
      ChannelType: '{{ response.AutoMLJobInputDataConfig.ChannelType }}'
      ContentType: '{{ response.AutoMLJobInputDataConfig.ContentType }}'
      CompressionType: '{{ response.AutoMLJobInputDataConfig.CompressionType }}'
      DataSource: '{{ response.AutoMLJobInputDataConfig.DataSource }}'
      SecurityConfig: '{{ resource.SecurityConfig }}'
      OutputDataConfig: '{{ resource.OutputDataConfig }}'
- discovery_id: aws.sagemaker.list_edge_packaging_jobs
  calls:
  - action: list_edge_packaging_jobs
    save_as: response
  emit:
    items_for: '{{ response.EdgePackagingJobSummaries }}'
    as: resource
    item:
      EdgePackagingJobArn: '{{ resource.EdgePackagingJobArn }}'
      EdgePackagingJobName: '{{ resource.EdgePackagingJobName }}'
      EdgePackagingJobStatus: '{{ resource.EdgePackagingJobStatus }}'
      CompilationJobName: '{{ resource.CompilationJobName }}'
      ModelName: '{{ resource.ModelName }}'
      ModelVersion: '{{ resource.ModelVersion }}'
      CreationTime: '{{ resource.CreationTime }}'
      LastModifiedTime: '{{ resource.LastModifiedTime }}'
- discovery_id: aws.sagemaker.describe_model
  calls:
  - action: describe_model
    save_as: response
    params:
      ModelName: '{{ item.ModelName }}'
  for_each: aws.sagemaker.list_edge_packaging_jobs
  on_error: continue
  emit:
    item:
      ContainerHostname: '{{ response.Containers.ContainerHostname }}'
      Image: '{{ response.Containers.Image }}'
      ImageConfig: '{{ response.Containers.ImageConfig }}'
      Mode: '{{ response.Containers.Mode }}'
      ModelDataUrl: '{{ response.Containers.ModelDataUrl }}'
      ModelDataSource: '{{ response.Containers.ModelDataSource }}'
      AdditionalModelDataSources: '{{ response.Containers.AdditionalModelDataSources
        }}'
      Environment: '{{ response.Containers.Environment }}'
      ModelPackageName: '{{ response.Containers.ModelPackageName }}'
      InferenceSpecificationName: '{{ response.Containers.InferenceSpecificationName
        }}'
      MultiModelConfig: '{{ response.Containers.MultiModelConfig }}'
      VpcConfig: '{{ resource.VpcConfig }}'
      ExecutionRoleArn: '{{ resource.ExecutionRoleArn }}'
      EnableNetworkIsolation: '{{ resource.EnableNetworkIsolation }}'
- discovery_id: aws.sagemaker.describe_inference_experiment
  calls:
  - action: describe_inference_experiment
    save_as: response
  emit:
    item:
      ModelName: '{{ response.ModelVariants.ModelName }}'
      VariantName: '{{ response.ModelVariants.VariantName }}'
      InfrastructureConfig: '{{ response.ModelVariants.InfrastructureConfig }}'
      Status: '{{ response.ModelVariants.Status }}'
      KmsKey: '{{ resource.KmsKey }}'
- discovery_id: aws.sagemaker.describe_notebook_instance
  calls:
  - action: describe_notebook_instance
    save_as: response
  emit:
    item:
      DirectInternetAccess: '{{ response.DirectInternetAccess }}'
      KmsKeyId: '{{ response.KmsKeyId }}'
      SecurityGroups: '{{ response.SecurityGroups }}'
- discovery_id: aws.sagemaker.list_endpoint_configs
  calls:
  - action: list_endpoint_configs
    save_as: response
  emit:
    items_for: '{{ response.EndpointConfigs }}'
    as: resource
    item:
      EndpointConfigName: '{{ resource.EndpointConfigName }}'
      EndpointConfigArn: '{{ resource.EndpointConfigArn }}'
      CreationTime: '{{ resource.CreationTime }}'
- discovery_id: aws.sagemaker.describe_hyper_parameter_tuning_job
  calls:
  - action: describe_hyper_parameter_tuning_job
    save_as: response
  emit:
    item:
      DefinitionName: '{{ response.TrainingJobDefinitions.DefinitionName }}'
      TuningObjective: '{{ response.TrainingJobDefinitions.TuningObjective }}'
      HyperParameterRanges: '{{ response.TrainingJobDefinitions.HyperParameterRanges
        }}'
      StaticHyperParameters: '{{ response.TrainingJobDefinitions.StaticHyperParameters
        }}'
      AlgorithmSpecification: '{{ response.TrainingJobDefinitions.AlgorithmSpecification
        }}'
      RoleArn: '{{ response.TrainingJobDefinitions.RoleArn }}'
      InputDataConfig: '{{ response.TrainingJobDefinitions.InputDataConfig }}'
      VpcConfig: '{{ response.TrainingJobDefinitions.VpcConfig }}'
      OutputDataConfig: '{{ response.TrainingJobDefinitions.OutputDataConfig }}'
      ResourceConfig: '{{ response.TrainingJobDefinitions.ResourceConfig }}'
      HyperParameterTuningResourceConfig: '{{ response.TrainingJobDefinitions.HyperParameterTuningResourceConfig
        }}'
      StoppingCondition: '{{ response.TrainingJobDefinitions.StoppingCondition }}'
      EnableNetworkIsolation: '{{ response.TrainingJobDefinitions.EnableNetworkIsolation
        }}'
      EnableInterContainerTrafficEncryption: '{{ response.TrainingJobDefinitions.EnableInterContainerTrafficEncryption
        }}'
      EnableManagedSpotTraining: '{{ response.TrainingJobDefinitions.EnableManagedSpotTraining
        }}'
      CheckpointConfig: '{{ response.TrainingJobDefinitions.CheckpointConfig }}'
      RetryStrategy: '{{ response.TrainingJobDefinitions.RetryStrategy }}'
      Environment: '{{ response.TrainingJobDefinitions.Environment }}'
      HyperParameterTuningJobConfig: '{{ resource.HyperParameterTuningJobConfig }}'
- discovery_id: aws.sagemaker.describe_user_profile
  calls:
  - action: describe_user_profile
    save_as: response
  emit:
    item:
      ExecutionRole: '{{ response.UserSettings.ExecutionRole }}'
      SecurityGroups: '{{ response.UserSettings.SecurityGroups }}'
      SharingSettings: '{{ response.UserSettings.SharingSettings }}'
      JupyterServerAppSettings: '{{ response.UserSettings.JupyterServerAppSettings
        }}'
      KernelGatewayAppSettings: '{{ response.UserSettings.KernelGatewayAppSettings
        }}'
      TensorBoardAppSettings: '{{ response.UserSettings.TensorBoardAppSettings }}'
      RStudioServerProAppSettings: '{{ response.UserSettings.RStudioServerProAppSettings
        }}'
      RSessionAppSettings: '{{ response.UserSettings.RSessionAppSettings }}'
      CanvasAppSettings: '{{ response.UserSettings.CanvasAppSettings }}'
      CodeEditorAppSettings: '{{ response.UserSettings.CodeEditorAppSettings }}'
      JupyterLabAppSettings: '{{ response.UserSettings.JupyterLabAppSettings }}'
      SpaceStorageSettings: '{{ response.UserSettings.SpaceStorageSettings }}'
      DefaultLandingUri: '{{ response.UserSettings.DefaultLandingUri }}'
      StudioWebPortal: '{{ response.UserSettings.StudioWebPortal }}'
      CustomPosixUserConfig: '{{ response.UserSettings.CustomPosixUserConfig }}'
      CustomFileSystemConfigs: '{{ response.UserSettings.CustomFileSystemConfigs }}'
      StudioWebPortalSettings: '{{ response.UserSettings.StudioWebPortalSettings }}'
      AutoMountHomeEFS: '{{ response.UserSettings.AutoMountHomeEFS }}'
- discovery_id: aws.sagemaker.list_model_packages
  calls:
  - action: list_model_packages
    save_as: response
  emit:
    items_for: '{{ response.ModelPackageSummaryList }}'
    as: resource
    item:
      ModelPackageName: '{{ resource.ModelPackageName }}'
      ModelPackageGroupName: '{{ resource.ModelPackageGroupName }}'
      ModelPackageVersion: '{{ resource.ModelPackageVersion }}'
      ModelPackageArn: '{{ resource.ModelPackageArn }}'
      ModelPackageDescription: '{{ resource.ModelPackageDescription }}'
      CreationTime: '{{ resource.CreationTime }}'
      ModelPackageStatus: '{{ resource.ModelPackageStatus }}'
      ModelApprovalStatus: '{{ resource.ModelApprovalStatus }}'
      ModelLifeCycle: '{{ resource.ModelLifeCycle }}'
- discovery_id: aws.sagemaker.list_data_quality_job_definitions
  calls:
  - action: list_data_quality_job_definitions
    save_as: response
  emit:
    items_for: '{{ response.JobDefinitionSummaries }}'
    as: resource
    item:
      MonitoringJobDefinitionName: '{{ resource.MonitoringJobDefinitionName }}'
      MonitoringJobDefinitionArn: '{{ resource.MonitoringJobDefinitionArn }}'
      CreationTime: '{{ resource.CreationTime }}'
      EndpointName: '{{ resource.EndpointName }}'
- discovery_id: aws.sagemaker.describe_endpoint
  calls:
  - action: describe_endpoint
    save_as: response
    params:
      EndpointName: '{{ item.EndpointName }}'
  for_each: aws.sagemaker.list_data_quality_job_definitions
  on_error: continue
  emit:
    item:
      VariantName: '{{ response.ProductionVariants.VariantName }}'
      DeployedImages: '{{ response.ProductionVariants.DeployedImages }}'
      CurrentWeight: '{{ response.ProductionVariants.CurrentWeight }}'
      DesiredWeight: '{{ response.ProductionVariants.DesiredWeight }}'
      CurrentInstanceCount: '{{ response.ProductionVariants.CurrentInstanceCount }}'
      DesiredInstanceCount: '{{ response.ProductionVariants.DesiredInstanceCount }}'
      VariantStatus: '{{ response.ProductionVariants.VariantStatus }}'
      CurrentServerlessConfig: '{{ response.ProductionVariants.CurrentServerlessConfig
        }}'
      DesiredServerlessConfig: '{{ response.ProductionVariants.DesiredServerlessConfig
        }}'
      ManagedInstanceScaling: '{{ response.ProductionVariants.ManagedInstanceScaling
        }}'
      RoutingConfig: '{{ response.ProductionVariants.RoutingConfig }}'
      CapacityReservationConfig: '{{ response.ProductionVariants.CapacityReservationConfig
        }}'
      DataCaptureConfig: '{{ resource.DataCaptureConfig }}'
- discovery_id: aws.sagemaker.describe_compilation_job
  calls:
  - action: describe_compilation_job
    save_as: response
  emit:
    item:
      MaxRuntimeInSeconds: '{{ response.StoppingCondition.MaxRuntimeInSeconds }}'
      MaxWaitTimeInSeconds: '{{ response.StoppingCondition.MaxWaitTimeInSeconds }}'
      MaxPendingTimeInSeconds: '{{ response.StoppingCondition.MaxPendingTimeInSeconds
        }}'
      OutputConfig: '{{ resource.OutputConfig }}'
- discovery_id: aws.sagemaker.list_pipelines
  calls:
  - action: list_pipelines
    save_as: response
  emit:
    items_for: '{{ response.PipelineSummaries }}'
    as: resource
    item:
      PipelineArn: '{{ resource.PipelineArn }}'
      PipelineName: '{{ resource.PipelineName }}'
      PipelineDisplayName: '{{ resource.PipelineDisplayName }}'
      PipelineDescription: '{{ resource.PipelineDescription }}'
      RoleArn: '{{ resource.RoleArn }}'
      CreationTime: '{{ resource.CreationTime }}'
      LastModifiedTime: '{{ resource.LastModifiedTime }}'
      LastExecutionTime: '{{ resource.LastExecutionTime }}'
- discovery_id: aws.sagemaker.describe_pipeline
  calls:
  - action: describe_pipeline
    save_as: response
    params:
      PipelineName: '{{ item.PipelineName }}'
  for_each: aws.sagemaker.list_pipelines
  on_error: continue
  emit:
    item:
      UserProfileArn: '{{ response.CreatedBy.UserProfileArn }}'
      UserProfileName: '{{ response.CreatedBy.UserProfileName }}'
      DomainId: '{{ response.CreatedBy.DomainId }}'
      IamIdentity: '{{ response.CreatedBy.IamIdentity }}'
- discovery_id: aws.sagemaker.describe_model_package
  calls:
  - action: describe_model_package
    save_as: response
  emit:
    item:
      Name: '{{ response.AdditionalInferenceSpecifications.Name }}'
      Description: '{{ response.AdditionalInferenceSpecifications.Description }}'
      Containers: '{{ response.AdditionalInferenceSpecifications.Containers }}'
      SupportedTransformInstanceTypes: '{{ response.AdditionalInferenceSpecifications.SupportedTransformInstanceTypes
        }}'
      SupportedRealtimeInferenceInstanceTypes: '{{ response.AdditionalInferenceSpecifications.SupportedRealtimeInferenceInstanceTypes
        }}'
      SupportedContentTypes: '{{ response.AdditionalInferenceSpecifications.SupportedContentTypes
        }}'
      SupportedResponseMIMETypes: '{{ response.AdditionalInferenceSpecifications.SupportedResponseMIMETypes
        }}'
- discovery_id: aws.sagemaker.describe_hub_content
  calls:
  - action: describe_hub_content
    save_as: response
  emit:
    item:
      SageMakerPublicHubContentArn: '{{ response.SageMakerPublicHubContentArn }}'
- discovery_id: aws.sagemaker.describe_app
  calls:
  - action: describe_app
    save_as: response
  emit:
    item:
      SageMakerImageArn: '{{ response.ResourceSpec.SageMakerImageArn }}'
      SageMakerImageVersionArn: '{{ response.ResourceSpec.SageMakerImageVersionArn
        }}'
      SageMakerImageVersionAlias: '{{ response.ResourceSpec.SageMakerImageVersionAlias
        }}'
      InstanceType: '{{ response.ResourceSpec.InstanceType }}'
      LifecycleConfigArn: '{{ response.ResourceSpec.LifecycleConfigArn }}'
- discovery_id: aws.sagemaker.describe_feature_group
  calls:
  - action: describe_feature_group
    save_as: response
  emit:
    item:
      FeatureName: '{{ response.FeatureDefinitions.FeatureName }}'
      FeatureType: '{{ response.FeatureDefinitions.FeatureType }}'
      CollectionType: '{{ response.FeatureDefinitions.CollectionType }}'
      CollectionConfig: '{{ response.FeatureDefinitions.CollectionConfig }}'
      OfflineStoreConfig: '{{ resource.OfflineStoreConfig }}'
- discovery_id: aws.sagemaker.list_notebook_instance_lifecycle_configs
  calls:
  - action: list_notebook_instance_lifecycle_configs
    save_as: response
  emit:
    items_for: '{{ response.NotebookInstanceLifecycleConfigs }}'
    as: resource
    item:
      NotebookInstanceLifecycleConfigName: '{{ resource.NotebookInstanceLifecycleConfigName
        }}'
      NotebookInstanceLifecycleConfigArn: '{{ resource.NotebookInstanceLifecycleConfigArn
        }}'
      CreationTime: '{{ resource.CreationTime }}'
      LastModifiedTime: '{{ resource.LastModifiedTime }}'
- discovery_id: aws.sagemaker.describe_inference_recommendations_job
  calls:
  - action: describe_inference_recommendations_job
    save_as: response
  emit:
    item:
      RecommendationId: '{{ response.InferenceRecommendations.RecommendationId }}'
      Metrics: '{{ response.InferenceRecommendations.Metrics }}'
      EndpointConfiguration: '{{ response.InferenceRecommendations.EndpointConfiguration
        }}'
      ModelConfiguration: '{{ response.InferenceRecommendations.ModelConfiguration
        }}'
      InvocationEndTime: '{{ response.InferenceRecommendations.InvocationEndTime }}'
      InvocationStartTime: '{{ response.InferenceRecommendations.InvocationStartTime
        }}'
- discovery_id: aws.sagemaker.list_experiments
  calls:
  - action: list_experiments
    save_as: response
  emit:
    items_for: '{{ response.ExperimentSummaries }}'
    as: resource
    item:
      ExperimentArn: '{{ resource.ExperimentArn }}'
      ExperimentName: '{{ resource.ExperimentName }}'
      DisplayName: '{{ resource.DisplayName }}'
      ExperimentSource: '{{ resource.ExperimentSource }}'
      CreationTime: '{{ resource.CreationTime }}'
      LastModifiedTime: '{{ resource.LastModifiedTime }}'
      Experiment: '{{ resource.Experiment }}'
checks:
- rule_id: aws.sagemaker.endpoint.logging_enabled
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: Enabled
- rule_id: aws.sagemaker.flowdefinition.workteam_access_rbac_least_privilege
  for_each: aws.sagemaker.describe_workteam
  conditions:
    var: item.Workteam
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.modelpackage.sagemaker_artifact_signed_and_verified
  for_each: aws.sagemaker.describe_auto_m_l_job_v2
  conditions:
    var: item.SecurityConfig
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.volume.and_output_encryption_enabled
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: Enabled
- rule_id: aws.sagemaker.modelpackage.encryption_at_rest_enabled
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: Enabled
- rule_id: aws.sagemaker.trainingjob.vpc_configured
  for_each: aws.sagemaker.describe_model
  conditions:
    var: item.VpcConfig
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.trainingjob.output_encryption_enabled
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: Enabled
- rule_id: aws.sagemaker.featuregroup.online_store_kms_encryption_enabled
  for_each: aws.sagemaker.describe_inference_experiment
  conditions:
    var: item.KmsKey
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.model.private_networking_enforced
  for_each: aws.sagemaker.describe_notebook_instance
  conditions:
    var: item.DirectInternetAccess
    op: equals
    value: 'false'
- rule_id: aws.sagemaker.endpoint.security_group_restrictive_configured
  for_each: aws.sagemaker.describe_notebook_instance
  conditions:
    var: item.SecurityGroups
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.endpoint.role_least_privilege
  for_each: aws.sagemaker.describe_model
  conditions:
    var: item.ExecutionRoleArn
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.endpoint_config_prod_variant_instances.endpoint_config_prod_variant_instances_configured
  for_each: aws.sagemaker.list_endpoint_configs
  conditions:
    var: item.EndpointConfigName
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.hyperparameter_tuning_job.logging_enabled
  for_each: aws.sagemaker.describe_hyper_parameter_tuning_job
  conditions:
    var: item.HyperParameterTuningJobConfig
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.model.sagemaker_cross_account_sharing_restricted
  for_each: aws.sagemaker.describe_user_profile
  conditions:
    var: item.SharingSettings
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.models_vpc_settings_configured.models_vpc_settings_configured_configured
  for_each: aws.sagemaker.describe_model
  conditions:
    var: item.VpcConfig
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.model.sagemaker_kms_cmk_used_configured
  for_each: aws.sagemaker.describe_notebook_instance
  conditions:
    var: item.KmsKeyId
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.pipeline.kms_encryption_enabled
  for_each: aws.sagemaker.describe_inference_experiment
  conditions:
    var: item.KmsKey
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.automljob.role_least_privilege
  for_each: aws.sagemaker.describe_model
  conditions:
    var: item.ExecutionRoleArn
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.instance.encryption_enabled
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: Enabled
- rule_id: aws.sagemaker.trainingjob.volume_encryption_enabled
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: Enabled
- rule_id: aws.sagemaker.notebook.instance_encryption_enabled
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: Enabled
- rule_id: aws.sagemaker.training_jobs_vpc_settings_configured.training_jobs_vpc_settings_configured_configured
  for_each: aws.sagemaker.describe_model
  conditions:
    var: item.VpcConfig
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.endpoint.in_vpc_configured
  for_each: aws.sagemaker.describe_model
  conditions:
    var: item.VpcConfig
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.endpoint_configuration.kms_keys_restricted
  for_each: aws.sagemaker.describe_inference_experiment
  conditions:
    var: item.KmsKey
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.notebook_instance.private_networking_enforced
  for_each: aws.sagemaker.describe_notebook_instance
  conditions:
    var: item.DirectInternetAccess
    op: equals
    value: 'False'
- rule_id: aws.sagemaker.transformjob.logging_enabled
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: Enabled
- rule_id: aws.sagemaker.endpoint.authz_policies_enforced
  for_each: aws.sagemaker.describe_auto_m_l_job_v2
  conditions:
    var: item.SecurityConfig
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.model.rbac_least_privilege
  for_each: aws.sagemaker.list_model_packages
  conditions:
    var: item.ModelApprovalStatus
    op: not_equals
    value: Approved
- rule_id: aws.sagemaker.instance.without_direct_internet_access_configured
  for_each: aws.sagemaker.describe_notebook_instance
  conditions:
    var: item.DirectInternetAccess
    op: equals
    value: 'false'
- rule_id: aws.sagemaker.trainingjob.role_least_privilege
  for_each: aws.sagemaker.describe_model
  conditions:
    var: item.ExecutionRoleArn
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.endpoint.kms_encryption_enabled
  for_each: aws.sagemaker.describe_notebook_instance
  conditions:
    var: item.KmsKeyId
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.experiment.logging_enabled
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: Enabled
- rule_id: aws.sagemaker.model.execution_role_least_privilege
  for_each: aws.sagemaker.describe_user_profile
  conditions:
    var: item.ExecutionRole
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.model.role_least_privilege
  for_each: aws.sagemaker.describe_model
  conditions:
    var: item.ExecutionRoleArn
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.resource.training_jobs_intercontainer_encryption_enabled
  for_each: aws.sagemaker.describe_hyper_parameter_tuning_job
  conditions:
    var: item.EnableInterContainerTrafficEncryption
    op: equals
    value: Enabled
- rule_id: aws.sagemaker.endpoint_configuration.data_capture_bucket_encrypted_private
  for_each: aws.sagemaker.describe_endpoint
  conditions:
    var: item.DataCaptureConfig
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.transformjob.sagemaker_input_output_encrypted
  for_each: aws.sagemaker.describe_compilation_job
  conditions:
    var: item.OutputConfig
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.automljob.private_networking_enforced
  for_each: aws.sagemaker.describe_notebook_instance
  conditions:
    var: item.DirectInternetAccess
    op: equals
    value: 'false'
- rule_id: aws.sagemaker.flowdefinition.ui_private_networking_enforced
  for_each: aws.sagemaker.describe_notebook_instance
  conditions:
    var: item.DirectInternetAccess
    op: equals
    value: 'false'
- rule_id: aws.sagemaker.notebook_instance.execution_role_least_privilege
  for_each: aws.sagemaker.describe_user_profile
  conditions:
    var: item.ExecutionRole
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.notebook.instance_without_direct_internet_access_configured
  for_each: aws.sagemaker.describe_notebook_instance
  conditions:
    var: item.DirectInternetAccess
    op: equals
    value: 'False'
- rule_id: aws.sagemaker.trainingjob.logging_enabled
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: Enabled
- rule_id: aws.sagemaker.transformjob.private_networking_enforced
  for_each: aws.sagemaker.describe_notebook_instance
  conditions:
    var: item.DirectInternetAccess
    op: equals
    value: Disabled
- rule_id: aws.sagemaker.model.sagemaker_artifact_encrypted_at_rest
  for_each: aws.sagemaker.describe_inference_experiment
  conditions:
    var: item.KmsKey
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.notebook_instance.iam_role_least_privileged_configured
  for_each: aws.sagemaker.describe_pipeline
  conditions:
    var: item.IamIdentity
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.endpoint_configuration.logging_enabled
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: Enabled
- rule_id: aws.sagemaker.endpoint_configuration.sagemaker_content_type_whitelist_enforced
  for_each: aws.sagemaker.describe_model_package
  conditions:
    var: item.SupportedContentTypes
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.notebook_instance.encryption_at_rest_enabled
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: Enabled
- rule_id: aws.sagemaker.experiment.sagemaker_metadata_store_encrypted
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: Enabled
- rule_id: aws.sagemaker.modelpackage.not_publicly_shared_configured
  for_each: aws.sagemaker.describe_hub_content
  conditions:
    var: item.SageMakerPublicHubContentArn
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.trainingjob.private_networking_enforced
  for_each: aws.sagemaker.describe_notebook_instance
  conditions:
    var: item.DirectInternetAccess
    op: equals
    value: Disabled
- rule_id: aws.sagemaker.trainingjob.sagemaker_input_output_encrypted
  for_each: aws.sagemaker.describe_auto_m_l_job_v2
  conditions:
    var: item.OutputDataConfig
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.notebook_instance.no_public_access_configured
  for_each: aws.sagemaker.describe_notebook_instance
  conditions:
    var: item.DirectInternetAccess
    op: equals
    value: Disabled
- rule_id: aws.sagemaker.trainingjob.network_isolation_enabled
  for_each: aws.sagemaker.describe_model
  conditions:
    var: item.EnableNetworkIsolation
    op: equals
    value: Enabled
- rule_id: aws.sagemaker.endpoint_configuration.sagemaker_capture_store_encrypted_and_private
  for_each: aws.sagemaker.describe_endpoint
  conditions:
    var: item.DataCaptureConfig
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.endpoint.sagemaker_data_capture_s3_encrypted
  for_each: aws.sagemaker.describe_endpoint
  conditions:
    var: item.DataCaptureConfig
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.endpoint_configuration.endpoint_in_vpc_configured
  for_each: aws.sagemaker.describe_model
  conditions:
    var: item.VpcConfig
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.flowdefinition.sagemaker_artifacts_encrypted
  for_each: aws.sagemaker.describe_inference_experiment
  conditions:
    var: item.KmsKey
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.transformjob.role_least_privilege
  for_each: aws.sagemaker.describe_model
  conditions:
    var: item.ExecutionRoleArn
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.endpoint_configuration.kms_encryption_enabled
  for_each: aws.sagemaker.describe_notebook_instance
  conditions:
    var: item.KmsKeyId
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.trainingjob.inter_container_traffic_encryption_enabled
  for_each: aws.sagemaker.describe_hyper_parameter_tuning_job
  conditions:
    var: item.EnableInterContainerTrafficEncryption
    op: equals
    value: Enabled
- rule_id: aws.sagemaker.automljob.logging_enabled
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: Enabled
- rule_id: aws.sagemaker.hyperparameter_tuning_job.private_networking_enforced
  for_each: aws.sagemaker.describe_notebook_instance
  conditions:
    var: item.DirectInternetAccess
    op: equals
    value: 'false'
- rule_id: aws.sagemaker.model.sagemaker_image_scan_passed_configured
  for_each: aws.sagemaker.describe_app
  conditions:
    var: item.SageMakerImageArn
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.endpoint.authn_required
  for_each: aws.sagemaker.describe_auto_m_l_job_v2
  conditions:
    var: item.SecurityConfig
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.pipeline.logging_enabled
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: Enabled
- rule_id: aws.sagemaker.featuregroup.sagemaker_offline_store_s3_encrypted
  for_each: aws.sagemaker.describe_feature_group
  conditions:
    var: item.OfflineStoreConfig
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.featuregroup.offline_store_block_public_access_configured
  for_each: aws.sagemaker.describe_feature_group
  conditions:
    var: item.OfflineStoreConfig
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.model.logging_enabled
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: Enabled
- rule_id: aws.sagemaker.pipeline.iam_role_least_privileged_configured
  for_each: aws.sagemaker.describe_model
  conditions:
    var: item.ExecutionRoleArn
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.notebook_instance.sagemaker_idle_shutdown_configured
  for_each: aws.sagemaker.list_notebook_instance_lifecycle_configs
  conditions:
    var: item.NotebookInstanceLifecycleConfigArn
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.pipeline.sagemaker_artifacts_private_and_encrypted
  for_each: aws.sagemaker.describe_inference_experiment
  conditions:
    var: item.KmsKey
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.endpoint.sagemaker_outputs_encrypted_and_private
  for_each: aws.sagemaker.describe_inference_recommendations_job
  conditions:
    var: item.EndpointConfiguration
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.pipeline.role_least_privilege
  for_each: aws.sagemaker.describe_model
  conditions:
    var: item.ExecutionRoleArn
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.experiment.rbac_least_privilege
  for_each: aws.sagemaker.list_experiments
  conditions:
    var: item.Experiment
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.modelpackage.kms_encryption_enabled
  for_each: aws.sagemaker.describe_notebook_instance
  conditions:
    var: item.KmsKeyId
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.model.sagemaker_outputs_encrypted_and_private
  for_each: aws.sagemaker.describe_inference_experiment
  conditions:
    var: item.KmsKey
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.modelpackage.sagemaker_image_scan_passed_configured
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: Enabled
- rule_id: aws.sagemaker.hyperparameter_tuning_job.role_least_privilege
  for_each: aws.sagemaker.describe_model
  conditions:
    var: item.ExecutionRoleArn
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.instance.vpc_settings_configured
  for_each: aws.sagemaker.describe_model
  conditions:
    var: item.VpcConfig
    op: not_equals
    value: 'null'
- rule_id: aws.sagemaker.modelpackage.sagemaker_package_approved_configured
  for_each: aws.sagemaker.list_model_packages
  conditions:
    var: item.ModelPackageStatus
    op: equals
    value: Completed
- rule_id: aws.sagemaker.model.artifact_encryption_enabled
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: Enabled
- rule_id: aws.sagemaker.endpoint.private_networking_enforced
  for_each: aws.sagemaker.describe_notebook_instance
  conditions:
    var: item.DirectInternetAccess
    op: equals
    value: 'false'
