version: '1.0'
provider: aws
service: sagemaker
services:
  client: sagemaker
  module: boto3.client
discovery:
- discovery_id: aws.sagemaker.list_actions
  calls:
  - action: list_actions
    save_as: response
  emit:
    items_for: '{{ response.ActionSummaries }}'
    as: resource
    item:
      ActionArn: '{{ resource.ActionArn }}'
      ActionName: '{{ resource.ActionName }}'
      Source: '{{ resource.Source }}'
      ActionType: '{{ resource.ActionType }}'
      Status: '{{ resource.Status }}'
      CreationTime: '{{ resource.CreationTime }}'
      LastModifiedTime: '{{ resource.LastModifiedTime }}'
- discovery_id: aws.sagemaker.list_auto_ml_jobs
  calls:
  - action: list_auto_ml_jobs
    save_as: response
  emit:
    items_for: '{{ response.AutoMLJobSummaries }}'
    as: resource
    item:
      AutoMLJobName: '{{ resource.AutoMLJobName }}'
      AutoMLJobArn: '{{ resource.AutoMLJobArn }}'
      AutoMLJobStatus: '{{ resource.AutoMLJobStatus }}'
      AutoMLJobSecondaryStatus: '{{ resource.AutoMLJobSecondaryStatus }}'
      CreationTime: '{{ resource.CreationTime }}'
      EndTime: '{{ resource.EndTime }}'
      LastModifiedTime: '{{ resource.LastModifiedTime }}'
      FailureReason: '{{ resource.FailureReason }}'
      PartialFailureReasons: '{{ resource.PartialFailureReasons }}'
- discovery_id: aws.sagemaker.list_clusters
  calls:
  - action: list_clusters
    save_as: response
  emit:
    items_for: '{{ response.ClusterSummaries }}'
    as: resource
    item:
      ClusterArn: '{{ resource.ClusterArn }}'
      ClusterName: '{{ resource.ClusterName }}'
      CreationTime: '{{ resource.CreationTime }}'
      ClusterStatus: '{{ resource.ClusterStatus }}'
      TrainingPlanArns: '{{ resource.TrainingPlanArns }}'
- discovery_id: aws.sagemaker.list_device_fleets
  calls:
  - action: list_device_fleets
    save_as: response
  emit:
    items_for: '{{ response.DeviceFleetSummaries }}'
    as: resource
    item:
      DeviceFleetArn: '{{ resource.DeviceFleetArn }}'
      DeviceFleetName: '{{ resource.DeviceFleetName }}'
      CreationTime: '{{ resource.CreationTime }}'
      LastModifiedTime: '{{ resource.LastModifiedTime }}'
- discovery_id: aws.sagemaker.list_devices
  calls:
  - action: list_devices
    save_as: response
  emit:
    items_for: '{{ response.DeviceSummaries }}'
    as: resource
    item:
      DeviceName: '{{ resource.DeviceName }}'
      DeviceArn: '{{ resource.DeviceArn }}'
      Description: '{{ resource.Description }}'
      DeviceFleetName: '{{ resource.DeviceFleetName }}'
      IotThingName: '{{ resource.IotThingName }}'
      RegistrationTime: '{{ resource.RegistrationTime }}'
      LatestHeartbeat: '{{ resource.LatestHeartbeat }}'
      Models: '{{ resource.Models }}'
      AgentVersion: '{{ resource.AgentVersion }}'
- discovery_id: aws.sagemaker.list_domains
  calls:
  - action: list_domains
    save_as: response
  emit:
    items_for: '{{ response.Domains }}'
    as: resource
    item:
      DomainArn: '{{ resource.DomainArn }}'
      DomainId: '{{ resource.DomainId }}'
      DomainName: '{{ resource.DomainName }}'
      Status: '{{ resource.Status }}'
      CreationTime: '{{ resource.CreationTime }}'
      LastModifiedTime: '{{ resource.LastModifiedTime }}'
      Url: '{{ resource.Url }}'
- discovery_id: aws.sagemaker.list_endpoints
  calls:
  - action: list_endpoints
    save_as: response
  emit:
    items_for: '{{ response.Endpoints }}'
    as: resource
    item:
      EndpointName: '{{ resource.EndpointName }}'
      EndpointArn: '{{ resource.EndpointArn }}'
      CreationTime: '{{ resource.CreationTime }}'
      LastModifiedTime: '{{ resource.LastModifiedTime }}'
      EndpointStatus: '{{ resource.EndpointStatus }}'
- discovery_id: aws.sagemaker.list_feature_groups
  calls:
  - action: list_feature_groups
    save_as: response
  emit:
    items_for: '{{ response.FeatureGroupSummaries }}'
    as: resource
    item:
      FeatureGroupName: '{{ resource.FeatureGroupName }}'
      FeatureGroupArn: '{{ resource.FeatureGroupArn }}'
      CreationTime: '{{ resource.CreationTime }}'
      FeatureGroupStatus: '{{ resource.FeatureGroupStatus }}'
      OfflineStoreStatus: '{{ resource.OfflineStoreStatus }}'
- discovery_id: aws.sagemaker.list_flow_definitions
  calls:
  - action: list_flow_definitions
    save_as: response
  emit:
    items_for: '{{ response.FlowDefinitionSummaries }}'
    as: resource
    item:
      FlowDefinitionName: '{{ resource.FlowDefinitionName }}'
      FlowDefinitionArn: '{{ resource.FlowDefinitionArn }}'
      FlowDefinitionStatus: '{{ resource.FlowDefinitionStatus }}'
      CreationTime: '{{ resource.CreationTime }}'
      FailureReason: '{{ resource.FailureReason }}'
- discovery_id: aws.sagemaker.list_hyper_parameter_tuning_jobs
  calls:
  - action: list_hyper_parameter_tuning_jobs
    save_as: response
  emit:
    items_for: '{{ response.HyperParameterTuningJobSummaries }}'
    as: resource
    item:
      HyperParameterTuningJobName: '{{ resource.HyperParameterTuningJobName }}'
      HyperParameterTuningJobArn: '{{ resource.HyperParameterTuningJobArn }}'
      HyperParameterTuningJobStatus: '{{ resource.HyperParameterTuningJobStatus }}'
      Strategy: '{{ resource.Strategy }}'
      CreationTime: '{{ resource.CreationTime }}'
      HyperParameterTuningEndTime: '{{ resource.HyperParameterTuningEndTime }}'
      LastModifiedTime: '{{ resource.LastModifiedTime }}'
      TrainingJobStatusCounters: '{{ resource.TrainingJobStatusCounters }}'
      ObjectiveStatusCounters: '{{ resource.ObjectiveStatusCounters }}'
      ResourceLimits: '{{ resource.ResourceLimits }}'
- discovery_id: aws.sagemaker.list_images
  calls:
  - action: list_images
    save_as: response
  emit:
    items_for: '{{ response.Images }}'
    as: resource
    item:
      CreationTime: '{{ resource.CreationTime }}'
      Description: '{{ resource.Description }}'
      DisplayName: '{{ resource.DisplayName }}'
      FailureReason: '{{ resource.FailureReason }}'
      ImageArn: '{{ resource.ImageArn }}'
      ImageName: '{{ resource.ImageName }}'
      ImageStatus: '{{ resource.ImageStatus }}'
      LastModifiedTime: '{{ resource.LastModifiedTime }}'
- discovery_id: aws.sagemaker.list_inference_experiments
  calls:
  - action: list_inference_experiments
    save_as: response
  emit:
    items_for: '{{ response.InferenceExperiments }}'
    as: resource
    item:
      Name: '{{ resource.Name }}'
      Type: '{{ resource.Type }}'
      Schedule: '{{ resource.Schedule }}'
      Status: '{{ resource.Status }}'
      StatusReason: '{{ resource.StatusReason }}'
      Description: '{{ resource.Description }}'
      CreationTime: '{{ resource.CreationTime }}'
      CompletionTime: '{{ resource.CompletionTime }}'
      LastModifiedTime: '{{ resource.LastModifiedTime }}'
      RoleArn: '{{ resource.RoleArn }}'
- discovery_id: aws.sagemaker.list_model_packages
  calls:
  - action: list_model_packages
    save_as: response
  emit:
    items_for: '{{ response.ModelPackageSummaryList }}'
    as: resource
    item:
      ModelPackageName: '{{ resource.ModelPackageName }}'
      ModelPackageGroupName: '{{ resource.ModelPackageGroupName }}'
      ModelPackageVersion: '{{ resource.ModelPackageVersion }}'
      ModelPackageArn: '{{ resource.ModelPackageArn }}'
      ModelPackageDescription: '{{ resource.ModelPackageDescription }}'
      CreationTime: '{{ resource.CreationTime }}'
      ModelPackageStatus: '{{ resource.ModelPackageStatus }}'
      ModelApprovalStatus: '{{ resource.ModelApprovalStatus }}'
      ModelLifeCycle: '{{ resource.ModelLifeCycle }}'
- discovery_id: aws.sagemaker.list_notebook_instance_lifecycle_configs
  calls:
  - action: list_notebook_instance_lifecycle_configs
    save_as: response
  emit:
    items_for: '{{ response.NotebookInstanceLifecycleConfigs }}'
    as: resource
    item:
      NotebookInstanceLifecycleConfigName: '{{ resource.NotebookInstanceLifecycleConfigName
        }}'
      NotebookInstanceLifecycleConfigArn: '{{ resource.NotebookInstanceLifecycleConfigArn
        }}'
      CreationTime: '{{ resource.CreationTime }}'
      LastModifiedTime: '{{ resource.LastModifiedTime }}'
- discovery_id: aws.sagemaker.list_notebook_instances
  calls:
  - action: list_notebook_instances
    save_as: response
  emit:
    items_for: '{{ response.NotebookInstances }}'
    as: resource
    item:
      NotebookInstanceName: '{{ resource.NotebookInstanceName }}'
      NotebookInstanceArn: '{{ resource.NotebookInstanceArn }}'
      NotebookInstanceStatus: '{{ resource.NotebookInstanceStatus }}'
      Url: '{{ resource.Url }}'
      InstanceType: '{{ resource.InstanceType }}'
      CreationTime: '{{ resource.CreationTime }}'
      LastModifiedTime: '{{ resource.LastModifiedTime }}'
      NotebookInstanceLifecycleConfigName: '{{ resource.NotebookInstanceLifecycleConfigName
        }}'
      DefaultCodeRepository: '{{ resource.DefaultCodeRepository }}'
      AdditionalCodeRepositories: '{{ resource.AdditionalCodeRepositories }}'
- discovery_id: aws.sagemaker.list_training_jobs
  calls:
  - action: list_training_jobs
    save_as: response
  emit:
    items_for: '{{ response.TrainingJobSummaries }}'
    as: resource
    item:
      TrainingJobName: '{{ resource.TrainingJobName }}'
      TrainingJobArn: '{{ resource.TrainingJobArn }}'
      CreationTime: '{{ resource.CreationTime }}'
      TrainingEndTime: '{{ resource.TrainingEndTime }}'
      LastModifiedTime: '{{ resource.LastModifiedTime }}'
      TrainingJobStatus: '{{ resource.TrainingJobStatus }}'
      SecondaryStatus: '{{ resource.SecondaryStatus }}'
      WarmPoolStatus: '{{ resource.WarmPoolStatus }}'
      TrainingPlanArn: '{{ resource.TrainingPlanArn }}'
- discovery_id: aws.sagemaker.list_transform_jobs
  calls:
  - action: list_transform_jobs
    save_as: response
  emit:
    items_for: '{{ response.TransformJobSummaries }}'
    as: resource
    item:
      TransformJobName: '{{ resource.TransformJobName }}'
      TransformJobArn: '{{ resource.TransformJobArn }}'
      CreationTime: '{{ resource.CreationTime }}'
      TransformEndTime: '{{ resource.TransformEndTime }}'
      LastModifiedTime: '{{ resource.LastModifiedTime }}'
      TransformJobStatus: '{{ resource.TransformJobStatus }}'
      FailureReason: '{{ resource.FailureReason }}'
- discovery_id: aws.sagemaker.batch_describe_model_package
  calls:
  - action: batch_describe_model_package
    save_as: response
- discovery_id: aws.sagemaker.describe_cluster
  calls:
  - action: describe_cluster
    save_as: response
    params:
      ClusterName: '{{ item.ClusterName }}'
  on_error: continue
  for_each: aws.sagemaker.list_clusters
  emit:
    item:
      CurrentCount: '{{ response.InstanceGroups.CurrentCount }}'
      TargetCount: '{{ response.InstanceGroups.TargetCount }}'
      MinCount: '{{ response.InstanceGroups.MinCount }}'
      InstanceGroupName: '{{ response.InstanceGroups.InstanceGroupName }}'
      InstanceType: '{{ response.InstanceGroups.InstanceType }}'
      LifeCycleConfig: '{{ response.InstanceGroups.LifeCycleConfig }}'
      ExecutionRole: '{{ response.InstanceGroups.ExecutionRole }}'
      ThreadsPerCore: '{{ response.InstanceGroups.ThreadsPerCore }}'
      InstanceStorageConfigs: '{{ response.InstanceGroups.InstanceStorageConfigs }}'
      OnStartDeepHealthChecks: '{{ response.InstanceGroups.OnStartDeepHealthChecks
        }}'
      Status: '{{ response.InstanceGroups.Status }}'
      TrainingPlanArn: '{{ response.InstanceGroups.TrainingPlanArn }}'
      TrainingPlanStatus: '{{ response.InstanceGroups.TrainingPlanStatus }}'
      OverrideVpcConfig: '{{ response.InstanceGroups.OverrideVpcConfig }}'
      ScheduledUpdateConfig: '{{ response.InstanceGroups.ScheduledUpdateConfig }}'
      CurrentImageId: '{{ response.InstanceGroups.CurrentImageId }}'
      DesiredImageId: '{{ response.InstanceGroups.DesiredImageId }}'
      ActiveOperations: '{{ response.InstanceGroups.ActiveOperations }}'
      KubernetesConfig: '{{ response.InstanceGroups.KubernetesConfig }}'
      CapacityRequirements: '{{ response.InstanceGroups.CapacityRequirements }}'
      TargetStateCount: '{{ response.InstanceGroups.TargetStateCount }}'
      SoftwareUpdateStatus: '{{ response.InstanceGroups.SoftwareUpdateStatus }}'
      ActiveSoftwareUpdateConfig: '{{ response.InstanceGroups.ActiveSoftwareUpdateConfig
        }}'
- discovery_id: aws.sagemaker.describe_device
  calls:
  - action: describe_device
    save_as: response
    params:
      DeviceName: '{{ item.DeviceName }}'
      DeviceFleetName: '{{ item.DeviceFleetName }}'
  on_error: continue
  for_each: aws.sagemaker.list_devices
  emit:
    item:
      ModelName: '{{ response.Models.ModelName }}'
      ModelVersion: '{{ response.Models.ModelVersion }}'
      LatestSampleTime: '{{ response.Models.LatestSampleTime }}'
      LatestInference: '{{ response.Models.LatestInference }}'
- discovery_id: aws.sagemaker.describe_endpoint
  calls:
  - action: describe_endpoint
    save_as: response
    params:
      EndpointName: '{{ item.EndpointName }}'
  on_error: continue
  for_each: aws.sagemaker.list_endpoints
  emit:
    item:
      VariantName: '{{ response.ProductionVariants.VariantName }}'
      DeployedImages: '{{ response.ProductionVariants.DeployedImages }}'
      CurrentWeight: '{{ response.ProductionVariants.CurrentWeight }}'
      DesiredWeight: '{{ response.ProductionVariants.DesiredWeight }}'
      CurrentInstanceCount: '{{ response.ProductionVariants.CurrentInstanceCount }}'
      DesiredInstanceCount: '{{ response.ProductionVariants.DesiredInstanceCount }}'
      VariantStatus: '{{ response.ProductionVariants.VariantStatus }}'
      CurrentServerlessConfig: '{{ response.ProductionVariants.CurrentServerlessConfig
        }}'
      DesiredServerlessConfig: '{{ response.ProductionVariants.DesiredServerlessConfig
        }}'
      ManagedInstanceScaling: '{{ response.ProductionVariants.ManagedInstanceScaling
        }}'
      RoutingConfig: '{{ response.ProductionVariants.RoutingConfig }}'
      CapacityReservationConfig: '{{ response.ProductionVariants.CapacityReservationConfig
        }}'
- discovery_id: aws.sagemaker.describe_hyper_parameter_tuning_job
  calls:
  - action: describe_hyper_parameter_tuning_job
    save_as: response
    params:
      HyperParameterTuningJobName: '{{ item.HyperParameterTuningJobName }}'
  on_error: continue
  for_each: aws.sagemaker.list_hyper_parameter_tuning_jobs
  emit:
    item:
      DefinitionName: '{{ response.TrainingJobDefinitions.DefinitionName }}'
      TuningObjective: '{{ response.TrainingJobDefinitions.TuningObjective }}'
      HyperParameterRanges: '{{ response.TrainingJobDefinitions.HyperParameterRanges
        }}'
      StaticHyperParameters: '{{ response.TrainingJobDefinitions.StaticHyperParameters
        }}'
      AlgorithmSpecification: '{{ response.TrainingJobDefinitions.AlgorithmSpecification
        }}'
      RoleArn: '{{ response.TrainingJobDefinitions.RoleArn }}'
      InputDataConfig: '{{ response.TrainingJobDefinitions.InputDataConfig }}'
      VpcConfig: '{{ response.TrainingJobDefinitions.VpcConfig }}'
      OutputDataConfig: '{{ response.TrainingJobDefinitions.OutputDataConfig }}'
      ResourceConfig: '{{ response.TrainingJobDefinitions.ResourceConfig }}'
      HyperParameterTuningResourceConfig: '{{ response.TrainingJobDefinitions.HyperParameterTuningResourceConfig
        }}'
      StoppingCondition: '{{ response.TrainingJobDefinitions.StoppingCondition }}'
      EnableNetworkIsolation: '{{ response.TrainingJobDefinitions.EnableNetworkIsolation
        }}'
      EnableInterContainerTrafficEncryption: '{{ response.TrainingJobDefinitions.EnableInterContainerTrafficEncryption
        }}'
      EnableManagedSpotTraining: '{{ response.TrainingJobDefinitions.EnableManagedSpotTraining
        }}'
      CheckpointConfig: '{{ response.TrainingJobDefinitions.CheckpointConfig }}'
      RetryStrategy: '{{ response.TrainingJobDefinitions.RetryStrategy }}'
      Environment: '{{ response.TrainingJobDefinitions.Environment }}'
checks:
- rule_id: aws.sagemaker.endpoint.logging_enabled
  for_each: aws.sagemaker.list_endpoints
  conditions:
    var: item.EndpointStatus
    op: equals
    value: ENABLED
- rule_id: aws.sagemaker.modelpackage.encryption_at_rest_enabled
  for_each: aws.sagemaker.list_model_packages
  conditions:
    var: item.ModelPackageArn
    op: exists
- rule_id: aws.sagemaker.trainingjob.vpc_configured
  for_each: aws.sagemaker.describe_hyper_parameter_tuning_job
  conditions:
    var: item.VpcConfig
    op: exists
- rule_id: aws.sagemaker.trainingjob.output_encryption_enabled
  for_each: aws.sagemaker.describe_hyper_parameter_tuning_job
  conditions:
    var: item.EnableInterContainerTrafficEncryption
    op: equals
    value: true
- rule_id: aws.sagemaker.featuregroup.online_store_kms_encryption_enabled
  for_each: aws.sagemaker.list_feature_groups
  conditions:
    var: item.FeatureGroupStatus
    op: equals
    value: ENABLED
- rule_id: aws.sagemaker.hyperparameter_tuning_job.logging_enabled
  for_each: aws.sagemaker.list_hyper_parameter_tuning_jobs
  conditions:
    var: item.HyperParameterTuningJobStatus
    op: equals
    value: ACTIVE
- rule_id: aws.sagemaker.model.sagemaker_cross_account_sharing_restricted
  for_each: aws.sagemaker.list_model_packages
  conditions:
    var: item.ModelApprovalStatus
    op: equals
    value: Approved
- rule_id: aws.sagemaker.models_vpc_settings_configured.models_vpc_settings_configured_configured
  for_each: aws.sagemaker.describe_hyper_parameter_tuning_job
  conditions:
    var: item.VpcConfig
    op: exists
- rule_id: aws.sagemaker.model.sagemaker_kms_cmk_used_configured
  for_each: aws.sagemaker.describe_device_fleet
  conditions:
    var: item.kms_key_id
    op: exists
- rule_id: aws.sagemaker.pipeline.kms_encryption_enabled
  for_each: aws.sagemaker.describe_device_fleet
  conditions:
    var: item.kms_key_id
    op: exists
- rule_id: aws.sagemaker.instance.encryption_enabled
  for_each: aws.sagemaker.describe_endpoint_config
  conditions:
    var: item.enable_ssm_access
    op: equals
    value: true
- rule_id: aws.sagemaker.trainingjob.volume_encryption_enabled
  for_each: aws.sagemaker.describe_hyper_parameter_tuning_job
  conditions:
    var: item.EnableInterContainerTrafficEncryption
    op: equals
    value: true
- rule_id: aws.sagemaker.notebook.instance_encryption_enabled
  for_each: aws.sagemaker.list_notebook_instance_lifecycle_configs
  conditions:
    var: item.NotebookInstanceLifecycleConfigName
    op: exists
- rule_id: aws.sagemaker.training_jobs_vpc_settings_configured.training_jobs_vpc_settings_configured_configured
  for_each: aws.sagemaker.describe_hyper_parameter_tuning_job
  conditions:
    var: item.VpcConfig
    op: exists
- rule_id: aws.sagemaker.endpoint.in_vpc_configured
  for_each: aws.sagemaker.describe_hyper_parameter_tuning_job
  conditions:
    var: item.VpcConfig
    op: exists
- rule_id: aws.sagemaker.endpoint_configuration.kms_keys_restricted
  for_each: aws.sagemaker.describe_device_fleet
  conditions:
    var: item.kms_key_id
    op: exists
- rule_id: aws.sagemaker.notebook_instance.private_networking_enforced
  for_each: aws.sagemaker.list_notebook_instance_lifecycle_configs
  conditions:
    var: item.NotebookInstanceLifecycleConfigName
    op: exists
- rule_id: aws.sagemaker.transformjob.logging_enabled
  for_each: aws.sagemaker.list_transform_jobs
  conditions:
    var: item.TransformJobStatus
    op: equals
    value: ENABLED
- rule_id: aws.sagemaker.instance.without_direct_internet_access_configured
  for_each: aws.sagemaker.list_notebook_instances
  conditions:
    var: item.NotebookInstanceStatus
    op: equals
    value: Disabled
- rule_id: aws.sagemaker.endpoint.kms_encryption_enabled
  for_each: aws.sagemaker.describe_device_fleet
  conditions:
    var: item.kms_key_id
    op: exists
- rule_id: aws.sagemaker.experiment.logging_enabled
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: ENABLED
- rule_id: aws.sagemaker.model.execution_role_least_privilege
  for_each: aws.sagemaker.describe_cluster
  conditions:
    var: item.ExecutionRole
    op: exists
- rule_id: aws.sagemaker.model.role_least_privilege
  for_each: aws.sagemaker.list_inference_experiments
  conditions:
    var: item.RoleArn
    op: exists
- rule_id: aws.sagemaker.resource.training_jobs_intercontainer_encryption_enabled
  for_each: aws.sagemaker.describe_hyper_parameter_tuning_job
  conditions:
    var: item.EnableInterContainerTrafficEncryption
    op: equals
    value: true
- rule_id: aws.sagemaker.transformjob.sagemaker_input_output_encrypted
  for_each: aws.sagemaker.list_transform_jobs
  conditions:
    var: item.TransformJobStatus
    op: equals
    value: Completed
- rule_id: aws.sagemaker.automljob.private_networking_enforced
  for_each: aws.sagemaker.describe_hyper_parameter_tuning_job
  conditions:
    var: item.VpcConfig
    op: exists
- rule_id: aws.sagemaker.flowdefinition.ui_private_networking_enforced
  for_each: aws.sagemaker.list_flow_definitions
  conditions:
    var: item.FlowDefinitionStatus
    op: equals
    value: ACTIVE
- rule_id: aws.sagemaker.notebook_instance.execution_role_least_privilege
  for_each: aws.sagemaker.describe_cluster
  conditions:
    var: item.ExecutionRole
    op: exists
- rule_id: aws.sagemaker.notebook.instance_without_direct_internet_access_configured
  for_each: aws.sagemaker.list_notebook_instances
  conditions:
    var: item.NotebookInstanceStatus
    op: equals
    value: Disabled
- rule_id: aws.sagemaker.trainingjob.logging_enabled
  for_each: aws.sagemaker.list_training_jobs
  conditions:
    var: item.TrainingJobStatus
    op: equals
    value: ENABLED
- rule_id: aws.sagemaker.transformjob.private_networking_enforced
  for_each: aws.sagemaker.list_transform_jobs
  conditions:
    var: item.TransformJobStatus
    op: equals
    value: COMPLETED
- rule_id: aws.sagemaker.model.sagemaker_artifact_encrypted_at_rest
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: ENABLED
- rule_id: aws.sagemaker.endpoint_configuration.logging_enabled
  for_each: aws.sagemaker.list_endpoints
  conditions:
    var: item.EndpointStatus
    op: equals
    value: InService
- rule_id: aws.sagemaker.endpoint_configuration.sagemaker_content_type_whitelist_enforced
  for_each: aws.sagemaker.list_inference_experiments
  conditions:
    var: item.supported_content_types
    op: exists
- rule_id: aws.sagemaker.notebook_instance.encryption_at_rest_enabled
  for_each: aws.sagemaker.list_notebook_instances
  conditions:
    var: item.NotebookInstanceStatus
    op: equals
    value: ENABLED
- rule_id: aws.sagemaker.experiment.sagemaker_metadata_store_encrypted
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: ENABLED
- rule_id: aws.sagemaker.notebook_instance.no_public_access_configured
  for_each: aws.sagemaker.list_domains
  conditions:
    var: item.Url
    op: equals
- rule_id: aws.sagemaker.trainingjob.network_isolation_enabled
  for_each: aws.sagemaker.describe_hyper_parameter_tuning_job
  conditions:
    var: item.EnableNetworkIsolation
    op: equals
    value: true
- rule_id: aws.sagemaker.endpoint.sagemaker_data_capture_s3_encrypted
  for_each: aws.sagemaker.describe_device_fleet
  conditions:
    var: item.kms_key_id
    op: exists
- rule_id: aws.sagemaker.endpoint_configuration.endpoint_in_vpc_configured
  for_each: aws.sagemaker.describe_hyper_parameter_tuning_job
  conditions:
    var: item.VpcConfig
    op: exists
- rule_id: aws.sagemaker.flowdefinition.sagemaker_artifacts_encrypted
  for_each: aws.sagemaker.list_flow_definitions
  conditions:
    var: item.FlowDefinitionStatus
    op: equals
    value: ACTIVE
- rule_id: aws.sagemaker.endpoint_configuration.kms_encryption_enabled
  for_each: aws.sagemaker.describe_device_fleet
  conditions:
    var: item.kms_key_id
    op: exists
- rule_id: aws.sagemaker.trainingjob.inter_container_traffic_encryption_enabled
  for_each: aws.sagemaker.describe_hyper_parameter_tuning_job
  conditions:
    var: item.EnableInterContainerTrafficEncryption
    op: equals
    value: true
- rule_id: aws.sagemaker.automljob.logging_enabled
  for_each: aws.sagemaker.list_auto_ml_jobs
  conditions:
    var: item.AutoMLJobStatus
    op: equals
    value: ENABLED
- rule_id: aws.sagemaker.model.sagemaker_image_scan_passed_configured
  for_each: aws.sagemaker.list_images
  conditions:
    var: item.ImageStatus
    op: equals
    value: ACTIVE
- rule_id: aws.sagemaker.endpoint.authn_required
  for_each: aws.sagemaker.list_endpoints
  conditions:
    var: item.EndpointStatus
    op: equals
    value: InService
- rule_id: aws.sagemaker.pipeline.logging_enabled
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: ENABLED
- rule_id: aws.sagemaker.featuregroup.sagemaker_offline_store_s3_encrypted
  for_each: aws.sagemaker.list_feature_groups
  conditions:
    var: item.OfflineStoreStatus
    op: equals
    value: ENABLED
- rule_id: aws.sagemaker.featuregroup.offline_store_block_public_access_configured
  for_each: aws.sagemaker.list_feature_groups
  conditions:
    var: item.OfflineStoreStatus
    op: equals
    value: DISABLED
- rule_id: aws.sagemaker.model.logging_enabled
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: ENABLED
- rule_id: aws.sagemaker.pipeline.iam_role_least_privileged_configured
  for_each: aws.sagemaker.list_inference_experiments
  conditions:
    var: item.RoleArn
    op: exists
- rule_id: aws.sagemaker.notebook_instance.sagemaker_idle_shutdown_configured
  for_each: aws.sagemaker.list_notebook_instance_lifecycle_configs
  conditions:
    var: item.NotebookInstanceLifecycleConfigName
    op: exists
- rule_id: aws.sagemaker.pipeline.role_least_privilege
  for_each: aws.sagemaker.list_inference_experiments
  conditions:
    var: item.RoleArn
    op: exists
- rule_id: aws.sagemaker.experiment.rbac_least_privilege
  for_each: aws.sagemaker.list_actions
  conditions:
    var: item.Status
    op: equals
    value: ACTIVE
- rule_id: aws.sagemaker.modelpackage.kms_encryption_enabled
  for_each: aws.sagemaker.describe_device_fleet
  conditions:
    var: item.kms_key_id
    op: exists
- rule_id: aws.sagemaker.instance.vpc_settings_configured
  for_each: aws.sagemaker.describe_hyper_parameter_tuning_job
  conditions:
    var: item.VpcConfig
    op: exists
- rule_id: aws.sagemaker.modelpackage.sagemaker_package_approved_configured
  for_each: aws.sagemaker.list_model_packages
  conditions:
    var: item.ModelApprovalStatus
    op: equals
    value: Approved
- rule_id: aws.sagemaker.model.artifact_encryption_enabled
  for_each: aws.sagemaker.describe_hyper_parameter_tuning_job
  conditions:
    var: item.EnableInterContainerTrafficEncryption
    op: equals
    value: true
