rule_id: aws.ecr.imagescan.scope_includes_all_asset_groups_configured
service: ecr
resource: imagescan
requirement: Scope Includes All Asset Groups Configuration
title: 'ECR imagescan: Scope Includes All Asset Groups Configured'
scope: ecr.imagescan.configuration
domain: configuration_and_change_management
subcategory: configuration_baseline
rationale: Ensures ecr imagescan has scope includes all asset groups configured properly
  configured for security compliance.
severity: medium
assertion_id: security.configuration.ecr_imagescan_scope_includes_all_asset_groups_configured
source: expert_generated
description: Verifies security configuration for AWS ECR imagescan to ensure alignment
  with AWS security best practices and compliance requirements. Proper configuration
  reduces security risks, maintains defense in depth, and supports overall security
  posture.
references:
- https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
remediation: "Enable encryption for ecr imagescan:\n\n1. Open ECR console\n2. Select\
  \ the imagescan\n3. Navigate to Properties/Configuration > Encryption\n4. Enable\
  \ encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n   - Customer\
  \ managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws ecr modify-imagescan\
  \ --imagescan-id <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\
  • Use customer-managed KMS keys for sensitive data\n• Enable automatic key rotation\n\
  • Implement proper key access policies\n• Audit key usage regularly"
