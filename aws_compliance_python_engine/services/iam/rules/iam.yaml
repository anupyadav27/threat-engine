version: 1.0
provider: aws
service: iam
discovery:
  discovery_id: aws.iam.users
  calls:
    - client: iam
      action: list_users
      paginate: true
  fields:
    - name: UserName
      save_as: user_name
  emit:
    items_for:
      as: resource
      item: user_name
checks:
  - title: Strong Authn Enabled
    severity: critical
    rule_id: aws.iam.user_mfa_status.strong_authn_enabled
    assertion_id: identity_access.authentication.strong_authn_enabled
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement strong authn enabled for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Strong Authn Enabled
    severity: critical
    rule_id: aws.iam.root_account_status.strong_authn_enabled
    assertion_id: identity_access.authentication.strong_authn_enabled
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement strong authn enabled for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Service Authn Configured
    severity: critical
    rule_id: aws.iam.user_mfa_status.service_authn_configured
    assertion_id: identity_access.authentication.service_authn_configured
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement service authn configured for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Service Authn Configured
    severity: critical
    rule_id: aws.iam.root_account_status.service_authn_configured
    assertion_id: identity_access.authentication.service_authn_configured
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement service authn configured for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Legacy Authn Disabled
    severity: critical
    rule_id: aws.iam.user_mfa_status.legacy_authn_disabled
    assertion_id: identity_access.authentication.legacy_authn_disabled
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement legacy authn disabled for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Legacy Authn Disabled
    severity: critical
    rule_id: aws.iam.root_account_status.legacy_authn_disabled
    assertion_id: identity_access.authentication.legacy_authn_disabled
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement legacy authn disabled for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Session Timeout Configured
    severity: critical
    rule_id: aws.iam.user_mfa_status.session_timeout_configured
    assertion_id: identity_access.authentication.session_timeout_configured
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement session timeout configured for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Session Timeout Configured
    severity: critical
    rule_id: aws.iam.root_account_status.session_timeout_configured
    assertion_id: identity_access.authentication.session_timeout_configured
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement session timeout configured for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Permission Boundaries Enforced
    severity: critical
    rule_id: aws.iam.role_policies.permission_boundaries_enforced
    assertion_id: identity_access.authorization.permission_boundaries_enforced
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement permission boundaries enforced for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Permission Boundaries Enforced
    severity: critical
    rule_id: aws.iam.managed_policies.permission_boundaries_enforced
    assertion_id: identity_access.authorization.permission_boundaries_enforced
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement permission boundaries enforced for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Permission Boundaries Enforced
    severity: critical
    rule_id: aws.iam.permission_boundaries.permission_boundaries_enforced
    assertion_id: identity_access.authorization.permission_boundaries_enforced
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement permission boundaries enforced for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Permission Boundaries Enforced
    severity: critical
    rule_id: aws.iam.inline_policies.permission_boundaries_enforced
    assertion_id: identity_access.authorization.permission_boundaries_enforced
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement permission boundaries enforced for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Permission Boundaries Enforced
    severity: critical
    rule_id: aws.iam.organization_policies.permission_boundaries_enforced
    assertion_id: identity_access.authorization.permission_boundaries_enforced
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement permission boundaries enforced for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Resource Policies Configured
    severity: critical
    rule_id: aws.iam.role_policies.resource_policies_configured
    assertion_id: identity_access.authorization.resource_policies_configured
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement resource policies configured for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Resource Policies Configured
    severity: critical
    rule_id: aws.iam.managed_policies.resource_policies_configured
    assertion_id: identity_access.authorization.resource_policies_configured
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement resource policies configured for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Resource Policies Configured
    severity: critical
    rule_id: aws.iam.permission_boundaries.resource_policies_configured
    assertion_id: identity_access.authorization.resource_policies_configured
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement resource policies configured for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Resource Policies Configured
    severity: critical
    rule_id: aws.iam.inline_policies.resource_policies_configured
    assertion_id: identity_access.authorization.resource_policies_configured
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement resource policies configured for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Resource Policies Configured
    severity: critical
    rule_id: aws.iam.organization_policies.resource_policies_configured
    assertion_id: identity_access.authorization.resource_policies_configured
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement resource policies configured for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Conditional Access Enabled
    severity: critical
    rule_id: aws.iam.role_policies.conditional_access_enabled
    assertion_id: identity_access.authorization.conditional_access_enabled
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement conditional access enabled for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Conditional Access Enabled
    severity: critical
    rule_id: aws.iam.managed_policies.conditional_access_enabled
    assertion_id: identity_access.authorization.conditional_access_enabled
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement conditional access enabled for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Conditional Access Enabled
    severity: critical
    rule_id: aws.iam.permission_boundaries.conditional_access_enabled
    assertion_id: identity_access.authorization.conditional_access_enabled
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement conditional access enabled for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Conditional Access Enabled
    severity: critical
    rule_id: aws.iam.inline_policies.conditional_access_enabled
    assertion_id: identity_access.authorization.conditional_access_enabled
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement conditional access enabled for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Conditional Access Enabled
    severity: critical
    rule_id: aws.iam.organization_policies.conditional_access_enabled
    assertion_id: identity_access.authorization.conditional_access_enabled
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement conditional access enabled for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: External Idp Configured
    severity: low
    rule_id: aws.iam.saml_providers.external_idp_configured
    assertion_id: identity_access.federation.external_idp_configured
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement external idp configured for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: External Idp Configured
    severity: low
    rule_id: aws.iam.oidc_providers.external_idp_configured
    assertion_id: identity_access.federation.external_idp_configured
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement external idp configured for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Trust Relationships Managed
    severity: low
    rule_id: aws.iam.saml_providers.trust_relationships_managed
    assertion_id: identity_access.federation.trust_relationships_managed
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement trust relationships managed for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Trust Relationships Managed
    severity: low
    rule_id: aws.iam.oidc_providers.trust_relationships_managed
    assertion_id: identity_access.federation.trust_relationships_managed
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement trust relationships managed for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Cross Account Access Controlled
    severity: low
    rule_id: aws.iam.saml_providers.cross_account_access_controlled
    assertion_id: identity_access.federation.cross_account_access_controlled
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement cross account access controlled for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Cross Account Access Controlled
    severity: low
    rule_id: aws.iam.oidc_providers.cross_account_access_controlled
    assertion_id: identity_access.federation.cross_account_access_controlled
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement cross account access controlled for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Enforced For Privileged Users
    severity: low
    rule_id: aws.iam.mfa.enforced_for_privileged_users
    assertion_id: identity_access.mfa.enforced_for_privileged_users
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement enforced for privileged users for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Backup Methods Configured
    severity: low
    rule_id: aws.iam.mfa.backup_methods_configured
    assertion_id: identity_access.mfa.backup_methods_configured
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement backup methods configured for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Hardware Tokens Required For Privileged
    severity: low
    rule_id: aws.iam.mfa.hardware_tokens_required_for_privileged
    assertion_id: identity_access.mfa.hardware_tokens_required_for_privileged
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement hardware tokens required for privileged for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Session Duration Limited
    severity: low
    rule_id: aws.iam.session_duration.session_duration_limited
    assertion_id: identity_access.session_management.session_duration_limited
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement session duration limited for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Temporary Credentials Controlled
    severity: low
    rule_id: aws.iam.session_duration.temporary_credentials_controlled
    assertion_id: identity_access.session_management.temporary_credentials_controlled
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement temporary credentials controlled for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Least Privilege Roles
    severity: low
    rule_id: aws.iam.role_definitions.least_privilege_roles
    assertion_id: rbac_entitlements.role_definition.least_privilege_roles
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement least privilege roles for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Least Privilege Roles
    severity: low
    rule_id: aws.iam.custom_policies.least_privilege_roles
    assertion_id: rbac_entitlements.role_definition.least_privilege_roles
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement least privilege roles for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Least Privilege Roles
    severity: low
    rule_id: aws.iam.service_linked_roles.least_privilege_roles
    assertion_id: rbac_entitlements.role_definition.least_privilege_roles
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement least privilege roles for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Service Linked Roles Used
    severity: low
    rule_id: aws.iam.role_definitions.service_linked_roles_used
    assertion_id: rbac_entitlements.role_definition.service_linked_roles_used
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement service linked roles used for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Service Linked Roles Used
    severity: low
    rule_id: aws.iam.custom_policies.service_linked_roles_used
    assertion_id: rbac_entitlements.role_definition.service_linked_roles_used
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement service linked roles used for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Service Linked Roles Used
    severity: low
    rule_id: aws.iam.service_linked_roles.service_linked_roles_used
    assertion_id: rbac_entitlements.role_definition.service_linked_roles_used
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement service linked roles used for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Principals Limited
    severity: low
    rule_id: aws.iam.role_assignments.principals_limited
    assertion_id: rbac_entitlements.role_assignment.principals_limited
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement principals limited for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Principals Limited
    severity: low
    rule_id: aws.iam.group_memberships.principals_limited
    assertion_id: rbac_entitlements.role_assignment.principals_limited
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement principals limited for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Principals Limited
    severity: low
    rule_id: aws.iam.resource_based_policies.principals_limited
    assertion_id: rbac_entitlements.role_assignment.principals_limited
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement principals limited for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Just In Time Access Enabled
    severity: low
    rule_id: aws.iam.role_assignments.just_in_time_access_enabled
    assertion_id: rbac_entitlements.role_assignment.just_in_time_access_enabled
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement just in time access enabled for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Just In Time Access Enabled
    severity: low
    rule_id: aws.iam.group_memberships.just_in_time_access_enabled
    assertion_id: rbac_entitlements.role_assignment.just_in_time_access_enabled
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement just in time access enabled for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Just In Time Access Enabled
    severity: low
    rule_id: aws.iam.resource_based_policies.just_in_time_access_enabled
    assertion_id: rbac_entitlements.role_assignment.just_in_time_access_enabled
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement just in time access enabled for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Access Reviews Conducted
    severity: low
    rule_id: aws.iam.least_privilege_analysis.access_reviews_conducted
    assertion_id: rbac_entitlements.least_privilege.access_reviews_conducted
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement access reviews conducted for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Access Reviews Conducted
    severity: low
    rule_id: aws.iam.permission_boundaries.access_reviews_conducted
    assertion_id: rbac_entitlements.least_privilege.access_reviews_conducted
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement access reviews conducted for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Unused Permissions Removed
    severity: low
    rule_id: aws.iam.least_privilege_analysis.unused_permissions_removed
    assertion_id: rbac_entitlements.least_privilege.unused_permissions_removed
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement unused permissions removed for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Unused Permissions Removed
    severity: low
    rule_id: aws.iam.permission_boundaries.unused_permissions_removed
    assertion_id: rbac_entitlements.least_privilege.unused_permissions_removed
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement unused permissions removed for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Lifecycle Managed
    severity: low
    rule_id: aws.iam.entitlement_policies.lifecycle_managed
    assertion_id: rbac_entitlements.entitlement_management.lifecycle_managed
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement lifecycle managed for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Lifecycle Managed
    severity: low
    rule_id: aws.iam.role_permissions.lifecycle_managed
    assertion_id: rbac_entitlements.entitlement_management.lifecycle_managed
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement lifecycle managed for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Lifecycle Managed
    severity: low
    rule_id: aws.iam.organization_policies.lifecycle_managed
    assertion_id: rbac_entitlements.entitlement_management.lifecycle_managed
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement lifecycle managed for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Temporary Access Controlled
    severity: low
    rule_id: aws.iam.entitlement_policies.temporary_access_controlled
    assertion_id: rbac_entitlements.entitlement_management.temporary_access_controlled
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement temporary access controlled for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Temporary Access Controlled
    severity: low
    rule_id: aws.iam.role_permissions.temporary_access_controlled
    assertion_id: rbac_entitlements.entitlement_management.temporary_access_controlled
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement temporary access controlled for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Temporary Access Controlled
    severity: low
    rule_id: aws.iam.organization_policies.temporary_access_controlled
    assertion_id: rbac_entitlements.entitlement_management.temporary_access_controlled
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement temporary access controlled for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Algorithm Standards Enforced
    severity: low
    rule_id: aws.iam.crypto_policies.algorithm_standards_enforced
    assertion_id: crypto_data_protection.crypto_policies.algorithm_standards_enforced
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement algorithm standards enforced for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Compliance Standards Met
    severity: low
    rule_id: aws.iam.crypto_policies.compliance_standards_met
    assertion_id: crypto_data_protection.crypto_policies.compliance_standards_met
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement compliance standards met for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Least Privilege Enforced
    severity: low
    rule_id: aws.iam.eks_service_roles.least_privilege_enforced
    assertion_id: containers_kubernetes.rbac_policies.least_privilege_enforced
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement least privilege enforced for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Service Account Restrictions
    severity: low
    rule_id: aws.iam.eks_service_roles.service_account_restrictions
    assertion_id: containers_kubernetes.rbac_policies.service_account_restrictions
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement service account restrictions for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Security Policies Defined
    severity: low
    rule_id: aws.iam.policy_management.security_policies_defined
    assertion_id: governance_compliance.policy_management.security_policies_defined
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement security policies defined for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Policy Compliance Monitored
    severity: low
    rule_id: aws.iam.policy_management.policy_compliance_monitored
    assertion_id: governance_compliance.policy_management.policy_compliance_monitored
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement policy compliance monitored for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
  - title: Policy Exceptions Managed
    severity: low
    rule_id: aws.iam.policy_management.policy_exceptions_managed
    assertion_id: governance_compliance.policy_management.policy_exceptions_managed
    for_each:
      as: resource
      item: user_name
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement policy exceptions managed for iam"
    references:
      - "https://docs.aws.amazon.com/iam/"
