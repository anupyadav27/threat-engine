rule_id: aws.iam.no_guest_accounts_with_permissions.no_guest_accounts_with_permissions_configured
service: iam
resource: no_guest_accounts_with_permissions
requirement: No Guest Accounts With Permissions Configuration
title: 'IAM no guest accounts with permissions: No Guest Accounts With Permissions
  Configured'
scope: iam.no_guest_accounts_with_permissions.access_control
domain: identity_and_access_management
subcategory: least_privilege
rationale: Ensures iam no_guest_accounts_with_permissions has no guest accounts with
  permissions configured properly configured for security compliance.
severity: high
assertion_id: identity_access.least_privilege.iam_no_guest_accounts_with_permissions_no_guest_accounts_with_permissions_configured
source: expert_generated
compliance:
- rbi_bank_multi_cloud_9.3_0027
description: Checks high-priority security configuration for AWS IAM no guest accounts
  with permissions to mitigate significant security risks. This control addresses
  vulnerabilities that could lead to unauthorized access, data exposure, or regulatory
  non-compliance if exploited.
references:
- https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html
- https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html
- https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
remediation: "Restrict public access for iam no_guest_accounts_with_permissions:\n\
  \n1. Open IAM console\n2. Select the no_guest_accounts_with_permissions\n3. Go to\
  \ Permissions/Access Control\n4. Review current permissions:\n   - Remove public\
  \ access grants\n   - Remove wildcard (*) principals\n   - Implement least privilege\n\
  5. Update resource policy or IAM policies\n6. Enable resource-level access control\n\
  7. Save changes\n\nSecurity Recommendations:\n• Use IAM roles instead of access\
  \ keys\n• Implement condition keys for additional security\n• Enable MFA for sensitive\
  \ operations\n• Regularly audit access permissions\n• Use AWS Organizations SCPs\
  \ for guardrails"
