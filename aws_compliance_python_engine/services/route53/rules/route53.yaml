version: 1.0
provider: aws
service: route53
discovery:
  discovery_id: aws.route53.resources
  calls:
    - client: route53
      action: describe_route53s
      paginate: true
  fields:
    - name: id
      save_as: resource_id
  emit:
    items_for:
      as: resource
      item: resource_id
checks:
  - title: Dns Filtering Enabled
    severity: low
    rule_id: aws.route53.dns_security.dns_filtering_enabled
    assertion_id: network_perimeter.dns_security.dns_filtering_enabled
    for_each:
      as: resource
      item: resource_id
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement dns filtering enabled for route53"
    references:
      - "https://docs.aws.amazon.com/route53/"
  - title: Private Dns Zones Used
    severity: low
    rule_id: aws.route53.dns_security.private_dns_zones_used
    assertion_id: network_perimeter.dns_security.private_dns_zones_used
    for_each:
      as: resource
      item: resource_id
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement private dns zones used for route53"
    references:
      - "https://docs.aws.amazon.com/route53/"
  - title: Dr Plan Documented
    severity: low
    rule_id: aws.route53.health_checks.dr_plan_documented
    assertion_id: resilience_recovery.disaster_recovery.dr_plan_documented
    for_each:
      as: resource
      item: resource_id
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement dr plan documented for route53"
    references:
      - "https://docs.aws.amazon.com/route53/"
  - title: Rto Rpo Defined
    severity: low
    rule_id: aws.route53.health_checks.rto_rpo_defined
    assertion_id: resilience_recovery.disaster_recovery.rto_rpo_defined
    for_each:
      as: resource
      item: resource_id
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement rto rpo defined for route53"
    references:
      - "https://docs.aws.amazon.com/route53/"
  - title: Cross Region Replication Enabled
    severity: low
    rule_id: aws.route53.health_checks.cross_region_replication_enabled
    assertion_id: resilience_recovery.disaster_recovery.cross_region_replication_enabled
    for_each:
      as: resource
      item: resource_id
    conditions:
      - field: resource.compliant
        operator: equals
        value: true
    remediation: "Implement cross region replication enabled for route53"
    references:
      - "https://docs.aws.amazon.com/route53/"
