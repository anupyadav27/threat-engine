version: '1.0'
provider: aws
service: wellarchitected
services:
  client: wellarchitected
  module: boto3.client
discovery:
- discovery_id: aws.wellarchitected.get_global_settings
  calls:
  - action: get_global_settings
    save_as: response
  emit:
    item:
      IntegrationStatus: '{{ response.JiraConfiguration.IntegrationStatus }}'
      IssueManagementStatus: '{{ response.JiraConfiguration.IssueManagementStatus
        }}'
      IssueManagementType: '{{ response.JiraConfiguration.IssueManagementType }}'
      Subdomain: '{{ response.JiraConfiguration.Subdomain }}'
      JiraProjectKey: '{{ response.JiraConfiguration.JiraProjectKey }}'
      StatusMessage: '{{ response.JiraConfiguration.StatusMessage }}'
      Status: '{{ resource.Status }}'
checks:
- rule_id: aws.wellarchitected.workload.wellarchitected_no_high_or_medium_risks_configured
  for_each: aws.wellarchitected.get_global_settings
  conditions:
    var: item.Status
    op: not_equals
    value: 'null'
