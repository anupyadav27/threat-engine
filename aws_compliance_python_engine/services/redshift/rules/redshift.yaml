version: '1.0'
provider: aws
service: redshift
discovery:
- discovery_id: aws.redshift.securitygroups
  calls:
  - client: redshift
    action: describe_clusters
    save_as: securitygroup_list
    on_error: continue
    fields:
    - Redshifts
  emit:
    items_for: securitygroup_list[]
    as: securitygroup
    item:
      id: '{{ securitygroup.Id }}'
      name: '{{ securitygroup.Name }}'
- discovery_id: aws.redshift.securitygroup_encryption
  for_each: aws.redshift.securitygroups
  calls:
  - client: redshift
    action: describe_clusters
    params:
      SecuritygroupId: '{{ item.id }}'
    save_as: encryption
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      encryption_enabled: '{{ encryption.Encrypted if encryption.Encrypted is defined else false }}'
- discovery_id: aws.redshift.securitygroup_logging
  for_each: aws.redshift.securitygroups
  calls:
  - client: redshift
    action: describe_account_attributes
    params:
      SecuritygroupId: '{{ item.id }}'
    save_as: logging
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      logging_enabled: '{{ logging.LoggingEnabled is defined if logging else false }}'
- discovery_id: aws.redshift.event_subscriptions
  for_each: aws.redshift.event_subscription
  calls:
  - client: redshift
    action: describe_event_subscriptions
    save_as: event_subscriptions
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.redshift.users
  for_each: aws.redshift.user
  calls:
  - client: redshift
    action: describe_account_attributes
    save_as: users
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.redshift.parametergroups
  for_each: aws.redshift.parametergroup
  calls:
  - client: redshift
    action: describe_account_attributes
    save_as: parametergroups
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.redshift.snapshot_encryption
  calls:
  - client: redshift
    action: list_recommendations
    save_as: snapshot_encryption
    on_error: continue
  emit:
    items_for: snapshot_encryption[]
    as: snapshot_encryption
    item:
      id: '{{ snapshot_encryption.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.redshift.resources
  for_each: aws.redshift.resource
  calls:
  - client: redshift
    action: describe_account_attributes
    save_as: resources
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.redshift.subnetgroups
  for_each: aws.redshift.subnetgroup
  calls:
  - client: redshift
    action: describe_account_attributes
    save_as: subnetgroups
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.redshift.clusters
  for_each: aws.redshift.cluster
  calls:
  - client: redshift
    action: describe_clusters
    save_as: clusters
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.redshift.endpoint_authorizations
  for_each: aws.redshift.endpoint_authorization
  calls:
  - client: redshift
    action: describe_account_attributes
    save_as: endpoint_authorizations
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.redshift.endpointaccesss
  for_each: aws.redshift.endpointacce
  calls:
  - client: redshift
    action: describe_account_attributes
    save_as: endpointaccesss
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.redshift.hsm_client_certificates
  for_each: aws.redshift.hsm_client_certificate
  calls:
  - client: redshift
    action: describe_hsm_client_certificates
    save_as: hsm_client_certificates
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.redshift.cluster_logging
  calls:
  - client: redshift
    action: list_recommendations
    save_as: cluster_logging
    on_error: continue
  emit:
    items_for: cluster_logging[]
    as: cluster_logging
    item:
      id: '{{ cluster_logging.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.redshift.hsm_configurations
  for_each: aws.redshift.hsm_configuration
  calls:
  - client: redshift
    action: describe_hsm_configurations
    save_as: hsm_configurations
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.redshift.event_subscription_encryption
  calls:
  - client: redshift
    action: list_recommendations
    save_as: event_subscription_encryption
    on_error: continue
  emit:
    items_for: event_subscription_encryption[]
    as: event_subscription_encryption
    item:
      id: '{{ event_subscription_encryption.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.redshift.snapshots
  for_each: aws.redshift.snapshot
  calls:
  - client: redshift
    action: describe_snapshot_schedules
    save_as: snapshots
    on_error: continue
  emit:
    item:
      resource_id: '{{ item.id }}'
      compliant: '{{ true }}'
- discovery_id: aws.redshift.cluster_encryption
  calls:
  - client: redshift
    action: list_recommendations
    save_as: cluster_encryption
    on_error: continue
  emit:
    items_for: cluster_encryption[]
    as: cluster_encryption
    item:
      id: '{{ cluster_encryption.Id }}'
      compliant: '{{ true }}'
- discovery_id: aws.redshift.parametergroup_logging
  calls:
  - client: redshift
    action: list_recommendations
    save_as: parametergroup_logging
    on_error: continue
  emit:
    items_for: parametergroup_logging[]
    as: parametergroup_logging
    item:
      id: '{{ parametergroup_logging.Id }}'
      compliant: '{{ true }}'
checks:
- title: 'REDSHIFT hsm configuration: Redshift Configuration Present'
  severity: medium
  rule_id: aws.redshift.hsm_configuration.redshift_configuration_present
  for_each:
    discovery: aws.redshift.hsm_configurations
    as: hsm_configuration
    item: hsm_configuration
  conditions:
    var: hsm_configuration.compliant
    op: equals
    value: true
  remediation: "Configure redshift hsm_configuration for compliance:\n\nRequirement: Redshift Configuration Present\n\nDescription:\
    \ Verifies security configuration for Amazon Redshift hsm configuration to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open REDSHIFT console\n2. Select the hsm_configuration\n3. Review security configuration\n\
    4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT hsm configuration: Keys In Hsm Only Configured'
  severity: medium
  rule_id: aws.redshift.hsm_configuration.keys_in_hsm_only_configured
  for_each:
    discovery: aws.redshift.hsm_configurations
    as: hsm_configuration
    item: hsm_configuration
  conditions:
    var: hsm_configuration.compliant
    op: equals
    value: true
  remediation: "Configure redshift hsm_configuration for compliance:\n\nRequirement: Keys In Hsm Only Configuration\n\nDescription:\
    \ Verifies security configuration for Amazon Redshift hsm configuration to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open REDSHIFT console\n2. Select the hsm_configuration\n3. Review security configuration\n\
    4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT securitygroup: Security Only Required Ports Open Restricted'
  severity: medium
  rule_id: aws.redshift.securitygroup.security_only_required_ports_open_restricted
  for_each:
    discovery: aws.redshift.securitygroups
    as: securitygroup
    item: securitygroup
  conditions:
    var: securitygroup.compliant
    op: equals
    value: true
  remediation: "Configure redshift securitygroup for compliance:\n\nRequirement: Security Only Required Ports Open Restricted\n\
    \nDescription: Verifies security configuration for Amazon Redshift securitygroup to ensure alignment with AWS security\
    \ best practices and compliance requirements. Proper configuration reduces security risks, maintains defense in depth,\
    \ and supports overall security posture.\n\nSteps:\n1. Open REDSHIFT console\n2. Select the securitygroup\n3. Review security\
    \ configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral\
    \ Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable\
    \ logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT parametergroup: Audit Logging Enabled'
  severity: medium
  rule_id: aws.redshift.parametergroup.audit_logging_enabled
  for_each:
    discovery: aws.redshift.parametergroup_logging
    as: parametergroup
    item: parametergroup
  conditions:
    var: logging.logging_enabled
    op: equals
    value: true
  remediation: "Enable logging for redshift parametergroup:\n\n1. Open REDSHIFT console\n2. Select the parametergroup\n3.\
    \ Go to Logging/Monitoring settings\n4. Enable logging\n5. Configure log destination:\n   - CloudWatch Logs\n   - S3 bucket\
    \ (for long-term retention)\n6. Set log level (INFO, DEBUG, ERROR)\n7. Save changes\n\nAWS CLI:\naws redshift update-parametergroup-logging\
    \ --parametergroup-id <id> --logging-enabled\n\nBest Practices:\n\u2022 Enable all security-relevant log types\n\u2022\
    \ Send logs to centralized logging service\n\u2022 Set appropriate retention periods\n\u2022 Configure log encryption\n\
    \u2022 Set up log monitoring and alerting"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT cluster: Admin Access Least Privilege'
  severity: high
  rule_id: aws.redshift.cluster.admin_access_least_privilege
  for_each:
    discovery: aws.redshift.clusters
    as: cluster
    item: cluster
  conditions:
    var: cluster.is_public
    op: equals
    value: false
  remediation: "Restrict public access for redshift cluster:\n\n1. Open REDSHIFT console\n2. Select the cluster\n3. Go to\
    \ Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*)\
    \ principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access\
    \ control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT endpointaccess: Tls Required'
  severity: high
  rule_id: aws.redshift.endpointaccess.tls_required
  for_each:
    discovery: aws.redshift.endpointaccesss
    as: endpointaccess
    item: endpointaccess
  conditions:
    var: endpointaccess.is_public
    op: equals
    value: false
  remediation: "Restrict public access for redshift endpointaccess:\n\n1. Open REDSHIFT console\n2. Select the endpointaccess\n\
    3. Go to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT endpointaccess: Access Allowed Cidrs Minimized Configured'
  severity: medium
  rule_id: aws.redshift.endpointaccess.access_allowed_cidrs_minimized_configured
  for_each:
    discovery: aws.redshift.endpointaccesss
    as: endpointaccess
    item: endpointaccess
  conditions:
    var: endpointaccess.is_public
    op: equals
    value: false
  remediation: "Restrict public access for redshift endpointaccess:\n\n1. Open REDSHIFT console\n2. Select the endpointaccess\n\
    3. Go to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT event subscription: Redshift Destination Encrypted'
  severity: high
  rule_id: aws.redshift.event_subscription.redshift_destination_encrypted
  for_each:
    discovery: aws.redshift.event_subscription_encryption
    as: event_subscription
    item: event_subscription
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for redshift event_subscription:\n\n1. Open REDSHIFT console\n2. Select the event_subscription\n\
    3. Navigate to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed\
    \ key (default)\n   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws redshift modify-event_subscription\
    \ --event_subscription-id <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed\
    \ KMS keys for sensitive data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022\
    \ Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT event subscription: Redshift Cross Account Sharing Restricted'
  severity: medium
  rule_id: aws.redshift.event_subscription.redshift_cross_account_sharing_restricted
  for_each:
    discovery: aws.redshift.event_subscriptions
    as: event_subscription
    item: event_subscription
  conditions:
    var: event_subscription.compliant
    op: equals
    value: true
  remediation: "Configure redshift event_subscription for compliance:\n\nRequirement: Redshift Cross Account Sharing Restricted\n\
    \nDescription: Verifies security configuration for Amazon Redshift event subscription to ensure alignment with AWS security\
    \ best practices and compliance requirements. Proper configuration reduces security risks, maintains defense in depth,\
    \ and supports overall security posture.\n\nSteps:\n1. Open REDSHIFT console\n2. Select the event_subscription\n3. Review\
    \ security configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\
    \nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\
    \u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT cluster: Audit Logging Enabled'
  severity: medium
  rule_id: aws.redshift.cluster.audit_logging_enabled
  for_each:
    discovery: aws.redshift.cluster_logging
    as: cluster
    item: cluster
  conditions:
    var: logging.logging_enabled
    op: equals
    value: true
  remediation: "Enable logging for redshift cluster:\n\n1. Open REDSHIFT console\n2. Select the cluster\n3. Go to Logging/Monitoring\
    \ settings\n4. Enable logging\n5. Configure log destination:\n   - CloudWatch Logs\n   - S3 bucket (for long-term retention)\n\
    6. Set log level (INFO, DEBUG, ERROR)\n7. Save changes\n\nAWS CLI:\naws redshift update-cluster-logging --cluster-id <id>\
    \ --logging-enabled\n\nBest Practices:\n\u2022 Enable all security-relevant log types\n\u2022 Send logs to centralized\
    \ logging service\n\u2022 Set appropriate retention periods\n\u2022 Configure log encryption\n\u2022 Set up log monitoring\
    \ and alerting"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT hsm client certificate: Key Length Minimum'
  severity: medium
  rule_id: aws.redshift.hsm_client_certificate.key_length_minimum
  for_each:
    discovery: aws.redshift.hsm_client_certificates
    as: hsm_client_certificate
    item: hsm_client_certificate
  conditions:
    var: hsm_client_certificate.compliant
    op: equals
    value: true
  remediation: "Configure redshift hsm_client_certificate for compliance:\n\nRequirement: Key Length Minimum\n\nDescription:\
    \ Verifies security configuration for Amazon Redshift hsm client certificate to ensure alignment with AWS security best\
    \ practices and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and\
    \ supports overall security posture.\n\nSteps:\n1. Open REDSHIFT console\n2. Select the hsm_client_certificate\n3. Review\
    \ security configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\
    \nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\
    \u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT parametergroup: Require Ssl Configured'
  severity: high
  rule_id: aws.redshift.parametergroup.require_ssl_configured
  for_each:
    discovery: aws.redshift.parametergroups
    as: parametergroup
    item: parametergroup
  conditions:
    var: parametergroup.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for redshift parametergroup:\n\n1. Ensure parametergroup is deployed in VPC\n2.\
    \ Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use\
    \ least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n\
    5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\
    \u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement\
    \ defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT hsm configuration: Only Approved Hsm Endpoints Configured'
  severity: medium
  rule_id: aws.redshift.hsm_configuration.only_approved_hsm_endpoints_configured
  for_each:
    discovery: aws.redshift.hsm_configurations
    as: hsm_configuration
    item: hsm_configuration
  conditions:
    var: hsm_configuration.compliant
    op: equals
    value: true
  remediation: "Configure redshift hsm_configuration for compliance:\n\nRequirement: Only Approved Hsm Endpoints Configuration\n\
    \nDescription: Verifies security configuration for Amazon Redshift hsm configuration to ensure alignment with AWS security\
    \ best practices and compliance requirements. Proper configuration reduces security risks, maintains defense in depth,\
    \ and supports overall security posture.\n\nSteps:\n1. Open REDSHIFT console\n2. Select the hsm_configuration\n3. Review\
    \ security configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\
    \nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\
    \u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT endpoint authorization: No Anonymous Access Configured'
  severity: medium
  rule_id: aws.redshift.endpoint_authorization.no_anonymous_access_configured
  for_each:
    discovery: aws.redshift.endpoint_authorizations
    as: endpoint_authorization
    item: endpoint_authorization
  conditions:
    var: endpoint_authorization.is_public
    op: equals
    value: false
  remediation: "Restrict public access for redshift endpoint_authorization:\n\n1. Open REDSHIFT console\n2. Select the endpoint_authorization\n\
    3. Go to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT user: Redshift Approved List Of Supers Only Configured'
  severity: medium
  rule_id: aws.redshift.user.redshift_approved_list_of_supers_only_configured
  for_each:
    discovery: aws.redshift.users
    as: user
    item: user
  conditions:
    var: user.compliant
    op: equals
    value: true
  remediation: "Configure redshift user for compliance:\n\nRequirement: Redshift Approved List Of Supers Only Configuration\n\
    \nDescription: Verifies security configuration for Amazon Redshift user to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open REDSHIFT console\n2. Select the user\n3. Review security configuration\n4. Apply\
    \ required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: Data warehouse encryption is enabled
  severity: high
  rule_id: aws.redshift.cluster.in_transit_encryption_enabled
  for_each:
    discovery: aws.redshift.cluster_encryption
    as: cluster
    item: cluster
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for redshift cluster:\n\n1. Open REDSHIFT console\n2. Select the cluster\n3. Navigate to\
    \ Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws redshift modify-cluster --cluster-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT resource: Backup Enabled'
  severity: medium
  rule_id: aws.redshift.resource.backup_enabled
  for_each:
    discovery: aws.redshift.resources
    as: resource
    item: resource
  conditions:
    var: resource.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for redshift resource:\n\n1. Open REDSHIFT console\n2. Select the resource\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT securitygroup: Security No 0 Configured'
  severity: medium
  rule_id: aws.redshift.securitygroup.security_no_0_configured
  for_each:
    discovery: aws.redshift.securitygroups
    as: securitygroup
    item: securitygroup
  conditions:
    var: securitygroup.compliant
    op: equals
    value: true
  remediation: "Configure redshift securitygroup for compliance:\n\nRequirement: Security No 0 Configuration\n\nDescription:\
    \ Verifies security configuration for Amazon Redshift securitygroup to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open REDSHIFT console\n2. Select the securitygroup\n3. Review security configuration\n\
    4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT cluster: Enhanced Vpc Routing Configured'
  severity: high
  rule_id: aws.redshift.cluster.enhanced_vpc_routing_configured
  for_each:
    discovery: aws.redshift.clusters
    as: cluster
    item: cluster
  conditions:
    var: cluster.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for redshift cluster:\n\n1. Ensure cluster is deployed in VPC\n2. Configure security\
    \ groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3.\
    \ Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT cluster: Automated Snapshot Configured'
  severity: medium
  rule_id: aws.redshift.cluster.automated_snapshot_configured
  for_each:
    discovery: aws.redshift.clusters
    as: cluster
    item: cluster
  conditions:
    var: cluster.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for redshift cluster:\n\n1. Open REDSHIFT console\n2. Select the cluster\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT subnetgroup: Redshift Private Subnets Only Configured'
  severity: high
  rule_id: aws.redshift.subnetgroup.redshift_private_subnets_only_configured
  for_each:
    discovery: aws.redshift.subnetgroups
    as: subnetgroup
    item: subnetgroup
  conditions:
    var: subnetgroup.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for redshift subnetgroup:\n\n1. Ensure subnetgroup is deployed in VPC\n2. Configure\
    \ security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n\
    3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT cluster: Deletion Protection Enabled'
  severity: medium
  rule_id: aws.redshift.cluster.deletion_protection_enabled
  for_each:
    discovery: aws.redshift.clusters
    as: cluster
    item: cluster
  conditions:
    var: cluster.compliant
    op: equals
    value: true
  remediation: "Configure redshift cluster for compliance:\n\nRequirement: Deletion Protection\n\nDescription: Ensures Amazon\
    \ Redshift cluster has deletion protection enabled to prevent accidental or malicious removal. Deletion protection provides\
    \ a safety mechanism requiring explicit disablement before deletion, preventing service disruption and data loss.\n\n\
    Steps:\n1. Open REDSHIFT console\n2. Select the cluster\n3. Review security configuration\n4. Apply required settings\
    \ per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow\
    \ AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use\
    \ encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT cluster: Multi Az Enabled'
  severity: medium
  rule_id: aws.redshift.cluster.multi_az_enabled
  for_each:
    discovery: aws.redshift.clusters
    as: cluster
    item: cluster
  conditions:
    var: cluster.compliant
    op: equals
    value: true
  remediation: "Configure redshift cluster for compliance:\n\nRequirement: Multi Az Enabled\n\nDescription: Verifies security\
    \ configuration for Amazon Redshift cluster to ensure alignment with AWS security best practices and compliance requirements.\
    \ Proper configuration reduces security risks, maintains defense in depth, and supports overall security posture.\n\n\
    Steps:\n1. Open REDSHIFT console\n2. Select the cluster\n3. Review security configuration\n4. Apply required settings\
    \ per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\u2022 Follow\
    \ AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\u2022 Use\
    \ encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT cluster: Minor Version Auto Upgrade Enabled'
  severity: low
  rule_id: aws.redshift.cluster.minor_version_auto_upgrade_enabled
  for_each:
    discovery: aws.redshift.clusters
    as: cluster
    item: cluster
  conditions:
    var: cluster.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for redshift cluster:\n\n1. Open REDSHIFT console\n2. Select the cluster\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT endpoint authorization: Rbac Least Privilege'
  severity: high
  rule_id: aws.redshift.endpoint_authorization.rbac_least_privilege
  for_each:
    discovery: aws.redshift.endpoint_authorizations
    as: endpoint_authorization
    item: endpoint_authorization
  conditions:
    var: endpoint_authorization.is_public
    op: equals
    value: false
  remediation: "Restrict public access for redshift endpoint_authorization:\n\n1. Open REDSHIFT console\n2. Select the endpoint_authorization\n\
    3. Go to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT cluster: Private Networking Enforced'
  severity: high
  rule_id: aws.redshift.cluster.private_networking_enforced
  for_each:
    discovery: aws.redshift.clusters
    as: cluster
    item: cluster
  conditions:
    var: cluster.is_public
    op: equals
    value: false
  remediation: "Restrict public access for redshift cluster:\n\n1. Open REDSHIFT console\n2. Select the cluster\n3. Go to\
    \ Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*)\
    \ principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access\
    \ control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT hsm client certificate: Certificate Trusted Issuer Verified'
  severity: medium
  rule_id: aws.redshift.hsm_client_certificate.certificate_trusted_issuer_verified
  for_each:
    discovery: aws.redshift.hsm_client_certificates
    as: hsm_client_certificate
    item: hsm_client_certificate
  conditions:
    var: hsm_client_certificate.compliant
    op: equals
    value: true
  remediation: "Configure redshift hsm_client_certificate for compliance:\n\nRequirement: Certificate Trusted Issuer Verified\n\
    \nDescription: Verifies security configuration for Amazon Redshift hsm client certificate to ensure alignment with AWS\
    \ security best practices and compliance requirements. Proper configuration reduces security risks, maintains defense\
    \ in depth, and supports overall security posture.\n\nSteps:\n1. Open REDSHIFT console\n2. Select the hsm_client_certificate\n\
    3. Review security configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save\
    \ changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense\
    \ in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT cluster: Tls Min 1 2 Enforced'
  severity: high
  rule_id: aws.redshift.cluster.tls_min_1_2_enforced
  for_each:
    discovery: aws.redshift.clusters
    as: cluster
    item: cluster
  conditions:
    var: cluster.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for redshift cluster:\n\n1. Ensure cluster is deployed in VPC\n2. Configure security\
    \ groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use least privilege\n3.\
    \ Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n5. Use Private Link/VPC\
    \ Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\u2022 Deploy\
    \ in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement defense in depth\n\
    \u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT securitygroup: Security Egress Restricted'
  severity: medium
  rule_id: aws.redshift.securitygroup.security_egress_restricted
  for_each:
    discovery: aws.redshift.securitygroups
    as: securitygroup
    item: securitygroup
  conditions:
    var: securitygroup.compliant
    op: equals
    value: true
  remediation: "Configure redshift securitygroup for compliance:\n\nRequirement: Security Egress Restricted\n\nDescription:\
    \ Verifies security configuration for Amazon Redshift securitygroup to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open REDSHIFT console\n2. Select the securitygroup\n3. Review security configuration\n\
    4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT securitygroup: Security No 0 Ingress Configured'
  severity: medium
  rule_id: aws.redshift.securitygroup.security_no_0_ingress_configured
  for_each:
    discovery: aws.redshift.securitygroups
    as: securitygroup
    item: securitygroup
  conditions:
    var: securitygroup.compliant
    op: equals
    value: true
  remediation: "Configure redshift securitygroup for compliance:\n\nRequirement: Security No 0 Ingress Configuration\n\nDescription:\
    \ Verifies security configuration for Amazon Redshift securitygroup to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open REDSHIFT console\n2. Select the securitygroup\n3. Review security configuration\n\
    4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT securitygroup: Security No 0 Ingress On Db Ports Configured'
  severity: medium
  rule_id: aws.redshift.securitygroup.security_no_0_ingress_on_db_ports_configured
  for_each:
    discovery: aws.redshift.securitygroups
    as: securitygroup
    item: securitygroup
  conditions:
    var: securitygroup.compliant
    op: equals
    value: true
  remediation: "Configure redshift securitygroup for compliance:\n\nRequirement: Security No 0 Ingress On Db Ports Configuration\n\
    \nDescription: Verifies security configuration for Amazon Redshift securitygroup to ensure alignment with AWS security\
    \ best practices and compliance requirements. Proper configuration reduces security risks, maintains defense in depth,\
    \ and supports overall security posture.\n\nSteps:\n1. Open REDSHIFT console\n2. Select the securitygroup\n3. Review security\
    \ configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral\
    \ Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable\
    \ logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT cluster: Public Access Configured'
  severity: high
  rule_id: aws.redshift.cluster.public_access_configured
  for_each:
    discovery: aws.redshift.clusters
    as: cluster
    item: cluster
  conditions:
    var: cluster.is_public
    op: equals
    value: false
  remediation: "Restrict public access for redshift cluster:\n\n1. Open REDSHIFT console\n2. Select the cluster\n3. Go to\
    \ Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*)\
    \ principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access\
    \ control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT user: Iam Auth Preferred Configured'
  severity: high
  rule_id: aws.redshift.user.iam_auth_preferred_configured
  for_each:
    discovery: aws.redshift.users
    as: user
    item: user
  conditions:
    var: user.is_public
    op: equals
    value: false
  remediation: "Restrict public access for redshift user:\n\n1. Open REDSHIFT console\n2. Select the user\n3. Go to Permissions/Access\
    \ Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*) principals\n   -\
    \ Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access control\n7. Save\
    \ changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement condition keys for\
    \ additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\u2022 Use\
    \ AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT cluster: Encryption At Rest Cmek Configured'
  severity: high
  rule_id: aws.redshift.cluster.encryption_at_rest_cmek_configured
  for_each:
    discovery: aws.redshift.cluster_encryption
    as: cluster
    item: cluster
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for redshift cluster:\n\n1. Open REDSHIFT console\n2. Select the cluster\n3. Navigate to\
    \ Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws redshift modify-cluster --cluster-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT cluster: Maintenance Settings Configured'
  severity: medium
  rule_id: aws.redshift.cluster.maintenance_settings_configured
  for_each:
    discovery: aws.redshift.clusters
    as: cluster
    item: cluster
  conditions:
    var: cluster.compliant
    op: equals
    value: true
  remediation: "Configure redshift cluster for compliance:\n\nRequirement: Maintenance Settings Configuration\n\nDescription:\
    \ Verifies security configuration for Amazon Redshift cluster to ensure alignment with AWS security best practices and\
    \ compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open REDSHIFT console\n2. Select the cluster\n3. Review security configuration\n4. Apply\
    \ required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT snapshot: Encryption At Rest Enabled'
  severity: high
  rule_id: aws.redshift.snapshot.encryption_at_rest_enabled
  for_each:
    discovery: aws.redshift.snapshot_encryption
    as: snapshot
    item: snapshot
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for redshift snapshot:\n\n1. Open REDSHIFT console\n2. Select the snapshot\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws redshift modify-snapshot --snapshot-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT snapshot: Redshift Cross Account Sharing Restricted'
  severity: medium
  rule_id: aws.redshift.snapshot.redshift_cross_account_sharing_restricted
  for_each:
    discovery: aws.redshift.snapshots
    as: snapshot
    item: snapshot
  conditions:
    var: snapshot.versioning_enabled
    op: equals
    value: true
  remediation: "Enable versioning for redshift snapshot:\n\n1. Open REDSHIFT console\n2. Select the snapshot\n3. Go to Properties\
    \ > Versioning\n4. Enable versioning\n5. Configure retention policies\n6. Set up lifecycle rules (optional)\n7. Save changes\n\
    \nBenefits:\n\u2022 Protection against accidental deletion\n\u2022 Ability to recover from ransomware\n\u2022 Audit trail\
    \ of changes\n\u2022 Point-in-time recovery"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT snapshot: Not Publicly Shared Configured'
  severity: high
  rule_id: aws.redshift.snapshot.not_publicly_shared_configured
  for_each:
    discovery: aws.redshift.snapshots
    as: snapshot
    item: snapshot
  conditions:
    var: snapshot.is_public
    op: equals
    value: false
  remediation: "Restrict public access for redshift snapshot:\n\n1. Open REDSHIFT console\n2. Select the snapshot\n3. Go to\
    \ Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard (*)\
    \ principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level access\
    \ control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT event subscription: Redshift Destination Least Privilege'
  severity: high
  rule_id: aws.redshift.event_subscription.redshift_destination_least_privilege
  for_each:
    discovery: aws.redshift.event_subscriptions
    as: event_subscription
    item: event_subscription
  conditions:
    var: event_subscription.is_public
    op: equals
    value: false
  remediation: "Restrict public access for redshift event_subscription:\n\n1. Open REDSHIFT console\n2. Select the event_subscription\n\
    3. Go to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT parametergroup: Tls Required'
  severity: high
  rule_id: aws.redshift.parametergroup.tls_required
  for_each:
    discovery: aws.redshift.parametergroups
    as: parametergroup
    item: parametergroup
  conditions:
    var: parametergroup.in_vpc
    op: equals
    value: true
  remediation: "Configure network security for redshift parametergroup:\n\n1. Ensure parametergroup is deployed in VPC\n2.\
    \ Configure security groups:\n   - Restrict inbound traffic to necessary ports\n   - Limit source IP ranges\n   - Use\
    \ least privilege\n3. Configure network ACLs for subnet-level control\n4. Enable VPC Flow Logs for network monitoring\n\
    5. Use Private Link/VPC Endpoints where available\n6. Enable TLS/SSL for data in transit\n\nNetwork Security Best Practices:\n\
    \u2022 Deploy in private subnets when possible\n\u2022 Use NAT Gateway for outbound internet access\n\u2022 Implement\
    \ defense in depth\n\u2022 Enable encryption in transit\n\u2022 Monitor network traffic"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT parametergroup: Redshift Insecure Features Disabled If Applicable Configured'
  severity: medium
  rule_id: aws.redshift.parametergroup.redshift_insecure_features_disabled_if_applicable_configured
  for_each:
    discovery: aws.redshift.parametergroups
    as: parametergroup
    item: parametergroup
  conditions:
    var: parametergroup.compliant
    op: equals
    value: true
  remediation: "Configure redshift parametergroup for compliance:\n\nRequirement: Redshift Insecure Features Disabled If Applicable\
    \ Configuration\n\nDescription: Verifies security configuration for Amazon Redshift parametergroup to ensure alignment\
    \ with AWS security best practices and compliance requirements. Proper configuration reduces security risks, maintains\
    \ defense in depth, and supports overall security posture.\n\nSteps:\n1. Open REDSHIFT console\n2. Select the parametergroup\n\
    3. Review security configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save\
    \ changes\n\nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense\
    \ in depth\n\u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT cluster: Audit Logging Configured'
  severity: medium
  rule_id: aws.redshift.cluster.audit_logging_configured
  for_each:
    discovery: aws.redshift.cluster_logging
    as: cluster
    item: cluster
  conditions:
    var: logging.logging_enabled
    op: equals
    value: true
  remediation: "Enable logging for redshift cluster:\n\n1. Open REDSHIFT console\n2. Select the cluster\n3. Go to Logging/Monitoring\
    \ settings\n4. Enable logging\n5. Configure log destination:\n   - CloudWatch Logs\n   - S3 bucket (for long-term retention)\n\
    6. Set log level (INFO, DEBUG, ERROR)\n7. Save changes\n\nAWS CLI:\naws redshift update-cluster-logging --cluster-id <id>\
    \ --logging-enabled\n\nBest Practices:\n\u2022 Enable all security-relevant log types\n\u2022 Send logs to centralized\
    \ logging service\n\u2022 Set appropriate retention periods\n\u2022 Configure log encryption\n\u2022 Set up log monitoring\
    \ and alerting"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT cluster: Encryption At Rest Enabled'
  severity: high
  rule_id: aws.redshift.cluster.encryption_at_rest_enabled
  for_each:
    discovery: aws.redshift.cluster_encryption
    as: cluster
    item: cluster
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for redshift cluster:\n\n1. Open REDSHIFT console\n2. Select the cluster\n3. Navigate to\
    \ Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws redshift modify-cluster --cluster-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT user: Redshift No Unused Or Default Supers Configured'
  severity: medium
  rule_id: aws.redshift.user.redshift_no_unused_or_default_supers_configured
  for_each:
    discovery: aws.redshift.users
    as: user
    item: user
  conditions:
    var: user.compliant
    op: equals
    value: true
  remediation: "Configure redshift user for compliance:\n\nRequirement: Redshift No Unused Or Default Supers Configuration\n\
    \nDescription: Verifies security configuration for Amazon Redshift user to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open REDSHIFT console\n2. Select the user\n3. Review security configuration\n4. Apply\
    \ required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT snapshot: Redshift Cross Region Copy Encrypted'
  severity: high
  rule_id: aws.redshift.snapshot.redshift_cross_region_copy_encrypted
  for_each:
    discovery: aws.redshift.snapshot_encryption
    as: snapshot
    item: snapshot
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for redshift snapshot:\n\n1. Open REDSHIFT console\n2. Select the snapshot\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws redshift modify-snapshot --snapshot-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT parametergroup: Logging Enabled'
  severity: medium
  rule_id: aws.redshift.parametergroup.logging_enabled
  for_each:
    discovery: aws.redshift.parametergroup_logging
    as: parametergroup
    item: parametergroup
  conditions:
    var: logging.logging_enabled
    op: equals
    value: true
  remediation: "Enable logging for redshift parametergroup:\n\n1. Open REDSHIFT console\n2. Select the parametergroup\n3.\
    \ Go to Logging/Monitoring settings\n4. Enable logging\n5. Configure log destination:\n   - CloudWatch Logs\n   - S3 bucket\
    \ (for long-term retention)\n6. Set log level (INFO, DEBUG, ERROR)\n7. Save changes\n\nAWS CLI:\naws redshift update-parametergroup-logging\
    \ --parametergroup-id <id> --logging-enabled\n\nBest Practices:\n\u2022 Enable all security-relevant log types\n\u2022\
    \ Send logs to centralized logging service\n\u2022 Set appropriate retention periods\n\u2022 Configure log encryption\n\
    \u2022 Set up log monitoring and alerting"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT endpointaccess: Access Private Only Configured'
  severity: high
  rule_id: aws.redshift.endpointaccess.access_private_only_configured
  for_each:
    discovery: aws.redshift.endpointaccesss
    as: endpointaccess
    item: endpointaccess
  conditions:
    var: endpointaccess.is_public
    op: equals
    value: false
  remediation: "Restrict public access for redshift endpointaccess:\n\n1. Open REDSHIFT console\n2. Select the endpointaccess\n\
    3. Go to Permissions/Access Control\n4. Review current permissions:\n   - Remove public access grants\n   - Remove wildcard\
    \ (*) principals\n   - Implement least privilege\n5. Update resource policy or IAM policies\n6. Enable resource-level\
    \ access control\n7. Save changes\n\nSecurity Recommendations:\n\u2022 Use IAM roles instead of access keys\n\u2022 Implement\
    \ condition keys for additional security\n\u2022 Enable MFA for sensitive operations\n\u2022 Regularly audit access permissions\n\
    \u2022 Use AWS Organizations SCPs for guardrails"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT securitygroup: Security Only Required Ports'
  severity: medium
  rule_id: aws.redshift.securitygroup.security_only_required_ports
  for_each:
    discovery: aws.redshift.securitygroups
    as: securitygroup
    item: securitygroup
  conditions:
    var: securitygroup.compliant
    op: equals
    value: true
  remediation: "Configure redshift securitygroup for compliance:\n\nRequirement: Security Only Required Ports\n\nDescription:\
    \ Verifies security configuration for Amazon Redshift securitygroup to ensure alignment with AWS security best practices\
    \ and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open REDSHIFT console\n2. Select the securitygroup\n3. Review security configuration\n\
    4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT snapshot: Kms Key Policy Least Privilege'
  severity: high
  rule_id: aws.redshift.snapshot.kms_key_policy_least_privilege
  for_each:
    discovery: aws.redshift.snapshot_encryption
    as: snapshot
    item: snapshot
  conditions:
    var: encryption.encryption_enabled
    op: equals
    value: true
  remediation: "Enable encryption for redshift snapshot:\n\n1. Open REDSHIFT console\n2. Select the snapshot\n3. Navigate\
    \ to Properties/Configuration > Encryption\n4. Enable encryption\n5. Choose encryption key:\n   - AWS managed key (default)\n\
    \   - Customer managed key (KMS) for enhanced control\n6. Save changes\n\nAWS CLI:\naws redshift modify-snapshot --snapshot-id\
    \ <id> --encrypted --kms-key-id <key-id>\n\nSecurity Best Practices:\n\u2022 Use customer-managed KMS keys for sensitive\
    \ data\n\u2022 Enable automatic key rotation\n\u2022 Implement proper key access policies\n\u2022 Audit key usage regularly"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT cluster: Automatic Upgrades Configured'
  severity: medium
  rule_id: aws.redshift.cluster.automatic_upgrades_configured
  for_each:
    discovery: aws.redshift.clusters
    as: cluster
    item: cluster
  conditions:
    var: cluster.compliant
    op: equals
    value: true
  remediation: "Configure redshift cluster for compliance:\n\nRequirement: Automatic Upgrades Configuration\n\nDescription:\
    \ Verifies security configuration for Amazon Redshift cluster to ensure alignment with AWS security best practices and\
    \ compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and supports overall\
    \ security posture.\n\nSteps:\n1. Open REDSHIFT console\n2. Select the cluster\n3. Review security configuration\n4. Apply\
    \ required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\nGeneral Security Recommendations:\n\
    \u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\u2022 Enable logging and monitoring\n\
    \u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
- title: 'REDSHIFT hsm client certificate: Certificate Valid'
  severity: medium
  rule_id: aws.redshift.hsm_client_certificate.certificate_valid
  for_each:
    discovery: aws.redshift.hsm_client_certificates
    as: hsm_client_certificate
    item: hsm_client_certificate
  conditions:
    var: hsm_client_certificate.compliant
    op: equals
    value: true
  remediation: "Configure redshift hsm_client_certificate for compliance:\n\nRequirement: Certificate Valid\n\nDescription:\
    \ Verifies security configuration for Amazon Redshift hsm client certificate to ensure alignment with AWS security best\
    \ practices and compliance requirements. Proper configuration reduces security risks, maintains defense in depth, and\
    \ supports overall security posture.\n\nSteps:\n1. Open REDSHIFT console\n2. Select the hsm_client_certificate\n3. Review\
    \ security configuration\n4. Apply required settings per organizational policy\n5. Verify compliance\n6. Save changes\n\
    \nGeneral Security Recommendations:\n\u2022 Follow AWS Well-Architected Framework\n\u2022 Implement defense in depth\n\
    \u2022 Enable logging and monitoring\n\u2022 Use encryption where applicable\n\u2022 Regular security audits"
  references:
  - https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html
