# AWS Rule Template (for aws_compliance_python_engine)
# Replace <placeholders> accordingly.

<service_name>:
  # Optional: scope key is not used by AWS engine (services define their own global/regional behavior)
  # scope: <global|regional>

  discovery:
    - discovery_id: <discovery_id_1>
      # Optional chaining:
      # for_each: <previous_discovery_id>
      # param: <param_name>
      calls:
        - action: <boto3_operation>        # e.g., describe_instances, list_buckets
          fields:
            - path: <response.path>        # supports [] wildcard, maps over arrays
              var: <var_name>
            # - path: <prop>
            #   var: <var2>

  checks:
    - check_id: <unique_check_id>
      title: <human_readable_name>
      severity: <low|medium|high|critical>
      for_each: <discovery_id_1>
      param: <param_name>
      logic: <AND|OR>
      calls:
        - action: <boto3_operation|identity>
          fields:
            - path: <response.path>
              operator: <equals|not_equals|contains|not_contains|exists>
              expected: <value> 