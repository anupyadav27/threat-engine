rule_id: k8s.kubelet.authorization.mode_not_always_allow
service: kubelet
resource: authorization
requirement: Mode Not Always Allow
title: Ensure Kubelet Authorization Mode is Set to Webhook or Node
description: This rule checks the kubelet configuration to ensure that the authorization
  mode is not set to 'AlwaysAllow'. Instead, it should be configured to 'Webhook'
  or 'Node' to enforce proper authorization checks. 'Webhook' mode allows for external
  authorization services to validate requests, while 'Node' restricts authorization
  based on node identity, both reducing the risk of unauthorized access. Properly
  configuring the kubelet authorization mode enhances the security posture by ensuring
  only authorized requests are processed, thus mitigating risks associated with unauthorized
  access and operations.
rationale: If the kubelet authorization mode is set to 'AlwaysAllow', any request
  made to the kubelet API is automatically authorized, leading to potential unauthorized
  access. This can expose sensitive operations on nodes, such as executing commands,
  retrieving logs, or accessing confidential data, thereby increasing the risk of
  malicious activities and data breaches.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: kubelet.authorization.mode_not_always_allow
references:
- https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/
- https://kubernetes.io/docs/reference/access-authn-authz/authorization/
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/
compliance:
- cis_kubernetes_kubernetes_4.2.2_0085
