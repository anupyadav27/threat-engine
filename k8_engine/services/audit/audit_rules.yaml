component: audit
component_type: control_plane
discovery:
- discovery_id: list_audit_resources
  calls:
  - action: list_pods
    fields:
    - path: name
      var: name
    - path: namespace
      var: namespace
    - path: labels
      var: labels
checks:
- check_id: k8s.audit.change.management_logging_enabled
  name: Management Logging Enabled
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.configuration.change_detection_enabled
  name: Change Detection Enabled
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.configuration.change_logged
  name: Change Logged
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.incident.detection_enabled
  name: Detection Enabled
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.incident.notification_configured
  name: Notification Configured
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.incident.response_admission_controller_enabled
  name: Response Admission Controller Enabled
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.incident.response_plan_configured
  name: Response Plan Configured
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.access_control_enforced
  name: Access Control Enforced
  severity: HIGH
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.access_review
  name: Access Review
  severity: HIGH
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.alerts_configured
  name: Alerts Configured
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.analysis_configured
  name: Analysis Configured
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.analysis_mechanism
  name: Analysis Mechanism
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.anomaly_detection_configured
  name: Anomaly Detection Configured
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.authentication_failures
  name: Authentication Failures
  severity: HIGH
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.backup_configured
  name: Backup Configured
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.creation_deletion_events_enabled
  name: Creation Deletion Events Enabled
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.enabled
  name: Enabled
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.failure_alert_configured
  name: Failure Alert Configured
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.file_validation_enabled
  name: File Validation Enabled
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.format_json
  name: Format Json
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.high_severity_event_detection
  name: High Severity Event Detection
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.integrity_enabled
  name: Integrity Enabled
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.monitoring_configured
  name: Monitoring Configured
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.network_policy_changes
  name: Network Policy Changes
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.policy_types
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.policies_documented
  name: Policies Documented
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.protection_mechanism_configured
  name: Protection Mechanism Configured
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.retention_configured
  name: Retention Configured
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.retention_days_specified
  name: Retention Days Specified
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.log.timestamps_configured
  name: Timestamps Configured
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.networkpolicy.changes_logged
  name: Changes Logged
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.capture_user_identity
  name: Capture User Identity
  severity: HIGH
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.captures_all_requests
  name: Captures All Requests
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.captures_metadata
  name: Captures Metadata
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.captures_privileged_actions
  name: Captures Privileged Actions
  severity: CRITICAL
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.captures_security_events
  name: Captures Security Events
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.captures_timestamps
  name: Captures Timestamps
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.captures_unauthorized_access
  name: Captures Unauthorized Access
  severity: HIGH
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.captures_user_access
  name: Captures User Access
  severity: HIGH
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.change_detection_enabled
  name: Change Detection Enabled
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.change_events_logged
  name: Change Events Logged
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.change_logging_enabled
  name: Change Logging Enabled
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.configured
  name: Configured
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.custom_rules_defined
  name: Custom Rules Defined
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.event_location_captured
  name: Event Location Captured
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.event_outcomes_captured
  name: Event Outcomes Captured
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.event_timestamp_captured
  name: Event Timestamp Captured
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.event_types_captured
  name: Event Types Captured
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.metadata_capture
  name: Metadata Capture
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.review_scheduled
  name: Review Scheduled
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.source_capture_enabled
  name: Source Capture Enabled
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.system_level_event_logging
  name: System Level Event Logging
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.policy.timestamps_included
  name: Timestamps Included
  severity: LOW
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.risk.analysis_policy_configured
  name: Analysis Policy Configured
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.software.installation_logging_enabled
  name: Installation Logging Enabled
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.supplier.service_changes_logged
  name: Service Changes Logged
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.threat.detection_enabled
  name: Detection Enabled
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.audit.user.activity_logging_enabled
  name: Activity Logging Enabled
  severity: MEDIUM
  for_each: list_audit_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
