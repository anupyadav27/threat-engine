rule_id: k8s.audit.policy.capture_user_identity
service: audit
resource: policy
requirement: Capture User Identity
title: Ensure User Identity is Captured in Audit Logs
description: This rule checks that the Kubernetes audit policy is configured to capture
  user identity information for all API server requests. A well-configured audit policy
  logs 'user' and 'userGroups' fields, ensuring that every action within the cluster
  can be attributed to a specific user or service account. This is essential for accountability,
  incident response, and compliance with standards like CIS Kubernetes Benchmark.
  Properly capturing user identity aids in forensic analysis, helping to understand
  the scope and impact of security incidents.
rationale: Capturing user identity in Kubernetes audit logs is critical to trace actions
  back to individual users. Without this, it becomes challenging to detect and investigate
  unauthorized access or malicious activities, as attackers may exploit the lack of
  traceability to cover their tracks.
severity: high
domain: identity_and_access_management
subcategory: access_control
scope: audit.policy.capture_user_identity
references:
- https://kubernetes.io/docs/tasks/debug/debug-cluster/audit/
- https://kubernetes.io/docs/reference/config-api/apiserver-audit.v1/
- https://kubernetes.io/docs/concepts/cluster-administration/logging/
compliance:
- nist_800_53_rev5_multi_cloud_AU-3-f_0236
