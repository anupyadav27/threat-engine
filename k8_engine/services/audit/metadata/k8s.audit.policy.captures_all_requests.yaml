rule_id: k8s.audit.policy.captures_all_requests
service: audit
resource: policy
requirement: Captures All Requests
title: Ensure Comprehensive Audit Logging for All API Requests
description: This control checks if the Kubernetes audit policy is configured to log
  all API requests, including metadata and request body. A well-configured audit policy
  includes rules that capture all request and response data for critical operations,
  such as changes to RBAC, creation/deletion of resources, and access to sensitive
  data. Ensuring comprehensive logging helps in forensic analysis and compliance with
  security frameworks like CIS Kubernetes Benchmark. Proper audit logging allows for
  tracking of user actions, detection of unauthorized access, and compliance with
  regulatory requirements.
rationale: Without comprehensive audit logging, unauthorized or malicious activities
  may go undetected, as there won't be a complete record of actions taken in the cluster.
  This can lead to unnoticed elevation of privileges, unauthorized data access, or
  exploitation attempts. Capturing all API requests ensures that any anomalous or
  suspicious activities can be traced and investigated, thus reducing the risk of
  security breaches and aiding in incident response.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: audit.policy.captures_all_requests
references:
- https://kubernetes.io/docs/tasks/debug/debug-cluster/audit/
- https://kubernetes.io/docs/tasks/debug/debug-cluster/audit/#audit-policy
- https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#audit-annotations
compliance:
- fedramp_moderate_multi_cloud_AU-3_0059
- fedramp_moderate_multi_cloud_AU-3_1_0060
