rule_id: k8s.audit.supplier.service_changes_logged
service: audit
resource: supplier
requirement: Service Changes Logged
title: Log and Monitor All Kubernetes API Server Requests
description: This rule ensures that all Kubernetes API server requests, especially
  those involving changes to cluster resources, are logged. It validates that audit
  logging is enabled with a focus on capturing create, update, and delete operations.
  Proper logging provides visibility into cluster activities, aiding in the detection
  of suspicious actions and facilitating forensic investigations. A good configuration
  includes specifying audit policies that capture and store logs in a secure, tamper-proof
  location, ensuring that all relevant events are monitored and retained according
  to compliance requirements.
rationale: If API server requests are not logged, unauthorized changes can occur without
  detection, allowing attackers to modify resources or escalate privileges unnoticed.
  This can lead to data breaches, service disruptions, or compliance violations.
severity: medium
domain: logging_and_monitoring
subcategory: audit_logging
scope: audit.supplier.service_changes_logged
references:
- https://kubernetes.io/docs/tasks/debug/debug-cluster/audit/
- https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#audit-logging
- https://kubernetes.io/docs/reference/config-api/apiserver-audit.v1/
compliance:
- iso27001_2022_multi_cloud_A.5.22_0019
