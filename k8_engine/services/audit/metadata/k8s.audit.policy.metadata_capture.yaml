rule_id: k8s.audit.policy.metadata_capture
service: audit
resource: policy
requirement: Metadata Capture
title: Ensure Comprehensive Metadata Capture in Audit Policies
description: This rule checks that the Kubernetes audit policy is set to capture comprehensive
  metadata for all relevant events, including user identities, request parameters,
  and response statuses. A well-configured audit policy ensures that all actions taken
  within the cluster are logged with sufficient detail, allowing for effective monitoring,
  incident response, and forensic analysis. This helps detect unauthorized access,
  configuration changes, and potential exploits, thereby enhancing the security posture
  of the cluster.
rationale: Failure to configure comprehensive metadata capture in Kubernetes audit
  policies can result in incomplete audit logs, making it difficult to trace unauthorized
  access or configuration changes. Attackers could exploit this by masking their activities,
  leading to potential data breaches or system compromise without detection.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: audit.policy.metadata_capture
references:
- https://kubernetes.io/docs/tasks/debug/debug-cluster/audit/
- https://kubernetes.io/docs/reference/access-authn-authz/controlling-access/
- https://kubernetes.io/docs/concepts/policy/audit-logging/
compliance:
- canada_pbmm_moderate_multi_cloud_CCCS_AU-3_0025
- fedramp_moderate_multi_cloud_AU-6_0065
- fedramp_moderate_multi_cloud_AU-6_1_0066
- fedramp_moderate_multi_cloud_AU-6_3_0067
- fedramp_moderate_multi_cloud_AU-6_4_0068
- fedramp_moderate_multi_cloud_AU-6_5_0069
- fedramp_moderate_multi_cloud_AU-6_6_0070
- fedramp_moderate_multi_cloud_AU-6_7_0071
- nist_800_53_rev5_multi_cloud_AU-12-a_0278
