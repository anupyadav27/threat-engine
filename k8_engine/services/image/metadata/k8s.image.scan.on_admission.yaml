rule_id: k8s.image.scan.on_admission
service: image
resource: scan
requirement: On Admission
title: Enforce Image Vulnerability Scanning on Admission
description: This control checks if an admission controller is configured to enforce
  image vulnerability scanning for all images being deployed into the Kubernetes cluster.
  A good configuration involves integrating tools like Open Policy Agent (OPA) or
  Kubernetes' own admission controllers to automatically reject images with known
  vulnerabilities or that do not meet security criteria. Implementing this control
  enhances security by ensuring that only vetted images are allowed to run, thus preventing
  potential exploitation of known vulnerabilities within container images.
rationale: Without mandatory image scanning on admission, Kubernetes clusters risk
  deploying vulnerable container images that could be exploited by attackers. This
  oversight may lead to privilege escalation, data breaches, or denial-of-service
  attacks, thereby compromising cluster security. Scanning images on admission helps
  identify vulnerabilities before they are deployed, reducing the attack surface and
  ensuring compliance with security policies.
severity: medium
domain: workload_security
subcategory: admission_control
scope: image.scan.on_admission
references:
- https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/
- https://kubernetes.io/docs/concepts/policy/pod-security-policy/
- https://kubernetes.io/docs/concepts/containers/images/
compliance: []
