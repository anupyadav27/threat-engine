rule_id: k8s.etcd.pod.peer_auto_tls_disabled
service: etcd
resource: pod
requirement: Peer Auto Tls Disabled
title: Disable Automatic TLS for etcd Peer Connections
description: This rule checks that the etcd pod is configured to disable automatic
  TLS for peer connections. A secure setup requires manually specifying trusted certificates
  and keys for peer communication, thus ensuring that all nodes are using validated
  and secure credentials. Proper configuration helps prevent unauthorized access and
  data tampering, maintaining the integrity and confidentiality of the etcd data store.
rationale: Disabling peer auto TLS in etcd prevents the use of automatically generated
  certificates, which may not be adequately secured or trusted. Misconfiguration can
  lead to unauthorized peer connections, allowing attackers to intercept or alter
  data. This control mitigates the risk of man-in-the-middle attacks and ensures only
  trusted nodes can communicate within the etcd cluster.
severity: high
domain: data_protection
subcategory: encryption_in_transit
scope: etcd.pod.peer_auto_tls_disabled
references:
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/#securing-etcd
- https://kubernetes.io/docs/setup/best-practices/certificates/
- https://kubernetes.io/docs/concepts/configuration/secret/
compliance:
- cis_kubernetes_kubernetes_2.6_0066
