rule_id: k8s.etcd.snapshot.retention_policy_configured
service: etcd
resource: snapshot
requirement: Retention Policy Configured
title: Configure Retention Policy for etcd Snapshots
description: This control checks whether a retention policy is configured for etcd
  snapshots in a Kubernetes cluster. A good configuration limits the number of retained
  snapshots to a practical number, ensuring that outdated snapshots are automatically
  deleted. This helps in managing storage efficiently and reduces the risk of exposing
  sensitive data in obsolete snapshots. Additionally, it ensures that the cluster
  complies with industry standards, mitigating the risk of data exposure and supporting
  regulatory compliance.
rationale: Without a properly configured retention policy for etcd snapshots, sensitive
  data could be stored indefinitely, increasing the risk of unauthorized access and
  potential data breaches. Misconfiguration can lead to excessive storage use and
  make it difficult to manage and secure older snapshots, which may contain vulnerabilities
  over time.
severity: medium
domain: workload_security
subcategory: admission_control
scope: etcd.snapshot.retention_policy_configured
references:
- https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/#etcd-backups
- https://kubernetes.io/docs/tasks/administer-cluster/safely-drain-node/#back-up-data-from-the-node
- https://kubernetes.io/docs/setup/best-practices/certificates/#etcd
compliance:
- soc2_multi_cloud_cc_c_1_2_0023
