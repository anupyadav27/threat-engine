rule_id: k8s.etcd.peer.client_cert_auth_in_transit_enabled
service: etcd
resource: peer
requirement: Client Cert Auth In Transit Enabled
title: Enable Client Certificate Authentication for ETCD Peer Communication
description: This control checks that etcd peer communication has client certificate
  authentication enabled, ensuring that only authenticated peers can connect. A valid
  configuration requires that etcd peers use mutual TLS (mTLS) to authenticate each
  other, which involves setting flags such as `--peer-cert-file`, `--peer-key-file`,
  and `--peer-client-cert-auth` to true. This setup helps in maintaining secure and
  trusted communication channels between etcd peers, protecting the cluster from unauthorized
  access and potential data leakage.
rationale: Without client certificate authentication for etcd peer communication,
  the cluster is vulnerable to man-in-the-middle attacks and unauthorized access,
  as attackers could intercept or impersonate etcd peer connections. This misconfiguration
  can lead to data breaches and compromise the integrity of the cluster's state data.
severity: high
domain: identity_and_access_management
subcategory: authentication
scope: etcd.peer.client_cert_auth_in_transit_enabled
references:
- https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/
- https://kubernetes.io/docs/tasks/tls/managing-tls-in-a-cluster/
- https://kubernetes.io/docs/concepts/architecture/control-plane-node-communication/
compliance: []
