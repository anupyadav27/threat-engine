rule_id: k8s.etcd.etcd.peer_client_cert_auth_in_transit_enabled
service: etcd
resource: etcd
requirement: Peer Client Cert Auth In Transit Enabled
title: Enable Peer Client Certificate Authentication for Etcd
description: This control checks whether peer client certificate authentication is
  enabled for etcd, ensuring that all communication between etcd nodes is authenticated
  using TLS certificates. A correct configuration involves setting 'peer-client-cert-auth'
  to 'true' in the etcd configuration, which requires all etcd peers to present valid
  client certificates for mutual TLS authentication. This measure enhances security
  by preventing unauthorized access to etcd data and maintaining the integrity and
  confidentiality of node-to-node communication within the etcd cluster.
rationale: If peer client certificate authentication is not enabled for etcd, unauthorized
  nodes could potentially communicate with the etcd cluster, leading to data breaches
  or cluster compromise. Enabling this authentication mechanism ensures that only
  authorized and authenticated nodes can participate in etcd peer-to-peer communication,
  mitigating risks such as man-in-the-middle attacks and unauthorized data access.
severity: high
domain: identity_and_access_management
subcategory: authentication
scope: etcd.etcd.peer_client_cert_auth_in_transit_enabled
references:
- https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/#configure-tls-for-etcd
- https://kubernetes.io/docs/setup/best-practices/certificates/#etcd-peer-certificates
- https://kubernetes.io/docs/concepts/architecture/control-plane-node-communication/#etcd
compliance:
- cis_kubernetes_kubernetes_2.5_0065
