rule_id: k8s.etcd.unique.ca_certificate_check
service: etcd
resource: unique
requirement: Ca Certificate Check
title: Ensure Unique CA Certificates for etcd Communication
description: This rule checks that etcd is configured with unique CA certificates
  for secure communication. It verifies that the CA certificate used is not shared
  with other components, and that it is correctly configured to validate authenticity.
  A properly configured CA certificate ensures encrypted and authenticated communication
  between etcd and other cluster components, reducing the risk of data interception
  and ensuring compliance with security benchmarks like the CIS Kubernetes Benchmark.
rationale: Misconfiguring CA certificates in etcd can expose the cluster to man-in-the-middle
  (MITM) attacks. An attacker could intercept and manipulate data between etcd and
  Kubernetes components, leading to potential data breaches and unauthorized access.
  Proper certificate validation ensures that etcd communication is secure and trusted.
severity: high
domain: data_protection
subcategory: encryption_in_transit
scope: etcd.unique.ca_certificate_check
references:
- https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/#etcd-security
- https://kubernetes.io/docs/setup/best-practices/certificates/#etcd-peer-and-client-certificates
- https://kubernetes.io/docs/concepts/cluster-administration/certificates/
compliance:
- cis_kubernetes_kubernetes_2.8_0068
