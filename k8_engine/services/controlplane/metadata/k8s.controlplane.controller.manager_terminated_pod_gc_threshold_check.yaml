rule_id: k8s.controlplane.controller.manager_terminated_pod_gc_threshold_check
service: controlplane
resource: controller
requirement: Manager Terminated Pod Gc Threshold Check
title: Configure Terminated Pod Garbage Collection Threshold
description: This rule checks that the 'terminated-pod-gc-threshold' parameter in
  the Kubernetes controller manager is set to a reasonable value. This parameter controls
  the maximum number of terminated pods that the garbage collector retains. A well-configured
  threshold prevents resource exhaustion by ensuring that terminated pods are cleaned
  up promptly, thus maintaining system stability and performance. Proper configuration
  aids in mitigating denial-of-service attacks by ensuring resources are not unnecessarily
  consumed by stale resources.
rationale: If the terminated pod garbage collection threshold is misconfigured, it
  can lead to excessive accumulation of terminated pods. This can increase resource
  usage on the control plane, potentially leading to denial-of-service conditions.
  An attacker could exploit this by repeatedly creating and terminating pods to exhaust
  system resources, thereby affecting cluster stability and availability.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: controlplane.controller.manager_terminated_pod_gc_threshold_check
references:
- https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/
- https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/
- https://kubernetes.io/docs/tasks/administer-cluster/reserve-compute-resources/
compliance:
- cis_kubernetes_kubernetes_1.3.1_0052
