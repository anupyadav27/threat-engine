rule_id: k8s.controlplane.proxy.metrics_bind_address_localhost
service: controlplane
resource: proxy
requirement: Metrics Bind Address Localhost
title: Restrict Metrics Endpoint to Localhost for Control Plane Proxy
description: This rule checks that the Kubernetes control plane proxy's metrics endpoint
  is bound to the localhost interface. By ensuring the metrics are only accessible
  locally, you prevent unauthorized external access to sensitive operational data.
  A correct configuration involves setting the metrics bind address to '127.0.0.1'.
  This helps protect against unauthorized access and potential data leakage, aligning
  with security best practices and compliance standards such as the CIS Kubernetes
  Benchmark.
rationale: Exposing the metrics endpoint on non-local interfaces can allow unauthorized
  access to sensitive data. This misconfiguration can lead to information leakage
  and potential exploitation by attackers who can gather insights into cluster performance
  and state, which might be used to orchestrate further attacks.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: controlplane.proxy.metrics_bind_address_localhost
references:
- https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/
- https://kubernetes.io/docs/tasks/extend-kubernetes/custom-resources/custom-resource-definitions/
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/
compliance:
- cis_kubernetes_kubernetes_4.3.1_0099
