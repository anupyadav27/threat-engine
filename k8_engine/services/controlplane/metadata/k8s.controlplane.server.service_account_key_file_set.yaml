rule_id: k8s.controlplane.server.service_account_key_file_set
service: controlplane
resource: server
requirement: Service Account Key File Set
title: Ensure Service Account Key Files Are Configured
description: This rule checks that the Kubernetes control plane server has the service
  account key file (`--service-account-key-file`) properly set. A correctly configured
  key file is crucial for the secure signing of service account tokens, which are
  used for authentication and authorization in Kubernetes. By ensuring that this key
  file is set and correctly configured, you reduce the risk of token forgery and unauthorized
  access, maintaining the integrity and security of the cluster.
rationale: If the service account key files are not properly configured on the Kubernetes
  control plane server, it can lead to unauthorized access and potential privilege
  escalation. Attackers could exploit this misconfiguration to impersonate service
  accounts, gain unauthorized access to resources, or disrupt operations, compromising
  the cluster's security.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: controlplane.server.service_account_key_file_set
references:
- https://kubernetes.io/docs/concepts/configuration/secret/#service-account-token-secrets
- https://kubernetes.io/docs/reference/access-authn-authz/authentication/#service-account-tokens
- https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/
compliance: []
