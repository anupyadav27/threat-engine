rule_id: k8s.policy.capabilities.restriction_check
service: policy
resource: capabilities
requirement: Restriction Check
title: Restrict Pod Capabilities to Minimal Set
description: This check ensures that the capabilities assigned to containers in your
  Kubernetes cluster are restricted to the minimal set necessary for application functionality.
  It validates that PodSecurityPolicies or Pod Security Standards are configured to
  drop all unnecessary Linux capabilities. Adhering to this practice reduces the attack
  surface by limiting what a compromised container can do, aligning with security
  best practices and compliance requirements like the CIS Kubernetes Benchmark.
rationale: Allowing excessive capabilities in containers can introduce security vulnerabilities,
  such as privilege escalation. Attackers may exploit granted capabilities to perform
  actions like modifying system files or network settings, which could compromise
  the entire cluster's security.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: policy.capabilities.restriction_check
references:
- https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted
- https://kubernetes.io/docs/concepts/policy/pod-security-policy/#capabilities
- https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-capabilities-for-a-container
compliance:
- cis_kubernetes_kubernetes_5.2.9_0121
