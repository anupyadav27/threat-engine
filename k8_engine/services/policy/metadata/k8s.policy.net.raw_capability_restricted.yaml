rule_id: k8s.policy.net.raw_capability_restricted
service: policy
resource: net
requirement: Raw Capability Restricted
title: Restrict NET_RAW Capability in Kubernetes Pods
description: This check ensures that the NET_RAW capability is not granted to containers
  running in Kubernetes pods unless explicitly required. A secure configuration involves
  using PodSecurityPolicies or SecurityContext to deny the NET_RAW capability by default.
  This reduces the attack surface by preventing unauthorized packet generation or
  manipulation, thus safeguarding against network-based attacks. Properly configured,
  this control helps maintain compliance with security benchmarks and best practices.
rationale: Allowing the NET_RAW capability in Kubernetes pods can expose the cluster
  to several security risks, such as packet sniffing and man-in-the-middle attacks.
  Attackers could exploit this capability to perform network reconnaissance or intercept
  network traffic, compromising the confidentiality and integrity of data. By restricting
  NET_RAW, you mitigate these risks and enhance the overall security posture of your
  cluster.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: policy.net.raw_capability_restricted
references:
- https://kubernetes.io/docs/concepts/policy/pod-security-policy/
- https://kubernetes.io/docs/concepts/security/pod-security-standards/
- https://kubernetes.io/docs/tasks/configure-pod-container/security-context/
compliance:
- cis_kubernetes_kubernetes_5.2.8_0120
