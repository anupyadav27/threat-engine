rule_id: k8s.cluster.service.account_credentials_enabled
service: cluster
resource: service
requirement: Account Credentials Enabled
title: Ensure Service Account Tokens Are Not Auto-Mounted
description: 'This rule checks whether the Kubernetes configuration disables the automatic
  mounting of service account tokens in pods, unless explicitly needed. A proper configuration
  involves setting `automountServiceAccountToken: false` in the pod or service account
  specification. Ensuring that service account tokens are not auto-mounted by default
  minimizes exposure to unnecessary credentials, helping to protect the cluster from
  potential privilege escalation and unauthorized access activities.'
rationale: Service accounts in Kubernetes automatically mount their tokens into pods
  by default, which can be exploited if a pod is compromised. Attackers can use these
  tokens to escalate privileges, access sensitive data, or interfere with cluster
  operations. By preventing the automatic mounting of service account tokens, you
  reduce the risk of token theft and unauthorized access within the cluster.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: cluster.service.account_credentials_enabled
references:
- https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#service-account-token-volume-projection
- https://kubernetes.io/docs/reference/access-authn-authz/service-accounts-admin/#automatically-mounting-api-credentials-for-a-service-account
- https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline
compliance: []
