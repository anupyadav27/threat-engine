rule_id: k8s.workload.daemonset.daemonset_host_access_controlled_enforced
service: workload
resource: daemonset
requirement: Daemonset Host Access Controlled Enforced
title: Restrict Host Network Access for DaemonSets
description: This rule checks that Kubernetes DaemonSets do not unnecessarily have
  host network access enabled. A secure configuration ensures that the 'hostNetwork'
  field in the DaemonSet specification is set to 'false' unless explicitly required
  for the workload to function correctly. By enforcing this control, organizations
  can significantly reduce the risk of unauthorized network access, limit potential
  attack vectors, and adhere to security best practices outlined in the CIS Kubernetes
  Benchmark.
rationale: If host network access is misconfigured in DaemonSets, it can lead to potential
  security risks such as unauthorized access to sensitive host resources or network
  interfaces. Attackers could exploit this access to perform lateral movement, eavesdrop
  on network traffic, or execute further attacks on cluster nodes. It is crucial to
  ensure that only DaemonSets that absolutely require host network access are granted
  such permissions to minimize the attack surface.
severity: high
domain: identity_and_access_management
subcategory: access_control
scope: workload.daemonset.daemonset_host_access_controlled_enforced
references:
- https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/
- https://kubernetes.io/docs/concepts/policy/pod-security-policy/#host-namespaces-and-networking
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/
compliance: []
