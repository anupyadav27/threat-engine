rule_id: k8s.workload.daemonset.host_pid_restricted
service: workload
resource: daemonset
requirement: Host Pid Restricted
title: Restrict HostPID Namespace Access in DaemonSets
description: This rule checks that DaemonSets do not have the 'hostPID' field set
  to 'true', ensuring that containers within the DaemonSet do not share the host's
  PID namespace. Proper configuration prevents containers from being able to view
  or interact with host-level processes, reducing the attack surface and improving
  the overall security posture of the Kubernetes cluster.
rationale: Allowing DaemonSets to use the host's PID namespace can lead to potential
  privilege escalation attacks, where a compromised container gains the ability to
  view and interact with processes on the host. This misconfiguration may expose sensitive
  data and processes, making the cluster more vulnerable to attacks.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: workload.daemonset.host_pid_restricted
references:
- https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted
- https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-the-security-context-for-a-pod
- https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/
compliance: []
