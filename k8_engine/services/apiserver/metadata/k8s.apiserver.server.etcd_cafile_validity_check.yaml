rule_id: k8s.apiserver.server.etcd_cafile_validity_check
service: apiserver
resource: server
requirement: Etcd Cafile Validity Check
title: Ensure Validity of Etcd CA File in Kube-Apiserver Configuration
description: This check verifies that the kube-apiserver is configured with a valid
  CA file for etcd communication. A valid CA file ensures that the kube-apiserver
  only trusts secure and authorized etcd nodes, mitigating potential security threats
  like unauthorized access and data tampering. Proper configuration includes checking
  the file's presence, its correct path, and ensuring it has not expired. This practice
  aligns with the CIS Kubernetes Benchmark and is essential for maintaining secure
  communication channels within the Kubernetes cluster.
rationale: Invalid or improperly configured CA files could lead to unauthorized access
  and data breaches. By ensuring the validity of the Etcd CA file, you protect the
  integrity and confidentiality of the data stored in etcd, which is a critical component
  in Kubernetes infrastructure. Without proper CA file validation, attackers could
  execute man-in-the-middle attacks, intercepting or altering communication between
  the kube-apiserver and etcd.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: apiserver.server.etcd_cafile_validity_check
references:
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/
- https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/#options
- https://kubernetes.io/docs/concepts/architecture/control-plane-node-communication/
compliance:
- cis_kubernetes_kubernetes_1.1.31_0150
