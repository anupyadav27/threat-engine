rule_id: k8s.apiserver.server.service_account_key_file_check
service: apiserver
resource: server
requirement: Service Account Key File Check
title: Ensure Service Account Key Rotation and Management
description: This control checks that the Kubernetes API server is configured with
  a valid and secure service account key file. It ensures that the key used for signing
  service account tokens is properly managed and rotated regularly. A well-configured
  key file minimizes the risk of token forgery and unauthorized API access, thus protecting
  the cluster from potential security breaches.
rationale: Misconfigured service account keys can lead to unauthorized access to the
  Kubernetes API, allowing attackers to perform malicious actions such as data exfiltration
  or privilege escalation. Without proper key management and rotation, the risk of
  compromised credentials increases, making it easier for attackers to exploit the
  cluster.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: apiserver.server.service_account_key_file_check
references:
- https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#manually-create-an-api-token-for-a-serviceaccount
- https://kubernetes.io/docs/reference/access-authn-authz/service-accounts-admin/
- https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/#options
compliance:
- cis_kubernetes_kubernetes_1.2.23_0044
- cis_kubernetes_kubernetes_1.2.24_0045
- cis_kubernetes_kubernetes_3.1.16_0209
- cis_kubernetes_kubernetes_3.1.17_0210
