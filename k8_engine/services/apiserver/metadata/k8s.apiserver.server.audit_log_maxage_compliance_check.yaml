rule_id: k8s.apiserver.server.audit_log_maxage_compliance_check
service: apiserver
resource: server
requirement: Audit Log Maxage Compliance Check
title: Enforce Audit Log MaxAge for Kubernetes API Server
description: This control verifies that the Kubernetes API Server's audit logging
  configuration includes a defined maximum age (MaxAge) for log retention. A proper
  configuration ensures that audit logs are retained only for a necessary period,
  thereby reducing the storage of potentially sensitive historical data. A compliant
  setup will have a 'MaxAge' parameter set to a reasonable number of days, ensuring
  logs are rotated and old data is purged. This practice not only enhances data protection
  but also aligns with compliance standards such as the CIS Kubernetes Benchmark.
rationale: Without properly configuring the audit log max age in Kubernetes API Server,
  logs may be retained longer than necessary, increasing the risk of exposure to unauthorized
  access or data leakage. An attacker could exploit old logs to gain insights into
  past system activities and potential vulnerabilities. Ensuring that logs are rotated
  and removed in a timely manner mitigates these risks and helps in maintaining a
  minimal data retention policy.
severity: high
domain: logging_and_monitoring
subcategory: audit_logging
scope: apiserver.server.audit_log_maxage_compliance_check
references:
- https://kubernetes.io/docs/tasks/debug-application-cluster/audit/
- https://kubernetes.io/docs/reference/config-api/kube-apiserver-config.v1/
- https://kubernetes.io/docs/reference/access-authn-authz/controlling-access/
compliance:
- cis_kubernetes_kubernetes_1.2.19_0040
