rule_id: k8s.apiserver.server.admission_plugins_security_context_deny_check
service: apiserver
resource: server
requirement: Admission Plugins Security Context Deny Check
title: Enforce Security Context Constraints with Admission Plugins
description: This rule checks if the Kubernetes API server is configured with the
  Security Context Deny admission plugin, which prevents pods from being created with
  insecure security contexts. A valid configuration denies requests that specify disallowed
  security contexts, such as running containers as root or using the host's network
  namespace. By enforcing strict security policies at the admission level, it ensures
  that all workloads adhere to security best practices, reducing the risk of privilege
  escalation and maintaining cluster integrity.
rationale: Without proper configuration of the Security Context Deny admission plugin,
  Kubernetes could allow pods to run with elevated privileges or access sensitive
  host resources, increasing the risk of privilege escalation and unauthorized access.
  An attacker could exploit misconfigured security contexts to gain access to the
  host system or compromise other pods.
severity: medium
domain: workload_security
subcategory: admission_control
scope: apiserver.server.admission_plugins_security_context_deny_check
references:
- https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#securitycontextdeny
- https://kubernetes.io/docs/concepts/policy/pod-security-policy/
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/
compliance:
- cis_kubernetes_kubernetes_1.2.12_0033
