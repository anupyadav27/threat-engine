rule_id: k8s.apiserver.server.args_profiling_disabled
service: apiserver
resource: server
requirement: Args Profiling Disabled
title: Disable Profiling in Kube-apiserver to Prevent Information Leakage
description: This rule checks that the '--profiling' argument in the kube-apiserver
  is set to 'false'. Proper configuration ensures that profiling endpoints, which
  can expose sensitive information, are disabled. By preventing profiling data from
  being exposed, this control helps protect the Kubernetes API server from being targeted
  by attackers looking to gather reconnaissance data or exploit detailed server performance
  insights. This is aligned with security best practices and is necessary for compliance
  with the CIS Kubernetes Benchmark.
rationale: Enabling profiling in the kube-apiserver can inadvertently expose sensitive
  information about the server's performance and internal state, which can be exploited
  by attackers to gain insights into potential vulnerabilities or orchestrate denial-of-service
  attacks. Disabling profiling minimizes the risk of unauthorized access to profiling
  data, thus maintaining the confidentiality and integrity of the Kubernetes control
  plane.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: apiserver.server.args_profiling_disabled
references:
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/#restrict-access-to-the-kubernetes-api
- https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/#options
- https://kubernetes.io/docs/tasks/debug/debug-cluster/resource-metrics-pipeline/#api-server-metrics
compliance:
- cis_kubernetes_kubernetes_1.2.17_0038
