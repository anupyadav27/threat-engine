rule_id: k8s.apiserver.server.encryption_provider_verification
service: apiserver
resource: server
requirement: Encryption Provider Verification
title: Enforce Encryption at Rest for Kubernetes Secrets
description: This control verifies that the Kubernetes API server is configured to
  use an encryption provider for encrypting Secrets at rest in etcd. A properly configured
  encryption provider ensures that all sensitive data stored as Kubernetes Secrets
  are encrypted before being persisted. This configuration involves specifying encryption
  providers in the kube-apiserver manifest file, typically using a combination of
  encryption techniques like AES-CBC or AES-GCM. By ensuring encryption at rest, this
  control mitigates risks associated with data exposure and enhances overall cluster
  security posture.
rationale: Without encryption at rest, sensitive data stored in Kubernetes Secrets
  is vulnerable to unauthorized access if the etcd database is compromised. Attackers
  gaining access to etcd could retrieve plaintext secrets, leading to potential data
  breaches and violations of compliance requirements.
severity: high
domain: data_protection
subcategory: encryption
scope: apiserver.server.encryption_provider_verification
references:
- https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/
- https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/
- https://kubernetes.io/docs/tasks/configmap-secret/managing-secret-using-config-file/
compliance:
- cis_kubernetes_kubernetes_1.2.30_0051
