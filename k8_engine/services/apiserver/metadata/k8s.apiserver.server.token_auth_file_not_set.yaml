rule_id: k8s.apiserver.server.token_auth_file_not_set
service: apiserver
resource: server
requirement: Token Auth File Not Set
title: Disable Token-Based Authentication for API Server
description: This rule checks if the Kubernetes API server is configured without a
  static token authentication file by ensuring the '--token-auth-file' flag is not
  set. Properly disabling token-based authentication enhances security by preventing
  the use of static tokens, which are difficult to rotate and manage securely. Instead,
  it encourages the use of dynamic and more secure authentication methods, thereby
  reducing the risk of unauthorized access and ensuring compliance with best security
  practices.
rationale: Token-based authentication in Kubernetes can expose the API server to unauthorized
  access if tokens are leaked or improperly managed. Such vulnerabilities might allow
  attackers to gain access to sensitive cluster resources and escalate privileges.
  Disabling token-based authentication reduces the attack surface by relying on more
  secure methods such as client certificates or OAuth2.
severity: high
domain: identity_and_access_management
subcategory: authentication
scope: apiserver.server.token_auth_file_not_set
references:
- https://kubernetes.io/docs/reference/access-authn-authz/authentication/#static-token-file
- https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/#options
- https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/
compliance:
- cis_kubernetes_kubernetes_1.2.2_0023
- cis_kubernetes_kubernetes_3.1.15_0208
