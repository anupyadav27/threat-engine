rule_id: k8s.apiserver.server.audit_log_maxbackup_retent
service: apiserver
resource: server
requirement: Audit Log Maxbackup Retent
title: Ensure Apiserver Audit Log MaxBackup is Configured
description: This control checks that the 'audit-log-maxbackup' parameter for the
  Kubernetes apiserver is set to an appropriate value. This parameter determines how
  many backup audit logs are retained, ensuring that historical audit data is available
  for a sufficient period. A well-configured audit log retention policy helps maintain
  a secure logging environment, aids in compliance with security benchmarks like CIS,
  and assists in retaining evidence for security investigations.
rationale: If the apiserver's audit log max backup is not properly configured, excessive
  log data can accumulate, leading to potential disk space exhaustion. This can disrupt
  critical logging processes, hindering the ability to detect and investigate malicious
  activities effectively. Proper configuration mitigates risks of log tampering and
  ensures that audit trails are preserved for compliance and forensic analysis.
severity: high
domain: logging_and_monitoring
subcategory: audit_logging
scope: apiserver.server.audit_log_maxbackup_retent
references:
- https://kubernetes.io/docs/tasks/debug/debug-cluster/audit/
- https://kubernetes.io/docs/reference/config-api/apiserver-config.v1/
- https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/
compliance:
- cis_kubernetes_kubernetes_1.2.20_0041
