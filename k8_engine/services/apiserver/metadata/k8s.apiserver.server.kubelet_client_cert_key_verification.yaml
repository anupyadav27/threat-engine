rule_id: k8s.apiserver.server.kubelet_client_cert_key_verification
service: apiserver
resource: server
requirement: Kubelet Client Cert Key Verification
title: Enforce Kubelet Client Certificate Key Verification on API Server
description: This rule verifies that the Kubernetes API server is configured to enforce
  client certificate key verification for kubelet connections. It checks the presence
  and correct configuration of the '--kubelet-client-certificate' and '--kubelet-client-key'
  flags. Proper configuration ensures that only authenticated and authorized kubelets
  can communicate with the API server, mitigating spoofing attacks and ensuring encrypted
  communication.
rationale: Without proper verification of client certificates, malicious actors could
  impersonate kubelets, gaining unauthorized access to sensitive cluster operations.
  This could lead to data breaches, unauthorized workload management, and cluster
  disruption.
severity: high
domain: data_protection
subcategory: encryption_in_transit
scope: apiserver.server.kubelet_client_cert_key_verification
references:
- https://kubernetes.io/docs/reference/access-authn-authz/authentication/#x509-client-certs
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/#securing-kubelet
- https://kubernetes.io/docs/setup/best-practices/certificates/#all-certificates
compliance:
- cis_kubernetes_kubernetes_1.2.4_0025
