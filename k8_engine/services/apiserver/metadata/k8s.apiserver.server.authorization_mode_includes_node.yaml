rule_id: k8s.apiserver.server.authorization_mode_includes_node
service: apiserver
resource: server
requirement: Authorization Mode Includes Node
title: Ensure API Server Authorization Mode Includes Node
description: This rule checks that the Kubernetes API server is configured with 'Node'
  as one of its authorization modes. Proper configuration ensures that nodes can only
  perform operations on resources that are specifically allowed, thereby adhering
  to the principle of least privilege. This reduces the attack surface by limiting
  node access strictly to its required resources, preventing unauthorized access,
  and enhancing overall cluster security.
rationale: If the 'Node' authorization mode is not enabled, unauthorized users or
  compromised nodes may gain unnecessary access to sensitive API requests meant for
  nodes, leading to potential privilege escalation or data breaches. This mode restricts
  nodes to only access resources necessary for their operation, mitigating the risk
  of lateral movement and maintaining cluster security by ensuring only legitimate
  node-level access.
severity: high
domain: identity_and_access_management
subcategory: authentication
scope: apiserver.server.authorization_mode_includes_node
references:
- https://kubernetes.io/docs/reference/access-authn-authz/authorization/#node
- https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/#options
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/#restricting-cloud-metadata-api-access
compliance:
- cis_kubernetes_kubernetes_1.2.7_0028
