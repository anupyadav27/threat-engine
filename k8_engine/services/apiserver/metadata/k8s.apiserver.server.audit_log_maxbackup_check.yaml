rule_id: k8s.apiserver.server.audit_log_maxbackup_check
service: apiserver
resource: server
requirement: Audit Log Maxbackup Check
title: Configure Audit Log MaxBackup in Kube-Apiserver
description: This rule checks that the `--audit-log-maxbackup` parameter is correctly
  set in the kube-apiserver configuration. The parameter determines the maximum number
  of audit log files to retain, which is essential for maintaining a historical record
  of API server interactions. A properly configured maxbackup ensures that audit logs
  are preserved for a sufficient duration to support forensic investigations and compliance
  audits, while also preventing disk space exhaustion. The recommended configuration
  aligns with security best practices and industry standards, such as the CIS Kubernetes
  Benchmark.
rationale: Improper configuration of the audit-log-maxbackup setting in the kube-apiserver
  can lead to excessive storage usage or loss of audit logs, which are crucial for
  post-incident investigations and ensuring compliance with security policies. Without
  proper backups, critical security events may be missed, hindering the ability to
  detect and respond to unauthorized access or configuration changes.
severity: high
domain: logging_and_monitoring
subcategory: audit_logging
scope: apiserver.server.audit_log_maxbackup_check
references:
- https://kubernetes.io/docs/tasks/debug/debug-cluster/audit/
- https://kubernetes.io/docs/reference/access-authn-authz/audit/
- https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/
compliance:
- cis_kubernetes_kubernetes_3.1.11_0204
- cis_kubernetes_kubernetes_3.1.12_0205
