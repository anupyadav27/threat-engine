rule_id: k8s.apiserver.tls.client_certificates_enabled
service: apiserver
resource: tls
requirement: Client Certificates Enabled
title: Enable Client Certificate Authentication for API Server
description: This rule checks that the Kubernetes API server is configured to require
  client certificates for authentication. A valid configuration includes enabling
  the `--client-ca-file` flag with a path to a valid CA certificate file. This setup
  ensures that only clients with valid certificates issued by the CA can interact
  with the API server, thus preventing unauthorized access and enhancing the security
  of API communications.
rationale: Without client certificate authentication, the Kubernetes API server is
  vulnerable to unauthorized access and man-in-the-middle attacks. This misconfiguration
  can allow attackers to impersonate legitimate users or services, potentially leading
  to data breaches and unauthorized actions within the cluster.
severity: high
domain: data_protection
subcategory: encryption_in_transit
scope: apiserver.tls.client_certificates_enabled
references:
- https://kubernetes.io/docs/reference/access-authn-authz/authentication/#x509-client-certs
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/#use-transport-layer-security-tls-for-all-communication
- https://kubernetes.io/docs/setup/best-practices/certificates/
compliance: []
