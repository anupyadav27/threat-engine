rule_id: k8s.apiserver.policy.captures_metadata
service: apiserver
resource: policy
requirement: Captures Metadata
title: Ensure Metadata Capture in API Server Audit Logs
description: This rule checks if the Kubernetes API server is configured to capture
  metadata in its audit logs. Proper configuration involves setting up audit policies
  that include metadata such as user identity, IP address, and request parameters.
  Capturing detailed metadata helps in creating an audit trail, crucial for forensic
  analysis, compliance audits, and ensuring accountability. It reduces security risks
  by enabling the detection of unauthorized access and anomalous behavior.
rationale: Failure to capture metadata in API server audit logs can lead to insufficient
  tracking of changes and activities within the Kubernetes cluster, making it difficult
  to detect unauthorized actions or anomalies. Attackers could exploit this lack of
  visibility to perform lateral movement or escalate privileges without detection,
  compromising cluster integrity and confidentiality.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: apiserver.policy.captures_metadata
references:
- https://kubernetes.io/docs/tasks/debug/debug-cluster/audit/
- https://kubernetes.io/docs/reference/config-api/kubernetes-audit/v1/
- https://kubernetes.io/docs/concepts/cluster-administration/logging/
compliance:
- pci_dss_v4_multi_cloud_9.2.1_0121
- pci_dss_v4_multi_cloud_9.2.1.1_0122
- pci_dss_v4_multi_cloud_9.3.1_0126
- pci_dss_v4_multi_cloud_9.3.1.1_0127
- pci_dss_v4_multi_cloud_10.1.2_0142
