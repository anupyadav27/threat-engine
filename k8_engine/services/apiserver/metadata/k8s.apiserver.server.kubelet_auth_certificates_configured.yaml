rule_id: k8s.apiserver.server.kubelet_auth_certificates_configured
service: apiserver
resource: server
requirement: Kubelet Auth Certificates Configured
title: Ensure Kubelet Authentication with Certificates is Configured
description: This control checks if the Kubernetes apiserver is configured to authenticate
  kubelets using client certificates. A valid configuration ensures that only authenticated
  kubelets can communicate with the apiserver, thereby reducing the risk of unauthorized
  access. Proper configuration involves setting up the apiserver with the '--kubelet-client-certificate'
  and '--kubelet-client-key' flags, which specify the client certificate and key to
  use when connecting to the kubelet. This setup helps ensure that only verified kubelets
  can execute operations, thus enhancing the overall security of the cluster.
rationale: Without proper kubelet authentication, unauthorized users could gain access
  to kubelet APIs, potentially leading to unauthorized workload management and node
  resource exploitation. Attackers might exploit this to escalate privileges, deploy
  malicious containers, or extract sensitive data from pods.
severity: high
domain: identity_and_access_management
subcategory: authentication
scope: apiserver.server.kubelet_auth_certificates_configured
references:
- https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/#options
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/#securing-kubelet
- https://kubernetes.io/docs/reference/access-authn-authz/authentication/
compliance:
- cis_kubernetes_kubernetes_1.1.22_0141
- cis_kubernetes_kubernetes_1.1.23_0142
- cis_kubernetes_kubernetes_1.2.5_0026
