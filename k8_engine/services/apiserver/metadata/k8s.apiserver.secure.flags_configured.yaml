rule_id: k8s.apiserver.secure.flags_configured
service: apiserver
resource: secure
requirement: Flags Configured
title: Ensure Kube-apiserver Secure Flags Are Properly Configured
description: This rule checks that the kube-apiserver is configured with secure flags
  according to best practices. Critical flags include '--anonymous-auth=false', '--insecure-port=0',
  and '--secure-port=443', among others. Proper configuration of these flags ensures
  that the API server does not accept requests from unauthenticated users, disables
  insecure communication channels, and enforces secure communication. This helps in
  mitigating risks of unauthorized access and data interception, ensuring compliance
  with security standards such as the CIS Kubernetes Benchmark.
rationale: Misconfiguration of kube-apiserver flags can lead to vulnerabilities such
  as unauthorized access, data breaches, and privilege escalation attacks. Properly
  configured flags ensure that security features like encryption, authentication,
  and authorization are enforced, reducing the risk of exploitation by malicious actors.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: apiserver.secure.flags_configured
references:
- https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/
- https://kubernetes.io/docs/concepts/security/overview/
compliance:
- nist_800_53_rev5_multi_cloud_CM-6-b_0398
