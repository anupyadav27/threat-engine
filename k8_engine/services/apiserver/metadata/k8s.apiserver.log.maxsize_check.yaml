rule_id: k8s.apiserver.log.maxsize_check
service: apiserver
resource: log
requirement: Maxsize Check
title: Enforce Max Log Size for kube-apiserver
description: This control checks whether the `--audit-log-maxsize` flag is set for
  the kube-apiserver, ensuring that log files do not exceed a specified size. A properly
  configured max log size ensures that log rotation occurs, preventing logs from growing
  indefinitely, which could lead to disk exhaustion and hinder effective log analysis.
  This also aligns with best practices as outlined in the CIS Kubernetes Benchmark,
  helping maintain a secure and manageable Kubernetes environment.
rationale: If the maximum size of the kube-apiserver logs is not properly configured,
  it can lead to excessive disk usage, potentially exhausting storage resources and
  leading to denial of service. Moreover, excessively large log files can become difficult
  to manage, making it harder to audit and detect security incidents. Without proper
  log size management, attackers might exploit this to cover their tracks or create
  noise to mask malicious activities.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: apiserver.log.maxsize_check
references:
- https://kubernetes.io/docs/tasks/debug/debug-cluster/audit/#log-backend
- https://kubernetes.io/docs/reference/config-api/apiserver-audit-config.v1/
- https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/
compliance:
- cis_kubernetes_kubernetes_1.2.21_0042
