rule_id: k8s.apiserver.server.image_policy_webhook_enabled
service: apiserver
resource: server
requirement: Image Policy Webhook Enabled
title: Enable and Configure ImagePolicyWebhook for Secure Image Admission
description: This rule checks that the ImagePolicyWebhook is enabled on the Kubernetes
  API server. A correctly configured ImagePolicyWebhook acts as an admission controller
  that intercepts image deployment requests, verifying them against a policy before
  allowing them to run. This ensures that only images from trusted sources are deployed,
  and restricts unauthorized or potentially harmful images. A good configuration involves
  setting up the webhook to reference a policy that defines allowed image sources,
  image signatures, and other compliance requirements. This control is critical for
  maintaining a secure and compliant container environment.
rationale: Without the ImagePolicyWebhook enabled, the Kubernetes cluster is vulnerable
  to running unverified or potentially malicious container images. This can lead to
  security breaches such as running compromised images that might contain malware
  or backdoors, potentially jeopardizing the integrity and confidentiality of the
  cluster and its applications. Enabling this webhook ensures that only images that
  meet predefined security policies are deployed, mitigating risks associated with
  image provenance and integrity.
severity: medium
domain: workload_security
subcategory: admission_control
scope: apiserver.server.image_policy_webhook_enabled
references:
- https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#imagepolicywebhook
- https://kubernetes.io/docs/concepts/containers/images/#image-security
- https://kubernetes.io/docs/tasks/administer-cluster/secure-cluster/
compliance:
- cis_kubernetes_kubernetes_5.5.1_0130
