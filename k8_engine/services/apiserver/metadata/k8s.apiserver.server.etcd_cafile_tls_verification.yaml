rule_id: k8s.apiserver.server.etcd_cafile_tls_verification
service: apiserver
resource: server
requirement: Etcd Cafile Tls Verification
title: Enable Etcd CA File TLS Verification in API Server
description: This rule checks that the `--etcd-cafile` flag is set on the Kubernetes
  API server to ensure TLS connections to etcd are verified with the specified Certificate
  Authority (CA) file. Proper configuration requires the etcd CA file to be present
  and correctly referenced, ensuring that all communication between the API server
  and etcd is encrypted and authenticated. This minimizes the risk of unauthorized
  data access and helps maintain compliance with security benchmarks by protecting
  data in transit.
rationale: Without proper TLS verification of the etcd CA file, the Kubernetes API
  server could connect to an untrusted etcd instance. This could lead to a man-in-the-middle
  attack where an attacker intercepts or modifies sensitive cluster data stored in
  etcd, compromising the integrity and confidentiality of the entire Kubernetes environment.
severity: high
domain: data_protection
subcategory: encryption_in_transit
scope: apiserver.server.etcd_cafile_tls_verification
references:
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/#use-transport-layer-security-tls-for-all-cluster-communication
- https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/#options
- https://kubernetes.io/docs/setup/best-practices/certificates/#all-certificates
compliance:
- cis_kubernetes_kubernetes_1.2.28_0049
