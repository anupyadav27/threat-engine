rule_id: k8s.apiserver.encryption.config_check
service: apiserver
resource: encryption
requirement: Config Check
title: Ensure Encryption Configuration for Secrets at Rest
description: This check ensures that the Kubernetes API server is configured to use
  encryption for secrets at rest. It involves validating that the 'EncryptionConfiguration'
  parameter is properly defined in the API server's configuration file, specifying
  the use of encryption providers such as 'AES-CBC' or 'secretbox'. A correctly configured
  encryption setup ensures that secrets stored in etcd are encrypted and only accessible
  by authorized components, significantly enhancing the security posture of the cluster
  by protecting sensitive data from unauthorized access and exposure.
rationale: Without encryption configured for secrets at rest, sensitive data stored
  in etcd is vulnerable to unauthorized access and data breaches. Attackers gaining
  access to etcd can exploit unencrypted secrets, leading to potential information
  disclosure and compromise of the entire Kubernetes cluster. Encrypting secrets mitigates
  these risks by ensuring that even if etcd is accessed, the data remains protected.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: apiserver.encryption.config_check
references:
- https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/
- https://kubernetes.io/docs/setup/best-practices/enforcing-policies/
- https://kubernetes.io/docs/reference/access-authn-authz/certificate-signing-requests/
compliance:
- cis_kubernetes_kubernetes_1.2.32_0136
