rule_id: k8s.apiserver.server.deny_service_external_ips_not_set
service: apiserver
resource: server
requirement: Deny Service External Ips Not Set
title: Restrict Use of External IPs in Services
description: This control ensures that services within the Kubernetes cluster do not
  have external IPs unless explicitly required. It checks for the absence of external
  IPs in service configurations, which helps to prevent accidental exposure of internal
  services to the public internet. By limiting the use of external IPs, the attack
  surface is reduced, enhancing the security posture of the cluster. A properly configured
  service should only use ClusterIP or NodePort types unless there is a justified
  need for an external IP, which should be meticulously documented and reviewed.
rationale: Allowing services to use external IPs can expose them to the internet,
  increasing the risk of unauthorized access and potential attacks such as DDoS. Misconfiguration
  could lead to sensitive services being accessible from outside the cluster, bypassing
  network security controls and exposing them to vulnerabilities.
severity: medium
domain: network_security
subcategory: network_configuration
scope: apiserver.server.deny_service_external_ips_not_set
references:
- https://kubernetes.io/docs/concepts/services-networking/service/#external-ips
- https://kubernetes.io/docs/tasks/access-application-cluster/configure-cloud-provider-firewall/
- https://kubernetes.io/docs/concepts/security/overview/
compliance:
- cis_kubernetes_kubernetes_1.2.3_0024
