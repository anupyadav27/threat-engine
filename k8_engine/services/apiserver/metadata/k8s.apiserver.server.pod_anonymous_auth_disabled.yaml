rule_id: k8s.apiserver.server.pod_anonymous_auth_disabled
service: apiserver
resource: server
requirement: Pod Anonymous Auth Disabled
title: Disable Anonymous Authentication to API Server
description: This check ensures that anonymous authentication is disabled in the Kubernetes
  API server configuration. A secure setup demands the '--anonymous-auth=false' flag
  to be set in the API server startup parameters. This prevents any unauthenticated
  requests from being accepted by the API server, thereby enforcing strict access
  control protocols. Proper configuration ensures robust security by ensuring that
  all requests are traceable to an authenticated user or service account, which is
  crucial for auditing and compliance with security standards like the CIS Kubernetes
  Benchmark.
rationale: Anonymous authentication allows unauthenticated requests to the Kubernetes
  API server, which poses a significant security risk. Attackers can exploit this
  to gain unauthorized access, perform reconnaissance, or execute malicious actions
  without accountability. Disabling anonymous authentication mitigates this risk by
  ensuring that only authenticated and authorized users can interact with the cluster,
  thereby reducing the potential attack surface.
severity: critical
domain: identity_and_access_management
subcategory: authentication
scope: apiserver.server.pod_anonymous_auth_disabled
references:
- https://kubernetes.io/docs/reference/access-authn-authz/controlling-access/#api-server-ports-and-ips
- https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/
- https://kubernetes.io/docs/concepts/security/overview/#controlling-access-to-the-kube-api-server
compliance:
- cis_kubernetes_kubernetes_1.2.1_0022
