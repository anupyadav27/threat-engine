rule_id: k8s.apiserver.server.audit_policy_file_configured
service: apiserver
resource: server
requirement: Audit Policy File Configured
title: Configure Kubernetes API Server Audit Policy File
description: This rule verifies that the Kubernetes API Server has an audit policy
  file configured according to best practices. It checks for the presence and correct
  configuration of the audit policy file, which defines how audit logs are generated
  and processed. A well-configured audit policy file helps in tracking access and
  changes to the cluster, identifying potential security incidents, and ensuring compliance
  with industry standards.
rationale: Misconfiguration of the audit policy file can lead to inadequate logging
  and monitoring, making it difficult to detect unauthorized access and activities.
  Without proper audit logging, attackers can exploit vulnerabilities unnoticed, leading
  to data breaches and non-compliance with regulatory standards.
severity: high
domain: logging_and_monitoring
subcategory: audit_logging
scope: apiserver.server.audit_policy_file_configured
references:
- https://kubernetes.io/docs/tasks/debug/debug-cluster/audit/
- https://kubernetes.io/docs/reference/access-authn-authz/authorization/
- https://kubernetes.io/docs/reference/config-api/apiserver-audit.v1/
compliance:
- canada_pbmm_moderate_multi_cloud_CCCS_CA-7_0039
- nist_800_171_r2_multi_cloud_3_11_2_3.11.2_Scan_for_vulnerabilities_in_organiz_0001
- nist_800_171_r2_multi_cloud_3_1_12_3.1.12_Monitor_and_control_remote_access_s_0021
- nist_800_53_rev5_multi_cloud_CA-7-a_0337
- nist_800_53_rev5_multi_cloud_PM-31-a_0911
- nist_800_53_rev5_multi_cloud_SI-2-a_1342
- pci_dss_v4_multi_cloud_8.4.1_0113
- pci_dss_v4_multi_cloud_8.5.1_0116
- pci_dss_v4_multi_cloud_8.6.1_0117
- pci_dss_v4_multi_cloud_9.1.1_0119
- pci_dss_v4_multi_cloud_10.1.1_0141
- cis_kubernetes_kubernetes_3.2.1_0072
