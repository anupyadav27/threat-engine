rule_id: k8s.apiserver.service.account_lookup_enabled
service: apiserver
resource: service
requirement: Account Lookup Enabled
title: Ensure Service Account Lookup is Enabled in API Server
description: This rule checks whether the Kubernetes API server is configured with
  the '--service-account-lookup' flag set to 'true'. A properly configured API server
  ensures that service account tokens are validated against the configured authentication
  method. This reduces the risk of unauthorized access by ensuring that service accounts
  are legitimate and have appropriate permissions, thus enhancing the overall security
  of the Kubernetes cluster.
rationale: If service account lookup is disabled, the API server might fail to authenticate
  service accounts properly, allowing unauthorized access to resources. This misconfiguration
  can be exploited through privilege escalation attacks or unauthorized resource access,
  compromising the entire cluster's security.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: apiserver.service.account_lookup_enabled
references:
- https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/
- https://kubernetes.io/docs/concepts/security/overview/
- https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/
compliance: []
