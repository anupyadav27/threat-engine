rule_id: k8s.apiserver.server.encryption_provider_config_check
service: apiserver
resource: server
requirement: Encryption Provider Config Check
title: Ensure Encryption at Rest is Configured in Kube-Apiserver
description: This rule checks if the Kubernetes API server has an encryption provider
  configuration set, ensuring that data stored in etcd is encrypted at rest. A proper
  configuration involves specifying an encryption provider and ensuring that all sensitive
  data types, such as Secrets, ConfigMaps, and other resources, are encrypted. This
  helps protect against data exfiltration and unauthorized access, maintaining compliance
  with standards like the CIS Kubernetes Benchmark.
rationale: Failure to configure encryption at rest for data in Kubernetes can lead
  to data breaches, where sensitive data may be accessed by unauthorized parties.
  Attack vectors include unauthorized access to etcd, where Kubernetes stores all
  its data, including secrets and configuration details. Proper encryption mitigates
  these risks by ensuring that data remains unreadable without appropriate decryption
  keys.
severity: high
domain: data_protection
subcategory: encryption
scope: apiserver.server.encryption_provider_config_check
references:
- https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/
- https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/#options
- https://kubernetes.io/docs/setup/best-practices/enforcing-policies/
compliance:
- cis_kubernetes_kubernetes_1.2.33_0213
