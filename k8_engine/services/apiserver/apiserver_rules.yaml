component: apiserver
component_type: control_plane
discovery:
- discovery_id: list_apiserver_resources
  calls:
  - action: list_pods
    fields:
    - path: name
      var: name
    - path: namespace
      var: namespace
    - path: labels
      var: labels
checks:
- check_id: k8s.apiserver.access.logging_enabled
  name: Logging Enabled
  severity: MEDIUM
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.logging-enabled
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.admission.plugin_serviceaccount_check
  name: Plugin Serviceaccount Check
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.plugin-serviceaccount-check
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.anonymous.auth_disabled
  name: Auth Disabled
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.auth-disabled
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.audit.logging_enabled
  name: Logging Enabled
  severity: MEDIUM
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.logging-enabled
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.authentication.enabled
  name: Enabled
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.enabled
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.authentication.mfa_enabled
  name: Mfa Enabled
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.mfa-enabled
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.authentication.strong_mechanism_enabled
  name: Strong Mechanism Enabled
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.strong-mechanism-enabled
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.authorization.mode_check
  name: Mode Check
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.mode-check
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.authorization.mode_rbac
  name: Mode Rbac
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.mode-rbac
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.automatic.upgrade_enabled
  name: Upgrade Enabled
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.upgrade-enabled
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.backup.configured
  name: Configured
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.configured
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.configuration.review_scheduled
  name: Review Scheduled
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.review-scheduled
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.ddos.protection_configured
  name: Protection Configured
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.protection-configured
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.deletion.protection_enabled
  name: Protection Enabled
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.protection-enabled
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.encryption.config_check
  name: Config Check
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.config-check
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.high.availability_configured
  name: Availability Configured
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.availability-configured
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.https.only
  name: Only
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.only
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.log.backup_configured
  name: Backup Configured
  severity: MEDIUM
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.backup-configured
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.log.maxsize_check
  name: Maxsize Check
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.maxsize-check
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.policy.captures_metadata
  name: Captures Metadata
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.captures-metadata
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.policy.configured
  name: Configured
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.configured
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.rate.limiting_enabled
  name: Limiting Enabled
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.limiting-enabled
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.secret.authority_validated
  name: Authority Validated
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.authority-validated
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.secure.configuration_applied
  name: Configuration Applied
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.configuration-applied
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.secure.flags_configured
  name: Flags Configured
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.flags-configured
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.admission_control_policy_check
  name: Admission Control Policy Check
  severity: MEDIUM
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.admission-control-policy-check
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.admission_control_service_account_check
  name: Admission Control Service Account Check
  severity: MEDIUM
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.admission-control-service-account-check
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.admission_controller_image_policy_webhook_configured
  name: Admission Controller Image Policy Webhook Configured
  severity: MEDIUM
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.admission-controller-image-policy-webhook-configured
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.admission_plugin_namespace_lifecycle_enabled
  name: Admission Plugin Namespace Lifecycle Enabled
  severity: MEDIUM
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.admission-plugin-namespace-lifecycle-enabled
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.admission_plugins_always_pull_images_set
  name: Admission Plugins Always Pull Images Set
  severity: MEDIUM
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.admission-plugins-always-pull-images-set
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.admission_plugins_check
  name: Admission Plugins Check
  severity: MEDIUM
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.admission-plugins-check
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.admission_plugins_event_rate_limit_set
  name: Admission Plugins Event Rate Limit Set
  severity: MEDIUM
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.admission-plugins-event-rate-limit-set
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.admission_plugins_node_restriction_check
  name: Admission Plugins Node Restriction Check
  severity: MEDIUM
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.admission-plugins-node-restriction-check
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.admission_plugins_podsecuritypolicy_check
  name: Admission Plugins Podsecuritypolicy Check
  severity: MEDIUM
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.admission-plugins-podsecuritypolicy-check
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.admission_plugins_security_context_deny_check
  name: Admission Plugins Security Context Deny Check
  severity: MEDIUM
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.admission-plugins-security-context-deny-check
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.args_profiling_disabled
  name: Args Profiling Disabled
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.args-profiling-disabled
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.audit_log_maxage_compliance_check
  name: Audit Log Maxage Compliance Check
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.audit-log-maxage-compliance-check
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.audit_log_maxbackup_check
  name: Audit Log Maxbackup Check
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.audit-log-maxbackup-check
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.audit_log_maxbackup_retent
  name: Audit Log Maxbackup Retent
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.audit-log-maxbackup-retent
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.audit_log_path_check
  name: Audit Log Path Check
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.audit-log-path-check
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.audit_policy_file_configured
  name: Audit Policy File Configured
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.audit-policy-file-configured
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.audit_policy_verification
  name: Audit Policy Verification
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.audit-policy-verification
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.authorization_mode_includes_node
  name: Authorization Mode Includes Node
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.authorization-mode-includes-node
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.automatic_upgrade_enabled
  name: Automatic Upgrade Enabled
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.automatic-upgrade-enabled
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.client_ca_configured
  name: Client Ca Configured
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.client-ca-configured
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.client_ca_file_configuration_check
  name: Client Ca File Configuration Check
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.client-ca-file-configuration-check
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.client_ca_file_presence_check
  name: Client Ca File Presence Check
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.client-ca-file-presence-check
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.configuration_review_scheduled
  name: Configuration Review Scheduled
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.configuration-review-scheduled
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.ddos_protection_configured
  name: Ddos Protection Configured
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.ddos-protection-configured
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.deny_service_external_ips_not_set
  name: Deny Service External Ips Not Set
  severity: MEDIUM
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.deny-service-external-ips-not-set
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.encryption_provider_config_check
  name: Encryption Provider Config Check
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.encryption-provider-config-check
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.encryption_provider_verification
  name: Encryption Provider Verification
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.encryption-provider-verification
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.etcd_cafile_tls_verification
  name: Etcd Cafile Tls Verification
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.etcd-cafile-tls-verification
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.etcd_cafile_validity_check
  name: Etcd Cafile Validity Check
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.etcd-cafile-validity-check
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.etcd_tls_configured
  name: Etcd Tls Configured
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.etcd-tls-configured
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.high_availability_enabled
  name: High Availability Enabled
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.high-availability-enabled
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.https_only_configured
  name: Https Only Configured
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.https-only-configured
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.image_policy_webhook_enabled
  name: Image Policy Webhook Enabled
  severity: MEDIUM
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.image-policy-webhook-enabled
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.insecure_port_disabled
  name: Insecure Port Disabled
  severity: CRITICAL
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.insecure-port-disabled
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.kubelet_auth_certificates_configured
  name: Kubelet Auth Certificates Configured
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.kubelet-auth-certificates-configured
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.kubelet_client_cert_key_verification
  name: Kubelet Client Cert Key Verification
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.kubelet-client-cert-key-verification
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.pod_anonymous_auth_disabled
  name: Pod Anonymous Auth Disabled
  severity: CRITICAL
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.pod-anonymous-auth-disabled
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.pod_authorization_mode_rbac_enabled
  name: Pod Authorization Mode Rbac Enabled
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.pod-authorization-mode-rbac-enabled
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.rate_limiting_enabled
  name: Rate Limiting Enabled
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.rate-limiting-enabled
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.request_timeout_check
  name: Request Timeout Check
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.request-timeout-check
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.secure_configuration_enforced
  name: Secure Configuration Enforced
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.secure-configuration-enforced
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.secure_port_not_zero
  name: Secure Port Not Zero
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.secure-port-not-zero
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.service_account_key_file_check
  name: Service Account Key File Check
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.service-account-key-file-check
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.tls_cert_file_check
  name: Tls Cert File Check
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.tls-cert-file-check
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.tls_certificates_configured
  name: Tls Certificates Configured
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.tls-certificates-configured
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.tls_cipher_suites_strong_check
  name: Tls Cipher Suites Strong Check
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.tls-cipher-suites-strong-check
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.token_auth_file_not_set
  name: Token Auth File Not Set
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.token-auth-file-not-set
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.server.verification_configured
  name: Verification Configured
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.verification-configured
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.service.account_lookup_enabled
  name: Account Lookup Enabled
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.account-lookup-enabled
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.ssh.access_disabled
  name: Access Disabled
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.access-disabled
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.tls.client_certificates_enabled
  name: Client Certificates Enabled
  severity: HIGH
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.client-certificates-enabled
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.apiserver.tls.enabled
  name: Enabled
  severity: LOW
  for_each: list_apiserver_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: arguments.enabled
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
