component: node
component_type: node
discovery:
- discovery_id: list_node_resources
  calls:
  - action: list_pods
    fields:
    - path: name
      var: name
    - path: namespace
      var: namespace
    - path: labels
      var: labels
checks:
- check_id: k8s.node.auto.repair_enabled
  name: Repair Enabled
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.automatic.updates_enabled
  name: Updates Enabled
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.automatic.upgrades_enabled
  name: Upgrades Enabled
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.configuration.compliance_check
  name: Compliance Check
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.configuration.management_enabled
  name: Management Enabled
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.deletion.protection_enabled
  name: Protection Enabled
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.labeling.for_inventory_tracking
  name: For Inventory Tracking
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.labeling.standard
  name: Standard
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.labels.inventory_maintained
  name: Inventory Maintained
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.memory.protection_mechanisms_enabled
  name: Protection Mechanisms Enabled
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.node.auto_upgrade_enabled
  name: Auto Upgrade Enabled
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.node.automatic_updates_enabled
  name: Automatic Updates Enabled
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.node.config_enforced
  name: Config Enforced
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.node.configuration_management_enabled
  name: Configuration Management Enabled
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.node.deletion_protection_enabled
  name: Deletion Protection Enabled
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.node.edr_integration_enabled
  name: Edr Integration Enabled
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.node.inventory_labels_maintained
  name: Inventory Labels Maintained
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.node.labeling_standard_configured
  name: Labeling Standard Configured
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.node.memory_protection_mechanisms_enabled
  name: Memory Protection Mechanisms Enabled
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.node.node_hardening_applied_enforced
  name: Node Hardening Applied Enforced
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.node.os_patch_enforced
  name: Os Patch Enforced
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.node.resource_utilization_audited
  name: Resource Utilization Audited
  severity: HIGH
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.node.runtime_security_enabled
  name: Runtime Security Enabled
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.node.tpm_verification_enabled
  name: Tpm Verification Enabled
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.os.patch_compliance
  name: Patch Compliance
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.pod.node_auto_upgrade_enabled
  name: Node Auto Upgrade Enabled
  severity: LOW
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.resource.monitoring_enabled
  name: Monitoring Enabled
  severity: MEDIUM
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.node.resource.utilization_monitored
  name: Utilization Monitored
  severity: MEDIUM
  for_each: list_node_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
