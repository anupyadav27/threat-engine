component: network
component_type: workload
discovery:
- discovery_id: list_network_resources
  calls:
  - action: list_network_policies
    fields:
    - path: name
      var: name
    - path: namespace
      var: namespace
    - path: labels
      var: labels
checks:
- check_id: k8s.network.anomaly.detection_enabled
  name: Detection Enabled
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.change.audit_enabled
  name: Audit Enabled
  severity: HIGH
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.change.monitoring_enabled
  name: Monitoring Enabled
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.changes.alerting_configured
  name: Alerting Configured
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.changes.audit_enabled
  name: Audit Enabled
  severity: HIGH
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.changes.logged
  name: Logged
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.changes.monitored
  name: Monitored
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.default.deny_egress
  name: Deny Egress
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.policy_types
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.encryption.in_transit_enabled
  name: In Transit Enabled
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.external.access_restricted
  name: Access Restricted
  severity: HIGH
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.flow.logging_enabled
  name: Logging Enabled
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.flow.logs_enabled
  name: Logs Enabled
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.ingress.ingress_controller_secure_enabled
  name: Ingress Controller Secure Enabled
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.policy_types
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.ingress.tls_termination_enabled_enforced
  name: Tls Termination Enabled Enforced
  severity: HIGH
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.internal.traffic_restricted
  name: Traffic Restricted
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.inventory.documented
  name: Documented
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.isolate.healthcare_clearinghouse
  name: Healthcare Clearinghouse
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.log.enabled
  name: Enabled
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.monitoring.alerts_configured
  name: Alerts Configured
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.monitoring.configured
  name: Configured
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.monitoring.logged
  name: Logged
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.monitoring.unauthorized_access
  name: Unauthorized Access
  severity: HIGH
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.networkpolicy.anomaly_detection_enabled
  name: Anomaly Detection Enabled
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.networkpolicy.dns_filtering_enabled
  name: Dns Filtering Enabled
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.networkpolicy.egress_traffic_controlled_enabled
  name: Egress Traffic Controlled Enabled
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.policy_types
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.networkpolicy.encryption_in_transit_enabled
  name: Encryption In Transit Enabled
  severity: HIGH
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.networkpolicy.internal_traffic_restricted
  name: Internal Traffic Restricted
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.networkpolicy.isolate_healthcare_clearinghouse_configured
  name: Isolate Healthcare Clearinghouse Configured
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.networkpolicy.namespace_isolation_enforced
  name: Namespace Isolation Enforced
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.networkpolicy.network_policies_enforced
  name: Network Policies Enforced
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.policy_types
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.networkpolicy.network_segmentation_enforced
  name: Network Segmentation Enforced
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.policy_types
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.networkpolicy.no_public_ip_configured
  name: No Public Ip Configured
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.networkpolicy.rate_limiting_enabled
  name: Rate Limiting Enabled
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.networkpolicy.restrict_egress_ports_configured
  name: Restrict Egress Ports Configured
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.policy_types
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.networkpolicy.restricted_to_security_services
  name: Restricted To Security Services
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.networkpolicy.review_scheduled
  name: Review Scheduled
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.networkpolicy.risk_assessment_configured
  name: Risk Assessment Configured
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.networkpolicy.service_to_service_encryption_enforced
  name: Service To Service Encryption Enforced
  severity: HIGH
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.networkpolicy.tls_encryption_enabled
  name: Tls Encryption Enabled
  severity: HIGH
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.networkpolicy.unused_policies_removed_configured
  name: Unused Policies Removed Configured
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.no.public_access
  name: Public Access
  severity: HIGH
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.no.public_ip
  name: Public Ip
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.pod.inventory_configured
  name: Inventory Configured
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.policies.documented
  name: Documented
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.policy.default_deny_ingress_check
  name: Default Deny Ingress Check
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.policy_types
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.policy.namespace_compliance_check
  name: Namespace Compliance Check
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.rate.limiting_enabled
  name: Limiting Enabled
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.restrict.admin_access
  name: Admin Access
  severity: HIGH
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.restrict.egress_to_internet
  name: Egress To Internet
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.policy_types
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.restrict.external_access
  name: External Access
  severity: HIGH
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.restrict.ingress_ports
  name: Ingress Ports
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.policy_types
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.restrict.internet_access
  name: Internet Access
  severity: HIGH
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.restrict.public_ip_access
  name: Public Ip Access
  severity: HIGH
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.review.scheduled
  name: Scheduled
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.risk.assessment_configured
  name: Assessment Configured
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.secure.transport_policy
  name: Transport Policy
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.service.authorization_policies_enforced
  name: Authorization Policies Enforced
  severity: HIGH
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.service.dns_policies_enforced_enabled
  name: Dns Policies Enforced Enabled
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.service.mtls_enforced
  name: Mtls Enforced
  severity: HIGH
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.ssh.restricted
  name: Restricted
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.supplier.service_monitoring_enabled
  name: Service Monitoring Enabled
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.suspicious.activity_monitoring
  name: Activity Monitoring
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.threat.detection_traffic_monitoring
  name: Detection Traffic Monitoring
  severity: MEDIUM
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.tls.encryption_enabled
  name: Encryption Enabled
  severity: HIGH
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.tls.enforced
  name: Enforced
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.network.unused.policies_removed
  name: Policies Removed
  severity: LOW
  for_each: list_network_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
