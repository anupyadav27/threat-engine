rule_id: k8s.network.flow.logging_enabled
service: network
resource: flow
requirement: Logging Enabled
title: Enable Network Flow Logging for Traffic Visibility
description: This rule checks whether network flow logging is enabled in Kubernetes
  clusters, ensuring that traffic between pods and external networks is logged. A
  properly configured logging setup captures detailed records of network activity,
  aiding in the detection of anomalies and the investigation of security incidents.
  Enabling network flow logs helps identify unauthorized access attempts, track data
  movement, and maintain compliance with security regulations.
rationale: Without network flow logging, malicious activities such as data exfiltration
  or lateral movement within a cluster may go undetected. Attackers might exploit
  unmonitored ingress and egress network paths to perform unauthorized actions, making
  it crucial to monitor and log network flows for timely detection and response.
severity: medium
domain: logging_and_monitoring
subcategory: audit_logging
scope: network.flow.logging_enabled
references:
- https://kubernetes.io/docs/tasks/debug/debug-cluster/audit/
- https://kubernetes.io/docs/concepts/cluster-administration/logging/
- https://kubernetes.io/docs/concepts/services-networking/network-policies/
compliance:
- iso27001_2022_multi_cloud_A.8.16_0071
- pci_dss_v4_multi_cloud_8.4.1_0113
- pci_dss_v4_multi_cloud_8.5.1_0116
- pci_dss_v4_multi_cloud_8.6.1_0117
- pci_dss_v4_multi_cloud_9.1.1_0119
- pci_dss_v4_multi_cloud_10.1.1_0141
