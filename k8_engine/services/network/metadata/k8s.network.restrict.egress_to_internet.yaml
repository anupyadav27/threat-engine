rule_id: k8s.network.restrict.egress_to_internet
service: network
resource: restrict
requirement: Egress To Internet
title: Restrict Egress Traffic to Prevent Uncontrolled Internet Access
description: This control checks that Kubernetes Network Policies are in place to
  restrict egress traffic from pods to the internet. Proper configuration ensures
  that pods can only communicate with explicitly permitted external endpoints, reducing
  the attack surface. A secure configuration typically involves defining specific
  egress rules that limit traffic to necessary external IPs or ranges and ports. This
  helps achieve compliance with security standards and ensures that all outbound communications
  are intentional and monitored.
rationale: Allowing unrestricted egress from Kubernetes pods can expose the cluster
  to various attack vectors, such as data exfiltration, external command-and-control
  servers, and unauthorized access to external services. By restricting egress traffic,
  you can minimize the risk of compromised pods communicating with malicious external
  entities, thereby maintaining the integrity and confidentiality of your applications
  and data.
severity: medium
domain: network_security
subcategory: network_policy
scope: network.restrict.egress_to_internet
references:
- https://kubernetes.io/docs/concepts/services-networking/network-policies/#default-allow-all-egress-traffic
- https://kubernetes.io/docs/tasks/administer-cluster/declare-network-policy/#limiting-pod-communication
- https://kubernetes.io/docs/concepts/network-policy/
compliance:
- pci_dss_v4_multi_cloud_1.3.2_0010
- pci_dss_v4_multi_cloud_11.3.2_0168
- pci_dss_v4_multi_cloud_11.3.2.1_0169
