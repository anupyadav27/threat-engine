rule_id: k8s.network.service.dns_policies_enforced_enabled
service: network
resource: service
requirement: Dns Policies Enforced Enabled
title: Enforce DNS Policies on Kubernetes Services
description: This rule checks that DNS policies are enforced on Kubernetes services.
  A correct configuration ensures that DNS traffic is handled according to network
  policies, preventing unauthorized access and tampering. The configuration should
  specify 'dnsPolicy' as 'Default', 'ClusterFirst', or 'None', based on the security
  requirements of the application. Enforcing DNS policies enhances security by controlling
  how DNS queries are resolved, thus reducing the attack surface for DNS-based attacks.
rationale: Without DNS policies enforced, Kubernetes services may become susceptible
  to DNS spoofing and cache poisoning attacks. This misconfiguration can allow attackers
  to redirect traffic to malicious servers, leading to data theft or further infiltration
  into the cluster. Enforcing DNS policies helps ensure that DNS requests are securely
  handled according to predefined rules, mitigating these risks.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: network.service.dns_policies_enforced_enabled
references:
- https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/#pod-s-dns-policy
- https://kubernetes.io/docs/tasks/administer-cluster/dns-custom-nameservers/
- https://kubernetes.io/docs/concepts/services-networking/network-policies/
compliance: []
