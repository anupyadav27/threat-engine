rule_id: k8s.network.restrict.ingress_ports
service: network
resource: restrict
requirement: Ingress Ports
title: Restrict Ingress Ports with Network Policies
description: This control checks that Kubernetes Network Policies are configured to
  restrict ingress ports to only those necessary for application functionality, minimizing
  exposure. A good configuration involves specifying the allowed ingress ports in
  Network Policies for each application, ensuring that only intended traffic can reach
  the services. This helps to enforce the principle of least privilege, reduce the
  risk of accidental exposure, and align with security best practices and compliance
  requirements.
rationale: Failing to properly restrict ingress ports can expose applications to unauthorized
  access and potential attacks such as port scanning, denial of service, or exploitation
  of vulnerabilities in services exposed to the internet. By controlling ingress traffic,
  you reduce the attack surface and limit potential entry points for malicious actors.
severity: medium
domain: network_security
subcategory: network_policy
scope: network.restrict.ingress_ports
references:
- https://kubernetes.io/docs/concepts/services-networking/network-policies/#networkpolicy-resource
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/#restricting-network-access
- https://kubernetes.io/docs/concepts/services-networking/service/#external-traffic-policy
compliance:
- nist_800_53_rev5_multi_cloud_CM-7-b_0412
- pci_dss_v4_multi_cloud_1.2.3_0004
- pci_dss_v4_multi_cloud_12.3.1_0181
- pci_dss_v4_multi_cloud_12.3.3_0182
- pci_dss_v4_multi_cloud_12.3.4_0183
- pci_dss_v4_multi_cloud_9.2.2_0123
