rule_id: k8s.network.policy.default_deny_ingress_check
service: network
resource: policy
requirement: Default Deny Ingress Check
title: Enforce Default Deny Ingress Policy for Network Security
description: This rule checks that every namespace in the Kubernetes cluster has a
  network policy that defaults to denying all ingress traffic unless explicitly allowed.
  A properly configured default deny ingress policy ensures that only traffic from
  trusted sources and services is permitted, minimizing the attack surface. Good configuration
  involves applying a network policy with 'ingress' rules that specify 'deny all'
  as the default action and then selectively allowing traffic to specific pods or
  services as required.
rationale: Without a default deny ingress policy, Kubernetes clusters are susceptible
  to unauthorized access and potential lateral movement by attackers. This misconfiguration
  can lead to exposure of sensitive services and data, making the cluster a target
  for network-based attacks such as data exfiltration or application layer attacks.
severity: medium
domain: network_security
subcategory: network_policy
scope: network.policy.default_deny_ingress_check
references:
- https://kubernetes.io/docs/concepts/services-networking/network-policies/#default-deny-all-ingress-traffic
- https://kubernetes.io/docs/tasks/administer-cluster/declare-network-policy/
- https://kubernetes.io/docs/concepts/services-networking/network-policies/
compliance:
- canada_pbmm_moderate_multi_cloud_CCCS_AC-17_0013
- canada_pbmm_moderate_multi_cloud_CCCS_CM-2_0042
- canada_pbmm_moderate_multi_cloud_CCCS_CM-7_0047
- canada_pbmm_moderate_multi_cloud_CCCS_SC-5_0131
- canada_pbmm_moderate_multi_cloud_CCCS_SC-7_0132
- fedramp_moderate_multi_cloud_AC-17_0034
- fedramp_moderate_multi_cloud_AC-17_1_0035
- fedramp_moderate_multi_cloud_AC-17_2_0036
- fedramp_moderate_multi_cloud_AC-17_3_0037
- fedramp_moderate_multi_cloud_AC-17_4_0038
- fedramp_moderate_multi_cloud_CM-2_0101
- fedramp_moderate_multi_cloud_CM-2_2_0102
- fedramp_moderate_multi_cloud_CM-2_3_0103
- fedramp_moderate_multi_cloud_CM-2_7_0104
- fedramp_moderate_multi_cloud_CM-7_0119
- fedramp_moderate_multi_cloud_CM-7_1_0120
- fedramp_moderate_multi_cloud_CM-7_2_0121
- fedramp_moderate_multi_cloud_CM-7_5_0122
- fedramp_moderate_multi_cloud_SC-5_0331
- fedramp_moderate_multi_cloud_SC-7_0332
- fedramp_moderate_multi_cloud_SC-7_3_0333
- fedramp_moderate_multi_cloud_SC-7_4_0334
- fedramp_moderate_multi_cloud_SC-7_5_0335
- fedramp_moderate_multi_cloud_SC-7_7_0336
- fedramp_moderate_multi_cloud_SC-7_8_0337
- fedramp_moderate_multi_cloud_SC-7_10_0338
- fedramp_moderate_multi_cloud_SC-7_12_0339
- fedramp_moderate_multi_cloud_SC-7_18_0340
- fedramp_moderate_multi_cloud_SC-7_20_0341
- fedramp_moderate_multi_cloud_SC-7_21_0342
- gdpr_multi_cloud_Article_25_Data_protection_by_design_and_by_defaul_0001
- gdpr_multi_cloud_Article_32_Security_of_processing_0003
- hipaa_multi_cloud_164_308_a_1_ii_b_0002
- hipaa_multi_cloud_164_308_a_5_ii_b_0012
- hipaa_multi_cloud_164_312_a_1_0022
- hipaa_multi_cloud_164_312_e_1_0030
- hipaa_multi_cloud_164_312_e_2_i_0031
- iso27001_2022_multi_cloud_A.12.6_0003
- iso27001_2022_multi_cloud_A.13.1_0004
- iso27001_2022_multi_cloud_A.5.19_0015
- iso27001_2022_multi_cloud_A.8.1_0064
- iso27001_2022_multi_cloud_A.8.10_0065
- iso27001_2022_multi_cloud_A.8.11_0066
- iso27001_2022_multi_cloud_A.8.12_0067
- iso27001_2022_multi_cloud_A.8.13_0068
- iso27001_2022_multi_cloud_A.8.14_0069
- iso27001_2022_multi_cloud_A.8.15_0070
- iso27001_2022_multi_cloud_A.8.17_0072
- iso27001_2022_multi_cloud_A.8.18_0073
- iso27001_2022_multi_cloud_A.8.19_0074
- iso27001_2022_multi_cloud_A.8.2_0075
- iso27001_2022_multi_cloud_A.8.20_0076
- iso27001_2022_multi_cloud_A.8.21_0077
- iso27001_2022_multi_cloud_A.8.27_0083
- iso27001_2022_multi_cloud_A.8.3_0085
- iso27001_2022_multi_cloud_A.8.30_0086
- iso27001_2022_multi_cloud_A.8.31_0087
- iso27001_2022_multi_cloud_A.8.32_0088
- iso27001_2022_multi_cloud_A.8.33_0089
- iso27001_2022_multi_cloud_A.8.34_0090
- iso27001_2022_multi_cloud_A.8.9_0096
- nist_800_171_r2_multi_cloud_3_12_4_3.12.4_Develop_document_and_periodically_0003
- nist_800_171_r2_multi_cloud_3_13_1_3.13.1_Monitor_control_and_protect_commu_0004
- nist_800_171_r2_multi_cloud_3_13_11_3.13.11_Employ_FIPS-validated_cryptograph_0005
- nist_800_171_r2_multi_cloud_3_13_16_3.13.16_Protect_the_confidentiality_of_CU_0007
- nist_800_171_r2_multi_cloud_3_13_2_3.13.2_Employ_architectural_designs_softw_0008
- nist_800_171_r2_multi_cloud_3_13_3_3.13.3_Separate_user_functionality_from_sy_0009
- nist_800_171_r2_multi_cloud_3_13_4_3.13.4_Prevent_unauthorized_and_unintended_0010
- nist_800_171_r2_multi_cloud_3_13_5_3.13.5_Implement_subnetworks_for_publicly_0011
- nist_800_171_r2_multi_cloud_3_13_6_3.13.6_Deny_network_communications_traffic_0012
- nist_800_171_r2_multi_cloud_3_13_8_3.13.8_Implement_cryptographic_mechanisms_0013
- nist_800_171_r2_multi_cloud_3_1_14_3.1.14_Route_remote_access_via_managed_acc_0023
- nist_800_171_r2_multi_cloud_3_1_2_3.1.2_Limit_system_access_to_the_types_of_t_0024
- nist_800_171_r2_multi_cloud_3_1_20_3.1.20_Verify_and_control_limit_connection_0025
- nist_800_171_r2_multi_cloud_3_1_3_3.1.3_Control_the_flow_of_CUI_in_accordance_0026
- nist_800_171_r2_multi_cloud_3_3_1_3.3.1_Create_and_retain_system_audit_logs_a_0031
- nist_800_171_r2_multi_cloud_3_4_2_3.4.2_Establish_and_enforce_security_config_0038
- nist_800_171_r2_multi_cloud_3_4_6_3.4.6_Employ_the_principle_of_least_functio_0039
- nist_800_171_r2_multi_cloud_3_4_7_3.4.7_Restrict_disable_or_prevent_the_use_0040
- nist_800_171_r2_multi_cloud_3_6_1_3.6.1_Establish_an_operational_incident-han_0049
- nist_800_53_rev5_multi_cloud_AC-17-b_0152
- nist_800_53_rev5_multi_cloud_CM-2-a_0366
- nist_800_53_rev5_multi_cloud_CM-7-b_0412
- nist_800_53_rev5_multi_cloud_SC-5-b_1192
- nist_800_53_rev5_multi_cloud_SC-7-a_1224
- nist_800_53_rev5_multi_cloud_SC-7-b_1225
- nist_800_53_rev5_multi_cloud_SC-7-c_1226
- pci_dss_v4_multi_cloud_1.1.1_0001
- pci_dss_v4_multi_cloud_1.1.2_0002
- pci_dss_v4_multi_cloud_1.2.1_0003
- pci_dss_v4_multi_cloud_1.2.3_0004
- pci_dss_v4_multi_cloud_1.2.5_0005
- pci_dss_v4_multi_cloud_1.2.6_0006
- pci_dss_v4_multi_cloud_1.2.7_0007
- pci_dss_v4_multi_cloud_1.2.8_0008
- pci_dss_v4_multi_cloud_1.3.1_0009
- pci_dss_v4_multi_cloud_1.3.2_0010
- pci_dss_v4_multi_cloud_1.3.3_0011
- pci_dss_v4_multi_cloud_2.2.2_0021
- pci_dss_v4_multi_cloud_2.2.3_0022
- pci_dss_v4_multi_cloud_2.2.6_0025
- pci_dss_v4_multi_cloud_2.2.7_0026
- pci_dss_v4_multi_cloud_7.2.1_0091
- pci_dss_v4_multi_cloud_7.2.2_0092
- pci_dss_v4_multi_cloud_7.2.3_0093
- pci_dss_v4_multi_cloud_7.2.5_0094
- pci_dss_v4_multi_cloud_7.2.5.1_0095
- pci_dss_v4_multi_cloud_8.3.9_0111
- pci_dss_v4_multi_cloud_8.3.11_0112
- pci_dss_v4_multi_cloud_9.2.2_0123
- pci_dss_v4_multi_cloud_9.2.4_0125
- pci_dss_v4_multi_cloud_9.3.2_0128
- pci_dss_v4_multi_cloud_9.4.1.1_0131
- pci_dss_v4_multi_cloud_9.4.2_0133
- pci_dss_v4_multi_cloud_11.1.1_0162
- pci_dss_v4_multi_cloud_11.1.2_0163
- pci_dss_v4_multi_cloud_11.2.1_0164
- pci_dss_v4_multi_cloud_11.2.2_0165
- pci_dss_v4_multi_cloud_11.3.1_0166
- pci_dss_v4_multi_cloud_11.3.2_0168
- pci_dss_v4_multi_cloud_11.3.2.1_0169
- pci_dss_v4_multi_cloud_11.4.3_0171
- pci_dss_v4_multi_cloud_12.1.2_0178
- pci_dss_v4_multi_cloud_12.1.3_0179
- pci_dss_v4_multi_cloud_12.1.4_0180
- pci_dss_v4_multi_cloud_12.3.1_0181
- pci_dss_v4_multi_cloud_12.3.3_0182
- pci_dss_v4_multi_cloud_12.3.4_0183
- pci_dss_v4_multi_cloud_12.5.1_0186
- pci_dss_v4_multi_cloud_12.5.3_0187
- pci_dss_v4_multi_cloud_12.6.1_0188
- pci_dss_v4_multi_cloud_12.6.2_0189
- pci_dss_v4_multi_cloud_12.6.3_0190
- pci_dss_v4_multi_cloud_12.6.3.1_0191
- pci_dss_v4_multi_cloud_12.7.1_0192
- pci_dss_v4_multi_cloud_12.8.1_0193
- pci_dss_v4_multi_cloud_12.8.2_0194
- pci_dss_v4_multi_cloud_12.8.3_0195
- pci_dss_v4_multi_cloud_12.8.4_0196
- pci_dss_v4_multi_cloud_12.8.5_0197
- pci_dss_v4_multi_cloud_12.10.3_0200
- pci_dss_v4_multi_cloud_12.10.4_0201
- pci_dss_v4_multi_cloud_12.10.4.1_0202
- pci_dss_v4_multi_cloud_12.10.5_0203
- pci_dss_v4_multi_cloud_12.10.6_0204
- pci_dss_v4_multi_cloud_12.10.7_0205
- rbi_bank_multi_cloud_14.1_0007
- rbi_bank_multi_cloud_4.3_0018
- rbi_nbfc_multi_cloud_2.8_0012
- rbi_nbfc_multi_cloud_5.4_0028
- soc2_multi_cloud_cc_3_1_0003
- soc2_multi_cloud_cc_3_2_0004
- soc2_multi_cloud_cc_5_2_0008
- soc2_multi_cloud_cc_6_1_0009
- soc2_multi_cloud_cc_6_6_0012
- soc2_multi_cloud_cc_6_7_0013
- soc2_multi_cloud_cc_6_8_0014
- cis_kubernetes_kubernetes_1.6.4_0173
