rule_id: k8s.network.networkpolicy.restrict_egress_ports_configured
service: network
resource: networkpolicy
requirement: Restrict Egress Ports Configured
title: Enforce Egress Port Restrictions in Network Policies
description: This rule verifies that Kubernetes network policies explicitly define
  restricted egress ports for each namespace. A correctly configured egress policy
  specifies allowed ports and protocols for outbound traffic, preventing unrestricted
  communication that could lead to data leakage or external attacks. Properly configured
  egress restrictions ensure that only necessary traffic is allowed, aligning with
  security best practices and reducing potential attack vectors. This validation helps
  maintain compliance with security frameworks and mitigates the risk of unauthorized
  data flow.
rationale: Improper egress port configurations in Kubernetes network policies can
  expose the cluster to data exfiltration and unauthorized communication with external
  networks. Attackers may exploit open egress ports to establish outbound connections,
  enabling data leaks or command-and-control activities. Restricting egress ports
  helps minimize these risks by controlling which ports are allowed for outbound traffic,
  thereby reducing the attack surface.
severity: medium
domain: network_security
subcategory: network_policy
scope: network.networkpolicy.restrict_egress_ports_configured
references:
- https://kubernetes.io/docs/concepts/services-networking/network-policies/#networkpolicy-resource
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/#restricting-network-access
- https://kubernetes.io/docs/concepts/services-networking/network-policies/#default-policies
compliance: []
