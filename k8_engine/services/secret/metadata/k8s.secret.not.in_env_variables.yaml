rule_id: k8s.secret.not.in_env_variables
service: secret
resource: not
requirement: In Env Variables
title: Avoid Storing Secrets in Environment Variables
description: This rule checks that Kubernetes secrets are not injected into containers
  via environment variables. Instead, it should validate that secrets are mounted
  as volumes or accessed through Kubernetes' native secret management capabilities.
  Properly managing secrets this way minimizes the exposure of sensitive data, reduces
  the attack surface, and aligns with security best practices like those outlined
  in the CIS Kubernetes Benchmark.
rationale: Storing secrets in environment variables can expose sensitive information
  if a container is compromised. Attackers who gain access to the environment variables
  of a container can obtain these secrets, potentially leading to unauthorized access
  to other services or resources.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: secret.not.in_env_variables
references:
- https://kubernetes.io/docs/concepts/configuration/secret/
- https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#configuring-environment-variables
- https://kubernetes.io/docs/tasks/inject-data-application/distribute-credentials-secure/
compliance:
- rbi_nbfc_multi_cloud_2.9_0013
- rbi_nbfc_multi_cloud_6.1_0029
- soc2_multi_cloud_cc_c_1_1_0022
