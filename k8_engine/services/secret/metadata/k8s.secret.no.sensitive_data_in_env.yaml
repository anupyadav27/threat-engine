rule_id: k8s.secret.no.sensitive_data_in_env
service: secret
resource: 'no'
requirement: Sensitive Data In Env
title: Prevent Sensitive Data Exposure in Environment Variables
description: This control checks that sensitive data, such as credentials or API keys,
  are not stored in environment variables within Kubernetes pods. Instead, it ensures
  that Kubernetes Secrets are used for managing sensitive information. Proper usage
  of Secrets reduces the risk of inadvertent exposure and provides a secure mechanism
  for accessing sensitive data. This is achieved by validating pod configurations
  to ensure that secrets are mounted as files or accessed through appropriate APIs,
  rather than being directly injected as environment variables, which can be exposed
  more easily.
rationale: Storing sensitive data in environment variables increases the risk of accidental
  exposure through logs, process listings, or unauthorized access. Misconfiguration
  can lead to data breaches where attackers exploit vulnerable components or gain
  unauthorized access to pods, exposing sensitive information.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: secret.no.sensitive_data_in_env
references:
- https://kubernetes.io/docs/concepts/configuration/secret/
- https://kubernetes.io/docs/tasks/inject-data-application/distribute-credentials-secure/
- https://kubernetes.io/docs/concepts/security/overview/
compliance:
- pci_dss_v4_multi_cloud_6.3.2_0080
