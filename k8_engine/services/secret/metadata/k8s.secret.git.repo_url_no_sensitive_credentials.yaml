rule_id: k8s.secret.git.repo_url_no_sensitive_credentials
service: secret
resource: git
requirement: Repo Url No Sensitive Credentials
title: Prevent Sensitive Credentials in Git Repository URLs
description: This control checks Kubernetes secrets for Git repository URLs to ensure
  they do not contain sensitive credentials. A secure configuration involves using
  SSH keys or OAuth tokens managed outside of the repository URL to authenticate access
  to Git repositories. This practice mitigates the risk of credential exposure, reduces
  the attack surface for unauthorized access, and aligns with best practices for secret
  management and regulatory compliance.
rationale: Including sensitive credentials like usernames, passwords, or tokens directly
  in Git repository URLs within Kubernetes secrets poses a significant security risk.
  Attackers who gain access to these URLs can easily access your repositories, potentially
  leading to code leaks, data breaches, or unauthorized code modifications. This vulnerability
  can be exploited through misconfigured access controls or by intercepting traffic,
  especially if not encrypted.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: secret.git.repo_url_no_sensitive_credentials
references:
- https://kubernetes.io/docs/concepts/configuration/secret/
- https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/
- https://kubernetes.io/docs/tasks/inject-data-application/distribute-credentials-secure/
compliance:
- pci_dss_v4_multi_cloud_6.3.2_0080
