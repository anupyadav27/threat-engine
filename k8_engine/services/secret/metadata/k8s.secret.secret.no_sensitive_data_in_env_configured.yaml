rule_id: k8s.secret.secret.no_sensitive_data_in_env_configured
service: secret
resource: secret
requirement: No Sensitive Data In Env Configured
title: Avoid Storing Sensitive Data in Environment Variables
description: This rule checks that sensitive data is not stored in environment variables
  within Kubernetes pods. Best practices recommend using Kubernetes Secrets to manage
  sensitive information securely. Environment variables should not contain sensitive
  information to prevent exposure through logs or debugging tools. A good configuration
  uses Secrets mounted as volumes or accessed through the Kubernetes API, ensuring
  sensitive data is encrypted at rest and transmitted securely. This approach mitigates
  the risk of unauthorized data exposure and enhances overall cluster security.
rationale: Storing sensitive data such as passwords or API keys in environment variables
  poses a significant security risk because environment variables can be exposed via
  logs, debugging processes, or by unauthorized access to the environment. Attack
  vectors include pod compromise, where attackers can access environment variables,
  potentially leading to unauthorized access to services and data breaches.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: secret.secret.no_sensitive_data_in_env_configured
references:
- https://kubernetes.io/docs/concepts/configuration/secret/
- https://kubernetes.io/docs/tasks/inject-data-application/distribute-credentials-secure/
- https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/
compliance: []
