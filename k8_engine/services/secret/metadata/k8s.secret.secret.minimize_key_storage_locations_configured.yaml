rule_id: k8s.secret.secret.minimize_key_storage_locations_configured
service: secret
resource: secret
requirement: Minimize Key Storage Locations Configured
title: Limit Secret Key Distribution Across Nodes
description: This control checks that Kubernetes secrets are configured to limit their
  storage locations to only the necessary nodes. A well-configured secret should be
  accessible only to the specific pods that require it, using mechanisms like projected
  volumes or environment variables. By restricting the distribution of secrets, clusters
  can prevent unauthorized access and reduce the risk of secrets being compromised
  due to node breaches. Proper configuration involves using tools like Secret Management
  solutions and ensuring secrets are not exposed in pod specs or logs.
rationale: Minimizing the distribution of secret keys across the cluster reduces the
  attack surface and mitigates the risk of secret exposure. If secret keys are stored
  in multiple locations, it increases the likelihood of unauthorized access through
  compromised nodes or misconfigured permissions, potentially leading to data breaches
  and privilege escalation.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: secret.secret.minimize_key_storage_locations_configured
references:
- https://kubernetes.io/docs/concepts/configuration/secret/
- https://kubernetes.io/docs/tasks/inject-data-application/distribute-credentials-secure/
- https://kubernetes.io/docs/concepts/security/overview/#protecting-cluster-components
compliance: []
