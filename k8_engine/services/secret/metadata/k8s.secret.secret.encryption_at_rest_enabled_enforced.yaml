rule_id: k8s.secret.secret.encryption_at_rest_enabled_enforced
service: secret
resource: secret
requirement: Encryption At Rest Enabled Enforced
title: Enforce Encryption at Rest for Kubernetes Secrets
description: This control checks that Kubernetes Secrets are stored encrypted at rest
  in etcd by verifying the encryption configuration in the kube-apiserver. A proper
  configuration involves setting up an encryption provider configuration file and
  specifying it in the kube-apiserver startup parameters. This ensures that sensitive
  data is protected from unauthorized access by encrypting it before storage, thus
  safeguarding against data leakage and complying with security best practices.
rationale: Without encryption at rest, secrets stored in etcd are vulnerable to unauthorized
  access or exfiltration. Attackers gaining access to the etcd datastore or a backup
  can potentially access sensitive information like passwords, tokens, and certificates,
  leading to privilege escalation and data breaches.
severity: high
domain: data_protection
subcategory: encryption
scope: secret.secret.encryption_at_rest_enabled_enforced
references:
- https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/
- https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/
- https://kubernetes.io/docs/concepts/configuration/secret/
compliance: []
