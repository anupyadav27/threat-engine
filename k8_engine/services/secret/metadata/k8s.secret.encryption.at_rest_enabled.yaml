rule_id: k8s.secret.encryption.at_rest_enabled
service: secret
resource: encryption
requirement: At Rest Enabled
title: Enable Encryption at Rest for Kubernetes Secrets
description: This rule checks that encryption at rest is enabled for Kubernetes secrets
  by verifying that the etcd database is configured with an encryption provider. A
  proper configuration involves setting up an appropriate encryption provider and
  key management system. Ensuring that secrets are encrypted at rest reduces the risk
  of data breaches by protecting sensitive information stored in the etcd database
  from being accessed in plaintext.
rationale: If Kubernetes secrets are not encrypted at rest, they are vulnerable to
  unauthorized access by anyone with file system access to the etcd database. This
  can lead to exposure of sensitive data, such as passwords and API keys, which could
  be exploited by attackers to gain unauthorized access to cluster resources.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: secret.encryption.at_rest_enabled
references:
- https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/#data-encryption-at-rest
- https://kubernetes.io/docs/concepts/configuration/secret/
compliance:
- canada_pbmm_moderate_multi_cloud_CCCS_CM-9_0049
- canada_pbmm_moderate_multi_cloud_CCCS_SC-12_0135
- canada_pbmm_moderate_multi_cloud_CCCS_SC-13_0136
- canada_pbmm_moderate_multi_cloud_CCCS_SC-28_0144
- fedramp_moderate_multi_cloud_CM-6_0116
- fedramp_moderate_multi_cloud_CM-6_1_0117
- fedramp_moderate_multi_cloud_CM-6_2_0118
- fedramp_moderate_multi_cloud_CP-9_0160
- fedramp_moderate_multi_cloud_CP-9_1_0161
- fedramp_moderate_multi_cloud_CP-9_2_0162
- fedramp_moderate_multi_cloud_CP-9_3_0163
- fedramp_moderate_multi_cloud_CP-9_5_0164
- fedramp_moderate_multi_cloud_CP-9_8_0165
- fedramp_moderate_multi_cloud_SC-12_0346
- fedramp_moderate_multi_cloud_SC-12_1_0347
- fedramp_moderate_multi_cloud_SC-13_0348
- fedramp_moderate_multi_cloud_SC-28_0357
- fedramp_moderate_multi_cloud_SC-28_1_0358
- gdpr_multi_cloud_Article_25_Data_protection_by_design_and_by_defaul_0001
- gdpr_multi_cloud_Article_32_Security_of_processing_0003
- hipaa_multi_cloud_164_308_a_1_ii_b_0002
- hipaa_multi_cloud_164_312_c_1_0027
- hipaa_multi_cloud_164_312_c_2_0028
- hipaa_multi_cloud_164_312_e_2_i_0031
- hipaa_multi_cloud_164_312_e_2_ii_0032
- iso27001_2022_multi_cloud_A.10.1_0001
- iso27001_2022_multi_cloud_A.8.24_0080
- iso27001_2022_multi_cloud_A.8.27_0083
- iso27001_2022_multi_cloud_A.8.3_0085
- iso27001_2022_multi_cloud_A.8.30_0086
- iso27001_2022_multi_cloud_A.8.31_0087
- iso27001_2022_multi_cloud_A.8.32_0088
- iso27001_2022_multi_cloud_A.8.33_0089
- iso27001_2022_multi_cloud_A.8.34_0090
- iso27001_2022_multi_cloud_A.8.9_0096
- nist_800_171_r2_multi_cloud_3_5_10_3.5.10_Store_and_transmit_only_cryptograph_0042
- nist_800_53_rev5_multi_cloud_CM-6-a_0397
- nist_800_53_rev5_multi_cloud_CP-9-d_0512
- nist_800_53_rev5_multi_cloud_IA-5-g_0578
- nist_800_53_rev5_multi_cloud_PM-11-b_0867
- nist_800_53_rev5_multi_cloud_SC-13-a_1248
- pci_dss_v4_multi_cloud_3.1.1_0032
- pci_dss_v4_multi_cloud_3.3.1.1_0034
- pci_dss_v4_multi_cloud_3.4.1_0039
- pci_dss_v4_multi_cloud_3.4.2_0040
- pci_dss_v4_multi_cloud_3.5.1.2_0042
- pci_dss_v4_multi_cloud_8.2.1_0101
- rbi_bank_multi_cloud_11.1_0004
- rbi_bank_multi_cloud_18.1_0012
- rbi_bank_multi_cloud_3.3_0016
- rbi_bank_multi_cloud_8.1_0024
- rbi_nbfc_multi_cloud_2.9_0013
- rbi_nbfc_multi_cloud_6.1_0029
- soc2_multi_cloud_cc_3_1_0003
- soc2_multi_cloud_cc_6_1_0009
- soc2_multi_cloud_cc_a_1_1_0021
- soc2_multi_cloud_cc_c_1_1_0022
