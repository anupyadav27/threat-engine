component: pod
component_type: workload
discovery:
- discovery_id: list_pod_resources
  calls:
  - action: list_pods
    fields:
    - path: name
      var: name
    - path: namespace
      var: namespace
    - path: labels
      var: labels
checks:
- check_id: k8s.pod.backup.annotation_present
  name: Annotation Present
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.backup.annotations_configured
  name: Annotations Configured
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.configuration.compliance_check
  name: Compliance Check
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.container.config_enforced
  name: Config Enforced
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.container.horizontal_autoscaler_enabled
  name: Horizontal Autoscaler Enabled
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.container.host_network_disabled
  name: Host Network Disabled
  severity: MEDIUM
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.policy_types
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.container.image_signing_verified_enforced
  name: Image Signing Verified Enforced
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.container.sbom_management_enabled
  name: Sbom Management Enabled
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.container.seccomp_profile_docker_default
  name: Seccomp Profile Docker Default
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.container.security_context_memory_protection_enabled
  name: Security Context Memory Protection Enabled
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.container.signed_images_required_enforced
  name: Signed Images Required Enforced
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.container.vulnerability_scanning_enabled_enforced
  name: Vulnerability Scanning Enabled Enforced
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.deployment.anomaly_detection_enabled
  name: Anomaly Detection Enabled
  severity: MEDIUM
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.disaster.recovery_plan_documented
  name: Recovery Plan Documented
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.disruption.budget_configured
  name: Budget Configured
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.horizontal.autoscaler_enabled
  name: Autoscaler Enabled
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.host.network_disabled
  name: Network Disabled
  severity: MEDIUM
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.policy_types
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.labeling.for_inventory_tracking
  name: For Inventory Tracking
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.labeling.standard
  name: Standard
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.labels.inventory_maintained
  name: Inventory Maintained
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.node.host_pid_disabled_enforced
  name: Host Pid Disabled Enforced
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.persistentvolume.backup_configured
  name: Backup Configured
  severity: MEDIUM
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.pod.annotation_standard_configured
  name: Annotation Standard Configured
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.pod.annotations_for_inventory_metadata_configured
  name: Annotations For Inventory Metadata Configured
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.pod.annotations_maintained
  name: Annotations Maintained
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.pod.disruption_budget_configured
  name: Disruption Budget Configured
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.pod.ebpf_monitoring_enabled
  name: Ebpf Monitoring Enabled
  severity: MEDIUM
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.pod.falco_enabled_enforced
  name: Falco Enabled Enforced
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.pod.inventory_labels_maintained
  name: Inventory Labels Maintained
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.pod.labeling_standard_configured
  name: Labeling Standard Configured
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.pod.patch_management_enabled
  name: Patch Management Enabled
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.pod.psa_enforced
  name: Psa Enforced
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.pod.resource_limits_configured
  name: Resource Limits Configured
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.pod.security_standard_review_scheduled
  name: Security Standard Review Scheduled
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.pod.termination_grace_period_configured
  name: Termination Grace Period Configured
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.resource.limits_set
  name: Limits Set
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.resource.requests_and_limits_set
  name: Requests And Limits Set
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.seccomp.profile_runtime_default_check
  name: Profile Runtime Default Check
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.security.admission_hostpid_restrictions
  name: Admission Hostpid Restrictions
  severity: MEDIUM
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.security.allow_privilege_escalation_restricted
  name: Allow Privilege Escalation Restricted
  severity: HIGH
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.security.capabilities_enforcement
  name: Capabilities Enforcement
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.security.host_network_policy_check
  name: Host Network Policy Check
  severity: MEDIUM
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.policy_types
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.security.patches_applied
  name: Patches Applied
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.security.policy_configuration_check
  name: Policy Configuration Check
  severity: MEDIUM
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.security.privileged_containers_check
  name: Privileged Containers Check
  severity: CRITICAL
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.containers[].securityContext.privileged
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.security.security_context_verification
  name: Security Context Verification
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.security.standard_restricted
  name: Standard Restricted
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.security.standard_review_scheduled
  name: Standard Review Scheduled
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.security.standard_vulnerability_checks
  name: Standard Vulnerability Checks
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.securitycontext.capabilities_restricted_enforced
  name: Capabilities Restricted Enforced
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.securitycontext.dangerous_capabilities_dropped_enforced
  name: Dangerous Capabilities Dropped Enforced
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.securitycontext.defined
  name: Defined
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.securitycontext.memory_protection_enabled
  name: Memory Protection Enabled
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.securitycontext.net_raw_capability_dropped_enforced
  name: Net Raw Capability Dropped Enforced
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.securitycontext.non_root
  name: Non Root
  severity: CRITICAL
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.securitycontext.privilege_escalation_disabled_enforced
  name: Privilege Escalation Disabled Enforced
  severity: HIGH
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.securitycontext.privileged_containers_prohibited_enforced
  name: Privileged Containers Prohibited Enforced
  severity: CRITICAL
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.containers[].securityContext.privileged
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.securitycontext.readonly_rootfs
  name: Readonly Rootfs
  severity: CRITICAL
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.securitycontext.seccomp_profile_enforced_enabled
  name: Seccomp Profile Enforced Enabled
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.securitycontext.verification
  name: Verification
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.service.account_automount_configured
  name: Account Automount Configured
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.serviceaccount.automount_check
  name: Automount Check
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.pod.termination.grace_period_set
  name: Grace Period Set
  severity: LOW
  for_each: list_pod_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
