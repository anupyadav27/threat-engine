rule_id: k8s.pod.securitycontext.capabilities_restricted_enforced
service: pod
resource: securitycontext
requirement: Capabilities Restricted Enforced
title: Enforce Minimal Capabilities in Pod SecurityContext
description: This rule checks that the security context of a Kubernetes Pod specifies
  only the minimal set of capabilities necessary for the application to function.
  By default, Linux capabilities extend privileges to programs, which can be exploited
  if not properly restricted. A secure configuration involves removing all capabilities
  not explicitly required by the application. This helps prevent privilege escalation
  and limits potential damage from compromised containers.
rationale: Allowing excessive capabilities in a Pod's security context can lead to
  privilege escalation, where an attacker might exploit unnecessary permissions to
  gain control over the node or cluster. Restricting capabilities reduces the attack
  surface and mitigates risks such as unauthorized access to system calls and sensitive
  kernel functionality.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: pod.securitycontext.capabilities_restricted_enforced
references:
- https://kubernetes.io/docs/tasks/configure-pod-container/security-context/
- https://kubernetes.io/docs/concepts/policy/pod-security-policy/#capabilities
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/#restricting-capabilities
compliance: []
