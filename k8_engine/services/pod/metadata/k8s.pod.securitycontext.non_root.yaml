rule_id: k8s.pod.securitycontext.non_root
service: pod
resource: securitycontext
requirement: Non Root
title: Enforce Non-Root User in Pod Security Context
description: This rule checks whether the 'runAsNonRoot' field is set to true in the
  pod's security context. The 'runAsNonRoot' setting ensures that containers are not
  started with root privileges, reducing the attack surface by limiting the permissions
  available to applications running inside the container. A well-configured pod security
  context can prevent privilege escalation attacks and conforms to best practices
  as outlined in the Kubernetes Pod Security Standards.
rationale: Running containers as root increases the risk of privilege escalation and
  lateral movement within the cluster. Attackers exploiting vulnerabilities in applications
  or container runtimes can gain root access, which could lead to full control over
  the node and potentially the entire Kubernetes cluster.
severity: critical
domain: infrastructure_security
subcategory: configuration_management
scope: pod.securitycontext.non_root
references:
- https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted
- https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-the-security-context-for-a-pod
- https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-the-security-context-for-a-container
compliance:
- iso27001_2022_multi_cloud_A.12.6_0003
- iso27001_2022_multi_cloud_A.8.7_0094
- pci_dss_v4_multi_cloud_2.2.3_0022
- soc2_multi_cloud_cc_6_8_0014
