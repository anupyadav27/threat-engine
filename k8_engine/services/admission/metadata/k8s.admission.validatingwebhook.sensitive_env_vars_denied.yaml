rule_id: k8s.admission.validatingwebhook.sensitive_env_vars_denied
service: admission
resource: validatingwebhook
requirement: Sensitive Env Vars Denied
title: Reject Sensitive Environment Variables in Admission Webhooks
description: This control ensures that Kubernetes ValidatingAdmissionWebhooks reject
  pods or resources that attempt to use predefined sensitive environment variables.
  By implementing this control, you prevent the inclusion of sensitive data such as
  passwords, API keys, or tokens in pod specifications. This validation step is crucial
  for maintaining the confidentiality of sensitive information and complying with
  security best practices. A properly configured webhook will deny any deployment
  that includes such variables, thereby reducing the risk of unauthorized data exposure.
rationale: Exposing sensitive data through environment variables can result in unauthorized
  access and data breaches. Attackers may exploit misconfigured webhooks to extract
  sensitive information, leading to potential privilege escalation or lateral movement
  within the cluster.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: admission.validatingwebhook.sensitive_env_vars_denied
references:
- https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/
- https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#validatingadmissionwebhook
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/
compliance: []
