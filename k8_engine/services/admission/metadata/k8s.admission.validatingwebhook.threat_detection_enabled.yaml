rule_id: k8s.admission.validatingwebhook.threat_detection_enabled
service: admission
resource: validatingwebhook
requirement: Threat Detection Enabled
title: Enable Threat Detection in Validating Webhooks
description: This control ensures that validating webhooks in Kubernetes are configured
  with threat detection capabilities. It checks that webhooks are set up to inspect
  API requests for anomalies or malicious patterns before they are processed by the
  API server. A proper configuration includes defining rules and policies that log
  and potentially block suspicious requests. This helps in maintaining audit trails,
  preventing unauthorized access, and enforcing compliance with security standards,
  such as the CIS Kubernetes Benchmark.
rationale: If threat detection is not enabled in validating webhooks, malicious or
  misconfigured requests could be admitted into the cluster, potentially leading to
  unauthorized access, privilege escalation, or data exfiltration. Threat detection
  helps identify and mitigate suspicious activities by analyzing requests before they
  are allowed to modify cluster state.
severity: medium
domain: logging_and_monitoring
subcategory: threat_detection
scope: admission.validatingwebhook.threat_detection_enabled
references:
- https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/
- https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/webhook/
- https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/
compliance: []
