rule_id: k8s.admission.deny.sensitive_env_variables
service: admission
resource: deny
requirement: Sensitive Env Variables
title: Restrict Use of Sensitive Environment Variables in Pods
description: This rule checks if Kubernetes admission controllers are configured to
  deny pod creation when sensitive environment variables are specified. A secure configuration
  ensures that sensitive information, such as API keys, database passwords, or private
  keys, are not inadvertently exposed in pod specifications. This minimizes the risk
  of data leakage and unauthorized access, enhancing the overall security posture
  of the Kubernetes environment by enforcing best practices for secret management.
rationale: Exposing sensitive information through environment variables in pods can
  lead to data breaches and unauthorized data access if exploited by attackers. Attack
  vectors include compromised containers accessing environment variables to extract
  credentials, tokens, or secrets that can be used to escalate privileges or access
  other systems.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: admission.deny.sensitive_env_variables
references:
- https://kubernetes.io/docs/concepts/configuration/secret/
- https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod-security-policies
- https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#podsecuritypolicy
compliance:
- pci_dss_v4_multi_cloud_6.3.2_0080
