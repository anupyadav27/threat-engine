component: admission
component_type: policy
discovery:
- discovery_id: list_admission_resources
  calls:
  - action: list_pods
    fields:
    - path: name
      var: name
    - path: namespace
      var: namespace
    - path: labels
      var: labels
checks:
- check_id: k8s.admission.control.hostipc_restriction
  name: Hostipc Restriction
  severity: MEDIUM
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.control.hostpath_volumes_restricted
  name: Hostpath Volumes Restricted
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.anomaly_detection_enabled
  name: Anomaly Detection Enabled
  severity: MEDIUM
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.antimalware_policies_enforced
  name: Antimalware Policies Enforced
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.antivirus_enabled
  name: Antivirus Enabled
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.change_control_enabled
  name: Change Control Enabled
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.change_management_enabled
  name: Change Management Enabled
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.changes_monitored
  name: Changes Monitored
  severity: MEDIUM
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.configuration_change_prevention
  name: Configuration Change Prevention
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.configuration_validated
  name: Configuration Validated
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.image_scan_on_admission
  name: Image Scan On Admission
  severity: MEDIUM
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.incident_reporting_enabled
  name: Incident Reporting Enabled
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.memory_protection_policies_enforced
  name: Memory Protection Policies Enforced
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.monitoring_enabled
  name: Monitoring Enabled
  severity: MEDIUM
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.networkpolicy_changes_logged
  name: Networkpolicy Changes Logged
  severity: MEDIUM
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.policy_types
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.policy_enforcement_enabled
  name: Policy Enforcement Enabled
  severity: MEDIUM
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.policy_violation_alerts_enabled
  name: Policy Violation Alerts Enabled
  severity: MEDIUM
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.privilege_escalation_prevention
  name: Privilege Escalation Prevention
  severity: HIGH
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.restrict_user_installed_software
  name: Restrict User Installed Software
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.security_alerts_enabled
  name: Security Alerts Enabled
  severity: MEDIUM
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.security_event_alerting
  name: Security Event Alerting
  severity: MEDIUM
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.security_policy_enabled
  name: Security Policy Enabled
  severity: MEDIUM
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.software_whitelist_enabled
  name: Software Whitelist Enabled
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.supplier_service_change_management
  name: Supplier Service Change Management
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.threat_detection_enabled
  name: Threat Detection Enabled
  severity: MEDIUM
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.threat_hunting_enabled
  name: Threat Hunting Enabled
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.controller.vulnerability_scanning_enabled
  name: Vulnerability Scanning Enabled
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.deny.sensitive_env_variables
  name: Sensitive Env Variables
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.mutatingwebhook.secure_webhooks_enforced_enabled
  name: Secure Webhooks Enforced Enabled
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.mutatingwebhook.webhook_tls_enforced
  name: Webhook Tls Enforced
  severity: HIGH
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.security.incident_alerting_enabled
  name: Incident Alerting Enabled
  severity: MEDIUM
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.threat.detection_webhook_configured
  name: Detection Webhook Configured
  severity: MEDIUM
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.validatingwebhook.builtin_controllers_enabled_enforced
  name: Builtin Controllers Enabled Enforced
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.validatingwebhook.constraints_configured_enabled
  name: Constraints Configured Enabled
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.validatingwebhook.control_hostpath_volumes_restricted
  name: Control Hostpath Volumes Restricted
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.validatingwebhook.controller_configuration_immutable
  name: Controller Configuration Immutable
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.validatingwebhook.controller_security_patches_enforced
  name: Controller Security Patches Enforced
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.validatingwebhook.pod_security_enforced
  name: Pod Security Enforced
  severity: MEDIUM
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.validatingwebhook.policy_testing_enabled
  name: Policy Testing Enabled
  severity: MEDIUM
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.validatingwebhook.security_alerting_enabled
  name: Security Alerting Enabled
  severity: MEDIUM
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.validatingwebhook.sensitive_env_vars_denied
  name: Sensitive Env Vars Denied
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.validatingwebhook.supplier_change_managed
  name: Supplier Change Managed
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.validatingwebhook.threat_detection_enabled
  name: Threat Detection Enabled
  severity: MEDIUM
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.validatingwebhook.user_software_restricted
  name: User Software Restricted
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.validatingwebhook.webhook_validation_enabled
  name: Webhook Validation Enabled
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.webhook.authentication_enabled
  name: Authentication Enabled
  severity: HIGH
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.webhook.configured
  name: Configured
  severity: LOW
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.webhook.policy_enforced
  name: Policy Enforced
  severity: MEDIUM
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.admission.webhook.security_policy_configured
  name: Security Policy Configured
  severity: MEDIUM
  for_each: list_admission_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
