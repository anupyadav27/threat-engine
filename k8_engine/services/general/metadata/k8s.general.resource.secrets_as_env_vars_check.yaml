rule_id: k8s.general.resource.secrets_as_env_vars_check
service: general
resource: resource
requirement: Secrets As Env Vars Check
title: Avoid Using Secrets as Environment Variables
description: This control checks that Kubernetes does not use environment variables
  to manage secrets. Instead, it recommends using Kubernetes Secrets mounted as volumes,
  which are specifically designed to store and manage sensitive data securely. This
  approach minimizes the risk of exposing secrets by reducing their surface area.
  Proper configuration ensures that secrets are only accessible to authorized pods
  and are not inadvertently exposed, helping maintain compliance with security standards
  such as the CIS Kubernetes Benchmark.
rationale: Using environment variables to pass secrets in Kubernetes can lead to accidental
  exposure of sensitive information. Environment variables are easily accessible by
  anyone with access to the container, providing a potential attack vector for privilege
  escalation or data exfiltration. This misconfiguration can lead to secrets being
  inadvertently logged or exposed in debugging sessions, increasing the risk of unauthorized
  access.
severity: high
domain: data_protection
subcategory: secrets_management
scope: general.resource.secrets_as_env_vars_check
references:
- https://kubernetes.io/docs/concepts/configuration/secret/#use-case-as-container-environment-variables
- https://kubernetes.io/docs/concepts/configuration/secret/#using-secrets-as-files-from-a-pod
- https://kubernetes.io/docs/concepts/security/overview/#protecting-data
compliance:
- cis_kubernetes_kubernetes_5.4.1_0128
