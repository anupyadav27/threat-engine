rule_id: k8s.ingress.controller.waf_enabled
service: ingress
resource: controller
requirement: Waf Enabled
title: Enable Web Application Firewall in Ingress Controller
description: This control checks whether a Web Application Firewall (WAF) is enabled
  and properly configured in the Kubernetes Ingress Controller. A correctly configured
  WAF inspects HTTP requests against a set of predefined security rules to detect
  and block harmful web traffic. A robust WAF configuration includes custom rules
  tailored to the application's specific needs, logging and monitoring of suspicious
  activities, and regular updates to security rules. Proper WAF configuration helps
  to mitigate risks from common web vulnerabilities, ensuring compliance with security
  standards such as the CIS Kubernetes Benchmark and PCI DSS requirements.
rationale: A misconfigured or absent Web Application Firewall (WAF) in the Kubernetes
  Ingress Controller exposes your applications to various web-based attacks such as
  SQL injection, cross-site scripting (XSS), and remote code execution. Attackers
  can exploit these vulnerabilities to gain unauthorized access, steal sensitive information,
  or disrupt services. By ensuring that a WAF is enabled and correctly configured,
  you add an essential layer of security that scrutinizes incoming HTTP requests and
  blocks malicious traffic, thereby reducing the attack surface.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: ingress.controller.waf_enabled
references:
- https://kubernetes.io/docs/concepts/services-networking/ingress/#what-is-ingress
- https://kubernetes.io/docs/concepts/security/overview/
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/
compliance:
- pci_dss_v4_multi_cloud_1.1.1_0001
- pci_dss_v4_multi_cloud_1.1.2_0002
- pci_dss_v4_multi_cloud_8.3.9_0111
- pci_dss_v4_multi_cloud_8.3.11_0112
- pci_dss_v4_multi_cloud_11.1.1_0162
- pci_dss_v4_multi_cloud_11.1.2_0163
- pci_dss_v4_multi_cloud_11.2.1_0164
- pci_dss_v4_multi_cloud_11.2.2_0165
