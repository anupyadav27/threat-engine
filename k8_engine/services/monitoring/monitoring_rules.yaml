component: monitoring
component_type: workload
discovery:
- discovery_id: list_monitoring_resources
  calls:
  - action: list_pods
    fields:
    - path: name
      var: name
    - path: namespace
      var: namespace
    - path: labels
      var: labels
checks:
- check_id: k8s.monitoring.alerts.configured
  name: Configured
  severity: LOW
  for_each: list_monitoring_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.monitoring.daemonset.centralized_logging_enabled
  name: Centralized Logging Enabled
  severity: MEDIUM
  for_each: list_monitoring_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.monitoring.deployment.anomaly_detection_enabled
  name: Anomaly Detection Enabled
  severity: MEDIUM
  for_each: list_monitoring_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.monitoring.deployment.automated_containment_enabled
  name: Automated Containment Enabled
  severity: LOW
  for_each: list_monitoring_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.monitoring.deployment.forensic_data_collection_enabled
  name: Forensic Data Collection Enabled
  severity: LOW
  for_each: list_monitoring_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.monitoring.deployment.incident_forensics_enabled
  name: Incident Forensics Enabled
  severity: LOW
  for_each: list_monitoring_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.monitoring.deployment.playbooks_automated_enabled
  name: Playbooks Automated Enabled
  severity: LOW
  for_each: list_monitoring_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.monitoring.deployment.proactive_hunting_enabled
  name: Proactive Hunting Enabled
  severity: LOW
  for_each: list_monitoring_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.monitoring.persistentvolume.retention_policies_enforced_enabled
  name: Retention Policies Enforced Enabled
  severity: LOW
  for_each: list_monitoring_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.monitoring.pod.alerting_system_configured
  name: Alerting System Configured
  severity: MEDIUM
  for_each: list_monitoring_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.monitoring.prometheus.alerts_configured
  name: Alerts Configured
  severity: MEDIUM
  for_each: list_monitoring_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.monitoring.server.audit_policy_comprehensive_enforced
  name: Audit Policy Comprehensive Enforced
  severity: HIGH
  for_each: list_monitoring_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.monitoring.server.automated_compliance_dashboard_enabled
  name: Automated Compliance Dashboard Enabled
  severity: LOW
  for_each: list_monitoring_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.monitoring.server.behavioral_analysis_enabled
  name: Behavioral Analysis Enabled
  severity: LOW
  for_each: list_monitoring_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.monitoring.server.compliance_dashboard_automated
  name: Compliance Dashboard Automated
  severity: LOW
  for_each: list_monitoring_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.monitoring.server.correlation_enabled
  name: Correlation Enabled
  severity: LOW
  for_each: list_monitoring_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.monitoring.server.security_alerts_configured_enforced
  name: Security Alerts Configured Enforced
  severity: MEDIUM
  for_each: list_monitoring_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.name
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
