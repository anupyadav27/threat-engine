rule_id: k8s.service.type.loadbalancer_restricted
service: service
resource: type
requirement: Loadbalancer Restricted
title: Restrict External LoadBalancer Usage in Services
description: This rule checks that Kubernetes services using the LoadBalancer type
  are appropriately configured to limit exposure to external networks. A proper configuration
  includes setting up network policies, using internal LoadBalancers where possible,
  and ensuring that only essential services have LoadBalancer access. This reduces
  the risk of inadvertent exposure and aligns with security best practices to prevent
  unauthorized access.
rationale: Improper configuration of LoadBalancer services can expose internal resources
  to the public internet, increasing the risk of unauthorized access and potential
  attacks such as DDoS or data exfiltration. Limiting LoadBalancer usage to only necessary
  services helps reduce the attack surface and protects sensitive data.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: service.type.loadbalancer_restricted
references:
- https://kubernetes.io/docs/concepts/services-networking/service/#loadbalancer
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/
- https://kubernetes.io/docs/concepts/security/overview/
compliance:
- canada_pbmm_moderate_multi_cloud_CCCS_AC-17_0013
- canada_pbmm_moderate_multi_cloud_CCCS_SC-7_0132
- fedramp_moderate_multi_cloud_AC-17_0034
- fedramp_moderate_multi_cloud_AC-17_1_0035
- fedramp_moderate_multi_cloud_AC-17_2_0036
- fedramp_moderate_multi_cloud_AC-17_3_0037
- fedramp_moderate_multi_cloud_AC-17_4_0038
- fedramp_moderate_multi_cloud_SC-7_0332
- fedramp_moderate_multi_cloud_SC-7_3_0333
- fedramp_moderate_multi_cloud_SC-7_4_0334
- fedramp_moderate_multi_cloud_SC-7_5_0335
- fedramp_moderate_multi_cloud_SC-7_7_0336
- fedramp_moderate_multi_cloud_SC-7_8_0337
- fedramp_moderate_multi_cloud_SC-7_10_0338
- fedramp_moderate_multi_cloud_SC-7_12_0339
- fedramp_moderate_multi_cloud_SC-7_18_0340
- fedramp_moderate_multi_cloud_SC-7_20_0341
- fedramp_moderate_multi_cloud_SC-7_21_0342
- iso27001_2022_multi_cloud_A.8.2_0075
- iso27001_2022_multi_cloud_A.8.20_0076
- iso27001_2022_multi_cloud_A.8.21_0077
- nist_800_171_r2_multi_cloud_3_13_1_3.13.1_Monitor_control_and_protect_commu_0004
- nist_800_171_r2_multi_cloud_3_13_11_3.13.11_Employ_FIPS-validated_cryptograph_0005
- nist_800_171_r2_multi_cloud_3_13_16_3.13.16_Protect_the_confidentiality_of_CU_0007
- nist_800_171_r2_multi_cloud_3_13_2_3.13.2_Employ_architectural_designs_softw_0008
- nist_800_171_r2_multi_cloud_3_13_3_3.13.3_Separate_user_functionality_from_sy_0009
- nist_800_171_r2_multi_cloud_3_13_4_3.13.4_Prevent_unauthorized_and_unintended_0010
- nist_800_171_r2_multi_cloud_3_13_5_3.13.5_Implement_subnetworks_for_publicly_0011
- nist_800_171_r2_multi_cloud_3_13_6_3.13.6_Deny_network_communications_traffic_0012
- nist_800_171_r2_multi_cloud_3_13_8_3.13.8_Implement_cryptographic_mechanisms_0013
- nist_800_171_r2_multi_cloud_3_1_14_3.1.14_Route_remote_access_via_managed_acc_0023
- nist_800_171_r2_multi_cloud_3_1_3_3.1.3_Control_the_flow_of_CUI_in_accordance_0026
- nist_800_171_r2_multi_cloud_3_3_1_3.3.1_Create_and_retain_system_audit_logs_a_0031
- nist_800_53_rev5_multi_cloud_AC-17-b_0152
- nist_800_53_rev5_multi_cloud_SC-7-a_1224
- nist_800_53_rev5_multi_cloud_SC-7-b_1225
- nist_800_53_rev5_multi_cloud_SC-7-c_1226
- pci_dss_v4_multi_cloud_1.1.1_0001
- pci_dss_v4_multi_cloud_1.1.2_0002
- pci_dss_v4_multi_cloud_1.2.3_0004
- pci_dss_v4_multi_cloud_1.2.6_0006
- pci_dss_v4_multi_cloud_1.3.2_0010
- pci_dss_v4_multi_cloud_1.3.3_0011
- pci_dss_v4_multi_cloud_2.2.3_0022
- pci_dss_v4_multi_cloud_7.2.1_0091
- pci_dss_v4_multi_cloud_7.2.3_0093
- pci_dss_v4_multi_cloud_7.2.5_0094
- pci_dss_v4_multi_cloud_7.2.5.1_0095
- pci_dss_v4_multi_cloud_8.3.9_0111
- pci_dss_v4_multi_cloud_8.3.11_0112
- pci_dss_v4_multi_cloud_9.2.2_0123
- pci_dss_v4_multi_cloud_9.4.2_0133
- pci_dss_v4_multi_cloud_11.1.1_0162
- pci_dss_v4_multi_cloud_11.1.2_0163
- pci_dss_v4_multi_cloud_11.2.1_0164
- pci_dss_v4_multi_cloud_11.2.2_0165
- pci_dss_v4_multi_cloud_11.3.2_0168
- pci_dss_v4_multi_cloud_11.3.2.1_0169
- pci_dss_v4_multi_cloud_12.3.1_0181
- pci_dss_v4_multi_cloud_12.3.3_0182
- pci_dss_v4_multi_cloud_12.3.4_0183
- pci_dss_v4_multi_cloud_12.6.1_0188
- pci_dss_v4_multi_cloud_12.6.2_0189
- pci_dss_v4_multi_cloud_12.6.3_0190
- pci_dss_v4_multi_cloud_12.6.3.1_0191
- soc2_multi_cloud_cc_6_1_0009
- soc2_multi_cloud_cc_6_6_0012
