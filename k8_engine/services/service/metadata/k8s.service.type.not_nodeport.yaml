rule_id: k8s.service.type.not_nodeport
service: service
resource: type
requirement: Not Nodeport
title: Restrict Use of NodePort Services
description: This control checks that Kubernetes services are not configured with
  the NodePort type. A NodePort service exposes a service on a static port on each
  node's IP, which can lead to inadvertent exposure of services to the external network.
  Ensuring services are not of type NodePort reduces the attack surface by limiting
  external access. Instead, use LoadBalancer or ClusterIP service types to manage
  external access through controlled ingress points.
rationale: Using NodePort services can expose internal applications to the internet,
  making them susceptible to unauthorized access and potential attacks such as DDoS
  or port scanning. NodePort services open a high-numbered port on every node in the
  cluster, creating multiple entry points for attackers if not properly secured.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: service.type.not_nodeport
references:
- https://kubernetes.io/docs/concepts/services-networking/service/#nodeport
- https://kubernetes.io/docs/concepts/security/overview/
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/
compliance:
- iso27001_2022_multi_cloud_A.13.1_0004
- iso27001_2022_multi_cloud_A.8.1_0064
- iso27001_2022_multi_cloud_A.8.10_0065
- iso27001_2022_multi_cloud_A.8.11_0066
- iso27001_2022_multi_cloud_A.8.12_0067
- iso27001_2022_multi_cloud_A.8.13_0068
- iso27001_2022_multi_cloud_A.8.14_0069
- iso27001_2022_multi_cloud_A.8.15_0070
- iso27001_2022_multi_cloud_A.8.17_0072
- iso27001_2022_multi_cloud_A.8.18_0073
- iso27001_2022_multi_cloud_A.8.19_0074
- nist_800_171_r2_multi_cloud_3_4_7_3.4.7_Restrict_disable_or_prevent_the_use_0040
- pci_dss_v4_multi_cloud_1.2.1_0003
- pci_dss_v4_multi_cloud_1.2.5_0005
- pci_dss_v4_multi_cloud_1.2.7_0007
- pci_dss_v4_multi_cloud_1.2.8_0008
- pci_dss_v4_multi_cloud_1.3.1_0009
- pci_dss_v4_multi_cloud_2.2.2_0021
- pci_dss_v4_multi_cloud_2.2.6_0025
- pci_dss_v4_multi_cloud_2.2.7_0026
- pci_dss_v4_multi_cloud_7.2.2_0092
- pci_dss_v4_multi_cloud_9.2.4_0125
- pci_dss_v4_multi_cloud_9.3.2_0128
- pci_dss_v4_multi_cloud_9.4.1.1_0131
- pci_dss_v4_multi_cloud_11.3.1_0166
- pci_dss_v4_multi_cloud_12.1.2_0178
- pci_dss_v4_multi_cloud_12.1.3_0179
- pci_dss_v4_multi_cloud_12.1.4_0180
- pci_dss_v4_multi_cloud_12.5.1_0186
- pci_dss_v4_multi_cloud_12.5.3_0187
- pci_dss_v4_multi_cloud_12.7.1_0192
- pci_dss_v4_multi_cloud_12.8.1_0193
- pci_dss_v4_multi_cloud_12.8.2_0194
- pci_dss_v4_multi_cloud_12.8.3_0195
- pci_dss_v4_multi_cloud_12.8.4_0196
- pci_dss_v4_multi_cloud_12.8.5_0197
- pci_dss_v4_multi_cloud_12.10.3_0200
- pci_dss_v4_multi_cloud_12.10.4_0201
- pci_dss_v4_multi_cloud_12.10.4.1_0202
- pci_dss_v4_multi_cloud_12.10.5_0203
- pci_dss_v4_multi_cloud_12.10.6_0204
- pci_dss_v4_multi_cloud_12.10.7_0205
- rbi_bank_multi_cloud_8.2_0025
