rule_id: k8s.federation.server.insecure_allow_any_token_disabled
service: federation
resource: server
requirement: Insecure Allow Any Token Disabled
title: Disable Insecure Token Authentication in Federation Server
description: This rule verifies that the 'insecure-allow-any-token' flag is disabled
  on the Kubernetes federation server. A securely configured federation server should
  not accept any token without proper verification. Disabling this setting ensures
  that only valid and authorized tokens can interact with the API server, thereby
  strengthening the cluster's authentication mechanism. This configuration protects
  against unauthorized access and aligns with security best practices as outlined
  in the CIS Kubernetes Benchmark.
rationale: Allowing any token to authenticate against the Kubernetes federation server
  poses a significant security risk. It could enable unauthorized entities to gain
  access to the cluster, potentially leading to data breaches, escalation of privileges,
  and disruption of services. Attackers could exploit this misconfiguration to impersonate
  legitimate users and execute arbitrary commands or exfiltrate sensitive information.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: federation.server.insecure_allow_any_token_disabled
references:
- https://kubernetes.io/docs/reference/access-authn-authz/authentication/
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/
- https://kubernetes.io/docs/concepts/cluster-administration/federation/
compliance:
- cis_kubernetes_kubernetes_3.1.3_0071
