rule_id: k8s.rbac.serviceaccount.automount_disabled_enabled
service: rbac
resource: serviceaccount
requirement: Automount Disabled Enabled
title: Disable Automounting of ServiceAccount Tokens
description: This rule checks that automountServiceAccountToken is set to false in
  the ServiceAccount configuration. This prevents the automatic inclusion of a ServiceAccount
  token in the pod's environment, reducing the risk of token misuse. A properly configured
  setting ensures that only pods explicitly requiring API access receive a token,
  minimizing attack vectors and adhering to the principle of least privilege.
rationale: Automounting ServiceAccount tokens by default can lead to unintended access
  where pods automatically receive a token that grants them permissions they should
  not have. If an attacker exploits a vulnerability within the pod, they could use
  this token to access the Kubernetes API server and potentially escalate privileges
  or access sensitive data.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: rbac.serviceaccount.automount_disabled_enabled
references:
- https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#service-account-token-volume-projection
- https://kubernetes.io/docs/reference/access-authn-authz/service-accounts-admin/#service-account-automounting
- https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-the-security-context-for-a-pod
compliance: []
