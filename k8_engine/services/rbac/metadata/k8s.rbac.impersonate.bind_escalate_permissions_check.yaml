rule_id: k8s.rbac.impersonate.bind_escalate_permissions_check
service: rbac
resource: impersonate
requirement: Bind Escalate Permissions Check
title: Prevent Unauthorized Role Escalation via Impersonation in RBAC
description: This control checks that Kubernetes Role-Based Access Control (RBAC)
  configurations do not allow users to bind or escalate their permissions through
  impersonation without proper authorization. A secure setup should ensure that only
  trusted entities have the ability to impersonate other users or service accounts,
  thereby preventing unauthorized privilege escalation. This is achieved by auditing
  RBAC rules to confirm that 'impersonate' verbs are not granted to users who do not
  need them, and ensuring that all such permissions are carefully reviewed and justified.
rationale: If impersonation permissions are not properly restricted, a malicious user
  could escalate their privileges by impersonating a higher-privileged user or service
  account. This could lead to unauthorized access to sensitive resources, data breaches,
  or system disruptions. By ensuring that impersonation bindings are secure, we mitigate
  the risk of privilege escalation attacks.
severity: high
domain: identity_and_access_management
subcategory: authorization
scope: rbac.impersonate.bind_escalate_permissions_check
references:
- https://kubernetes.io/docs/reference/access-authn-authz/rbac/#role-binding-and-cluster-role-binding
- https://kubernetes.io/docs/reference/access-authn-authz/authentication/#user-impersonation
- https://kubernetes.io/docs/reference/access-authn-authz/rbac/#referring-to-subjects
compliance:
- cis_kubernetes_kubernetes_5.1.8_0107
