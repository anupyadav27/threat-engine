rule_id: k8s.rbac.nodes.proxy_access_check
service: rbac
resource: nodes
requirement: Proxy Access Check
title: Restrict Unauthorized Node Proxy Access via RBAC
description: This rule verifies that Role-Based Access Control (RBAC) policies are
  correctly configured to restrict proxy access to Kubernetes nodes. It ensures that
  only authorized users and service accounts can use the node proxy feature, which
  is crucial for accessing the Kubernetes API through nodes. Proper configuration
  includes assigning roles with specific permissions to trusted entities, thereby
  minimizing the attack surface and maintaining cluster integrity.
rationale: Misconfigured proxy access on nodes can lead to unauthorized users gaining
  access to sensitive cluster information and operations, such as viewing pod logs
  or executing commands. This can be exploited by attackers to pivot within the cluster
  or exfiltrate data, leading to potential breaches and compliance violations.
severity: high
domain: identity_and_access_management
subcategory: access_control
scope: rbac.nodes.proxy_access_check
references:
- https://kubernetes.io/docs/reference/access-authn-authz/rbac/
- https://kubernetes.io/docs/concepts/security/overview/#security-checklist
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/#restrict-node-access
compliance:
- cis_kubernetes_kubernetes_5.1.10_0109
