rule_id: k8s.rbac.serviceaccount.inactive_cleanup
service: rbac
resource: serviceaccount
requirement: Inactive Cleanup
title: Cleanup Unused Service Accounts to Prevent Unauthorized Access
description: This rule checks for service accounts in the Kubernetes cluster that
  have not been used for a specified period and flags them for cleanup. A good configuration
  involves regularly auditing service accounts and either disabling or deleting those
  that are no longer necessary. This practice helps in maintaining a minimal set of
  permissions aligned with the principle of least privilege and limits exposure to
  potential security threats.
rationale: Inactive service accounts in Kubernetes can be exploited by attackers to
  gain unauthorized access to cluster resources. These accounts may have permissions
  that can be misused if not properly managed. Ensuring inactive accounts are cleaned
  up reduces the attack surface and mitigates potential privilege escalation and lateral
  movement within the cluster.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: rbac.serviceaccount.inactive_cleanup
references:
- https://kubernetes.io/docs/reference/access-authn-authz/rbac/
- https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/
- https://kubernetes.io/docs/concepts/security/overview/#service-accounts
compliance:
- canada_pbmm_moderate_multi_cloud_CCCS_AC-2_0002
- canada_pbmm_moderate_multi_cloud_CCCS_AC-20_0016
- canada_pbmm_moderate_multi_cloud_CCCS_AC-21_0017
- canada_pbmm_moderate_multi_cloud_CCCS_AC-22_0018
