component: rbac
component_type: workload
discovery:
- discovery_id: list_rbac_resources
  calls:
  - action: list_cluster_roles
    fields:
    - path: name
      var: name
    - path: namespace
      var: namespace
    - path: labels
      var: labels
checks:
- check_id: k8s.rbac.access.review_process
  name: Review Process
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.activity.monitoring_configured
  name: Monitoring Configured
  severity: MEDIUM
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.change.control_role_defined
  name: Control Role Defined
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.change.management_policy_configured
  name: Management Policy Configured
  severity: MEDIUM
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.change.management_roles_defined
  name: Management Roles Defined
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.cluster.admin_role_access_review
  name: Admin Role Access Review
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.cluster.admin_role_usage_check
  name: Admin Role Usage Check
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.clusterrolebinding.admin_bindings_audited_enforced
  name: Admin Bindings Audited Enforced
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.configuration.change_audit_enabled
  name: Change Audit Enabled
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.configuration.change_monitoring
  name: Change Monitoring
  severity: MEDIUM
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.csr.approval_access_control_check
  name: Approval Access Control Check
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.database.access_restricted
  name: Access Restricted
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.default.service_account_audit
  name: Service Account Audit
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.impersonate.bind_escalate_permissions_check
  name: Bind Escalate Permissions Check
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.inactive.service_account_disabled
  name: Service Account Disabled
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.inactive.user_cleanup
  name: User Cleanup
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.incident.response_team_access_configured
  name: Response Team Access Configured
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.least.privilege_enforcement
  name: Privilege Enforcement
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.least.privilege_for_clearinghouse
  name: Privilege For Clearinghouse
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.log.access_restricted
  name: Access Restricted
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.minimal.privileges_assigned
  name: Privileges Assigned
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.no.anonymous_access
  name: Anonymous Access
  severity: CRITICAL
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.no.cluster_admin_binding
  name: Cluster Admin Binding
  severity: CRITICAL
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.no.root_access_key
  name: Root Access Key
  severity: CRITICAL
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.no.shared_service_accounts
  name: Shared Service Accounts
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.no.single_user_full_control
  name: Single User Full Control
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.nodes.proxy_access_check
  name: Proxy Access Check
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.oidc.authentication_configured
  name: Authentication Configured
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.persistentvolume.creation_access_check
  name: Creation Access Check
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.pod.creation_access_check
  name: Creation Access Check
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.policies.documented
  name: Documented
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.role.break_glass_controls_enabled
  name: Break Glass Controls Enabled
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.role.change_audit_enabled
  name: Change Audit Enabled
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.role.least_privilege_enforced
  name: Least Privilege Enforced
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.role.review_scheduled
  name: Review Scheduled
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.role.separation_of_duties_enforced
  name: Separation Of Duties Enforced
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.role.wildcard_permissions_prohibited_enforced
  name: Wildcard Permissions Prohibited Enforced
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules[].resources
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.rolebinding.admission_controller_enforced
  name: Admission Controller Enforced
  severity: MEDIUM
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.rolebinding.audit_enabled
  name: Audit Enabled
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.rolebinding.least_privilege
  name: Least Privilege
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.rolebinding.rbac_enabled_enforced
  name: Rbac Enabled Enforced
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.rolebinding.review
  name: Review
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.rolebinding.scope_limited
  name: Scope Limited
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.rolebinding.separation
  name: Separation
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.rolebinding.to_specific_namespaces
  name: To Specific Namespaces
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.roles.no_wildcard_in_rules
  name: No Wildcard In Rules
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules[].resources
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.secret.auto_rotation_configured
  name: Auto Rotation Configured
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.secrets.access_review
  name: Access Review
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.segregation.of_duties_enforced
  name: Of Duties Enforced
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.separation.of_duties_enforced
  name: Of Duties Enforced
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.automount_disabled_enabled
  name: Automount Disabled Enabled
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.break_glass_access_controlled_enforced
  name: Break Glass Access Controlled Enforced
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.cert_auto_rotation_enabled
  name: Cert Auto Rotation Enabled
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.certificate_auth_configured_enforced
  name: Certificate Auth Configured Enforced
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.emergency_access_audit_enforced
  name: Emergency Access Audit Enforced
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.inactive_cleanup
  name: Inactive Cleanup
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.least_privilege
  name: Least Privilege
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.management_review
  name: Management Review
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.mfa_enforced
  name: Mfa Enforced
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.privileges_restricted
  name: Privileges Restricted
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.restricted_roles
  name: Restricted Roles
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.review_enabled
  name: Review Enabled
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.scope_limited
  name: Scope Limited
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.serviceaccount_token_automount_disabled
  name: Serviceaccount Token Automount Disabled
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.token_auth_secure_enforced
  name: Token Auth Secure Enforced
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.token_automount_disabled
  name: Token Automount Disabled
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: not_equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.token_creation_access_check
  name: Token Creation Access Check
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.token_expiration_configured
  name: Token Expiration Configured
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.unique_identifiers
  name: Unique Identifiers
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.unique_serviceaccount_enforced
  name: Unique Serviceaccount Enforced
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.usage_audited
  name: Usage Audited
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.serviceaccount.usage_review
  name: Usage Review
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.system.masters_group_usage_check
  name: Masters Group Usage Check
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.unique.service_account_per_user
  name: Service Account Per User
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.unused.role_cleanup
  name: Role Cleanup
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.unused.service_account_cleanup
  name: Service Account Cleanup
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.user.access_review_policy_implemented
  name: Access Review Policy Implemented
  severity: MEDIUM
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.user.access_review_scheduled
  name: Access Review Scheduled
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.user.action_audit_enabled
  name: Action Audit Enabled
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.user.identity_audit_enabled
  name: Identity Audit Enabled
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: equals
      expected: true
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.user.registration_authorization_review
  name: Registration Authorization Review
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.user.unique_identifiers
  name: Unique Identifiers
  severity: LOW
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
- check_id: k8s.rbac.webhook.configuration_access_review
  name: Configuration Access Review
  severity: HIGH
  for_each: list_rbac_resources
  param: item
  calls:
  - action: identity
    params: {}
    fields:
    - path: item.rules
      operator: exists
      expected: null
  logic: AND
  errors_as_fail: []
