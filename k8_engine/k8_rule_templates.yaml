# Kubernetes Rule Template (for k8_engine)
# Replace <placeholders> accordingly.

component: <component>              # e.g., core, rbac, apiserver
component_type: <workload|controlplane|rbac>

# Discovery
discovery:
  - discovery_id: <list_items>
    calls:
      - action: <list_action>        # e.g., list_pods, list_deployments, list_roles
        fields:
          - path: <field.path>       # e.g., name, namespace, containers, spec.template.spec.hostNetwork
            var: <var_name>
          # Add more fields as needed

# Checks
checks:
  - check_id: <unique_check_id>
    name: <human_readable_name>
    severity: <LOW|MEDIUM|HIGH|CRITICAL>
    for_each: <list_items>
    param: item
    calls:
      - action: identity
        params: {}
        fields:
          - path: item.<var_name_or_path>
            operator: <equals|not_equals|contains|not_contains|exists>
            expected: <value>
    logic: <AND|OR>
    errors_as_fail: [] 