component: scheduler
component_type: control_plane

discovery:
  - discovery_id: get_scheduler_config
    calls:
      - action: get_component_config
        params:
          component: kube-scheduler
        fields:
          - path: arguments.bind-address
            var: bind_address
          - path: arguments.profiling
            var: profiling

checks:
  - check_id: scheduler_profiling_disabled
    name: Ensure scheduler profiling is disabled
    severity: LOW
    for_each: get_scheduler_config
    param: config
    calls:
      - action: get_component_config
        params:
          component: kube-scheduler
        fields:
          - path: profiling
            operator: equals
            expected: "false"
    logic: AND
    errors_as_fail: [] 