component: kubelet
component_type: workload
discovery:
- discovery_id: get_kubelet_config
  calls:
  - action: get_component_config
    params:
      component: kube-kubelet
    fields:
    - path: pod_name
      var: pod_name
checks:
- check_id: kubelet_disable_read_only_port
  name: Kubelet Disable Read Only Port
  severity: MEDIUM
  for_each: get_kubelet_config
  param: config
  calls:
  - action: get_component_config
    params:
      component: kube-kubelet
    fields:
    - path: pod_name
      operator: exists
      expected: true
  logic: AND
  errors_as_fail: []
