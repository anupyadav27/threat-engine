component: kubelet

discovery:
  - discovery_id: list_namespaces
    calls:
      - action: list_namespaces
        fields:
          - path: name
            var: ns_name

checks:
  - check_id: kubelet_namespace_list_non_empty
    name: Ensure namespaces are discovered
    severity: LOW
    for_each: list_namespaces
    param: ns
    calls:
      - action: identity
        fields:
          - path: ns.ns_name
            operator: exists
            expected: true
    logic: AND
    errors_as_fail: [] 