rule_id: k8s.pod.security.capabilities_enforcement
service: pod
resource: security
requirement: Capabilities Enforcement
title: Restrict Excessive Linux Capabilities in Pods
description: This control checks that pods are configured with a minimal set of Linux
  capabilities, adhering to the principle of least privilege. It validates that the
  'capabilities' field in the security context of a pod's containers does not include
  unnecessary capabilities beyond what is required for the application to function.
  Properly configured capabilities prevent privilege escalation and reduce the risk
  of container breakout, thereby enhancing the overall security of the Kubernetes
  environment.
rationale: Allowing excessive Linux capabilities in containers can lead to privilege
  escalation attacks. An attacker exploiting a misconfigured pod could gain elevated
  permissions within a container, potentially compromising the host node. Reducing
  capabilities to only those necessary minimizes the attack surface and prevents unauthorized
  actions within the cluster.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: pod.security.capabilities_enforcement
references:
- https://kubernetes.io/docs/tasks/configure-pod-container/security-context/
- https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted
- https://kubernetes.io/docs/concepts/policy/pod-security-policy/#capabilities
compliance:
- cis_kubernetes_kubernetes_5.2.10_0122
