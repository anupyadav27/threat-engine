rule_id: k8s.pod.serviceaccount.automount_check
service: pod
resource: serviceaccount
requirement: Automount Check
title: Disable Automatic ServiceAccount Token Mounting in Pods
description: 'This check validates that pods do not automatically mount the default
  service account token by setting `automountServiceAccountToken: false` in their
  configuration. A compliant configuration restricts the exposure of service account
  tokens to only those pods that explicitly require them, thus reducing the attack
  surface and enhancing overall security posture. Proper configuration ensures compliance
  with security standards such as the CIS Kubernetes Benchmark, which advocates for
  the principle of least privilege.'
rationale: Automatically mounting the default service account token in pods can lead
  to unauthorized access and privilege escalation if a pod is compromised. Attackers
  could use the token to interact with the Kubernetes API server and gain control
  over additional resources within the cluster. Disabling automatic token mounting
  minimizes this risk by ensuring that only pods which specifically require access
  to the API server are granted service account tokens.
severity: low
domain: infrastructure_security
subcategory: configuration_management
scope: pod.serviceaccount.automount_check
references:
- https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#service-account-token-volume-projection
- https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted
- https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#serviceaccount
compliance:
- cis_kubernetes_kubernetes_5.1.6_0105
