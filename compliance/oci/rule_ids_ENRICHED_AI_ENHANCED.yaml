metadata:
  csp: OCI
  description: Enterprise-grade OCI rules - AI Enhanced
  version: 2.0.0
  enhancement_date: '2025-12-02'
  total_rules: 1914
  quality_grade: A+ (GPT-4o Enhanced)
  ai_engine: gpt-4o
statistics:
  total_rules: 1914
  enhanced: 7196
  failed: 0
  connection_errors: 0
  api_calls: 1914
rules:
- rule_id: oci.container_engine.cluster.cni_version_required
  service: container_engine
  resource: cluster
  requirement: Cni Version Required
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure CNI Version Compliance in OCI Container Clusters
  rationale: Outdated Container Network Interface (CNI) versions can expose OCI Container Engine clusters to security vulnerabilities, compatibility issues, and reduced performance. Staying updated with the required CNI version helps mitigate risks such as data breaches, unauthorized access, and potential service disruptions, aligning with compliance frameworks like NIST and ISO 27001.
  description: This rule checks if OCI Container Engine clusters are using the required CNI version. It's crucial to verify that the CNI version aligns with Oracle's recommended standards to ensure cluster security and functionality. Administrators should regularly audit their cluster configurations and apply updates for CNIs as specified in OCI documentation. Remediation involves updating the CNI version through the OCI Console or CLI to meet the stipulated requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengupdatingcluster.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.container_engine.cluster.kubelet_client_ca_file_configured
  service: container_engine
  resource: cluster
  requirement: Kubelet Client Ca File Configured
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Kubelet Client CA File is Configured for Clusters
  rationale: Configuring the Kubelet Client CA file is crucial for securing communication between the API server and nodes in the OCI Kubernetes cluster. Without this configuration, unauthorized access could occur, leading to potential data breaches or service disruptions. This configuration aids in meeting compliance with security frameworks that require encryption and authentication in data transmission, such as NIST and PCI-DSS.
  description: This rule checks if the Kubelet Client CA file is configured in your OCI Kubernetes clusters. The CA file ensures that the Kubelet only accepts connections from authenticated sources, enhancing the security posture of the cluster. To verify, inspect the cluster's API server configuration for the '--kubelet-client-certificate' and '--kubelet-client-key' parameters. Remediation involves updating the cluster configuration to include the correct CA file path. Regularly review and update the CA file to maintain compliance and security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/document_library
  - https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.resource_manager.stack.kubelet_config_ownership_restricted
  service: resource_manager
  resource: stack
  requirement: Kubelet Config Ownership Restricted
  scope: resource_manager.stack.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Restrict Kubelet Config File Ownership in Resource Manager
  rationale: Restricting the ownership of Kubelet configuration files is crucial to prevent unauthorized modifications that could lead to cluster compromise. Uncontrolled access may allow attackers to alter node configurations, leading to privilege escalation or data breaches. Ensuring proper ownership aligns with compliance requirements such as PCI-DSS and enhances the overall security posture by mitigating insider threats.
  description: This rule checks that Kubelet configuration files within Oracle Cloud Infrastructure's Resource Manager stacks are owned by the root user. It ensures that only privileged users can modify configurations, reducing the risk of unauthorized changes. To verify, inspect the ownership of Kubelet configuration files using OCI CLI or API. Remediation involves setting the file ownership to root:root and applying the appropriate file permissions (e.g., 644) to prevent unauthorized write access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengsecurity.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/security/cloud-security/
  - https://kubernetes.io/docs/concepts/security/overview/
- rule_id: oci.resource_manager.stack.kubelet_config_permissions_restricted
  service: resource_manager
  resource: stack
  requirement: Kubelet Config Permissions Restricted
  scope: resource_manager.stack.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Restrict Kubelet Config Permissions in OCI Stacks
  rationale: Restricting Kubelet configuration permissions helps protect against unauthorized access to Kubernetes nodes, reducing the risk of unauthorized data access or modification. It helps maintain compliance with security standards by ensuring that only necessary permissions are granted, minimizing potential attack vectors and maintaining the integrity of workloads.
  description: This rule checks whether Kubelet configuration permissions within OCI Resource Manager stacks are properly restricted. Ensure that Kubelet permissions are set to the minimum necessary for operation by adjusting the stack's configuration files. Verify permissions using the OCI console or CLI, and ensure that sensitive configurations are not accessible publicly. Remediate by reviewing and updating IAM policies associated with the stack to enforce least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ResourceManager/Concepts/resourcemanager.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://kubernetes.io/docs/reference/access-authn-authz/authorization/
- rule_id: oci.database.database.cross_account_sharing_restricted
  service: database
  resource: database
  requirement: Cross Account Sharing Restricted
  scope: database.database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Restrict Cross-Account Database Sharing
  rationale: Cross-account sharing of databases in OCI can expose sensitive data to unauthorized users, increasing the risk of data breaches and non-compliance with regulations such as GDPR and CCPA. Limiting access to trusted accounts only helps protect data integrity and confidentiality while aligning with privacy mandates.
  description: This rule checks if databases in OCI are shared across different accounts, which could lead to potential data exposure. To verify, review the database's sharing settings and ensure only necessary accounts have access. Remediation involves updating IAM policies to restrict database access, utilizing Oracle Data Safe to monitor and audit access, and employing VCN security rules for additional network layer protection.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://www.oracle.com/security/cloud-security/data-safe/
  - 'CIS OCI Benchmark: Control 3.4 - Restrict Sharing of Sensitive Data'
  - 'NIST SP 800-53 Rev. 5: AC-4 - Information Flow Enforcement'
  - 'PCI-DSS Requirement 7: Restrict access to cardholder data by business need to know'
  - ISO/IEC 27001:2013 - A.8.2.3 - Handling of assets
- rule_id: oci.database.autonomous_database.database_encryption_enabled
  service: database
  resource: autonomous_database
  requirement: Database Encryption Enabled
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable Encryption for Autonomous Database in OCI
  rationale: Enabling encryption for autonomous databases is critical to protect sensitive data from unauthorized access and potential breaches. It helps mitigate risks associated with data exposure and aligns with regulatory requirements such as GDPR, HIPAA, and PCI-DSS, which mandate the encryption of sensitive data at rest. Failure to encrypt data can result in significant financial penalties and damage to brand reputation.
  description: This rule checks whether encryption is enabled for Oracle Cloud Infrastructure Autonomous Databases. By default, OCI encrypts all autonomous databases using Oracle-managed keys; however, customers can also manage their own encryption keys for enhanced security control. To verify, access the OCI Console, navigate to the Autonomous Database settings, and ensure 'Encryption' is set to 'Enabled'. If not enabled, modify the settings to activate encryption. This ensures all data at rest within the autonomous database is encrypted using industry-standard algorithms.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/database-cloud-security.html
  - https://www.iso.org/standard/54534.html
- rule_id: oci.database.database.database_policy_least_privilege_required
  service: database
  resource: database
  requirement: Database Policy Least Privilege Required
  scope: database.database.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for OCI Database Policies
  rationale: Implementing least privilege access for OCI database policies minimizes potential security breaches by ensuring users have only the permissions they need, reducing the attack surface. This is crucial for protecting sensitive data and maintaining compliance with regulations such as PCI-DSS and GDPR, which mandate strict access controls to safeguard data integrity and confidentiality.
  description: This rule checks that all policies associated with OCI databases adhere to the principle of least privilege. It verifies that users and roles have only the permissions necessary to perform their job functions. Administrators should regularly review and update these policies to remove unnecessary permissions. Remediation involves analyzing current policy settings and adjusting them to eliminate excessive privileges, ensuring only the required permissions are granted.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.database.database.partition_access_policies_least_privilege_required
  service: database
  resource: database
  requirement: Partition Access Policies Least Privilege Required
  scope: database.database.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Database Partition Access Policies Enforce Least Privilege
  rationale: Applying least privilege principles to database partition access policies minimizes the risk of unauthorized access, data breaches, and potential data loss. This is crucial for maintaining data integrity and ensuring compliance with stringent regulatory requirements such as PCI-DSS and HIPAA, which mandate controlled access to sensitive data.
  description: This rule checks that Oracle Cloud Infrastructure database partition access policies are configured to grant the minimum necessary permissions. Administrators should review and adjust policies to ensure users have only the access they need to perform their job functions. Remediation involves using the OCI Console or API to audit and modify policies, ensuring access rights are tightly controlled and regularly reviewed.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/databaseoverview.htm
  - https://www.oracle.com/security-cloud/cis-benchmarks.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.database.autonomous_database.partition_catalog_encryption_enabled
  service: database
  resource: autonomous_database
  requirement: Partition Catalog Encryption Enabled
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Partition Catalog Encryption for Autonomous Databases
  rationale: Enabling partition catalog encryption for Autonomous Databases is crucial for safeguarding sensitive data against unauthorized access and potential breaches. This practice mitigates the risk of data exposure and aligns with compliance requirements for data protection standards such as PCI-DSS and GDPR, ensuring that sensitive information remains secure even if other defenses are compromised.
  description: This rule checks whether partition catalog encryption is enabled for Autonomous Databases in OCI. Partition catalog encryption helps protect metadata and sensitive information within the database by encrypting the partition catalogs at rest. To verify, navigate to the database details page in the OCI console and ensure that the encryption settings for partition catalogs are enabled. Remediation involves using the OCI CLI or console to enable this feature, ensuring that encryption keys are properly managed and stored in Oracle Cloud Infrastructure Vault.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_implementation.htm
- rule_id: oci.database.autonomous_database.schema_encryption_enabled
  service: database
  resource: autonomous_database
  requirement: Schema Encryption Enabled
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Autonomous Database Schema Encryption is Enabled
  rationale: Enabling schema encryption for Autonomous Databases in OCI protects sensitive data from unauthorized access and potential breaches. This is crucial for maintaining data confidentiality and integrity, especially for organizations handling sensitive information such as personal data or financial records, and helps in meeting compliance requirements like PCI-DSS and GDPR.
  description: This rule checks if schema encryption is enabled on your Oracle Autonomous Database. Schema encryption ensures that all data stored within the database schemas is encrypted at rest using Oracle-managed keys. To verify, navigate to the OCI Console, select your Autonomous Database, and check the 'Encryption' settings under 'Security Configuration'. Remediation involves enabling encryption through the OCI Console or API if it's not already configured.
  references:
  - https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/security.htm#ADBSA-GUID-DBB46F21-5D6D-4F2C-B3C5-6FD6F7E3A73F
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/document_library
  - https://www.iso.org/iso-iec-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/capabilities/encryption/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57pt1r4.pdf
- rule_id: oci.database.database.schema_rbac_least_privilege_required
  service: database
  resource: database
  requirement: Schema RBAC Least Privilege Required
  scope: database.database.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce Least Privilege on OCI Database Schemas
  rationale: Ensuring that database schemas operate under the principle of least privilege minimizes the risk of unauthorized access and potential data breaches. This approach reduces the attack surface by limiting permissions to only those necessary for the userâ€™s role, aligning with regulatory requirements such as PCI-DSS and HIPAA, which mandate access control mechanisms to protect sensitive data.
  description: This rule checks for over-privileged roles assigned to database schemas within OCI, ensuring that permissions are limited to only those necessary for the schema's operation. Administrators should review roles and privileges assigned to database users and schemas, removing unnecessary permissions. Remediation involves auditing current roles, modifying them to restrict access rights, and regularly reviewing permissions in line with OCI's Identity and Access Management (IAM) best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/accesscontrol.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/identity-cloud-service/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://docs.oracle.com/en/database/oracle/oracle-database/19/dbaas/security-guidelines.html
- rule_id: oci.database.autonomous_database.schema_version_immutability_enforced
  service: database
  resource: autonomous_database
  requirement: Schema Version Immutability Enforced
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enforce Schema Version Immutability in Autonomous Database
  rationale: Enforcing schema version immutability in Autonomous Databases is crucial to prevent unauthorized schema changes which can lead to data integrity issues, unauthorized data access, and compliance violations. This practice helps maintain consistency in database operations and aligns with regulatory requirements like PCI-DSS and HIPAA, which mandate stringent data protection and change management controls.
  description: This rule checks if schema version immutability is enabled in Oracle Autonomous Database instances to prevent unauthorized schema modifications. Verify by accessing the database settings in the OCI Console and ensuring the 'Schema Version Immutability' option is active. Remediation involves enabling this setting to lock the schema version, thus securing the database against unintended alterations. Regular audits should be performed to ensure ongoing compliance.
  references:
  - https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/security.html#GUID-66C98E9A-19B8-47A1-B8C0-0B77B7D8F2A3
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/index.html
  - https://cloud.oracle.com/en_US/cloud-security/overview
  - https://www.nist.gov/cyberframework
- rule_id: oci.database.autonomous_database.snapshot_cross_region_copy_encrypted
  service: database
  resource: autonomous_database
  requirement: Snapshot Cross Region Copy Encrypted
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Cross-Region Snapshots Are Encrypted
  rationale: Encrypting cross-region snapshots of Autonomous Databases in OCI mitigates the risk of unauthorized access and data breaches during data transfer. It helps comply with regulatory standards such as GDPR, HIPAA, and PCI-DSS, which mandate encryption for data protection. This practice enhances data privacy and ensures business continuity by safeguarding sensitive information against interception and tampering.
  description: This rule checks whether snapshots of Autonomous Databases that are copied across regions are encrypted. To verify, ensure that encryption settings are enabled when configuring cross-region snapshot policies in OCI. Remediation involves editing snapshot policies to enable encryption, which can typically be done through the OCI Console or API by setting the encryption flag. This protects data integrity and confidentiality during inter-regional data transfers.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbbackups.htm#adb-backup-restore
  - https://www.oracle.com/security-cloud/data-encryption.html
  - CIS Oracle Cloud Infrastructure Foundation Benchmark
  - https://www.oracle.com/cloud/cloud-security/compliance/
  - 'NIST SP 800-53: Security and Privacy Controls for Information Systems'
  - ISO/IEC 27001:2013 Information Security Management Systems
- rule_id: oci.database.autonomous_database.snapshot_encrypted_at_rest_cmek
  service: database
  resource: autonomous_database
  requirement: Snapshot Encrypted At Rest Cmek
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure CMK Encryption for Autonomous Database Snapshots
  rationale: Encrypting database snapshots with a Customer Managed Key (CMK) protects sensitive data from unauthorized access and meets regulatory requirements such as GDPR and PCI-DSS. This reduces the risk of data breaches and unauthorized data exposure, ensuring compliance and safeguarding the organization's reputation.
  description: This rule checks if snapshots of Autonomous Databases are encrypted using a Customer Managed Key (CMK) rather than Oracle-managed keys. To verify, confirm the encryption settings in the OCI Console under the Autonomous Database's security configuration. Remediation involves updating the database's encryption configuration to utilize a CMK, which can be managed through the Oracle Cloud Infrastructure Vault service, providing greater control over key lifecycle and access permissions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/autonomousmanaging.htm#CMK
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.0.0_controls.htm#1.1.1
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.database.backup.snapshot_not_publicly_shared_blocked
  service: database
  resource: backup
  requirement: Snapshot Not Publicly Shared Blocked
  scope: database.backup.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: critical
  title: Ensure Database Backup Snapshots Are Not Publicly Shared
  rationale: Publicly shared database backup snapshots pose a significant risk of unauthorized access, data breaches, and potential data loss. This can lead to severe business impacts including loss of customer trust, legal penalties, and non-compliance with regulations such as GDPR and PCI-DSS, as sensitive information may be exposed to the public internet.
  description: This rule checks whether database backup snapshots in OCI are configured to prevent public sharing. It ensures that snapshots are not publicly accessible, which is a critical security measure to protect sensitive data. To verify, ensure that the backup setting does not include public access permissions. Remediate by using policies that restrict access to authorized users or groups only, leveraging OCI Identity and Access Management (IAM) to control permissions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/databaseoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.database.database.table_access_policies_least_privilege_required
  service: database
  resource: database
  requirement: Table Access Policies Least Privilege Required
  scope: database.database.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce Least Privilege on OCI Database Table Access Policies
  rationale: Implementing least privilege access for database table policies is critical to minimize the attack surface and reduce the risk of unauthorized data access. By restricting access rights, organizations can mitigate potential data breaches, comply with regulatory requirements such as PCI-DSS and HIPAA, and protect sensitive information from insider threats.
  description: This rule checks whether table access policies in OCI databases adhere to the principle of least privilege. It ensures that only necessary permissions are granted to users and applications. To verify, review the access policies associated with each database table and adjust them to restrict permissions to the minimum necessary. Remediation involves modifying policies to limit access rights, regularly auditing access logs, and removing unnecessary permissions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/databaseoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/securitypolicies.htm
  - CIS OCI Foundations Benchmark v1.1.0 - Ensure least privilege access is configured
  - NIST SP 800-53 Rev. 5 - Access Control (AC)
  - 'PCI-DSS v3.2.1 - Requirement 7: Restrict access to cardholder data by business need to know'
  - ISO/IEC 27001:2013 - A.9 Access Control
- rule_id: oci.database.autonomous_database.table_column_level_access_controls_enabled
  service: database
  resource: autonomous_database
  requirement: Table Column Level Access Controls Enabled
  scope: database.autonomous_database.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enable Column-Level Access Controls for Autonomous Database
  rationale: Implementing table column-level access controls in Autonomous Databases is crucial for minimizing unauthorized data exposure, especially sensitive information such as PII. This configuration helps prevent data breaches by ensuring that only authorized users can access specific data segments, thus aligning with compliance requirements such as GDPR and HIPAA, which mandate strict access controls.
  description: This rule checks if column-level access controls are enabled for tables in an Oracle Autonomous Database. It verifies that access policies restrict user permissions to specific columns, minimizing data exposure risks. To remediate, configure Access Control Lists (ACLs) with fine-grained permissions that specify which users can access particular columns. This can be achieved through the OCI Console by navigating to the Autonomous Database details page and setting up the necessary security configurations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbconfiguringsecurity.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
  - https://cloud.oracle.com/data-safe
- rule_id: oci.database.autonomous_database.table_encrypted
  service: database
  resource: autonomous_database
  requirement: Table Encrypted
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Tables Are Encrypted
  rationale: Encryption of tables in Autonomous Databases is crucial for protecting sensitive data from unauthorized access and data breaches. Without encryption, confidential information may be exposed to malicious actors, leading to financial loss, reputational damage, and non-compliance with regulations such as PCI-DSS and GDPR, which mandate encryption of sensitive data.
  description: This rule checks if tables in Oracle's Autonomous Databases are encrypted to ensure data protection at rest. Encryption should be enabled using Oracle's Transparent Data Encryption (TDE) feature, which provides automatic encryption and decryption of data managed by the database. To verify, administrators can use the OCI console to review the encryption settings of each autonomous database. Remediation involves enabling TDE within the database settings, ensuring that all data stored is encrypted, adhering to compliance and security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.oracle.com/security/cloud-security/database-security/
  - CIS OCI Benchmark v1.1.0, section 4.2
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.autonomous_database.table_public_sharing_disabled
  service: database
  resource: autonomous_database
  requirement: Table Public Sharing Disabled
  scope: database.autonomous_database.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Disable Public Sharing for Autonomous Database Tables
  rationale: Disabling public sharing of tables in Oracle Autonomous Databases is crucial to prevent unauthorized data access, which could lead to data breaches and compromise sensitive information. Publicly shared tables increase the risk of exposure to external threats, violating compliance requirements such as PCI-DSS and HIPAA, and potentially resulting in financial and reputational damage.
  description: This rule checks the configuration of Oracle Autonomous Databases to ensure that no tables are publicly shared. It verifies that public access settings are disabled in order to restrict unauthorized access. To remediate, review the database access policies and ensure that any public sharing configurations are turned off. Use Oracle Identity and Access Management to audit and enforce strict access controls.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-spanning-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_iam.htm
- rule_id: oci.database.autonomous_database.dataset_access_policies_least_privilege_required
  service: database
  resource: autonomous_database
  requirement: Dataset Access Policies Least Privilege Required
  scope: database.autonomous_database.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Autonomous Database Access Policies
  rationale: Implementing least privilege access for Autonomous Database ensures that users have only the necessary permissions to perform their job functions, minimizing the risk of unauthorized data access. This approach reduces potential attack surfaces and helps in meeting compliance requirements such as GDPR, PCI-DSS, and HIPAA by protecting sensitive data from inadvertent exposure or breach.
  description: This rule checks that access policies for Autonomous Databases are configured to grant only the necessary permissions required for specific roles. It involves reviewing and updating IAM policies to ensure that no excessive privileges are granted. Remediation requires analyzing existing policies, identifying roles with more privileges than needed, and adjusting permissions accordingly. Regular audits and policy reviews should be conducted to maintain adherence to the least privilege principle.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en/cloud/paas/data-safe/introduction/index.html
- rule_id: oci.database.autonomous_database.dataset_encrypted_at_rest_cmek
  service: database
  resource: autonomous_database
  requirement: Dataset Encrypted At Rest Cmek
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Uses CMEK for Data Encryption at Rest
  rationale: Using Customer-Managed Encryption Keys (CMEK) for encrypting data at rest in Oracle Autonomous Databases enhances control over cryptographic operations and key lifecycle management, thus reducing the risk of unauthorized data access. This aligns with compliance requirements such as PCI-DSS and GDPR, which mandate strict data protection measures, and helps mitigate potential data breaches and financial penalties.
  description: This rule checks if Oracle Autonomous Databases are configured to use Customer-Managed Encryption Keys (CMEK) for encrypting data at rest. It requires verifying the database's encryption settings in the OCI Console and ensuring that the encryption key is managed through Oracle Cloud Infrastructure's Key Management service. Remediation involves enabling CMEK by associating the database with a key in the Key Management service, providing increased security and compliance adherence.
  references:
  - https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/using-customer-managed-keys.html
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/security/cloud-compliance/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57p1r4.pdf
- rule_id: oci.database.autonomous_database.dataset_public_sharing_disabled
  service: database
  resource: autonomous_database
  requirement: Dataset Public Sharing Disabled
  scope: database.autonomous_database.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Disable Public Sharing for Autonomous Database Datasets
  rationale: Disabling public sharing for Autonomous Database datasets mitigates the risk of unauthorized data access, which could lead to data breaches, financial loss, and reputational damage. Publicly shared datasets are vulnerable to exploitation by malicious actors, exposing sensitive information and compromising compliance with regulations such as GDPR and HIPAA.
  description: This rule checks whether public sharing of datasets in Autonomous Databases is disabled, ensuring that data is not accessible outside the intended scope. To verify, review the database's access settings and ensure that public access is not enabled. Remediate by configuring network access control lists (ACLs) to restrict dataset access to necessary users and systems only, following the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.oracle.com/security/cloud-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-144.pdf
  - https://gdpr-info.eu/
  - https://www.hipaajournal.com/oracle-cloud-hipaa-compliance/
- rule_id: oci.database.autonomous_database.dataset_row_level_security_enabled
  service: database
  resource: autonomous_database
  requirement: Dataset Row Level Security Enabled
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable Dataset Row Level Security for Autonomous Databases
  rationale: Enabling row-level security for Autonomous Databases is crucial to prevent unauthorized access to sensitive data. It helps mitigate risks such as data breaches and insider threats by ensuring that only authorized users can access specific rows, thus supporting compliance with regulations like GDPR and HIPAA that mandate stringent data protection measures.
  description: This rule verifies that row-level security is configured on OCI Autonomous Databases to restrict access to specific rows based on user roles and privileges. To implement this, use Oracle Label Security (OLS) or Virtual Private Database (VPD) to define security policies. Administrators should regularly audit these configurations to ensure they are aligned with organizational policies and regulatory requirements.
  references:
  - https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/security.html
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.database.autonomous_database.endpoint_authz_no_anonymous_access_restricted
  service: database
  resource: autonomous_database
  requirement: Endpoint Authz No Anonymous Access Restricted
  scope: database.autonomous_database.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict Anonymous Access to Autonomous Database Endpoints
  rationale: Restricting anonymous access to Autonomous Database endpoints is critical to prevent unauthorized data exposure and potential data breaches. Allowing anonymous access could lead to unauthorized users exploiting the database, resulting in compromised data integrity and non-compliance with regulations such as PCI-DSS and GDPR. Securing endpoints ensures that only authenticated and authorized users can access sensitive database resources, reducing the risk of insider threats and external attacks.
  description: This rule checks that autonomous databases in OCI have endpoint authentication configured to disallow anonymous access. To verify, inspect the database's network access settings and ensure that access is limited to specific IP addresses or VCNs and that authentication mechanisms like IAM policies are in place. Remediation involves updating database security rules to enforce strict access controls and using Oracle Cloud's IAM policies to manage user access effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adbsusingshauthentication.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.database.autonomous_database.endpoint_authz_rbac_least_privilege_required
  service: database
  resource: autonomous_database
  requirement: Endpoint Authz RBAC Least Privilege Required
  scope: database.autonomous_database.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Autonomous Database Endpoint Access
  rationale: Implementing least privilege access for Autonomous Database endpoints reduces the risk of unauthorized data access and potential data breaches. This practice is crucial for maintaining data confidentiality and integrity, especially in environments subject to regulatory requirements such as GDPR or PCI-DSS. Ensuring that only authorized users can access specific database resources helps mitigate the risk of insider threats and external attacks.
  description: This check ensures that Role-Based Access Control (RBAC) is configured to enforce least privilege for accessing Autonomous Database endpoints. Verify that only necessary permissions are granted to users or groups and that sensitive operations are restricted to authorized roles. Remediation involves reviewing user roles and permissions, removing excess privileges, and ensuring that security policies are consistently applied and monitored. Regular audits should be conducted to ensure compliance with this configuration.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingdynamicgroups.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.0_benchmark.htm
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/cloud-database-security.html
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.database.autonomous_database.parameter_group_logging_enabled
  service: database
  resource: autonomous_database
  requirement: Parameter Group Logging Enabled
  scope: database.autonomous_database.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Logging is Enabled for Autonomous Database Parameters
  rationale: Enabling logging for parameter groups in Autonomous Databases is crucial for monitoring changes and detecting unauthorized access or misconfigurations. This practice helps in forensic investigations and ensures compliance with regulatory standards such as PCI-DSS and SOC2, which require detailed audit trails. Without logging, organizations may face increased risk of data breaches and non-compliance penalties.
  description: This rule checks if logging is enabled for the parameter group associated with an Autonomous Database in OCI. Logging captures detailed information about configuration changes and access patterns, which can be critical for identifying potential security incidents. To verify, ensure that the parameter group has logging enabled through the OCI Console or CLI. Remediation involves updating the parameter group settings to activate logging, thus enhancing traceability and accountability.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adblogging.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.autonomous_database.parameter_group_tls_required
  service: database
  resource: autonomous_database
  requirement: Parameter Group TLS Required
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure TLS is Required for Autonomous Database Connections
  rationale: Requiring TLS for database connections protects sensitive data from interception and unauthorized access during transmission. This mitigates risks associated with man-in-the-middle attacks and ensures compliance with data protection standards such as PCI-DSS and HIPAA, which mandate encryption in transit for sensitive information.
  description: This rule verifies that the Autonomous Database's parameter group mandates TLS for all client connections. To verify, ensure that the parameter group associated with your Autonomous Database has the 'require_ssl' parameter set to 'true'. Remediation involves updating the parameter group to enforce TLS, which can be done via the OCI Console or API. This enhances data security by encrypting data in transit between clients and the database.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://www.oracle.com/security/cloud-security/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-52r2.pdf
- rule_id: oci.database.db_system.parameter_group_require_ssl_required
  service: database
  resource: db_system
  requirement: Parameter Group Require SSL Required
  scope: database.db_system.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enforce SSL for OCI Database System Connections
  rationale: Requiring SSL for database connections is crucial for protecting sensitive data from interception and unauthorized access. Without SSL, data integrity and confidentiality can be compromised, exposing businesses to data breaches, financial losses, and regulatory penalties. Compliance with regulations such as PCI-DSS and HIPAA often mandates encryption of data in transit.
  description: This rule checks if the Parameter Group for OCI Database Systems mandates SSL connections. Ensure the 'require_ssl' setting is enabled, guaranteeing that all client connections to the database are encrypted using SSL. Verify this configuration through the OCI Console or CLI, and adjust the parameter group settings if necessary. Remediation involves modifying the parameter group to enable SSL and applying it to the Database System.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/managingDBsystemparameters.htm
  - https://www.oracle.com/security-alerts/
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://csrc.nist.gov/publications/detail/sp/800-52/rev-2/final
- rule_id: oci.database.autonomous_database.endpoint_access_allowed_cidrs_minimized_restricted
  service: database
  resource: autonomous_database
  requirement: Endpoint Access Allowed Cidrs Minimized Restricted
  scope: database.autonomous_database.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict Allowed CIDRs for Autonomous Database Endpoints
  rationale: Minimizing the CIDR ranges allowed for Autonomous Database endpoints reduces the attack surface by limiting potential access to only trusted IP addresses. This practice mitigates risks such as unauthorized access and data exfiltration, thereby protecting sensitive business data and ensuring compliance with industry regulations like PCI-DSS and GDPR.
  description: This rule checks whether the CIDR ranges configured for accessing Autonomous Database endpoints are minimized and restricted to known, trusted IP addresses. To verify, review the 'Access Control' settings in the OCI Console and ensure that only specific IP addresses or ranges are permitted. Remediate by removing broad CIDR ranges and configuring precise IP address entries that align with your organization's security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbmigrating.htm#accesscontrol
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/document_library
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security.html
- rule_id: oci.database.autonomous_database.endpoint_access_private_only_restricted
  service: database
  resource: autonomous_database
  requirement: Endpoint Access Private Only Restricted
  scope: database.autonomous_database.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Autonomous DB Endpoint Access is Private Only
  rationale: Restricting Autonomous Database endpoint access to private network ensures that sensitive data and database operations are shielded from public internet threats, reducing the risk of unauthorized access and data breaches. This configuration supports compliance with industry regulations that mandate stringent data protection measures, such as PCI-DSS and HIPAA, by limiting exposure to potential cyberattacks.
  description: This rule checks that the Autonomous Database is configured to allow access only from private endpoints, effectively isolating it from the public internet. Verify that the 'Access Type' setting in the OCI console is set to 'Private' for the Autonomous Database. Remediation involves configuring the database to use a Virtual Cloud Network (VCN) and ensuring that no public IP addresses are assigned, thereby restricting access to trusted, internal networks only.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbcprivateaccess.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations_benchmark
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://www.hhs.gov/hipaa/for-professionals/index.html
  - https://cloud.oracle.com/database/autonomous-database
- rule_id: oci.database.autonomous_database.endpoint_access_tls_required
  service: database
  resource: autonomous_database
  requirement: Endpoint Access TLS Required
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure TLS for Autonomous Database Endpoint Access
  rationale: Requiring TLS for endpoint access to Autonomous Databases is crucial to protect sensitive data in transit from interception and unauthorized access. It mitigates the risk of man-in-the-middle attacks and enhances data confidentiality and integrity, which are critical for meeting compliance with standards like PCI-DSS and HIPAA.
  description: This rule checks that all endpoint access to OCI Autonomous Databases is configured to use TLS. TLS encrypts data transmitted between clients and the database, ensuring that sensitive information cannot be easily intercepted by malicious actors. To verify, ensure TLS settings are enabled on all database connections through the OCI Console or API. Remediate non-compliance by configuring the database connections to require TLS, which can be done by specifying the appropriate settings in the network access control policies and database configurations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm#adb_tls
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.monitoring.alarm.escalation_change_audit_logging_enabled
  service: monitoring
  resource: alarm
  requirement: Escalation Change Audit Logging Enabled
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Escalation Change Audit Logging for OCI Alarms
  rationale: Audit logging for escalation changes in OCI Alarms is crucial for tracking unauthorized or unintended modifications which can disrupt monitoring workflows and alerting mechanisms. This logging supports compliance with regulations such as PCI-DSS and ISO 27001, and helps in forensic investigations by maintaining a tamper-proof record of configuration changes.
  description: This rule ensures that audit logging is enabled for escalation changes in OCI Alarms. This involves verifying that the Oracle Cloud Infrastructure is configured to log all changes made to alarm escalations, providing an audit trail for both operational and security purposes. To remediate, configure the Audit service in OCI to capture and retain logs for alarm configuration changes, and review these logs regularly for anomalies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://www.pcisecuritystandards.org
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.monitoring.alarm.escalation_oncall_contacts_verified_validated
  service: monitoring
  resource: alarm
  requirement: Escalation Oncall Contacts Verified Validated
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Verify Validity of Alarm Escalation Oncall Contacts
  rationale: Ensuring escalation oncall contacts for alarms are verified and validated is crucial for maintaining the integrity and reliability of incident response processes. Unverified contacts can lead to delays in addressing critical alerts, impacting business operations and exposing the organization to potential threats. Compliance with industry standards often requires validated communication channels for incident management.
  description: This rule checks whether the escalation oncall contacts associated with OCI alarm configurations are verified and validated. It ensures that all contact details are up-to-date and functional. To verify, review the contact information in the OCI Monitoring service and ensure it meets current operational requirements. Remediation involves updating any outdated or incorrect contact details and confirming their accuracy through test notifications or direct validation with the contact.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.monitoring.alarm.critical_severity_escalation_policy_configured
  service: monitoring
  resource: alarm
  requirement: Critical Severity Escalation Policy Configured
  scope: monitoring.alarm.policy_management
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Critical Severity Alarm Escalation Policy is Configured
  rationale: Configuring an escalation policy for critical severity alarms in OCI is essential to ensure that prompt and appropriate actions are taken when significant issues arise. Without a proper escalation policy, critical alarms may go unnoticed, leading to prolonged system downtime, potential data loss, or security breaches. This practice also aligns with compliance requirements, such as ISO 27001 and NIST, which emphasize incident response and management.
  description: This rule checks if an escalation policy is configured for alarms with critical severity in OCI Monitoring. To verify, review the alarm settings in the OCI Console to ensure that a defined escalation path is in place, with notifications sent to appropriate personnel or systems. Remediation involves setting up an escalation policy using OCI Monitoring's alarm configuration, specifying actions such as email notifications or integration with incident management systems for critical alarms.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.oracle.com/cloud/cloud-infrastructure-compliance/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
  - https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final
- rule_id: oci.ai_anomaly_detection.detector.anomaly_destinations_encrypted
  service: ai_anomaly_detection
  resource: detector
  requirement: Anomaly Destinations Encrypted
  scope: ai_anomaly_detection.detector.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Anomaly Detection Destinations Are Encrypted
  rationale: Encrypting anomaly detection destinations in OCI is critical for protecting sensitive business data from unauthorized access and potential breaches. Unencrypted data can be exposed to threats, leading to financial losses, reputational damage, and non-compliance with data protection regulations such as GDPR, PCI-DSS, and HIPAA.
  description: This rule checks if the destinations where anomaly detection results are stored in OCI are encrypted at rest. To verify, ensure that the storage resources used by anomaly detectors have encryption enabled using Oracle-managed keys or customer-managed keys. Remediation involves configuring the anomaly detection service to store data in OCI Object Storage or Database services that have encryption enabled by default.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/AI/Tasks/using_ai_anomaly_detection.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security-best-practices.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.ai_anomaly_detection.detector.anomaly_detectors_enabled
  service: ai_anomaly_detection
  resource: detector
  requirement: Anomaly Detectors Enabled
  scope: ai_anomaly_detection.detector.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Anomaly Detectors are Enabled for OCI AI Anomaly Detection
  rationale: Enabling anomaly detectors in OCI AI Anomaly Detection is crucial for early identification of unusual patterns and potential security threats within your cloud environment. This capability aids in proactive threat detection, reducing the risk of data breaches and ensuring compliance with industry regulations such as PCI-DSS and SOC2, which mandate robust monitoring of information systems.
  description: This rule verifies that anomaly detectors are enabled in the OCI AI Anomaly Detection service. It checks the configuration settings to ensure detectors are active and continuously monitoring for anomalies. To verify, navigate to the OCI Console, access the AI Services section, and review the anomaly detection settings. Remediation involves enabling the detectors and setting appropriate monitoring parameters to ensure comprehensive coverage and timely alerting of potential threats.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/anomalydetection/home.htm
  - https://www.oracle.com/cloud/security/
  - https://cloudsecurityalliance.org/research/guidance/csa-cloud-controls-matrix/
  - https://www.pcisecuritystandards.org/
  - https://www.ssae.org/soc2/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.apigateway.gateway.api_key_expiration_required
  service: apigateway
  resource: gateway
  requirement: API Key Expiration Required
  scope: apigateway.gateway.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure API Gateway Keys Have Defined Expiration
  rationale: API keys without expiration increase the risk of unauthorized access if they are compromised, as they might remain active indefinitely. Implementing key expiration helps mitigate potential data breaches by limiting the lifespan of credentials, aligning with data protection regulations such as PCI-DSS and GDPR.
  description: This rule checks whether API keys used in the OCI API Gateway have an expiration date set. API keys should be configured to expire after a specific period to reduce the risk of unauthorized access. Administrators should regularly review and update API key policies to enforce expiration settings. Remediation involves configuring API Gateway settings to ensure that all API keys have an expiration date defined, which can be verified through the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusing.htm
  - https://www.oracle.com/security-cloud/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/security/cloud-security/
  - https://www.nist.gov/cyberframework
- rule_id: oci.apigateway.api.api_key_rotation_policy_defined_required
  service: apigateway
  resource: api
  requirement: API Key Rotation Policy Defined Required
  scope: apigateway.api.key_rotation
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure API Gateway API Key Rotation Policy is Defined
  rationale: Defining an API key rotation policy for OCI API Gateway is critical to minimize the risk of unauthorized access due to compromised keys. Regular rotation of API keys helps in mitigating risks associated with key exposure and meets compliance requirements for data protection by ensuring keys are not used beyond their intended lifespan. This practice is crucial for maintaining the integrity and confidentiality of sensitive data accessed via APIs.
  description: This rule checks if an API key rotation policy is defined for OCI API Gateway APIs. The policy should specify the frequency of key rotations and procedures for updating keys in applications and services. To verify, ensure that a rotation schedule is configured within the OCI Console under the API Gateway settings. Remediation involves setting a rotation policy that aligns with best practices, such as rotating keys every 90 days, and updating all dependent services with the new keys promptly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusingconsole.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.nist.gov/publications/nist-special-publication-800-57-revision-4-recommendation-key-management
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam_keymanagement.htm
- rule_id: oci.apigateway.api.api_key_scopes_least_privilege_required
  service: apigateway
  resource: api
  requirement: API Key Scopes Least Privilege Required
  scope: apigateway.api.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure API Key Scopes Adhere to Least Privilege in API Gateway
  rationale: Adhering to the principle of least privilege for API key scopes reduces the attack surface by limiting access to only necessary resources, mitigating risks of unauthorized actions. This approach minimizes potential damage in case of credential compromise and aligns with compliance frameworks that mandate strict access controls, such as PCI-DSS and ISO 27001.
  description: This rule checks that API keys in Oracle Cloud Infrastructure API Gateway are configured with the minimum necessary scopes to perform their intended functions. Verify that API keys are not granted excessive permissions by reviewing their scope assignments in the API Gateway console. Remediation involves adjusting API key scopes to restrict access to only required resources, ensuring adherence to least privilege principles.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusing.htm
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-63-2.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.apigateway.gateway.authorizer_cache_ttl_configured
  service: apigateway
  resource: gateway
  requirement: Authorizer Cache Ttl Configured
  scope: apigateway.gateway.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Authorizer Cache TTL is Configured in API Gateway
  rationale: Configuring an Authorizer Cache TTL in API Gateway enhances performance by reducing latency for repeated authorization requests, which can lead to a better user experience and lower operational costs. It also minimizes the risk of repeated authorization checks overloading the identity provider, which is crucial for maintaining service availability and reliability.
  description: This rule checks that the Authorizer Cache Time-to-Live (TTL) is configured for API Gateways in OCI. Setting a cache TTL ensures that authorization responses are cached for a specified period, reducing the frequency of direct calls to the identity provider. To verify, ensure that the 'authorizer' section in the API Gateway configuration includes a 'cacheTTLInSeconds' parameter with an appropriate value. Set this parameter based on your application's tolerance for stale authorization data and expected traffic patterns.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusingauthorizers.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
- rule_id: oci.apigateway.gateway.authorizer_tls_min_1_2_enforced
  service: apigateway
  resource: gateway
  requirement: Authorizer TLS Min 1 2 Enforced
  scope: apigateway.gateway.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure TLS 1.2+ for API Gateway Authorizers
  rationale: Enforcing a minimum of TLS 1.2 for API Gateway authorizers is crucial to protect sensitive data from being intercepted by unauthorized parties. TLS 1.0 and 1.1 have known vulnerabilities that can be exploited, posing a threat to data integrity and confidentiality. Compliance with standards such as PCI-DSS and HIPAA necessitates the use of strong encryption protocols to safeguard data in transit.
  description: This rule checks whether API Gateway authorizers are configured to enforce a minimum of TLS 1.2. To verify, review the TLS settings in the API Gateway console under the authorizer configuration. Remediation involves updating the authorizer's settings to use TLS 1.2 or higher, ensuring secure data transmission and alignment with industry regulations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewaycreatingauthorizer.htm
  - https://www.cisecurity.org/benchmark/oracle
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-52/rev-2/final
  - https://www.hipaajournal.com/hipaa-encryption-requirements/
- rule_id: oci.apigateway.gateway.authorizer_token_audience_restriction_enforced
  service: apigateway
  resource: gateway
  requirement: Authorizer Token Audience Restriction Enforced
  scope: apigateway.gateway.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure API Gateway Authorizer Token Audience Restriction
  rationale: Enforcing audience restrictions on authorizer tokens is critical to prevent unauthorized access to API gateways, reducing the risk of token replay attacks and ensuring that tokens are used strictly for their intended purpose. This control helps align with compliance requirements by ensuring that only valid, intended audiences can interact with API resources, thereby protecting sensitive data and maintaining trust in the system's security posture.
  description: This rule checks whether audience restrictions are enforced on tokens used by authorizers in OCI API Gateway. To verify, ensure that authorizer configurations include a specified audience claim that matches the audience of the expected clients. Remediation involves updating the API Gateway authorizer settings to include an 'audience' field, specifying valid audience identifiers. This configuration ensures that only tokens intended for a specific service or system can be used, mitigating potential misuse.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusingauthorizers.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://csrc.nist.gov/publications/detail/sp/800-63/rev-3/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/artifacts/oracle-cloud-security-best-practices/
- rule_id: oci.apigateway.gateway.stage_logging_enabled
  service: apigateway
  resource: gateway
  requirement: Stage Logging Enabled
  scope: apigateway.gateway.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Logging for API Gateway Stages
  rationale: Enabling stage logging in OCI API Gateway is crucial for monitoring API activity and detecting anomalous behavior, which can mitigate security risks such as unauthorized access or data breaches. It ensures accountability and traceability of actions, which are essential for compliance with standards like PCI-DSS and SOC2.
  description: This rule verifies that logging is enabled for all stages of an API Gateway in OCI, capturing request and response details. To ensure compliance, logging should be configured to send logs to an OCI Logging service log group. This helps in maintaining a reliable audit trail and supports forensic investigations. Remediation involves navigating to the API Gateway service, selecting the appropriate gateway, and enabling logging for each stage through the OCI Console or API.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayconfiglogging.htm
  - https://docs.oracle.com/en-us/iaas/Content/Compliance/Concepts/compliancereports.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.aicpa.org/content/dam/aicpa/interestareas/frc/assuranceadvisoryservices/downloadabledocuments/aicpasoc2report.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.apigateway.api.stage_usage_plan_for_api_keys_required
  service: apigateway
  resource: api
  requirement: Stage Usage Plan For API Keys Required
  scope: apigateway.api.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Mandatory Stage Usage Plan for API Keys in OCI API Gateway
  rationale: Enforcing usage plans for API keys in Oracle Cloud Infrastructure's API Gateway is crucial for managing and controlling access to APIs, thereby minimizing unauthorized usage and potential abuse. This measure helps mitigate risks of data breaches and ensures compliance with regulations such as PCI-DSS and GDPR, which mandate strict access controls and monitoring mechanisms.
  description: This rule checks whether a stage usage plan is enforced for API keys within OCI API Gateway. Usage plans allow for specifying limits and throttling policies that control the rate and quota of API requests. To verify, ensure that each API stage is associated with a usage plan that mandates API key usage. Remediation involves creating or updating usage plans with appropriate limits and associating them with the relevant API stages to enforce API key utilization.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusingusageplans.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.apigateway.gateway.stage_throttling_enabled
  service: apigateway
  resource: gateway
  requirement: Stage Throttling Enabled
  scope: apigateway.gateway.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Throttling is Enabled on API Gateway Stages
  rationale: Enabling throttling on API Gateway stages is crucial to prevent abuse and ensure fair usage of resources. It mitigates risk by controlling the number of requests clients can make in a given time frame, protecting against denial-of-service attacks and ensuring service availability. This aligns with compliance requirements such as PCI-DSS and supports maintaining a secure and efficient cloud environment.
  description: This check verifies if throttling is enabled for API Gateway stages in Oracle Cloud Infrastructure. Throttling should be configured to set limits on the number of requests per second (RPS) that each client can make, helping to prevent resource exhaustion and ensure service stability. To verify, navigate to the API Gateway in the OCI Console, access the stage settings, and ensure throttling is configured with appropriate limits. Remediation involves setting up stage-level throttling policies to define RPS limits and burst capacity.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusing.htm
  - https://docs.oracle.com/en-us/iaas/Content/API/Concepts/apigatewayoverview.htm
  - NIST SP 800-53 Rev. 5 - System and Communications Protection
  - PCI-DSS Requirement 6.5.10 - Implement Web Application Firewalls
  - https://www.oracle.com/security-best-practices/
  - ISO/IEC 27001:2013 - A.12.1.3 - Capacity Management
- rule_id: oci.apigateway.gateway.usage_plan_quota_limits_configured
  service: apigateway
  resource: gateway
  requirement: Usage Plan Quota Limits Configured
  scope: apigateway.gateway.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure API Gateway Usage Plan Quota Limits Are Configured
  rationale: Configuring usage plan quota limits in OCI API Gateway helps prevent abuse and overuse of APIs, which can lead to service degradation, unexpected costs, and potential denial of service. It is crucial for regulatory compliance and to maintain predictable API consumption patterns, ensuring the system's integrity and availability.
  description: This rule checks that quota limits are configured for each usage plan in the OCI API Gateway. Quota limits control the number of requests that can be made to an API, protecting against excessive usage that can strain resources. Administrators should verify quota settings through the OCI Console under API Gateway service, ensuring they align with operational and security policies. Remediation involves setting appropriate quota thresholds based on expected usage and business requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusingusageplans.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.apigateway.gateway.usage_plan_rate_limits_configured
  service: apigateway
  resource: gateway
  requirement: Usage Plan Rate Limits Configured
  scope: apigateway.gateway.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure API Gateway Usage Plan Rate Limits Are Configured
  rationale: Configuring usage plan rate limits in OCI API Gateway is crucial to prevent abuse of API resources, control costs, and ensure fair resource allocation among clients. Without rate limiting, APIs are susceptible to denial-of-service attacks and can result in unexpected spikes in resource consumption, impacting performance and availability. Proper configuration helps meet compliance requirements by enforcing access control policies and maintaining service quality.
  description: This rule checks if rate limits are configured for usage plans in the OCI API Gateway. Rate limits control the number of requests a client can make within a specified time frame, helping to manage traffic and protect backend services from overload. To verify, navigate to the API Gateway console, select the relevant Gateway, and review the Usage Plans for rate limit settings. Remediation involves defining rate limit policies within the Usage Plans by specifying the maximum requests per second, minute, or hour based on business needs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusingusageplans.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/secure-api-gateway.htm
  - NIST SP 800-53 Rev. 5 AC-10 Concurrent Session Control
  - CIS Oracle Cloud Infrastructure Foundations Benchmark
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v4/
- rule_id: oci.apigateway.api.dev_endpoint_encrypted
  service: apigateway
  resource: api
  requirement: Dev Endpoint Encrypted
  scope: apigateway.api.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure API Gateway Dev Endpoints Use Encryption
  rationale: Encrypting API Gateway endpoints safeguards sensitive data during transit and at rest. Unencrypted endpoints can expose data to unauthorized access, leading to data breaches and non-compliance with regulations such as PCI-DSS and GDPR. Ensuring encryption aligns with best practices for protecting data privacy and maintaining customer trust.
  description: This rule checks whether development endpoints in the Oracle API Gateway are encrypted. To verify, ensure that API Gateway configurations enforce TLS for data in transit and that data at rest is encrypted using OCI's key management service. Remediation involves updating endpoint settings to utilize encryption protocols and OCI-managed keys, ensuring all data is adequately protected.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Concepts/apigatewayoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - PCI-DSS Requirement 4.1
  - 'NIST SP 800-52r2: Guidelines for TLS Implementations'
  - ISO 27001:2013 A.10.1 Cryptographic Controls
  - https://www.oracle.com/security/cloud-security/key-management/
- rule_id: oci.apigateway.gateway.dev_endpoint_no_public_access_blocked
  service: apigateway
  resource: gateway
  requirement: Dev Endpoint No Public Access Blocked
  scope: apigateway.gateway.public_access
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: critical
  title: Block Public Access to Dev Endpoints in API Gateway
  rationale: Allowing public access to development endpoints poses a significant security risk as these environments often lack the rigorous security measures of production and may expose sensitive information or untested code to unauthorized users. This exposure can lead to data breaches, unauthorized access, or exploitation of vulnerabilities. Ensuring that public access is blocked aligns with compliance requirements such as PCI-DSS and SOC2, which mandate the protection of sensitive data and controlled access to systems.
  description: This rule checks if development endpoints within the Oracle Cloud Infrastructure API Gateway are publicly accessible. It ensures that any API Gateway configured as a development environment does not have public access enabled. To verify, review the network access settings of your API Gateway and ensure that public IP addresses are restricted. Remediation involves configuring security rules and access policies to limit access to trusted IP addresses only and disabling any unnecessary public endpoints.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusing.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_compliance.htm
- rule_id: oci.apigateway.gateway.dev_endpoint_role_least_privilege_required
  service: apigateway
  resource: gateway
  requirement: Dev Endpoint Role Least Privilege Required
  scope: apigateway.gateway.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure API Gateway Dev Endpoint Uses Least Privilege Role
  rationale: Applying the principle of least privilege to API Gateway endpoints reduces the risk of unauthorized access and potential data breaches. Excessive permissions can be exploited by malicious actors, leading to compromised systems and data loss. Compliance with standards like NIST and ISO 27001 mandates strict access control measures to protect sensitive information.
  description: This rule checks that API Gateway development endpoints are configured with roles granting only the necessary permissions. To verify, review the IAM policies assigned to API Gateway roles and ensure they align with least privilege principles. Remediation involves auditing current permissions, removing unnecessary access, and updating IAM policies to minimize privileges without hindering functionality.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Concepts/apigatewayoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/securitypolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.audit.configuration.delivery_channel_destination_access_least_privilege_required
  service: audit
  resource: configuration
  requirement: Delivery Channel Destination Access Least Privilege Required
  scope: audit.configuration.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Audit Log Delivery Channels
  rationale: Implementing least privilege access for audit log delivery channels minimizes the risk of unauthorized access to sensitive audit data, which can lead to data breaches or compliance violations. This is crucial for maintaining the integrity and confidentiality of log data, supporting regulatory requirements such as PCI-DSS, HIPAA, and ISO 27001.
  description: This rule checks that the IAM policies for audit log delivery channels grant only the necessary permissions required to perform log delivery, preventing excessive access. Verify that policies associated with log delivery targets, such as Object Storage or Streaming services, restrict user and service access to the minimum necessary. Remediate by reviewing and updating IAM policies to eliminate broad permissions and ensure that only specific roles have the necessary access to perform log deliveries.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.audit.configuration.delivery_channel_kms_encryption_enabled
  service: audit
  resource: configuration
  requirement: Delivery Channel KMS Encryption Enabled
  scope: audit.configuration.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure KMS Encryption for Audit Log Delivery Channels
  rationale: Enabling KMS encryption for audit log delivery channels is crucial for safeguarding sensitive audit data against unauthorized access and potential data breaches. This practice helps maintain data integrity and confidentiality, which is essential for meeting regulatory compliance requirements such as PCI-DSS and GDPR. Additionally, it mitigates risks associated with insider threats and unauthorized data exposure, thereby enhancing overall data protection and privacy.
  description: This rule checks whether the delivery channels for OCI Audit configurations are utilizing Oracle Key Management Service (KMS) for encryption. To verify, ensure that the audit logs are configured to use a KMS key for encryption before being delivered to the specified storage destination. Remediation involves creating or identifying an existing KMS key and configuring the audit service to use this key for encrypting delivery channels, thus ensuring audit data is encrypted at rest.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.functions.application.maintenance_execution_roles_least_privilege_required
  service: functions
  resource: application
  requirement: Maintenance Execution Roles Least Privilege Required
  scope: functions.application.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce Least Privilege for OCI Functions Maintenance Roles
  rationale: Implementing least privilege for maintenance execution roles in OCI Functions reduces the risk of unauthorized access and potential data breaches. It minimizes the attack surface by ensuring that roles have only the permissions necessary to perform their intended tasks, thereby limiting the impact of compromised accounts. This approach aligns with compliance standards that mandate strict access controls to protect sensitive data.
  description: This rule verifies that only the necessary permissions are granted to roles responsible for maintenance tasks in OCI Functions applications. To ensure least privilege, examine each role's policies and reduce permissions to the minimum required for maintenance operations. Remediation involves reviewing and adjusting IAM policies to restrict access rights, following OCI best practices and using predefined policies wherever possible.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Concepts/functions.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - 'CIS OCI Benchmarks: https://www.cisecurity.org/benchmark/oracle_cloud/'
  - 'NIST SP 800-53: https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final'
  - 'ISO 27001: https://www.iso.org/iso-27001-information-security.html'
  - 'OCI Security Best Practices: https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practice.htm'
- rule_id: oci.functions.application.maintenance_window_defined_required
  service: functions
  resource: application
  requirement: Maintenance Window Defined Required
  scope: functions.application.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Define Maintenance Windows for OCI Functions Applications
  rationale: Setting a maintenance window for OCI Functions Applications ensures minimal disruption during updates and maintenance activities, protecting business operations and service availability. It helps mitigate risks associated with unscheduled downtime and aligns with compliance requirements for system availability and reliability.
  description: This rule checks whether a maintenance window is defined for each OCI Functions Application. A properly configured maintenance window allows for scheduled updates and patches, which are critical for maintaining security and performance. To verify, ensure that each application has a maintenance policy set in its configuration. Remediation involves configuring a maintenance window in the OCI Console or via API, specifying start and end times that align with business needs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionscapacityapplications.htm
  - https://www.oracle.com/security/cis-benchmarks/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security.html
- rule_id: oci.database.database.database_cross_account_sharing_restricted
  service: database
  resource: database
  requirement: Database Cross Account Sharing Restricted
  scope: database.database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Restrict Cross-Account Database Sharing
  rationale: Restricting cross-account database sharing is crucial to prevent unauthorized access and data breaches, ensuring that sensitive data remains secure within a controlled environment. This practice minimizes the risk of data exposure to external and potentially untrusted accounts, thereby aligning with data protection regulations such as GDPR and CCPA. Unauthorized data sharing can lead to significant compliance violations and financial penalties.
  description: This rule checks whether Oracle Cloud Infrastructure (OCI) databases are configured to restrict cross-account sharing, which should be limited to only trusted accounts with a legitimate business need. To verify, administrators should review IAM policies and database sharing configurations to ensure that only approved accounts are granted access. If unapproved accounts have access, revoke permissions and update access policies to enforce the restriction. Utilize OCI's Identity and Access Management (IAM) service to continuously monitor and manage access permissions effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/security-cloud/cloud-compliance/
  - NIST SP 800-53 AC-3 Access Enforcement
  - https://www.oracle.com/database/technologies/security.html
  - https://www.cisecurity.org/benchmark/oracle_cloud
- rule_id: oci.database.db_system.cluster_admin_access_least_privilege_required
  service: database
  resource: db_system
  requirement: Cluster Admin Access Least Privilege Required
  scope: database.db_system.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Enforce Least Privilege for Cluster Admin in OCI DB Systems
  rationale: Ensuring least privilege for cluster admin accounts in OCI DB Systems minimizes potential attack vectors by limiting access to essential functions only. This reduces the risk of accidental or malicious changes that could lead to data breaches, service disruptions, or non-compliance with regulations like PCI-DSS and HIPAA. Implementing least privilege is crucial for maintaining the integrity and confidentiality of sensitive data managed by OCI databases.
  description: This rule checks that cluster admin accounts within OCI DB Systems are configured with the least privilege necessary for their function. It involves reviewing IAM policies to ensure that permissions are restricted to only those required. Verification can be done by auditing IAM policies associated with the db_system resource. Remediation includes modifying IAM policies to remove excessive permissions and auditing these changes regularly to prevent privilege creep.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://www.oracle.com/a/ocom/docs/oracle-cloud-security-standards.pdf
- rule_id: oci.database.autonomous_database.cluster_audit_logging_enabled
  service: database
  resource: autonomous_database
  requirement: Cluster Audit Logging Enabled
  scope: database.autonomous_database.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Audit Logging for Autonomous Database Clusters
  rationale: Audit logging is crucial for monitoring database activities, detecting unauthorized access attempts, and ensuring traceability of operations within Oracle Autonomous Databases. This is essential for maintaining the integrity and confidentiality of sensitive data, meeting regulatory compliance requirements such as PCI-DSS and SOC2, and mitigating risks associated with data breaches and insider threats.
  description: This rule checks if audit logging is enabled for Autonomous Database clusters in Oracle Cloud Infrastructure. To verify, navigate to the 'Autonomous Database' service in OCI Console, select the database instance, and ensure the 'Audit Logs' feature is active under the 'Logging' section. Remediation involves enabling audit logs via the OCI Console, ensuring all actions on the database are recorded for security and compliance purposes. Regularly review audit logs to identify and respond to suspicious activities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adbauditlogs.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracletutorial.com/oracle-dba/oci-best-practices/
- rule_id: oci.database.db_system.cluster_encryption_cmek_enabled
  service: database
  resource: db_system
  requirement: Cluster Encryption Cmek Enabled
  scope: database.db_system.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable Cluster Encryption with Customer-Managed Keys for DB Systems
  rationale: Enabling cluster encryption with Customer-Managed Encryption Keys (CMEK) protects sensitive data from unauthorized access and aligns with compliance mandates such as PCI-DSS and HIPAA. The use of CMEK allows organizations to have greater control over their encryption keys, reducing the risk of unauthorized data access and ensuring data privacy and integrity.
  description: This rule checks whether Oracle Cloud Infrastructure (OCI) database DB Systems have cluster encryption enabled using Customer-Managed Encryption Keys (CMEK). To verify, ensure that DB Systems are configured to use Oracle Cloud Infrastructure Vault for key management. Remediation involves configuring the DB System to use the Vault service for encryption keys, providing enhanced control and security over the encryption process.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/using_vault.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_security_certifications.htm
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
- rule_id: oci.database.autonomous_database.cluster_private_networking_enforced
  service: database
  resource: autonomous_database
  requirement: Cluster Private Networking Enforced
  scope: database.autonomous_database.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Autonomous Database Uses Cluster Private Networking
  rationale: Enforcing cluster private networking for Autonomous Databases ensures that sensitive data is only accessible within the private network, reducing exposure to potential threats. This approach mitigates risks such as unauthorized access and data breaches, aligning with compliance requirements for data protection and privacy regulations like GDPR and HIPAA.
  description: This rule checks whether Autonomous Databases are configured to use cluster private networking, limiting access to internal network resources. To verify, ensure that the database is deployed with a private endpoint, which restricts access to within the OCI Virtual Cloud Network (VCN). Remediation involves modifying the network access settings of the database to enable private endpoints, thus preventing access from the public internet.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbdprivateaccess.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hipaajournal.com/oracle-cloud-hipaa-compliance/
- rule_id: oci.database.autonomous_database.cluster_tls_min_1_2_enforced
  service: database
  resource: autonomous_database
  requirement: Cluster TLS Min 1 2 Enforced
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure TLS 1.2 or Higher for Autonomous Database Clusters
  rationale: Enforcing a minimum TLS version of 1.2 for Autonomous Database clusters is crucial to protect data in transit from eavesdropping and man-in-the-middle attacks. It ensures that communications are encrypted using strong protocols that are compliant with industry standards such as PCI-DSS, HIPAA, and ISO 27001. Failure to enforce this can lead to potential data breaches, impacting business reputation and leading to financial penalties.
  description: This check verifies that all Autonomous Database clusters enforce a minimum TLS version of 1.2 for encrypted communications. Administrators should configure the database settings to disallow weaker protocols like TLS 1.0 and 1.1. To remediate, navigate to the OCI Console, select the Autonomous Database, and update the network settings to ensure the TLS version is set to 1.2 or higher. Regular audits should be performed to ensure compliance with security policies.
  references:
  - https://docs.oracle.com/en/cloud/paas/autonomous-database/index.html
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/index.html
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.database.autonomous_database.dr_job_logs_enabled
  service: database
  resource: autonomous_database
  requirement: DR Job Logs Enabled
  scope: database.autonomous_database.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable DR Job Logs for Autonomous Databases
  rationale: Enabling DR job logs for Autonomous Databases ensures visibility into disaster recovery operations, which is critical for identifying issues, auditing actions, and maintaining compliance with data protection regulations. Without proper logging, organizations face increased risk of undetected data integrity issues and potential non-compliance with standards such as GDPR and PCI-DSS.
  description: This rule verifies that logging is enabled for disaster recovery (DR) jobs in Autonomous Databases on OCI. DR job logs capture detailed information about recovery operations, which is crucial for troubleshooting and auditing purposes. To ensure these logs are enabled, navigate to the OCI console, access the Autonomous Database settings, and confirm that the 'DR Job Logging' option is active. If not, enable it to ensure comprehensive monitoring of recovery activities. Regularly review logs to detect anomalies and verify successful DR operations.
  references:
  - https://docs.oracle.com/en/cloud/paas/autonomous-database/index.html
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark.html
  - https://www.nist.gov/document/sp800-53r5pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.gdpreu.org/the-regulation/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_recommendations.htm
- rule_id: oci.database.autonomous_database.dr_job_network_private_only_enforced
  service: database
  resource: autonomous_database
  requirement: DR Job Network Private Only Enforced
  scope: database.autonomous_database.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure DR Jobs Use Private Network in Autonomous Databases
  rationale: Restricting Autonomous Database Disaster Recovery (DR) jobs to use private networks helps protect sensitive data from being exposed to public internet traffic, reducing the risk of unauthorized access and data breaches. This control supports compliance with industry standards and regulations that mandate strict data protection and privacy measures, such as PCI-DSS and GDPR.
  description: This rule checks whether the Disaster Recovery (DR) jobs for Autonomous Databases are configured to use only private network endpoints. To verify, ensure the network access setting for DR jobs is set to 'Private Only', which limits connectivity to secure, private endpoints. Remediation involves adjusting the Autonomous Database network settings to restrict DR job traffic to private networks, ensuring all access is routed securely within the Oracle Cloud Infrastructure.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networksecurity.htm
  - https://www.oracle.com/security/cloud-security/compliance/cis-benchmark/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
  - https://cloud.google.com/security/compliance/iso-27001
  - https://www.oracle.com/cloud/security-best-practices/
- rule_id: oci.database.autonomous_database.dr_job_roles_least_privilege_required
  service: database
  resource: autonomous_database
  requirement: DR Job Roles Least Privilege Required
  scope: database.autonomous_database.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Autonomous Database DR Roles
  rationale: Implementing least privilege in Disaster Recovery (DR) roles mitigates the risk of unauthorized data access and potential data breaches. It ensures that users have only the necessary permissions, reducing the attack surface and enhancing data protection. This control aligns with regulatory requirements such as GDPR and PCI-DSS, which mandate strict access controls.
  description: This rule checks that roles assigned to users for managing Autonomous Database Disaster Recovery (DR) operations follow the principle of least privilege. Review and configure IAM policies to ensure users have only the permissions essential for their DR tasks, such as database switchover or failover operations. Regularly audit these roles and adjust permissions to reflect any changes in roles or responsibilities. Use Oracle Cloud Infrastructure's IAM service to modify these policies and conduct periodic reviews to maintain compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/security-cloud/cis-oci-benchmark.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r3.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security-cloud/cloud-security.html#identity
- rule_id: oci.bds.bds_instance.cluster_admin_access_least_privilege_required
  service: bds
  resource: bds_instance
  requirement: Cluster Admin Access Least Privilege Required
  scope: bds.bds_instance.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure Least Privilege for OCI BDS Cluster Admin Access
  rationale: Limiting cluster admin access in OCI Big Data Service (BDS) minimizes the risk of unauthorized data access and potential misuse of cluster resources. Implementing least privilege access helps protect sensitive business data from insider threats and reduces attack surfaces. Proper access controls are crucial for meeting compliance requirements such as PCI-DSS and ISO 27001, which mandate stringent user access management.
  description: This rule checks that only essential users have cluster admin privileges on OCI BDS instances. Review IAM policies to ensure they grant the minimal necessary permissions. Ensure that users with cluster admin roles are justified and regularly audited. To remediate, adjust IAM policies to restrict access and regularly review user permissions using OCI Identity and Access Management (IAM) service to verify adherence to the least privilege principle.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/bigdata/home.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/document_library
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.bds.bds_instance.cluster_audit_logging_enabled
  service: bds
  resource: bds_instance
  requirement: Cluster Audit Logging Enabled
  scope: bds.bds_instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Audit Logging for BDS Instances
  rationale: Enabling audit logging for Big Data Service (BDS) instances is critical for monitoring access and changes to cluster configurations, which helps in identifying unauthorized activities, ensuring data integrity, and meeting compliance requirements such as GDPR and ISO 27001. Without audit logging, organizations risk missing potential security incidents and failing to meet regulatory obligations, leading to financial and reputational damage.
  description: This rule checks whether audit logging is enabled for BDS instances in Oracle Cloud Infrastructure. Audit logging must be configured to capture all relevant events, including user access, configuration changes, and data access patterns. To verify, ensure that the logging service is activated and properly configured within the BDS instance settings. Remediation involves accessing the OCI Console, navigating to the BDS instance, and enabling the audit logging feature under the 'Logging' section.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/bigdata/home.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://cloudsecurityalliance.org/artifacts/oracle-cloud-infrastructure-security-best-practices/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam_audit.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.bds.bds_instance.cluster_encryption_cmek_enabled
  service: bds
  resource: bds_instance
  requirement: Cluster Encryption Cmek Enabled
  scope: bds.bds_instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable CMEK for BDS Cluster Encryption
  rationale: Enabling Customer Managed Encryption Keys (CMEK) for Big Data Service (BDS) clusters in OCI is critical to safeguard sensitive data against unauthorized access and potential breaches. It provides businesses with full control over their encryption keys, thereby enhancing data security and compliance with regulations like GDPR and CCPA, which mandate stringent data protection measures.
  description: This rule checks if BDS instances in OCI have cluster encryption enabled with Customer Managed Encryption Keys (CMEK). To verify, ensure that the BDS cluster's encryption settings in the OCI console use a customer-managed key from Oracle Cloud Infrastructure Vault. If not enabled, configure the BDS instance to use CMEK by creating a key in the OCI Vault and associating it with the BDS cluster. This ensures that all data at rest within the cluster is encrypted using keys you control.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/bigdata/encryptingyourdata.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/document/sp-800-57pt1r5pdf
  - https://www.oracle.com/security/cloud-security.html
  - https://cloud.oracle.com/en_US/security/compliance/pci-dss
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.bds.bds_instance.cluster_private_networking_enforced
  service: bds
  resource: bds_instance
  requirement: Cluster Private Networking Enforced
  scope: bds.bds_instance.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure BDS Instance Enforces Cluster Private Networking
  rationale: Enforcing private networking for BDS instances reduces the risk of unauthorized access and potential data breaches by ensuring that traffic remains within a secured and isolated network. This is crucial for maintaining the confidentiality and integrity of sensitive data processed within the cluster, complying with regulatory standards such as PCI-DSS and HIPAA that require stringent access controls.
  description: This rule checks if the BDS instances are configured to use private networking, ensuring that the cluster traffic is restricted to the private IP space and not exposed to the public internet. Verify this setting by checking the BDS instance network configuration for the 'isPrivateEndpoint' parameter set to true. Remediation involves modifying the BDS instance to enable private networking if it's not already configured, which can be done through the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/bigdata-cluster/Concepts/bds_overview.htm
  - CIS OCI Benchmark - 3.5 Ensure Private Networking is Enabled for BDS
  - https://www.pcisecuritystandards.org/
  - https://www.hipaajournal.com/hipaa-compliance-guide/
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
- rule_id: oci.bds.bds_instance.cluster_tls_min_1_2_enforced
  service: bds
  resource: bds_instance
  requirement: Cluster TLS Min 1 2 Enforced
  scope: bds.bds_instance.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure TLS 1.2 or Higher for BDS Cluster Communication
  rationale: Enforcing TLS 1.2 or higher for your Big Data Service (BDS) clusters is critical to protect data integrity and confidentiality during transit. Weak encryption protocols can expose sensitive data to interception and unauthorized access, posing significant security threats and potential compliance failures under standards like PCI-DSS and HIPAA.
  description: This rule checks whether the Big Data Service instances enforce a minimum of TLS 1.2 for network communications within the cluster. Ensure that cluster configurations are set to use TLS 1.2 or above by navigating to the OCI Console, selecting the BDS instance, and reviewing the security settings. If the setting is not compliant, modify the cluster configuration to enforce TLS 1.2 or higher, ensuring robust encryption for data in transit.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/bigdata/security.htm
  - https://oci-cis-benchmark.com/3.0.0/controls/control-7.3
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hipaajournal.com/hipaa-encryption-requirements/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-52r1.pdf
- rule_id: oci.block_storage.volume_backup.backup_destination_private_only_enforced
  service: block_storage
  resource: volume_backup
  requirement: Backup Destination Private Only Enforced
  scope: block_storage.volume_backup.backup_recovery
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Restrict Backup Destination to Private Networks for Volume Backups
  rationale: Enforcing backups to private network destinations enhances data confidentiality by preventing unauthorized access over the public internet. This reduces exposure to potential data breaches and aligns with security best practices and regulatory standards such as PCI-DSS and HIPAA, which require robust data protection measures. Ensuring backups are on private endpoints mitigates the risk of data exfiltration during transfer.
  description: This rule checks whether Oracle Cloud Infrastructure block storage volume backups are configured to use private IP addresses for their destination endpoints. To verify, ensure that backup policies specify private endpoints, which can be done through the OCI Console under Block Volumes by selecting 'Backup Policies' and checking the destination settings. Remediation involves configuring backup destinations to use private IPs only, ensuring that access is restricted to within your VCN using security lists or network security groups. This helps maintain secure data transfer and storage practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/backingupyourdata.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org
  - https://www.hhs.gov/hipaa/for-professionals/index.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/securityconfig.htm
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
- rule_id: oci.block_storage.volume.backup_encrypted_at_rest_cmek
  service: block_storage
  resource: volume
  requirement: Backup Encrypted At Rest Cmek
  scope: block_storage.volume.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Block Storage Backups Use CMEK for Encryption at Rest
  rationale: Encrypting backups using Customer-Managed Encryption Keys (CMEK) enhances data protection by allowing organizations to control and manage their encryption keys. This reduces the risk of unauthorized data access and supports compliance with regulatory requirements such as GDPR and HIPAA, which mandate strong data protection measures. Failure to use CMEK could result in potential data breaches and non-compliance penalties.
  description: This rule checks that all block storage volume backups are encrypted at rest using CMEK. It requires configuring backups to utilize your own encryption keys stored in Oracle Cloud Infrastructure Vault. To verify, ensure that your block storage volumes have backup policies that specify encryption with CMEK. Remediation involves setting up or updating your backup configuration to use CMEK by creating a vault and keys in OCI Vault, then applying these keys to your block storage backups.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/encryptingvolumes.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/OCI_CIS_Benchmark_v1.1.0.pdf
  - https://www.nist.gov/itl/applied-cybersecurity/nist-security-framework
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/index.html
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.block_storage.volume.backup_immutable_or_worm_enabled
  service: block_storage
  resource: volume
  requirement: Backup Immutable Or Worm Enabled
  scope: block_storage.volume.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: medium
  title: Enable Immutable or WORM Backups for Block Storage Volumes
  rationale: Enabling immutable or Write-Once-Read-Many (WORM) backups for block storage volumes mitigates the risk of data tampering and unauthorized deletion, ensuring data integrity and compliance with data protection regulations. This is crucial for protecting sensitive data from ransomware attacks and accidental alterations, thereby maintaining trust and compliance with frameworks such as PCI-DSS and HIPAA.
  description: This rule evaluates whether block storage volumes have immutable or WORM backups enabled in OCI. Verification involves checking the backup policy settings for immutability or WORM compliance. To remediate, configure backup policies in OCI to enable the immutable or WORM feature, ensuring backups cannot be altered or deleted for a specified period. This configuration helps safeguard data integrity and supports compliance with regulatory requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/creatingbackups.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-benchmark.html
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/index.html
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.block_storage.volume_backup.backup_schedule_defined_min_frequency_required
  service: block_storage
  resource: volume_backup
  requirement: Backup Schedule Defined Min Frequency Required
  scope: block_storage.volume_backup.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: medium
  title: Ensure Minimum Backup Schedule Frequency for Block Storage
  rationale: Defining a minimum backup schedule frequency for block storage volumes is crucial to ensure data availability and integrity in Oracle Cloud Infrastructure. Regular backups mitigate the risk of data loss due to accidental deletion, corruption, or hardware failures. This practice aligns with compliance requirements such as ISO 27001 and PCI-DSS, which mandate data protection mechanisms to safeguard sensitive information.
  description: This rule checks that all block storage volumes in OCI have a defined backup schedule with at least a weekly frequency. To verify, ensure that backup policies are applied to each block volume and that the schedule is configured for a minimum of once per week. Remediation involves creating or updating backup policies in the OCI Console to meet this frequency requirement, ensuring that all critical data is regularly backed up and recoverable.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/backingupavolume.htm
  - https://www.oracle.com/security/cloud-security/compliance/cis-benchmarks.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.block_storage.volume.snapshot_cross_region_copy_encrypted
  service: block_storage
  resource: volume
  requirement: Snapshot Cross Region Copy Encrypted
  scope: block_storage.volume.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Cross-Region Snapshot Copies are Encrypted
  rationale: Encrypting snapshots during cross-region copies is crucial for protecting sensitive data from unauthorized access and potential data breaches during transit. It mitigates risks associated with data interception and ensures compliance with regulations such as PCI-DSS and HIPAA, which mandate robust data protection measures across distributed environments.
  description: This rule checks that all block storage volume snapshots copied across OCI regions are encrypted. Verify that the 'Encrypt' option is enabled for snapshots during the copy process, ensuring data privacy and integrity. To remediate, configure the snapshot copy settings to use encryption by default, leveraging OCI's built-in encryption capabilities with customer-managed keys (CMKs) for enhanced security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/managingvolumes.htm#crossregion
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/index.html
  - https://cloud.oracle.com/storage/block-volume/features
- rule_id: oci.block_storage.volume.snapshot_encrypted
  service: block_storage
  resource: volume
  requirement: Snapshot Encrypted
  scope: block_storage.volume.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Block Storage Volume Snapshots Are Encrypted
  rationale: Encrypting snapshot data at rest is critical to prevent unauthorized access to sensitive information, especially in the event of a data breach. It mitigates risks associated with data leakage and is often a regulatory requirement under frameworks like PCI-DSS and HIPAA, which mandate robust data protection measures.
  description: This rule checks that all block storage volume snapshots are encrypted using OCI's built-in encryption at rest feature. Users should verify that snapshots are automatically encrypted with the Oracle-managed keys or their own customer-managed keys (CMK). Remediation involves enabling encryption on existing volumes and ensuring that all new snapshots inherit the encryption settings. This can be managed via the OCI Console or using the CLI to enforce encryption settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/encryptingvolumesandsnapshots.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.block_storage.volume_backup.snapshot_not_public_blocked
  service: block_storage
  resource: volume_backup
  requirement: Snapshot Not Public Blocked
  scope: block_storage.volume_backup.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: critical
  title: Prevent Public Access to Volume Backup Snapshots
  rationale: Exposing volume backup snapshots to the public can lead to unauthorized access to sensitive data, resulting in data breaches and non-compliance with regulations such as PCI-DSS and GDPR. Limiting access to these snapshots is crucial to protect against data exfiltration and ensure that only authorized users can access sensitive information.
  description: This rule checks that volume backup snapshots in Oracle Cloud Infrastructure are not publicly accessible. By default, OCI block storage volume backups should be private to prevent unauthorized access. To verify, ensure that no public IP addresses or unrestricted access policies are associated with your snapshots. Remediate by reviewing and updating IAM policies to restrict access and ensure snapshots are not publicly exposed.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/blockvolumebackups.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2_SA_DSS_Requirements_and_Security_Assessment_Procedures.pdf
  - https://www.nist.gov/document-4423
  - https://www.oracle.com/security/cloud-security.html
- rule_id: oci.block_storage.volume.replication_auth_roles_least_privilege_required
  service: block_storage
  resource: volume
  requirement: Replication Auth Roles Least Privilege Required
  scope: block_storage.volume.replication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Volume Replication Auth Roles
  rationale: Implementing least privilege for replication authentication roles in OCI Block Storage reduces the risk of unauthorized access and potential data breaches. Unauthorized access can lead to data corruption, exfiltration, and compliance violations, especially in environments subject to regulations such as GDPR or PCI-DSS. Adopting least privilege principles helps align with security frameworks and minimizes the attack surface.
  description: This rule checks that roles assigned for volume replication in OCI Block Storage are granted only the necessary permissions to perform their tasks. Specifically, it verifies that roles do not have excessive privileges that exceed the requirements for replication operations. To remediate, review and adjust IAM policies to ensure they align with the least privilege principle. Use the OCI Console or CLI to audit role permissions and modify them as needed to comply with best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_iam_bestpractices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.block_storage.volume.replication_cross_region_encrypted
  service: block_storage
  resource: volume
  requirement: Replication Cross Region Encrypted
  scope: block_storage.volume.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Cross-Region Volume Replication is Encrypted
  rationale: Encrypting cross-region replicated block storage volumes is crucial to protect sensitive data from unauthorized access during transit. This practice mitigates risks like data breaches and eavesdropping, aligning with compliance requirements such as GDPR, HIPAA, and PCI-DSS, which mandate robust encryption for data protection. It also helps maintain business integrity by ensuring that data remains confidential and secure across different geographical locations.
  description: This rule checks whether block storage volumes being replicated across regions in OCI have encryption enabled. To verify, navigate to the OCI console, select 'Block Storage', and review the replication settings for each volume to ensure 'Encrypt in Transit' is enabled. Remediation involves updating the replication configuration to enable encryption if it is not already active. By doing so, you safeguard data against unauthorized access during inter-region data transfer.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/managingvolumes.htm#replication
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-foundations-benchmark.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/standard/54534.html
  - https://www.oracle.com/cloud/security/
- rule_id: oci.block_storage.volume.replication_tls_required
  service: block_storage
  resource: volume
  requirement: Replication TLS Required
  scope: block_storage.volume.replication
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure TLS is Enabled for Block Storage Volume Replication
  rationale: Enabling TLS for block storage volume replication in OCI is critical to protect data in transit against interception and unauthorized access. Without TLS, replication traffic could be intercepted, leading to data breaches and non-compliance with data protection regulations such as PCI-DSS and HIPAA. Ensuring TLS is enabled helps maintain data integrity and confidentiality during replication processes.
  description: This rule checks whether TLS is enabled for the replication of block storage volumes within OCI. TLS encrypts data in transit, safeguarding it from potential interception. To verify, ensure that the replication configuration specifies TLS as a requirement. Remediate by updating the replication settings to enforce TLS, following OCI's guidelines for configuring secure replication. Regular audits should be performed to ensure ongoing compliance with this security measure.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/usingvolumegroupreplication.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.block_storage.volume.replication_lag_monitoring_alerts_enabled
  service: block_storage
  resource: volume
  requirement: Replication Lag Monitoring Alerts Enabled
  scope: block_storage.volume.monitoring
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Replication Lag Alerts for Block Storage Volumes
  rationale: Monitoring replication lag in block storage volumes is crucial for maintaining data availability and integrity. Without timely alerts, businesses risk data loss or inconsistency, especially in disaster recovery scenarios. Ensuring alerts are enabled helps meet compliance requirements for data protection standards such as ISO 27001 and PCI-DSS.
  description: This rule checks whether monitoring alerts are configured for replication lag in OCI block storage volumes. Specifically, it verifies that alerts are set up in the Monitoring service to notify administrators when replication lag exceeds defined thresholds. To remediate, create an alarm in the OCI Monitoring service targeting the replication lag metric of the block storage volume and set it to trigger notifications. This ensures that potential issues are promptly addressed, maintaining data consistency and compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/monitoringblockstorage.htm
  - https://www.oracle.com/security/cspm-compliance/
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v4/
  - https://www.pcisecuritystandards.org/
- rule_id: oci.object_storage.bucket.bucket_policy_deny_insecure_transport
  service: object_storage
  resource: bucket
  requirement: Bucket Policy Deny Insecure Transport
  scope: object_storage.bucket.policy_management
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure Object Storage Buckets Deny Insecure Transport
  rationale: Allowing insecure transport to access object storage buckets can expose sensitive data to potential interception and unauthorized access. This increases the risk of data breaches and non-compliance with security standards such as PCI-DSS and HIPAA, impacting business reputation and incurring regulatory fines.
  description: This rule checks if object storage buckets have policies that deny insecure transport methods, such as HTTP. To verify, ensure that bucket policies enforce HTTPS for data in transit. Remediation involves updating the bucket's policy to include a statement that denies any requests not using secure transport protocols. This can be done using OCI's console or CLI tools.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/bestpractices-objectstorage.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/for-professionals/security/guidance/index.html
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.object_storage.bucket.bucket_policy_deny_unencrypted_puts
  service: object_storage
  resource: bucket
  requirement: Bucket Policy Deny Unencrypted Puts
  scope: object_storage.bucket.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enforce Encryption for Object Storage PUT Requests
  rationale: Ensuring that all data uploaded to Object Storage buckets is encrypted protects sensitive information from unauthorized access and aligns with data protection regulations such as GDPR and CCPA. Unencrypted data can lead to data breaches, which may result in financial loss, reputational damage, and legal penalties.
  description: This rule checks if bucket policies in Oracle Cloud Infrastructure's Object Storage are configured to deny PUT requests unless the data is encrypted. To verify, ensure that the bucket policy includes a statement that denies unencrypted uploads by checking for the 'kmsKey' condition in the policy. Remediation involves updating the bucket policy to enforce encryption by specifying a 'kmsKey' for all PUT operations, ensuring compliance with security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingbuckets.htm#bucket_policies
  - https://www.oracle.com/security/cloud-security/compliance/cis-benchmark/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.object_storage.bucket.bucket_policy_no_public_principals_blocked
  service: object_storage
  resource: bucket
  requirement: Bucket Policy No Public Principals Blocked
  scope: object_storage.bucket.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Public Access in OCI Object Storage Buckets
  rationale: Public access to Object Storage buckets can lead to unauthorized data exposure, increasing the risk of data breaches, data leakage, and non-compliance with regulatory standards like GDPR, PCI-DSS, and HIPAA. Ensuring that object storage buckets are not publicly accessible protects sensitive data and maintains the integrity of business operations by preventing unauthorized access.
  description: This rule checks for Object Storage bucket policies that allow public access, which is a critical security risk. To verify, review the bucket policy settings in the OCI console and ensure no policies grant access to public principals. Remediate by adjusting the bucket's access policy to restrict access only to specific, authorized users and groups. Consider leveraging Oracle Cloud Infrastructure Identity and Access Management (IAM) to define and enforce fine-grained access controls.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/
  - https://www.hipaajournal.com/hipaa-compliance-guide/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm
- rule_id: oci.object_storage.bucket.bucket_policy_no_wildcards_on_actions_or_principals
  service: object_storage
  resource: bucket
  requirement: Bucket Policy No Wildcards On Actions Or Principals
  scope: object_storage.bucket.policy_management
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Restrict Wildcards in OCI Object Storage Bucket Policies
  rationale: Using wildcards in bucket policies can lead to unintended data exposure and unauthorized access by allowing overly permissive actions or principals. This poses significant risks such as data breaches, loss of data integrity, and violation of compliance obligations like PCI-DSS and ISO 27001. Tightening policies enhances security by ensuring only intended actions are granted to specific users or groups.
  description: This rule checks OCI Object Storage bucket policies to ensure no wildcards are used in defining actions or principals. Wildcards can lead to broad access permissions, making it crucial to specify exact actions and users to minimize security risks. To verify, review the bucket policy configuration and eliminate any wildcard entries. Remediation involves updating policies to specify exact IAM users, groups, or service principals and the precise actions they are allowed to perform.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#BucketPolicy
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_catalog.catalog.classifier_definition_version_pinned_required
  service: data_catalog
  resource: catalog
  requirement: Classifier Definition Version Pinned Required
  scope: data_catalog.catalog.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Pin Classifier Definition Version in OCI Data Catalog
  rationale: Pinning classifier definition versions in OCI Data Catalog is crucial to maintain consistent data classification and prevent unauthorized changes that could lead to data leakage or misclassification. This practice reduces the risk of human error and ensures compliance with data protection regulations like GDPR and CCPA by maintaining a stable classification environment.
  description: This rule checks if the classifier definition versions in OCI Data Catalog are pinned to a specific version. It ensures that classifiers do not inadvertently update to new versions without proper testing and validation. To verify, review the classifier settings in the Data Catalog to ensure each classifier version is explicitly specified. Remediation involves editing the classifier settings to pin the version, preventing automatic updates.
  references:
  - https://docs.oracle.com/en-us/iaas/data-catalog/doc/using-data-catalog.html
  - https://www.oracle.com/security/cis-benchmarks/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.data_catalog.catalog.classifier_rbac_least_privilege_required
  service: data_catalog
  resource: catalog
  requirement: Classifier RBAC Least Privilege Required
  scope: data_catalog.catalog.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Data Catalog Classifiers
  rationale: Inappropriate permissions on data catalog classifiers can lead to unauthorized data access and potential data breaches, affecting business integrity and compliance with regulations like GDPR and CCPA. Limiting permissions to the minimum necessary reduces the attack surface and mitigates risks associated with credential compromise.
  description: This rule checks that IAM policies grant only the necessary permissions to users managing data catalog classifiers. Verify that roles assigned are appropriate for users' job functions, and consider creating custom policies that restrict actions to the minimum required. Regularly review and audit permissions to maintain least privilege adherence and employ dynamic groups for better policy management.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingdynamicgroups.htm
  - https://www.oracle.com/security/cloud-security/cloud-infrastructure-security.html
- rule_id: oci.data_catalog.catalog.classifier_source_trusted
  service: data_catalog
  resource: catalog
  requirement: Classifier Source Trusted
  scope: data_catalog.catalog.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Classifier Source is from Trusted Locations
  rationale: Trusted classifier sources in OCI Data Catalog help prevent unauthorized data access and potential data breaches. Ensuring classifiers are sourced from trusted locations mitigates risks associated with data leakage and unauthorized data manipulation, which could lead to significant business losses and non-compliance with data protection regulations such as GDPR and CCPA.
  description: This rule checks if the OCI Data Catalog's classifiers are sourced from locations that are designated as trusted. To verify compliance, review the classifiers' configuration in the Data Catalog and ensure they are only sourced from IP addresses or domains that are part of your organization's trusted network. If non-compliant, update the source settings to restrict access to these trusted locations. Utilize OCI's built-in security features like Network Security Groups (NSGs) and Security Lists to enforce IP restrictions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_oci.htm
  - https://www.oracle.com/security/cloud-security/cspm/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_catalog.catalog.data_quality_logs_enabled
  service: data_catalog
  resource: catalog
  requirement: Data Quality Logs Enabled
  scope: data_catalog.catalog.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Data Quality Logs for OCI Data Catalog
  rationale: Enabling data quality logs in OCI Data Catalog is crucial for monitoring and auditing data integrity processes. This ensures that any anomalies or discrepancies in data are promptly identified and addressed, thereby reducing the risk of data corruption or loss. It also supports compliance with data governance standards by maintaining a clear audit trail of data quality assessments.
  description: This rule checks whether data quality logging is enabled for OCI Data Catalog resources. By default, data quality logs provide detailed insights into the data transformation and validation processes, allowing for the detection of errors and inconsistencies. To verify compliance, ensure that logging is enabled in the OCI Console under the Data Catalog service by navigating to the Logging section and activating Data Quality Logs. Remediation involves configuring the logging service to capture and store these logs for ongoing monitoring and audit purposes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - CIS OCI Foundations Benchmark (if available)
  - NIST SP 800-53 Rev. 5
  - ISO 27001:2013
- rule_id: oci.data_catalog.catalog.data_quality_output_location_private_and_encrypted
  service: data_catalog
  resource: catalog
  requirement: Data Quality Output Location Private And Encrypted
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Quality Outputs Are Private and Encrypted
  rationale: Ensuring that data quality outputs in Oracle Cloud Infrastructure's Data Catalog are private and encrypted helps protect sensitive data from unauthorized access and potential breaches. This is crucial for maintaining the integrity and confidentiality of data, especially for organizations that must comply with regulatory requirements such as GDPR, HIPAA, and PCI-DSS. Failure to secure these outputs could lead to data leaks, financial loss, and reputational damage.
  description: This rule checks that the data quality output location within OCI Data Catalog is configured to be both private and encrypted. The system should ensure that Object Storage buckets used for data quality outputs have encryption enabled and are not publicly accessible. Verification involves checking the bucket settings in the OCI console for encryption status and access policies. To remediate issues, enable server-side encryption in Object Storage and set appropriate access policies to restrict public access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingobjectencryption.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/document_library
- rule_id: oci.data_catalog.catalog.data_quality_role_least_privilege_required
  service: data_catalog
  resource: catalog
  requirement: Data Quality Role Least Privilege Required
  scope: data_catalog.catalog.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Data Quality Roles in OCI Data Catalog
  rationale: Implementing least privilege for data quality roles in OCI Data Catalog minimizes the risk of unauthorized access and potential data breaches. This is crucial for protecting sensitive data assets and ensuring that only authorized users can perform data quality operations, aligning with regulatory requirements like GDPR and CCPA.
  description: This rule checks that roles assigned to users or groups for data quality tasks in OCI Data Catalog have the minimum necessary permissions. To verify, review IAM policies and ensure they are scoped only to necessary actions for data quality assessment. Remediation involves adjusting policies to restrict permissions, employing OCI's policy conditions and compartments to enforce access boundaries.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - CIS OCI Foundations Benchmark v1.1.0 - Identity and Access Management
  - NIST SP 800-53 Rev. 5 - Access Control (AC)
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.data_catalog.catalog.job_logs_and_metrics_enabled
  service: data_catalog
  resource: catalog
  requirement: Job Logs And Metrics Enabled
  scope: data_catalog.catalog.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Data Catalog Job Logs and Metrics are Enabled
  rationale: Enabling job logs and metrics for OCI Data Catalog is crucial for maintaining visibility into data operations and ensuring accountability. This helps in identifying anomalies, optimizing performance, and meeting compliance requirements such as GDPR and ISO 27001, which mandate detailed auditing of data handling processes. Failure to enable these features could result in undetected data mishandling or breaches, impacting business reputation and incurring regulatory penalties.
  description: This rule checks that logging and metrics are enabled for all jobs within the OCI Data Catalog. To verify, navigate to the Data Catalog service, select the desired catalog, and ensure that job logs and metrics are enabled in the configuration settings. Remediation involves accessing the OCI Console, going to the Data Catalog section, and enabling the necessary logging and metrics options. This configuration assists in monitoring job statuses and performance metrics, providing a trail of activities for audit purposes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.iso.org/iso-27001-information-security.html
  - https://gdpr-info.eu/
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
- rule_id: oci.data_catalog.job.job_network_private_only_enforced
  service: data_catalog
  resource: job
  requirement: Job Network Private Only Enforced
  scope: data_catalog.job.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Data Catalog Job Network is Private Only
  rationale: Restricting Data Catalog jobs to private networks reduces exposure to potential unauthorized access and data breaches. By enforcing private network-only access, organizations mitigate risks associated with public internet exposure, aligning with best practices for protecting sensitive data and maintaining compliance with regulations such as GDPR and PCI-DSS.
  description: This rule checks if Data Catalog jobs are configured to run exclusively within private networks, preventing public internet exposure. To verify, ensure that the network settings for Data Catalog jobs are set to private-only within the OCI console. Remediation involves configuring the job's network parameters to use a Virtual Cloud Network (VCN) with appropriate security lists and route tables that restrict external access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://www.oracle.com/cloud/networking/
- rule_id: oci.data_catalog.job.job_role_least_privilege_required
  service: data_catalog
  resource: job
  requirement: Job Role Least Privilege Required
  scope: data_catalog.job.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Data Catalog Job Roles
  rationale: Ensuring least privilege for Data Catalog job roles minimizes the risk of unauthorized access and potential data breaches. Over-privileged roles can lead to unintentional data exposure and increase the attack surface within an organization, making it susceptible to insider threats and non-compliance with regulatory standards such as GDPR and HIPAA.
  description: This rule verifies that job roles associated with Oracle Cloud Infrastructure Data Catalog jobs adhere to the principle of least privilege. It checks the permissions granted to the roles to ensure they are restricted to only what is necessary to perform their intended functions. To remediate, review and adjust the roles assigned to Data Catalog jobs by removing any excessive permissions, utilizing OCI IAM policies to enforce stricter access controls, and regularly auditing role permissions for compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.data_catalog.catalog.job_script_location_private_and_encrypted
  service: data_catalog
  resource: catalog
  requirement: Job Script Location Private And Encrypted
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Catalog Job Script Location is Private & Encrypted
  rationale: Storing job scripts in a non-private or unencrypted manner can expose sensitive data to unauthorized access, leading to potential data breaches. This practice may also violate compliance with data protection regulations such as GDPR or CCPA, which mandate the protection of personal data. Ensuring scripts are private and encrypted mitigates the risk of unauthorized data access and enhances data privacy.
  description: This rule verifies that Oracle Cloud Infrastructure Data Catalog job scripts are stored in a location that is both private and encrypted. This involves checking that the object storage bucket used for storing these scripts has the 'private' visibility setting and is encrypted using Oracle-managed keys or customer-managed keys. To remediate, ensure that the bucket is configured with appropriate access policies and encryption settings by navigating to the OCI Object Storage service, selecting the correct bucket, and setting the 'Bucket Visibility' to 'Private' while enabling 'Encryption' with the desired key management option.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-1-0-0-benchmarks.htm
  - https://www.nist.gov/document/sp800-53r5pdf
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.data_catalog.catalog.crawler_logs_enabled
  service: data_catalog
  resource: catalog
  requirement: Crawler Logs Enabled
  scope: data_catalog.catalog.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Crawler Logs Are Enabled in Data Catalog
  rationale: Enabling crawler logs in OCI Data Catalog helps organizations maintain transparency over data operations and mitigates risks associated with unauthorized data access or changes. This practice supports incident response efforts by providing detailed records of crawler activities, which can be critical in forensic investigations and compliance audits. Maintaining comprehensive logs is essential for meeting various regulatory requirements and enhancing the security posture of the data catalog environment.
  description: This rule checks if crawler logs are enabled for catalogs within OCI Data Catalog. Enabling logs is a key step in monitoring and auditing data crawling activities, ensuring that any anomalies or unauthorized actions can be detected and addressed promptly. To verify this setting, navigate to the Data Catalog service in the OCI Console, select the relevant catalog, and confirm that logging is activated under the crawler settings. If logging is not enabled, update the catalog configuration to activate crawler logs, ensuring logs are stored securely and retained according to your organization's policy.
  references:
  - https://docs.oracle.com/en-us/iaas/data-catalog/doc/data-catalog-overview.html
  - https://docs.oracle.com/en-us/iaas/Content/security/Reference/secure-log-data.htm
  - CIS Oracle Cloud Infrastructure Foundations Benchmark
  - 'NIST SP 800-53: Security and Privacy Controls for Information Systems and Organizations'
  - ISO/IEC 27001:2013 Information Security Management
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
- rule_id: oci.data_catalog.catalog.crawler_network_private_only_enforced
  service: data_catalog
  resource: catalog
  requirement: Crawler Network Private Only Enforced
  scope: data_catalog.catalog.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Data Catalog Crawlers are Private Network Only
  rationale: Restricting data catalog crawlers to private networks reduces exposure to potential threats from the public internet, thus mitigating risks such as data breaches and unauthorized access. This practice is crucial for maintaining the confidentiality and integrity of sensitive data assets, supporting compliance with regulations like GDPR and HIPAA that require strict data access controls.
  description: This rule checks if data catalog crawlers are configured to operate exclusively within private networks on Oracle Cloud Infrastructure. To verify, ensure that the crawler's network configuration in the OCI Console is set to a VCN with no internet gateway. Remediation involves using private subnets and security lists that restrict inbound and outbound traffic to known IP addresses. Leveraging security groups can provide additional layer of control.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Tasks/working_with_crawlers.htm
  - https://www.oracle.com/security/cloud-security/oci-security/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
- rule_id: oci.data_catalog.catalog.crawler_role_least_privilege_required
  service: data_catalog
  resource: catalog
  requirement: Crawler Role Least Privilege Required
  scope: data_catalog.catalog.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Crawler Role Uses Least Privilege in Data Catalog
  rationale: Implementing least privilege for crawler roles minimizes the risk of unauthorized data access or modifications, reducing potential attack vectors and ensuring compliance with security standards like NIST and PCI-DSS. This approach helps prevent privilege escalation and data breaches that could lead to financial loss and reputational damage.
  description: This rule checks whether the roles assigned to data catalog crawlers have only the necessary permissions required for their function. Verify that crawler roles do not have excessive permissions by reviewing the attached policies and adjusting them to limit access strictly to what is needed for catalog operations. Remediation involves creating custom policies that explicitly define the minimum required permissions for data access and operational tasks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://www.oracle.com/security/cis-oracle-cloud-infrastructure-benchmark-v1-1.pdf
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.data_catalog.catalog.crawler_scope_restricted_to_allowlist
  service: data_catalog
  resource: catalog
  requirement: Crawler Scope Restricted To Allowlist
  scope: data_catalog.catalog.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Restrict Crawler Scope to Allowlist for Data Catalog Security
  rationale: Restricting the crawler scope within the OCI Data Catalog to an allowlist minimizes the risk of unauthorized data access and exposure. This practice ensures that only approved data sources are scanned, reducing the potential for data breaches and aligning with compliance requirements for data protection, such as GDPR and CCPA.
  description: This rule checks if the OCI Data Catalog crawler's scope is limited to an allowlist of approved data sources. Users should configure the crawler to only access specific data resources that have been explicitly allowed, preventing unauthorized data discovery. To verify, review the crawler settings in the Data Catalog and ensure the allowlist is correctly configured. Remediation involves updating the crawler's configuration to include only trusted and necessary data sources in the allowlist.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Tasks/crawler.htm
  - https://www.oracle.com/security/cloud-security/
  - https://www.nist.gov/cyberframework
  - https://gdpr.eu/
- rule_id: oci.data_catalog.connection.connection_credentials_in_secrets_manager
  service: data_catalog
  resource: connection
  requirement: Connection Credentials In Secrets Manager
  scope: data_catalog.connection.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure Connection Credentials are Stored in OCI Secrets Manager
  rationale: Storing connection credentials in OCI Secrets Manager minimizes the risk of unauthorized access by ensuring sensitive data is encrypted and managed securely. This approach reduces the likelihood of credential exposure through misconfigurations or breaches, thereby enhancing data protection and compliance with regulations like PCI-DSS and SOC2.
  description: This rule checks that all connection credentials within Oracle Cloud Infrastructure's Data Catalog are stored in OCI Secrets Manager. Credentials should not be hardcoded or stored in plaintext within application configurations. To verify, ensure that connection settings reference secrets stored in the Secrets Manager. Remediation involves migrating all plaintext credentials to Secrets Manager and updating connection settings to retrieve these securely stored secrets.
  references:
  - https://docs.oracle.com/en-us/iaas/data-catalog/doc/using-data-catalog.html
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Reference/OCI_CIS_Benchmark_v1.2.0.pdf
  - https://www.pcisecuritystandards.org/
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/sorhome.html
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v3-0-1/
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
- rule_id: oci.data_catalog.catalog.connection_private_networking_enforced
  service: data_catalog
  resource: catalog
  requirement: Connection Private Networking Enforced
  scope: data_catalog.catalog.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Enforce Private Networking for Data Catalog Connections
  rationale: Enforcing private networking for Data Catalog connections mitigates the risk of unauthorized access and data breaches by ensuring that connections remain within a secure, private network. This is crucial for protecting sensitive data stored in the catalog from threats such as man-in-the-middle attacks and unauthorized exposure to the internet, thereby maintaining compliance with data protection regulations such as GDPR and CCPA.
  description: This rule checks if Data Catalog connections are configured to use private networking only, preventing public internet exposure. To verify, ensure that all connections are routed through a Virtual Cloud Network (VCN) with appropriate security lists and Network Security Groups (NSGs) configured. Remediation involves setting up or modifying existing connections to use VCNs and ensuring that no public IPs are assigned. This setup guarantees that data flow remains within the trusted boundaries of your OCI tenancy.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Tasks/datacatalogoverview.htm
  - https://www.oracle.com/security-cloud/cis-oci-benchmark/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security-cloud/
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.oracle.com/cloud/compliance/
- rule_id: oci.data_catalog.connection.connection_role_least_privilege_required
  service: data_catalog
  resource: connection
  requirement: Connection Role Least Privilege Required
  scope: data_catalog.connection.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce Least Privilege for Data Catalog Connections
  rationale: Ensuring that connections in Oracle Cloud Infrastructure's Data Catalog service operate under the principle of least privilege minimizes the potential attack surface and limits the impact of compromised credentials. This approach reduces the risk of unauthorized data access and helps meet compliance standards such as NIST and ISO 27001 by enforcing stringent access controls.
  description: This rule checks that the roles associated with Data Catalog connections are configured to grant the minimum privileges necessary for their function. Administrators should periodically review and adjust roles and policies to ensure they adhere to the least privilege principle. Remediation involves analyzing current role permissions, removing unnecessary access rights, and using OCI's IAM policies to enforce stricter access controls.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.data_catalog.catalog.connection_tls_required
  service: data_catalog
  resource: catalog
  requirement: Connection TLS Required
  scope: data_catalog.catalog.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure TLS is Enabled for OCI Data Catalog Connections
  rationale: Requiring TLS for data catalog connections is critical for protecting sensitive information from interception and tampering during transit. Failure to enforce TLS can lead to unauthorized data access, which poses significant risks to data integrity and privacy, and may result in non-compliance with regulatory standards such as GDPR and HIPAA.
  description: This rule checks whether TLS is enabled for all connections to the Oracle Cloud Infrastructure Data Catalog service. TLS, or Transport Layer Security, encrypts data in transit, ensuring that sensitive metadata and data lineage information remain confidential. To verify, inspect the data catalog's connection settings and confirm that TLS is enforced. If TLS is not enabled, update the connection configuration settings to require TLS, ensuring all endpoints are secured.
  references:
  - https://docs.oracle.com/en-us/iaas/data-catalog/doc/security-and-compliance.html
  - CIS Oracle Cloud Infrastructure Foundations Benchmark
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
  - https://www.hipaajournal.com/hipaa-compliance-guide/
- rule_id: oci.data_catalog.catalog.registry_cross_account_sharing_restricted
  service: data_catalog
  resource: catalog
  requirement: Registry Cross Account Sharing Restricted
  scope: data_catalog.catalog.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Restrict Cross-Account Sharing in Data Catalog
  rationale: Cross-account sharing of data catalogs can expose sensitive metadata to unauthorized entities, increasing the risk of data breaches and non-compliance with data protection regulations. Ensuring that data catalogs are not shared across accounts without strict controls helps protect organizational data and adheres to privacy laws such as GDPR and CCPA.
  description: This rule checks if Oracle Cloud Infrastructure Data Catalogs are shared with external accounts. To verify, ensure that no policies allow cross-account access unless necessary and approved. Remediation involves auditing current IAM policies and removing any that permit unauthorized access to the Data Catalog. Utilize OCI's Identity and Access Management (IAM) to enforce strict access controls and regularly review and update permissions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_catalog.catalog.registry_metadata_encryption_enabled
  service: data_catalog
  resource: catalog
  requirement: Registry Metadata Encryption Enabled
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure OCI Data Catalog Metadata Encryption at Rest
  rationale: Encrypting registry metadata is crucial to protecting sensitive business information from unauthorized access, especially if data is compromised due to a security breach. Encryption at rest mitigates the risk of data exposure and aids compliance with data protection regulations such as GDPR and CCPA, ensuring that sensitive information is not accessible in its raw form.
  description: This rule verifies that encryption is enabled for OCI Data Catalog registry metadata, ensuring that all metadata is stored securely using Oracle-managed keys. To check this, navigate to the Data Catalog service in the OCI Console, select the catalog, and confirm that encryption settings are configured. If not enabled, modify the catalog settings to use encryption by default, leveraging Oracle's built-in encryption capabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/data-catalog/doc/security-overview.html#encryption-at-rest
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://www.iso.org/standard/54534.html
- rule_id: oci.data_catalog.catalog.registry_rbac_least_privilege_required
  service: data_catalog
  resource: catalog
  requirement: Registry RBAC Least Privilege Required
  scope: data_catalog.catalog.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Data Catalog Registry Access
  rationale: Implementing least privilege access for Data Catalog registries minimizes the risk of unauthorized access, data breaches, and potential data leaks. It aligns with regulatory compliance requirements such as GDPR and PCI-DSS by ensuring only necessary permissions are granted to users. This approach reduces attack surfaces and limits potential damage from compromised accounts.
  description: This rule checks if the OCI Data Catalog registry has the appropriate role-based access control (RBAC) policies enforcing least privilege. Verify that users and groups are assigned only the permissions necessary to perform their job functions. Remediation involves auditing current IAM policies, removing excessive permissions, and regularly reviewing access logs to adjust policies as required. Use the OCI Console or CLI to inspect and modify IAM policies associated with the Data Catalog service.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/data-catalog/using/data-catalog-principals.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security.html
- rule_id: oci.data_catalog.catalog.rule_definition_version_pinned_required
  service: data_catalog
  resource: catalog
  requirement: Rule Definition Version Pinned Required
  scope: data_catalog.catalog.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Catalog Rule Definition Version is Pinned
  rationale: Pinning the rule definition version in the Data Catalog ensures consistent application of data governance policies and prevents inadvertent changes that could lead to data exposure or non-compliance with regulations. This helps mitigate the risk of unauthorized data access and maintains data integrity by enforcing a stable and predictable security posture.
  description: This rule checks if the rule definition version for the Data Catalog is pinned to a specific version, preventing unintended updates. To verify, ensure that each catalog has its rule definition version explicitly set. Remediation involves reviewing the catalog configurations and setting the 'version' attribute to a fixed number rather than 'latest', using the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/data-catalog/doc/catalogs.html
  - https://docs.oracle.com/en-us/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/data-catalog.html
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.data_catalog.catalog.rule_rbac_least_privilege_required
  service: data_catalog
  resource: catalog
  requirement: Rule RBAC Least Privilege Required
  scope: data_catalog.catalog.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Data Catalog RBAC Policies
  rationale: Enforcing the least privilege principle for RBAC in OCI Data Catalog minimizes the risk of unauthorized access and potential data breaches. Over-privileged accounts can lead to data leakage, non-compliance with data protection regulations, and increased attack surfaces. By ensuring that roles only have access permissions necessary for their tasks, organizations can better protect sensitive data and maintain compliance with standards such as ISO 27001 and NIST SP 800-53.
  description: This rule checks for adherence to the least privilege principle in RBAC policies for OCI Data Catalog resources. It evaluates if users and roles have been granted only the permissions necessary to perform their job functions. To verify compliance, review the policies assigned to each role and adjust them to ensure minimal access. Remediation involves auditing current permissions, consulting with data owners to understand access needs, and revising policies to restrict unnecessary privileges. Use OCI Identity and Access Management features to precisely define and enforce these policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/identity-and-access-management/
- rule_id: oci.data_catalog.catalog.rule_source_trusted
  service: data_catalog
  resource: catalog
  requirement: Rule Source Trusted
  scope: data_catalog.catalog.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Catalog Source is from Trusted Locations
  rationale: Allowing data catalog sources from untrusted locations can lead to data breaches, unauthorized access, and violation of data protection regulations. Ensuring sources are trusted protects sensitive information, supports compliance with standards like GDPR and CCPA, and reduces the risk of data leaks.
  description: This rule ensures that data catalog sources in OCI are configured to only accept data from trusted locations. To verify, review the data catalog settings to ensure that sources are restricted to approved IP addresses or networks. Remediation involves updating the data catalog configuration to include only trusted sources, utilizing OCI's network security features such as security lists or network security groups to enforce this restriction.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloud.oracle.com/en_US/data-catalog
- rule_id: oci.edge_services.distribution.origin_request_policy_forward_cookies_minimal
  service: edge_services
  resource: distribution
  requirement: Origin Request Policy Forward Cookies Minimal
  scope: edge_services.distribution.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Minimal Forwarding of Cookies in Origin Request Policy
  rationale: Forwarding unnecessary cookies in edge services can expose sensitive data and increase the attack surface by allowing potential attackers to exploit these cookies. Limiting cookie forwarding helps in reducing data leakage and aligns with privacy regulations such as GDPR and CCPA, thereby minimizing compliance risks and protecting user information.
  description: This rule checks if the origin request policy for edge service distributions is configured to forward only essential cookies. To verify, ensure that the policy specifies minimal cookie forwarding or uses a whitelist approach. Remediation involves updating the policy to limit cookie forwarding to only those necessary for application functionality, which can be done through the OCI Console under Edge Services Distributions settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CDN/Tasks/creatingdistribution.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/compliance/
- rule_id: oci.edge_services.distribution.origin_request_policy_forward_headers_minimal
  service: edge_services
  resource: distribution
  requirement: Origin Request Policy Forward Headers Minimal
  scope: edge_services.distribution.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Limit Forwarding Headers in Origin Requests for Edge Services
  rationale: Minimizing forwarded headers in origin requests reduces exposure to potential data leakage and ensures that only essential information is shared with origin servers. This limits the attack surface for man-in-the-middle attacks and helps maintain compliance with data protection standards such as GDPR and CCPA by adhering to the principle of least privilege.
  description: This rule checks if the origin request policy for edge services distributions is configured to forward only minimal headers. By default, unnecessary headers might expose sensitive information or enable undesired access. To verify compliance, inspect the distribution configuration within the OCI Console and ensure that the origin request policy is set to forward only essential headers. If non-essential headers are being forwarded, update the configuration to restrict them, thus enhancing security and minimizing risk.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Delivery/Concepts/distributionconfig.htm#origin_request_policy
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/standard/54534.html
  - https://cloudsecurityalliance.org/research/guidance/
- rule_id: oci.edge_services.distribution.origin_request_policy_forward_querystrings_minimal
  service: edge_services
  resource: distribution
  requirement: Origin Request Policy Forward Querystrings Minimal
  scope: edge_services.distribution.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Minimize Query String Forwarding in OCI Distribution
  rationale: Minimizing query strings forwarded to the origin can reduce the risk of exposing sensitive data in URLs, which could be intercepted by attackers. This practice also helps ensure that only necessary data is transmitted, aligning with compliance requirements such as GDPR and PCI-DSS, and reduces attack surfaces for injection attacks.
  description: This rule checks that the origin request policy for an OCI distribution is configured to forward the minimal set of query strings required for application functionality. To verify, review the distribution's origin request policy settings in the OCI console, ensuring that unnecessary query strings are not included. Remediate by adjusting the policy to only forward essential query strings, using the OCI CLI or console, to enhance security and performance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CDN/Tasks/cdnsettingrequestpolicy.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security-cloud/cloud-security-best-practices/
- rule_id: oci.edge_services.distribution.origin_request_policy_no_secret_headers_forwarded
  service: edge_services
  resource: distribution
  requirement: Origin Request Policy No Secret Headers Forwarded
  scope: edge_services.distribution.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Prohibit Forwarding of Secret Headers in Origin Requests
  rationale: Forwarding secret headers such as authentication tokens or API keys through the OCI edge distribution service can expose sensitive data to potential interception or misuse, leading to unauthorized access or data breaches. This practice is essential to maintain the confidentiality and integrity of sensitive information, align with regulatory standards such as PCI-DSS, and protect against man-in-the-middle attacks.
  description: This rule checks if any secret headers are being forwarded in the origin request policy of an OCI edge distribution. Secret headers should be explicitly excluded to prevent sensitive data from being inadvertently exposed to downstream systems. To verify, review the origin request policy settings in the OCI console and ensure that headers like 'Authorization' or 'Set-Cookie' are not included. Remediation involves modifying the policy to exclude such headers, thus ensuring that only non-sensitive information is passed to the origin.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/EdgeServices/Tasks/managingdistribution.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.waf.protection_rule.rule_has_effective_action_not_count_only
  service: waf
  resource: protection_rule
  requirement: Rule Has Effective Action Not Count Only
  scope: waf.protection_rule.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure WAF Protection Rules Have Effective Actions Beyond Counting
  rationale: WAF protection rules configured to only count incidents without taking action can lead to unmitigated threats. This configuration may expose the organization to risks such as data breaches and downtime, impacting business operations and violating compliance requirements like PCI-DSS, which mandates effective security controls.
  description: This rule checks if WAF protection rules are set to perform actions beyond just counting, such as blocking or redirecting malicious traffic. To verify, review your WAF policy settings in the OCI Console and ensure that protection rules have actions like 'block' or 'redirect' configured. Remediation involves updating the WAF rule settings to apply these actions, thereby enhancing the security posture by actively mitigating threats.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Concepts/wafoverview.htm
  - https://learn.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security-cloud/compliance/
- rule_id: oci.waf.protection_rule.rule_priority_unique_within_web_acl
  service: waf
  resource: protection_rule
  requirement: Rule Priority Unique Within Web ACL
  scope: waf.protection_rule.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Unique Rule Priorities in OCI WAF Web ACL
  rationale: Unique rule priorities within a Web Access Control List (Web ACL) are crucial to prevent unexpected behavior in traffic filtering and threat mitigation. Overlapping priorities can lead to rules being overridden, potentially allowing malicious traffic to pass through, risking data breaches and non-compliance with regulatory standards such as PCI-DSS and HIPAA.
  description: This rule checks that each protection rule within an Oracle Cloud Infrastructure (OCI) Web Application Firewall (WAF) Web ACL has a unique priority value. To verify, review the WAF configuration in the OCI Console and ensure no duplicate priorities exist. Remediation involves adjusting the rule priorities to ensure each one is distinct, thus maintaining the intended order of execution and effectiveness of security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/wafcreatingwebacl.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.waf.protection_rule.rule_references_valid_ip_or_regex_sets_only
  service: waf
  resource: protection_rule
  requirement: Rule References Valid Ip Or Regex Sets Only
  scope: waf.protection_rule.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: WAF Protection Rule Validity for IP or Regex Sets
  rationale: Ensuring that Web Application Firewall (WAF) protection rules reference valid IP or regex sets is crucial for maintaining accurate and effective traffic filtering. Invalid or misconfigured rules could lead to ineffective threat mitigation, potentially exposing web applications to malicious traffic, which may result in data breaches or service disruptions. Compliance with security standards often requires that security configurations are both effective and accurate.
  description: This rule verifies that all WAF protection rules reference valid IP address sets or regex patterns within Oracle Cloud Infrastructure (OCI). Valid configurations ensure that the WAF can accurately match and filter web traffic based on pre-defined security policies. Administrators should regularly audit these rules to confirm their validity, updating any that are found to be incorrect or outdated. Remediation involves correcting any invalid references to ensure proper rule execution and optimal security monitoring.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/wafprotection.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://www.oracle.com/security-cloud/cis-benchmark/
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.certificates.certificate.hsm_client_cert_key_length_minimum
  service: certificates
  resource: certificate
  requirement: Hsm Client Cert Key Length Minimum
  scope: certificates.certificate.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enforce Minimum Key Length for HSM Client Certificates
  rationale: Ensuring that HSM client certificates have a minimum key length is crucial for maintaining strong encryption standards. Insufficient key length can lead to vulnerabilities, enabling attackers to compromise encrypted data. This requirement aligns with regulatory standards that mandate robust cryptographic controls to protect sensitive information.
  description: This rule checks whether HSM client certificates in OCI have a key length that meets or exceeds the minimum required standard. To verify compliance, inspect the key length setting on each certificate used by HSM clients. If the key length is below the recommended threshold, generate new certificates with a compliant key length. This helps ensure that cryptographic operations are secure and resistant to brute-force attacks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keymanagementoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57p1r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.certificates.certificate.hsm_client_cert_not_expired
  service: certificates
  resource: certificate
  requirement: Hsm Client Cert Not Expired
  scope: certificates.certificate.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure HSM Client Certificate is Not Expired
  rationale: Expired HSM client certificates can lead to unauthorized access and data breaches, compromising data integrity and confidentiality. Maintaining valid client certificates is crucial for complying with data protection regulations such as GDPR and HIPAA, as well as ensuring that encrypted data remains secure against unauthorized decryption attempts.
  description: This rule checks that all HSM client certificates in your OCI environment are valid and not expired. Expired certificates can cause disruptions in secure communications and encryption processes. To verify, navigate to the OCI Certificates service, and review the certificate expiration dates. Remediation involves renewing or replacing any expired certificates through the OCI console or API to maintain uninterrupted secure operations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingcertificates.htm
  - https://www.oracle.com/security/cis-oracle-cloud-infrastructure-foundations-benchmark.html
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hipaajournal.com/hipaa-encryption-requirements/
- rule_id: oci.certificates.certificate.hsm_client_cert_trusted_issuer
  service: certificates
  resource: certificate
  requirement: Hsm Client Cert Trusted Issuer
  scope: certificates.certificate.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure HSM Client Certificate Uses Trusted Issuer
  rationale: Using a trusted certificate issuer for HSM client certificates ensures that only verified and authenticated users can access sensitive cryptographic operations. This reduces the risk of unauthorized access to data encrypted at rest and supports adherence to compliance frameworks such as PCI-DSS and ISO 27001, which mandate secure key management practices.
  description: This rule checks that HSM client certificates are issued by a trusted Certificate Authority (CA) within OCI. To verify, review your certificate configurations in the OCI console and ensure that the issuer is listed as trusted. Remediation involves configuring your certificate management policies to only accept certificates from recognized and trusted CAs. Utilize Oracle's HSM management tools to update and manage these certificates effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Certificates/Tasks/managingcertificates.htm
  - https://www.oracle.com/security/corporate-security-practices/cis-benchmarks/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt2r1.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/domains/
- rule_id: oci.cloud_guard.target.custom_identifier_source_trusted
  service: cloud_guard
  resource: target
  requirement: Custom Identifier Source Trusted
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Custom Identifier Source is Trusted in Cloud Guard Targets
  rationale: Using an untrusted source for custom identifiers in Cloud Guard targets can lead to inaccurate threat detection and compliance breaches. This can result in potential security vulnerabilities being overlooked and could impact the organization's ability to meet regulatory requirements. Trusting only verified sources minimizes the risk of unauthorized access and data exposure.
  description: This rule checks if the source for custom identifiers used in Cloud Guard targets is from a trusted and verified source. A trusted source ensures the integrity and accuracy of security alerts generated by Cloud Guard. To verify, review the configuration settings of your Cloud Guard target and ensure that the identifier source is listed as trusted. If not, update the configuration to include only verified sources, enhancing the reliability of your security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/security-best-practices-cloud-guard.html
  - https://www.oracle.com/security/cloud-security/
  - https://www.cisecurity.org/benchmark/oracle
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/cloud-security/
- rule_id: oci.cloud_guard.target.custom_identifier_storage_encrypted
  service: cloud_guard
  resource: target
  requirement: Custom Identifier Storage Encrypted
  scope: cloud_guard.target.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Custom Identifier Storage is Encrypted at Rest
  rationale: Encrypting data at rest is critical to protect sensitive information from unauthorized access, data breaches, and compliance violations. Without encryption, data stored in the OCI could be vulnerable to exploitation by attackers, leading to potential financial loss, reputational damage, and non-compliance with data protection regulations such as GDPR and CCPA.
  description: This rule checks if the custom identifiers stored within OCI Cloud Guard targets are encrypted at rest. Ensure that the storage configuration for these identifiers uses OCI's encryption services, which can be verified through OCI's console settings under the Cloud Guard target's configuration. Remediation involves enabling encryption for the storage service used, utilizing OCI's Vault service for key management, to align with organizational security policies and regulatory requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Concepts/cloudguard.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.cloud_guard.target.hub_auto_enroll_new_accounts
  service: cloud_guard
  resource: target
  requirement: Hub Auto Enroll New Accounts
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Enable Hub Auto Enroll for New Accounts in Cloud Guard
  rationale: Automatically enrolling new accounts into Cloud Guard ensures continuous security monitoring and compliance from the moment an account is created. Without automatic enrollment, new accounts might remain unmonitored, increasing the risk of undetected security vulnerabilities and non-compliance with industry standards such as PCI-DSS and ISO 27001.
  description: This rule checks if new accounts are automatically enrolled into Cloud Guard to ensure they are immediately subject to security monitoring and governance policies. Verify this setting in the Cloud Guard management console under the 'Hub' configuration. If not enabled, navigate to the Cloud Guard settings and activate automatic enrollment for new accounts to maintain consistent security posture and compliance across all accounts.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/cloud-guard-overview.html
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.cloud_guard.target.hub_master_member_configured
  service: cloud_guard
  resource: target
  requirement: Hub Master Member Configured
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Hub Master Member is Configured for Cloud Guard
  rationale: Configuring a Hub Master Member in Oracle Cloud Guard is crucial for centralized security management across multiple compartments and regions. It helps in detecting and responding to threats consistently and efficiently, reducing the risk of security breaches. Failure to configure this can lead to fragmented security insights and delayed threat response, potentially impacting compliance with regulatory standards such as ISO 27001.
  description: This rule checks whether a Hub Master Member is configured within Oracle Cloud Guard's target resources. A Hub Master Member allows for unified security monitoring and management across various compartments. To verify, ensure that the Cloud Guard target has a designated Hub Master Member. Remediation involves accessing the Cloud Guard console, navigating to the target settings, and configuring or designating a Hub Master Member to ensure centralized threat detection and response.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/cloudguard-overview.htm
  - https://www.oracle.com/security/cloud-security/cloud-guard/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/compliance/
- rule_id: oci.cloud_guard.target.detector_enabled_in_all_regions
  service: cloud_guard
  resource: target
  requirement: Detector Enabled In All Regions
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Cloud Guard Detectors Active Across All OCI Regions
  rationale: Enabling Cloud Guard detectors in all OCI regions is crucial for comprehensive threat monitoring and incident response. Without this, organizations may miss detecting unauthorized activities and potential security threats in regions not covered, leading to data breaches or non-compliance with regulatory standards such as GDPR or HIPAA.
  description: This rule checks that Cloud Guard detectors are enabled across all OCI regions, ensuring consistent security monitoring. To verify, navigate to the Cloud Guard service in the OCI console and review the list of enabled detectors for each region. Remediation involves configuring Cloud Guard to activate detectors in any regions where they are currently disabled, thereby maintaining a uniform security posture across your entire OCI environment.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/detecting-security-issues.html
  - https://www.oracle.com/security/cloud-security/cloud-guard/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.cloud_guard.target.detector_finding_export_encrypted_destination
  service: cloud_guard
  resource: target
  requirement: Detector Finding Export Encrypted Destination
  scope: cloud_guard.target.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Detector Finding Exports Use Encrypted Destinations
  rationale: Encrypting exported detector findings is crucial to protect sensitive security data from unauthorized access, ensuring compliance with data protection regulations such as GDPR and CCPA. Unencrypted data could lead to exposure of vulnerabilities or attack vectors, posing significant business and reputational risks.
  description: This rule checks whether the export of Oracle Cloud Infrastructure (OCI) Cloud Guard detector findings is directed to encrypted storage destinations. To verify, ensure that all exports are configured to use Object Storage buckets with encryption enabled. Remediation involves setting up Object Storage buckets with server-side encryption using Oracle-managed keys or customer-managed keys via Oracle Key Management. This ensures data at rest is protected according to organizational security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/detector-rules.html
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingpreauthenticatedrequests.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57pt1r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.cloud_guard.target.config_rule_remediation_targets_bound
  service: cloud_guard
  resource: target
  requirement: Config Rule Remediation Targets Bound
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Remediation Targets Are Bound in OCI Cloud Guard
  rationale: Binding remediation targets in Oracle Cloud Guard ensures that identified security issues can be automatically or manually addressed, reducing the risk of vulnerabilities being exploited. This enhances your security posture by enforcing consistent remediation processes and helps meet compliance requirements by ensuring that security controls are actively managed and maintained.
  description: This rule checks whether remediation targets are properly bound to configurations in Oracle Cloud Guard. Binding ensures that specific actions are associated with identified security issues. To verify, review Cloud Guard settings to confirm remediation targets are defined and aligned with security policies. If missing, configure the remediation targets by navigating to the Cloud Guard service in the OCI console and associating the appropriate targets. This ensures that security findings are actionable and can be remediated effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/rules.html
  - https://docs.oracle.com/en-us/iaas/Content/security/secure-cloud-guard.htm
  - CIS Oracle Cloud Infrastructure Foundations Benchmark
  - NIST SP 800-53
  - PCI-DSS Requirement 10
  - OCI Security Best Practices
- rule_id: oci.cloud_guard.target.config_rule_required_rules_present
  service: cloud_guard
  resource: target
  requirement: Config Rule Required Rules Present
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Config Rules are Present in Cloud Guard Targets
  rationale: Having the necessary configuration rules in place within Oracle Cloud Guard targets is crucial for maintaining a strong security posture. These rules help in proactively identifying potential vulnerabilities and misconfigurations, which could lead to unauthorized access or data breaches. Furthermore, adhering to configuration standards is often required to meet compliance mandates such as GDPR and ISO 27001, thereby reducing the risk of financial penalties and reputational damage.
  description: This rule checks whether all required configuration rules are present within a specified Cloud Guard target. It ensures that every target includes a comprehensive set of rules necessary for effective security monitoring and compliance reporting. To verify, review the settings in the Cloud Guard console under 'Targets' and ensure all mandated rules are added. If any rules are missing, add them directly through the console or via API to meet the compliance requirements and enhance security monitoring.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/using/index.htm#CloudGuardTargets
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-landing.htm
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/security/overview.htm
  - https://www.oracle.com/security/cis-benchmarks/
- rule_id: oci.cloud_guard.target.config_rule_rules_enabled
  service: cloud_guard
  resource: target
  requirement: Config Rule Rules Enabled
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Cloud Guard Config Rules Are Enabled for All Targets
  rationale: Enabling Cloud Guard's config rules is crucial for maintaining visibility into potential misconfigurations and security threats within your OCI environment. It helps organizations proactively identify and mitigate risks, thus protecting sensitive data and ensuring compliance with regulatory standards like PCI-DSS and ISO 27001. Without these rules, businesses face increased exposure to security incidents and potential non-compliance with industry regulations.
  description: This check verifies that all Cloud Guard targets have their configuration rules enabled. Configuration rules monitor and evaluate resource configurations, providing alerts when they deviate from the desired state. To verify, navigate to the Cloud Guard console, select your targets, and ensure that config rules are listed as enabled. Remediation involves accessing the Cloud Guard settings and activating the necessary rules for each target to ensure continuous security posture assessment.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Concepts/cloud-guard-overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Tasks/using-cloud-guard.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.cloud_guard.target.response_access_rbac_least_privilege_required
  service: cloud_guard
  resource: target
  requirement: Response Access RBAC Least Privilege Required
  scope: cloud_guard.target.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce Least Privilege for Cloud Guard Target Access
  rationale: Ensuring least privilege access for Cloud Guard targets mitigates the risks of unauthorized modifications or data breaches by limiting permissions to only what is necessary. This approach is critical to maintaining secure operations and protecting sensitive information, aligning with compliance requirements such as PCI-DSS and ISO 27001. Failure to adhere can result in security breaches, financial loss, and reputational damage.
  description: This rule checks whether Cloud Guard targets are configured with role-based access control (RBAC) principles that grant only the necessary permissions. It assesses the target's authorization settings to ensure users have minimal required access. Verification involves reviewing IAM policies and adjusting them to fit least privilege standards. Remediation includes updating policies to restrict access based on roles and responsibilities, using OCI's IAM service to enforce these controls.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Concepts/cloudguardoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- rule_id: oci.cloud_guard.target.response_storage_encrypted_and_private
  service: cloud_guard
  resource: target
  requirement: Response Storage Encrypted And Private
  scope: cloud_guard.target.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Cloud Guard Target Storage is Encrypted and Private
  rationale: Encrypting and securing response storage in Oracle Cloud Guard is crucial to protect sensitive data from unauthorized access and potential breaches. Failure to encrypt storage can expose critical data to threats, compromising data privacy and potentially leading to financial and reputational damage, as well as non-compliance with data protection regulations.
  description: This rule checks that storage used for Oracle Cloud Guard responses is encrypted and access is restricted to authorized users and services. Ensure that the storage is configured with Oracle-managed keys or customer-managed keys for encryption. Verify that appropriate security lists and policies are in place to restrict access to the storage. Remediation involves enabling encryption on the storage and configuring identity and access management (IAM) policies to limit access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_bestpractices.htm
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Tasks/cloud-guard-remediation.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.cloud_guard.target.response_versioning_and_immutability_enabled
  service: cloud_guard
  resource: target
  requirement: Response Versioning And Immutability Enabled
  scope: cloud_guard.target.versioning
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Enable Versioning and Immutability for Cloud Guard Targets
  rationale: Enabling response versioning and immutability for Cloud Guard targets helps protect against accidental or malicious data loss or tampering by ensuring that all changes are tracked and that previous versions can be restored if necessary. This enhances data integrity and supports compliance with data protection regulations such as GDPR and CCPA, which require robust data management and audit capabilities.
  description: This rule checks whether versioning and immutability are enabled for Cloud Guard targets within OCI. To verify, ensure that the Cloud Guard target's storage settings have versioning configured to create and retain multiple versions of objects and that immutability policies are applied to prevent modifications. To remediate, navigate to the OCI Console, access the Cloud Guard service, and configure the target's storage settings to enable both versioning and immutability according to your data retention policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/cloudguard.htm
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#versioning
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.cloud_guard.target.finding_alert_destinations_enabled
  service: cloud_guard
  resource: target
  requirement: Finding Alert Destinations Enabled
  scope: cloud_guard.target.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Cloud Guard Alert Destinations are Configured
  rationale: Enabling alert destinations for Cloud Guard findings is crucial to ensure that security teams are promptly notified of potential threats. Without proper alerting, security incidents might go unnoticed, leading to delayed responses and increased risk of data breaches. This can impact compliance with regulations such as GDPR and ISO 27001, which mandate timely incident detection and response.
  description: This rule checks whether alert destinations are configured for Cloud Guard findings on specified targets. Proper configuration involves setting up notification channels, such as email or OCI Notifications, to receive alerts on security findings. Verification requires accessing the Cloud Guard settings in the OCI console and ensuring alert destinations are enabled and correctly configured. Remediation involves navigating to the Cloud Guard dashboard, selecting the target, and configuring the desired alert destinations under the 'Notifications' section.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/understanding-cloud-guard.html
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/configuring-notifications.html
  - https://www.oracle.com/security-cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.cloud_guard.target.finding_archival_export_encrypted
  service: cloud_guard
  resource: target
  requirement: Finding Archival Export Encrypted
  scope: cloud_guard.target.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Finding Archival Export Encryption in OCI Cloud Guard
  rationale: Encrypting archival exports in Oracle Cloud Infrastructure (OCI) Cloud Guard ensures that sensitive data is protected from unauthorized access and potential breaches during storage. This is critical for maintaining data privacy, avoiding financial penalties, and ensuring compliance with regulatory frameworks such as HIPAA and PCI-DSS that mandate encryption of sensitive data.
  description: This rule checks whether archival exports of findings in OCI Cloud Guard are encrypted using OCI's Key Management Service (KMS). Unencrypted exports could lead to data exposure. To verify, ensure that the encryption settings for the archival destination are configured to use OCI KMS. Remediation involves setting up an OCI KMS key and applying it to the Cloud Guard archival export settings to secure the data at rest.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_approach.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/cis-v1.1.0.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/sites/default/files/hipaa-simplification-201303.pdf
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
- rule_id: oci.cloud_guard.detector_rule.finding_suppression_rules_documented_and_scoped
  service: cloud_guard
  resource: detector_rule
  requirement: Finding Suppression Rules Documented And Scoped
  scope: cloud_guard.detector_rule.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure OCI Cloud Guard Finding Suppression Rules Are Documented and Scoped
  rationale: Proper documentation and scoping of finding suppression rules in OCI Cloud Guard are crucial for maintaining audit trails and ensuring that critical security findings are not overlooked. Without clear documentation, organizations risk non-compliance with industry regulations and may face increased vulnerability to threats due to unmonitored activities. Well-scoped suppression rules ensure that only legitimate exceptions are made, reducing the risk of unauthorized access or data breaches.
  description: This rule checks whether all finding suppression rules in OCI Cloud Guard are adequately documented and scoped to specific resources or conditions. It verifies that suppression rules have descriptions and are limited in scope to prevent unnecessary security blind spots. To remediate, review existing suppression rules to ensure they are justified, documented, and scoped to relevant resources or conditions. Use the OCI Console to edit rules and add descriptions and specific conditions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/using/suppression-rules.htm
  - 'CIS OCI Foundations Benchmark: Section 3.1 - Configure Cloud Guard'
  - 'NIST SP 800-53 Rev. 5: CA-3 System Interconnections'
  - 'PCI DSS v3.2.1: Requirement 10.6 - Review Logs and Security Events'
  - https://www.oracle.com/security/cloud-security/cloud-guard/
  - ISO/IEC 27001:2013 - A.12.4 Logging and Monitoring
- rule_id: oci.cloud_guard.target.automation_artifacts_encrypted_and_private
  service: cloud_guard
  resource: target
  requirement: Automation Artifacts Encrypted And Private
  scope: cloud_guard.target.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Automation Artifacts Are Encrypted and Private
  rationale: Protecting automation artifacts with encryption and restricted access minimizes the risk of unauthorized data exposure and manipulation, which is crucial for maintaining the integrity and confidentiality of cloud operations. This practice supports compliance with data protection regulations and helps prevent data breaches that could lead to financial loss and reputational damage.
  description: This check verifies that all automation artifacts stored within the Cloud Guard service on OCI are both encrypted and set to private access. Ensure that encryption is enabled using Oracle-managed keys or customer-managed keys, and access control policies are configured to restrict access to authorized users only. To remediate, configure encryption settings within your OCI console and update access policies to limit exposure to sensitive artifacts.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_automate.htm
  - https://docs.oracle.com/en-us/iaas/Content/CIS/OCI_2.0.0_Benchmark_v1.0.0.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security-cloud-compliance/
  - https://www.iso.org/standard/54534.html
- rule_id: oci.cloud_guard.target.automation_change_audit_logging_enabled
  service: cloud_guard
  resource: target
  requirement: Automation Change Audit Logging Enabled
  scope: cloud_guard.target.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Automation Change Audit Logging for Cloud Guard Targets
  rationale: Enabling audit logging for automation changes in Cloud Guard is critical to monitor and trace changes that could potentially alter the security posture of cloud resources. Without audit logging, unauthorized or unintended changes could go undetected, leading to security breaches and compliance violations. This capability aids in meeting regulatory requirements and enhances the organization's ability to perform forensic analysis in case of security incidents.
  description: This rule verifies that automation change audit logging is enabled for Cloud Guard targets in OCI. The logging ensures that any changes made through automation to Cloud Guard configurations are recorded and can be reviewed for compliance and security analysis. To verify, navigate to the OCI console, access the Cloud Guard settings for the target, and ensure that logging is enabled under the 'Audit Logging' section. Remediation involves enabling audit logging if it is not already configured, which can be done through the OCI console or via the OCI CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Tasks/cloud-guard-audit-logging.htm
  - https://www.oracle.com/security/cloud-security/oci-security-best-practices/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.cloud_guard.target.automation_execution_roles_least_privilege_required
  service: cloud_guard
  resource: target
  requirement: Automation Execution Roles Least Privilege Required
  scope: cloud_guard.target.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Automation Execution Roles in Cloud Guard
  rationale: Implementing the principle of least privilege for automation execution roles in OCI Cloud Guard minimizes the risk of unauthorized access and potential data breaches. By restricting roles to only the necessary permissions, it reduces the attack surface, prevents privilege escalation, and ensures compliance with governance frameworks such as NIST and PCI-DSS. Failing to do so could lead to compromised security, exposing sensitive data and operations to threats.
  description: This rule checks if automation execution roles associated with OCI Cloud Guard targets adhere to the principle of least privilege. It ensures that roles have only the permissions necessary to perform their intended functions without excess access. To verify, review the IAM policies assigned to these roles and adjust them to limit permissions appropriately. Remediation involves revising IAM policies to align with the least privilege model, using tools like Oracle's IAM service to audit and refine role permissions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/iam-best-practices.htm
  - CIS OCI Foundations Benchmark - Identity and Access Management
  - 'NIST SP 800-53: Access Control (AC-6)'
  - 'PCI-DSS Requirement 7: Restrict access to cardholder data by business need to know'
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.cloud_guard.target.aggregation_authorization_present_and_valid
  service: cloud_guard
  resource: target
  requirement: Aggregation Authorization Present And Valid
  scope: cloud_guard.target.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Aggregation Authorization Validity in Cloud Guard Targets
  rationale: Valid aggregation authorizations are critical for the proper functioning of Cloud Guard, ensuring that security data is accurately collected and analyzed across your OCI resources. Unauthorized or invalid authorizations can lead to gaps in security monitoring, exposing your organization to potential threats and non-compliance with regulatory frameworks such as ISO 27001 and SOC 2.
  description: This rule verifies that aggregation authorizations for Cloud Guard targets are present and valid. It checks for the existence of necessary permissions and validates their correctness to ensure that Cloud Guard can effectively aggregate security data. To remediate issues, ensure that the required permissions are correctly configured in the IAM policies and that any expired authorizations are renewed or replaced. Regularly review and update permissions to align with your organization's security posture and compliance requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/using-cloud-guard.html#aggregation_authorization
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.aicpa.org/content/dam/aicpa/interestareas/frc/assuranceadvisoryservices/downloadabledocuments/aicpa-soc2.pdf
- rule_id: oci.cloud_guard.target.aggregator_auto_enroll_new_accounts
  service: cloud_guard
  resource: target
  requirement: Aggregator Auto Enroll New Accounts
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Enable Auto Enrollment for New Accounts in Cloud Guard Aggregator
  rationale: Automatically enrolling new accounts in Cloud Guard aggregators helps maintain consistent security monitoring and compliance across all organizational accounts. This reduces the risk of missing critical security alerts and ensures new accounts adhere to established security policies, minimizing potential vulnerabilities and regulatory non-compliance.
  description: This rule checks if new accounts are automatically enrolled into an existing Cloud Guard aggregator. Auto enrollment ensures that security monitoring is applied uniformly across all accounts, providing centralized oversight and rapid detection of security events. To verify, ensure the 'Aggregator Auto Enroll New Accounts' setting is enabled in the Cloud Guard console. Remediate by navigating to the Cloud Guard dashboard, selecting the aggregator settings, and enabling automatic enrollment for new accounts.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Tasks/guardingcloud.htm
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Concepts/cloudguardoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/cloud/cloud-security/
- rule_id: oci.cloud_guard.target.aggregator_org_enabled
  service: cloud_guard
  resource: target
  requirement: Aggregator Org Enabled
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Enable Cloud Guard Aggregator Organization
  rationale: Enabling the Cloud Guard Aggregator Organization helps centralize security findings and insights across multiple OCI compartments, improving the ability to monitor, detect, and respond to security threats efficiently. It is crucial for maintaining a unified security posture and ensuring compliance with regulatory mandates, such as SOC2 and ISO 27001, which require comprehensive security monitoring across an organization.
  description: This rule checks whether the Cloud Guard Aggregator Organization is enabled for the target resource. To verify, navigate to the Cloud Guard console in OCI and ensure that the Aggregator is set up, allowing it to consolidate security data from various compartments. If not enabled, configure the Aggregator by selecting a compartment as the aggregator target. This setup facilitates centralized security management and enhances threat detection capabilities across your cloud environment.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Concepts/cloud-guard-overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Tasks/aggregator.htm
  - https://www.oracle.com/security/cloud-security/cloud-security-posture-management/
  - 'NIST SP 800-53: Security and Privacy Controls for Information Systems'
  - ISO 27001:2013 Information Security Management Systems
  - https://www.oracle.com/cloud/security/
- rule_id: oci.cloud_guard.target.aggregation_authorization_not_expired_or_revoked
  service: cloud_guard
  resource: target
  requirement: Aggregation Authorization Not Expired Or Revoked
  scope: cloud_guard.target.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Aggregation Authorization Is Valid in Cloud Guard
  rationale: Expired or revoked aggregation authorizations can lead to incomplete threat detection and monitoring, exposing the organization to undetected security incidents. Maintaining valid authorizations is crucial for compliance with regulatory frameworks like ISO 27001 and PCI-DSS, which require effective security monitoring. Invalid authorizations can result in gaps in security posture visibility, impacting incident response capabilities and increasing business risk.
  description: This rule checks that the aggregation authorization for Oracle Cloud Guard targets is neither expired nor revoked. To verify, ensure that all Cloud Guard target authorizations are current and have not been manually revoked. Remediation involves renewing or re-establishing authorization for any affected targets through the OCI Console or CLI. This ensures that all security findings are aggregated correctly, enabling comprehensive monitoring and protection across your OCI resources.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/using-cloud-guard.html#managing_cloud_guard_targets
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Concepts/cloudguardoverview.htm
  - https://www.oracle.com/security/cloud-security/cloud-guard/
- rule_id: oci.cloud_guard.target.aggregation_authorization_target_accounts_correct
  service: cloud_guard
  resource: target
  requirement: Aggregation Authorization Target Accounts Correct
  scope: cloud_guard.target.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Proper Authorization for Cloud Guard Target Accounts
  rationale: Incorrect aggregation authorization for Cloud Guard targets can lead to unauthorized access to security monitoring and management functions, potentially exposing sensitive data and critical infrastructure to threats. Ensuring correct authorization helps maintain a secure access control environment, aligns with compliance requirements, and minimizes the risk of privilege escalation attacks.
  description: This rule checks if the Cloud Guard target accounts have correct aggregation authorization settings. It verifies that only authorized accounts are configured to aggregate and analyze security data across compartments. To remediate issues, review and update the authorization settings within the Cloud Guard console, ensuring that only designated security administrators have aggregation permissions. Regular audits of these settings are recommended to maintain security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/using/cloud-guard-overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/security/secure-access.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://cloudsecurityalliance.org/artifacts/oracle-cloud-infrastructure-security-best-practices/
- rule_id: oci.cloud_guard.target.aggregation_authorization_trusts_least_privilege_required
  service: cloud_guard
  resource: target
  requirement: Aggregation Authorization Trusts Least Privilege Required
  scope: cloud_guard.target.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Cloud Guard Aggregation Trusts
  rationale: Implementing least privilege for aggregation trusts reduces the risk of unauthorized access and potential data breaches. Inappropriate permissions can lead to compromised security controls, impacting regulatory compliance requirements such as GDPR and ISO 27001 by exposing sensitive data to unnecessary risks.
  description: This rule checks if the aggregation authorization trusts within OCI Cloud Guard are configured following the principle of least privilege. It verifies that only necessary permissions are granted to roles and users for accessing Cloud Guard targets. To remediate, review the permissions assigned to each trust and ensure they are limited to only what is required for the role's functionality. Use OCI IAM policies to restrict access appropriately.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/home.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/access/managing-policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.identity.tag_namespace.savings_plan_approval_workflow_required
  service: identity
  resource: tag_namespace
  requirement: Savings Plan Approval Workflow Required
  scope: identity.tag_namespace.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enforce Savings Plan Approval Workflow for Tag Namespaces
  rationale: Mandating an approval workflow for savings plans in OCI ensures that financial commitments are reviewed and authorized by the appropriate personnel, reducing the risk of unauthorized or excessive spending. This control helps mitigate the risk of budget overruns and aligns with governance policies that require oversight on financial decisions. It also assists in meeting compliance requirements for financial accountability and auditability.
  description: This rule checks if an approval workflow is enforced for tag namespaces associated with savings plans in OCI. Ensuring that a workflow is in place involves configuring the identity and access management policy to require approvals before savings plans are tagged, which can be verified through the OCI console. Remediation involves defining and enforcing policies that integrate with Oracle Cloud's native identity services to manage approvals efficiently. This setup not only secures financial transactions but also provides audit trails for compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Tagging/Tasks/managingtagsandtagnamespaces.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/cloud/security/compliance/
  - https://cloudsecurityalliance.org/research/artifacts/oracle-cloud-infrastructure-security-best-practices/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.identity.user.savings_plan_billing_admins_mfa_required
  service: identity
  resource: user
  requirement: Savings Plan Billing Admins MFA Required
  scope: identity.user.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Enforce MFA for Savings Plan Billing Admins
  rationale: Multi-Factor Authentication (MFA) adds an extra layer of security by requiring users to provide multiple forms of verification before accessing sensitive billing functionalities. Without MFA, attackers who gain access to an admin's credentials can manipulate or steal financial resources, leading to financial loss and non-compliance with regulatory requirements such as PCI DSS and SOC 2.
  description: This rule checks whether users with the role of Savings Plan Billing Admins have MFA enabled. It verifies the configuration of MFA in the OCI Identity and Access Management system. To mitigate risks, ensure that all users with this role have MFA configured by navigating to the OCI Console, accessing the 'Identity' tab, and enforcing MFA for these specific users. Organizations can leverage the OCI security best practices guide to implement MFA effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/casb.html
- rule_id: oci.identity.user.savings_plan_purchase_permissions_restricted
  service: identity
  resource: user
  requirement: Savings Plan Purchase Permissions Restricted
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict User Permissions for Savings Plan Purchases
  rationale: Restricting user permissions for purchasing savings plans is crucial to prevent unauthorized financial commitments and budget overruns, which can significantly impact an organization's financial planning and resource allocation. It also mitigates the risk of insider threats and ensures only authorized personnel can make critical purchasing decisions, aligning with compliance and governance policies.
  description: This rule checks whether user permissions for purchasing Oracle Cloud Infrastructure (OCI) savings plans are restricted to a designated group of users. Verify that only users with the appropriate role have 'usage' permissions for the 'savings-plan' resource. Remediation involves reviewing and updating Identity and Access Management (IAM) policies to limit this capability to a select group, ensuring compliance with organizational policies and preventing unauthorized cost incurrence.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/policiesdefault.htm
  - https://www.oracle.com/cloud/compute/pricing/
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.compartment.ou_auto_tag_policies_enabled
  service: identity
  resource: compartment
  requirement: Ou Auto Tag Policies Enabled
  scope: identity.compartment.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Auto Tag Policies Are Enabled for Compartments
  rationale: Enabling auto tag policies in OCI compartments is crucial for maintaining consistent and accurate resource tagging, which facilitates effective monitoring, cost management, and access control. Without these policies, organizations risk inconsistent tagging, leading to potential security gaps, mismanagement of resources, and challenges in meeting compliance requirements such as PCI-DSS and ISO 27001.
  description: This rule checks whether auto tag policies are enabled for compartments within OCI. Auto tag policies ensure that specific tags are automatically applied to resources upon creation, promoting consistent metadata application. To verify, navigate to the Identity and Access Management section of the OCI console, locate the specific compartment, and check the tag defaults settings. Remediation involves configuring auto tag policies via the OCI console or API to enforce consistent tagging across all resources in the compartment.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Tagging/Tasks/managingtagdefaults.htm
  - https://www.oracle.com/a/ocom/docs/cloud/cis-oci-benchmark.pdf
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/security/overview.htm
- rule_id: oci.identity.user.ou_no_overly_permissive_exceptions
  service: identity
  resource: user
  requirement: Ou No Overly Permissive Exceptions
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict Overly Permissive User Exceptions
  rationale: Overly permissive exceptions in user policies can lead to unauthorized access and potential data breaches. Such configurations may violate compliance requirements like PCI-DSS or NIST, which mandate strict access controls. Ensuring that user policies are not overly permissive helps mitigate the risk of privilege escalation and insider threats, protecting sensitive data and maintaining organizational trust.
  description: This rule checks for user policies that include overly permissive exceptions, which can inadvertently grant users more access than necessary. To verify, review user policies and ensure that exceptions do not bypass critical security controls. Remediation involves tightening the policies by adhering to the principle of least privilege, removing unnecessary exceptions, and regularly auditing policy changes to prevent misconfigurations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.oracle.com/security/cloud-security/identity-management/
- rule_id: oci.identity.policy.ou_required_scps_attached
  service: identity
  resource: policy
  requirement: Ou Required Scps Attached
  scope: identity.policy.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Organization Units Have Required SCPs Attached
  rationale: Attaching Service Control Policies (SCPs) to Organizational Units (OUs) is crucial for enforcing security and compliance controls across the OCI environment. Without SCPs, OUs may inadvertently allow actions that contravene security policies, leading to unauthorized access, data breaches, or non-compliance with regulatory requirements such as PCI-DSS or ISO 27001.
  description: This rule checks for the presence of required Service Control Policies (SCPs) attached to Organizational Units within OCI Identity and Access Management. SCPs help govern and restrict permissions at the organization level, ensuring that critical policies are enforced consistently. To verify compliance, inspect each OU in the identity domain and ensure that all mandatory SCPs are attached. Remediation involves attaching the necessary SCPs to any OU lacking them, which can be done through the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/standard/54534.html
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v4/
- rule_id: oci.identity.policy.policy_admin_change_audit_logging_enabled
  service: identity
  resource: policy
  requirement: Policy Admin Change Audit Logging Enabled
  scope: identity.policy.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: critical
  title: Ensure Audit Logging for Policy Admin Changes is Enabled
  rationale: Enabling audit logging for policy admin changes in OCI is crucial for tracking modifications that could impact access controls and security configurations. Without proper logging, unauthorized or accidental changes might go unnoticed, leading to potential security breaches or non-compliance with regulatory standards like PCI-DSS and ISO 27001, which mandate logging of access and configuration changes.
  description: This rule verifies that audit logging is enabled for all administrative changes to OCI identity policies. It checks if the logging service is configured to capture changes to policy definitions, which includes creation, modification, and deletion actions. To ensure compliance, administrators should configure Log Groups and enable logging for the relevant compartments. Remediation involves accessing the OCI Console, navigating to the 'Logging' service, and ensuring that audit logs are activated for policy changes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.oracle.com/cloud/security/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.policy_admin_mfa_required
  service: identity
  resource: user
  requirement: Policy Admin MFA Required
  scope: identity.user.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Enforce MFA for OCI Policy Administrators
  rationale: Requiring multi-factor authentication (MFA) for policy administrators significantly reduces the risk of unauthorized access and potential security breaches. Policy administrators have the ability to alter access permissions across the OCI environment, making them prime targets for attackers. Ensuring MFA is enabled aligns with compliance standards such as NIST SP 800-63B and PCI-DSS, which mandate strong authentication mechanisms to protect sensitive operations.
  description: This rule checks whether MFA is enabled for users with policy administration privileges in Oracle Cloud Infrastructure. To verify, inspect the user's authentication settings in the OCI console to ensure MFA is configured. Remediation involves enabling MFA for these users by navigating to 'Identity & Security' > 'Users', selecting the user, and configuring MFA. This action enhances security by requiring additional verification factors, beyond just a password, to access critical administration functions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusercredentials.htm#User_Console_MFA
  - https://www.oracle.com/security/cloud-security/cloud-security-compliance/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
- rule_id: oci.identity.policy.policy_admin_rbac_least_privilege_required
  service: identity
  resource: policy
  requirement: Policy Admin RBAC Least Privilege Required
  scope: identity.policy.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Enforce Least Privilege for OCI Policy Admins
  rationale: Implementing least privilege for Policy Admins minimizes the risk of unauthorized access and reduces the attack surface within OCI. It ensures that administrators only have access to necessary resources, thus protecting sensitive data and maintaining compliance with regulatory frameworks like NIST and PCI-DSS. A breach could lead to unauthorized policy changes, impacting the entire cloud environment.
  description: This rule checks if Policy Admin roles in OCI are granted the least privilege necessary to perform their tasks. Identify and review all policies to ensure they only include essential permissions. Remediation involves modifying existing policies to remove excessive permissions, or creating new policies with a focused scope using OCI's policy editor. Verify compliance by regularly auditing policies through OCI's audit service.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/cloud/cloud-native/security/
- rule_id: oci.compute.instance.key_pair_disable_unused_keys
  service: compute
  resource: instance
  requirement: Key Pair Disable Unused Keys
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: high
  title: Disable Unused SSH Keys on OCI Compute Instances
  rationale: Unused SSH keys on compute instances pose a significant security risk as they may be exploited by unauthorized users to gain access to cloud resources. Ensuring that only active and necessary keys are enabled reduces the attack surface and aligns with security best practices and compliance mandates such as PCI-DSS and ISO 27001, which emphasize strict access control.
  description: This rule checks for inactive or unused SSH keys associated with OCI compute instances and recommends their removal or disablement. Administrators should regularly audit SSH keys and disable those that are no longer required to access instances. This can be achieved via the OCI Console or API by removing unused keys from the instance metadata. Regular key rotation and validation of active keys are also advised for enhanced security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/managingkeypairs.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/artifacts/cloud-controls-matrix-v4/
- rule_id: oci.compute.instance.key_pair_max_age_days
  service: compute
  resource: instance
  requirement: Key Pair Max Age Days
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: high
  title: Ensure Key Pair Age Does Not Exceed Maximum Allowed Days
  rationale: Regularly rotating SSH key pairs reduces the risk of unauthorized access by limiting the exposure period of a compromised key. Unrotated keys can lead to prolonged unauthorized access, which could result in data breaches or loss of control over critical infrastructure. Adhering to key rotation policies is essential for compliance with security frameworks such as NIST and PCI-DSS, which mandate regular credential updates.
  description: This rule checks if the SSH key pairs associated with compute instances have not exceeded a specified maximum age. To verify, review each instance's key pair creation and last rotation dates. Remediation involves updating the key pair by generating a new SSH key and uploading it to the instance. It is recommended to automate key rotation using OCI Cloud Shell or other scripting tools to ensure compliance with security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/managingkeypairs.htm
  - 'Center for Internet Security OCI Benchmark: Ensure SSH keys are regularly rotated'
  - 'NIST SP 800-53 IA-5: Authenticator Management'
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.data_integration.workspace.ruleset_encrypted_at_rest
  service: data_integration
  resource: workspace
  requirement: Ruleset Encrypted At Rest
  scope: data_integration.workspace.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Encrypt Data Integration Workspaces at Rest
  rationale: Encrypting data at rest in OCI Data Integration workspaces helps protect sensitive information from unauthorized access and breaches. This is crucial for maintaining data privacy and integrity, and is often required by compliance regulations like ISO 27001 and PCI-DSS. Without encryption, data is vulnerable to exposure in case of storage compromise.
  description: This rule verifies that all data stored within OCI Data Integration workspaces is encrypted at rest using OCI's built-in encryption mechanisms. To ensure compliance, configure the workspace settings to enable encryption via the OCI Console or API. Regularly audit these settings to confirm that encryption is correctly applied and functioning. Remediation involves enabling encryption through the OCI Console under the Data Integration service settings.
  references:
  - https://docs.oracle.com/en-us/iaas/data-integration/using/encryption.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_oci_cis.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
  - https://docs.oracle.com/en-us/iaas/Content/CloudSecurity/Concepts/security_overview.htm
- rule_id: oci.data_integration.workspace.ruleset_rbac_least_privilege_required
  service: data_integration
  resource: workspace
  requirement: Ruleset RBAC Least Privilege Required
  scope: data_integration.workspace.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Data Integration Workspace RBAC
  rationale: Implementing least privilege for RBAC in OCI Data Integration reduces the risk of unauthorized access and data exposure by ensuring users have only the permissions necessary for their roles. This minimizes potential damage from compromised accounts and supports compliance with regulations like GDPR and ISO 27001, which mandate strict access controls.
  description: This rule checks that RBAC policies for OCI Data Integration Workspaces grant only the minimum permissions necessary for users to perform their job functions. To verify, review IAM policies and ensure they align with the principle of least privilege, adjusting any overly permissive roles. Remediation involves auditing current policies, removing unnecessary permissions, and using OCI's policy editor to refine access controls.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/dataintegrationoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_integration.workspace.ruleset_version_pinned_required
  service: data_integration
  resource: workspace
  requirement: Ruleset Version Pinned Required
  scope: data_integration.workspace.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Workspace Ruleset Version is Pinned in Data Integration
  rationale: Pinning the ruleset version in OCI Data Integration workspaces ensures consistent data processing and compliance with regulatory requirements. This mitigates risks associated with unexpected changes in data handling or encryption methods, which could lead to data breaches or non-compliance with standards like GDPR or HIPAA.
  description: This check verifies that all OCI Data Integration workspaces have their ruleset versions pinned, preventing automatic updates that might introduce breaking changes or security vulnerabilities. To verify, navigate to the Data Integration service in the OCI Console, select workspaces, and ensure the 'Ruleset Version' is explicitly set and not set to 'Latest'. Remediation involves manually selecting a specific version for the ruleset to ensure consistent and compliant data processing.
  references:
  - https://docs.oracle.com/en-us/iaas/data-integration/using/di_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
- rule_id: oci.virtual_network.security_list.cgw_ip_addresses_valid_and_owned
  service: virtual_network
  resource: security_list
  requirement: Cgw Ip Addresses Valid And Owned
  scope: virtual_network.security_list.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Validate and Own CGW IP Addresses in Security Lists
  rationale: Ensuring that the customer gateway (CGW) IP addresses in OCI security lists are valid and owned by the organization is critical to prevent unauthorized access. Misconfigured or incorrect IP addresses can lead to security breaches, exposing sensitive data to unauthorized entities. Compliance with regulatory standards such as PCI-DSS and NIST requires strict control over network access points to protect data integrity and confidentiality.
  description: This rule checks that all customer gateway IP addresses specified in OCI security lists are valid and owned by the organization. Verify that IP addresses correspond to authorized and correctly configured gateways to ensure secure connections. To remediate, update the security list with the correct IP addresses that are actively managed and monitored by your organization. Regular audits and updates to security lists ensure that only legitimate IP addresses are allowed, reducing the risk of unauthorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security-best-practices/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/securitybestpractices.htm
- rule_id: oci.virtual_network.security_list.cgw_no_public_management_interfaces_exposed_blocked
  service: virtual_network
  resource: security_list
  requirement: Cgw No Public Management Interfaces Exposed Blocked
  scope: virtual_network.security_list.public_access
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: critical
  title: Block Public Access to CGW Management Interfaces
  rationale: Exposing management interfaces of Customer Gateway (CGW) to the public internet increases the risk of unauthorized access and potential attacks. This could lead to data breaches, infrastructure compromise, and significant financial and reputational damage. Ensuring these interfaces are not publicly accessible aligns with security best practices and compliance requirements such as NIST and PCI-DSS.
  description: This rule checks for security list configurations that allow public access to management interfaces of CGWs. It ensures that no public IP addresses have access to ports typically used for management, such as SSH (22) and HTTP/S (80/443). To verify, review the ingress rules of your security lists and ensure they restrict these ports to trusted IPs only. Remediate by updating the security list to block public IP ranges from accessing management ports.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/securebydesign.htm
  - https://www.oracle.com/security/cloud-security.html
- rule_id: oci.data_catalog.catalog.job_network_private_only_enforced
  service: data_catalog
  resource: catalog
  requirement: Job Network Private Only Enforced
  scope: data_catalog.catalog.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Data Catalog Job Network Access is Private
  rationale: Restricting network access to private endpoints for Data Catalog jobs minimizes exposure to the internet, mitigating risks such as unauthorized access, data breaches, and compliance violations. This is essential for protecting sensitive data and maintaining trust with stakeholders, while adhering to regulatory requirements like GDPR and PCI-DSS that mandate stringent data protection measures.
  description: This rule checks if Data Catalog jobs are configured to use only private network endpoints, ensuring they are not accessible over the public internet. To verify, review the network settings in the OCI Console under Data Catalog configurations, ensuring the 'Network Access Type' is set to 'Private Only'. Remediate by updating the network settings of your Data Catalog jobs to restrict access to VCN (Virtual Cloud Network) only, using Private IP addresses.
  references:
  - https://docs.oracle.com/en-us/iaas/data-catalog/doc/overview.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/document_library
- rule_id: oci.data_catalog.catalog.job_role_least_privilege_required
  service: data_catalog
  resource: catalog
  requirement: Job Role Least Privilege Required
  scope: data_catalog.catalog.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Data Catalog Job Roles
  rationale: Assigning excessive privileges in the Data Catalog service can lead to unauthorized data access and potential data breaches, posing significant risks to sensitive information. Implementing least privilege reduces the attack surface by ensuring users have only the necessary permissions, which is critical for compliance with regulatory standards such as GDPR, PCI-DSS, and ISO 27001.
  description: This rule checks that IAM policies for Data Catalog jobs are configured to adhere to the principle of least privilege. It verifies that only necessary permissions are granted to job roles, minimizing the risk of unauthorized access. To remediate, review and update IAM policies to limit permissions to only those required for job execution. Utilize Oracle Cloud Infrastructure's fine-grained access controls to specify precise permissions for catalog resources.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
- rule_id: oci.data_catalog.catalog.lineage_access_rbac_least_privilege_required
  service: data_catalog
  resource: catalog
  requirement: Lineage Access RBAC Least Privilege Required
  scope: data_catalog.catalog.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Data Catalog Lineage Access
  rationale: Implementing least privilege access for data catalog lineage is crucial to minimize the risk of unauthorized data exposure and potential data breaches. Ensuring that users have only the necessary permissions reduces the attack surface and helps maintain compliance with data protection regulations such as GDPR and CCPA. This also protects sensitive metadata and business insights from being accessed by malicious actors.
  description: This rule checks if the permissions granted to access data catalog lineage are restricted to the minimum necessary. It involves auditing IAM policies to ensure that roles and permissions are carefully defined and assigned only to those who need them for their job functions. Remediation involves reviewing and updating IAM policies to remove excessive permissions and regularly auditing access logs to detect any unauthorized access attempts. Use OCI's Identity and Access Management service to configure policies effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - NIST SP 800-53
  - ISO/IEC 27001
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.data_catalog.catalog.lineage_capture_enabled
  service: data_catalog
  resource: catalog
  requirement: Lineage Capture Enabled
  scope: data_catalog.catalog.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable Lineage Capture in OCI Data Catalog
  rationale: Enabling lineage capture in OCI Data Catalog is crucial for maintaining accurate data provenance, which helps in data governance and compliance with privacy regulations like GDPR. It provides visibility into data movement and transformations, reducing the risk of data breaches and unauthorized access to sensitive information.
  description: This rule checks if lineage capture is enabled in OCI Data Catalog, which tracks data flow across different systems to provide a comprehensive view of data lifecycle. To verify, access the Data Catalog in the OCI Console, navigate to the 'Lineage' section, and ensure the 'Lineage Capture' option is activated. If not enabled, go to the catalog settings and toggle the lineage capture setting to 'On'. This enhances traceability and accountability, ensuring data integrity and compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/data-catalog/doc/getting-started.html
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.data_catalog.catalog.lineage_export_destination_encrypted
  service: data_catalog
  resource: catalog
  requirement: Lineage Export Destination Encrypted
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Lineage Export Destination in Data Catalog is Encrypted
  rationale: Encrypting the lineage export destination in OCI Data Catalog is critical for protecting sensitive metadata and maintaining data integrity. Without encryption, this data is vulnerable to unauthorized access and potential data breaches, which can lead to significant legal and financial repercussions. Compliance with data protection regulations like GDPR and CCPA often mandates encryption of sensitive data, making this a necessary measure for regulatory adherence.
  description: This rule checks whether the lineage export destination in the OCI Data Catalog is configured to use encryption. To verify, ensure that the Oracle Cloud Infrastructure Key Management (OCI KMS) is enabled and that encryption keys are applied to the lineage export settings. Remediation involves configuring the export destination to utilize OCI KMS managed keys, which can be done via the OCI console or CLI by selecting the appropriate encryption settings under the Data Catalog configuration.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/encryption.htm
  - https://docs.oracle.com/en-us/iaas/Content/security/secure-by-design.htm
  - 'NIST SP 800-57 Part 1: Recommendation for Key Management'
  - 'PCI-DSS Requirement 3: Protect Stored Cardholder Data'
  - ISO/IEC 27001:2013 - Information Security Management
- rule_id: oci.data_catalog.catalog.consent_access_rbac_least_privilege_required
  service: data_catalog
  resource: catalog
  requirement: Consent Access RBAC Least Privilege Required
  scope: data_catalog.catalog.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce Least Privilege on Data Catalog Consent Access
  rationale: Implementing least privilege access for data catalog consent ensures that users have only the permissions necessary for their roles, reducing the risk of unauthorized data exposure and potential breaches. This is crucial for maintaining data integrity and confidentiality, especially in regulated environments where compliance with standards like GDPR and HIPAA is mandatory.
  description: This rule checks whether the Resource-Based Access Control (RBAC) policies for accessing data catalog consents are configured with the least privilege principle. To verify, examine the IAM policies assigned to user groups accessing the data catalog and ensure that permissions are limited to only those necessary for consent management tasks. Remediation involves adjusting IAM policies to remove any excessive permissions and regularly auditing them to align with organizational roles and responsibilities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/data-catalog/
- rule_id: oci.data_catalog.catalog.consent_store_encrypted
  service: data_catalog
  resource: catalog
  requirement: Consent Store Encrypted
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Consent Store Data is Encrypted at Rest
  rationale: Encrypting data at rest in the Consent Store is crucial to protect sensitive information from unauthorized access and data breaches. This practice mitigates risks such as data exfiltration and ensures compliance with regulatory frameworks like GDPR, which mandate the protection of personal data. Failure to encrypt could lead to significant financial and reputational damage in the event of a security incident.
  description: This rule checks whether data within the Oracle Cloud Infrastructure (OCI) Data Catalog's Consent Store is encrypted at rest. It verifies that encryption mechanisms are correctly configured to secure sensitive information stored within catalogs. To remediate, ensure encryption settings are enabled and configured according to OCI best practices by using Oracle-managed keys or customer-managed keys through OCI Vault. Verify the configuration in the OCI console or via OCI CLI commands.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-security/capabilities/data-encryption/
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
- rule_id: oci.data_flow.application.job_logs_and_metrics_enabled
  service: data_flow
  resource: application
  requirement: Job Logs And Metrics Enabled
  scope: data_flow.application.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Data Flow Job Logs and Metrics are Enabled
  rationale: Enabling logs and metrics for Data Flow applications is crucial for tracking job performance and identifying anomalies or failures. This enhances visibility into application behavior, aiding in quick troubleshooting and ensuring compliance with regulatory frameworks requiring detailed audit trails. Without this, organizations risk operational inefficiencies and potential non-compliance with standards like PCI-DSS and ISO 27001.
  description: This rule checks whether logging and metrics collection are enabled for Data Flow applications in Oracle Cloud Infrastructure. Ensure that job logs and metrics are configured to automatically capture execution details and performance data. Verification involves accessing the OCI Console, navigating to Data Flow applications, and confirming that logging and metrics settings are active. Remediation requires configuring application settings to enable logging and metrics, ensuring data is effectively captured and monitored.
  references:
  - https://docs.oracle.com/en-us/iaas/data-flow/using/overview.htm
  - https://www.oracle.com/cloud/cloud-infrastructure/compliance/
  - https://www.nist.gov/document-1500-11
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_flow.application.job_network_private_only_enforced
  service: data_flow
  resource: application
  requirement: Job Network Private Only Enforced
  scope: data_flow.application.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Restrict Data Flow Job Network to Private Only
  rationale: Ensuring that Data Flow jobs are restricted to private networks reduces exposure to unauthorized access and mitigates risks associated with data breaches. This practice is crucial for protecting sensitive data processed by data flow applications, aligning with compliance requirements such as PCI-DSS and ISO 27001, and reducing attack surfaces.
  description: This rule checks if Oracle Cloud Infrastructure Data Flow applications are configured to enforce private network access only. To verify, ensure that Data Flow jobs are not using public subnets and are connected solely through private endpoints. Remediation involves updating the network configuration of Data Flow applications to use private subnets, ensuring data remains within the secure boundaries of your Oracle Cloud environment.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataFlow/Concepts/dataflowoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.data_flow.application.job_role_least_privilege_required
  service: data_flow
  resource: application
  requirement: Job Role Least Privilege Required
  scope: data_flow.application.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for OCI Data Flow Applications
  rationale: Implementing least privilege for OCI Data Flow applications minimizes the risk of unauthorized access, data breaches, and potential abuse of resources. It ensures that users and roles have only the permissions necessary to perform their jobs, aligning with compliance requirements such as PCI-DSS and ISO 27001, and reducing the attack surface for insider threats and external attacks.
  description: This rule verifies that OCI Data Flow applications operate under the principle of least privilege by auditing the roles and permissions assigned to Data Flow applications. It checks for overly permissive roles that may grant unnecessary access to sensitive data or critical operations. Remediation involves reviewing the roles assigned to each application, removing excess permissions, and ensuring roles are aligned with job functions. Use OCI Identity and Access Management (IAM) policies to enforce these constraints and regularly audit permissions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataFlow/Concepts/dataflowoverview.htm
  - https://www.oracle.com/security/cloud-security/cloud-compliance/cis-benchmark/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.data_flow.application.job_script_location_private_and_encrypted
  service: data_flow
  resource: application
  requirement: Job Script Location Private And Encrypted
  scope: data_flow.application.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Job Script Location is Private and Encrypted
  rationale: Storing job scripts in a private and encrypted location mitigates unauthorized access and data breaches. It protects sensitive data processing logic from exposure and ensures compliance with data protection regulations like GDPR and HIPAA. By maintaining confidentiality and integrity, organizations reduce the risk of intellectual property theft and maintain trust with stakeholders.
  description: This rule checks that the job script location for OCI Data Flow applications is set to a private and encrypted storage bucket. Verify that the bucket's access is restricted to necessary users and that encryption is enabled either via Oracle-managed or customer-managed keys. Remediation involves configuring the bucket's access policies to limit public exposure and enabling encryption settings through the OCI console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/data-flow/latest/data-flow/using-data-flow.htm#data-flow-managing-buckets
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-security/best-practices/
- rule_id: oci.data_flow.application.ml_transform_logs_enabled
  service: data_flow
  resource: application
  requirement: Ml Transform Logs Enabled
  scope: data_flow.application.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure ML Transform Logs are Enabled for Data Flow Applications
  rationale: Enabling ML Transform Logs for Data Flow applications is crucial for maintaining a robust audit trail and enhancing visibility into data processing activities. This is vital for identifying anomalous behaviors, mitigating insider threats, and ensuring compliance with regulatory frameworks that mandate audit logging, such as SOC2 and ISO 27001. Without these logs, organizations risk undetected data breaches and non-compliance penalties.
  description: This rule verifies that ML Transform Logs are enabled for Oracle Cloud Infrastructure Data Flow applications. To ensure logging is active, check the application settings in the OCI Console under Data Flow and enable the ML Transform Logs option. Remediation involves configuring the application to send logs to an OCI Logging service, which provides centralized log storage and analysis capabilities. Regularly review these logs to detect and respond to incidents promptly.
  references:
  - https://docs.oracle.com/en-us/iaas/data-flow/latest/using/data-flow-overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloud.oracle.com/data-flow
- rule_id: oci.data_flow.application.ml_transform_network_private_only_enforced
  service: data_flow
  resource: application
  requirement: Ml Transform Network Private Only Enforced
  scope: data_flow.application.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Enforce Private Network for Data Flow ML Transform Apps
  rationale: Restricting Data Flow ML Transform applications to private networks minimizes exposure to public internet threats, reducing the risk of unauthorized access and data breaches. This control is vital for meeting compliance standards such as PCI-DSS and ISO 27001, which mandate secure processing environments.
  description: This rule checks that Data Flow ML Transform applications operate exclusively within private networks, preventing public internet exposure. Verify that the VCN (Virtual Cloud Network) is correctly configured to restrict access to private IP addresses only. Remediation involves ensuring that network security groups and subnet settings enforce private connectivity by default. Implement VCN peering where necessary to maintain private application operations across different network environments.
  references:
  - https://docs.oracle.com/en-us/iaas/data-flow/using/data-flow.htm#dataflowapps
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - CIS OCI Foundations Benchmark
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.data_flow.application.ml_transform_role_least_privilege_required
  service: data_flow
  resource: application
  requirement: Ml Transform Role Least Privilege Required
  scope: data_flow.application.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Data Flow ML Transform Roles
  rationale: Implementing least privilege for ML Transform roles in OCI Data Flow minimizes unauthorized access and potential misuse of sensitive data processing resources. Over-privileged roles can lead to data breaches, compliance violations, and financial losses, especially in environments handling regulated data under frameworks like PCI-DSS and HIPAA.
  description: This rule checks that roles assigned to Data Flow ML Transform applications adhere to the principle of least privilege by ensuring they only have permissions necessary to perform specific tasks. Verify that roles do not have excessive permissions and adjust IAM policies to limit access. Remediation involves reviewing IAM policies, auditing current role permissions, and modifying them to restrict access to only the required resources for ML transformations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataFlow/Concepts/dataflowsecurity.htm
  - https://www.oracle.com/security/cis-oci-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://www.oracle.com/cloud/cloud-security/
- rule_id: oci.data_science.project.dev_endpoint_encrypted
  service: data_science
  resource: project
  requirement: Dev Endpoint Encrypted
  scope: data_science.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Dev Endpoints Are Encrypted in Data Science Projects
  rationale: Encrypting development endpoints in data science projects is crucial to prevent unauthorized access to sensitive data, which could lead to data breaches or intellectual property theft. This practice mitigates the risk of data leakage and aligns with regulatory requirements for data protection, such as GDPR and CCPA, ensuring that sensitive information remains confidential and secure.
  description: This rule checks if development endpoints in Oracle Cloud Infrastructure Data Science projects are configured to use encryption at rest. By verifying that all endpoints are encrypted, you ensure that data stored within these endpoints is protected against unauthorized access. To remediate, ensure that encryption settings are enabled in the OCI console under the Data Science project's development endpoints configuration. Use OCI's built-in encryption features to comply with best practices and regulatory standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/datascienceoverview.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-foundations-benchmark.pdf
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/encryption/
- rule_id: oci.data_science.model_deployment.dev_endpoint_no_public_access_blocked
  service: data_science
  resource: model_deployment
  requirement: Dev Endpoint No Public Access Blocked
  scope: data_science.model_deployment.public_access
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: critical
  title: Block Public Access to Dev Endpoints in Model Deployment
  rationale: Public access to development endpoints in OCI Data Science Model Deployment poses significant security risks, including unauthorized access to sensitive data and intellectual property. Ensuring endpoints are not publicly accessible mitigates the risk of data breaches and aligns with compliance requirements such as GDPR and CCPA, which mandate data protection and privacy controls.
  description: This rule verifies that development endpoints within OCI Data Science Model Deployments are not publicly accessible. It checks the network security settings of model deployments to ensure that public internet access is blocked. To remediate, configure security rules to restrict access to trusted IP addresses or private networks only, leveraging OCI's Virtual Cloud Network (VCN) and Security Lists or Network Security Groups (NSGs). Ensure that any public IP associations are removed from the deployment configuration.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/data-science-models.htm
  - https://www.oracle.com/security-cloud/compliance/gdpr/
  - https://www.oracle.com/a/ocom/docs/cloud/oci-security-whitepaper.pdf
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingsecuritylists.htm
- rule_id: oci.data_science.model_deployment.dev_endpoint_role_least_privilege_required
  service: data_science
  resource: model_deployment
  requirement: Dev Endpoint Role Least Privilege Required
  scope: data_science.model_deployment.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Dev Endpoint Role in Model Deployment
  rationale: Implementing least privilege for model deployment endpoints minimizes the risk of unauthorized access and potential data breaches. It protects sensitive data within machine learning models and ensures that only necessary permissions are granted, aligning with regulatory requirements such as GDPR and HIPAA. Failing to restrict permissions could lead to data exposure, model manipulation, and compliance violations.
  description: This rule verifies that roles associated with development endpoints in OCI Data Science model deployments are configured with the least privilege principle. It checks for excessive permissions that may allow access beyond what is necessary for development tasks. To comply, audit and adjust the IAM policies to ensure roles have only the essential permissions needed. Remediation involves reviewing and modifying IAM policies to remove unnecessary privileges, ensuring alignment with business and security requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/datascienceroles.htm
  - https://www.oracle.com/cloud/cloud-security/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.data_integration.pipeline.data_pipeline_security_object_environment_no_plaintext_secrets
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Object Environment No Plaintext Secrets
  scope: data_integration.pipeline.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure No Plaintext Secrets in Data Pipeline Environment
  rationale: Storing secrets in plaintext within data pipeline environments exposes sensitive information to unauthorized access, leading to potential data breaches and non-compliance with regulations like GDPR and PCI-DSS. Encrypting secrets mitigates the risk of data exfiltration and maintains the integrity and confidentiality of critical business data.
  description: This rule checks that no plaintext secrets are stored in the environment variables of OCI Data Integration pipelines. Ensuring secrets are encrypted at rest involves configuring the OCI Vault to securely store and manage sensitive data. Verify by auditing data pipeline configurations and implementing OCI Vault for secret management. Remediation involves migrating plaintext secrets to OCI Vault and updating pipeline configurations to retrieve and use these encrypted secrets.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/data-integration-overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingvaults.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.data_integration.pipeline.data_pipeline_security_object_execution_role_required
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Object Execution Role Required
  scope: data_integration.pipeline.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Execution Role Assignment for Data Pipelines
  rationale: Assigning an execution role to data pipelines in OCI is crucial to prevent unauthorized access and execution. Without a specified role, pipelines could be exploited to gain access to sensitive data or to execute unauthorized operations, leading to potential data breaches and non-compliance with regulations such as PCI-DSS and GDPR.
  description: This rule checks that each data integration pipeline in OCI has a designated execution role to ensure operations are properly authenticated and authorized. Verify that the 'executionRole' attribute is set for every pipeline configuration. To remediate, assign an appropriate IAM role that grants the necessary permissions for pipeline execution while adhering to the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/data-integrationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/cloud/cloud-security.html
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.data_integration.workspace.data_pipeline_security_object_logging_enabled
  service: data_integration
  resource: workspace
  requirement: Data Pipeline Security Object Logging Enabled
  scope: data_integration.workspace.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Logging for Data Integration Pipeline Security
  rationale: Enabling logging for data integration pipeline security is crucial for detecting unauthorized access and mitigating potential data breaches. This practice enhances visibility into data processing activities, supports incident response efforts, and helps meet compliance requirements related to data protection laws such as GDPR and CCPA.
  description: This rule checks whether logging for security objects in OCI Data Integration pipelines is enabled. Specifically, it verifies that audit logs are configured to capture activities related to data pipeline operations. To ensure compliance, enable logging by navigating to the OCI Console, selecting the Data Integration service, and configuring the workspace to send logs to an appropriate logging service. This enables continuous monitoring and alerting on suspicious activities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/dataintegrationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.oracle.com/security/cis-benchmarks/
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.oracle.com/cloud/cloud-security.html
  - https://www.oracle.com/a/ocom/docs/oci-security-architecture.pdf
- rule_id: oci.data_integration.pipeline.data_pipeline_security_object_network_private_only_enforced
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Object Network Private Only Enforced
  scope: data_integration.pipeline.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Enforce Private Network Access for Data Integration Pipelines
  rationale: Restricting data pipelines to private networks minimizes exposure to potential attacks, reducing the risk of unauthorized access, data breaches, and compliance violations. This is crucial for maintaining data confidentiality and integrity, especially when processing sensitive or regulated data.
  description: This rule checks if data integration pipelines in OCI are configured to operate exclusively within private networks, preventing access from public endpoints. To verify, ensure that network security groups (NSGs) and security lists are configured to limit traffic to private IP addresses only. Remediation involves reviewing and updating NSG rules to prohibit public IP access, and ensuring all data transfer occurs over secure, internal networks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/data-integration-overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networksecuritygroups.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations_benchmark
  - https://www.oracle.com/cloud/networking/virtual-cloud-network/
- rule_id: oci.data_integration.workspace.quality_jobs_role_least_privilege_required
  service: data_integration
  resource: workspace
  requirement: Quality Jobs Role Least Privilege Required
  scope: data_integration.workspace.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce Least Privilege for Data Integration Workspace Roles
  rationale: Granting excessive permissions can lead to unauthorized access and data breaches, impacting business operations and compliance with standards like PCI-DSS and ISO 27001. Limiting roles to the least privilege necessary reduces the attack surface and mitigates the risk of insider threats and privilege escalation.
  description: This rule checks if roles assigned to Data Integration Workspace resources adhere to the principle of least privilege. Review and adjust roles to ensure they only include permissions essential for job functions. Verify current role configurations in the OCI Console and use policies that limit access to necessary operations. Implementing least privilege helps secure sensitive data and maintains compliance with security frameworks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/di_overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_integration.workspace.quality_logs_enabled
  service: data_integration
  resource: workspace
  requirement: Quality Logs Enabled
  scope: data_integration.workspace.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Quality Logs for Data Integration Workspaces
  rationale: Enabling quality logs for Data Integration Workspaces ensures visibility into data processing activities, helping to detect anomalies and unauthorized access. This is crucial for maintaining data integrity and meeting compliance requirements such as GDPR and CCPA, which mandate robust logging and monitoring practices to protect sensitive information.
  description: This rule checks whether quality logs are enabled in OCI Data Integration Workspaces to capture detailed records of data operations. Enabling these logs allows for comprehensive auditing and monitoring, providing insights into data transformations and data flow activities. To verify, ensure the logging service is configured to capture quality logs for each workspace. Remediation involves accessing the OCI Console, navigating to the Data Integration service, and configuring the workspace to enable detailed logging under the 'Logging' section.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/dataintegrationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.oracle.com/security/cloud-compliance/
  - NIST SP 800-53 Rev. 5 - Audit and Accountability
  - CIS OCI Foundations Benchmark v1.1.0
  - https://gdpr-info.eu/
- rule_id: oci.data_integration.workspace.quality_outputs_encrypted_and_private
  service: data_integration
  resource: workspace
  requirement: Quality Outputs Encrypted And Private
  scope: data_integration.workspace.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Integration Workspace Outputs are Encrypted and Private
  rationale: Encrypting data integration workspace outputs protects sensitive information from unauthorized access and potential data breaches. This is crucial to comply with data protection regulations such as GDPR and CCPA, and to mitigate risks associated with data leaks, ensuring business continuity and customer trust.
  description: This rule checks that all outputs from OCI Data Integration workspaces are encrypted at rest and are not publicly accessible. Verify that encryption is enabled by default for all data outputs using Oracle-managed keys or customer-managed keys. Ensure that access policies are configured to restrict public access and only allow authorized user interactions. Remediation involves enabling encryption settings in the OCI Console and reviewing IAM policies to enforce strict access controls.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/dataintegrationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/securitypolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.data_integration.connection.connection_credentials_in_secrets_manager
  service: data_integration
  resource: connection
  requirement: Connection Credentials In Secrets Manager
  scope: data_integration.connection.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure OCI Data Integration Connections Use Secrets Manager
  rationale: Storing connection credentials in OCI Secrets Manager reduces risk of credential exposure, ensuring that sensitive data is protected from unauthorized access. It aligns with compliance requirements such as GDPR, PCI-DSS, and ISO 27001, which mandate secure management of sensitive information. Failing to use a secure storage solution for credentials can lead to data breaches, financial loss, and reputational damage.
  description: This rule verifies that connection credentials in OCI Data Integration are stored in the OCI Secrets Manager. Using Secrets Manager helps protect credentials by encrypting them and managing access through IAM policies. To verify, check that connections are configured to reference secret OCIDs stored in Secrets Manager. Remediate by updating connections to use Secrets Manager for credentials, ensuring proper IAM policies are applied to control access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Tasks/usingconnections.htm
  - https://www.oracle.com/security/cloud-security/secrets-management/
  - CIS OCI Foundations Benchmark v1.1.0, Section 3.4
  - 'NIST SP 800-53 Rev. 5: Access Control (AC-3) & System and Communications Protection (SC-28)'
  - 'PCI DSS Requirement 3: Protect Stored Cardholder Data'
- rule_id: oci.data_integration.workspace.connection_private_networking_enforced
  service: data_integration
  resource: workspace
  requirement: Connection Private Networking Enforced
  scope: data_integration.workspace.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Enforce Private Networking for Data Integration Workspaces
  rationale: Enforcing private networking for data integration workspaces minimizes exposure to public internet threats, reducing the risk of unauthorized access and data breaches. It ensures that data transfer occurs within secure, private networks, which is crucial for maintaining data confidentiality and integrity, especially for organizations subject to stringent compliance requirements like PCI-DSS and HIPAA.
  description: This rule checks if the data integration workspaces are configured to use private networking, ensuring that all connections are restricted to private IP addresses. To verify, review the workspace network settings in the OCI Console and ensure that 'Allow access from public networks' is disabled. Remediation involves configuring a Virtual Cloud Network (VCN) with appropriate security lists and route tables to facilitate secure, private connectivity for data integration tasks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Tasks/workspaces.htm
  - https://www.oracle.com/security/cloud-security/cloud-security-controls.html
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.oracle.com/cloud/networking/
- rule_id: oci.data_integration.connection.connection_role_least_privilege_required
  service: data_integration
  resource: connection
  requirement: Connection Role Least Privilege Required
  scope: data_integration.connection.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce Least Privilege for Data Integration Connection Roles
  rationale: Implementing least privilege for connection roles minimizes the risk of unauthorized access and potential data breaches, which can lead to significant financial losses and reputational damage. This practice is crucial for maintaining compliance with regulatory requirements such as PCI-DSS and HIPAA, which mandate strict access controls to protect sensitive data.
  description: This rule checks if data integration connections in OCI are configured with roles that grant only the necessary permissions required for their function. Verify that each connection role is assigned based on the principle of least privilege, ensuring no excessive permissions are granted. Remediate by reviewing and adjusting role permissions in the OCI Console under Identity and Access Management, ensuring they align with the specific needs of the connection while avoiding unnecessary access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/dataintegrationoverview.htm
  - https://www.oracle.com/security/cloud-security/cloud-security-posture-management-cspm/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/index.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.data_integration.workspace.connection_tls_required
  service: data_integration
  resource: workspace
  requirement: Connection TLS Required
  scope: data_integration.workspace.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure TLS is Enabled for Data Integration Workspace Connections
  rationale: Enforcing TLS for connections in Oracle Cloud Infrastructure Data Integration Workspaces is crucial for protecting data in transit. Without TLS, sensitive data can be intercepted by attackers during transmission, leading to potential data breaches and non-compliance with data privacy regulations such as HIPAA or GDPR. TLS provides encryption and integrity, mitigating risks of unauthorized access and data tampering.
  description: This rule checks that all connections to Data Integration Workspace endpoints are configured to require TLS. TLS configuration ensures that data is encrypted during transit between OCI services and external endpoints. To verify, inspect the Data Integration Workspace settings and ensure TLS is enabled for all connections. Remediation involves updating the connection configurations to enforce TLS, which may require adjusting endpoint settings and ensuring compatible TLS versions are used.
  references:
  - https://docs.oracle.com/en-us/iaas/data-integration/using/data-integration-overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/itl/smallbusinesscyber/guidance
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://cloudsecurityalliance.org/artifacts/security-guidance-v4-for-critical-areas-of-focus-in-cloud-computing/
- rule_id: oci.data_integration.workspace.data_quality_logs_enabled
  service: data_integration
  resource: workspace
  requirement: Data Quality Logs Enabled
  scope: data_integration.workspace.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Data Quality Logs in OCI Data Integration Workspaces
  rationale: Enabling data quality logs in OCI Data Integration workspaces is crucial for maintaining data integrity, identifying anomalies, and ensuring that data processing adheres to organizational quality standards. Without these logs, businesses risk undetected data corruption or processing errors that could lead to inaccurate analytics, compliance violations, and potential data breaches.
  description: This rule checks if data quality logs are enabled in OCI Data Integration workspaces. Logging must be configured to capture all data processing activities, including transformations and data flow executions, to facilitate troubleshooting and maintain audit trails. To verify, ensure that logging is enabled within the OCI console under the Data Integration service settings. Remediation involves accessing the workspace settings and enabling the logging feature with the appropriate log group and compartment configured.
  references:
  - https://docs.oracle.com/en-us/iaas/data-integration/using/logging.html
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.data_integration.workspace.data_quality_output_location_private_and_encrypted
  service: data_integration
  resource: workspace
  requirement: Data Quality Output Location Private And Encrypted
  scope: data_integration.workspace.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Quality Output is Secure and Encrypted in OCI
  rationale: Securing the Data Quality Output Location by ensuring it is both private and encrypted mitigates the risk of unauthorized access and data breaches. Encrypting data at rest addresses potential threats such as data theft or exposure due to misconfigurations, thus supporting compliance with regulations like GDPR and HIPAA that mandate data protection and privacy.
  description: This check verifies that the Data Quality Output Location within an OCI Data Integration Workspace is configured to be private and encrypted. To ensure compliance, the storage bucket used must have encryption enabled, and access should be restricted to authorized OCI services and users. Remediation involves configuring the storage bucket with Oracle-managed keys or customer-managed keys for encryption and setting bucket policies to enforce private access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/data-integration-overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/commonpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.oracle.com/security/cloud-security/
  - https://cloud.oracle.com/storage/buckets
  - https://www.nist.gov/cyberframework
- rule_id: oci.data_integration.workspace.data_quality_role_least_privilege_required
  service: data_integration
  resource: workspace
  requirement: Data Quality Role Least Privilege Required
  scope: data_integration.workspace.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Data Integration Workspace Roles
  rationale: Enforcing least privilege on Data Integration workspaces ensures that users have only the necessary permissions to perform their tasks, reducing the risk of insider threats and accidental data exposure. It mitigates the impact of compromised credentials and aligns with compliance requirements like SOC2 and ISO 27001, which mandate access controls and data protection.
  description: This rule checks if roles assigned to users in the OCI Data Integration service adhere to the principle of least privilege. Specifically, it verifies that users have the minimum set of permissions required for their job functions. To remediate, review the roles and permissions assigned to each user in the workspace and adjust them to limit access to the least privilege necessary. Utilize OCI IAM policies to define and enforce these permissions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/dataintegrationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/security/cis-oracle-cloud-infrastructure-foundations-benchmark/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.data_integration.workspace.data_quality_security_rule_definition_version_pinned_required
  service: data_integration
  resource: workspace
  requirement: Data Quality Security Rule Definition Version Pinned Required
  scope: data_integration.workspace.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Integration Workspace Version Locking
  rationale: Version pinning in Data Integration ensures consistent execution environments, reducing risk of unplanned disruptions or security vulnerabilities from untested updates. This practice is crucial for maintaining data integrity and compliance with industry regulations that mandate controlled changes in data processing environments.
  description: This rule checks whether the Data Integration Workspace has pinned versions for its security rule definitions. Pinning versions ensures that updates do not automatically alter the security posture of the environment, allowing for controlled testing and deployment. To verify, navigate to the OCI Console, access the Data Integration Workspace settings, and ensure version pinning is enabled under security configurations. Remediate by setting a specific version for security rules through the OCI Console or API.
  references:
  - https://docs.oracle.com/en-us/iaas/data-integration/doc/workspace.html
  - https://www.oracle.com/security/cloud-security/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_integration.pipeline.data_quality_security_rule_parameters_no_plaintext_secrets
  service: data_integration
  resource: pipeline
  requirement: Data Quality Security Rule Parameters No Plaintext Secrets
  scope: data_integration.pipeline.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure No Plaintext Secrets in Data Integration Pipelines
  rationale: Storing secrets in plaintext within data integration pipelines exposes sensitive information to unauthorized access, increasing the risk of data breaches and non-compliance with regulations such as PCI-DSS and HIPAA. Protecting these secrets is crucial for maintaining data integrity, confidentiality, and the trust of stakeholders by adhering to best practices for data protection and privacy.
  description: This rule checks for the presence of plaintext secrets in security rule parameters within Oracle Cloud Infrastructure (OCI) Data Integration pipelines. It ensures that sensitive information such as API keys, passwords, and tokens are not exposed in plaintext format. To verify compliance, inspect pipeline configurations for encrypted secret management practices. Remediation involves using OCI Vault to securely manage and access secrets, ensuring all sensitive data is encrypted both in transit and at rest.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/using/home.htm
  - https://www.oracle.com/cloud/security/oci-best-practices/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.hipaajournal.com/hipaa-compliance-checklist/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_integration.workspace.data_quality_security_rule_source_trusted
  service: data_integration
  resource: workspace
  requirement: Data Quality Security Rule Source Trusted
  scope: data_integration.workspace.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Trusted Sources for Data Quality in OCI Workspaces
  rationale: Ensuring that only trusted sources are used for data quality rules in OCI Data Integration Workspaces is crucial to prevent unauthorized data access and manipulation. Trusted sources help maintain data integrity, reduce the risk of data breaches, and comply with regulations like GDPR and CCPA that mandate strict data protection measures.
  description: This rule checks that all data quality rules in OCI Data Integration Workspaces are sourced from trusted origins. It involves configuring access controls to ensure only authorized entities can create or modify data quality rules. To verify compliance, review the workspace settings and ensure that data sources are validated and listed as trusted. Remediation includes updating access policies and validating sources through established security and compliance protocols.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/workspaces.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security.html
  - https://www.oracle.com/cloud/oci-compliance/
- rule_id: oci.data_integration.workspace.data_quality_security_recommendation_access_rbac_required
  service: data_integration
  resource: workspace
  requirement: Data Quality Security Recommendation Access RBAC Required
  scope: data_integration.workspace.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enforce RBAC for Data Integration Workspace Access
  rationale: Implementing Role-Based Access Control (RBAC) for OCI Data Integration workspaces is critical to ensure that only authorized users have access to sensitive data processing resources. Without proper RBAC, organizations risk unauthorized access, which can lead to data breaches, non-compliance with data protection regulations, and potential financial and reputational harm.
  description: This rule verifies that RBAC is enforced for accessing Data Integration workspaces in OCI. It checks if access policies are configured to restrict operations based on user roles and responsibilities. To remediate, configure OCI Identity and Access Management (IAM) policies to assign least privilege access to users and service principals. Regularly audit and update these policies to adapt to changing organizational roles and compliance requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/workspaces.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/Oracle_cloud_computing_services
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/standard/54534.html
- rule_id: oci.data_integration.workspace.data_quality_security_recommendation_outputs_encrypted_and_private
  service: data_integration
  resource: workspace
  requirement: Data Quality Security Recommendation Outputs Encrypted And Private
  scope: data_integration.workspace.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Outputs in Data Integration Workspace are Encrypted and Private
  rationale: Encrypting and securing data quality outputs within OCI Data Integration workspaces prevents unauthorized access and potential data breaches. This ensures sensitive business intelligence and analytics data remain confidential, reducing risks of non-compliance with regulations such as GDPR, PCI-DSS, and HIPAA. Encrypting data at rest addresses threat scenarios related to data theft and insider threats, preserving customer trust and organizational reputation.
  description: This rule checks if data quality outputs in OCI Data Integration workspaces are encrypted and restricted to authorized users. Verify that all outputs are stored using OCI's encryption capabilities, such as Oracle-managed keys or customer-managed keys. Ensure access controls are in place to limit data visibility to necessary personnel only. Remediate by configuring encryption settings in the OCI console and reviewing IAM policies to enforce principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/data-integration/doc/data-security.html
  - https://www.oracle.com/security/cloud-security/oci-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.oracle.com/security/cloud-security/identity-and-access-management/
- rule_id: oci.data_integration.workspace.data_quality_security_recommendation_run_metadata_logging_enabled
  service: data_integration
  resource: workspace
  requirement: Data Quality Security Recommendation Run Metadata Logging Enabled
  scope: data_integration.workspace.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Data Quality Run Metadata Logging is Enabled
  rationale: Enabling metadata logging for data quality runs in OCI Data Integration enhances auditability and transparency, which are crucial for identifying unauthorized access attempts and unusual activities. This practice mitigates security risks by allowing organizations to track and investigate potential data breaches or compliance violations, aligning with regulatory requirements such as GDPR and CCPA for data protection and accountability.
  description: This rule checks if metadata logging is activated for data quality runs within OCI Data Integration workspaces. To verify, examine the workspace configuration to ensure logging is enabled for all data quality operations. If not enabled, configure the logging settings in the OCI console under the Data Integration service to capture detailed metadata logs. This enhances security monitoring and supports incident response activities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/dataintegrationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_oci_cis.htm
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/cloud-security-best-practices/
- rule_id: oci.data_integration.workspace.data_quality_security_ruleset_encrypted_at_rest
  service: data_integration
  resource: workspace
  requirement: Data Quality Security Ruleset Encrypted At Rest
  scope: data_integration.workspace.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Integration Workspace Encryption at Rest
  rationale: Encrypting data at rest is crucial to protect sensitive information from unauthorized access and potential data breaches. Inadequate encryption can lead to data exposure, resulting in financial loss, reputational damage, and non-compliance with regulatory standards such as GDPR and CCPA. By ensuring encryption at rest, organizations mitigate risks associated with data interception and unauthorized data retrieval.
  description: This rule checks that all data stored within Oracle Cloud Infrastructure (OCI) Data Integration Workspaces is encrypted at rest using OCI's native encryption mechanisms. Users should verify that encryption settings are properly configured by reviewing the workspace's security configurations in the OCI console. Remediation involves enabling encryption at rest for any non-compliant workspaces by configuring OCI Vault or using OCI's default encryption with Oracle-managed keys, ensuring that data is securely encrypted.
  references:
  - https://docs.oracle.com/en/cloud/paas/data-integration/data-integration/access-control-and-encryption.html
  - 'CIS OCI Benchmark: https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure'
  - 'NIST SP 800-53: https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf'
  - 'PCI-DSS Requirement 3: https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf'
  - 'ISO 27001 Annex A.10: https://www.iso.org/standard/54534.html'
- rule_id: oci.data_integration.workspace.data_quality_security_ruleset_rbac_least_privilege_required
  service: data_integration
  resource: workspace
  requirement: Data Quality Security Ruleset RBAC Least Privilege Required
  scope: data_integration.workspace.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce Least Privilege for Data Integration Workspace RBAC
  rationale: Implementing least privilege in RBAC for Data Integration workspaces minimizes the risk of unauthorized access and potential data breaches. It helps protect sensitive data and aligns with compliance requirements by ensuring that users have only the necessary permissions to perform their job functions, reducing the attack surface and potential insider threats.
  description: This rule checks that IAM policies for Data Integration workspaces adhere to the principle of least privilege. It verifies that roles are appropriately assigned, ensuring users have only the necessary permissions to access and manage Data Integration resources. To comply, review IAM policies and roles, adjusting them to limit access based on job responsibilities. Utilize OCI's policy statements to refine access control and regularly audit permissions to maintain compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/data-integration/overview.htm
  - CIS Oracle Cloud Infrastructure Foundations Benchmark
  - NIST SP 800-53 Revision 5
  - ISO/IEC 27001:2013
  - https://www.oracle.com/security-cloud/compliance/
- rule_id: oci.data_integration.workspace.data_quality_security_ruleset_version_immutable_required
  service: data_integration
  resource: workspace
  requirement: Data Quality Security Ruleset Version Immutable Required
  scope: data_integration.workspace.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Immutable Data Quality Ruleset Version in OCI Workspaces
  rationale: Immutable data quality ruleset versions in OCI Data Integration workspaces help maintain data integrity and prevent unauthorized modifications, which is crucial for protecting sensitive and regulated data. This control mitigates risks of data corruption and supports compliance with data protection regulations such as GDPR and HIPAA by ensuring that data processing rules are consistent and tamper-proof.
  description: This rule checks whether the data quality security ruleset versions in OCI Data Integration workspaces are immutable. Ensuring immutability prevents changes to rulesets after creation, thereby safeguarding the integrity of data processing pipelines. To verify, review the workspace's configuration settings in the OCI Console under Data Integration and ensure that ruleset versions are set to immutable. If not, modify the workspace configuration to enforce immutability, thus enhancing data security and compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/dataintegrationoverview.htm
  - https://docs.oracle.com/en-us/iaas/data-integration/cis-oci-benchmark.htm
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/document_library
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.data_integration.workspace.data_quality_security_recommendation_run_execution_required
  service: data_integration
  resource: workspace
  requirement: Data Quality Security Recommendation Run Execution Required
  scope: data_integration.workspace.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enforce Data Quality Security Run in OCI Data Integration
  rationale: Ensuring that data quality security recommendations are executed is crucial for maintaining the integrity and confidentiality of data processed within the OCI Data Integration workspace. Failure to implement these recommendations can expose sensitive data to unauthorized access, leading to potential breaches that could have regulatory consequences under frameworks like GDPR and CCPA. Additionally, it helps mitigate risks of data corruption and loss, which can impact business operations and decision-making processes.
  description: This rule checks whether the OCI Data Integration workspace has executed data quality security recommendations to ensure encryption at rest is properly configured. Administrators should verify that all data quality checks are completed and any deficiencies are addressed promptly. Remediation involves reviewing the workspace configurations to ensure compliance with recommended security practices, such as implementing encryption for sensitive data and applying Oracle Cloud's best practices for data protection.
  references:
  - https://docs.oracle.com/en-us/iaas/data-integration/using/data-integration-overview.htm
  - https://www.oracle.com/security-cloud/standards-compliance/
  - CIS OCI Foundations Benchmark
  - https://www.nist.gov/cyberframework
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
- rule_id: oci.data_integration.workspace.data_quality_security_recommendation_run_logs_enabled
  service: data_integration
  resource: workspace
  requirement: Data Quality Security Recommendation Run Logs Enabled
  scope: data_integration.workspace.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Data Quality Run Logs in Data Integration Workspaces
  rationale: Enabling Data Quality Security Recommendation Run Logs in OCI Data Integration Workspaces is crucial for maintaining comprehensive audit trails, which help identify and mitigate potential data integrity issues and unauthorized access. This practice supports compliance with regulatory requirements by ensuring that all data quality operations are logged and auditable, reducing the risk of data breaches and enhancing organizational accountability.
  description: This check verifies that Data Quality Security Recommendation Run Logs are enabled in OCI Data Integration Workspaces to track data quality evaluations and recommendations. To verify, ensure that logging is configured in the OCI Console under the Data Integration Workspace settings, and that logs are being directed to an appropriate logging service. Remediation involves configuring the workspace settings to enable logging, setting up a log group, and ensuring that appropriate permissions are granted for log access and analysis.
  references:
  - https://docs.oracle.com/en-us/iaas/data-integration/doc/using-data-integration.html#GUID-9D3F9A96-FFC4-4D58-8A42-123456789ABC
  - https://www.oracle.com/security/cis-oracle-cloud-infrastructure/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.hipaajournal.com/hipaa-compliance-guide/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_integration.workspace.data_quality_security_recommendation_run_output_encrypted_private
  service: data_integration
  resource: workspace
  requirement: Data Quality Security Recommendation Run Output Encrypted Private
  scope: data_integration.workspace.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Integration Run Output is Encrypted and Private
  rationale: Encrypting data integration run outputs protects sensitive information from unauthorized access and potential data breaches, mitigating risks associated with data exposure. This is crucial for maintaining client trust and complying with regulations like GDPR and CCPA, which mandate data protection and privacy. Non-compliance can result in significant financial penalties and reputational damage.
  description: This rule checks if the data integration workspace's run outputs are encrypted at rest using OCI's native encryption features. Ensure that all data outputs are stored in Oracle Cloud Infrastructure Object Storage with encryption enabled. Verify that the 'Encryption' setting in the workspace configuration is set to 'Enabled'. Remediation involves updating the workspace settings to enforce encryption on all data outputs, thereby securing data in compliance with organizational and regulatory standards.
  references:
  - https://docs.oracle.com/en-us/iaas/data-integration/doc/data-integration-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_oss.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.data_integration.data_flow.workflow_cross_account_trusts_restricted
  service: data_integration
  resource: data_flow
  requirement: Workflow Cross Account Trusts Restricted
  scope: data_integration.data_flow.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Restrict Cross-Account Trusts in Data Integration Workflows
  rationale: Limiting cross-account trusts in data integration workflows is crucial to prevent unauthorized data access and maintain data integrity. Unrestricted trusts can lead to accidental or intentional exposure of sensitive information, violating privacy regulations such as GDPR and CCPA. Ensuring strict trust boundaries mitigates risks associated with data breaches and aligns with compliance requirements.
  description: This rule checks if cross-account trusts in OCI Data Integration workflows are restricted to prevent unauthorized access. Ensure that only necessary accounts have trust relationships, and regularly review these settings for compliance with data protection policies. Use OCI Identity and Access Management (IAM) to define and enforce precise trust policies. Remediation involves auditing the current trust configurations and modifying IAM policies to limit access appropriately.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataFlow/Concepts/dataflowoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/cloud-infrastructure-compliance/
  - https://www.nist.gov/itl/applied-cybersecurity/nist-cybersecurity-framework
- rule_id: oci.data_integration.data_flow.workflow_execution_role_least_privilege_required
  service: data_integration
  resource: data_flow
  requirement: Workflow Execution Role Least Privilege Required
  scope: data_integration.data_flow.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Data Flow Execution Roles
  rationale: Applying the principle of least privilege to data flow execution roles minimizes security risks such as unauthorized access and data breaches by ensuring that roles have only the necessary permissions to perform their tasks. This practice aligns with compliance requirements like GDPR and HIPAA, reducing the risk of non-compliance penalties and enhancing the overall security posture of the organization.
  description: This rule checks if the execution roles assigned to OCI Data Flow workflows are configured with the least privilege necessary to perform their designated functions. It involves verifying that roles do not have excessive permissions beyond what is needed for data flow execution. To remediate, review and adjust IAM policies associated with the roles to limit permissions strictly to required actions. Implement continuous monitoring to detect and rectify any deviations from the least privilege model.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataFlow/Concepts/dataflowauth.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/securitypolicies.htm
  - CIS OCI Foundations Benchmark
  - https://www.iso.org/standard/54534.html
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.data_integration.workspace.workflow_kms_encryption_enabled
  service: data_integration
  resource: workspace
  requirement: Workflow KMS Encryption Enabled
  scope: data_integration.workspace.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable KMS Encryption for Data Integration Workflows
  rationale: Enabling KMS encryption for OCI Data Integration workflows protects sensitive data from unauthorized access and potential breaches. This is crucial for maintaining data confidentiality, integrity, and compliance with data protection regulations such as GDPR and CCPA. Failure to encrypt sensitive data at rest may lead to data exposure, financial penalties, and loss of customer trust.
  description: This check ensures that all OCI Data Integration workspaces have KMS encryption enabled for workflows. To verify, navigate to the Data Integration service in the OCI Console, select the workspace, and confirm that a Key Management Service (KMS) key is associated with the workspace for encryption. Remediation involves configuring a KMS key within the OCI Console and associating it with the relevant workspace to ensure all data processed by workflows is encrypted at rest.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Tasks/encryptingdataatrest.htm
  - https://www.oracle.com/security-cloud/data-encryption-and-tokenization/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://www.cisecurity.org/benchmark/oracle/
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://www.iso.org/standard/54534.html
- rule_id: oci.data_integration.workspace.job_logs_and_metrics_enabled
  service: data_integration
  resource: workspace
  requirement: Job Logs And Metrics Enabled
  scope: data_integration.workspace.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Job Logs and Metrics for Data Integration Workspaces
  rationale: Enabling job logs and metrics in OCI Data Integration workspaces is crucial for monitoring and auditing data transformation processes. It helps identify anomalies, troubleshoot errors, and ensure compliance with security policies by providing visibility into job execution and resource utilization. Without these logs, organizations face increased risk of undetected breaches or inefficiencies, potentially impacting data integrity and operational effectiveness.
  description: This rule checks whether job logs and metrics are enabled for Data Integration workspaces in Oracle Cloud Infrastructure. To verify, ensure that logging is configured in the OCI console under the Data Integration service by navigating to the specific workspace settings and enabling the logging feature. Remediation involves configuring the workspace to send logs and metrics to the OCI Logging and Monitoring services, facilitating real-time insights and historical analysis. This setup aids in proactive incident response and compliance adherence.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/logging.htm
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
- rule_id: oci.data_integration.workspace.job_network_private_only_enforced
  service: data_integration
  resource: workspace
  requirement: Job Network Private Only Enforced
  scope: data_integration.workspace.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Enforce Private Network Access for Data Integration Jobs
  rationale: Restricting Data Integration jobs to private networks minimizes the risk of unauthorized access and data exfiltration by ensuring that data flows within secure, controlled environments. This practice aligns with compliance mandates that require sensitive data to be protected from exposure to public networks, reducing the attack surface and enhancing data confidentiality.
  description: This rule checks that all Data Integration jobs within a workspace are configured to run exclusively on private networks. To verify, ensure that the network settings for each job disallow public internet access, using VCNs and private IP addresses within OCI. Remediation involves modifying job configurations to utilize only private networks, leveraging OCI's VCN and subnet capabilities to enforce this policy.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/dataintegrationoverview.htm
  - https://www.oracle.com/cloud/cloud-security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
- rule_id: oci.data_integration.workspace.job_role_least_privilege_required
  service: data_integration
  resource: workspace
  requirement: Job Role Least Privilege Required
  scope: data_integration.workspace.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce Least Privilege for Data Integration Workspace Roles
  rationale: Implementing the principle of least privilege for job roles in OCI Data Integration workspaces reduces the attack surface by limiting access rights to only those necessary for job functions. This minimizes potential damage from insider threats or compromised accounts and aligns with compliance standards such as NIST and ISO 27001, which emphasize strict access control policies.
  description: This rule checks if Data Integration workspace roles are configured with the minimum permissions necessary for operation. It assesses the roles assigned to users and automated processes to ensure they do not exceed their intended access levels. To verify compliance, review role assignments in the OCI console and adjust policies to restrict permissions to necessary operations only. Remediation involves auditing current roles and updating IAM policies to eliminate unnecessary permissions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/data_integration.htm
- rule_id: oci.data_integration.workspace.job_script_location_private_and_encrypted
  service: data_integration
  resource: workspace
  requirement: Job Script Location Private And Encrypted
  scope: data_integration.workspace.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Job Scripts Are Stored Privately and Encrypted
  rationale: Storing job scripts in a private and encrypted manner protects sensitive business logic from unauthorized access and data breaches. This practice mitigates risks of intellectual property theft and ensures compliance with data protection regulations such as GDPR and CCPA, safeguarding organizational reputation and customer trust.
  description: This rule checks that job scripts within the OCI Data Integration workspace are stored in locations that are both private and encrypted. It requires setting up security lists and policies to restrict access to authorized users only, and enabling encryption settings to protect data at rest. Remediation involves verifying and configuring storage buckets to use OCI's Object Storage with encryption enabled and access controls set to private.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/data-integration-overview.htm
  - https://www.oracle.com/security/cloud-security/data-encryption/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-1-2-0.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.data_safe.data_safe_configuration.compliance_access_rbac_least_privilege_required
  service: data_safe
  resource: data_safe_configuration
  requirement: Compliance Access RBAC Least Privilege Required
  scope: data_safe.data_safe_configuration.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Data Safe Configurations Follow Least Privilege Principles
  rationale: Implementing the principle of least privilege in Data Safe configurations minimizes the risk of unauthorized access to sensitive data. Inadequate access controls can lead to data breaches, compromising intellectual property and customer data, which may result in financial loss and regulatory penalties under frameworks like GDPR and PCI-DSS.
  description: This rule verifies that all roles and permissions assigned within the Data Safe configurations adhere to the least privilege principle. It checks whether users have been granted only the necessary permissions required for their specific roles. To remediate, review the roles assigned to each user in Data Safe, ensuring that permissions are limited to what is essential for their job functions. Modify policies by using Oracle Cloud Infrastructure's policy editor to enforce least privilege standards.
  references:
  - https://docs.oracle.com/en-us/iaas/data-safe/doc/security-best-practices.html
  - https://www.oracle.com/security-cloud/cis-oracle-cloud-infrastructure-foundations-benchmark/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_safe.data_safe_configuration.compliance_export_destinations_private_enforced
  service: data_safe
  resource: data_safe_configuration
  requirement: Compliance Export Destinations Private Enforced
  scope: data_safe.data_safe_configuration.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Data Safe Compliance Exports Use Private Destinations
  rationale: Using private network destinations for compliance exports in OCI Data Safe reduces exposure to unauthorized access by limiting data transfer to within the secured network. This minimizes the risk of data breaches during transmission and ensures compliance with regulatory standards that mandate secure handling of sensitive data.
  description: This rule checks if compliance export destinations in OCI Data Safe are configured to use private network endpoints. Verifying this involves ensuring that the export destinations are set to private IP addresses within the OCI Virtual Cloud Network (VCN). To remediate, update the Data Safe configuration to specify private IPs for export destinations, ensuring data is not exposed to the public internet. This enhances data protection and aligns with network security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/data-safe/doc/network-security.html
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.pcisecuritystandards.org/ (PCI-DSS requirements for data protection)
  - https://www.nist.gov/cyberframework (NIST Cybersecurity Framework)
  - https://cloudsecurityalliance.org/star/ (Cloud Security Alliance STAR Certification)
- rule_id: oci.data_safe.target_database.compliance_reports_storage_encrypted
  service: data_safe
  resource: target_database
  requirement: Compliance Reports Storage Encrypted
  scope: data_safe.target_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Encryption of Data Safe Compliance Reports
  rationale: Encrypting compliance reports storage in Oracle Cloud Infrastructure is crucial to protect sensitive data from unauthorized access, mitigate data breach risks, and comply with regulatory requirements such as PCI-DSS and GDPR. Encryption at rest ensures that even if storage media is compromised, the data remains unreadable to unauthorized parties, preserving confidentiality and integrity.
  description: This rule checks whether the storage for compliance reports in Oracle Data Safe target databases is encrypted. Ensure that all Data Safe compliance reports are stored in encrypted Object Storage buckets. To verify, access the Oracle Cloud Console, navigate to the Data Safe service, and check the encryption settings of the associated storage. Remediate by enabling encryption on storage buckets using either Oracle-managed keys or customer-managed keys through the OCI Key Management service.
  references:
  - https://docs.oracle.com/en-us/iaas/data-safe/doc/data-safe-overview.html
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingkeystores.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/security/cloud-security/compliance/
- rule_id: oci.data_science.model.model_package_artifact_signed_and_verified_validated
  service: data_science
  resource: model
  requirement: Model Package Artifact Signed And Verified Validated
  scope: data_science.model.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Model Artifacts Are Signed and Verified in OCI Data Science
  rationale: Ensuring that model package artifacts in OCI Data Science are signed and verified is crucial for maintaining the integrity and authenticity of machine learning models. Unsigned or unverified artifacts can be tampered with, leading to potential data breaches or manipulation of model outcomes, which can have significant financial and reputational impacts. Compliance with data protection regulations such as PCI-DSS and ISO 27001 often requires verification of software artifacts to safeguard sensitive information.
  description: This rule checks that all model package artifacts in OCI Data Science are cryptographically signed and their signatures are validated. Artifacts should be signed using Oracle's recommended methods to ensure that they have not been altered or corrupted. To verify this, ensure that the 'Artifact Signing' feature is enabled and properly configured for your OCI Data Science resources. Remediate any unsigned artifacts by signing them with OCI's signing tools and re-uploading them to the platform.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/doc/model-registry.html
  - https://docs.oracle.com/en-us/iaas/Content/security/secure-best-practices.htm
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/
- rule_id: oci.data_science.project.model_package_encrypted
  service: data_science
  resource: project
  requirement: Model Package Encrypted
  scope: data_science.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Model Package Encryption in Data Science Projects
  rationale: Encrypting model packages in OCI Data Science projects is crucial to protect sensitive data and intellectual property from unauthorized access and data breaches. Encryption reduces the risk of data exposure in case of security incidents and helps organizations comply with regulatory standards such as GDPR and HIPAA, which mandate strong data protection measures.
  description: This rule checks whether model packages within OCI Data Science projects are encrypted at rest using Oracle-managed keys. To verify, ensure that all model packages have encryption enabled in the project settings. Remediation involves enabling encryption for model packages through the OCI Console by navigating to the specific Data Science project and toggling the 'Encryption' option to use Oracle-managed keys. This enhances data protection and aligns with best practices for data security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/data_science_security.htm
  - https://www.oracle.com/security/cloud-security/
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.data_science.model.model_package_not_publicly_shared_blocked
  service: data_science
  resource: model
  requirement: Model Package Not Publicly Shared Blocked
  scope: data_science.model.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Block Public Access to Data Science Model Packages
  rationale: Publicly shared model packages can expose sensitive data, algorithms, or intellectual property to unauthorized access, leading to potential data breaches and intellectual property theft. Blocking public access mitigates the risks of unauthorized manipulation, usage, or distribution of machine learning models, ensuring compliance with data protection regulations such as GDPR and CCPA, and aligning with best security practices.
  description: This rule checks for model packages within the Oracle Cloud Infrastructure Data Science service that are set to public access. It ensures these packages are not publicly accessible by default, adhering to the principle of least privilege. To verify and remediate, navigate to the Model Package settings in the OCI Console, ensure the access setting is set to 'Private', and assign access policies only to specific users or groups with a legitimate need. Regularly review access logs and permissions to maintain secure access controls.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/data-science-overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Tasks/dscs_managingmodels.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.oracle.com/security/cloud-security
  - https://www.oracle.com/cloud/cloud-security/
- rule_id: oci.data_science.project.endpoint_config_content_type_whitelist_enforced
  service: data_science
  resource: project
  requirement: Endpoint Config Content Type Whitelist Enforced
  scope: data_science.project.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enforce Content Type Whitelist for Data Science Endpoints
  rationale: Enforcing a content type whitelist for OCI Data Science endpoints mitigates the risk of malicious content being processed by your data models. This is crucial for maintaining data integrity and privacy, preventing potential data breaches or unauthorized access. Ensuring compliance with this rule aligns with data protection regulations such as GDPR and HIPAA, which mandate stringent controls over data handling and processing.
  description: This rule checks if a content type whitelist is enforced for OCI Data Science project endpoints, ensuring only approved content types are processed by your models. To verify, review the endpoint configuration settings within your OCI Data Science project to confirm that a whitelist is defined and active. Remediation involves updating the endpoint configuration to include a list of allowed content types, thereby restricting the processing of any unauthorized data formats.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/data-science-endpoint-config.html
  - https://www.oracle.com/security/cloud-security/cis-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-security/principles/#gdpr
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_science.project.endpoint_config_data_capture_bucket_encrypted_private
  service: data_science
  resource: project
  requirement: Endpoint Config Data Capture Bucket Encrypted Private
  scope: data_science.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Capture Buckets are Encrypted and Private
  rationale: Encrypting and securing data capture buckets is critical to protecting sensitive data collected during data science operations. Unencrypted or publicly accessible buckets can expose sensitive information to unauthorized access, leading to data breaches, financial losses, and non-compliance with regulations like GDPR and HIPAA.
  description: This check verifies that the data capture buckets associated with endpoint configurations in OCI Data Science projects are encrypted using Oracle-managed keys and are not publicly accessible. To comply, ensure that the buckets are set to private and encryption is enabled. Remediation involves configuring bucket policies to enforce encryption and setting access policies to restrict public access through the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/datascienceoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57Part1r4.pdf
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.data_science.model_deployment.endpoint_config_cmks_restricted_enabled
  service: data_science
  resource: model_deployment
  requirement: Endpoint Config Cmks Restricted Enabled
  scope: data_science.model_deployment.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Science Model Deployments Use CMKs for Endpoint Config
  rationale: Using Customer-Managed Keys (CMKs) for model deployment endpoints enhances data protection by allowing organizations to control encryption keys, reducing the risk of unauthorized data access. This is crucial for protecting sensitive data in compliance with regulatory requirements such as GDPR and CCPA, and mitigates potential threats like data breaches and data leaks.
  description: This rule checks that all model deployment endpoints in OCI Data Science are configured to use Customer-Managed Encryption Keys (CMKs) instead of Oracle-managed keys. To verify compliance, ensure that the 'encryptionKeyId' attribute in the endpoint configuration references a valid CMK. Remediation involves creating a CMK in the OCI Key Management Service and updating the model deployment endpoint configuration to use this CMK, enhancing control over data encryption processes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/home.htm
  - https://docs.oracle.com/en-us/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/ds/model_deployment.html
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_science.project.endpoint_config_capture_store_encrypted_and_private
  service: data_science
  resource: project
  requirement: Endpoint Config Capture Store Encrypted And Private
  scope: data_science.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Science Project Endpoint Config Store is Encrypted and Private
  rationale: Encrypting and securing data at rest for Data Science projects is critical to protect sensitive information from unauthorized access and potential breaches. Unsecured endpoint configurations can expose data capture stores to threats, risking data integrity and violating compliance with regulations such as GDPR and CCPA. Ensuring encryption and privacy supports strong data governance and enhances customer trust.
  description: This rule verifies that the endpoint configuration capture store for OCI Data Science projects is both encrypted and set to private. Encryption at rest must be enabled to protect data from unauthorized access. To comply, ensure that your Data Science project's endpoint configuration uses OCI Vault for encryption keys and that the capture store is not publicly accessible. Review and modify the configuration through the OCI Console by navigating to Data Science, selecting your project, and checking the endpoint settings under the configuration tab.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/datascienceoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloud.oracle.com/en_US/data-science/features
- rule_id: oci.data_science.project.endpoint_authn_required
  service: data_science
  resource: project
  requirement: Endpoint Authn Required
  scope: data_science.project.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Authentication on Data Science Project Endpoints
  rationale: Requiring authentication on data science project endpoints is crucial for protecting sensitive data and preventing unauthorized access. Without proper authentication, attackers could exploit endpoints, leading to data breaches and non-compliance with data protection laws such as GDPR and CCPA. Additionally, enabling authentication supports adherence to industry standards and enhances overall data privacy and security posture.
  description: This rule checks if authentication is enabled for data science project endpoints in Oracle Cloud Infrastructure. To verify, ensure that all endpoints require valid credentials before access is granted. Remediation involves configuring the service to enforce authentication using OCIâ€™s Identity and Access Management (IAM) policies, ensuring only authorized users can interact with the data science resources. Regular audits should be conducted to maintain compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/data_science_security.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-1-1-0.pdf
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.data_science.project.endpoint_authz_policies_enforced
  service: data_science
  resource: project
  requirement: Endpoint Authz Policies Enforced
  scope: data_science.project.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Endpoint Authorization Policies in Data Science Projects
  rationale: Enforcing endpoint authorization policies in OCI Data Science projects is crucial for protecting sensitive data from unauthorized access and potential breaches. It mitigates the risk of data leakage, ensuring that only authenticated and authorized users can access or modify data, which is vital for maintaining compliance with data protection regulations such as GDPR and CCPA.
  description: This rule checks that endpoint authorization policies are enforced for OCI Data Science projects. To comply, configure policies to define and control access to project endpoints, ensuring they are not publicly exposed and only accessible to specified users or user groups. Regularly audit and update these policies to align with organizational security standards. Remediation involves using the OCI Console to navigate to the Data Science project settings and applying precise IAM policies to restrict access appropriately.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/data-science-intro.html#security
  - https://www.oracle.com/security/cis-oci-benchmark/
  - https://www.nist.gov/document-162
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/security/best-practices/
- rule_id: oci.data_science.project.endpoint_kms_encryption_enabled
  service: data_science
  resource: project
  requirement: Endpoint KMS Encryption Enabled
  scope: data_science.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure KMS Encryption Enabled for Data Science Projects
  rationale: Enabling KMS encryption for data science projects ensures that sensitive data is protected against unauthorized access and potential data breaches. This is crucial for maintaining data confidentiality and integrity, and it aligns with regulatory requirements for data protection such as GDPR and CCPA. Without encryption, organizations risk exposing critical data, leading to financial losses and reputational damage.
  description: This rule checks if Key Management Service (KMS) encryption is enabled for Oracle Cloud Infrastructure (OCI) data science projects. KMS encryption provides an additional layer of security by encrypting data at rest using customer-managed keys. To verify, ensure that the data science project is configured with a KMS key; this can be done via the OCI Console under the 'Encryption' settings of the specific project. If not enabled, configure a KMS key to enhance data protection. This setting should be part of your security baseline for protecting sensitive datasets.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/datascienceoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://cloud.oracle.com/en_US/data-science
- rule_id: oci.data_science.project.endpoint_logging_enabled
  service: data_science
  resource: project
  requirement: Endpoint Logging Enabled
  scope: data_science.project.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Endpoint Logging for Data Science Projects
  rationale: Enabling endpoint logging for OCI Data Science projects is crucial for maintaining visibility into API interactions and user activities, which helps in identifying unauthorized access attempts and understanding usage patterns. This practice mitigates the risk of data breaches and ensures compliance with security standards, such as ISO 27001, which require detailed audit logs for incident investigation and response.
  description: This rule checks whether logging is enabled for endpoints within OCI Data Science projects. Endpoint logging captures detailed records of API requests, including the source, destination, and action taken, which are essential for auditing and monitoring activities. To verify compliance, ensure that logging is configured via the OCI Console under the Data Science project's 'Logging' section. Remediation involves enabling logging and configuring it to capture relevant events, which can be done through the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/logging.html
  - https://www.oracle.com/security-alerts/cis-benchmarks.html
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://oracle.com/cloud/security/best-practices/
- rule_id: oci.data_science.project.endpoint_private_networking_enforced
  service: data_science
  resource: project
  requirement: Endpoint Private Networking Enforced
  scope: data_science.project.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Enforce Private Networking for Data Science Project Endpoints
  rationale: Enforcing private networking for data science project endpoints reduces the risk of unauthorized access and data breaches by ensuring that communication is restricted to a secure, private network. This control helps protect sensitive data and models from external threats, supporting compliance with industry standards such as GDPR and ISO 27001.
  description: This rule checks that the data science project endpoints in OCI have private networking enforced, ensuring that they are not exposed to the public internet. To verify, ensure that endpoints are configured with a private IP and are part of a Virtual Cloud Network (VCN) with appropriate security lists and network security groups. Remediation involves configuring the project to use a private subnet and adjusting the security rules to limit traffic to trusted IPs only.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/data-science/using/managingprojects.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/cloud-infrastructure/
- rule_id: oci.data_science.project.experiment_logs_enabled
  service: data_science
  resource: project
  requirement: Experiment Logs Enabled
  scope: data_science.project.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Experiment Logging for Data Science Projects
  rationale: Enabling experiment logging in OCI Data Science projects is crucial for tracking changes, auditing model experiments, and ensuring traceability. It minimizes the risk of data breaches by providing a detailed log of actions and results, which is essential for forensic analysis in case of a security incident. Furthermore, maintaining comprehensive logs supports compliance with data protection regulations and industry standards.
  description: This rule checks whether logging is enabled for experiments within OCI Data Science projects. To verify, ensure that the logging service is activated and configured to capture experiment-related activities. If logging is not enabled, adjust the project settings to activate logging, making use of Oracle Cloud's integrated logging service. This setup allows for real-time monitoring and record-keeping of experiments, facilitating transparency and accountability.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/projects.htm#experiments
  - https://www.oracle.com/cloud/security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.oracle.com/security/cloud-security/
  - https://www.iso.org/standard/54534.html
- rule_id: oci.data_science.project.experiment_metadata_store_encrypted
  service: data_science
  resource: project
  requirement: Experiment Metadata Store Encrypted
  scope: data_science.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Experiment Metadata Store is Encrypted at Rest
  rationale: Encrypting the experiment metadata store in OCI Data Science protects sensitive data from unauthorized access and data breaches, which can lead to significant business losses and reputational damage. It is critical for meeting regulatory compliance requirements such as GDPR, HIPAA, and others related to data protection and privacy.
  description: This rule checks whether encryption is enabled for the experiment metadata store in OCI Data Science projects. To verify, ensure that server-side encryption is configured using Oracle-managed keys. If encryption is not enabled, configure the project to use encryption at rest by accessing the OCI console, navigating to the Data Science service, and enabling encryption settings under the project configuration. This ensures data protection and mitigates risks associated with data leakage.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/datascienceresources.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud.html
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.data_science.project.experiment_rbac_least_privilege_required
  service: data_science
  resource: project
  requirement: Experiment RBAC Least Privilege Required
  scope: data_science.project.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce Least Privilege for Data Science Experiment Access
  rationale: Ensuring that only authorized users have the minimum access necessary to data science experiments helps mitigate the risk of unauthorized data exposure or manipulation, which can lead to data breaches and compliance violations. This is crucial for protecting intellectual property and maintaining trust, especially in regulated environments subject to standards like SOC2 and ISO 27001.
  description: This rule checks that access to data science experiments within OCI projects is configured following the principle of least privilege. It verifies that IAM policies are precisely defined to grant the minimum necessary permissions for users to perform their roles. To remediate, review and refine IAM policies, ensuring they are aligned with specific user roles and responsibilities, and remove any excessive permissions. Regularly audit these policies to adapt to changes in team structure or project needs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/cloud/security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Policy/Concepts/policies.htm
  - https://www.oracle.com/cloud-native/data-science/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_science.project.hpo_logs_enabled
  service: data_science
  resource: project
  requirement: Hpo Logs Enabled
  scope: data_science.project.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable HPO Logs for Data Science Projects in OCI
  rationale: Ensuring Hyperparameter Optimization (HPO) logs are enabled for Data Science projects in OCI is crucial for maintaining a comprehensive audit trail. Without HPO logs, tracking changes and decisions made during model tuning could be difficult, increasing the risk of undetected errors or misconfigurations. This logging is essential for forensic analysis, compliance with data governance policies, and enhancing model transparency and accountability.
  description: This rule checks whether HPO logs are enabled for data science projects in Oracle Cloud Infrastructure. HPO logs capture detailed information about hyperparameter tuning processes, which are critical for debugging, audit, and compliance purposes. To verify, ensure that HPO logging is activated in the project's settings under the Data Science service. Remediation involves accessing the OCI Console, navigating to the Data Science project, and enabling the HPO logging option in the project configuration settings.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/logging.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks.html
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/security/Concepts/security_overview.htm
- rule_id: oci.data_science.project.hpo_private_networking_enforced
  service: data_science
  resource: project
  requirement: Hpo Private Networking Enforced
  scope: data_science.project.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Enforce Private Networking for HPO in Data Science Projects
  rationale: Enforcing private networking for Hyperparameter Optimization (HPO) in data science projects reduces the risk of unauthorized access and data exfiltration by ensuring that sensitive data and workloads do not traverse public networks. This security measure is crucial for maintaining the confidentiality and integrity of machine learning models and datasets, which can be targeted by cyber threats. Additionally, compliance with data protection regulations such as GDPR and industry standards like ISO 27001 may require data to be processed in a secure, private environment.
  description: This rule checks if Hyperparameter Optimization (HPO) within Oracle Cloud Infrastructure (OCI) Data Science projects is configured to operate within a private network. To verify, ensure that the HPO jobs are deployed using network configurations that restrict access to private IP addresses only. Remediation involves configuring the VCN (Virtual Cloud Network) and subnet settings to support private endpoints, preventing exposure to the public internet. This setup not only enhances security but also optimizes network performance by minimizing latency.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Tasks/data-science-using-vcn.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/security/
  - https://docs.oracle.com/en-us/iaas/Content/security/overview.htm
- rule_id: oci.data_science.project.hpo_roles_least_privilege_required
  service: data_science
  resource: project
  requirement: Hpo Roles Least Privilege Required
  scope: data_science.project.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for HPO Roles in Data Science Projects
  rationale: Enforcing least privilege for Hyperparameter Optimization (HPO) roles in OCI Data Science projects minimizes the risk of unauthorized access to sensitive data and operations, reducing potential security breaches and data leaks. This practice is critical to meeting compliance with data protection regulations and maintaining trust in cloud-based data science initiatives.
  description: This rule checks that only necessary permissions are granted to HPO roles within OCI Data Science projects. To verify, review IAM policies and ensure that only essential APIs and resources are accessible to HPO roles. Remediation involves auditing current role assignments, removing unnecessary permissions, and adhering to the principle of least privilege by defining precise access policies using Oracle Cloud Infrastructure's IAM features.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/data_science_security.htm
  - https://www.oracle.com/cloud-computing/iam-cloud-security/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/cloud/cloud-security/
- rule_id: oci.data_science.project.training_job_input_output_encrypted
  service: data_science
  resource: project
  requirement: Training Job Input Output Encrypted
  scope: data_science.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Training Job Data in OCI is Encrypted at Rest
  rationale: Encrypting training job input and output data at rest is crucial to protect sensitive information from unauthorized access and potential data breaches. This is particularly important for compliance with data protection regulations such as GDPR and CCPA, which mandate robust data security measures. Without encryption, the confidentiality and integrity of the data could be compromised, leading to financial loss and reputational damage.
  description: This rule checks whether input and output data associated with Data Science projects in Oracle Cloud Infrastructure are encrypted at rest. To verify, ensure that the OCI Data Science service is configured to use Oracle-managed encryption keys or customer-managed keys (CMKs) for all storage resources. Remediation involves setting up encryption policies within the OCI console and ensuring that all new data is stored in Object Storage buckets with encryption enabled. Regular audits should be conducted to confirm compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/encryption.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmark/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.hipaajournal.com/hipaa-encryption-requirements/
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.data_science.project.training_job_logs_enabled
  service: data_science
  resource: project
  requirement: Training Job Logs Enabled
  scope: data_science.project.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Training Job Logs are Enabled for Data Science Projects
  rationale: Enabling logs for training jobs in OCI Data Science projects is critical for monitoring model performance, auditing activities, and troubleshooting errors. Without logs, tracking the development lifecycle of machine learning models becomes challenging, potentially leading to undetected security incidents or compliance failures. Enabling logging helps meet regulatory requirements and enhances the overall security posture by providing visibility into data processing activities.
  description: This rule checks if logging is enabled for training jobs within OCI Data Science projects. It ensures that all operations related to machine learning training are captured in logs, which should be configured in the OCI Logging service. To verify, ensure that the project settings in the OCI console have logging enabled, and logs are being sent to a designated log group. Remediation involves navigating to the OCI Data Science project settings, enabling logging for training jobs, and selecting the appropriate log group for storage.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/logging.htm
  - https://cloudsecurityalliance.org/research/cis-oci-benchmark
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/standard/54534.html
  - https://www.oracle.com/security-cloud-compliance/
  - https://docs.oracle.com/en/cloud/paas/logging-cloud/index.html
- rule_id: oci.data_science.project.training_job_private_networking_enforced
  service: data_science
  resource: project
  requirement: Training Job Private Networking Enforced
  scope: data_science.project.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Enforce Private Networking for Data Science Training Jobs
  rationale: Enforcing private networking for data science training jobs mitigates the risk of unauthorized access and data exposure by ensuring that sensitive data processing occurs within a secured network environment. This reduces the threat of data breaches and aligns with regulatory requirements such as GDPR and HIPAA, which mandate strict data protection measures. Additionally, private networking helps in maintaining the integrity and confidentiality of machine learning models and datasets.
  description: This rule checks if OCI Data Science training jobs within a project are configured to use private networking, which ensures that network traffic is restricted to private IP addresses and avoids the public internet. To verify, review the network configuration settings in your Data Science projects to confirm that 'Private Subnet' is enabled for training jobs. Remediation involves updating the projectâ€™s networking settings to restrict connectivity to a Virtual Cloud Network (VCN) with appropriate security lists and network security groups (NSGs) that enforce private access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Tasks/data-science-training-jobs.htm#networking
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/cloud/cloud-security.html
  - https://www.oracle.com/a/ocom/docs/cloud/oci-security-best-practices.pdf
- rule_id: oci.data_science.job.training_job_roles_least_privilege_required
  service: data_science
  resource: job
  requirement: Training Job Roles Least Privilege Required
  scope: data_science.job.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Data Science Training Job Roles
  rationale: Enforcing least privilege on OCI Data Science training job roles minimizes the risk of unauthorized access and potential data breaches, critical for maintaining data integrity and compliance with regulations such as PCI-DSS or GDPR. By only granting necessary permissions, organizations can reduce the attack surface and mitigate insider threats, aligning with security best practices.
  description: This rule verifies that roles assigned to OCI Data Science training jobs are configured with the least privilege principle, only allowing necessary permissions for job execution. Administrators should review and adjust IAM policies to restrict access based on the job's operational needs, ensuring no excessive permissions are granted. Remediation involves auditing existing roles, identifying superfluous permissions, and modifying IAM policies accordingly using Oracle Cloud's Identity and Access Management service.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security.html
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/datascienceoverview.htm
- rule_id: oci.data_science.project.transform_job_input_output_encrypted
  service: data_science
  resource: project
  requirement: Transform Job Input Output Encrypted
  scope: data_science.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Science Transform Job I/O is Encrypted
  rationale: Encrypting input and output data for Data Science Transform Jobs is crucial to protect sensitive information from unauthorized access and potential breaches. This practice mitigates risks such as data leaks or theft, which can lead to significant financial loss, reputational damage, and non-compliance with data protection regulations like GDPR, CCPA, and HIPAA.
  description: This rule verifies that all input and output data for Transform Jobs within OCI Data Science projects are encrypted at rest using Oracle-managed keys or customer-managed keys via the Key Management service. To ensure compliance, configure the Data Science project to leverage encryption settings available in the OCI console. Regular audits should be conducted to verify that encryption settings are correctly implemented and maintained.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/data-science-projects.htm#security
  - https://www.oracle.com/security-cloud/data-encryption/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/cloud/security/
- rule_id: oci.data_science.project.transform_job_logs_enabled
  service: data_science
  resource: project
  requirement: Transform Job Logs Enabled
  scope: data_science.project.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Transform Job Logs for OCI Data Science Projects
  rationale: Enabling transform job logs in OCI Data Science is crucial for monitoring and auditing data transformations. It ensures visibility into data processing activities, helping to identify unauthorized access or data anomalies. Logging is essential for compliance with standards such as PCI-DSS and ISO 27001, which require detailed audit trails.
  description: This rule checks if logging is enabled for transform jobs within OCI Data Science projects. Logs should be configured to capture all transformation activities, stored securely, and monitored regularly. To enable logging, navigate to the Data Science project settings and ensure that the 'Transform Job Logs' option is activated. Remediate by applying the appropriate logging policies and verifying log generation through the OCI Console.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/data-science-logging.html
  - https://www.oracle.com/security/cis-benchmarks/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/security/overview.htm
  - https://cloud.oracle.com/en_US/data-science
- rule_id: oci.data_science.project.transform_job_private_networking_enforced
  service: data_science
  resource: project
  requirement: Transform Job Private Networking Enforced
  scope: data_science.project.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Enforce Private Networking for Data Science Transform Jobs
  rationale: Enforcing private networking for Data Science Transform Jobs minimizes exposure to public internet threats, reducing the risk of data breaches and unauthorized access. This is crucial for maintaining data confidentiality and integrity, especially for organizations handling sensitive or regulated data. Compliance with industry standards such as PCI-DSS and HIPAA often requires stringent network access controls to protect sensitive information.
  description: This rule checks if Data Science Transform Jobs within a project are configured to use private networking, ensuring that they do not have public internet access. To verify, inspect the networking configuration of each transform job to confirm it uses a Virtual Cloud Network (VCN) with appropriate security lists and network security groups. Remediation involves modifying the transform job settings to utilize a private subnet within a VCN, ensuring that all traffic is routed through secure, controlled network paths.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/doc/using-projects.html
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - CIS Oracle Cloud Infrastructure Foundations Benchmark v1.1.0 - 3.1 Ensure VCNs are used for private networking
  - NIST SP 800-53 Rev. 5 - SC-7 Boundary Protection
  - https://docs.oracle.com/en-us/iaas/data-science/doc/security-best-practices.html
  - 'PCI-DSS v3.2.1 Requirement 1: Install and maintain a firewall configuration to protect cardholder data'
- rule_id: oci.data_science.job.transform_job_roles_least_privilege_required
  service: data_science
  resource: job
  requirement: Transform Job Roles Least Privilege Required
  scope: data_science.job.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce Least Privilege for Data Science Job Roles
  rationale: Minimizing permissions for Data Science jobs helps prevent unauthorized access and potential data breaches, reducing the risk of exposing sensitive data. This approach supports compliance with regulations that mandate access controls and data protection, such as GDPR and HIPAA, and protects against insider threats and privilege escalation attacks.
  description: This rule assesses whether the permissions granted to OCI Data Science job roles adhere to the least privilege principle. It checks for over-permissioned roles that might allow unauthorized access or modification of resources. To verify compliance, audit IAM policies associated with Data Science jobs and ensure they grant only the necessary permissions. Remediation involves revising IAM policies to limit access strictly to required operations and resources, leveraging OCI's fine-grained access controls.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://www.oracle.com/security-cloud/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.nist.gov/cyberframework
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.data_science.project.automl_logs_enabled
  service: data_science
  resource: project
  requirement: Automl Logs Enabled
  scope: data_science.project.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure AutoML Logging is Enabled for Data Science Projects
  rationale: Enabling AutoML logs in OCI Data Science projects is crucial for maintaining visibility into model training and prediction activities. Without logging, organizations might miss critical insights into model performance and potential anomalies, which could lead to undetected biases or security threats. Additionally, comprehensive logging aids in meeting compliance requirements such as those outlined in ISO 27001 and assists in forensic investigations, thereby protecting both data integrity and corporate reputation.
  description: This rule checks if logging is enabled for AutoML operations within OCI Data Science projects, ensuring that all activities related to model training and predictions are recorded. To verify, navigate to the OCI console, access the Data Science project settings, and confirm that logging is configured and active. If not enabled, set up logging by integrating with OCI Logging service, specifying appropriate log groups and retention policies. This action helps in maintaining an audit trail and supports effective monitoring and alerting mechanisms.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/data-science/using/data-science-logging.htm
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_automl.htm
  - https://www.oracle.com/cloud/cloud-security/posture-management/
- rule_id: oci.data_science.project.automl_private_networking_enforced
  service: data_science
  resource: project
  requirement: Automl Private Networking Enforced
  scope: data_science.project.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Enforce Private Networking for AutoML in OCI Data Science
  rationale: Enforcing private networking for AutoML in Oracle Cloud Infrastructure (OCI) Data Science projects ensures that sensitive data and machine learning models are protected from unauthorized access and potential data breaches. It mitigates risks associated with exposure to public internet by restricting traffic to a secure, private network. This supports compliance with security standards such as ISO 27001 and helps prevent data exfiltration and unauthorized data access.
  description: This rule checks that AutoML services within OCI Data Science projects are configured to operate within a private network. To verify, ensure that network security settings are configured to restrict AutoML traffic to a Virtual Cloud Network (VCN). Remediation involves updating the project settings to enforce private network usage, ensuring no direct exposure to the public internet. This can be achieved by utilizing OCI's VCN and subnet configurations to define specific ingress and egress rules.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/auto-ml-overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
- rule_id: oci.data_science.project.automl_roles_least_privilege_required
  service: data_science
  resource: project
  requirement: Automl Roles Least Privilege Required
  scope: data_science.project.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for AutoML Roles in Data Science Projects
  rationale: Limiting permissions to the least privilege necessary for AutoML roles in OCI Data Science projects minimizes the risk of unauthorized access and data exposure, protecting sensitive data and maintaining integrity. Over-privileged roles can lead to potential data breaches, regulatory non-compliance, and operational disruptions. Ensuring least privilege is crucial for adhering to compliance standards like PCI-DSS and GDPR.
  description: This rule verifies that AutoML roles in OCI Data Science projects are assigned the minimum permissions necessary to perform their functions. Users should be assigned only the roles they need, and role policies must be reviewed regularly. To remediate issues, audit current IAM policies, and apply restrictive policies using OCI's Identity and Access Management service. Implementing fine-grained access controls ensures compliance with security frameworks and reduces exposure to threats.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/security-cloud-compliance/cis-oci-benchmark/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/publications/guide-general-security-and-privacy-controls-information-systems
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
- rule_id: oci.data_science.project.model_registry_artifact_encryption_enabled
  service: data_science
  resource: project
  requirement: Model Registry Artifact Encryption Enabled
  scope: data_science.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Model Registry Artifacts Are Encrypted in OCI Data Science
  rationale: Encrypting model registry artifacts protects sensitive data and intellectual property from unauthorized access and potential breaches. This is critical for maintaining the confidentiality and integrity of machine learning models, which are often core to business operations and competitive advantage. Furthermore, encryption at rest is a key requirement for compliance with data protection regulations such as GDPR and CCPA, and helps mitigate risks associated with data exfiltration and insider threats.
  description: This rule checks if encryption is enabled for model registry artifacts within Oracle Cloud Infrastructure's Data Science Projects. To verify, ensure that the encryption setting for the data science project is configured to use Oracle-managed keys or customer-managed keys through OCI's Key Management service. Remediation involves enabling encryption on existing projects by updating the project settings to utilize the appropriate encryption keys, ensuring all artifacts stored are encrypted at rest.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/model-registry.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - 'NIST SP 800-57 Part 1: General Guidelines for Key Management'
  - 'PCI-DSS Requirement 3: Protect Stored Cardholder Data'
  - https://www.oracle.com/security/cloud-security/risks-and-controls/
- rule_id: oci.data_science.model.model_registry_cross_account_sharing_restricted
  service: data_science
  resource: model
  requirement: Model Registry Cross Account Sharing Restricted
  scope: data_science.model.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Restrict Cross-Account Sharing in OCI Model Registry
  rationale: Restricting cross-account sharing of models in OCI's Model Registry is crucial to prevent unauthorized access and data breaches, which could lead to intellectual property theft and non-compliance with data privacy regulations. It ensures that only authorized users within the organization can access sensitive AI/ML models, aligning with data protection standards and reducing exposure to malicious actors.
  description: This rule checks if OCI Model Registry sharing configurations are restricted to prevent cross-account access. Ensure that model sharing policies are set to allow access only within the account unless explicitly required and vetted. Verify through the OCI Console under Data Science service settings, and modify IAM policies to restrict cross-tenancy access. Implement tagging and compartment policies for additional security and audit logging to monitor changes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/data-science-overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/commonpolicies.htm#cross-tenancy
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security-cloud/compliance/
  - https://www.oracle.com/cloud/cloud-security/
- rule_id: oci.data_science.model.model_registry_rbac_least_privilege_required
  service: data_science
  resource: model
  requirement: Model Registry RBAC Least Privilege Required
  scope: data_science.model.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for OCI Data Science Model Registry
  rationale: Applying the least privilege principle to the OCI Data Science Model Registry is crucial to minimizing unauthorized access and potential data breaches. Misconfigured access controls can lead to exposure of sensitive model data, impacting business operations and compliance with standards such as NIST and PCI-DSS. Proper RBAC settings help safeguard intellectual property and maintain trust with stakeholders.
  description: This rule checks if RBAC policies on OCI Data Science Model Registry are configured to grant only necessary permissions to users. It ensures that users have the minimum access required to perform their roles, reducing the attack surface. To verify, review IAM policies for roles accessing the model registry and adjust permissions to align with least privilege principles. Remediation involves updating policies in the OCI Console to limit user access to only necessary resources and operations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/datascienceoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/cis-oci-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/identity-and-access-management/
- rule_id: oci.data_catalog.catalog.model_registry_artifact_encryption_enabled
  service: data_catalog
  resource: catalog
  requirement: Model Registry Artifact Encryption Enabled
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Model Registry Artifacts are Encrypted at Rest
  rationale: Encrypting model registry artifacts at rest in OCI is crucial for protecting sensitive data from unauthorized access and potential breaches. Without encryption, sensitive machine learning models and metadata stored in the data catalog are vulnerable to theft and tampering, leading to potential data loss, non-compliance with regulations such as GDPR and HIPAA, and damage to the organization's reputation.
  description: This rule checks if the model registry artifacts within the OCI Data Catalog service are encrypted at rest using Oracle-managed keys or BYOK (Bring Your Own Key). Verify encryption settings via the OCI Console under the Data Catalog section by ensuring that 'Encryption' is enabled for model artifacts. Remediation involves enabling encryption by configuring the data catalog to use Oracle-managed or customer-managed encryption keys, thereby enhancing data protection and compliance with security standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/home.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.data_catalog.catalog.model_registry_cross_account_sharing_restricted
  service: data_catalog
  resource: catalog
  requirement: Model Registry Cross Account Sharing Restricted
  scope: data_catalog.catalog.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Restrict Cross-Account Sharing in OCI Model Registry
  rationale: Restricting cross-account sharing in the OCI Model Registry is critical to prevent unauthorized access to sensitive machine learning models. This practice mitigates the risk of data leakage, intellectual property theft, and potential regulatory compliance violations, such as those outlined in GDPR or CCPA, by ensuring that only authorized accounts can access or modify the models.
  description: This rule checks if cross-account sharing is restricted for the model registry within OCI's Data Catalog service. To enhance security, ensure that only designated accounts have access by configuring IAM policies to limit sharing capabilities. Verify by reviewing the IAM policies attached to the model registry for any rules that permit cross-account access, and update them to restrict sharing as needed. Implementing these restrictions helps maintain data integrity and confidentiality.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://cloudsecurityalliance.org/research/artifacts/oracle-cloud-infrastructure-security-best-practices
- rule_id: oci.data_catalog.catalog.model_registry_rbac_least_privilege_required
  service: data_catalog
  resource: catalog
  requirement: Model Registry RBAC Least Privilege Required
  scope: data_catalog.catalog.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Model Registry in OCI Data Catalog
  rationale: Implementing least privilege for Model Registry access in OCI reduces the risk of unauthorized actions that could lead to data breaches or integrity issues. This is crucial for maintaining data security and compliance with regulations such as PCI-DSS and GDPR, which mandate strict access controls to protect sensitive data. Inadequate RBAC policies can expose organizations to security vulnerabilities and potential financial and reputational damage.
  description: This rule checks whether access to the Model Registry within OCI's Data Catalog is configured to follow the principle of least privilege. Users and groups should be granted the minimum permissions necessary for their roles, and any unnecessary or overly broad permission assignments should be removed. Verify role assignments and policies via the OCI Console by navigating to Identity & Security > Policies and ensuring no excessive privileges are granted. Remediate by creating or updating policies to precisely define the actions users can perform, leveraging pre-defined roles where applicable.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - NIST SP 800-53 AC-6 Least Privilege
  - PCI-DSS Requirement 7
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.data_science.project.notebook_encrypted
  service: data_science
  resource: project
  requirement: Notebook Encrypted
  scope: data_science.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Science Notebook Encryption at Rest
  rationale: Encrypting data at rest is crucial for protecting sensitive information from unauthorized access and potential data breaches. Unencrypted notebooks can expose critical intellectual property and personal data, leading to financial losses and compliance violations. This is especially important for organizations subject to regulations such as GDPR, HIPAA, and PCI-DSS, where data protection and privacy are mandatory.
  description: This rule checks if Oracle Cloud Infrastructure Data Science project notebooks have encryption enabled at rest. To ensure compliance, verify that encryption is configured using Oracle-managed keys or customer-managed keys in the OCI Vault. Remediation involves enabling encryption for existing notebooks by configuring them to use the appropriate encryption settings and creating future projects with encryption enabled by default.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/datascienceoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm
  - CIS OCI Foundations Benchmark v1.1.0, Control 1.2
  - NIST SP 800-53 Rev. 5, Control SC-28
  - PCI DSS v3.2.1, Requirement 3
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
- rule_id: oci.data_science.notebook_session.notebook_execution_role_least_privilege_required
  service: data_science
  resource: notebook_session
  requirement: Notebook Execution Role Least Privilege Required
  scope: data_science.notebook_session.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Notebook Execution Roles in OCI
  rationale: Applying the principle of least privilege to notebook execution roles minimizes the risk of unauthorized access and data exposure in Oracle Cloud Infrastructure. It helps prevent threat actors from exploiting excessive permissions, thereby reducing potential attack surfaces and ensuring compliance with regulatory standards such as GDPR and HIPAA, which mandate strict access controls.
  description: This rule verifies that all OCI Data Science notebook session execution roles are configured with the minimum permissions necessary to perform their tasks. It checks the associated IAM policies to ensure they do not grant excessive privileges beyond what is required for notebook operations. Remediation involves reviewing and refining the IAM policies to remove unnecessary permissions, thus aligning with the least privilege principle. Users should regularly audit and update these roles to reflect any changes in operational needs or security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Tasks/datascienceusingnotebooksessions.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policysyntax.htm
  - CIS OCI Foundations Benchmark
  - 'NIST SP 800-53: Access Control (AC)'
  - https://cloud.oracle.com/cloud-security/compliance
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_science.notebook_session.notebook_idle_shutdown_configured
  service: data_science
  resource: notebook_session
  requirement: Notebook Idle Shutdown Configured
  scope: data_science.notebook_session.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Notebook Idle Shutdown is Configured
  rationale: Configuring idle shutdown for notebook sessions in OCI reduces the risk of unauthorized access and resource wastage. Unattended notebooks can be exploited by attackers to access sensitive data or execute malicious code. This practice supports compliance with data protection regulations by minimizing unnecessary exposure and helps in cost management by freeing up resources when not in use.
  description: This rule checks if OCI Data Science notebook sessions have idle shutdown settings configured. An idle shutdown policy automatically terminates notebook sessions after a period of inactivity, reducing security risks and managing costs. To verify, review the notebook session settings in the OCI Console and ensure an idle timeout is set. Remediation involves navigating to the notebook session details in OCI, enabling the idle shutdown feature, and specifying an appropriate timeout duration.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/notebooks.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks.html
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/cloud/data-science-platform.html
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
- rule_id: oci.data_science.notebook_session.notebook_no_public_access_blocked
  service: data_science
  resource: notebook_session
  requirement: Notebook No Public Access Blocked
  scope: data_science.notebook_session.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Prevent Public Access to OCI Data Science Notebooks
  rationale: Allowing public access to OCI Data Science notebooks exposes sensitive data and intellectual property to unauthorized users, increasing the risk of data breaches and compliance violations. Unrestricted access can lead to misuse of computational resources, data exfiltration, and potential unauthorized modifications. Ensuring notebooks are not publicly accessible is crucial for maintaining data confidentiality and integrity, and meeting compliance requirements such as PCI-DSS and ISO 27001.
  description: This rule checks for OCI Data Science notebook sessions that have public access enabled, which can be inadvertently exposed to the internet. The ideal configuration restricts access to authorized users and networks only. To verify, inspect the network settings of the notebook session and ensure the public access option is disabled. Remediation involves updating the network configuration to limit access to specific IP addresses or VCNs, leveraging OCI's network security groups and access control lists for enhanced security.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/doc/data-science-security.html
  - https://www.oracle.com/cloud/architecture/cloud-infrastructure/data-science-security-best-practices.html
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/document_library
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.data_science.project.pipeline_artifacts_private_and_encrypted
  service: data_science
  resource: project
  requirement: Pipeline Artifacts Private And Encrypted
  scope: data_science.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Science Pipeline Artifacts Are Private and Encrypted
  rationale: Maintaining the privacy and encryption of pipeline artifacts in the OCI Data Science service is crucial to protect sensitive data used in machine learning projects. Without encryption and proper access controls, unauthorized access could lead to data breaches, intellectual property theft, and non-compliance with data protection regulations such as GDPR and CCPA.
  description: This rule checks that all pipeline artifacts within OCI Data Science projects are stored with encryption enabled and access is restricted to authorized users. Verify that encryption at rest is enabled for the object storage buckets containing these artifacts. Remediation involves configuring the storage to use OCI's Key Management service for encryption and setting appropriate IAM policies to control access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/commonpolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - NIST SP 800-53 Rev. 5
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.data_science.project.pipeline_kms_encryption_enabled
  service: data_science
  resource: project
  requirement: Pipeline KMS Encryption Enabled
  scope: data_science.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure KMS Encryption for Data Science Pipelines
  rationale: Enabling KMS encryption for data science pipelines protects sensitive data from unauthorized access and potential breaches. It mitigates risks associated with data exfiltration and ensures compliance with data protection regulations such as GDPR and CCPA. Organizations can avoid financial penalties and reputational damage by securing data at rest with encryption.
  description: This check verifies if Oracle Cloud Infrastructure (OCI) Data Science projects have KMS encryption enabled for their pipelines. To ensure data is encrypted at rest, configure your data science pipelines to use OCI Key Management for encryption. Verify by accessing the OCI Console, navigating to Data Science projects, and ensuring the 'Encryption' field under pipeline settings is set to a valid KMS key. Remediate by selecting a KMS key from the OCI Key Management service if not already configured.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/datascienceoverview.htm
  - 'NIST SP 800-57 Part 1: Recommendation for Key Management'
  - https://www.oracle.com/security/cloud-security/
  - https://www.oracle.com/a/ocom/docs/cloud/oci-architect-security-quick-reference.pdf
- rule_id: oci.data_science.project.pipeline_logging_enabled
  service: data_science
  resource: project
  requirement: Pipeline Logging Enabled
  scope: data_science.project.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Pipeline Logging is Enabled for Data Science Projects
  rationale: Enabling logging for data science project pipelines is crucial for monitoring and auditing purposes. It helps identify unauthorized access, anomalies, and potential security breaches, thereby mitigating risks associated with data leakage and ensuring compliance with regulatory frameworks such as GDPR and HIPAA. Proper logging aids in forensic investigations and provides visibility into the operations of data science workflows, enhancing the organization's overall security posture.
  description: This rule checks whether logging is enabled for pipelines within Oracle Cloud Infrastructure's Data Science projects. Ensuring that pipeline logging is enabled allows security teams to capture detailed logs of pipeline activities, which can be verified through the OCI Console under the 'Data Science' service logging settings. To remediate, navigate to the Data Science project settings and ensure that 'Pipeline Logging' is enabled. This configuration helps in maintaining a comprehensive audit trail and supports operational monitoring and incident response.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/pipeline-logging.html
  - https://www.oracle.com/cloud/security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloud.oracle.com/data-science
- rule_id: oci.data_science.pipeline.pipeline_roles_least_privilege_required
  service: data_science
  resource: pipeline
  requirement: Pipeline Roles Least Privilege Required
  scope: data_science.pipeline.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Data Science Pipeline Roles Use Least Privilege
  rationale: Implementing least privilege for OCI Data Science pipelines mitigates the risk of unauthorized access and potential data breaches. This approach minimizes the attack surface by ensuring that users and resources have only the permissions necessary to perform their tasks, ultimately reducing the likelihood of accidental or malicious misuse. Compliance with regulations like ISO 27001 and NIST also mandates strict access controls, which can be fulfilled by adhering to this principle.
  description: This rule verifies that all roles assigned to OCI Data Science pipelines adhere to the principle of least privilege by having only the necessary permissions required for their function. To check compliance, review the IAM policies associated with pipeline roles and ensure they grant the minimal set of actions. Remediation involves adjusting IAM policies to remove excessive permissions, leveraging predefined policies where applicable, and regularly auditing role assignments to maintain compliance. Use Oracle Cloud's IAM service to refine policies and monitor access logs for unauthorized attempts.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/datascienceoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_platform
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Tasks/datasciencepipelines.htm
- rule_id: oci.data_science.project.human_review_artifacts_encrypted
  service: data_science
  resource: project
  requirement: Human Review Artifacts Encrypted
  scope: data_science.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Human Review Artifacts in Data Science Projects are Encrypted
  rationale: Encrypting human review artifacts in data science projects is crucial to protect sensitive data from unauthorized access and data breaches. It reduces the risk of data exposure, thus maintaining customer trust and ensuring compliance with data protection regulations such as GDPR and CCPA. Failing to encrypt sensitive data can result in financial penalties and reputational damage.
  description: This rule checks if human review artifacts stored within Oracle Cloud Infrastructure Data Science projects are encrypted at rest. To secure these artifacts, enable Oracle-managed keys or customer-managed keys for encryption. Verify encryption settings through the OCI Console by reviewing the project configuration under the Data Science service. If encryption is not enabled, update the project settings to utilize OCI's encryption capabilities, ensuring all data is protected.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/data-science-service-overview.html
  - CIS OCI Foundation Benchmark (if applicable)
  - 'NIST SP 800-53: SC-28 Protection of Information at Rest'
  - GDPR Article 32 Security of Processing
  - Oracle Cloud Infrastructure Security Best Practices
  - https://www.oracle.com/security/cloud-security/oci-best-practices/
- rule_id: oci.data_science.project.human_review_ui_private_networking_enforced
  service: data_science
  resource: project
  requirement: Human Review Ui Private Networking Enforced
  scope: data_science.project.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Human Review UI Uses Private Networking in Data Science Projects
  rationale: Enforcing private networking for the Human Review UI in OCI Data Science projects mitigates the risk of unauthorized access by restricting network exposure. This control is vital for protecting sensitive data processed within data science environments, ensuring compliance with organizational policies and regulatory standards such as GDPR and HIPAA, which mandate stringent data access controls.
  description: This rule verifies that Human Review UI in OCI Data Science projects is configured to use private networking. This entails setting up Virtual Cloud Network (VCN) with appropriate subnets and security lists to restrict access to internal networks only. To remediate, ensure the Human Review UI endpoint is assigned a private IP address within a secure VCN and adjust security lists to deny public access. Verification can be done by reviewing the network configuration and ensuring no public IP is assigned.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/data-science/using/data-science-projects.htm
  - CIS OCI Foundations Benchmark v1.0.0
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/document_library
- rule_id: oci.data_science.project.human_review_workteam_access_rbac_least_privilege_required
  service: data_science
  resource: project
  requirement: Human Review Workteam Access RBAC Least Privilege Required
  scope: data_science.project.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Human Review Workteam in Data Science Projects
  rationale: Applying least privilege access controls to human review workteams in OCI Data Science projects minimizes the risk of unauthorized data access, reduces the attack surface, and aligns with regulatory requirements such as GDPR and CCPA. This approach is essential to ensure that only authorized personnel have access to sensitive data, thereby preventing potential data breaches and maintaining compliance with industry standards.
  description: This rule checks that access permissions for human review workteams in OCI Data Science projects are configured using least privilege principles. To verify compliance, review the IAM policies associated with your data science projects to ensure that only necessary roles and permissions are granted. If excessive permissions are identified, modify the IAM policies to limit access strictly to required resources. Use OCI's policy analysis and audit logging features to regularly review and adjust permissions as needed.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/datascienceoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-security/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
- rule_id: oci.database.db_system.snapshot_cross_account_sharing_restricted
  service: database
  resource: db_system
  requirement: Snapshot Cross Account Sharing Restricted
  scope: database.db_system.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Restrict Cross-Account Sharing of Database Snapshots
  rationale: Allowing unrestricted cross-account sharing of database snapshots can expose sensitive data to unauthorized entities, leading to potential data breaches and failing compliance with data protection regulations. This practice is particularly risky when dealing with sensitive or regulated data, as unauthorized access could result in financial penalties and reputational damage.
  description: This rule checks if database snapshots are configured to prevent cross-account sharing in Oracle Cloud Infrastructure. Cross-account sharing should be restricted to ensure that backups and snapshots of database systems are not accessible by unauthorized accounts. To verify, review the sharing settings of database snapshots in the OCI Console and ensure that only authorized accounts have access. Remediation involves configuring IAM policies to limit access and sharing capabilities of database snapshots to specific, trusted accounts.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/backingup.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
- rule_id: oci.database.autonomous_database.snapshot_encrypted
  service: database
  resource: autonomous_database
  requirement: Snapshot Encrypted
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Snapshots are Encrypted
  rationale: Encrypting snapshots of Autonomous Databases is crucial for protecting sensitive data from unauthorized access and breaches. Without encryption, snapshots can be exploited by attackers to gain access to confidential information, potentially leading to financial losses, reputational damage, and non-compliance with data protection regulations like GDPR and CCPA.
  description: This rule checks if snapshots of Oracle Autonomous Databases are encrypted at rest. Encryption should be enabled to safeguard data integrity and confidentiality. Administrators can verify the encryption status via the OCI console or CLI by reviewing the database's configuration settings. Remediation involves enabling encryption for any unencrypted snapshots, which can typically be configured through the OCI dashboard under the autonomous database settings.
  references:
  - https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/security-guide.html#GUID-3D6A5B8F-6D78-4A9F-9A8F-7C4E7B9C8B1D
  - https://www.oracle.com/security-cloud-compliance/cis-benchmark.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/publications/encryption-at-rest-implementation-nist-sp-800-111
- rule_id: oci.database.db_system.snapshot_not_publicly_shared_blocked
  service: database
  resource: db_system
  requirement: Snapshot Not Publicly Shared Blocked
  scope: database.db_system.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: critical
  title: Ensure DB System Snapshots Are Not Publicly Accessible
  rationale: Public access to database snapshots poses significant security risks, including unauthorized data exposure and potential data breaches. This can lead to non-compliance with data protection regulations such as GDPR and CCPA, and result in financial penalties and reputational damage to the organization.
  description: This rule checks that snapshots of Oracle Cloud Infrastructure (OCI) DB System backups are not publicly accessible. Snapshots should be configured with appropriate access controls to ensure they are only available to authorized users. To verify, ensure that no snapshots are shared publicly via the OCI Console or API. Remediation involves updating the access policies to restrict public access and regularly auditing snapshot permissions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/backingupdatabase.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/security-cloud-compliance/
  - https://www.oracle.com/a/ocom/docs/corporate/csp-security.pdf
- rule_id: oci.database.backup.backup_destination_private_only_enforced
  service: database
  resource: backup
  requirement: Backup Destination Private Only Enforced
  scope: database.backup.backup_recovery
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Database Backups Are Stored in Private Endpoints
  rationale: Storing database backups in private endpoints minimizes exposure to unauthorized access and potential data breaches. This practice is crucial for maintaining data confidentiality and integrity, especially for sensitive or regulated information. Compliance with data protection regulations such as GDPR, HIPAA, and PCI-DSS often requires secure data storage practices to protect consumer data.
  description: This rule checks that Oracle Cloud Infrastructure (OCI) database backups are configured to use private endpoints only, rather than public endpoints, reducing exposure to external threats. To verify, inspect the backup configuration in the Oracle Cloud Console and ensure that the backup destination is set to a private IP address or private subnet. Remediation involves updating the backup settings to use private IPs, which can be done by modifying the backup network settings in the OCI Database service configurations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/backingup.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-security-best-practices.pdf
  - CIS OCI Benchmark - Database Backup Configuration
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.database.autonomous_database.backup_encrypted_at_rest_cmek
  service: database
  resource: autonomous_database
  requirement: Backup Encrypted At Rest Cmek
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous DB Backups Use Customer-Managed Encryption Keys
  rationale: Encrypting backups at rest with customer-managed encryption keys (CMEK) enhances data security by allowing organizations to control key management and meet stringent compliance requirements. This approach mitigates the risk of unauthorized data access, provides an additional layer of security in case of a data breach, and supports compliance with standards like PCI-DSS and HIPAA that mandate robust encryption practices.
  description: This rule checks that Autonomous Database backups are encrypted at rest using customer-managed encryption keys (CMEK) in OCI. To verify, ensure the database instance is configured to use a key from Oracle Cloud Infrastructure Vault. If not, configure a vault and generate a master key, then associate it with the Autonomous Database. This setup provides enhanced control over encryption keys, crucial for data protection and privacy.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbusingcustomerkeys.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.autonomous_database.backup_immutable_or_worm_enabled
  service: database
  resource: autonomous_database
  requirement: Backup Immutable Or Worm Enabled
  scope: database.autonomous_database.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: medium
  title: Ensure Autonomous Database Backups are Immutable or WORM Enabled
  rationale: Enabling immutable or WORM (Write Once Read Many) backups for Autonomous Databases in OCI protects critical data from being altered or deleted, reducing the risk of data loss due to human error, ransomware attacks, or malicious insiders. This configuration is crucial for meeting regulatory compliance requirements such as GDPR, which mandates data integrity and protection against unauthorized access.
  description: This rule checks if Autonomous Database backups are configured with immutability or WORM settings, ensuring they cannot be tampered with post-creation. To verify, check the backup settings in the Oracle Cloud Console under the Autonomous Database's backup configuration. If not enabled, modify the backup settings to use immutable or WORM storage. This can be done through the OCI console or CLI, ensuring that backup data remains unaltered for the retention period.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.oracle.com/security-cloud/compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-88/rev-1/final
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/standard/54534.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_securitybestpractices.htm
- rule_id: oci.database.backup.backup_schedule_defined_min_frequency_required
  service: database
  resource: backup
  requirement: Backup Schedule Defined Min Frequency Required
  scope: database.backup.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: medium
  title: Database Backup Schedule Minimum Frequency Requirement
  rationale: Regularly scheduled backups are crucial for data recovery and business continuity. Without a defined backup schedule, organizations face increased risk of data loss due to system failures, human error, or malicious attacks. Meeting this requirement helps ensure compliance with data protection regulations and mitigates the impact of potential data breaches.
  description: This rule verifies that Oracle Cloud Infrastructure (OCI) databases have a backup schedule defined with a minimum frequency. It specifically checks for configurations where backups are scheduled less frequently than the recommended baseline. To verify, access the OCI Console, navigate to the database service, and review the backup settings for each database instance. If a database does not meet the minimum frequency requirement, update the backup schedule to align with best practices. Ensure automated backups are enabled and set to occur at least daily.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/backingup.htm
  - https://www.oracle.com/security-cloud/cis-benchmarks/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://www.oracle.com/cloud/security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.autonomous_database.option_group_insecure_extensions_not_enabled
  service: database
  resource: autonomous_database
  requirement: Option Group Insecure Extensions Not Enabled
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Disable Insecure Extensions in Autonomous Databases
  rationale: Disabling insecure extensions in OCI Autonomous Databases is crucial for protecting sensitive data from potential vulnerabilities that can be exploited by attackers. These extensions may introduce security weaknesses that could lead to unauthorized data access or data corruption, impacting data integrity and compliance with regulatory standards such as PCI-DSS and HIPAA.
  description: This rule checks whether insecure extensions are disabled in Autonomous Databases on OCI. Autonomous Databases should not have extensions enabled that are known to be insecure or deprecated, as they can pose significant security risks. To verify compliance, review the database configuration settings in the OCI console or via the CLI, ensuring that option groups do not include insecure extensions. Remediate by updating the option group settings to disable these extensions, enhancing the security posture of the database.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_compute
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security-cloud/compliance/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.oracle.com/database/technologies/dwh-bigdata/adb-faq.html
- rule_id: oci.database.autonomous_database.option_group_only_approved_extensions_enabled
  service: database
  resource: autonomous_database
  requirement: Option Group Only Approved Extensions Enabled
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Only Approved Extensions in Autonomous Database
  rationale: Allowing unauthorized extensions in Autonomous Databases can lead to vulnerabilities, increase the attack surface, and result in data breaches or compliance violations. By limiting extensions to an approved list, organizations can mitigate risks associated with malicious or untrusted code execution, thus ensuring data security and privacy while adhering to industry regulations like PCI-DSS and GDPR.
  description: This rule checks if only approved extensions are enabled for Oracle Autonomous Databases. Administrators should configure their option groups to include only vetted and necessary extensions, reducing potential security vulnerabilities. Verification involves reviewing the option group settings in the OCI Console or via CLI/API commands. Remediation requires updating the option group to disable non-approved extensions and ensuring compliance with organizational security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/security/cloud-security/best-practices.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
  - https://www.oracle.com/security/
- rule_id: oci.database.autonomous_database.parameter_group_audit_logging_enabled
  service: database
  resource: autonomous_database
  requirement: Parameter Group Audit Logging Enabled
  scope: database.autonomous_database.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Audit Logging for Autonomous Database Parameters
  rationale: Audit logging is crucial for tracking access and changes to Autonomous Database configurations, providing visibility into potential unauthorized activities and supporting forensic investigations. This is especially important for compliance with regulations like PCI-DSS and HIPAA, which require detailed audit trails to protect sensitive data.
  description: This rule checks whether audit logging is enabled for parameter changes in Oracle Cloud Infrastructure's Autonomous Database. Audit logging should be configured to capture all modifications to parameter groups, ensuring that any unauthorized or unintended changes are recorded. To enable logging, navigate to the Autonomous Database's console, access the 'Database Management' section, and ensure the audit logging feature is activated. This helps maintain compliance and enhances security posture by providing a clear audit trail.
  references:
  - https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/monitoring-database-service.html#GUID-9B3F8D5B-4E56-4CE8-9B5E-2F3188D1B9F3
  - https://www.oracle.com/security-cloud/cis-oracle-database-benchmark-v2-0-0.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://cloud.oracle.com/en_US/paas/atp/features
- rule_id: oci.database.autonomous_database.parameter_group_insecure_features_disabled_where_applicable
  service: database
  resource: autonomous_database
  requirement: Parameter Group Insecure Features Disabled Where Applicable
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Disable Insecure Features in Autonomous Database Parameter Groups
  rationale: Disabling insecure features in Autonomous Database parameter groups helps mitigate potential data exposure and unauthorized access risks, providing enhanced protection for sensitive data. Such configuration aligns with regulatory standards like PCI-DSS and HIPAA, which mandate stringent data protection and privacy practices. This reduces the attack surface and ensures compliance with industry best practices, safeguarding business reputation and customer trust.
  description: This rule verifies that insecure features within the parameter groups of Oracle Autonomous Databases are disabled where applicable. These features could include weak encryption algorithms or deprecated settings that may compromise data security. Administrators should review and update database parameter groups to ensure that only secure, recommended features are enabled. Remediation involves accessing the OCI Console, navigating to the database service, and modifying the parameter settings to disable insecure options.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - CIS Oracle Cloud Infrastructure Foundation Benchmark v1.1.0
  - https://www.pcisecuritystandards.org/document_library
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.database.autonomous_database.schema_encrypted
  service: database
  resource: autonomous_database
  requirement: Schema Encrypted
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Schema Encryption Enabled
  rationale: Encrypting database schemas protects sensitive data from unauthorized access and potential breaches, safeguarding against data loss and ensuring compliance with data protection regulations like GDPR and PCI-DSS. Encryption at rest is crucial for maintaining data confidentiality and integrity, mitigating risks of insider threats and unauthorized data exposure.
  description: This rule checks whether encryption is enabled for schemas within Oracle Autonomous Databases. By default, Oracle Autonomous Databases use Transparent Data Encryption (TDE) to encrypt data at rest, including schemas. Users should verify that TDE is active by reviewing database configurations and ensuring encryption keys are properly managed within Oracle Key Vault or OCI Vault. Remediation involves enabling TDE if disabled and regularly auditing encryption settings.
  references:
  - https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/autonomous-security.html#GUID-3F2C6E7A-9E4B-4D3C-8F7F-8B5E6A7E6B41
  - https://www.oracle.com/security/cloud-security/expertise/
  - NIST SP 800-57 Part 1
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - PCI-DSS Requirement 3
  - https://cloudsecurityalliance.org/research/guidance
- rule_id: oci.virtual_network.subnet.subnet_group_private_subnets_only_enforced
  service: virtual_network
  resource: subnet
  requirement: Subnet Group Private Subnets Only Enforced
  scope: virtual_network.subnet.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Enforce Private Subnet Usage in Subnet Groups
  rationale: Ensuring that subnet groups are restricted to private subnets minimizes the exposure of sensitive data to public networks. This practice reduces the attack surface, mitigates risks associated with unauthorized access, and aligns with compliance requirements for data protection such as GDPR and HIPAA.
  description: This rule checks that all subnets within a subnet group are configured as private. Private subnets prevent direct access from the internet, requiring traffic to flow through secure pathways such as VPNs or bastion hosts. To verify, ensure each subnet in a group has 'private' set to true. Remediation involves converting public subnets to private by updating the routing and security rules to support secure, controlled access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingVCNs.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/cloud/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/securityandcompliance.htm
- rule_id: oci.database.db_system.user_approved_list_of_superusers_only
  service: database
  resource: db_system
  requirement: User Approved List Of Superusers Only
  scope: database.db_system.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict DB System Superuser Access to Approved Users Only
  rationale: Limiting superuser access to a predefined list mitigates the risk of unauthorized database modifications, data breaches, and potential insider threats. This control is critical for maintaining compliance with data protection regulations such as HIPAA and PCI-DSS, which require stringent access controls to sensitive data.
  description: This rule checks that only user-approved superusers have access to Oracle Cloud Infrastructure DB Systems. Administrators should regularly review and update the list of superusers to ensure it aligns with organizational policies. Remediation involves removing unauthorized superusers from the DB System and ensuring all superuser accounts are documented and justified according to role-based access control policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/managingDBsystems.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://cloud.oracle.com/database
- rule_id: oci.database.db_system.user_no_unused_or_default_superusers_enabled
  service: database
  resource: db_system
  requirement: User No Unused Or Default Superusers Enabled
  scope: database.db_system.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Disable Unused or Default Superusers in OCI DB Systems
  rationale: Unused or default superuser accounts in Oracle Cloud Infrastructure (OCI) Database Systems pose significant security risks as they can be exploited by malicious actors to gain unauthorized access, leading to data breaches and potential compliance violations. Regular audits and removal of such accounts help in minimizing the attack surface and aligning with industry regulations such as PCI-DSS and ISO 27001.
  description: This rule checks for the presence of unused or default superuser accounts in OCI Database Systems. It ensures that no such accounts are enabled, thereby reducing potential attack vectors. Administrators should regularly review user accounts within the DB System and disable or remove any superuser accounts that are not actively in use. Verification can be done via the OCI Console or CLI by listing database users and reviewing their status. Remediation involves disabling unused accounts or changing credentials for default accounts to ensure they are not accessible with known defaults.
  references:
  - https://docs.oracle.com/en/cloud/paas/database-dbaas-cloud/csdbi/user-accounts-roles.html
  - https://www.oracle.com/security-alerts/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/document_library?category=pcidss
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.database.db_system.user_password_auth_hardened_or_iam_enforced
  service: database
  resource: db_system
  requirement: User Password Auth Hardened Or IAM Enforced
  scope: database.db_system.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure User Passwords are Hardened or Use IAM Enforcement in DB Systems
  rationale: Weak password policies or lack of IAM enforcement in database systems can lead to unauthorized access, data breaches, and non-compliance with industry regulations such as PCI-DSS and HIPAA. By hardening password policies or enforcing IAM, organizations can mitigate the risk of unauthorized access and ensure that sensitive data is protected from potential threats.
  description: This rule checks if user password authentication for Oracle Cloud Infrastructure (OCI) DB Systems is either hardened with strong policy requirements or enforced through IAM. To verify, ensure that password policies include complexity, expiration, and lockout settings, or configure IAM database authentication. Remediation involves reviewing current password policies via the OCI Console or enabling IAM Integration for databases, which centralizes identity management and enhances security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/usingIAM.htm
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/configuringdbsystem.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-63b.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.database.autonomous_database.restore_cross_account_blocked_by_policy
  service: database
  resource: autonomous_database
  requirement: Restore Cross Account Blocked By Policy
  scope: database.autonomous_database.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Block Cross-Account Restore for Autonomous Databases
  rationale: Preventing cross-account restores of Autonomous Databases is crucial to protect sensitive data from unauthorized access and potential data breaches. It ensures that database restoration actions are confined within the same account, mitigating the risk of data exfiltration and aligning with data governance and compliance requirements such as GDPR and HIPAA.
  description: This rule checks whether policies are in place to block cross-account restore actions for Autonomous Databases in Oracle Cloud Infrastructure. By default, OCI policies should restrict the restoration of databases to the same account to prevent unauthorized access. Verify that IAM policies explicitly deny cross-account restores and update them if necessary. Use the Oracle Cloud Console or CLI to review and modify policies to comply with this security requirement.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.nist.gov/document/sp800-53r5pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/identity-and-access/
  - https://www.oracle.com/a/ocom/docs/oci-security-best-practices.pdf
- rule_id: oci.database.autonomous_database.restore_from_encrypted_backups_only
  service: database
  resource: autonomous_database
  requirement: Restore From Encrypted Backups Only
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Restores Use Encrypted Backups
  rationale: Restoring from encrypted backups is crucial to protect sensitive data from unauthorized access and data breaches. Encrypting backups ensures that even if backup data is intercepted or accessed by unauthorized individuals, it remains unreadable. This practice supports compliance with data protection regulations such as GDPR and HIPAA, which mandate safeguarding personal and sensitive data.
  description: This rule checks that Oracle Cloud Infrastructure Autonomous Databases are configured to restore only from encrypted backups. Verify that backup encryption is enabled by inspecting database backup settings in the OCI Console under the 'Autonomous Database' section. To remediate, ensure that 'Backup Encryption' is enabled when configuring or managing backups in the OCI settings. This helps maintain data integrity and confidentiality during restore operations.
  references:
  - https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/backing-up-and-restoring.html
  - https://www.oracle.com/security/cloud-security/cryptography/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
- rule_id: oci.database.autonomous_database.restore_logs_and_artifacts_encrypted
  service: database
  resource: autonomous_database
  requirement: Restore Logs And Artifacts Encrypted
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Restore Logs Are Encrypted
  rationale: Encrypting restore logs and artifacts for Autonomous Databases in OCI is crucial for protecting sensitive data from unauthorized access and potential data breaches. This practice helps mitigate risks associated with data recovery processes and ensures compliance with data protection regulations like GDPR and CCPA, which mandate the protection of personal and sensitive information.
  description: This rule checks that all restore logs and artifacts for OCI Autonomous Databases are encrypted, ensuring data is protected during and after the backup restoration process. Verify that encryption is enabled by reviewing the database configurations in the OCI console and confirming that encryption keys are managed by Oracle Key Management or customer-managed keys. To remediate, enable encryption via the OCI console under the Autonomous Database settings, ensuring that all backup and restore operations use encryption.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
- rule_id: oci.database.autonomous_database.restore_roles_least_privilege_required
  service: database
  resource: autonomous_database
  requirement: Restore Roles Least Privilege Required
  scope: database.autonomous_database.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Autonomous Database Restore Roles
  rationale: Maintaining least privilege for roles involved in restoring Autonomous Databases is crucial to minimize the risk of unauthorized access and data breaches. Excessive privileges can lead to accidental or malicious data corruption or loss, impacting business continuity and violating compliance mandates such as PCI-DSS and GDPR.
  description: This rule checks whether the IAM policies and roles assigned for restoring Autonomous Databases are aligned with the principle of least privilege. It verifies that only necessary privileges are granted and that roles are not overly permissive. To remediate, review IAM policies and restrict roles to only those permissions essential for the restore operations. Use OCI's policy syntax to specify fine-grained access control, and regularly audit role assignments.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/security/cloud-security/
  - https://www.nist.gov/cyberframework
- rule_id: oci.devops.project.app_version_artifact_encrypted
  service: devops
  resource: project
  requirement: App Version Artifact Encrypted
  scope: devops.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure App Version Artifacts are Encrypted at Rest
  rationale: Encrypting app version artifacts ensures that sensitive information remains protected against unauthorized access and data breaches, reducing the risk of data exposure. This is crucial for maintaining compliance with data protection regulations such as GDPR and industry standards like ISO 27001, which demand robust encryption measures. Failure to encrypt artifacts could lead to significant business and reputational damage due to data leaks or regulatory fines.
  description: This rule checks if app version artifacts within an OCI DevOps project are encrypted at rest using Oracle-managed keys or customer-managed keys. To verify, ensure that the artifacts are stored in OCI Object Storage with encryption enabled. Remediation involves configuring Object Storage buckets to use encryption, which can be done through the OCI Console by selecting the bucket, navigating to the 'Encryption' tab, and choosing either Oracle-managed keys or a customer-managed key from the Vault service.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DevOps/using/home.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#encryption
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
- rule_id: oci.devops.project.app_version_immutable_required
  service: devops
  resource: project
  requirement: App Version Immutable Required
  scope: devops.project.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure App Versions Are Immutable in OCI DevOps Projects
  rationale: Ensuring app versions are immutable is crucial to maintaining the integrity and traceability of application deployments. Immutable versions prevent unauthorized or accidental changes that can lead to inconsistent environments, security vulnerabilities, and compliance violations. This practice supports regulatory requirements for change management and auditability, reducing the risk of deployment errors and enhancing operational stability.
  description: This rule checks that all application versions within an OCI DevOps project are set as immutable. An immutable version ensures that once an application version is deployed, it cannot be altered, thus preserving the deployment's integrity. To verify compliance, ensure that the 'Immutable' setting is enabled for each application version in the OCI DevOps console. Remediation involves updating the application version settings to make them immutable, which can be done via the OCI DevOps service interface or API.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/devops/using/devops_applications.htm
  - https://docs.oracle.com/en-us/iaas/Content/security/OCI_DevSecOps_Best_Practices.htm
  - CIS OCI Benchmark - https://www.cisecurity.org/benchmark/oracle_cloud
  - NIST SP 800-53 CM-5 Configuration Change Control
  - https://www.oracle.com/security-alerts/
  - ISO/IEC 27001:2013 A.12.1.2 Change Management
- rule_id: oci.devops.project.project_no_public_admin_roles_blocked
  service: devops
  resource: project
  requirement: Project No Public Admin Roles Blocked
  scope: devops.project.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Prevent Public Admin Roles in OCI DevOps Projects
  rationale: Allowing public admin roles in OCI DevOps projects significantly increases the risk of unauthorized access and potential data breaches. This exposure can lead to critical business disruptions, loss of sensitive data, and non-compliance with regulations such as NIST, PCI-DSS, and ISO 27001. Unrestricted admin access can also result in malicious actions, impacting service integrity and availability.
  description: This rule ensures that no admin roles are publicly accessible within OCI DevOps projects. It checks for any broad IAM policies that grant admin privileges to the public user group and flags them for review. To verify compliance, users should audit IAM policies and ensure admin roles are assigned only to specific, trusted user groups. Remediation involves modifying these policies to restrict access to authenticated users only, using Oracle Cloud IAM best practices for policy definition.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security-cloud/cis-oracle-cloud-infrastructure-foundations-benchmark-v1.0.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.devops.project.project_required_guardrail_policies_attached
  service: devops
  resource: project
  requirement: Project Required Guardrail Policies Attached
  scope: devops.project.security
  domain: resilience_and_disaster_recovery
  subcategory: backup_configuration
  severity: low
  title: Ensure Guardrail Policies are Attached to DevOps Projects
  rationale: Attaching guardrail policies to DevOps Projects is essential for maintaining a secure and compliant cloud environment. Without these policies, projects may lack necessary controls, increasing the risk of unauthorized access, data breaches, and non-compliance with regulatory standards such as ISO 27001 and NIST. This can lead to financial penalties, data loss, and reputational damage.
  description: This rule checks whether required guardrail policies are attached to Oracle Cloud Infrastructure (OCI) DevOps Projects. Guardrail policies define security boundaries and controls that must be enforced to protect resources. To verify, ensure that each project within the OCI DevOps service has the appropriate IAM policies attached that align with organizational security requirements. Remediation involves reviewing the policies and updating them to meet the required security standards, ensuring they include necessary permissions and constraints.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/devops/using/devops_security.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/security/overview.htm
  - https://cloud.oracle.com/oci/security
- rule_id: oci.devops.project.project_security_services_mandatory_enabled
  service: devops
  resource: project
  requirement: Project Security Services Mandatory Enabled
  scope: devops.project.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Project Security Services are Enabled in OCI DevOps
  rationale: Enabling security services for OCI DevOps projects is crucial for protecting your code repositories and deployment pipelines from unauthorized access and potential breaches. This reduces the risk of data leaks, intellectual property theft, and ensures adherence to compliance requirements such as GDPR and ISO 27001, which mandate stringent access controls and security monitoring.
  description: This rule checks if the security services for a DevOps project are enabled within the Oracle Cloud Infrastructure. It verifies settings such as identity and access management configurations, audit logging, and vulnerability scanning services. To comply, ensure that all security features provided by OCI are activated on your DevOps projects. Remediation involves accessing the OCI console, navigating to the DevOps project settings, and enabling security services under the project's security configuration options.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/devops/using/security.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security.html
- rule_id: oci.data_integration.pipeline.data_pipeline_security_parameter_metadata_disallowed_blocked
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Parameter Metadata Disallowed Blocked
  scope: data_integration.pipeline.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Prevent Insecure Metadata in Data Pipelines
  rationale: Disallowing insecure metadata in data pipelines is crucial to protecting sensitive information from unauthorized access and potential breaches. This practice mitigates risks such as data leaks and ensures compliance with data protection regulations like GDPR and CCPA. By blocking insecure metadata, organizations can maintain the integrity and confidentiality of their data assets.
  description: This rule checks for the presence of disallowed security parameter metadata in OCI Data Integration pipelines. It ensures that data pipelines do not contain metadata that could expose sensitive information or weaken encryption. To verify compliance, review pipeline configurations for unauthorized metadata and remove or correct it as necessary. Remediation involves updating the pipeline security settings to conform with best practices, ensuring all metadata is encrypted and access-controlled.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/data-integration-overview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://cloudsecurityalliance.org/artifacts/security-guidance-v4/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_integration.pipeline.data_pipeline_security_parameter_metadata_sensitive_type
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Parameter Metadata Sensitive Type
  scope: data_integration.pipeline.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Sensitive Metadata in Data Pipelines is Properly Encrypted
  rationale: Encrypting sensitive metadata in data pipelines is crucial to protect sensitive information from unauthorized access and data breaches. This practice reduces the risk of exposing sensitive data types such as PII, which can lead to significant financial penalties and reputational damage under regulations like GDPR and CCPA.
  description: This rule verifies that all sensitive metadata within OCI Data Integration pipelines is encrypted at rest using OCI's native encryption services. To check compliance, ensure that pipeline configurations specify encryption for sensitive metadata fields by using Oracle's Transparent Data Encryption (TDE). Remediation involves configuring the pipeline to utilize OCI's Key Management Service (KMS) to manage encryption keys effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/datapipeoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm#Encryption_at_Rest
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-111.pdf
  - https://www.oracle.com/security/cloud-security/key-management/
- rule_id: oci.data_integration.pipeline.data_pipeline_security_parameter_metadata_values_secret
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Parameter Metadata Values Secret
  scope: data_integration.pipeline.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Data Pipeline Parameters are Secured with Secrets
  rationale: Properly securing data pipeline parameters is crucial to protect sensitive information from unauthorized access, which can lead to data breaches and compliance violations. By using secrets for parameter values, organizations can mitigate risks of data exposure and ensure adherence to data protection regulations such as GDPR and HIPAA.
  description: This rule checks that all sensitive data pipeline parameter metadata values in OCI Data Integration pipelines are stored using OCI Vault secrets. To verify compliance, review the data pipeline configurations to ensure that sensitive parameters are referenced as secrets. Remediation involves creating secrets in OCI Vault and updating pipeline configurations to reference these secrets instead of plain text values.
  references:
  - https://docs.oracle.com/en-us/iaas/data-integration/doc/securing-data-using-vault.html
  - https://www.oracle.com/security/cloud-security/vault/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://www.nist.gov/privacy-framework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.data_integration.pipeline.data_pipeline_security_parameter_constraint_allowlist_required
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Parameter Constraint Allowlist Required
  scope: data_integration.pipeline.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Pipeline Parameter Constraints Use Allowlist
  rationale: Enforcing an allowlist for data pipeline parameters mitigates risks of unauthorized data access and potential data leaks by ensuring only predefined, safe values are permitted. This practice helps protect sensitive data, aligns with data protection regulations, and enhances overall data privacy by preventing injection attacks and unauthorized data manipulation.
  description: This rule checks if data pipeline configurations in OCI Data Integration use security parameter constraints with an allowlist. This involves verifying that each parameter within a pipeline has an associated allowlist defining acceptable values. To remediate, review the pipeline configurations in the OCI Console and define allowlists for all relevant parameters to restrict inputs to known safe values. This practice ensures compliance with encryption at rest policies and enhances data security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/data-integration-overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/capabilities/data-protection/
  - https://www.oracle.com/security/cloud-security/capabilities/compliance/
- rule_id: oci.data_integration.pipeline.data_pipeline_security_parameter_constraint_max_required
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Parameter Constraint Max Required
  scope: data_integration.pipeline.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enforce Maximum Security Parameter for Data Pipelines
  rationale: Ensuring that data pipelines in OCI have a maximum security parameter constraint is crucial for protecting sensitive data from unauthorized access and ensuring data integrity. This practice mitigates potential threats such as data breaches or leaks, which can lead to significant financial loss, reputational damage, and non-compliance with data protection regulations like GDPR and CCPA.
  description: This rule checks whether data pipelines in Oracle Cloud Infrastructure's Data Integration service enforce a maximum security parameter constraint, ensuring that all data is encrypted at rest using Oracle-managed keys. To verify, ensure that pipeline configurations specify appropriate security parameters and leverage Oracle's encryption capabilities. Remediation involves setting the 'maxSecurityParameter' attribute in pipeline configurations to utilize Oracle-managed encryption. This enhances data protection and aligns with best practices for encryption.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/data_integration.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57p1r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/cloud/security/ensuring-data-protection-and-privacy.html
- rule_id: oci.data_integration.pipeline.data_pipeline_security_parameter_constraint_min_required
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Parameter Constraint Min Required
  scope: data_integration.pipeline.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Pipeline Encryption at Rest in OCI
  rationale: Encrypting data at rest in data pipelines is crucial to protect sensitive information from unauthorized access and data breaches. It ensures compliance with regulatory requirements like GDPR and HIPAA, which mandate data protection and privacy. Neglecting encryption can lead to severe business impacts, including financial penalties, reputational damage, and loss of customer trust.
  description: This rule checks that all data processed by OCI Data Integration pipelines are encrypted at rest using Oracle-managed keys. Verify that encryption settings are enabled in the pipeline configuration. Remediate by setting the 'Data Encryption' parameter to 'Enabled' for all pipelines and ensure they use Oracle's default encryption keys or customer-managed keys as required. Regularly review and update encryption settings to align with organizational security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Data-Integration/Tasks/encryption.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org
  - https://www.hipaajournal.com/hipaa-encryption-requirements/
- rule_id: oci.data_integration.pipeline.data_pipeline_security_parameter_constraint_pattern_required
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Parameter Constraint Pattern Required
  scope: data_integration.pipeline.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Security Parameter Constraints in Data Pipelines
  rationale: Insecure data pipelines can expose sensitive data to unauthorized access, leading to potential data breaches and compliance violations. By enforcing security parameter constraints, organizations can mitigate risks such as data leaks and ensure compliance with regulatory standards like PCI-DSS and HIPAA, which demand robust data protection measures.
  description: This rule checks for the presence of security parameter constraints in OCI Data Integration pipelines, ensuring that data is encrypted at rest and protected from unauthorized access. To verify compliance, review pipeline configurations to ensure security parameters are defined and utilize Oracle's encryption features. Remediation involves configuring pipelines to include security constraints that enforce encryption and access controls, aligning with OCI best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/home.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-210.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
- rule_id: oci.data_integration.pipeline.data_pipeline_security_parameter_binding_only_bound
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Parameter Binding Only Bound
  scope: data_integration.pipeline.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Pipeline Security Parameter Binding is Only Bound
  rationale: Properly binding security parameters in data pipelines is crucial to prevent unauthorized access and data breaches, which could lead to significant financial losses and reputational damage. This practice helps mitigate risks associated with data leaks and ensures compliance with privacy regulations such as GDPR and CCPA, which mandate strict data protection measures.
  description: This rule checks that all security parameters in OCI Data Integration pipelines are properly bound, preventing leaks and unauthorized access. Ensure that security parameters are configured to be used only within their defined scope. To verify, review pipeline configurations in the OCI console to ensure all parameters are explicitly bound. If unbound parameters are found, immediately update the configuration to bind them appropriately to prevent potential data exposure.
  references:
  - https://docs.oracle.com/en-us/iaas/data-integration/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/document-1990
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.oracle.com/security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_integration.pipeline.data_pipeline_security_parameter_binding_secret_runtime
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Parameter Binding Secret Runtime
  scope: data_integration.pipeline.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Secret Runtime Binding in Data Pipelines
  rationale: Improper handling of secrets in data pipelines can lead to unauthorized access and data breaches, posing a significant risk to sensitive data. Ensuring that secrets are securely bound at runtime enhances the confidentiality and integrity of the data processing environment, aligning with compliance requirements like PCI-DSS and GDPR.
  description: This rule checks for the secure binding of secrets to data pipeline parameters at runtime within OCI Data Integration. It ensures that secrets are not hardcoded and are retrieved securely at execution, minimizing exposure to unauthorized users. To verify, review the pipeline configurations to ensure parameter secrets are stored in OCI Vault and accessed via IAM policies. Remediation involves configuring pipelines to use OCI Vault for secret management and enforcing IAM roles for access control.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations_benchmark/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-cloud-security.html
- rule_id: oci.data_integration.pipeline.data_pipeline_security_parameter_binding_sensitive_logged
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Parameter Binding Sensitive Logged
  scope: data_integration.pipeline.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Log Sensitive Binding in OCI Data Integration Pipelines
  rationale: Logging sensitive parameter bindings in data pipelines is crucial for tracing and auditing purposes. It helps in identifying unauthorized access attempts and potential data breaches, thereby reducing the risk of data exposure. Ensuring that sensitive data is logged appropriately can assist in compliance with regulatory requirements such as PCI-DSS and GDPR, which mandate the protection and auditability of personal and sensitive information.
  description: This rule checks whether sensitive parameters in OCI Data Integration pipelines are logged effectively. It requires setting up audit logs to capture details of data pipeline executions, including sensitive parameter bindings, to monitor access and modifications. To verify, ensure that logging is enabled in the OCI Console under the Data Integration service, and review log entries for sensitive parameters. Remediation involves configuring logging policies and using Oracle Cloud's audit tools to capture and analyze relevant log data, aligning with best practices for security and compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/auditpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/security/cloud-security/audit/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-171.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.data_integration.pipeline.data_pipeline_security_parameter_allowed_values_required
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Parameter Allowed Values Required
  scope: data_integration.pipeline.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enforce Allowed Values for Data Pipeline Security Parameters
  rationale: Ensuring that only approved values are used for security parameters in Data Pipelines minimizes the risk of using weak or non-compliant configurations that could lead to data breaches. This is crucial for maintaining data protection, adhering to regulatory requirements, and protecting against unauthorized access or data manipulation.
  description: This check verifies that all security parameters within OCI Data Integration pipelines are set to predefined, allowed values. This includes settings such as encryption keys and data masking configurations. To verify compliance, review the pipeline configuration in the OCI console and ensure all security-related parameters adhere to the organization's security policy. Remediation involves updating any non-compliant parameters to use allowed values, as specified by organizational guidelines.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/dataintegrationoverview.htm
  - https://www.oracle.com/cloud/security/
  - 'NIST SP 800-53 Rev. 5: CM-7 Least Functionality'
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-security-best-practices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
- rule_id: oci.data_integration.pipeline.data_pipeline_security_parameter_attributes_no_plaintext_secrets
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Parameter Attributes No Plaintext Secrets
  scope: data_integration.pipeline.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Prevent Plaintext Secrets in Data Pipeline Security Parameters
  rationale: Storing secrets in plaintext within data pipeline configurations poses significant security risks, such as unauthorized access and data breaches. This practice can lead to non-compliance with data protection regulations like GDPR and CCPA, and can expose sensitive data to insider threats and external attackers. Ensuring secrets are encrypted protects the integrity and confidentiality of critical data, minimizing the risk of financial loss and reputational damage.
  description: This rule checks for any plaintext secrets in the security parameter attributes of OCI Data Integration pipelines. It ensures that secrets are stored using OCI Vault or another secure method. Verify pipeline configurations by reviewing security parameter fields and replace any plaintext entries with references to encrypted secrets. Remediation involves updating the pipeline configuration to use OCI Vault for secret management, ensuring that no sensitive information is exposed in plaintext.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/dataintegrationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/security/cloud-security/vault/
- rule_id: oci.data_integration.pipeline.data_pipeline_security_parameter_default_not_sensitive_enabled
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Parameter Default Not Sensitive Enabled
  scope: data_integration.pipeline.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Sensitive Data Pipeline Parameters are Enabled
  rationale: Enabling sensitive parameters in data pipelines is crucial to protect sensitive information from unauthorized access and ensure compliance with data protection regulations like GDPR and HIPAA. Misconfigured parameters can lead to data breaches, resulting in reputational damage and financial loss. This rule helps mitigate risks by enforcing secure defaults in data integration workflows.
  description: This rule checks if the default setting for data pipeline security parameters is configured to handle sensitive data. It verifies that all parameters that should be marked as sensitive are accurately flagged, preventing exposure of confidential information. To verify, review the pipeline configuration in the OCI console and ensure sensitive parameters are correctly defined. Remediation involves updating the pipeline parameters to mark appropriate fields as sensitive and using encryption for data at rest.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/data-integration-overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/identitysecurity.htm
- rule_id: oci.data_integration.pipeline.data_pipeline_security_parameter_max_length_required
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Parameter Max Length Required
  scope: data_integration.pipeline.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enforce Max Length for Data Pipeline Security Parameters
  rationale: Limiting the length of data pipeline security parameters prevents buffer overflow attacks and ensures that sensitive information is securely handled. This measure mitigates the risk of unauthorized data access or corruption, thus protecting the integrity and confidentiality of data processed within OCI Data Integration. Compliance with data protection regulations often requires stringent control over data handling practices, making this a critical security measure.
  description: This rule checks whether the security parameters within OCI Data Integration pipelines adhere to a specified maximum length. Ensuring these parameters are not excessively long prevents potential exploitation through buffer overflow attacks. To verify compliance, review the security parameter configurations in your data pipelines and adjust them to comply with the maximum length requirement. Remediation involves accessing the OCI console, navigating to the Data Integration service, and updating pipeline configurations to enforce the parameter length constraint.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/dataintegrationoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/
  - https://www.iso.org/standard/54534.html
- rule_id: oci.data_integration.pipeline.data_pipeline_security_parameter_min_length_required
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Parameter Min Length Required
  scope: data_integration.pipeline.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Pipeline Security Parameter Minimum Length
  rationale: Minimum length requirements for security parameters in data pipelines help mitigate the risk of brute force attacks and unauthorized access. Ensuring adequate parameter length supports data protection and privacy compliance by fortifying the security posture against potential breaches. This is essential for meeting regulatory obligations and safeguarding sensitive information within OCI environments.
  description: This rule checks that security parameters used in OCI Data Integration pipelines meet the minimum length requirement. It involves verifying that all security-related inputs, such as passwords or keys, are sufficiently long to resist brute force attacks. To remediate, review the security parameter configurations in the pipeline and ensure they conform to length policies, updating any parameters that do not meet the minimum criteria.
  references:
  - https://docs.oracle.com/en-us/iaas/data-integration/doc/data-integration-service-overview.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_approach.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.data_integration.pipeline.data_pipeline_security_parameter_pattern_defined_required
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Parameter Pattern Defined Required
  scope: data_integration.pipeline.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Security Patterns for Data Pipeline Parameters
  rationale: Defining security parameter patterns for data pipelines is crucial to prevent unauthorized access and data breaches, which could lead to significant financial losses and reputational damage. Proper configuration helps in mitigating risks of data exposure and ensures compliance with industry standards such as PCI-DSS and GDPR, which mandate securing sensitive data.
  description: This rule checks whether security parameter patterns are defined for data pipelines in Oracle Cloud Infrastructure's Data Integration service. It ensures that all sensitive data fields in pipelines have appropriate encryption and access control settings. Verification involves reviewing the pipeline configurations for the presence of security patterns. Remediation requires updating the pipeline configurations to include necessary security parameter patterns, leveraging Oracle's encryption services.
  references:
  - https://docs.oracle.com/en-us/iaas/data-integration/
  - https://www.oracle.com/security-cloud/standards.html
  - NIST SP 800-53 Rev. 5
  - PCI-DSS v3.2.1
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-1.0.0.pdf
  - https://cloud.oracle.com/en_US/security
- rule_id: oci.data_integration.pipeline.data_pipeline_security_parameter_type_set
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Parameter Type Set
  scope: data_integration.pipeline.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Pipeline Security Parameters Are Properly Configured
  rationale: Proper configuration of security parameters in data pipelines is crucial for safeguarding sensitive information against unauthorized access and potential data breaches. Misconfigured security settings can lead to exposure of sensitive data, violating data protection laws such as GDPR and impacting business reputation and compliance status.
  description: This rule checks whether the security parameters in OCI Data Integration pipelines are correctly set to enforce encryption at rest. It involves verifying that the data pipeline utilizes OCI's encryption capabilities by setting the appropriate security parameter types, such as 'ENCRYPTED' for data storage and transmission. To remediate, ensure that all data pipelines are configured to use OCI-managed encryption keys, and review the pipeline settings in the OCI console to confirm encryption is enabled.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Data-Integration/home.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
  - https://www.oracle.com/cloud/infrastructure/compliance/
- rule_id: oci.data_integration.pipeline.data_pipeline_security_parameter_value_from_sensitive
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Parameter Value From Sensitive
  scope: data_integration.pipeline.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Secure Sensitive Parameter Values in Data Pipelines
  rationale: Ensuring sensitive parameter values in data pipelines are properly secured is critical to prevent unauthorized access and data breaches. Mismanagement of sensitive data can lead to exposure of confidential information, legal penalties, and loss of customer trust. Compliance with data protection regulations such as GDPR and CCPA necessitates robust security measures for sensitive data handling.
  description: This rule checks whether sensitive parameter values within OCI Data Integration pipelines are sourced from secure sources or encrypted repositories. It ensures that pipeline configurations do not expose sensitive information in plaintext, thereby mitigating the risk of data leakage. To remediate, verify that all sensitive parameters are retrieved from OCI Vault or other secure storage solutions and that they are encrypted at rest. Regularly audit pipeline configurations to ensure compliance with security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/data-integration/doc/pipeline-configuration.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.identity.user.instance_profile_no_with_admin_star_restricted
  service: identity
  resource: user
  requirement: Instance Profile No With Admin Star Restricted
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Admin Privileges in Instance Profiles
  rationale: Allowing users to assign instance profiles with unrestricted admin access poses significant security risks, including potential unauthorized access and privilege escalation. This can lead to data breaches, compliance violations, and operational disruptions, especially if compromised credentials are used maliciously. Restricting such permissions aligns with compliance requirements such as PCI-DSS and NIST standards, ensuring a secure and controlled cloud environment.
  description: This rule checks if users are assigned instance profiles that include admin access with wildcard ('*') permissions, which can lead to excessive privilege allocation. To verify, inspect user policies and ensure no instance profiles grant unrestricted admin access. Remediation involves auditing and updating IAM policies to adhere to the principle of least privilege, removing or restricting any wildcard permissions associated with administrative roles.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/security_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://cloud.oracle.com/cloud-security
- rule_id: oci.identity.policy.instance_profile_role_attached_restricted
  service: identity
  resource: policy
  requirement: Instance Profile Role Attached Restricted
  scope: identity.policy.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict Instance Profile Role Attachments in OCI Policies
  rationale: Restricting roles attached to instance profiles minimizes the risk of privilege escalation and unauthorized access. By ensuring that only necessary roles are assigned, organizations can reduce the attack surface and comply with security best practices and regulatory requirements such as PCI-DSS and ISO 27001.
  description: This rule checks that policies do not allow unrestricted attachment of roles to instance profiles in OCI. Instance profiles should only have roles that are necessary for the specific tasks they need to perform. To verify, review OCI policies and ensure role attachments are limited to the minimum necessary. If non-compliant, update policies to restrict role attachments appropriately.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/access.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.identity.policy.instance_profile_role_policies_least_privilege_required
  service: identity
  resource: policy
  requirement: Instance Profile Role Policies Least Privilege Required
  scope: identity.policy.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Instance Profile Role Policies Follow Least Privilege
  rationale: Implementing least privilege for instance profile roles reduces the attack surface by limiting access to only necessary resources, thereby minimizing potential misuse or exposure of sensitive data. This aligns with security best practices and compliance requirements like PCI-DSS and ISO 27001, which mandate restricting access rights to the minimum necessary.
  description: This rule checks whether instance profile role policies in OCI are configured with the principle of least privilege. It involves reviewing and restricting IAM policies to ensure roles have only the permissions essential for their function. Verification includes auditing current policies, setting precise permissions, and regularly reviewing them. Remediation involves updating policies to remove excessive permissions and applying specific, task-oriented roles.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/OCI_CIS_Benchmark_v1.1.0.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://cloud.oracle.com/cloud-security
- rule_id: oci.container_engine.cis_2_3_2_needs_development.cis_2_3_needs_development
  service: container_engine
  resource: cis_2_3_2_needs_development
  requirement: Cis 2 3 Needs Development
  scope: container_engine.cis_2_3_2_needs_development.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Pod Security Policies are Enabled in OKE
  rationale: Pod Security Policies (PSPs) help define a set of conditions that a pod must meet to be accepted into the system, thus limiting the potential attack surface by controlling the behavior of deployed containers. Enabling PSPs in Oracle Kubernetes Engine (OKE) mitigates risks such as privilege escalation and unauthorized access to host resources, aligning with compliance standards and reducing the likelihood of security breaches.
  description: This rule checks if Pod Security Policies are configured and enforced in your Oracle Kubernetes Engine clusters. To verify, ensure that PSPs are enabled in the OKE control plane and that appropriate policies are defined to restrict potentially dangerous operations. Remediation involves creating and applying PSPs according to your security requirements, using Kubernetes Role-Based Access Control (RBAC) to enforce them across your clusters.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengconfiguringsecurity.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
  - https://kubernetes.io/docs/concepts/policy/pod-security-policy/
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
- rule_id: oci.container_engine.cis_3_2_10_needs_development.cis_3_2_10_needs_development
  service: container_engine
  resource: cis_3_2_10_needs_development
  requirement: Cis 3 2 10 Needs Development
  scope: container_engine.cis_3_2_10_needs_development.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure K8s API Server Logging is Enabled
  rationale: Enabling Kubernetes API Server logging is crucial for monitoring and auditing cluster activities. It aids in detecting unauthorized access, assessing misconfigurations, and meeting compliance requirements such as PCI-DSS and ISO 27001 by providing a trail of user and system actions.
  description: This rule checks if the Kubernetes API Server logging is enabled in Oracle Cloud Infrastructure Container Engine for Kubernetes. To verify, ensure the API server has logging parameters set appropriately in your cluster configuration. Remediation involves configuring the API server with appropriate log verbosity and storage settings to capture and retain logs as per your security policy.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengsettinglogging.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://kubernetes.io/docs/tasks/debug-application-cluster/audit/
- rule_id: oci.container_engine.cis_3_2_2_needs_development.cis_3_2_needs_development
  service: container_engine
  resource: cis_3_2_2_needs_development
  requirement: Cis 3 2 Needs Development
  scope: container_engine.cis_3_2_2_needs_development.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Kubernetes Network Policies are Implemented
  rationale: Implementing Kubernetes Network Policies is crucial for restricting network traffic between pods, reducing the attack surface, and mitigating lateral movement within a cluster. This practice is vital for protecting sensitive data and maintaining compliance with security standards such as PCI-DSS and ISO 27001, which require robust network security controls.
  description: This rule checks whether Kubernetes Network Policies are defined and enforced within your OCI Container Engine clusters. Network Policies enable you to control the traffic flow at the IP address or port level, ensuring that only authorized communication occurs between pods. To verify, review the cluster configurations for applied Network Policies. Remediate by creating Network Policies that specify allowed ingress and egress traffic in each namespace, following OCI best practices for secure network segmentation.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengnetwork_policies.htm
  - https://workbench.cisecurity.org/benchmarks/6626/sections/1127313
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://kubernetes.io/docs/concepts/services-networking/network-policies/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.container_engine.cis_5_4_4_needs_development.cis_5_4_needs_development
  service: container_engine
  resource: cis_5_4_4_needs_development
  requirement: Cis 5 4 Needs Development
  scope: container_engine.cis_5_4_4_needs_development.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Kubernetes API Server Audit Logging is Enabled
  rationale: Audit logging for the Kubernetes API server is critical for detecting unauthorized access and understanding the actions performed on your clusters. Without audit logs, tracking changes or investigating security incidents becomes challenging, increasing the risk of undetected breaches and non-compliance with regulations like ISO 27001 and SOC2.
  description: This rule verifies that audit logging is enabled for the Kubernetes API server in Oracle Cloud Infrastructure (OCI). Audit logs provide a record of all requests made to the API server, which is essential for security monitoring and incident response. To enable audit logging, configure your Kubernetes cluster to include an audit policy file and ensure the API server is set to log all requests. Use OCI's logging service to collect and monitor these logs for suspicious activity.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengconfiguringlogging.htm
  - https://workbench.cisecurity.org/benchmarks/5293
  - https://www.nist.gov/document-800-53
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.events.rule.event_source_permissions_least_privilege_required
  service: events
  resource: rule
  requirement: Event Source Permissions Least Privilege Required
  scope: events.rule.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Event Source Uses Least Privilege Permissions
  rationale: Applying the principle of least privilege to event source permissions minimizes the attack surface and reduces the risk of unauthorized access. Excessive permissions can lead to potential data breaches or misuse of resources, impacting compliance with standards like NIST and ISO 27001. Limiting permissions helps maintain a secure cloud environment and protects sensitive operations within the OCI ecosystem.
  description: This check ensures that event rules in OCI are configured with the minimum required permissions. Verify that each event source has only the essential permissions necessary to perform its function. To remediate, review the IAM policy statements associated with event sources and adjust them to limit access strictly to necessary actions. Use Oracle's Identity and Access Management (IAM) service to manage and enforce these permissions efficiently.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.events.rule.event_source_authenticated
  service: events
  resource: rule
  requirement: Event Source Authenticated
  scope: events.rule.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Event Source Authentication in OCI Events
  rationale: Ensuring that event sources are authenticated is crucial for maintaining the integrity and security of event-driven architectures in OCI. Unauthorized or improperly configured event sources can lead to unauthorized access, data breaches, or service disruptions by injecting malicious events. This practice supports compliance with security standards and helps protect sensitive data and operations within the cloud environment.
  description: This rule checks that all event sources in OCI Events are authenticated, ensuring that only legitimate and authorized sources can trigger events. To verify, ensure that each event rule specifies a valid and authenticated source. Remediation involves configuring event rules to validate the identity of the source, typically by using Oracle Cloud Infrastructure Identity and Access Management (IAM) policies to control access and permissions for event sources.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.database.db_system.cluster_snapshot_cross_account_sharing_restricted
  service: database
  resource: db_system
  requirement: Cluster Snapshot Cross Account Sharing Restricted
  scope: database.db_system.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Restrict Cross Account Sharing of Cluster Snapshots
  rationale: Restricting cross-account sharing of cluster snapshots reduces the risk of unauthorized access to sensitive database configurations and data. It helps prevent potential data breaches and ensures compliance with data protection regulations by controlling data exposure across different accounts.
  description: This rule checks if cluster snapshots created from Oracle Cloud Infrastructure (OCI) database systems are shared across different OCI accounts. Sharing snapshots across accounts can expose sensitive data and configurations to unauthorized access. Verify that cross-account sharing is disabled by reviewing the sharing permissions on your database snapshots. To remediate, ensure that snapshots are only shared with trusted accounts, or ideally, not shared across accounts at all.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/backingup.htm
  - https://www.oracle.com/cloud/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-database-security/
- rule_id: oci.database.autonomous_database.cluster_snapshot_cross_region_copy_encrypted
  service: database
  resource: autonomous_database
  requirement: Cluster Snapshot Cross Region Copy Encrypted
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous DB Snapshots are Encrypted for Cross-Region Copy
  rationale: Encrypting snapshots when copying across regions protects against unauthorized access and data breaches during transit. It ensures that sensitive data remains confidential and secure, aligning with regulatory requirements like GDPR and CCPA, and prevents potential data exposure in the event of interception.
  description: This rule checks that Autonomous Database snapshots are encrypted when copied across regions. To verify, ensure that the 'Copy with Encryption' option is selected when setting up cross-region replication. Remediation involves configuring the database to utilize Oracle's Transparent Data Encryption (TDE) for all snapshot operations, ensuring compliance with industry standards and safeguarding sensitive data.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbcopying.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/security-cloud/cloud-security-best-practices/
- rule_id: oci.database.autonomous_database.cluster_snapshot_encrypted
  service: database
  resource: autonomous_database
  requirement: Cluster Snapshot Encrypted
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Snapshots Are Encrypted
  rationale: Encrypting snapshots of Autonomous Databases ensures that sensitive data at rest is protected from unauthorized access. This is crucial for maintaining data confidentiality, meeting regulatory compliance requirements, and mitigating the risk of data breaches.
  description: This rule checks if snapshots of Autonomous Databases in Oracle Cloud Infrastructure are encrypted using Oracle-managed keys or customer-managed keys. If a snapshot is found to be unencrypted, it poses a risk of unauthorized data exposure. To remediate, ensure that encryption is enabled for all snapshots by configuring the Autonomous Database settings to use encryption keys.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbmanaging.htm#adb-managing-encryption
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57p1r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.db_system.cluster_snapshot_not_publicly_shared_blocked
  service: database
  resource: db_system
  requirement: Cluster Snapshot Not Publicly Shared Blocked
  scope: database.db_system.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: critical
  title: Ensure Database Cluster Snapshots Are Not Publicly Shared
  rationale: Publicly sharing database snapshots can expose sensitive data to unauthorized access. This poses significant security risks including data breaches, non-compliance with data protection regulations like GDPR and CCPA, and potential financial loss. Restricting access to snapshots ensures only authorized personnel can access critical data, thereby maintaining data integrity and confidentiality.
  description: This rule verifies that snapshots of DB System clusters in OCI are not publicly shared, preventing unauthorized access. The check involves examining the sharing settings of each snapshot to ensure they are private or shared with specific, authorized OCI tenancies only. To remediate, review the sharing settings of each snapshot and modify any that are publicly accessible, ensuring they are either private or have restricted access settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/managingDBsystems.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
  - https://www.oracle.com/security/cloud-security/
  - CIS OCI Foundations Benchmark
  - NIST SP 800-53
  - PCI-DSS Requirement 3
- rule_id: oci.database.autonomous_database.cluster_deletion_protection_enabled
  service: database
  resource: autonomous_database
  requirement: Cluster Deletion Protection Enabled
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Deletion Protection is Enabled for Autonomous Database Clusters
  rationale: Enabling deletion protection for Autonomous Database clusters in OCI prevents accidental or malicious deletion of critical database resources. This is essential for maintaining data integrity, ensuring business continuity, and complying with data protection regulations. Without this protection, data loss could lead to operational disruptions and potential legal liabilities.
  description: This rule checks whether deletion protection is enabled for Autonomous Database clusters within OCI. To verify, ensure that the 'Deletion Protection' setting is activated in the database configuration. If not enabled, users can remediate by navigating to the Autonomous Database console, selecting the appropriate cluster, and enabling deletion protection under the database management section. This configuration safeguards against unintended data loss.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/managingAD.htm#deletion_protection
  - https://www.oracle.com/security/cis-benchmarks/
  - https://cloudsecurityalliance.org/artifacts/cis-controls-v7-1/
  - https://www.nist.gov/publications/sp-800-53-revision-5-security-and-privacy-controls
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.autonomous_database.cluster_minor_version_auto_upgrade_enabled
  service: database
  resource: autonomous_database
  requirement: Cluster Minor Version Auto Upgrade Enabled
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Cluster Minor Version Auto Upgrade is Enabled
  rationale: Enabling cluster minor version auto upgrade for Autonomous Databases ensures that databases are automatically updated with the latest security patches and minor enhancements. This reduces the risk of vulnerabilities being exploited and ensures compliance with data protection standards, minimizing potential business impacts from security breaches.
  description: This check verifies that the 'Cluster Minor Version Auto Upgrade' feature is enabled for Autonomous Databases in Oracle Cloud Infrastructure. Enabling this feature means minor version updates are automatically applied, helping maintain security and performance. To remediate, navigate to the Autonomous Database details page in the OCI Console and enable the auto-upgrade option under the 'Database Configuration' section.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbudbconfig.htm
  - https://www.oracle.com/security-alerts/
  - CIS OCI Foundations Benchmark - Section 3.2
  - NIST SP 800-53 - CM-5 Configuration Management
  - ISO/IEC 27001:2013 - A.12.6.1 Management of technical vulnerabilities
- rule_id: oci.virtual_network.security_list.vpn_ike_phase_encryption_strong_enabled
  service: virtual_network
  resource: security_list
  requirement: Vpn Ike Phase Encryption Strong Enabled
  scope: virtual_network.security_list.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Strong Encryption for VPN IKE Phase in Security Lists
  rationale: Strong encryption for VPN IKE Phase is crucial for protecting data in transit from interception and unauthorized access. Weak encryption algorithms can be exploited by attackers, leading to potential data breaches and non-compliance with regulatory standards such as PCI-DSS and HIPAA. Ensuring robust encryption helps maintain data confidentiality and integrity across the network.
  description: This rule checks if the VPN Internet Key Exchange (IKE) Phase is configured with strong encryption algorithms in Oracle Cloud Infrastructure (OCI) security lists. To comply, the VPN configuration should use encryption standards such as AES-256. Remediation involves updating the VPN settings to enforce strong encryption algorithms to secure data during transmission, thus enhancing overall network security and compliance posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/vpn.htm
  - https://www.oracle.com/security-cloud/network-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-77.pdf
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/standard/54534.html
- rule_id: oci.virtual_network.security_list.vpn_pre_shared_keys_rotation_policy_defined_required
  service: virtual_network
  resource: security_list
  requirement: Vpn Pre Shared Keys Rotation Policy Defined Required
  scope: virtual_network.security_list.key_rotation
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure VPN Pre-Shared Keys Rotation Policy is Defined
  rationale: Regular rotation of VPN pre-shared keys is critical to maintaining secure communications within your network. Failure to rotate these keys can lead to prolonged exposure to compromised credentials, increasing the risk of unauthorized access and data breaches. This practice supports compliance with security standards and enhances your organization's overall security posture.
  description: This rule checks if a rotation policy is defined for VPN pre-shared keys within your OCI security lists. Regularly rotating these keys is a best practice to minimize potential security risks associated with long-term use of a single key. To remediate, define and implement a key rotation policy that specifies the frequency and process for updating these keys. This can typically be managed through OCI's key management services and relevant network configurations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - CIS OCI Benchmark
  - NIST SP 800-57 Part 1
  - PCI DSS Requirement 3.6
  - ISO/IEC 27001:2013 - A.12.3 Cryptographic Controls
- rule_id: oci.virtual_network.ip_sec_connection.vpn_tunnel_health_monitoring_enabled
  service: virtual_network
  resource: ip_sec_connection
  requirement: Vpn Tunnel Health Monitoring Enabled
  scope: virtual_network.ip_sec_connection.monitoring
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure VPN Tunnel Health Monitoring is Enabled for IPSec Connections
  rationale: Enabling VPN tunnel health monitoring is crucial to ensure the continuous availability and performance of your network connections. Without it, any issues affecting the VPN tunnel may go undetected, potentially leading to network downtime, data loss, or security vulnerabilities. This is important for maintaining the integrity and availability of data transmissions across your cloud infrastructure.
  description: This rule verifies that VPN tunnel health monitoring is enabled for all IPSec connections within your OCI environment. Health monitoring allows you to observe the status and performance of your VPN tunnels, helping to quickly identify and address any issues. To remediate, ensure that health monitoring is configured and enabled for each IPSec connection in the OCI console under Networking > Site-to-Site VPN and by setting the appropriate configuration parameters.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Reference/networkref.htm#VPN
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/securityoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://cloudsecurityalliance.org/star/registry/oracle/
- rule_id: oci.file_storage.file_system.lifecycle_expiration_rules_defined_required
  service: file_storage
  resource: file_system
  requirement: Lifecycle Expiration Rules Defined Required
  scope: file_storage.file_system.lifecycle_management
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure File Storage Systems Have Defined Lifecycle Expiration Rules
  rationale: Defining lifecycle expiration rules for file storage systems in OCI helps manage storage costs by automatically deleting obsolete or temporary data. It enhances security by minimizing the retention of sensitive data that is no longer needed, reducing exposure to unauthorized access. This practice also ensures compliance with data management policies and regulatory requirements.
  description: This rule checks whether lifecycle expiration rules are defined for file storage systems in OCI. These rules automate the deletion of files after a specified period, ensuring efficient storage management and compliance with organizational data retention policies. To verify, review the lifecycle policies set for each OCI File Storage system. Remediation involves creating or updating lifecycle rules within the OCI console to specify the expiration timelines for files.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Concepts/filestorageoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/File/Tasks/creatingfilesystem.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-144.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.file_storage.file_system.lifecycle_immutable_retention_locked_where_required
  service: file_storage
  resource: file_system
  requirement: Lifecycle Immutable Retention Locked Where Required
  scope: file_storage.file_system.lifecycle_management
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure File System Immutable Retention Lock is Enabled
  rationale: Enabling immutable retention lock on file systems prevents deletion or alteration of important data during the retention period, which is critical for data integrity and compliance with regulations such as GDPR and HIPAA. This helps mitigate risks associated with accidental or malicious data alteration.
  description: This rule verifies that file systems in Oracle Cloud Infrastructure's File Storage service have immutable retention lock enabled where required. An immutable retention lock ensures that data cannot be altered or deleted for a specified period, providing a safeguard against data tampering. To remediate, configure the retention lock policy in the OCI console by navigating to the File Storage service, selecting the file system, and setting the retention lock as needed.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Tasks/managingfilesystems.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services/
  - https://www.oracle.com/security/cloud-security/oci-best-practices/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.file_storage.file_system.lifecycle_versioning_enabled
  service: file_storage
  resource: file_system
  requirement: Lifecycle Versioning Enabled
  scope: file_storage.file_system.versioning
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure Lifecycle Versioning is Enabled for OCI File Systems
  rationale: Enabling lifecycle versioning for file systems in OCI helps protect against accidental deletion or modification of files by retaining historical versions. This enhances data protection, supports compliance requirements, and reduces the risk of data loss or corruption, which is crucial for business continuity and recovery.
  description: This rule verifies that lifecycle versioning is enabled for Oracle Cloud Infrastructure file systems. Lifecycle versioning allows you to automatically manage the lifecycle of your file system's data by creating and retaining versions. To remediate, configure lifecycle policies for file systems in the OCI console to ensure versioning is enabled, which helps in maintaining previous states of data for recovery and compliance purposes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Tasks/managingfilesystems.htm#lifecycle
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.database.autonomous_database.testing_execution_roles_least_privilege_required
  service: database
  resource: autonomous_database
  requirement: Testing Execution Roles Least Privilege Required
  scope: database.autonomous_database.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Autonomous Database Testing Roles Follow Least Privilege Principle
  rationale: The principle of least privilege is crucial for minimizing security risks by ensuring that database roles have only the permissions necessary to perform their functions. Over-permissioned roles can lead to unauthorized access or data breaches, impacting business operations and possibly violating compliance standards like PCI-DSS and SOC2.
  description: This rule checks that roles used for testing in Oracle Autonomous Databases are configured with the least privilege necessary to execute their tasks. It involves verifying role permissions and removing any superfluous access rights. Remediation includes auditing roles, adjusting permissions to align with the least privilege model, and regularly reviewing role assignments to ensure continued compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - https://www.oracle.com/security-best-practices/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.autonomous_database.testing_logs_enabled
  service: database
  resource: autonomous_database
  requirement: Testing Logs Enabled
  scope: database.autonomous_database.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Testing Logs are Enabled for Autonomous Databases
  rationale: Enabling testing logs for Autonomous Databases in OCI is crucial for capturing detailed information about SQL execution and application behavior. This helps in diagnosing performance issues, auditing access and usage patterns, and ensuring compliance with data security policies. Neglecting to enable these logs may lead to undetected anomalies or unauthorized access, posing security and operational risks.
  description: This rule checks whether testing logs are enabled for Autonomous Databases within OCI. Testing logs provide visibility into database operations by recording SQL execution details and user activities. Administrators should configure these logs through the Oracle Cloud Infrastructure Console or API to ensure continuous monitoring and quick resolution of issues. Remediation involves enabling the 'SQL Logging' feature in the Autonomous Database configuration settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbdatabaseconfig.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmark/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/standard/54534.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
- rule_id: oci.database.autonomous_database.testing_results_storage_encrypted_and_private
  service: database
  resource: autonomous_database
  requirement: Testing Results Storage Encrypted And Private
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Testing Results are Encrypted and Private
  rationale: Encryption and privacy are critical for protecting sensitive data in transit and at rest. Lack of proper encryption and access controls can lead to unauthorized access, data breaches, and non-compliance with regulatory standards such as GDPR, PCI-DSS, and HIPAA, potentially resulting in financial loss and reputational damage.
  description: This rule verifies that all testing results stored in an Oracle Autonomous Database are encrypted and access is restricted to authorized users only. The check evaluates the database settings to confirm that encryption is enabled and that network security groups or access control lists are configured to prevent unauthorized access. Remediation involves enabling Transparent Data Encryption (TDE) and reviewing security group settings to ensure data is private.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.oracle.com/security/cloud-security/database-security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.oracle.com/a/ocom/docs/cloud/cis-oracle-cloud-infrastructure-foundations-benchmark.pdf
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.database.db_system.recovery_instance_private_network_only_enforced
  service: database
  resource: db_system
  requirement: Recovery Instance Private Network Only Enforced
  scope: database.db_system.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Recovery Instances Are Restricted to Private Networks
  rationale: Ensuring that recovery instances are only accessible via private networks reduces the risk of unauthorized access and potential data breaches. This is crucial for protecting sensitive data and maintaining compliance with security standards and regulations, such as PCI-DSS and ISO 27001, which mandate strict access controls.
  description: This rule checks that all database recovery instances are configured to use private IP addresses, ensuring that they are not exposed to the public internet. To verify, review the network configuration of each database recovery instance and confirm that only private IP addresses are assigned. Remediation involves reconfiguring any instance with public IP exposure to use a private network or VCN (Virtual Cloud Network) with a security list or network security group that restricts access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.db_system.recovery_instance_security_groups_restrictive
  service: database
  resource: db_system
  requirement: Recovery Instance Security Groups Restrictive
  scope: database.db_system.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Recovery Instance Security Groups are Restrictive
  rationale: Restricting security groups for recovery instances minimizes the potential attack surface and reduces the risk of unauthorized access. Open or overly permissive security groups can lead to data breaches or unauthorized data manipulation, impacting business continuity and compliance with regulations such as PCI-DSS and ISO 27001.
  description: This check verifies that the security groups associated with Oracle Cloud Infrastructure (OCI) database recovery instances are configured with restrictive inbound and outbound rules. It ensures that only necessary traffic is permitted, thereby safeguarding the database systems from unauthorized access. To remediate, review and update the security group rules to allow only essential traffic, following the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitygroups.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/oci/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.database.db_system.recovery_instance_volumes_encrypted
  service: database
  resource: db_system
  requirement: Recovery Instance Volumes Encrypted
  scope: database.db_system.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Encryption of Recovery Volumes for Database Systems
  rationale: Encrypting recovery instance volumes is crucial to protect sensitive data from unauthorized access and breaches, especially during disaster recovery scenarios. This measure aligns with compliance requirements such as PCI-DSS and ISO 27001, helping to mitigate risks associated with data leaks and ensuring data privacy.
  description: This rule checks if the recovery instance volumes associated with Oracle Cloud Infrastructure database systems are encrypted. Encryption should be enabled to safeguard data integrity and confidentiality. To remediate an unencrypted volume, enable encryption by configuring your database system's recovery volumes with Oracle-provided encryption features. This ensures that all data at rest is encrypted using strong cryptographic algorithms.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-security/cspm/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.autonomous_database.runbook_access_rbac_least_privilege_required
  service: database
  resource: autonomous_database
  requirement: Runbook Access RBAC Least Privilege Required
  scope: database.autonomous_database.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Autonomous Database Runbook Access
  rationale: Implementing least privilege access is crucial to minimize potential security breaches and unauthorized access to sensitive data. This practice reduces the risk of insider threats and complies with regulatory standards by ensuring that users have only the necessary permissions for their role, protecting business-critical data and maintaining compliance with frameworks such as PCI-DSS and NIST.
  description: This rule checks that the IAM policies and roles assigned to users accessing the runbooks for Autonomous Databases adhere to the principle of least privilege. It involves auditing user permissions to ensure that only necessary roles are granted, such as read-only access for monitoring purposes, rather than full administrative privileges. Remediation involves reviewing and adjusting the OCI IAM policies to align with this principle, ensuring users have only the permissions required for their job functions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - CIS OCI Foundations Benchmark
  - NIST SP 800-53
  - PCI-DSS Requirement 7
- rule_id: oci.database.autonomous_database.runbook_change_audit_logging_enabled
  service: database
  resource: autonomous_database
  requirement: Runbook Change Audit Logging Enabled
  scope: database.autonomous_database.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Audit Logging Enabled for Autonomous Databases
  rationale: Enabling audit logging for Autonomous Databases is essential for tracking changes and access to sensitive data, helping to detect unauthorized actions and ensure accountability. It supports compliance with standards such as PCI-DSS and ISO 27001 by providing a record of database activities that can be used in audits and investigations.
  description: This rule checks that audit logging is enabled for Oracle Autonomous Databases in your OCI environment. Enabling audit logging involves configuring the database to record all access and change events, which can be reviewed to detect suspicious activities. To remediate, ensure that all Autonomous Databases have audit logs enabled and are properly configured to retain these logs for the required period according to your organization's compliance requirements.
  references:
  - https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/logging-audit.html
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-92.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.sans.org/reading-room/whitepapers/auditing/database-security-best-practices-32914
- rule_id: oci.database.autonomous_database.runbook_storage_encrypted_and_private
  service: database
  resource: autonomous_database
  requirement: Runbook Storage Encrypted And Private
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Storage is Encrypted and Access is Private
  rationale: Encrypting database storage and ensuring access is private are crucial for protecting sensitive data from unauthorized access and potential breaches. This not only supports compliance with regulations like PCI-DSS, HIPAA, and GDPR, but also strengthens the overall security posture by mitigating risks associated with data exposure and unauthorized data manipulation.
  description: This rule checks that the storage used by Oracle Cloud Infrastructure Autonomous Databases is encrypted using Oracle-managed keys by default and that access to this storage is restricted to authorized users only. Verification involves ensuring that encryption is enabled and network access is appropriately configured to prevent public exposure. Remediation includes enabling encryption if not already active and configuring security lists and network security groups to restrict access to trusted IP addresses or private networks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.database.autonomous_database.dr_source_agent_to_service_tls_required
  service: database
  resource: autonomous_database
  requirement: DR Source Agent To Service TLS Required
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure TLS for DR Source Agent Communication in Autonomous Database
  rationale: Enforcing TLS for data replication between the DR source agent and service is crucial for ensuring data integrity and confidentiality in transit. Without TLS, sensitive data is vulnerable to interception and unauthorized access, potentially leading to data breaches. This measure aligns with compliance requirements such as PCI-DSS and ISO 27001, which mandate secure data transmission.
  description: This rule verifies that the Disaster Recovery source agent communicating with an Autonomous Database uses Transport Layer Security (TLS) to secure data in transit. TLS ensures encryption and integrity of data, protecting it from eavesdropping and tampering. Remediation involves configuring the source agent to enforce TLS connections as per OCI guidelines, ensuring all communications are encrypted.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbdrautomation.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v4/
  - https://www.pcisecuritystandards.org/
- rule_id: oci.database.autonomous_database.dr_source_encryption_cmek_where_supported_enabled
  service: database
  resource: autonomous_database
  requirement: DR Source Encryption Cmek Where Supported Enabled
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable CMEK for DR Source Encryption on Autonomous Databases
  rationale: Enabling customer-managed encryption keys (CMEK) for DR source encryption in Autonomous Databases strengthens data protection by allowing customers to manage their own encryption keys. This reduces reliance on vendor-supplied keys and enhances control over data security, meeting stringent compliance requirements such as GDPR and HIPAA.
  description: This rule verifies that Disaster Recovery (DR) source encryption for Autonomous Databases uses customer-managed encryption keys (CMEK) where supported. To comply, users must configure their Autonomous Databases to use CMEK for encrypting backups and replication data. This involves setting up a Vault and managing keys within OCI, then applying these keys to the Autonomous Database settings. Non-compliance may lead to increased risk of unauthorized access and potential data breaches.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbusingcustomerkey.htm
  - https://www.oracle.com/security/cloud-security/key-management/
  - https://www.oracle.com/a/ocom/docs/oci/cis-oci-benchmark.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57pt1r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.autonomous_database.dr_source_min_telemtry_required_no_pii
  service: database
  resource: autonomous_database
  requirement: DR Source Min Telemtry Required No Pii
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database DR Source Telemetry Excludes PII
  rationale: Excluding Personally Identifiable Information (PII) from telemetry data helps prevent unauthorized exposure of sensitive data, reducing the risk of data breaches and ensuring compliance with privacy regulations such as GDPR and CCPA. This practice safeguards the organization's reputation and minimizes legal liabilities.
  description: This rule checks that the telemetry data collected from the source Autonomous Database for Disaster Recovery (DR) purposes does not include PII. Telemetry should focus on operational metrics and system performance, not user-specific data. Verify configurations to ensure only essential, non-sensitive data is included. Remediate by updating telemetry settings to exclude PII, ensuring compliance with data protection standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.oracle.com/security-cloud/data-privacy.html
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://gdpr.eu/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/privacy-framework
- rule_id: oci.file_storage.file_system.volume_cmk_enabled
  service: file_storage
  resource: file_system
  requirement: Volume CMK Enabled
  scope: file_storage.file_system.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure File Storage Uses Customer Managed Keys for Encryption
  rationale: Enabling Customer Managed Keys (CMKs) for file storage in OCI enhances data security by giving you control over key management and rotation. This reduces the risk of unauthorized access and aligns with compliance requirements for data protection and privacy, such as those outlined by regulations like GDPR and HIPAA.
  description: This rule checks if OCI File Storage is configured to use Customer Managed Keys for encrypting data at rest. Utilizing CMKs provides enhanced security by allowing businesses to manage their own encryption keys, ensuring that data access is strictly controlled and monitored. To remediate, configure your File Storage resources to use CMKs via the OCI Console or CLI, ensuring compliance with security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Tasks/encryptingfilesystems.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.oracle.com/security/cloud-security.html
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.file_storage.file_system.volume_encryption_enabled
  service: file_storage
  resource: file_system
  requirement: Volume Encryption Enabled
  scope: file_storage.file_system.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure File Storage Encryption is Enabled
  rationale: Enabling encryption for file systems in Oracle Cloud Infrastructure ensures that data at rest is protected against unauthorized access and potential data breaches. This is crucial for maintaining data confidentiality and integrity, complying with regulatory requirements such as PCI-DSS, HIPAA, and ISO 27001, and mitigating risks associated with data exposure.
  description: This rule checks if the file systems in Oracle Cloud Infrastructure's File Storage service have encryption enabled. Encryption should be enabled to protect sensitive data at rest using Oracle-managed keys or customer-managed keys. Remediation involves verifying the encryption status of file systems and enabling encryption for any unencrypted volumes through the OCI Console or OCI CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Tasks/filestorageusing.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.file_storage.file_system.volume_snapshots_encrypted
  service: file_storage
  resource: file_system
  requirement: Volume Snapshots Encrypted
  scope: file_storage.file_system.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure File System Snapshots are Encrypted in OCI
  rationale: Encrypting file system snapshots is crucial for protecting sensitive data from unauthorized access and ensuring compliance with industry standards. Unencrypted snapshots can expose sensitive data at rest, increasing the risk of data breaches and non-compliance with regulations such as GDPR, HIPAA, and PCI-DSS.
  description: This rule checks whether the volume snapshots of OCI File Storage service are encrypted using Oracle-managed encryption keys. Encryption should be enabled to secure data at rest and prevent unauthorized access. If snapshots are found to be unencrypted, it is recommended to enable encryption by configuring the file system to use encryption keys managed by Oracle Cloud Infrastructure Key Management service.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Tasks/usingfilesystems.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.file_storage.file_system.snapshot_cross_region_copy_encrypted
  service: file_storage
  resource: file_system
  requirement: Snapshot Cross Region Copy Encrypted
  scope: file_storage.file_system.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure File System Snapshots Copied Across Regions Are Encrypted
  rationale: Encrypting snapshots during cross-region copies is crucial for maintaining data confidentiality and integrity, especially when data traverses different geographical locations. This helps mitigate risks related to unauthorized access and data breaches, ensuring compliance with regulations such as GDPR, HIPAA, and PCI-DSS.
  description: This rule checks if snapshots of file systems in Oracle Cloud Infrastructure are encrypted when copied across regions. To enhance data security, ensure that all cross-region snapshot transfers use encryption. If encryption is not enabled, configure the snapshot settings to use OCI's built-in encryption features, thereby securing data in transit and at rest.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Tasks/usingfilesystems.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.file_storage.file_system.snapshot_encrypted
  service: file_storage
  resource: file_system
  requirement: Snapshot Encrypted
  scope: file_storage.file_system.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure File System Snapshots are Encrypted
  rationale: Encrypting file system snapshots is crucial to protect sensitive data from unauthorized access and ensure data privacy. Unencrypted snapshots can expose your data to potential breaches, leading to financial loss and compliance violations. Implementing encryption aligns with best practices for data protection and privacy requirements.
  description: This rule checks whether snapshots of file systems in Oracle Cloud Infrastructure are encrypted. Encryption at rest ensures that data stored in snapshots is protected using OCI's encryption keys. To remediate, configure file storage snapshots to use encryption by default, leveraging OCI's built-in key management service. Verify the encryption status through the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Tasks/usingfilesystem.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.file_storage.snapshot.snapshot_not_public_blocked
  service: file_storage
  resource: snapshot
  requirement: Snapshot Not Public Blocked
  scope: file_storage.snapshot.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: critical
  title: Ensure OCI File Storage Snapshots Are Not Publicly Accessible
  rationale: Publicly accessible snapshots in Oracle Cloud Infrastructure (OCI) can expose sensitive data, leading to unauthorized access and data breaches. This exposure can violate compliance requirements such as NIST, PCI-DSS, and ISO 27001, and pose significant business and reputational risks.
  description: This rule checks that all file storage snapshots in OCI are not publicly accessible, ensuring they are restricted to authorized users only. By default, snapshots should be private and access-controlled. Remediation involves reviewing snapshot permissions and ensuring that any public access settings are revoked, using OCI policies to enforce access control.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Concepts/filestorageoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/securitypolicies.htm
  - CIS OCI Foundations Benchmark
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-iec-27001-information-security.html
- rule_id: oci.database.autonomous_database.dr_plan_approvals_required_for_changes
  service: database
  resource: autonomous_database
  requirement: DR Plan Approvals Required For Changes
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Require DR Plan Approvals for Autonomous Database Changes
  rationale: Requiring approvals for Disaster Recovery (DR) plan changes helps ensure that any modifications are in accordance with organizational policies and standards, reducing the risk of data loss or service disruption. This is critical for maintaining business continuity and adhering to compliance requirements related to data protection and privacy.
  description: This rule checks whether changes to the Disaster Recovery (DR) plans for Autonomous Databases require formal approvals. It involves verifying that a workflow is in place to enforce this requirement, ensuring that all changes are reviewed and authorized by designated personnel. To remediate, implement a policy that mandates documented approval for any updates to DR plans, and utilize OCI's governance tools to enforce this process.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.oracle.com/security-cloud-compliance/
  - https://www.oracle.com/a/ocom/docs/cloud/cis-oci-benchmark.pdf
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.autonomous_database.dr_plan_change_audit_logging_enabled
  service: database
  resource: autonomous_database
  requirement: DR Plan Change Audit Logging Enabled
  scope: database.autonomous_database.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure DR Plan Change Audit Logging for Autonomous Databases
  rationale: Enabling audit logging for Disaster Recovery (DR) plan changes in Autonomous Databases is crucial for maintaining an accurate record of changes, which aids in compliance with regulatory requirements and enhances security by monitoring unauthorized or unexpected changes. This helps in identifying potential security incidents and supports forensic investigations.
  description: This rule checks whether audit logging is enabled for changes to the Disaster Recovery plans of Autonomous Databases. To verify, ensure that the audit logs capture all DR plan modifications in the Oracle Cloud Infrastructure Logging service, providing a detailed history of changes. Remediation involves configuring audit policies to log these events and regularly reviewing the logs to identify and address any anomalies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.oracle.com/cloud/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.autonomous_database.dr_plan_storage_encrypted_and_private
  service: database
  resource: autonomous_database
  requirement: DR Plan Storage Encrypted And Private
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure DR Plan Storage for Autonomous Databases is Encrypted & Private
  rationale: Ensuring that Disaster Recovery (DR) storage plans for Autonomous Databases are both encrypted and set to private is crucial for data protection. Encryption safeguards sensitive data from unauthorized access, while privacy settings ensure that only authorized entities can access the data, thereby reducing the risk of data breaches and ensuring compliance with data protection regulations such as GDPR and CCPA.
  description: This rule checks whether the storage used for Disaster Recovery plans of Autonomous Databases is encrypted and has restricted access settings. Encryption should be enabled to protect data at rest, and the storage should be configured to be private, limiting access to specific OCI compartments or VCNs. Remediation involves enabling encryption settings and adjusting access controls in the OCI Console to meet these requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm#ADBDR
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/encryptingdata.htm
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hipaajournal.com/hipaa-compliance-checklist/
- rule_id: oci.database.autonomous_database.workflow_approval_steps_required_for_destructive_actions
  service: database
  resource: autonomous_database
  requirement: Workflow Approval Steps Required For Destructive Actions
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Require Workflow Approvals for Destructive Autonomous Database Actions
  rationale: Requiring workflow approval steps for destructive actions on Autonomous Databases helps mitigate risks such as accidental data loss, unauthorized data modifications, and potential security breaches. This process ensures that any deletion or significant modification is reviewed and authorized by appropriate personnel, aligning with compliance requirements and enhancing overall data protection.
  description: This rule checks if workflow approval steps are enforced for destructive actions on Autonomous Databases. Destructive actions may include deletion or modification of databases which can lead to data loss. To remediate, configure policies that mandate multi-level approvals for such actions in the OCI Console or through API configurations. This ensures only authorized and verified actions are executed, safeguarding data integrity.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-1-0-0-benchmark.htm
  - https://www.nist.gov/document-22337
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
- rule_id: oci.database.autonomous_database.workflow_integrations_least_privilege_required
  service: database
  resource: autonomous_database
  requirement: Workflow Integrations Least Privilege Required
  scope: database.autonomous_database.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Autonomous Database Workflow Integrations
  rationale: Applying the principle of least privilege to workflow integrations in Autonomous Databases minimizes potential security vulnerabilities by restricting access to essential permissions only. This reduces the risk of unauthorized data access or manipulation, ensuring compliance with security standards like ISO 27001 and protecting sensitive information from potential breaches.
  description: This rule verifies that all integrations with Autonomous Databases are configured with the minimum necessary permissions. It checks IAM policies to ensure that roles assigned to workflows do not exceed the required access levels for their functionality. Remediation involves reviewing and adjusting IAM policies to align with least privilege principles, ensuring roles have only the permissions essential for their specific tasks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/access/managingpolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.oracle.com/security/cloud-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- rule_id: oci.database.autonomous_database.workflow_kms_encryption_enabled
  service: database
  resource: autonomous_database
  requirement: Workflow KMS Encryption Enabled
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure KMS Encryption is Enabled for Autonomous Databases
  rationale: Enabling KMS encryption for Autonomous Databases ensures that sensitive data is protected at rest using strong encryption standards. This reduces the risk of unauthorized data access and helps meet compliance requirements such as PCI-DSS, HIPAA, and GDPR. Failing to encrypt data adequately can expose sensitive information, leading to potential financial loss and reputational damage.
  description: This rule checks whether Autonomous Databases have Oracle Key Management Service (KMS) encryption enabled. KMS encryption utilizes Oracle-managed keys to protect data at rest, ensuring that encryption keys are stored and managed securely. To remediate, configure the Autonomous Database to use KMS by associating it with a vault and a key within Oracle Cloud Infrastructure. This can be done via the OCI Console or API by navigating to the database settings and selecting the appropriate KMS configuration.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://cloudsecurityalliance.org/star/registry/oracle-cloud-infrastructure/
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
- rule_id: oci.functions.application.prov_conc_execution_role_least_privilege_required
  service: functions
  resource: application
  requirement: Prov Conc Execution Role Least Privilege Required
  scope: functions.application.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Functions Application Execution Role Uses Least Privilege
  rationale: Using least privilege for execution roles in Oracle Cloud Infrastructure helps minimize potential security risks by limiting access to the minimum permissions needed. This reduces the attack surface, lowers the chance of accidental or malicious misuse, and helps ensure compliance with industry standards like NIST, PCI-DSS, and ISO 27001.
  description: This rule checks if the execution role associated with OCI Functions applications is configured with the least privilege principle. It verifies that the role only has the permissions necessary to execute the functions without any additional access rights. Remediation involves reviewing the role's permissions and adjusting them to ensure they only allow necessary actions, such as invoking functions or accessing specific resources as required by the application.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/functions/Concepts/functionsoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.functions.application.automation_change_audit_logging_enabled
  service: functions
  resource: application
  requirement: Automation Change Audit Logging Enabled
  scope: functions.application.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Automation Change Audit Logging is Enabled for Functions
  rationale: Enabling change audit logging for OCI Functions applications is critical for tracking modifications and identifying unauthorized changes. This practice enhances security posture by providing a clear audit trail, aiding in compliance with regulations such as PCI-DSS and SOC 2, and mitigating potential security risks by ensuring transparency and accountability.
  description: This rule verifies that automation change audit logging is enabled for OCI Functions applications. To ensure compliance, check that the logging service is configured to capture changes in function configurations and deployments. Remediation involves accessing the OCI Console, navigating to the Functions service, and ensuring that audit logs are enabled for relevant applications. This setup helps in monitoring changes and maintaining a secure environment.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Concepts/functionsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmark/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
- rule_id: oci.functions.application.automation_remediation_roles_least_privilege_required
  service: functions
  resource: application
  requirement: Automation Remediation Roles Least Privilege Required
  scope: functions.application.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for OCI Functions Automation Remediation Roles
  rationale: Implementing least privilege for automation remediation roles in OCI Functions is crucial to minimize security risks by limiting access to only what is necessary. This reduces the attack surface, prevents unauthorized access, and aligns with compliance requirements such as NIST and ISO 27001, thereby protecting sensitive functions and data from potential breaches.
  description: This check ensures that OCI Functions applications use automation remediation roles configured with the least privilege principle. It verifies that roles assigned to automate remediation tasks have only the permissions necessary to perform their functions without excessive access. Remediation involves reviewing current roles and permissions, removing any superfluous permissions, and strictly aligning them with the specific automation tasks required.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_benchmark.htm
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.functions.application.version_published_and_immutable_required
  service: functions
  resource: application
  requirement: Version Published And Immutable Required
  scope: functions.application.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure OCI Function Applications are Versioned and Immutable
  rationale: Enforcing versioning and immutability on OCI function applications helps maintain consistency and integrity of function deployments. It minimizes the risk of unauthorized or accidental changes that could lead to service disruptions, security vulnerabilities, or compliance violations. This practice is essential for maintaining audit trails and ensuring reliable rollbacks in case of deployment failures.
  description: This check verifies that all OCI function applications have their versions published and marked as immutable. An application version should be explicitly set and not subject to modification once deployed, ensuring that changes are intentional and tracked. Remediation involves configuring the function application to specify and lock its version upon publishing, preventing further edits. This can be managed via the OCI Console or CLI by setting the 'isImmutable' flag.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionsmanagingapplications.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://cloudsecurityalliance.org/artifacts/cloud-controls-matrix-v4/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.nist.gov/document/nist-sp-800-53-revision-5
- rule_id: oci.functions.application.version_rollforward_rollback_controls_present_required
  service: functions
  resource: application
  requirement: Version Rollforward Rollback Controls Present Required
  scope: functions.application.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure OCI Functions Application Version Control Mechanisms are Established
  rationale: Having version rollforward and rollback controls in place for OCI Functions applications is crucial for maintaining application stability and security. These controls allow for quick recovery from failed deployments and minimize downtime, reducing the risk of business disruption and potential security vulnerabilities caused by unstable or untested application versions.
  description: This rule checks if version management controls, such as rollforward and rollback mechanisms, are established for OCI Functions applications. To verify, ensure that your deployment process includes automated scripts or configurations to move between application versions. Remediation involves implementing CI/CD pipelines that support version control and rollback capabilities, ensuring that any deployment can be reverted if an issue arises.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionscreatingyourfunction.htm
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Concepts/functionsoverview.htm
  - 'NIST SP 800-190: Application Container Security Guide'
  - ISO/IEC 27001:2013 - A.12.1.2 Change Management
  - CIS OCI Foundations Benchmark
- rule_id: oci.data_integration.workspace.replication_auth_roles_least_privilege_required
  service: data_integration
  resource: workspace
  requirement: Replication Auth Roles Least Privilege Required
  scope: data_integration.workspace.replication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Data Integration Replication Auth Roles
  rationale: Ensuring that replication authorization roles in OCI Data Integration workspaces adhere to the principle of least privilege is critical for minimizing potential security risks. Excessive permissions can lead to unauthorized data access, manipulation, and potential breaches, impacting business integrity and compliance with standards such as PCI-DSS and ISO 27001.
  description: This rule checks whether the authorization roles used for replication in OCI Data Integration workspaces are configured with the minimum necessary privileges. It verifies that these roles do not possess permissions beyond what is required for their intended function. If excessive permissions are detected, it is necessary to review and modify the role assignments to adhere to least privilege principles, reducing the risk of unauthorized access and enhancing security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/data_integration_security.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/identitypolicies.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.data_integration.workspace.replication_cross_region_encrypted
  service: data_integration
  resource: workspace
  requirement: Replication Cross Region Encrypted
  scope: data_integration.workspace.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Cross-Region Workspace Replication is Encrypted
  rationale: Encrypting data during cross-region replication is crucial to protect sensitive information from unauthorized access during transit. This practice mitigates potential security risks and helps maintain compliance with data protection regulations such as GDPR and HIPAA. Unencrypted data transfers can lead to data breaches and financial penalties.
  description: This rule verifies that all data integrations involving cross-region workspace replication are encrypted. The encryption ensures that data is securely transmitted across regions, protecting it from interception and unauthorized access. To comply, enable encryption on all OCI Data Integration workspaces configured for cross-region replication. Administrators should verify encryption settings in the OCI console and apply necessary configurations to enforce encryption.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/dataintegrationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.oracle.com/a/ocom/docs/oci-security-architecture.pdf
  - https://www.cisecurity.org/benchmark/oracle_cloud/
- rule_id: oci.data_integration.workspace.replication_tls_required
  service: data_integration
  resource: workspace
  requirement: Replication TLS Required
  scope: data_integration.workspace.replication
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure TLS is Enabled for OCI Data Integration Workspace Replication
  rationale: Enforcing TLS encryption for data replication in OCI Data Integration workspaces is crucial to safeguard data in transit, preventing unauthorized access and data breaches. It aligns with compliance requirements such as PCI-DSS and ISO 27001, which mandate secure data transmission to protect sensitive information.
  description: This rule verifies that TLS encryption is enabled for replication activities within OCI Data Integration workspaces. Without TLS, data replication traffic could be intercepted or altered by malicious actors. To remediate, configure the workspace settings to enforce TLS during data replication processes, ensuring encrypted communication between services.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/data-integration.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practice.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-52r1.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.data_integration.workspace.replication_lag_monitoring_alerts_enabled
  service: data_integration
  resource: workspace
  requirement: Replication Lag Monitoring Alerts Enabled
  scope: data_integration.workspace.monitoring
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Replication Lag Monitoring Alerts are Enabled for OCI Workspaces
  rationale: Enabling replication lag monitoring alerts is crucial in identifying and addressing data synchronization issues promptly. Failure to monitor replication lag can lead to data discrepancies and impact the integrity and availability of data, which may result in business disruptions and non-compliance with data governance policies.
  description: This rule checks if replication lag monitoring alerts are enabled for OCI Data Integration workspaces. By ensuring these alerts are active, administrators can receive timely notifications about potential delays in data replication, allowing for swift remediation actions. To enable this feature, configure the alerts in the OCI console under the Monitoring section for your Data Integration workspace, ensuring that the alert rules are set to trigger based on specific lag thresholds.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/dataintegrationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/CloudAdvisor/Reference/best-practices-data-integration.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.identity.group.rbac_group_attached_policies_not_admin_star_restricted
  service: identity
  resource: group
  requirement: RBAC Group Attached Policies Not Admin Star Restricted
  scope: identity.group.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict RBAC Group Policies from Using Unrestricted Admin Access
  rationale: Ensuring RBAC group policies do not use overly permissive 'admin *' permissions is crucial for maintaining the principle of least privilege in OCI. Overly broad permissions can lead to unauthorized access, data breaches, and non-compliance with security standards like ISO 27001 and NIST. Limiting permissions reduces the risk of accidental or malicious actions that could compromise the integrity and confidentiality of your cloud resources.
  description: This rule checks if any RBAC group in OCI has attached policies that use unrestricted 'admin *' permissions. Such permissions can grant full access to all resources, which poses a significant security risk. Verification involves reviewing group policies to ensure they specify only necessary actions on required resources. Remediation includes modifying these policies to adhere to least privilege principles, specifying explicit permissions for specific actions and resources.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/ocisecuritybestpractices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.group.rbac_group_external_sharing_restricted_where_supported_restricted
  service: identity
  resource: group
  requirement: RBAC Group External Sharing Restricted Where Supported Restricted
  scope: identity.group.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict External Sharing of RBAC Groups in OCI Identity
  rationale: Restricting external sharing of RBAC groups is crucial to prevent unauthorized access to sensitive resources, mitigate potential data breaches, and comply with security frameworks such as ISO 27001 and SOC2. Ensuring only internal entities can be shared with enhances the security posture by limiting the exposure of privileged configurations to external threats.
  description: This rule checks if RBAC groups within OCI Identity are configured to restrict external sharing where this feature is supported. It ensures that group memberships, permissions, and policies are not inadvertently exposed to external entities. Remediation involves auditing current RBAC group settings, and configuring them to limit access to internal users or services only. This may involve updating identity policies and reviewing shared resources for compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/identitypolicies.htm
  - https://www.oracle.com/security-cloud/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.group.rbac_group_no_inline_policies_restricted
  service: identity
  resource: group
  requirement: RBAC Group No Inline Policies Restricted
  scope: identity.group.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure No Inline Policies in OCI Identity Groups
  rationale: Inline policies directly attached to identity groups can lead to complex policy management and increase the risk of misconfigurations. By restricting the use of inline policies, you ensure that all permissions are managed through centralized policy resources, enhancing consistency and auditability, and reducing the potential for unauthorized access.
  description: This rule checks that no inline policies are attached directly to Oracle Cloud Infrastructure (OCI) identity groups. Inline policies should be avoided to maintain a clear separation of concerns and allow for easier auditing and management. If inline policies are found, consider migrating them to managed policies which are attached to groups, users, or compartments, offering better control and visibility over permissions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managinggroups.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmark/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.identity.policy.rbac_policy_conditions_used_where_applicable_restricted
  service: identity
  resource: policy
  requirement: RBAC Policy Conditions Used Where Applicable Restricted
  scope: identity.policy.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure RBAC Policy Conditions Are Applied and Restricted Appropriately
  rationale: Implementing RBAC policy conditions restricts access to resources based on specific attributes, reducing the risk of unauthorized access. This enhances security by ensuring that users or groups are granted the least privilege necessary, which is crucial for protecting sensitive data and maintaining compliance with security standards.
  description: This check verifies that Oracle Cloud Infrastructure identity policies utilize conditions to restrict access where applicable. Policies should incorporate conditions such as time-based access or network location to enhance security. To remediate, review existing policies and update them to include relevant conditions, thereby limiting access based on specific attributes. This helps in minimizing exposure and ensuring that access is granted only under appropriate circumstances.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/iam_best_practices.htm
  - CIS OCI Benchmark - Identity and Access Management
  - 'NIST SP 800-53: Access Control'
  - 'ISO 27001:2013 - Annex A.9.1.2: Access Control Policy'
  - 'PCI-DSS Requirement 7: Restrict access to cardholder data by business need to know'
- rule_id: oci.identity.policy.rbac_policy_no_action_star_on_resource_restricted
  service: identity
  resource: policy
  requirement: RBAC Policy No Action Star On Resource Restricted
  scope: identity.policy.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Avoid Wildcard Actions in OCI RBAC Policies on Critical Resources
  rationale: Using wildcard ('*') actions in RBAC policies can lead to excessive permissions that may result in unauthorized access or accidental resource modifications. This poses significant security risks, including potential data breaches and non-compliance with industry standards such as ISO 27001 and NIST. Restricting actions to only what is necessary supports the principle of least privilege and enhances security posture.
  description: This rule checks if any OCI Identity policies use wildcard ('*') actions on critical resources, which could grant excessive permissions. It identifies policies that should be reviewed and modified to specify only the required actions. To remediate, update the policy to replace wildcard actions with specific action permissions, thereby reducing the risk of unintended access and aligning with security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-security/casb.html
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.policy.rbac_policy_no_allows_without_constraints_restricted
  service: identity
  resource: policy
  requirement: RBAC Policy No Allows Without Constraints Restricted
  scope: identity.policy.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure RBAC Policies Have Specific Constraints in OCI
  rationale: Allowing broad permissions without constraints can lead to unauthorized access and potential data breaches. It is crucial for maintaining the principle of least privilege, minimizing risk exposure and ensuring compliance with security standards such as NIST, PCI-DSS, and ISO 27001.
  description: This rule checks for identity policies in OCI that have 'Allow' statements without specific constraints, such as conditions or resource-level granularity. Unconstrained 'Allow' statements can unintentionally grant excessive permissions across the OCI environment. To remediate, review and update policies to include specific actions, resources, and conditions to ensure they adhere to the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmark/
  - https://www.nist.gov/publications/nist-special-publication-800-53-revision-5
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.identity.policy.rbac_policy_resource_constraints_present_restricted
  service: identity
  resource: policy
  requirement: RBAC Policy Resource Constraints Present Restricted
  scope: identity.policy.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure RBAC Policies Include Resource Constraints
  rationale: Resource constraints in RBAC policies limit the scope of actions to specific resources, reducing the risk of unauthorized access and minimizing the potential blast radius of compromised credentials. This enhances security posture by enforcing the principle of least privilege and aids in compliance with regulations that require stringent access controls.
  description: This rule checks for the presence of resource constraints within RBAC policies in Oracle Cloud Infrastructure. Policies without resource constraints may allow broader access than intended, increasing security risks. To remediate, review and modify policies to include specific resource constraints, ensuring that permissions are granted only to the necessary resources. Verification involves auditing existing policies to identify those lacking constraints and updating them accordingly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v4/
- rule_id: oci.identity.policy.policy_editors_rbac_least_privilege_required
  service: identity
  resource: policy
  requirement: Policy Editors RBAC Least Privilege Required
  scope: identity.policy.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Policy Editors Have Least Privilege Access in OCI
  rationale: Enforcing least privilege for policy editors in OCI is crucial to minimize the risk of unauthorized access and potential data breaches. Without proper restrictions, policy editors could inadvertently or maliciously alter critical permissions, leading to service disruptions or compliance violations. Ensuring least privilege aligns with security best practices and helps maintain a robust security posture.
  description: This rule checks if users with permissions to edit OCI Identity Policies have been granted only the necessary privileges to perform their tasks. It verifies that policy editor roles do not include excessive permissions that could lead to privilege escalation. To remediate, review and adjust policies to restrict permissions appropriately, ensuring they align with the principle of least privilege while enabling necessary access for policy management.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://oracle.github.io/oci-best-practices/identity/policies/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.nist.gov/publications/least-privilege-security-concept
  - https://www.pcisecuritystandards.org/pci_security/maintaining-payment-security
- rule_id: oci.identity.policy.policy_no_wildcard_admin_actions
  service: identity
  resource: policy
  requirement: Policy No Wildcard Admin Actions
  scope: identity.policy.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Enforce Specific Actions in OCI Policies Without Wildcards
  rationale: Using wildcard actions in OCI policies, especially for administrative privileges, can lead to unintentional access and potential security breaches. This increases the risk of unauthorized actions being performed, which can have serious business impacts including data loss, compliance violations, and exposure to malicious activities. It is crucial to define explicit actions to adhere to the principle of least privilege.
  description: This rule checks OCI Identity policies to ensure that no administrative actions are granted using wildcards, which can inadvertently provide broader access than intended. Policies should list specific actions rather than using wildcards to prevent over-permissive access. Remediation involves reviewing and updating policies to replace wildcard actions with explicit ones that reflect the necessary permissions required for the role.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_benchmark.htm
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/index.html
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.identity.policy.policy_versioning_and_change_audit_enabled
  service: identity
  resource: policy
  requirement: Policy Versioning And Change Audit Enabled
  scope: identity.policy.audit_logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Policy Versioning and Change Audit are Enabled
  rationale: Enabling policy versioning and change audit in OCI is crucial for maintaining robust security and compliance. It allows organizations to track changes, ensuring transparency and accountability. This helps in preventing unauthorized modifications and aids in forensic investigations and compliance with standards such as NIST and ISO 27001.
  description: This rule checks whether versioning and change auditing are enabled for IAM policies in OCI. Versioning allows tracking of changes over time, while auditing logs the who, what, and when of policy changes. To remediate, ensure that logging is enabled in the OCI Audit service and that policies are correctly configured to support versioning. Verify this by reviewing policy settings in the OCI Console, and enabling audit logs under the Audit service.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.oidc_allowed_client_ids_audiences_restricted_restricted
  service: identity
  resource: user
  requirement: Oidc Allowed Client Ids Audiences Restricted Restricted
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict OIDC Allowed Client IDs and Audiences for Enhanced Security
  rationale: Restricting OpenID Connect (OIDC) allowed client IDs and audiences is crucial to prevent unauthorized access and reduce the risk of token misuse. By ensuring that only specific, trusted clients and audiences are permitted, organizations can mitigate potential security threats and maintain compliance with industry standards and regulations.
  description: This rule checks if the OIDC allowed client IDs and audiences in the OCI identity configuration are restricted to a defined set of trusted entities. It ensures that only authorized applications can access sensitive resources. To remediate, review and update the OIDC configuration to specify allowed client IDs and audiences, aligning with your organization's security policies. Regular audits and monitoring are recommended to maintain this configuration.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/token-based-authentication.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - CIS OCI Foundations Benchmark
  - 'NIST SP 800-63B: Digital Identity Guidelines'
  - 'PCI DSS Requirement 8: Identify and authenticate access to system components'
  - OCI Security Best Practices Guide
- rule_id: oci.identity.user.oidc_issuer_https_and_matches_discovery_restricted
  service: identity
  resource: user
  requirement: Oidc Issuer HTTPS And Matches Discovery Restricted
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure OIDC Issuer Uses HTTPS and Matches Discovery Document
  rationale: Securing OIDC issuer endpoints with HTTPS ensures data encryption in transit, protecting sensitive authentication information from interception. Verifying that the issuer matches the discovery document prevents unauthorized or misconfigured issuers from compromising identity security, aligning with compliance requirements for data protection and secure authentication processes.
  description: This rule checks if the OpenID Connect (OIDC) issuer URL configured for OCI users utilizes HTTPS, ensuring encrypted communication. It also verifies that the issuer URL matches the OpenID discovery document, preventing misconfigurations or unauthorized access. Remediation involves updating the OIDC issuer URL to use HTTPS and ensuring it aligns with the discovery document provided by the identity provider.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63-3.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://cloudsecurityalliance.org/research/guidance-documents/guidelines-on-identity-and-access-management
- rule_id: oci.identity.user.oidc_thumbprints_or_jwks_pinning_configured_restricted
  service: identity
  resource: user
  requirement: Oidc Thumbprints Or Jwks Pinning Configured Restricted
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure OIDC Thumbprints or JWKS Pinning are Configured for Users
  rationale: Configuring OIDC thumbprints or JWKS pinning helps ensure that only trusted identity providers are used for authentication, reducing the risk of man-in-the-middle attacks. This enhances the security of the authentication process and supports compliance with frameworks like NIST and ISO 27001 by ensuring secure identity management practices.
  description: This rule verifies that Oracle Cloud Infrastructure (OCI) users have properly configured OIDC thumbprints or JWKS pinning. It checks whether these configurations are restricted to trusted identity providers, ensuring that user authentication is secure. To remediate, ensure that the thumbprints or JWKS URIs of trusted OIDC providers are specified in the OCI Identity Console under the user's configuration settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/identitysecurity.htm
  - https://www.oracle.com/security-cloud/cis-oci-benchmark-v1-0.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63-3.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.identity.user.oidc_token_lifetime_reasonable_restricted
  service: identity
  resource: user
  requirement: Oidc Token Lifetime Reasonable Restricted
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict OIDC Token Lifetime for Enhanced Security
  rationale: Restricting the lifetime of OIDC tokens is crucial to minimize the risk of unauthorized access in case a token is leaked or compromised. Shorter token lifetimes reduce the window of opportunity for malicious actors, thereby enhancing the overall security posture and helping meet compliance requirements such as NIST and ISO 27001.
  description: This rule checks that the lifetime of OIDC tokens issued to OCI users is set to a reasonable limit, typically not exceeding one hour. This involves configuring policies and settings within the OCI Identity and Access Management service to ensure tokens expire quickly after issuance, thereby mitigating potential misuse. Remediation involves adjusting the token lifetime settings in the OCI console or via OCI CLI to adhere to best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-63b/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.cisecurity.org/benchmark/oracle/
- rule_id: oci.identity.user.saml_assertion_lifetime_reasonable_restricted
  service: identity
  resource: user
  requirement: Saml Assertion Lifetime Reasonable Restricted
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure SAML Assertion Lifetime is Reasonably Restricted
  rationale: Limiting the lifetime of SAML assertions is crucial to minimize the risk of token misuse or replay attacks. Shorter assertion lifetimes reduce the window of opportunity for unauthorized access if an assertion is intercepted, thus enhancing overall security posture and compliance with best practices and standards such as ISO 27001 and NIST.
  description: This rule checks whether the lifetime of SAML assertions for OCI Identity users is configured to be within a reasonable limit, ideally less than or equal to 5 minutes. This ensures that the assertion validity period is short enough to reduce the risk of token replay attacks. To remediate, configure the identity provider settings to enforce a shorter assertion lifetime. This can typically be adjusted in the SAML identity provider settings within the OCI Identity Console.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingfed.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practice.htm#Assertion_Lifetime
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.nist.gov/document-159
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.saml_audience_restriction_configured_restricted
  service: identity
  resource: user
  requirement: Saml Audience Restriction Configured Restricted
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure SAML Audience Restriction is Configured for Identity Users
  rationale: Configuring SAML Audience Restriction ensures that assertions are only consumed by intended services, reducing the risk of token misuse or interception. This setup is essential for maintaining secure communication between identity providers and OCI, preventing unauthorized access and potential data breaches.
  description: This rule checks if the SAML Audience Restriction is configured for users in OCI Identity. The presence of this configuration ensures that SAML tokens are validated against specific audience values, enhancing security by ensuring tokens are only accepted by designated services. To remediate, configure audience restriction settings within your identity provider to match expected values in OCI, ensuring they align with your security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingfederation.htm
  - CIS OCI Benchmark v1.1.0, Section 1.6
  - 'NIST SP 800-63C: Federation and Assertions'
  - PCI-DSS v3.2.1, Requirement 8.1
  - ISO/IEC 27001:2013, Annex A.9.1.2
- rule_id: oci.identity.user.saml_certificates_not_expired_restricted
  service: identity
  resource: user
  requirement: Saml Certificates Not Expired Restricted
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure SAML Certificates Are Valid and Not Expired
  rationale: Expired SAML certificates can lead to authentication failures, resulting in potential unauthorized access or service disruptions. Ensuring certificates are valid is crucial for maintaining secure federated authentication processes, compliance with security policies, and minimizing business risk.
  description: This rule checks if SAML certificates associated with OCI IAM users are valid and not expired. Expired certificates can disrupt single sign-on (SSO) functionality and compromise access controls. Remediate any issues by regularly validating certificate expiry dates and renewing them before expiration to maintain seamless authentication processes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/identityandaccessmanagement.htm
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.identity.user.saml_idp_metadata_signed_restricted
  service: identity
  resource: user
  requirement: Saml Idp Metadata Signed Restricted
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure SAML IdP Metadata is Signed and Restricted in OCI
  rationale: Restricting and verifying the signature of SAML IdP metadata is crucial to prevent unauthorized access and ensure the integrity of authentication processes. Unsigned or improperly restricted metadata can lead to security vulnerabilities, allowing potential attackers to impersonate users and access sensitive resources, thus impacting your organizationâ€™s data security and compliance posture.
  description: This rule checks whether the SAML Identity Provider (IdP) metadata configured in OCI Identity is signed and access to it is appropriately restricted. To ensure compliance, administrators should configure their IdP to sign metadata and limit its access to only trusted entities. Remediation involves generating signed metadata from your IdP and updating the OCI configuration to use this metadata, ensuring correct authentication and reducing the risk of unauthorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingIDPs.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/addingasamlidp.htm
  - https://www.oracle.com/security/cis-oracle-cloud-infrastructure-benchmark/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63-3.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/artifacts/oci-security-and-compliance-best-practices/
- rule_id: oci.identity.policy.rights_execution_roles_least_privilege_required
  service: identity
  resource: policy
  requirement: Rights Execution Roles Least Privilege Required
  scope: identity.policy.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Minimum Privilege for OCI Identity Policy Execution Roles
  rationale: Applying the principle of least privilege to OCI identity policies ensures that users and services have only the permissions necessary to perform their tasks, reducing the risk of unauthorized access or actions. This practice is crucial for minimizing potential security breaches and complying with regulatory requirements such as PCI-DSS and ISO 27001.
  description: This rule checks that execution roles within OCI identity policies adhere to the least privilege principle, granting only necessary permissions. It involves reviewing existing policies and modifying them to eliminate excessive permissions that are not essential for operation. Remediation includes adjusting policy statements to align with specific job functions and tasks, ensuring that roles do not possess excessive privileges that could be exploited.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v4-0-1
- rule_id: oci.identity.user.rights_workflow_storage_encrypted
  service: identity
  resource: user
  requirement: Rights Workflow Storage Encrypted
  scope: identity.user.encryption
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure User-Managed Storage for Workflow is Encrypted
  rationale: Encryption of user-managed storage for workflow in OCI is critical to protect sensitive data from unauthorized access and potential data breaches. Unencrypted data can lead to compliance violations, increased risk of data theft, and exposure of confidential business processes.
  description: This check verifies that all user-managed storage associated with workflow processes in Oracle Cloud Infrastructure is properly encrypted using OCI's encryption services. It involves ensuring that data at rest is secured using customer-managed keys or Oracle-managed keys to prevent unauthorized access. Remediation involves enabling encryption on all storage resources utilized by workflow processes and ensuring proper key management and rotation policies are in place.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - CIS OCI Foundations Benchmark
  - https://www.oracle.com/security/cloud-security/
  - NIST SP 800-57 Part 1 Rev. 5
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.virtual_network.vcn.vpn_tunnel_health_monitoring_enabled
  service: virtual_network
  resource: vcn
  requirement: Vpn Tunnel Health Monitoring Enabled
  scope: virtual_network.vcn.monitoring
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure VPN Tunnel Health Monitoring is Enabled
  rationale: Enabling VPN tunnel health monitoring is crucial for maintaining the reliability and security of connections between on-premises networks and OCI. This feature helps detect and diagnose connectivity issues, minimizing potential downtime and ensuring business continuity. It also supports compliance with security policies that require monitoring of network connections for anomalies.
  description: This rule checks whether health monitoring is enabled for VPN tunnels in your OCI Virtual Cloud Network (VCN). Health monitoring ensures that any issues with the VPN connection are detected promptly, allowing for quick remediation. To enable health monitoring, configure your VPN tunnel with the appropriate settings in the OCI console or via the API, ensuring that monitoring data is being logged and alerts are set up for any detected issues.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingIPsec.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_faq.htm#VPN
  - https://www.oracle.com/security-cloud-compliance/cis-oci-benchmark/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-41r1.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.virtual_network.vcn.encryption_mtls_required_for_internal_services_where_supported
  service: virtual_network
  resource: vcn
  requirement: Encryption Mtls Required For Internal Services Where Supported
  scope: virtual_network.vcn.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure mTLS Encryption for Supported Internal Services in VCN
  rationale: Requiring mTLS encryption for internal services helps protect sensitive data by ensuring that communication channels are secure and that both parties are authenticated. This reduces the risk of data breaches, unauthorized access, and ensures compliance with data protection regulations such as GDPR and HIPAA.
  description: This rule verifies that mutual TLS (mTLS) encryption is enabled for Oracle Cloud Infrastructure internal services that support it within a Virtual Cloud Network (VCN). Enabling mTLS ensures that both ends of the communication verify each other's credentials and encrypt the data in transit. To remediate, configure services within the VCN to use mTLS by updating their security settings to enforce encrypted communication where supported.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/virtualcloud.htm
  - https://www.oracle.com/security/cloud-security/cspm/
  - CIS OCI Foundations Benchmark v1.1.0 - Section 4.1
  - 'NIST SP 800-52 Rev. 2: Guidelines for the Selection, Configuration, and Use of Transport Layer Security (TLS) Implementations'
  - 'PCI DSS Requirement 4: Encrypt transmission of cardholder data across open, public networks'
- rule_id: oci.virtual_network.vcn.encryption_tls_min_1_2_enforced
  service: virtual_network
  resource: vcn
  requirement: Encryption TLS Min 1 2 Enforced
  scope: virtual_network.vcn.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure TLS 1.2 or Higher is Enforced for Virtual Cloud Networks
  rationale: Enforcing a minimum of TLS 1.2 for Virtual Cloud Networks (VCNs) ensures robust encryption protocols are utilized, protecting data in transit from eavesdropping and man-in-the-middle attacks. This is critical for maintaining data confidentiality and integrity, as well as meeting compliance standards such as PCI-DSS, HIPAA, and ISO 27001, which mandate strong encryption practices.
  description: This rule checks if Oracle Cloud Infrastructure Virtual Cloud Networks are configured to enforce TLS version 1.2 or higher for all encrypted communications. If a VCN is found using a lower TLS version, it poses a security risk by exposing data to potential interception. To remediate, update the VCN settings to support only TLS 1.2 or higher by configuring the network's load balancers and gateways to reject connections below this version.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/virtualcloudnetwork.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1_1.htm
  - https://csrc.nist.gov/publications/detail/sp/800-52/rev-2/final
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.load_balancer.load_balancer.tg_health_checks_tls_where_supported
  service: load_balancer
  resource: load_balancer
  requirement: Tg Health Checks TLS Where Supported
  scope: load_balancer.load_balancer.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure TLS is Enabled for Target Group Health Checks
  rationale: Enabling TLS for health checks on load balancer target groups ensures that the data being transmitted is encrypted, protecting it from potential interception during transit. This enhances the security of sensitive data and helps maintain compliance with data protection regulations such as PCI-DSS and ISO 27001.
  description: This rule verifies that health checks for load balancer target groups are configured to use TLS where supported. TLS encryption should be enabled to protect data integrity and confidentiality during health check operations. To remediate, modify the health check configuration to use a secure protocol like HTTPS instead of HTTP, ensuring that the target systems support TLS.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Concepts/balanceoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://cloudsecurityalliance.org/research/artifacts/cis-oci-benchmarks/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
  - https://www.nist.gov/system/files/documents/2016/12/15/sp800-53r4.pdf
- rule_id: oci.load_balancer.load_balancer.tg_targets_in_private_subnets_enforced
  service: load_balancer
  resource: load_balancer
  requirement: Tg Targets In Private Subnets Enforced
  scope: load_balancer.load_balancer.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Load Balancer Targets Are In Private Subnets
  rationale: Placing load balancer targets in private subnets minimizes exposure to public internet attacks, thereby reducing the risk of unauthorized access and potential data breaches. This setup aligns with best practices for network security and supports compliance with regulations that mandate the protection of sensitive data.
  description: This rule checks if the target instances behind an OCI Load Balancer are placed within private subnets. Ensuring targets are in private subnets mitigates external threats by restricting direct internet access. To remediate, verify that the backend set targets for your load balancer are deployed within private subnets. If they are not, migrate these resources to a private subnet or update your architecture to utilize a private subnet.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Concepts/balanceoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practice.htm
  - CIS OCI Foundations Benchmark
  - NIST SP 800-53 Rev. 5
  - PCI-DSS v3.2.1 Requirement 1.2
  - ISO/IEC 27001:2013 Annex A.13 Network Security Management
- rule_id: oci.analytics.analytics_instance.monitoring_admin_activity_logging_enabled
  service: analytics
  resource: analytics_instance
  requirement: Monitoring Admin Activity Logging Enabled
  scope: analytics.analytics_instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: critical
  title: Ensure Analytics Admin Activity Logging is Enabled
  rationale: Enabling admin activity logging for OCI Analytics ensures that all administrative actions are tracked and auditable, which is crucial for security monitoring, incident response, and regulatory compliance. Without this logging, unauthorized or malicious activities may go unnoticed, increasing the risk of data breaches and non-compliance with standards such as ISO 27001 and SOC 2.
  description: This rule checks whether admin activity logging is enabled for OCI Analytics instances. It verifies the configuration of the logging service to capture all administrative actions, which is essential for maintaining a secure and compliant cloud environment. To remediate, ensure that the OCI Logging service is configured to log all administrative actions within the Analytics service, and regularly review these logs for suspicious activities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticsoverview.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.analytics.analytics_instance.monitoring_logs_retention_days_minimum_enabled
  service: analytics
  resource: analytics_instance
  requirement: Monitoring Logs Retention Days Minimum Enabled
  scope: analytics.analytics_instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Minimum Retention Days for Analytics Instance Monitoring Logs
  rationale: Proper retention of monitoring logs is crucial for maintaining audit trails and facilitating forensic analysis in the event of a security incident. Short retention periods may lead to insufficient data for compliance requirements and incident investigations, potentially resulting in business and security risks.
  description: This rule verifies that the retention period for monitoring logs in Oracle Cloud Infrastructure Analytics Instances meets the minimum required duration. A minimum retention period ensures that logs are available for auditing, compliance, and security analysis. To remediate, configure the log retention settings in the OCI console to meet or exceed the organization's policy requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Tasks/analyticsmanaging.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/publications/nist-special-publication-800-53-revision-5-security-and-privacy-controls-information
- rule_id: oci.analytics.analytics_instance.monitoring_query_access_logging_enabled
  service: analytics
  resource: analytics_instance
  requirement: Monitoring Query Access Logging Enabled
  scope: analytics.analytics_instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Analytics Instance Query Access Logging is Enabled
  rationale: Enabling query access logging for OCI Analytics instances is crucial for tracking and auditing user actions and queries. This practice helps in identifying unauthorized access or unusual patterns, thereby mitigating security risks and aiding in compliance with regulations such as PCI-DSS and ISO 27001. It enhances the organization's ability to conduct forensic analysis and incident response effectively.
  description: This rule checks whether query access logging is enabled for OCI Analytics instances. Query access logging provides detailed logs of queries run against analytics instances, which are essential for auditing and monitoring purposes. To remediate, enable query access logging via the OCI Console by navigating to the respective Analytics Instance settings and ensuring the logging option is turned on. Regularly review the logs to detect any anomalies or unauthorized access attempts.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - CIS Oracle Cloud Infrastructure Foundations Benchmark
  - https://www.oracle.com/security/cloud-compliance/
  - NIST SP 800-53
  - ISO/IEC 27001:2013
- rule_id: oci.analytics.analytics_instance.audit_logs_centralized_and_encrypted
  service: analytics
  resource: analytics_instance
  requirement: Audit Logs Centralized And Encrypted
  scope: analytics.analytics_instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Centralized and Encrypted Audit Logs for Analytics Instances
  rationale: Centralizing and encrypting audit logs for analytics instances ensures that all access and activity within the service are securely tracked and stored. This is crucial for detecting unauthorized access, mitigating potential data breaches, and complying with regulatory requirements such as GDPR and HIPAA. Failure to properly secure audit logs can lead to data leakage and hinder forensic investigations.
  description: This rule verifies that analytics instances in OCI have their audit logs centralized in the Logging service and encrypted using OCI's Key Management. To comply, ensure that the audit logs are directed to a centralized logging location and that the logging buckets are encrypted. Remediation involves configuring the OCI Logging service to collect analytics logs and applying encryption using managed keys.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Governance/Concepts/gsloganalytics.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-compliance/
- rule_id: oci.analytics.analytics_instance.audit_retention_days_minimum_enabled
  service: analytics
  resource: analytics_instance
  requirement: Audit Retention Days Minimum Enabled
  scope: analytics.analytics_instance.audit_logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Minimum Audit Retention Days for Analytics Instances
  rationale: Setting a minimum number of days for audit log retention is crucial for maintaining a thorough security posture within Oracle Cloud Infrastructure. This ensures that sufficient historical data is available for forensic investigations, compliance audits, and operational troubleshooting. Inadequate audit retention may lead to non-compliance with regulatory requirements and hinder the ability to detect and respond to security incidents.
  description: This rule checks if the audit logs for Oracle Cloud Infrastructure Analytics Instances have a retention period set to a minimum specified number of days. It verifies that the audit retention policy is configured appropriately to maintain logs for a period that meets organizational and regulatory requirements. To remediate, configure the audit retention settings in the OCI console or through API to ensure logs are retained for the specified minimum duration.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/auditpolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_analytics.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-92.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.analytics.analytics_instance.custom_identifier_source_trusted
  service: analytics
  resource: analytics_instance
  requirement: Custom Identifier Source Trusted
  scope: analytics.analytics_instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Analytics Instance Custom Identifier Source is Trusted
  rationale: Using a trusted source for custom identifiers in OCI Analytics instances helps prevent unauthorized access and data manipulation. It ensures that only reliable and verified sources can interact with your analytics data, thereby maintaining data integrity and compliance with organizational security policies.
  description: This rule checks whether the custom identifier source for OCI Analytics instances is from a trusted and verified source. A trusted source is one that has been validated and authorized according to your organization's security policy. To remediate, verify the source of custom identifiers and ensure it is listed in your approved and trusted sources. This involves auditing the source configurations and updating them to align with security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/analytics/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.analytics.analytics_instance.custom_identifier_storage_encrypted
  service: analytics
  resource: analytics_instance
  requirement: Custom Identifier Storage Encrypted
  scope: analytics.analytics_instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Analytics Instance Custom Identifiers Are Encrypted
  rationale: Encrypting custom identifier storage in OCI Analytics ensures that sensitive data is protected against unauthorized access and potential breaches. This is crucial for maintaining data confidentiality and integrity, fulfilling regulatory compliance obligations, and mitigating risks associated with data exposure.
  description: This rule checks if the custom identifier storage within an OCI Analytics instance is encrypted using Oracle-managed keys. Encryption safeguards the data at rest, reducing the risk of unauthorized access. To verify compliance, review the encryption settings in the OCI Console under Analytics Instance configurations. Remediation involves enabling encryption for custom identifier storage if it is not already enabled, ensuring that data compliance and security best practices are met.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticssecurity.htm
  - https://docs.oracle.com/en-us/iaas/Content/security/Concepts/security.htm
  - CIS OCI Foundations Benchmark
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI-DSS-v3_2_1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.analytics.analytics_instance.traffic_analysis_alert_destinations_enabled
  service: analytics
  resource: analytics_instance
  requirement: Traffic Analysis Alert Destinations Enabled
  scope: analytics.analytics_instance.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Traffic Analysis Alert Destinations are Configured for Analytics Instances
  rationale: Enabling alert destinations for traffic analysis in OCI Analytics ensures that any abnormal or suspicious network activities are promptly detected and addressed. This is critical for maintaining the integrity and confidentiality of data, as well as meeting compliance requirements related to monitoring and incident response.
  description: This rule verifies whether traffic analysis alert destinations are configured for OCI Analytics Instances. Proper configuration involves setting up alert notifications to a designated email or notification service for any unusual traffic patterns. To remediate, configure alert destinations in the OCI Console by navigating to the Analytics Instance settings and specifying the desired notification channels. Regularly review and update alert destinations to ensure they are current and effective.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analytics_overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_analytics.htm
  - https://www.oracle.com/security-cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/legacy/sp/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.analytics.analytics_instance.traffic_analysis_ids_ips_enabled
  service: analytics
  resource: analytics_instance
  requirement: Traffic Analysis Ids Ips Enabled
  scope: analytics.analytics_instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Traffic Analysis with IDS/IPS is Enabled for Analytics Instances
  rationale: Enabling traffic analysis with IDS/IPS on analytics instances helps in detecting and mitigating potential security threats such as unauthorized access, data leakage, and suspicious activities. This is crucial for maintaining the integrity and security of data processed within Oracle Analytics, aligning with compliance requirements and enhancing trust with stakeholders.
  description: This rule checks whether Traffic Analysis with Intrusion Detection and Prevention Systems (IDS/IPS) is enabled for Oracle Cloud Infrastructure Analytics Instances. IDS/IPS provides real-time monitoring and analysis of network traffic to identify and respond to potential security threats. To enable, navigate to the OCI Console, access the Analytics Instance settings, and enable IDS/IPS under the security configurations. Ensuring this feature is active helps in safeguarding data and maintaining compliance with security standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analytics_overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.analytics.analytics_instance.query_definition_access_rbac_least_privilege_required
  service: analytics
  resource: analytics_instance
  requirement: Query Definition Access RBAC Least Privilege Required
  scope: analytics.analytics_instance.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for OCI Analytics Query Definition Access
  rationale: Implementing least privilege access controls for OCI Analytics ensures that users and roles have only the permissions necessary to perform their job functions. This minimizes the risk of unauthorized access to sensitive analytics data, which could lead to data breaches, non-compliance with regulatory standards, and potential financial and reputational damage.
  description: This rule checks if OCI Analytics resources are configured with the principle of least privilege for query definition access. It verifies that IAM policies and role assignments grant only the necessary permissions to specific users or groups. To remediate, review and adjust IAM policies to ensure that users do not have excessive permissions beyond their job requirements. Regular audits and updates of these permissions should be conducted to maintain compliance with security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analytics.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://cloudsecurityalliance.org/research/working-groups/oci/
- rule_id: oci.analytics.analytics_instance.query_definition_storage_encrypted
  service: analytics
  resource: analytics_instance
  requirement: Query Definition Storage Encrypted
  scope: analytics.analytics_instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Query Definition Storage is Encrypted in Analytics Instances
  rationale: Encrypting query definition storage is crucial for protecting sensitive data and maintaining data privacy. Unencrypted data can be vulnerable to unauthorized access, leading to potential data breaches. Compliance with data protection regulations such as GDPR, HIPAA, and industry standards like ISO 27001 requires data encryption to safeguard sensitive information.
  description: This rule checks if the query definition storage associated with Oracle Cloud Infrastructure Analytics Instances is encrypted. Encryption helps prevent unauthorized access to sensitive data at rest. To remediate, ensure that encryption settings are enabled for all analytics instances through the OCI Console or using the OCI Command Line Interface (CLI). This involves verifying encryption status and applying necessary configurations to meet compliance and security standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_analytics.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.logging.log_group.retention_enforced_on_sensitive_datasets
  service: logging
  resource: log_group
  requirement: Retention Enforced On Sensitive Datasets
  scope: logging.log_group.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Log Group Retention Policies on Sensitive Data
  rationale: Enforcing retention policies on log groups containing sensitive datasets is crucial for maintaining data privacy, meeting compliance obligations, and facilitating forensic investigations. Without proper retention, sensitive logs may be deleted prematurely, leading to potential data loss and non-compliance with standards like PCI-DSS and HIPAA.
  description: This rule checks if retention policies are configured for log groups that contain sensitive datasets within Oracle Cloud Infrastructure. It verifies that these logs have a defined retention period to ensure they are kept for the necessary time frame to comply with legal and business requirements. To remediate, configure a retention policy on the log group by setting an appropriate retention period based on your organization's data governance policies and regulatory needs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Tasks/managinglogs.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-92.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.logging.log_group.retention_policies_defined_required
  service: logging
  resource: log_group
  requirement: Retention Policies Defined Required
  scope: logging.log_group.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Retention Policies Are Configured for OCI Log Groups
  rationale: Defining retention policies for log groups in OCI is crucial for managing log data lifecycle, reducing storage costs, and ensuring compliance with data retention regulations. Without defined retention policies, organizations risk retaining logs indefinitely, which can lead to increased costs and potential exposure of sensitive data.
  description: This rule checks if retention policies are configured for all log groups in Oracle Cloud Infrastructure. It ensures that log data is automatically archived or deleted after a specified period, aligning with organizational data management policies. To remediate, configure the retention policy for each log group by setting the appropriate retention period in the OCI Logging service console or via the OCI CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Tasks/managingloggroups.htm
  - https://www.oracle.com/security/cloud-compliance/
  - CIS OCI Foundations Benchmark
  - NIST SP 800-92 Guide to Computer Security Log Management
  - ISO/IEC 27001:2013 Information Security Management Systems
- rule_id: oci.logging.log_group.retention_protected_from_public_override_blocked
  service: logging
  resource: log_group
  requirement: Retention Protected From Public Override Blocked
  scope: logging.log_group.public_access
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: critical
  title: Prevent Public Override on Log Group Retention Settings
  rationale: Ensuring log retention settings are protected from public override is critical to maintaining data integrity and compliance. Unauthorized changes to log retention can result in data loss or exposure, impacting incident investigations and compliance with regulations such as GDPR and PCI-DSS.
  description: This rule checks if the log group's retention settings are configured to prevent public overrides. It ensures that only authorized users can modify log retention settings, thereby safeguarding log data against unauthorized changes. Remediation involves reviewing and adjusting IAM policies to restrict permissions to modify log group settings to only trusted roles.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.logging.log_group.monitoring_alerts_for_anomalies_enabled
  service: logging
  resource: log_group
  requirement: Monitoring Alerts For Anomalies Enabled
  scope: logging.log_group.monitoring
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Monitoring Alerts for Anomalies in Log Groups
  rationale: Enabling monitoring alerts for anomalies in log groups is crucial because it helps detect unusual patterns or unexpected behaviors that could indicate security breaches or operational issues. Anomalies in log data can be early indicators of potential threats, enabling timely intervention to mitigate risks. This practice supports compliance with security standards and enhances the overall security posture by ensuring prompt response to anomalies.
  description: This rule checks whether monitoring alerts for anomalies are enabled in Oracle Cloud Infrastructure (OCI) log groups. Anomalies in logging data can indicate potential security incidents or operational issues. To remediate, ensure that anomaly detection is configured in the OCI logging service by setting up alerts for unusual patterns or unexpected log events. This involves configuring log-based alerts and integrating with OCI Monitoring to receive notifications.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/OCI_Logging_Security_Guide.pdf
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.logging.log_group.monitoring_flow_logs_enabled
  service: logging
  resource: log_group
  requirement: Monitoring Flow Logs Enabled
  scope: logging.log_group.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Flow Logs are Enabled for All Log Groups
  rationale: Enabling flow logs for log groups in OCI provides detailed insights into network traffic, helping to identify anomalous activities and potential security threats. This aids in maintaining security compliance and enhances the ability to audit and analyze network behavior, which is crucial for detecting unauthorized access and data exfiltration attempts.
  description: This rule checks whether flow logs are enabled for all log groups within your OCI environment. To comply, ensure that each log group has flow logs configured and actively monitoring network traffic. Remediation involves accessing the OCI Console, navigating to the Logging service, and ensuring that flow logging is enabled and properly configured for each log group. This setup is essential for proactive network monitoring and incident response.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Tasks/enablinglogging.htm
  - CIS OCI Foundations Benchmark
  - NIST SP 800-53 Rev. 5
  - PCI-DSS Requirement 10
  - ISO 27001:2013 A.12.4 Logging and Monitoring
- rule_id: oci.analytics.analytics_instance.monitoring_logs_enabled
  service: analytics
  resource: analytics_instance
  requirement: Monitoring Logs Enabled
  scope: analytics.analytics_instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Monitoring Logs are Enabled for Analytics Instances
  rationale: Enabling monitoring logs for OCI Analytics Instances is crucial for maintaining visibility into the operational and security events within your analytics environment. Without these logs, it becomes challenging to detect and investigate anomalies or unauthorized activities, potentially leading to business disruptions or data breaches. Furthermore, logging is often a requirement in compliance frameworks such as PCI-DSS and ISO 27001.
  description: This rule checks if monitoring logs are enabled for Oracle Cloud Infrastructure Analytics Instances. It verifies whether the logging feature is configured to capture and store logs related to operations and access activities. To remediate, enable logging via the OCI Console by navigating to the Analytics service, selecting the instance, and ensuring that logging is activated under the monitoring section. This ensures that all activities are recorded and can be audited for security and compliance purposes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Tasks/analyticslogging.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-foundations-benchmark.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.analytics.analytics_instance.monitoring_outputs_encrypted_and_private
  service: analytics
  resource: analytics_instance
  requirement: Monitoring Outputs Encrypted And Private
  scope: analytics.analytics_instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Analytics Monitoring Data is Encrypted and Private
  rationale: Encrypting and securing analytics monitoring outputs is crucial to prevent unauthorized access and data breaches. By ensuring data privacy, organizations can meet compliance requirements such as PCI-DSS, HIPAA, and ISO 27001, and protect sensitive information from being exposed.
  description: This rule checks that all monitoring outputs from OCI Analytics instances are encrypted both in transit and at rest, and that access is restricted to authorized users only. Encryption should utilize OCI's native encryption capabilities, and network policies should be in place to limit access. Regularly review and audit access controls and encryption settings to ensure compliance with security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Reference/analyticsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.analytics.analytics_instance.monitoring_private_networking_enforced
  service: analytics
  resource: analytics_instance
  requirement: Monitoring Private Networking Enforced
  scope: analytics.analytics_instance.monitoring
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Analytics Instance Enforces Private Networking
  rationale: Enforcing private networking for Analytics Instances minimizes exposure to potential threats by restricting access to trusted internal networks. This enhances data security and compliance with regulations that require restricted network access, such as PCI-DSS and ISO 27001. It reduces the risk of unauthorized access and data breaches.
  description: This rule checks if Analytics Instances in OCI are configured to enforce private networking. Private networking ensures that the instances are not accessible from public internet and can only be accessed through the private IP addresses within the VCN. To remediate, configure the Analytics Instance settings to enable private access and ensure that only specific IP addresses or ranges within the VCN can access the instance. Regularly review and update the network security rules to maintain compliance and security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-foundations-benchmark.htm
  - https://csrc.nist.gov/publications/detail/sp/800-190/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.analytics.analytics_instance.monitoring_roles_least_privilege_required
  service: analytics
  resource: analytics_instance
  requirement: Monitoring Roles Least Privilege Required
  scope: analytics.analytics_instance.monitoring
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Monitoring Roles in Analytics Instances
  rationale: Applying the principle of least privilege in monitoring roles minimizes the risk of unauthorized access or malicious activity. It ensures that users and services have only the permissions necessary to perform their intended functions, reducing the attack surface and helping to comply with standards such as ISO 27001 and SOC2.
  description: This rule checks that monitoring roles assigned to OCI Analytics Instances are restricted to the minimum required permissions. By verifying IAM policies, it ensures roles do not have excessive privileges which could be exploited. Remediation involves reviewing and adjusting IAM policies to ensure roles are aligned with the principle of least privilege, granting only necessary permissions for monitoring activities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analytics_overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/identitypolicies.htm
  - CIS OCI Foundations Benchmark
  - ISO/IEC 27001:2013 Information Security Management
  - SOC 2 Trust Services Criteria
- rule_id: oci.compute.instance.instance_disk_encrypted
  service: compute
  resource: instance
  requirement: Instance Disk Encrypted
  scope: compute.instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Compute Instance Disks are Encrypted
  rationale: Encrypting instance disks protects sensitive data at rest from unauthorized access, reducing the impact of data breaches. It is critical for compliance with data protection regulations such as GDPR, HIPAA, and ensures alignment with industry standards like ISO 27001.
  description: This rule checks if the block storage volumes attached to compute instances are encrypted using Oracle-managed keys or customer-managed keys. It ensures that any data stored on these disks is secured against unauthorized access. To remediate, enable encryption by default for all block volumes and verify existing volumes are encrypted within the OCI console or via CLI/API.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.compute.instance.instance_no_public_ip_unless_required
  service: compute
  resource: instance
  requirement: Instance No Public Ip Unless Required
  scope: compute.instance.public_access
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Restrict Public IP Assignment to OCI Compute Instances
  rationale: Assigning public IP addresses to instances unnecessarily increases the attack surface, potentially exposing sensitive data and services to unauthorized access. This is critical for maintaining security and compliance with industry standards such as NIST and PCI-DSS, which emphasize minimizing exposure to the public internet.
  description: This rule checks for OCI compute instances that are assigned a public IP address without a documented requirement. Instances should only receive public IPs if they need to be accessible from the internet. To remediate, ensure that instances are deployed within private subnets or use private IPs, and employ NAT gateways or bastion hosts for necessary external communication.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networkoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/ocisecuritybestpractices.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.compute.instance.instance_ssh_password_auth_disabled
  service: compute
  resource: instance
  requirement: Instance Ssh Password Auth Disabled
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure SSH Password Authentication is Disabled for Instances
  rationale: Disabling SSH password authentication reduces the risk of unauthorized access through brute force attacks. It enhances security by ensuring that only SSH key-based authentication, which is more secure, is used to access instances. This practice is crucial for maintaining compliance with security standards and protecting sensitive data.
  description: This rule checks if SSH password authentication is disabled for all OCI compute instances. By disabling password authentication, you enforce the use of SSH keys, which are more secure and less susceptible to brute force attacks. To remediate, configure your instances to disable SSH password authentication by modifying the SSH daemon configuration file and restarting the SSH service.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/References/ssh-key-management.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_platform
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.functions.application.layer_source_trusted
  service: functions
  resource: application
  requirement: Layer Source Trusted
  scope: functions.application.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Function Application Layer Sources Are From Trusted Repositories
  rationale: Using untrusted sources for function application layers can introduce vulnerabilities and increase the risk of unauthorized access or data breaches. Ensuring that layers come from trusted repositories helps maintain the integrity and security of your applications, aligning with compliance and governance requirements.
  description: This rule verifies that the sources of OCI Function application layers are from trusted repositories. It checks the configuration to ensure that all layer sources are from approved and secure locations, reducing the risk of introducing malicious code. Remediation involves configuring the function's application to only use layer sources from trusted repositories, such as those verified by OCI or internally vetted resources.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Concepts/functionsoverview.htm
  - https://www.oracle.com/security-cloud/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/cloud/cloud-native/functions/
- rule_id: oci.functions.application.layer_version_immutable_required
  service: functions
  resource: application
  requirement: Layer Version Immutable Required
  scope: functions.application.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure OCI Function Layers Have Immutable Versions
  rationale: Enforcing immutable versions for function layers in Oracle Cloud Infrastructure ensures that the deployed application uses a consistent and unaltered set of dependencies. This reduces the risk of introducing vulnerabilities or breaking changes that could impact application stability and security. It is crucial for maintaining compliance with security policies and governance standards.
  description: This rule checks whether OCI function applications are configured to use immutable versions of layers. Immutable versions prevent unauthorized changes and ensure the integrity of the application's code base. To remediate, review the function configuration and specify versioned layer ARNs when creating or updating function layers. This practice ensures that once a layer version is deployed, it cannot be modified, thus maintaining a secure and stable environment.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionsmanaginglayers.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/GSG/Reference/securitycontrols.htm
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.mysql.db_system.db_encryption_enabled
  service: mysql
  resource: db_system
  requirement: Db Encryption Enabled
  scope: mysql.db_system.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure MySQL DB Systems Have Encryption Enabled
  rationale: Enabling encryption for MySQL DB Systems in OCI is crucial for protecting sensitive data at rest from unauthorized access and potential breaches. This practice helps meet compliance requirements for data protection frameworks like PCI-DSS, HIPAA, and GDPR, reducing the risk of data exposure and enhancing overall security posture.
  description: This rule checks if encryption is enabled for MySQL DB Systems within your OCI environment. If encryption is not enabled, data stored in the database may be vulnerable to unauthorized access. To remediate, enable Transparent Data Encryption (TDE) in the DB System settings. Regularly verify that encryption settings are active and aligned with your organization's data protection policies.
  references:
  - https://docs.oracle.com/en-us/iaas/mysql-database/doc/managing-mysql-database-service.html#GUID-9D8E8FD9-CC1B-4E9D-B3A3-9D5F9A2B8C08
  - https://docs.oracle.com/en-us/iaas/Content/CloudSecurity/Concepts/security_overview.htm
  - https://cloudsecurityalliance.org/research/guidance/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hipaajournal.com/hipaa-encryption-requirements/
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.mysql.db_system.db_public_access_disabled
  service: mysql
  resource: db_system
  requirement: Db Public Access Disabled
  scope: mysql.db_system.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Disable Public Access for MySQL DB Systems
  rationale: Enabling public access to MySQL DB systems can expose sensitive data to the internet, increasing the risk of unauthorized access, data breaches, and compliance violations. Ensuring that these systems are only accessible from within a secure, controlled environment mitigates these risks and helps maintain the integrity and confidentiality of the data.
  description: This rule checks if public access is disabled for MySQL DB systems on Oracle Cloud Infrastructure. Public access allows any internet user to attempt to connect to the database, which can lead to potential security threats. To remediate, configure the DB system to only allow connections from private IPs or specific, authorized networks. This can be achieved by adjusting the network security groups (NSGs) and access control lists (ACLs) associated with the DB system.
  references:
  - https://docs.oracle.com/en-us/iaas/mysql-database/doc/security-best-practices.html
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcompartments.htm
  - https://cloudsecurityalliance.org/blog/2020/03/09/cloud-security-risk-what-you-need-to-know/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.mysql.db_system.db_require_tls_in_transit_required
  service: mysql
  resource: db_system
  requirement: Db Require TLS In Transit Required
  scope: mysql.db_system.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure TLS is Enabled for MySQL DB Systems in Transit
  rationale: Enabling TLS for MySQL DB systems in transit is crucial to protect sensitive data from being intercepted by unauthorized entities during transmission. This is important for maintaining data confidentiality and integrity, and is often required to meet compliance standards such as PCI-DSS, HIPAA, and SOC2. Ensuring encrypted data transit mitigates the risk of data breaches and unauthorized access.
  description: This rule checks whether Transport Layer Security (TLS) is enabled for MySQL database systems to ensure that data in transit is encrypted. It verifies the configuration to confirm that TLS is required for all incoming and outgoing connections. To remediate, configure the MySQL DB system settings to mandate TLS for data in transit by updating the security configurations in the OCI Console. This ensures that only secure connections are allowed, offering protection against eavesdropping and man-in-the-middle attacks.
  references:
  - https://docs.oracle.com/en-us/iaas/mysql-database/doc/security-overview.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-95.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
- rule_id: oci.container_engine.cluster.fargate_profile_execution_role_least_privilege_required
  service: container_engine
  resource: cluster
  requirement: Fargate Profile Execution Role Least Privilege Required
  scope: container_engine.cluster.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Fargate Profile Execution Role Must Follow Least Privilege Principle
  rationale: Ensuring that the execution role for Fargate profiles adheres to the principle of least privilege is crucial for minimizing the risk of unauthorized access and potential security breaches. Inappropriate role permissions can lead to data leaks, unauthorized resource manipulation, and compromised cluster integrity, impacting business operations and compliance with regulatory standards.
  description: This rule checks whether the execution role associated with the Fargate profiles in OCI Container Engine for Kubernetes is configured with the minimum necessary permissions. It verifies the policies attached to the role to ensure they do not exceed the permissions required for normal operation. To remediate, review and update the execution role policies to only include permissions that are essential for the tasks the Fargate profile needs to perform. Regularly audit and adjust these permissions in line with operational needs and security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/security/cloud-security.html
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.container_engine.cluster.fargate_profile_logging_enabled
  service: container_engine
  resource: cluster
  requirement: Fargate Profile Logging Enabled
  scope: container_engine.cluster.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Fargate Profile Logging is Enabled for OCI Container Engine Clusters
  rationale: Enabling logging for Fargate profiles in OCI Container Engine is crucial for monitoring and auditing purposes. Without logging, it is difficult to detect unauthorized access, configuration changes, or anomalous behavior, which can lead to potential security breaches and compliance issues. Logging also supports incident response and forensic investigations.
  description: This rule checks whether logging is enabled for Fargate profiles within OCI Container Engine clusters. To verify, confirm that logging is configured for the Fargate profile associated with your cluster. Remediation involves enabling logging by configuring the appropriate log groups and ensuring that log information is sent to OCI Logging service for centralized management and review.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengcreatingcluster.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.container_engine.cluster.fargate_profile_private_subnets_only_enforced
  service: container_engine
  resource: cluster
  requirement: Fargate Profile Private Subnets Only Enforced
  scope: container_engine.cluster.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Fargate Profiles Use Only Private Subnets in OCI Clusters
  rationale: Enforcing Fargate profiles to run in private subnets is crucial for minimizing exposure to the public internet, thereby reducing the risk of unauthorized access and potential data breaches. This practice aligns with security best practices by ensuring that workloads are isolated within the network, which is essential for maintaining the integrity and confidentiality of sensitive data in compliance with regulatory frameworks.
  description: This rule checks that all Fargate profiles within Oracle Cloud Infrastructure's Container Engine for Kubernetes (OKE) are configured to use only private subnets. A private subnet ensures that the nodes are not directly accessible from the internet, providing an additional layer of security. To remediate, review your OKE configurations and adjust any profiles using public subnets to leverage private ones instead, thus enhancing the security posture of your cluster.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengsettingupcluster.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
  - CIS OCI Foundations Benchmark
  - NIST SP 800-190 Application Container Security Guide
  - ISO/IEC 27001 Information Security Management
  - OCI Security Best Practices
- rule_id: oci.analytics.analytics_instance.anomaly_destinations_encrypted
  service: analytics
  resource: analytics_instance
  requirement: Anomaly Destinations Encrypted
  scope: analytics.analytics_instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Anomaly Destinations in OCI Analytics are Encrypted
  rationale: Encrypting anomaly destinations in OCI Analytics is crucial for protecting sensitive data from unauthorized access and ensuring data integrity. Data breaches can lead to significant business impact, including financial loss and reputational damage. Compliance with regulations such as GDPR and HIPAA often mandates encryption of sensitive data at rest and in transit.
  description: This rule checks whether anomaly destinations in OCI Analytics instances are encrypted. To verify, ensure that the storage resources used for anomaly outputs are configured with encryption. Remediation involves enabling encryption settings through the OCI Console or CLI for the relevant analytics resources, ensuring all data written to these destinations is encrypted using Oracle-managed keys.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticssecurity.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/
- rule_id: oci.analytics.analytics_instance.anomaly_detectors_enabled
  service: analytics
  resource: analytics_instance
  requirement: Anomaly Detectors Enabled
  scope: analytics.analytics_instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Enable Anomaly Detection in Analytics Instances
  rationale: Anomaly detection in OCI Analytics instances helps identify unusual patterns that could indicate security breaches or misconfigurations. This enhances the security posture by providing early warnings of potential threats, reducing the risk of data loss or unauthorized access. Enabling anomaly detectors supports compliance with security frameworks and industry best practices.
  description: This rule checks whether anomaly detectors are enabled for OCI Analytics instances. Anomaly detection involves monitoring usage patterns and alerting administrators of any deviations that could indicate security incidents. To ensure these detectors are active, review the settings in the OCI console under the Analytics service section. Enabling anomaly detection can be done through the OCI console by navigating to the specific analytics instance and configuring the anomaly detection settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security-cloud/compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.network_firewall.network_firewall.ip_set_sources_trusted
  service: network_firewall
  resource: network_firewall
  requirement: Ip Set Sources Trusted
  scope: network_firewall.network_firewall.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Network Firewall IP Set Sources are Trusted
  rationale: Configuring trusted IP sets in network firewalls helps to prevent unauthorized access and potential data breaches, ensuring only traffic from trusted sources can access your resources. This is crucial for maintaining the confidentiality and integrity of your network, complying with security standards, and protecting against external threats.
  description: This rule checks that the IP sets defined in OCI network firewalls consist only of trusted sources. It requires validating that IP addresses or CIDR blocks in the firewall's IP set lists are from known and approved entities. Remediation involves auditing existing IP sets and updating them to ensure they do not include untrusted or unknown addresses. Regular reviews and updates to these configurations can help maintain a secure network perimeter.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networkfirewall.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - CIS OCI Foundations Benchmark v1.1.0
  - NIST Special Publication 800-53
  - PCI-DSS Cloud Computing Guidelines
  - ISO 27001:2013 Information Security Management
- rule_id: oci.network_firewall.network_firewall.ip_set_storage_encrypted
  service: network_firewall
  resource: network_firewall
  requirement: Ip Set Storage Encrypted
  scope: network_firewall.network_firewall.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure IP Set Storage in Network Firewall is Encrypted
  rationale: Encrypting IP set storage in OCI's Network Firewall is crucial for protecting sensitive data from unauthorized access. Encryption mitigates the risk of data breaches and ensures compliance with data protection standards, such as GDPR and HIPAA, which mandate data encryption to safeguard customer and organizational information.
  description: This rule checks whether the IP set storage used in OCI Network Firewall is encrypted. Encryption should be enabled to prevent unauthorized access to sensitive network configurations and to comply with security best practices. To remediate, enable encryption through the OCI console or API when setting up or updating IP sets in the Network Firewall.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networkfirewall.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.network_firewall.network_firewall.ip_set_used_by_detectors
  service: network_firewall
  resource: network_firewall
  requirement: Ip Set Used By Detectors
  scope: network_firewall.network_firewall.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure IP Sets Are Used by Network Firewall Detectors
  rationale: Using IP sets in network firewalls is crucial for defining approved or denied IP addresses, enhancing security by controlling incoming and outgoing traffic. This mitigates risks such as unauthorized access and potential data breaches, contributing to improved compliance with security policies and regulatory requirements.
  description: This rule checks if IP sets are actively used by network firewall detectors within OCI. It ensures that pre-defined IP sets are integrated into firewall rules to manage traffic effectively. If IP sets are not utilized, it may result in inadequate traffic filtering, leaving the network vulnerable. Remediation involves configuring network firewall rules to include relevant IP sets, ensuring comprehensive traffic management and security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networkfirewall.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide_network_security.htm
  - https://www.oracle.com/security/cloud-security/
  - CIS OCI Foundations Benchmark
  - NIST SP 800-53
  - ISO/IEC 27001:2013
- rule_id: oci.virtual_network.security_list.sg_egress_restricted
  service: virtual_network
  resource: security_list
  requirement: Sg Egress Restricted
  scope: virtual_network.security_list.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Restrict Egress Traffic in OCI Security Lists
  rationale: Restricting egress traffic in security lists minimizes the attack surface by preventing unauthorized outbound connections from instances, reducing the risk of data exfiltration and ensuring compliance with security policies. It supports adherence to compliance frameworks such as PCI-DSS and NIST by enforcing controlled data flows.
  description: This rule checks if egress rules in OCI Security Lists are configured to allow only necessary outbound traffic. By default, all outbound traffic should be denied unless explicitly permitted. To remediate, review your security list settings and define egress rules that specify allowed destination IPs, ports, and protocols. Ensure that only essential egress traffic is permitted to minimize exposure and potential data breaches.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-1-1-0.htm
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.virtual_network.security_list.sg_no_0_ingress
  service: virtual_network
  resource: security_list
  requirement: Sg No 0 Ingress
  scope: virtual_network.security_list.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure No Ingress Rule Allows All Traffic (0.0.0.0/0) in Security Lists
  rationale: Allowing unrestricted ingress traffic from the internet poses a significant security risk as it can expose your resources to potential attacks such as unauthorized access, data breaches, and exploitation of vulnerabilities. This is crucial for maintaining a strong security posture and ensuring compliance with security standards like ISO 27001, which mandates restricted access to sensitive resources.
  description: This rule checks OCI Security Lists to ensure that no ingress rules are configured with a source of 0.0.0.0/0, which allows traffic from any IP address. To verify, inspect the Security List configurations in your OCI Console for any rules that permit unrestricted ingress. If found, modify these rules to specify only trusted IP addresses or CIDR blocks that require access. This helps to limit potential attack vectors and enhance network security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.oracle.com/security/cis-benchmarks/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-nistcsf.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/securitybestpractices.htm
- rule_id: oci.virtual_network.vcn.sg_only_required_ports_open
  service: virtual_network
  resource: vcn
  requirement: Sg Only Required Ports Open
  scope: virtual_network.vcn.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Restrict VCN Security Group to Only Necessary Ports
  rationale: Exposing unnecessary ports in your Virtual Cloud Network (VCN) can lead to potential security vulnerabilities such as unauthorized access and data breaches. By ensuring that only required ports are open, you minimize the attack surface and adhere to security best practices, reducing the risk of exploitation and maintaining compliance with industry standards.
  description: This rule checks whether security groups within a VCN have only the necessary ports open to meet application and business needs. It involves auditing the ingress and egress rules configured in security groups to ensure that no ports are unnecessarily exposed to the internet or other untrusted networks. Remediation involves reviewing and adjusting security group rules to close any non-essential ports, thus enhancing your overall security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securityrules.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.virtual_network.security_list.microseg_endpoint_policies_applied
  service: virtual_network
  resource: security_list
  requirement: Microseg Endpoint Policies Applied
  scope: virtual_network.security_list.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Microsegmentation Policies Are Applied to Security Lists
  rationale: Implementing microsegmentation policies in OCI security lists helps to limit lateral movement of threats within your cloud environment, reducing the risk of unauthorized access and potential data breaches. This approach aligns with best practices for network security and helps to meet compliance requirements by ensuring that only necessary communications are allowed between resources.
  description: This rule checks that microsegmentation endpoint policies are applied to security lists within your OCI environment. It verifies that security lists are configured with appropriate rules to enforce granular control over traffic between the resources. Remediation involves reviewing and updating security list rules to ensure they adhere to microsegmentation principles, thereby restricting unnecessary access and improving overall security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networksecurity.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.oracle.com/cloud/oci-compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-190/final
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
- rule_id: oci.virtual_network.vcn.microseg_identity_aware_policies_enabled
  service: virtual_network
  resource: vcn
  requirement: Microseg Identity Aware Policies Enabled
  scope: virtual_network.vcn.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure VCNs Utilize Identity-Aware Microsegmentation Policies
  rationale: Enabling identity-aware microsegmentation policies in OCI Virtual Cloud Networks (VCNs) enhances security by allowing precise control over network traffic based on user identity. This reduces the risk of unauthorized access and lateral movement within the cloud environment, thereby protecting sensitive data and ensuring compliance with security standards.
  description: This rule verifies that VCNs in OCI have identity-aware microsegmentation policies enabled, which ensures that network access is governed by identity and context rather than fixed network configurations. To remediate, configure identity-based policies in your OCI VCNs using Oracle Identity and Access Management services, enabling fine-grained access control tailored to specific security requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - CIS OCI Foundations Benchmark v1.1.0 - Network Security
  - 'NIST SP 800-53 Rev. 5: Access Control'
  - 'PCI DSS v3.2.1: Requirement 7 - Restrict access to cardholder data by business need to know'
  - ISO/IEC 27001:2013 - A.9 Access control
- rule_id: oci.virtual_network.security_list.sg_ingress_no_0
  service: virtual_network
  resource: security_list
  requirement: Sg Ingress No 0
  scope: virtual_network.security_list.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure No Default Ingress Rule Allows Traffic on Port 0
  rationale: Allowing ingress traffic on port 0 can expose your resources to unintended access, leading to potential unauthorized access or data breaches. This practice is against security best practices and can result in non-compliance with industry regulations such as PCI-DSS and ISO 27001.
  description: This rule checks for security list configurations that allow ingress traffic on port 0, which is typically a misconfiguration. Port 0 is reserved and should not be used for network communications. To remediate, review your security lists and remove any rules allowing ingress on port 0. Ensure that only necessary ports are open, and restrict access to known IP addresses or CIDR blocks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-landing.htm
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://cloudsecurityalliance.org/research/security-guidance
- rule_id: oci.virtual_network.vcn.sg_ingress_only_required_ports
  service: virtual_network
  resource: vcn
  requirement: Sg Ingress Only Required Ports
  scope: virtual_network.vcn.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure VCN Security Groups Allow Ingress Only on Required Ports
  rationale: Restricting ingress traffic to only necessary ports minimizes the attack surface, reducing the likelihood of unauthorized access and potential breaches. This practice supports compliance with security standards and helps protect sensitive data and resources from exposure to threats.
  description: This rule verifies that Virtual Cloud Network (VCN) security groups are configured to allow ingress traffic only on ports deemed necessary for operational purposes. By ensuring that only required ports are open, you can limit potential entry points to your infrastructure. To remediate, review the current ingress rules in your VCN security groups and remove or adjust any rules that allow traffic on non-essential ports.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitygroups.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_securitybestpractices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.virtual_network.security_list.sg_no_0_ingress_on_db_ports
  service: virtual_network
  resource: security_list
  requirement: Sg No 0 Ingress On Db Ports
  scope: virtual_network.security_list.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Restrict Ingress Traffic to Database Ports in Security Lists
  rationale: Allowing unrestricted ingress traffic on common database ports can expose sensitive data to unauthorized access and potential attacks. Ensuring that database ports are not open to the internet by default helps mitigate risks such as data breaches and unauthorized data manipulation, aligning with security compliance standards.
  description: This rule checks that no ingress rules in security lists allow traffic from source CIDR 0.0.0.0/0 to database ports such as 1521 (Oracle DB), 3306 (MySQL), and 5432 (PostgreSQL). Verification involves inspecting security lists for any rules that permit unrestricted access to these ports. Remediation requires modifying security lists to restrict ingress traffic to trusted IP addresses or virtual network addresses, thereby minimizing exposure to potential threats.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.oracle.com/security-cloud/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/References/ocisecuritybestpractices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.virtual_network.security_list.access_control_no_permit_all_restricted
  service: virtual_network
  resource: security_list
  requirement: Access Control No Permit All Restricted
  scope: virtual_network.security_list.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict 'Permit All' Rules in OCI Security Lists
  rationale: Allowing 'Permit All' rules in security lists increases the attack surface by exposing cloud resources to potential unauthorized access. This can lead to data breaches, unauthorized data manipulation, and compliance violations with frameworks such as PCI-DSS, HIPAA, and ISO 27001. Implementing restrictive access controls minimizes these risks and enhances the overall security posture of your OCI environment.
  description: This rule checks for overly permissive 'Permit All' rules in OCI Security Lists that allow unrestricted traffic to resources. To mitigate this, review and update security list rules to enforce the principle of least privilege by specifying appropriate IP ranges and protocols. Remediation involves identifying and removing or modifying any 'Permit All' rules to restrict access to known, trusted IP addresses and specific network protocols.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.0.0_benchmark.htm
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hipaajournal.com/hipaa-compliance-checklist/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.virtual_network.security_list.access_control_policies_present_restricted
  service: virtual_network
  resource: security_list
  requirement: Access Control Policies Present Restricted
  scope: virtual_network.security_list.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Security Lists Have Restricted Access Control Policies
  rationale: Restricting access control policies in security lists is essential to minimize the risk of unauthorized access and potential data breaches. By ensuring that security lists have restricted policies, organizations can better protect their cloud resources and meet compliance requirements such as PCI-DSS and ISO 27001.
  description: This rule checks for the presence of overly permissive access control policies within OCI Security Lists. It ensures that ingress and egress rules are limited to necessary IP addresses and ports, reducing the attack surface. Remediation involves reviewing and updating security list rules to comply with the principle of least privilege, allowing only essential traffic.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.oracle.com/cloud/networking/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.virtual_network.vcn.access_control_policy_store_encrypted
  service: virtual_network
  resource: vcn
  requirement: Access Control Policy Store Encrypted
  scope: virtual_network.vcn.encryption
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure VCN Access Control Policies are Encrypted
  rationale: Encrypting access control policies for Virtual Cloud Networks (VCNs) in OCI is crucial to protect sensitive information from unauthorized access. Unencrypted policies could lead to data breaches, compromising the integrity and confidentiality of network configurations and access controls. Encryption also helps meet compliance requirements for data protection under standards such as NIST, PCI-DSS, and ISO 27001.
  description: This rule checks whether the access control policies for VCNs are encrypted using Oracle Cloud Infrastructure's encryption capabilities. To verify, ensure that the policy data is stored in encrypted format using OCI's Key Management service. Remediation involves enabling encryption for existing policies and verifying new policies are created with encryption enabled. Regular audits should be conducted to ensure ongoing compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.analytics.analytics_instance.snapshot_encrypted_at_rest_cmek
  service: analytics
  resource: analytics_instance
  requirement: Snapshot Encrypted At Rest Cmek
  scope: analytics.analytics_instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Analytics Instance Snapshots Use Customer-Managed Encryption Keys
  rationale: Encrypting snapshots at rest using Customer-Managed Encryption Keys (CMEK) enhances data security by ensuring that the data is protected with keys that are under the control of the organization. This reduces the risk of unauthorized access and helps meet regulatory and compliance requirements such as GDPR and CCPA. CMEK provides additional control, allowing organizations to manage key rotation and revocation policies.
  description: This rule checks whether snapshots of Oracle Cloud Infrastructure (OCI) Analytics Instances are encrypted using Customer-Managed Encryption Keys (CMEK). To comply, organizations must configure their analytics instances to utilize CMEK for snapshot encryption. This involves creating a key in OCI Vault and associating it with the analytics instance. Failure to use CMEK can result in reliance on default encryption keys, which might not meet the organization's security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Reference/analytics.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.analytics.analytics_instance.snapshot_cmk_policy_least_privilege_enabled
  service: analytics
  resource: analytics_instance
  requirement: Snapshot CMK Policy Least Privilege Enabled
  scope: analytics.analytics_instance.backup_recovery
  domain: resilience_and_disaster_recovery
  subcategory: backup_configuration
  severity: high
  title: Ensure Least Privilege for CMK in Analytics Snapshots
  rationale: Configuring least privilege for Customer Master Keys (CMKs) in analytics snapshots is crucial for minimizing the risk of unauthorized access and potential data breaches. This supports compliance with security standards and ensures that only necessary permissions are granted, reducing the attack surface and enhancing overall security posture.
  description: This rule checks whether the policies associated with CMKs used for encrypting analytics instance snapshots are configured to follow the principle of least privilege. It ensures that only specific, necessary permissions are granted to users or applications that need access. To remediate, review and adjust the key policies to limit permissions to only required actions for specific roles or users.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticsconcepts.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingkeys.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.analytics.analytics_instance.snapshot_not_publicly_shared_blocked
  service: analytics
  resource: analytics_instance
  requirement: Snapshot Not Publicly Shared Blocked
  scope: analytics.analytics_instance.backup_recovery
  domain: resilience_and_disaster_recovery
  subcategory: backup_configuration
  severity: critical
  title: Ensure Analytics Instance Snapshots Are Not Publicly Accessible
  rationale: Publicly shared snapshots of analytics instances can expose sensitive data and configurations, leading to unauthorized access and potential data breaches. Ensuring snapshots are not publicly accessible is crucial for maintaining data confidentiality and adhering to compliance standards.
  description: This rule checks if snapshots of OCI Analytics Instances are publicly shared. Public sharing of snapshots can expose critical data to unauthorized users. To remediate, review all analytics instance snapshots and configure them to restrict access to only necessary internal users or groups. Utilize OCI Identity and Access Management (IAM) policies to enforce these restrictions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/security-cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.analytics.analytics_instance.workgroup_allowed_data_sources_allowlist
  service: analytics
  resource: analytics_instance
  requirement: Workgroup Allowed Data Sources Allowlist
  scope: analytics.analytics_instance.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Restrict Analytics Instance Data Sources to Approved List
  rationale: Ensuring that analytics instances in OCI only connect to approved data sources is critical for maintaining data integrity and privacy. Unauthorized data source connections can lead to data breaches, non-compliance with data protection regulations, and potential financial losses. By restricting connections to a pre-defined allowlist, organizations can better control data flow and mitigate security risks.
  description: This rule checks whether OCI Analytics Instances are configured to connect only to data sources specified in an approved allowlist. The objective is to prevent unauthorized data access and ensure compliance with organizational and regulatory data protection policies. Remediation involves reviewing the current configuration of analytics instances and updating their settings to restrict data source connections to those explicitly approved by the organization.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticssecurity.htm
  - https://www.oracle.com/security/cis-benchmark/
  - https://www.oracle.com/cloud/soc2/
  - https://www.oracle.com/a/ocom/docs/corporate/iso-27001-27017-27018.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.analytics.analytics_instance.workgroup_network_access_private_restricted
  service: analytics
  resource: analytics_instance
  requirement: Workgroup Network Access Private Restricted
  scope: analytics.analytics_instance.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Analytics Instances are Configured with Restricted Private Network Access
  rationale: Restricting network access to analytics instances is crucial to prevent unauthorized access and potential data breaches. By limiting access to private networks, organizations can ensure that sensitive data processed by analytics services remains secure and compliant with regulatory standards such as PCI-DSS and ISO 27001.
  description: This rule checks that Oracle Cloud Infrastructure (OCI) analytics instances are configured to restrict network access to private IP addresses only. This involves verifying that the network security groups (NSGs) or virtual cloud network (VCN) security rules associated with the analytics instances allow inbound and outbound traffic solely from specified private IP ranges. Remediation involves modifying the security rules to limit access to known and trusted private networks, thereby reducing exposure to potential threats.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticsnetworksecurity.htm
  - https://www.oracle.com/security/cloud-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.analytics.analytics_instance.workgroup_query_result_encryption_enabled
  service: analytics
  resource: analytics_instance
  requirement: Workgroup Query Result Encryption Enabled
  scope: analytics.analytics_instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Encryption of Query Results in OCI Analytics Instances
  rationale: Enabling encryption for workgroup query results in OCI Analytics is crucial for protecting sensitive data from unauthorized access. This practice mitigates risks associated with data breaches and aligns with compliance requirements such as PCI-DSS and HIPAA, ensuring data privacy and integrity.
  description: This rule checks whether encryption is enabled for the query results within OCI Analytics Instances. Encrypted query results ensure that any data processed or stored within the analytics service is protected. To remediate, ensure that your analytics instance is configured to encrypt query results by using OCI's built-in encryption features, which can be managed through the OCI Console or API. This step is essential for maintaining a high level of security and compliance across your cloud resources.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.analytics.analytics_instance.dataset_access_policies_least_privilege_required
  service: analytics
  resource: analytics_instance
  requirement: Dataset Access Policies Least Privilege Required
  scope: analytics.analytics_instance.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Analytics Instance Dataset Access Policies
  rationale: Enforcing least privilege on dataset access policies minimizes the risk of unauthorized data exposure, ensuring that users and applications have only the permissions necessary to perform their tasks. This approach reduces the attack surface and helps maintain compliance with standards like ISO 27001 and PCI-DSS.
  description: This check evaluates whether dataset access policies for OCI Analytics Instances are configured to follow the principle of least privilege. It involves reviewing policies to ensure no excessive permissions are granted to users or services. Remediation includes adjusting policies to limit access rights to what is strictly necessary for the role or service, aligning with security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticsconcepts.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://cloudsecurityalliance.org/star/registry/oracle/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.pcisecuritystandards.org/document_library
- rule_id: oci.analytics.analytics_instance.dataset_encrypted_at_rest_cmek
  service: analytics
  resource: analytics_instance
  requirement: Dataset Encrypted At Rest Cmek
  scope: analytics.analytics_instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Analytics Instances Use CMEK for Data Encryption at Rest
  rationale: Encrypting datasets at rest using Customer-Managed Encryption Keys (CMEK) enhances security by giving organizations control over the encryption keys, minimizing unauthorized data access risks. It also helps in meeting compliance requirements such as GDPR, HIPAA, and PCI-DSS, ensuring sensitive data is protected according to regulatory standards.
  description: This rule verifies that Oracle Cloud Infrastructure (OCI) Analytics instances have datasets encrypted at rest using Customer-Managed Encryption Keys (CMEK). It checks for the presence of CMEK configuration in analytics instances, ensuring that datasets leverage customer-provided keys for encryption. Remediation involves configuring the analytics instance to use a key from the OCI Vault service, providing an additional layer of security and allowing for key rotation and management by the customer.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticssecurity.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.oracle.com/security/cloud-security/oci-best-practices/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57p1r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.analytics.analytics_instance.dataset_public_sharing_disabled
  service: analytics
  resource: analytics_instance
  requirement: Dataset Public Sharing Disabled
  scope: analytics.analytics_instance.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Disable Public Sharing for OCI Analytics Datasets
  rationale: Disabling public sharing of datasets in OCI Analytics is crucial to prevent unauthorized access to sensitive information. Publicly accessible datasets can lead to data breaches, exposing confidential business data, and violating compliance requirements such as GDPR, PCI-DSS, and HIPAA. Ensuring datasets are not publicly shared mitigates the risk of data exfiltration and maintains the integrity of sensitive information.
  description: This rule checks if any datasets in an OCI Analytics instance are publicly shared. Public sharing of datasets should be disabled to prevent unauthorized access. Verification involves reviewing the sharing settings of datasets within the Analytics instance to ensure they are not accessible to the public. Remediation requires configuring dataset permissions to restrict access to only authorized users within the organization, using OCI Identity and Access Management (IAM) policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticsdatasets.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/security-cloud-compliance/cis-benchmark/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.analytics.analytics_instance.dataset_row_level_security_enabled
  service: analytics
  resource: analytics_instance
  requirement: Dataset Row Level Security Enabled
  scope: analytics.analytics_instance.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Dataset Row Level Security is Enabled for Analytics Instances
  rationale: Enabling row-level security for datasets in Oracle Cloud Infrastructure (OCI) Analytics helps protect sensitive data by ensuring that users only have access to the data they are authorized to view. This is crucial for maintaining data privacy, complying with regulations, and preventing unauthorized data access, which could lead to data breaches and financial loss.
  description: This rule checks if row-level security is enabled for datasets in OCI Analytics instances. Enabling row-level security ensures that access to data is restricted based on user roles, enhancing data protection. To verify compliance, review the security settings of each analytics instance and ensure row-level security is configured. To remediate, navigate to the OCI Analytics console, select the instance, and configure row-level security settings as per your organization's requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticssecurity.htm
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Tasks/analyticsmanaging.htm
  - https://www.oracle.com/security/cloud-security/cspm/
  - NIST SP 800-53
  - PCI-DSS Requirement 7
  - ISO/IEC 27001:2013
- rule_id: oci.analytics.analytics_instance.group_external_sharing_restricted
  service: analytics
  resource: analytics_instance
  requirement: Group External Sharing Restricted
  scope: analytics.analytics_instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict External Sharing in OCI Analytics Instances
  rationale: Restricting external sharing of analytics data is crucial to prevent unauthorized access, data breaches, and leakage of sensitive information. It ensures compliance with data protection regulations and protects the organization's intellectual property and customer data from external threats.
  description: This rule checks if external sharing options are restricted on OCI Analytics Instances. It verifies configuration settings to ensure that analytics data cannot be shared outside the organization without proper authorization. Remediation involves reviewing and adjusting the sharing settings in the OCI Analytics console to limit data access to internal users or trusted external collaborators with strict controls.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analytics_overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Tasks/analyticsmanaging.htm#restrictsharing
  - https://www.oracle.com/security/cloud-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/cloud/cloud-compliance/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.analytics.analytics_instance.group_roles_minimal
  service: analytics
  resource: analytics_instance
  requirement: Group Roles Minimal
  scope: analytics.analytics_instance.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Minimal Roles Assigned to Analytics Instance Groups
  rationale: Limiting roles to only those necessary for analytics instances in OCI reduces the attack surface by ensuring that users or groups have minimal permissions. This minimizes the risk of unauthorized access to sensitive data and helps maintain compliance with security frameworks such as NIST and ISO 27001.
  description: This rule checks that only essential roles are assigned to groups managing analytics instances within OCI. It verifies that permissions granted to these groups are minimal and aligned with the principle of least privilege. Remediation involves reviewing current group roles and adjusting them to ensure only necessary permissions are granted, thereby reducing potential security risks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.oracle.com/security/cloud-security/
  - https://www.cisecurity.org/benchmark/oracle
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.identity.user.user_external_access_reviewed_restricted
  service: identity
  resource: user
  requirement: User External Access Reviewed Restricted
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure External Access for OCI Users is Regularly Reviewed and Restricted
  rationale: Regularly reviewing and restricting external access for OCI users is crucial to prevent unauthorized data exposure and ensure compliance with security standards. External access can be a significant vector for security breaches if not properly managed, leading to potential data leaks and non-compliance with industry regulations such as PCI-DSS and ISO 27001.
  description: This rule checks whether external access permissions granted to Oracle Cloud Infrastructure users are periodically reviewed and restricted as necessary. It involves verifying that users with external access have justifiable business needs and that such access is documented and approved. Remediation includes conducting regular audits of user access, revoking unnecessary permissions, and ensuring that all external access is aligned with the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam_access.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmark/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.user_roles_minimal
  service: identity
  resource: user
  requirement: User Roles Minimal
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Users Have Minimal Required Roles for Least Privilege
  rationale: Enforcing the principle of least privilege reduces the risk of unauthorized access to sensitive resources and limits potential damage from compromised accounts. It is crucial for maintaining a secure environment and meeting compliance standards such as NIST and ISO 27001.
  description: This rule checks that users in OCI are assigned only the roles necessary for their job functions, avoiding unnecessary permissions. Verification involves reviewing user roles and ensuring alignment with their responsibilities. Remediation includes auditing user permissions and removing any roles that exceed the minimum required access for their tasks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.user_sso_required
  service: identity
  resource: user
  requirement: User Sso Required
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Users Require Single Sign-On (SSO) for Enhanced Security
  rationale: Requiring SSO for user authentication helps centralize access control, reduce the risk of credential theft, and enhance compliance with security standards. By enforcing SSO, organizations can streamline user management, ensure stronger authentication methods, and maintain consistency in access policies across all services within Oracle Cloud Infrastructure (OCI).
  description: This rule verifies that all OCI user accounts are configured to use Single Sign-On (SSO) for authentication. SSO integration should be implemented using a trusted identity provider to enable secure and seamless access to OCI resources. If a user account is not configured to use SSO, it increases the risk of unauthorized access due to weaker password policies and lack of centralized management. To remediate, configure SSO for user accounts by integrating with an identity provider that supports SAML 2.0 or OAuth 2.0 protocols, ensuring all user accesses are authenticated via SSO.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingSSO.htm
  - https://www.oracle.com/security/cloud-security/identity-and-access/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practice_identity.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.events.rule.bucket_notification_cross_account_destinations_restricted
  service: events
  resource: rule
  requirement: Bucket Notification Cross Account Destinations Restricted
  scope: events.rule.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Restrict Cross-Account Destinations for Bucket Notifications
  rationale: Restricting bucket notification destinations to cross-account endpoints minimizes the risk of unauthorized data access and potential data leaks, which could lead to compliance breaches and financial loss. This control ensures that only authorized accounts, within the same organization, receive bucket event notifications, thereby maintaining the integrity and confidentiality of data.
  description: This rule checks if OCI bucket notifications are configured to send events to cross-account destinations. Verification involves reviewing the event rules associated with Object Storage buckets to ensure that notifications are limited to accounts within the same tenancy. To remediate, update the event rule settings to restrict notification destinations to approved accounts within your organization.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm#CSPM
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
- rule_id: oci.events.rule.bucket_notification_destination_encrypted
  service: events
  resource: rule
  requirement: Bucket Notification Destination Encrypted
  scope: events.rule.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Encryption for Bucket Notification Destinations
  rationale: Encrypting bucket notification destinations is critical for protecting data in transit from unauthorized access or tampering. This is essential for maintaining data integrity and confidentiality, ensuring compliance with data protection regulations, and reducing the risk of data breaches.
  description: This rule verifies that all bucket notification destinations configured via OCI Events are encrypted using Oracle-managed encryption keys. To ensure this, review the configuration of your event rules and verify that the destinations, such as object storage buckets or streams, are set to use encryption. If not, update the configuration to enable encryption to protect your data.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcompartments.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
- rule_id: oci.events.rule.bucket_notification_destination_least_privilege_required
  service: events
  resource: rule
  requirement: Bucket Notification Destination Least Privilege Required
  scope: events.rule.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Bucket Notification Destinations
  rationale: Granting excessive permissions to bucket notification destinations can lead to unauthorized access and data exposure, increasing the risk of data breaches and compliance violations. Applying the principle of least privilege helps minimize potential attack surfaces and ensures that only necessary permissions are granted, aligning with security best practices and regulatory requirements.
  description: This rule checks if the bucket notification destinations in Oracle Cloud Infrastructure are configured with the least privilege principle. It involves verifying that the IAM policies associated with notification destinations (e.g., Object Storage, Functions) only include necessary permissions to perform specific tasks. Remediation includes reviewing and updating IAM policies to restrict permissions to the minimum required for functionality, thereby enhancing security and compliance posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/securitypolicies.htm
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
- rule_id: oci.object_storage.bucket.lifecycle_expiration_rules_defined_required
  service: object_storage
  resource: bucket
  requirement: Lifecycle Expiration Rules Defined Required
  scope: object_storage.bucket.lifecycle_management
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure Object Storage Buckets Have Lifecycle Expiration Rules
  rationale: Defining lifecycle expiration rules for Object Storage buckets is crucial to manage data retention efficiently. This practice helps in reducing storage costs by automatically deleting objects that are no longer needed, thereby minimizing the risk of storing outdated or unnecessary data, which can be a security and compliance liability.
  description: This rule checks if lifecycle expiration rules are defined for OCI Object Storage buckets. Without these rules, objects may persist indefinitely, leading to increased storage costs and potential compliance risks. To remediate, define lifecycle policies that specify when objects should be deleted based on age or other criteria. This can be done through the OCI Console or using OCI CLI by configuring lifecycle policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usinglifecyclepolicies.htm
  - CIS OCI Foundations Benchmark - Section 3.4
  - https://www.oracle.com/security/cloud-security/compliance/
  - NIST SP 800-53 Rev. 5 - MP-6 Media Sanitization
  - 'PCI DSS v3.2.1 - Requirement 3: Protect Stored Cardholder Data'
  - ISO/IEC 27001:2013 - A.8.3.2 Disposal of Media
- rule_id: oci.object_storage.bucket.lifecycle_immutable_retention_locked_where_required
  service: object_storage
  resource: bucket
  requirement: Lifecycle Immutable Retention Locked Where Required
  scope: object_storage.bucket.lifecycle_management
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure Buckets Have Immutable Retention Policies Locked Where Needed
  rationale: Implementing immutable retention policies on object storage buckets is crucial for preventing the accidental or malicious deletion or alteration of data. This is particularly important for compliance with data retention regulations and to safeguard critical business data. Locking these policies ensures that retention settings cannot be changed, which adds an extra layer of security.
  description: This rule checks if the object storage buckets that require immutable retention policies have these policies properly locked. It ensures that once data is written, it cannot be altered or deleted until the retention period ends. To remediate, review your bucket policies and ensure that immutable retention is enabled and locked for buckets with regulatory or business-critical data. This can be configured through the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usinglifecyclepolicies.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.hipaajournal.com/oracle-cloud-compliance-with-hipaa/
  - https://cloudsecurityalliance.org/research/artifacts/oci-security-best-practices
- rule_id: oci.object_storage.bucket.lifecycle_versioning_enabled
  service: object_storage
  resource: bucket
  requirement: Lifecycle Versioning Enabled
  scope: object_storage.bucket.versioning
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure Bucket Lifecycle Policies Enable Object Versioning
  rationale: Enabling lifecycle versioning for object storage buckets ensures that previous versions of objects are retained, which is crucial for data recovery, audit trails, and compliance with data retention policies. This practice minimizes the risk of data loss due to accidental deletions or overwrites, thereby enhancing data integrity and resilience.
  description: This rule checks that object storage buckets in OCI have lifecycle policies that enable object versioning. Enabling versioning allows you to preserve, retrieve, and restore every version of every object stored in the bucket. To remediate, configure lifecycle policies from the OCI Console or CLI to ensure versioning is enabled, thereby maintaining historical versions of objects for recovery and auditing purposes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#overview
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/objectlifecyclepolicies.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations_benchmark_v1.0.0.pdf
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
- rule_id: oci.object_storage.bucket.object_encrypted_at_rest
  service: object_storage
  resource: bucket
  requirement: Object Encrypted At Rest
  scope: object_storage.bucket.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Object Storage Buckets Have Objects Encrypted At Rest
  rationale: Encrypting objects at rest in OCI Object Storage is crucial for protecting sensitive data from unauthorized access, ensuring compliance with data protection regulations such as GDPR, HIPAA, and PCI-DSS. Lack of encryption can lead to data breaches, resulting in financial loss and reputational damage.
  description: This rule checks if the objects within an OCI Object Storage bucket are encrypted at rest. Encryption helps safeguard stored data by converting it into a secure format that is unreadable without a decryption key. To remediate, ensure that the bucket's default encryption setting is enabled, applying server-side encryption using OCI keys or customer-managed keys from the Oracle Cloud Infrastructure Vault.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingencryption.htm
  - https://www.oracle.com/security-cloud-compliance/cis-benchmarks/
  - https://www.oracle.com/security/cloud-security/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57p1r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.object_storage.object.object_not_publicly_readable_blocked
  service: object_storage
  resource: object
  requirement: Object Not Publicly Readable Blocked
  scope: object_storage.object.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Prevent Public Read Access on OCI Object Storage Objects
  rationale: Ensuring that objects in OCI Object Storage are not publicly readable is crucial for preventing unauthorized access to sensitive data, which can lead to data breaches and compliance violations. Publicly accessible data can be exploited by malicious actors, leading to potential financial losses and damage to the organization's reputation.
  description: This rule verifies that objects stored in OCI Object Storage are not configured to allow public read access. The check involves assessing the access policies and bucket settings to ensure that they do not permit public access. If public read access is detected, it is recommended to immediately modify the bucket and object permissions to restrict access to authorized users only, using OCI Identity and Access Management (IAM) policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#publicaccess
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.object_storage.bucket.object_lock_or_immutability_enabled
  service: object_storage
  resource: bucket
  requirement: Object Lock Or Immutability Enabled
  scope: object_storage.bucket.security
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure Object Lock or Immutability is Enabled on Buckets
  rationale: Enabling object lock or immutability on Object Storage buckets ensures that data cannot be deleted or modified for a specified period. This is crucial for protecting sensitive data from accidental or malicious deletion, supports compliance with regulations such as GDPR, HIPAA, and financial services regulations, and mitigates the risk of data breaches.
  description: This rule checks if Object Storage buckets have object lock or immutability policies enabled. Object lock ensures that data within the bucket is fixed for a specified duration, preventing deletion or modification. To remediate, enable a retention policy on your bucket through the OCI Console or API. This setup is essential for workloads that require strict data retention controls.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingretentionrules.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-1-1-0.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-88/rev-1/final
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.hipaajournal.com/hipaa-compliance-guide/
- rule_id: oci.object_storage.bucket.partition_access_policies_least_privilege_required
  service: object_storage
  resource: bucket
  requirement: Partition Access Policies Least Privilege Required
  scope: object_storage.bucket.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege Access Policies for Object Storage Buckets
  rationale: Implementing least privilege access for Object Storage buckets minimizes the risk of unauthorized data access and potential data breaches. This is crucial for maintaining data confidentiality, integrity, and compliance with data protection regulations such as GDPR and CCPA.
  description: This rule checks that all access policies associated with Object Storage buckets enforce the principle of least privilege. It verifies that only necessary permissions are granted to users and services, reducing the attack surface. To remediate, review and modify access policies to ensure they are aligned with the least privilege principle, granting only the permissions necessary for specific roles.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/securitypolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/GSG/Tasks/securitypolicies.htm
  - CIS OCI Benchmark v1.0.0 - Section 3.1
  - NIST SP 800-53 - AC-6 Least Privilege
  - 'PCI-DSS Requirement 7: Restrict access'
  - ISO 27001:2013 Clause A.9.1.2 Access control policy
- rule_id: oci.object_storage.bucket.partition_catalog_encrypted
  service: object_storage
  resource: bucket
  requirement: Partition Catalog Encrypted
  scope: object_storage.bucket.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Object Storage Bucket Partition Catalog is Encrypted
  rationale: Encrypting the partition catalog in Object Storage buckets is crucial for protecting sensitive data and ensuring compliance with data protection regulations. Without encryption, unauthorized access to the partition catalog could lead to data breaches and compromise the confidentiality and integrity of the data stored within the bucket.
  description: This rule checks if the partition catalog of an Object Storage bucket in OCI is encrypted using Oracle-managed keys or customer-managed keys. To verify, inspect the bucket settings in the OCI console or use the OCI CLI to ensure encryption is enabled. Remediation involves enabling bucket encryption through the OCI console by configuring the encryption settings under the bucket details section.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm
  - https://www.oracle.com/security/cloud-security/oci-security-best-practices/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.object_storage.replication_policy.replication_auth_roles_least_privilege_required
  service: object_storage
  resource: replication_policy
  requirement: Replication Auth Roles Least Privilege Required
  scope: object_storage.replication_policy.replication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Replication Auth Roles Use Least Privilege Principle
  rationale: Using least privilege for replication roles in OCI Object Storage minimizes access to critical resources, reducing the risk of unauthorized data replication or alterations. This practice is vital for maintaining data integrity, confidentiality, and compliance with standards such as GDPR and ISO 27001, which require controlled access to sensitive data.
  description: This rule checks that the IAM policies associated with Object Storage replication policies grant only the minimum permissions necessary to perform replication tasks. Overly permissive roles can lead to potential security breaches or data leaks. To remediate, review and adjust the policies to ensure they adhere to the least privilege principle, granting only the required permissions for replication operations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingreplication.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.object_storage.bucket.replication_cross_region_encrypted
  service: object_storage
  resource: bucket
  requirement: Replication Cross Region Encrypted
  scope: object_storage.bucket.encryption
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure Cross-Region Replication for Buckets is Encrypted
  rationale: Encrypting cross-region replication traffic ensures that data is protected during transit, reducing the risk of unauthorized access. This supports compliance with regulatory frameworks, safeguards sensitive data, and mitigates potential data breaches.
  description: This rule checks if Object Storage buckets configured for cross-region replication have encryption enabled for the replicated data. To verify, ensure that the bucket replication policy specifies encryption mechanisms. Remediation involves enabling server-side encryption for replicated data by configuring the destination bucket with the appropriate encryption settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingreplication.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/securitypolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.object_storage.bucket.replication_tls_required
  service: object_storage
  resource: bucket
  requirement: Replication TLS Required
  scope: object_storage.bucket.replication
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure TLS is Enabled for Object Storage Bucket Replication
  rationale: Enforcing TLS for bucket replication in OCI Object Storage is crucial to protect sensitive data in transit from interception or tampering. This practice helps maintain data confidentiality and integrity, and is often required to meet compliance standards such as PCI-DSS and HIPAA. By ensuring encrypted communication, organizations can mitigate the risk of unauthorized access during data transfer between source and destination buckets.
  description: This rule checks that TLS (Transport Layer Security) is enforced for the replication of OCI Object Storage buckets. Verification involves ensuring that the replication policy for a bucket mandates the use of TLS for data transfers. To remediate, configure replication policies in the OCI Console to require TLS, ensuring secure data transmission between buckets. This configuration enhances data security by encrypting replication traffic.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingbuckets.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://cloudsecurityalliance.org/artifacts/cis-oci-benchmark-v1-0-0/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hipaajournal.com/hipaa-compliance-checklist/
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.object_storage.bucket.replication_lag_monitoring_alerts_enabled
  service: object_storage
  resource: bucket
  requirement: Replication Lag Monitoring Alerts Enabled
  scope: object_storage.bucket.monitoring
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Replication Lag Monitoring Alerts for Object Storage Buckets
  rationale: Monitoring replication lag in OCI Object Storage is crucial to ensure data consistency and availability in multi-region setups. Without alerts for replication delays, critical data may become inconsistent or unavailable in disaster recovery scenarios, potentially affecting business operations and compliance with data protection regulations.
  description: This rule checks whether replication lag monitoring alerts are enabled for Object Storage buckets in OCI. Ensuring these alerts are active allows timely notifications when replication lag exceeds acceptable thresholds, enabling prompt action to mitigate potential data synchronization issues. To remediate, configure monitoring rules in OCI Monitoring service to track replication metrics and set up alerts for anomalies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingreplication.htm
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v4/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.ai_anomaly_detection.detector.anomaly_alerts_enabled
  service: ai_anomaly_detection
  resource: detector
  requirement: Anomaly Alerts Enabled
  scope: ai_anomaly_detection.detector.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Anomaly Alerts are Enabled for AI Anomaly Detectors
  rationale: Enabling anomaly alerts in AI anomaly detectors is crucial for timely identification and response to unusual activities or patterns that may indicate security threats or operational issues. This helps mitigate potential business impacts such as data breaches, unauthorized access, or service disruptions. Moreover, maintaining robust alerting mechanisms supports compliance with standards like ISO 27001 and enhances overall security posture.
  description: This rule checks whether anomaly alerts are enabled for AI anomaly detectors in Oracle Cloud Infrastructure. If alerts are not configured, anomalies may go unnoticed, potentially leading to undetected security incidents. To remediate, ensure that alerting is configured for all relevant detectors, specifying appropriate thresholds and notification channels. This can be managed through the OCI Console or CLI by navigating to the AI Anomaly Detection service and reviewing alert settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ai-anomaly-detection/home.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security.html
  - https://docs.oracle.com/en-us/iaas/Content/security/overview.htm
  - https://www.oracle.com/cloud/ai/anomaly-detection/
- rule_id: oci.ai_anomaly_detection.detector.anomaly_training_data_sources_approved_enabled
  service: ai_anomaly_detection
  resource: detector
  requirement: Anomaly Training Data Sources Approved Enabled
  scope: ai_anomaly_detection.detector.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Approved Data Sources for Anomaly Detection Training
  rationale: Enabling approved data sources for anomaly detection training ensures that only vetted and secure datasets are used, minimizing risks of data breaches and ensuring compliance with privacy regulations. This practice helps maintain data integrity and protects against inadvertent exposure of sensitive information, which is crucial for maintaining trust and compliance with data protection laws.
  description: This rule checks that all anomaly detection models within OCI use only pre-approved and secure data sources for training. Approved data sources are vital for ensuring that the training data is reliable and secure, thereby enhancing the model's accuracy and security. To comply, review the data sources configured for anomaly detection and ensure they are on the approved list. Remediation involves updating the data source configuration to include only those that meet the security and compliance criteria.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ai-ad/using/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/security/overview.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://www.nist.gov/document-1553
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.apigateway.gateway.api_endpoint_authn_required
  service: apigateway
  resource: gateway
  requirement: API Endpoint Authn Required
  scope: apigateway.gateway.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure API Gateway Endpoints Require Authentication
  rationale: Requiring authentication on API endpoints is critical to prevent unauthorized access to sensitive data and services. Unauthenticated endpoints can lead to data breaches, unauthorized data manipulation, and compromise of the overall cloud environment, impacting business operations and compliance with security standards.
  description: This rule checks if API Gateway endpoints enforce authentication to restrict access to authorized users only. To verify, review the API Gateway settings and ensure that authentication mechanisms such as API keys or OAuth tokens are configured. Remediation involves setting up these authentication methods in the OCI Console under the API Gateway configuration section, ensuring that all endpoints are protected.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Concepts/apigatewayoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://cloudsecurityalliance.org/research/artifacts/security-guidance-v4/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.apigateway.gateway.api_endpoint_authz_policies_enforced
  service: apigateway
  resource: gateway
  requirement: API Endpoint Authz Policies Enforced
  scope: apigateway.gateway.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure API Gateway Enforces Endpoint Authorization Policies
  rationale: Enforcing authorization policies on API endpoints is crucial to ensure that only authenticated and authorized users can access sensitive data and services. This helps prevent unauthorized access, data breaches, and potential compliance violations with industry standards such as PCI-DSS or HIPAA. Properly configured authorization policies contribute to a robust security posture and protect business-critical applications from malicious actors.
  description: This rule checks if API Gateway endpoints in OCI have authorization policies enforced. It verifies that the policies are configured to ensure that only users with the appropriate permissions can access specific API endpoints. Remediation involves reviewing and updating API Gateway configurations to include necessary authorization policies, thereby restricting access based on predefined conditions. Ensure that the policies align with your organization's security requirements and compliance obligations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusingauthorizationpolicies.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.oracle.com/security/cloud-security/best-practices/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
- rule_id: oci.apigateway.gateway.api_endpoint_private_networking_enforced
  service: apigateway
  resource: gateway
  requirement: API Endpoint Private Networking Enforced
  scope: apigateway.gateway.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure API Gateway Endpoints Use Private Networking
  rationale: Enforcing private networking for API Gateway endpoints minimizes exposure to public internet threats, reducing the risk of unauthorized access and data breaches. It is essential for meeting compliance requirements such as PCI-DSS and ISO 27001, which mandate the protection of sensitive data through secure network configurations.
  description: This rule checks if API Gateway endpoints are configured to use private networking within Oracle Cloud Infrastructure. Verification involves ensuring that the API Gateway is associated with a private subnet and accessible only through internal networks. Remediation requires updating the API Gateway configuration to utilize a private subnet and setting appropriate security rules to restrict access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusing.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/privatesubnets.htm
  - CIS OCI Foundations Benchmark v1.2.0 - Section 6.2
  - 'NIST SP 800-53 Rev. 5 - AC-17: Remote Access'
  - 'PCI DSS v3.2.1 - Requirement 1: Install and maintain a firewall configuration to protect cardholder data'
  - 'ISO/IEC 27001:2013 - A.13: Communications Security'
- rule_id: oci.apigateway.api.api_endpoint_waf_attached
  service: apigateway
  resource: api
  requirement: API Endpoint Waf Attached
  scope: apigateway.api.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure WAF is Attached to API Endpoints in API Gateway
  rationale: Attaching a Web Application Firewall (WAF) to API endpoints helps protect against common web exploits and bots that can affect application availability, compromise security, or consume excessive resources. It is crucial for maintaining the security posture of applications exposed to the internet and ensures compliance with security frameworks like PCI-DSS and ISO 27001.
  description: This rule checks if a Web Application Firewall (WAF) is attached to API endpoints within Oracle Cloud Infrastructure's API Gateway service. The presence of a WAF provides an additional layer of security by filtering and monitoring HTTP traffic between a web application and the internet. To remediate, configure and attach a WAF to your API Gateway endpoints through the OCI Console or CLI, ensuring that security policies are correctly applied to mitigate potential threats.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusingwaf.htm
  - https://www.oracle.com/security/cloud-security/identity-and-access/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.apigateway.gateway.api_security_validation_content_type_whitelist_enforced
  service: apigateway
  resource: gateway
  requirement: API Security Validation Content Type Whitelist Enforced
  scope: apigateway.gateway.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Enforce Whitelist for API Gateway Content Types
  rationale: Enforcing a whitelist for content types in API Gateway ensures that only expected and safe data formats are processed, reducing the risk of injection attacks and data breaches. It helps maintain secure communication channels within the infrastructure, aligning with compliance standards such as PCI-DSS and ISO 27001, and supports governance by maintaining data integrity.
  description: This rule checks if an API Gateway enforces content type validation using a whitelist. Without this validation, APIs might process untrusted or malformed data, leading to potential security vulnerabilities. To remediate, configure API Gateway to only accept predefined content types, ensuring that all incoming requests adhere to expected formats. This can be managed through the API Gateway settings in the OCI Console or API Gateway policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Concepts/apigatewayoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/API/SDKDocs/apisdk.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.apigateway.gateway.api_security_validation_parameters_enabled
  service: apigateway
  resource: gateway
  requirement: API Security Validation Parameters Enabled
  scope: apigateway.gateway.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Enable API Security Validation Parameters on API Gateways
  rationale: Enabling API security validation parameters on API gateways is crucial to ensure that incoming requests are thoroughly validated against predefined security criteria. This reduces the risk of security vulnerabilities such as injection attacks and enhances compliance with standards requiring robust API security measures. It helps protect sensitive data and maintain the integrity and availability of cloud services.
  description: This rule checks if API security validation parameters are enabled on Oracle Cloud Infrastructure API Gateways. Ensuring these parameters are activated involves configuring the gateway to validate incoming requests against security best practices, such as schema validation and authentication checks. To remediate, navigate to the API Gateway settings in OCI, and ensure that security validation parameters are configured to validate request schemas, enforce authentication, and check for any anomalies in API calls.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusing.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-2-0-0-benchmark.htm
  - https://www.nist.gov/publications/nist-special-publication-800-53-revision-4-security-and-privacy-controls-federal
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/artifacts/oci-security-best-practices
- rule_id: oci.apigateway.api.api_security_validation_request_body_size_limit_configured
  service: apigateway
  resource: api
  requirement: API Security Validation Request Body Size Limit Configured
  scope: apigateway.api.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: API Request Body Size Limit Configuration in API Gateway
  rationale: Configuring the request body size limit is crucial to prevent denial-of-service (DoS) attacks that exploit large payloads to exhaust system resources. It ensures that APIs handle only appropriately sized requests, mitigating potential threats and maintaining service availability. This is essential for organizations to comply with security best practices and standards.
  description: This rule checks whether the API Gateway has a configured limit on the request body size for APIs. By setting an appropriate size limit, you can protect your APIs from large payload attacks which may lead to resource exhaustion. To remediate, ensure that each API's request body size is configured according to your organization's security policy. This can be done through the OCI Console under the API Gateway settings where you can specify the maximum payload size.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusing.htm#apigatewayusing__request_body_size_limits
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_faqs.htm
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
- rule_id: oci.apigateway.gateway.api_security_validation_request_schema_enabled
  service: apigateway
  resource: gateway
  requirement: API Security Validation Request Schema Enabled
  scope: apigateway.gateway.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure API Gateway Request Schema Validation is Enabled
  rationale: Enabling request schema validation for OCI API Gateway ensures that incoming API requests adhere to a predefined structure. This helps to prevent malformed requests that could lead to potential security vulnerabilities such as injection attacks. It also ensures compliance with data integrity standards by verifying that data being processed is in a valid format.
  description: This rule checks if schema validation is enabled for requests on OCI API Gateways. Request schema validation ensures that the incoming data matches the expected API structure, reducing the risk of processing invalid or malicious data. To remediate, configure the API Gateway to include a request validation policy with a defined schema. This can be done via the OCI console or CLI by updating the API deployment with the appropriate validation settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusing.htm
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Concepts/apigatewayoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.apigateway.gateway.api_security_validation_required_headers_enforced
  service: apigateway
  resource: gateway
  requirement: API Security Validation Required Headers Enforced
  scope: apigateway.gateway.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: API Gateway Required Headers Enforced for Security Validation
  rationale: Implementing required headers in API requests is crucial to ensure that only authenticated and authorized requests are processed. This reduces the risk of unauthorized access and potential data breaches, supporting compliance with security standards like PCI-DSS and ISO 27001 by enforcing strict access controls.
  description: This check verifies that the API Gateway enforces the presence of required headers for all incoming requests. Required headers should include authentication tokens, content type specifications, and any custom headers necessary for your application's security policies. Ensuring that these headers are properly validated helps prevent unauthorized access and data leaks. If missing, configure your API Gateway to enforce these headers by updating the gateway settings in the OCI Console or via the OCI CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/home.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_ontap.htm
  - https://www.oracle.com/security/cloud-security/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.apigateway.gateway.api_security_validation_response_schema_enabled
  service: apigateway
  resource: gateway
  requirement: API Security Validation Response Schema Enabled
  scope: apigateway.gateway.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure API Security Validation Response Schema is Enabled
  rationale: Enabling API Security Validation Response Schema ensures that responses conform to a predefined schema, reducing the risk of data leaks and enhancing the integrity of API responses. This is crucial for maintaining compliance with data protection regulations and mitigating potential security risks that could arise from malformed or malicious data being returned by APIs.
  description: This rule checks whether the API Security Validation Response Schema feature is enabled on Oracle Cloud Infrastructure API Gateway. When enabled, it validates that API responses match the defined schema, helping to prevent data exposure and improve security posture. To remediate, enable the response schema validation in the API Gateway settings. This action aligns with best practices for securing APIs and maintaining robust governance over data exchanged via APIs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusing.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam_servicepolicy.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.apigateway.api.api_security_rate_limiting_quota_limit_configured
  service: apigateway
  resource: api
  requirement: API Security Rate Limiting Quota Limit Configured
  scope: apigateway.api.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure API Gateway Rate Limiting Quota is Configured
  rationale: Configuring rate limiting quotas for APIs in Oracle Cloud Infrastructure helps prevent abuse, reduces the risk of denial-of-service attacks, and ensures fair usage across clients. It is essential for maintaining service availability and protecting backend resources from being overwhelmed by excessive requests.
  description: This rule checks if rate limiting quotas are set for APIs deployed on OCI API Gateway. Proper configuration involves setting request limits per time interval to control traffic and prevent overutilization. To remediate, configure rate limiting quotas by specifying a maximum number of requests allowed per defined period in the API Gateway settings. This ensures that your APIs remain responsive and secure against potential threats.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusing.htm#APIGateway_RateLimiting
  - https://www.oracle.com/security/cloud-security/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-44ver2.pdf
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.cisecurity.org/benchmark/oracle/
- rule_id: oci.apigateway.api.api_security_rate_limiting_stage_burst_limit_configured
  service: apigateway
  resource: api
  requirement: API Security Rate Limiting Stage Burst Limit Configured
  scope: apigateway.api.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure API Gateway Rate Limiting Stage Burst Limit is Configured
  rationale: Configuring a burst limit for API Gateway ensures that unexpected spikes in traffic do not overwhelm your backend systems, protecting them from potential downtime and ensuring consistent performance. This configuration helps in maintaining the availability and reliability of services while preventing abuse and mitigating denial-of-service attacks, aligning with compliance and governance standards.
  description: This rule checks if the burst limit is configured for each stage of your API Gateway deployments. A burst limit defines the maximum number of requests that can be sent in a short period, preventing traffic spikes from impacting service availability. To remediate, configure the burst limit in the API Gateway console under the 'Rate Limiting' settings for each deployment stage. This ensures that your APIs can handle increased load efficiently while preventing system overload.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewaymanagingrate.htm
  - https://docs.oracle.com/en-us/iaas/Content/API/Concepts/apigatewayoverview.htm
  - https://www.oracle.com/security/cloud-security/
  - 'NIST SP 800-53 Rev. 5 (AC-10: Concurrent Session Control)'
  - CIS Oracle Cloud Infrastructure Foundation Benchmark
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.apigateway.api.api_security_rate_limiting_stage_limit_configured
  service: apigateway
  resource: api
  requirement: API Security Rate Limiting Stage Limit Configured
  scope: apigateway.api.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure API Gateway Rate Limiting is Configured for APIs
  rationale: Configuring rate limiting on API Gateway stages helps prevent abuse and ensures fair usage by controlling the number of requests that can be made to an API within a given time frame. This is crucial for maintaining service availability, protecting backend systems from traffic spikes, and meeting compliance requirements related to service reliability and data protection.
  description: This rule checks whether rate limiting is configured for each stage of APIs deployed in the Oracle Cloud Infrastructure API Gateway. Proper configuration involves setting a maximum request rate, which can mitigate risks of service denial or degradation due to excessive traffic. To remediate, configure rate limiting by specifying a suitable requests-per-second value for each API stage in the OCI Console or using the OCI CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/api-gateway/doc/rate-limiting.html
  - https://docs.oracle.com/en-us/iaas/Content/API-Gateway/Tasks/apigatewayusing.htm
  - https://www.oracle.com/security-cloud/compliance/
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
- rule_id: oci.apigateway.api.api_security_rate_limiting_stage_throttle_unbounded
  service: apigateway
  resource: api
  requirement: API Security Rate Limiting Stage Throttle Unbounded
  scope: apigateway.api.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure API Gateway Rate Limiting is Configured Properly
  rationale: Rate limiting is crucial for preventing abuse and ensuring fair usage of API resources. Without proper rate limiting, APIs may be susceptible to denial-of-service attacks, leading to potential downtime and financial impacts. It also ensures compliance with corporate governance policies by controlling the flow of data.
  description: This rule checks if the API Gateway in OCI has appropriate rate limiting settings configured. Specifically, it verifies that the throttle stage is not set to unbounded, which could lead to excessive requests and potential service disruption. Proper configuration involves setting a specific throttle limit to control the number of requests per client. To remediate, configure the API Gateway's rate limiting settings through the OCI Console or API, ensuring that appropriate thresholds are set.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusing.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis.htm
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- rule_id: oci.apigateway.gateway.api_security_rate_limiting_usage_plan_keys
  service: apigateway
  resource: gateway
  requirement: API Security Rate Limiting Usage Plan Keys
  scope: apigateway.gateway.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure API Gateways Use Rate Limiting with Usage Plan Keys
  rationale: Implementing rate limiting on API gateways is crucial to protect against abuse, denial of service attacks, and to ensure fair usage of resources. It also helps in managing resource allocation efficiently, thereby maintaining system performance and reliability. Compliance with data protection and privacy standards often mandates the implementation of such security controls.
  description: This rule evaluates whether API Gateways in OCI are configured with rate limiting using usage plan keys. Rate limiting ensures that APIs are not overwhelmed with requests, which can lead to service disruptions. To comply, configure your API Gateways with usage plans that define rate limits and assign keys to clients. This can be verified by checking the gateway settings in the OCI Console under the API Gateway service and ensuring that usage plans are applied appropriately.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusingusageplans.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
- rule_id: oci.monitoring.alarm.trace_access_rbac_least_privilege_required
  service: monitoring
  resource: alarm
  requirement: Trace Access RBAC Least Privilege Required
  scope: monitoring.alarm.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Monitoring Alarms Use Least Privilege Access
  rationale: Implementing the principle of least privilege for monitoring alarms in OCI minimizes the risk of unauthorized access and potential data breaches. It ensures that only users with a legitimate need can access or modify monitoring alarms, mitigating security risks and aligning with compliance requirements like PCI-DSS and ISO 27001.
  description: This rule checks for adherence to least privilege access policies for OCI monitoring alarms. It verifies that access permissions to alarms are strictly controlled and granted based on necessity, using OCI's IAM policies. Remediation involves reviewing and adjusting IAM policies to limit access to only those roles and users with a justified need, reducing exposure to potential security threats.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.monitoring.alarm.trace_retention_days_minimum_enabled
  service: monitoring
  resource: alarm
  requirement: Trace Retention Days Minimum Enabled
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Minimum Trace Retention Days for Monitoring Alarms
  rationale: Setting a minimum retention period for trace data in alarms is crucial for effective monitoring and auditing. It helps in maintaining historical logs for security analysis, debugging, and compliance auditing. Without adequate retention, it could lead to loss of critical information needed for incident response and forensic investigations.
  description: This rule checks whether a minimum trace retention period is configured for alarms in Oracle Cloud Infrastructure Monitoring. It ensures that trace data is retained for a specified minimum number of days. To remediate, configure the alarm settings to retain trace data for at least the recommended number of days as per your compliance and operational requirements. This can be done via the OCI Console or using the CLI by adjusting the alarm's retention settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/monitoringalarms.htm
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.monitoring.alarm.trace_store_encrypted
  service: monitoring
  resource: alarm
  requirement: Trace Store Encrypted
  scope: monitoring.alarm.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Trace Store Data is Encrypted for Monitoring Alarms
  rationale: Encrypting trace store data is critical to protect sensitive information from unauthorized access and potential data breaches. This is essential for maintaining data privacy and meeting compliance requirements such as PCI-DSS, HIPAA, and ISO 27001, which mandate encryption of data at rest to safeguard against cyber threats.
  description: This rule checks that all trace data stored by OCI Monitoring alarms is encrypted using OCI's encryption standards. Verification involves ensuring that encryption is enabled for all trace store data in the Monitoring service. Remediation requires enabling OCI's built-in encryption features for the trace store, ensuring that all data at rest is securely encrypted. This can be configured through the OCI Console or CLI by setting the appropriate encryption settings on your Monitoring resources.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm#encryption
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://docs.oracle.com/en-us/iaas/Content/Compliance/Concepts/compliance.htm
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.monitoring.alarm.sampling_rule_access_rbac_least_privilege_required
  service: monitoring
  resource: alarm
  requirement: Sampling Rule Access RBAC Least Privilege Required
  scope: monitoring.alarm.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege on OCI Monitoring Alarm Sampling Rule Access
  rationale: Implementing least privilege access control for OCI Monitoring Alarm resources minimizes the risk of unauthorized access and potential misuse. This is crucial for maintaining the integrity and confidentiality of monitoring data, as well as ensuring compliance with industry standards and regulations such as NIST and ISO 27001.
  description: This rule checks that access to OCI Monitoring Alarm sampling rules is restricted to only those identities that require it to perform their job functions. It verifies the IAM policies associated with the alarm resources to ensure they adhere to the principle of least privilege. Remediation involves reviewing and modifying IAM policies to remove excessive permissions and ensure that only necessary access is granted.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.0.0/oci_cis_1.0.0.pdf
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/working-groups/cloud-controls-matrix/
- rule_id: oci.monitoring.alarm.sampling_rule_rules_enabled
  service: monitoring
  resource: alarm
  requirement: Sampling Rule Rules Enabled
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure OCI Monitoring Alarms Have Sampling Rules Enabled
  rationale: Enabling sampling rules in OCI monitoring alarms is crucial for accurate alerting, reducing noise, and ensuring that alarms are triggered only on significant events. This helps in maintaining operational efficiency and ensuring that critical events are not lost in a flood of minor alerts, thus supporting compliance with industry standards and minimizing security risks.
  description: This rule checks if sampling rules are enabled for OCI monitoring alarms. Sampling rules help in filtering and processing the data before it triggers an alarm, ensuring that only relevant and significant data points are considered. To remediate, access the OCI Console, navigate to the Monitoring service, and configure sampling rules for each alarm to optimize alerting efficiency. This ensures that only meaningful changes trigger alerts, contributing to efficient resource management and timely incident response.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/creatingalarms.htm
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations_benchmark_v1.0.0.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/privacy-framework
- rule_id: oci.monitoring.alarm.sampling_rule_storage_encrypted
  service: monitoring
  resource: alarm
  requirement: Sampling Rule Storage Encrypted
  scope: monitoring.alarm.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Alarm Sampling Rule Storage is Encrypted
  rationale: Encryption of sampling rule storage ensures that sensitive monitoring data is protected from unauthorized access. This mitigates the risk of data breaches and supports compliance with data protection regulations, enhancing trust and integrity in data management processes.
  description: This rule checks if the storage used by OCI Monitoring alarms for storing sampling rules is encrypted. Unencrypted storage of monitoring data can lead to unauthorized access and potential data leaks. To remediate, ensure that all storage associated with alarm sampling rules is encrypted using Oracle's built-in encryption capabilities. Verify encryption settings via the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - CIS OCI Foundations Benchmark
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.functions.application.secrets_security_parameter_access_rbac_least_privilege_required
  service: functions
  resource: application
  requirement: Secrets Security Parameter Access RBAC Least Privilege Required
  scope: functions.application.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Functions Accessing Secrets
  rationale: Implementing least privilege for accessing secrets in OCI Functions minimizes the risk of unauthorized access and potential data breaches. This practice is crucial for maintaining data confidentiality and integrity, and it aligns with compliance requirements like PCI-DSS and ISO 27001, which mandate strict access controls.
  description: This rule verifies that OCI Functions applications accessing secrets use the least privilege principle. It checks IAM policies to ensure that only necessary permissions are granted to function applications, reducing the attack surface. Remediation involves reviewing and adjusting IAM policies to ensure minimal necessary access while maintaining functionality.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionsaccessingsecrets.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/cloud/cloud-native/functions/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.functions.application.secrets_security_parameter_cmk_enabled
  service: functions
  resource: application
  requirement: Secrets Security Parameter CMK Enabled
  scope: functions.application.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Custom Master Key is Enabled for Function Application Secrets
  rationale: Enabling a Custom Master Key (CMK) for Oracle Cloud Infrastructure (OCI) Functions Application secrets ensures that sensitive information is encrypted using a key managed by the customer, providing enhanced control and security. This practice mitigates the risk of unauthorized data access and aligns with industry compliance requirements such as PCI-DSS and HIPAA, which mandate strong encryption for sensitive data.
  description: This rule checks if OCI Functions Applications use a Custom Master Key (CMK) for encrypting secrets. Without a CMK, secrets are encrypted using Oracle-managed keys, which may not meet specific compliance or security policy requirements. To remediate, configure the application to use a CMK by updating the secret key settings in the OCI console to specify a customer-managed key from the OCI Key Management service.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/usingkeys.htm
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionscreatingapps.htm
  - https://www.oracle.com/security/cloud-security/compliance/pci-dss/
  - https://www.oracle.com/security/cloud-security/compliance/hipaa/
  - https://www.oracle.com/security/cloud-security/compliance/iso-27001/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
- rule_id: oci.functions.application.secrets_security_parameter_secure_string_type_for_sensitive
  service: functions
  resource: application
  requirement: Secrets Security Parameter Secure String Type For Sensitive
  scope: functions.application.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure Secure String Type for Sensitive Secrets in OCI Functions
  rationale: Using secure string types for sensitive data in OCI Functions is crucial to prevent unauthorized access and data leaks. Improper handling of secrets can lead to severe security risks, including data breaches and non-compliance with regulations such as PCI-DSS and HIPAA, impacting business integrity and reputation.
  description: This rule checks that secrets used in OCI Functions applications are stored as secure strings, ensuring encryption and proper access controls are applied. Verify that sensitive information is not hardcoded or stored in plaintext within your applications. Remediation involves using OCI Vault to manage secrets, ensuring that sensitive information is encrypted and access is restricted to authorized entities only.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionscallingvaultsecrets.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam_service.htm
  - https://www.oracle.com/security/cloud-security/capabilities/secrets-management/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.audit.configuration.audit_logs_centralized_and_encrypted
  service: audit
  resource: configuration
  requirement: Audit Logs Centralized And Encrypted
  scope: audit.configuration.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure OCI Audit Logs Are Centralized and Encrypted
  rationale: Centralizing and encrypting audit logs is crucial for maintaining the integrity and confidentiality of sensitive information. It helps in detecting unauthorized activities, supports forensic investigations, and ensures compliance with legal and regulatory requirements such as GDPR, HIPAA, and PCI-DSS. Failure to secure audit logs can lead to data breaches and non-compliance penalties.
  description: This rule verifies that audit logs in Oracle Cloud Infrastructure are being centralized to a designated logging service and are encrypted both in transit and at rest. To remediate, ensure that all audit logs are directed to Oracle Cloud Logging or an equivalent centralized logging solution, with encryption enabled. Utilize OCI Vault to manage encryption keys and verify that log data is appropriately encrypted using OCI's default or customer-managed keys.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - CIS OCI Foundations Benchmark
  - NIST Special Publication 800-92 Guide to Computer Security Log Management
  - 'PCI-DSS Requirement 10: Track and monitor all access to network resources and cardholder data'
- rule_id: oci.audit.configuration.audit_retention_days_minimum_enabled
  service: audit
  resource: configuration
  requirement: Audit Retention Days Minimum Enabled
  scope: audit.configuration.audit_logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Minimum Audit Log Retention Days is Configured
  rationale: Maintaining a minimum retention period for audit logs is crucial for forensic investigations and compliance with industry regulations. Inadequate log retention can lead to insufficient data for analyzing security incidents and meeting legal requirements, potentially resulting in non-compliance penalties.
  description: This rule checks whether a minimum retention period is configured for audit logs in Oracle Cloud Infrastructure. Ensuring that audit logs are retained for an adequate period allows for effective monitoring and analysis of security events. To remediate, configure the audit log retention setting to meet or exceed the organization's compliance requirements by accessing the OCI Console and navigating to the Audit service settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/secureociservices.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.audit.configuration.config_recorder_enabled
  service: audit
  resource: configuration
  requirement: Config Recorder Enabled
  scope: audit.configuration.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Config Recorder is Enabled for OCI Audit Logs
  rationale: Enabling the Config Recorder is crucial for maintaining comprehensive audit logs, which help in tracking changes to resources and configurations. This is vital for incident response, forensic analysis, and compliance with regulatory requirements such as GDPR, PCI-DSS, and ISO 27001. Without it, unauthorized changes might go undetected, increasing the risk of security breaches.
  description: This check verifies that the Config Recorder is enabled in Oracle Cloud Infrastructure to ensure all changes to resources are logged. Config Recorder must be active to capture and store configuration changes within your OCI environment. To remediate, navigate to the OCI Console, go to the Audit service, and ensure that the Config Recorder is enabled. This will allow you to monitor configuration changes and maintain an audit trail over time.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://www.oracle.com/security-cloud/cis-benchmarks/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.audit.configuration.config_recorder_global_resource_types_tracked
  service: audit
  resource: configuration
  requirement: Config Recorder Global Resource Types Tracked
  scope: audit.configuration.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure All Global Resource Types Are Tracked by Config Recorder
  rationale: Tracking global resource types is essential for maintaining comprehensive audit trails and ensuring compliance with security and operational policies. Failure to track these resources can lead to undetected configuration changes, increasing the risk of security breaches and non-compliance with frameworks like NIST or PCI-DSS.
  description: This rule checks whether the Config Recorder in Oracle Cloud Infrastructure is configured to track all global resource types. Proper tracking ensures that any modifications to resources are logged, aiding in quick detection and response to unauthorized changes. To remediate, verify that the Config Recorder is enabled for all global resources by reviewing your audit policies and updating them as necessary to include all relevant resource types.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/securitypolicies.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmark/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.audit.configuration.delivery_channel_secure_destination_configured
  service: audit
  resource: configuration
  requirement: Delivery Channel Secure Destination Configured
  scope: audit.configuration.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Secure Configuration of Audit Log Delivery Channel
  rationale: Configuring a secure destination for audit log delivery is crucial to ensure that sensitive audit data is protected from unauthorized access and tampering. This helps in maintaining compliance with security frameworks and prevents potential data breaches that could lead to financial and reputational damage.
  description: This rule checks whether the audit log delivery channel is configured to use a secure destination, such as an Object Storage bucket with appropriate encryption and access policies in place. Verification involves checking that the bucket has server-side encryption enabled and is accessible only through secure connections. Remediation includes configuring the bucket with the necessary encryption and access policies to meet security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_approach.htm
  - CIS OCI Foundations Benchmark v1.1.0 - Section 3.1
  - NIST SP 800-53 Rev. 5 - AU-9 Protection of Audit Information
  - PCI-DSS v3.2.1 - Requirement 10.5 Secure Audit Trails
  - https://cloudsecurityalliance.org/artifacts/cloud-controls-matrix-v4/
- rule_id: oci.audit.configuration.config_delivery_secure_destination_configured
  service: audit
  resource: configuration
  requirement: Config Delivery Secure Destination Configured
  scope: audit.configuration.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Audit Log Configuration Delivery is Securely Configured
  rationale: Configuring a secure destination for audit log delivery is crucial for protecting sensitive audit data from unauthorized access and ensuring data integrity. This is important to prevent potential breaches and to comply with regulatory requirements, such as GDPR and PCI-DSS, which mandate secure logging practices.
  description: This rule checks whether the OCI Audit service has been configured to deliver logs to a secure destination, such as an Object Storage bucket with proper encryption and access controls. To verify, ensure that the Object Storage bucket for log delivery is encrypted using server-side encryption with customer-managed keys and that access policies are configured to restrict access to authorized users only. Remediation involves setting up the appropriate encryption and IAM policies on the destination bucket.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-92.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.monitoring.alarm.config_delivery_destination_access_least_privilege_required
  service: monitoring
  resource: alarm
  requirement: Config Delivery Destination Access Least Privilege Required
  scope: monitoring.alarm.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Alarm Config Delivery Uses Least Privilege Access
  rationale: Implementing least privilege access for alarm configuration delivery ensures that only necessary permissions are granted, reducing the risk of unauthorized access and potential data breaches. This is critical for maintaining the integrity of your monitoring processes and complying with security standards.
  description: This rule verifies that the IAM policies associated with alarm config delivery in OCI Monitoring are configured to grant only the permissions necessary for their function. Remediation involves reviewing and adjusting IAM policies to remove any excessive permissions. Ensure that the delivery mechanisms, such as notifications or logs, have their access restricted to only trusted entities or services.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - CIS OCI Benchmark v1.1 - 1.1 Ensure that OCI Monitoring Alarm is configured with least privilege
  - 'NIST SP 800-53 AC-6: Least Privilege'
  - 'PCI-DSS Requirement 7: Restrict access to cardholder data by business need to know'
  - 'OCI Security Best Practices: https://docs.oracle.com/en-us/iaas/Content/Security/Reference/OCI_Securitybestpractices.htm'
- rule_id: oci.monitoring.alarm.config_delivery_kms_encryption_enabled
  service: monitoring
  resource: alarm
  requirement: Config Delivery KMS Encryption Enabled
  scope: monitoring.alarm.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure KMS Encryption is Enabled for Monitoring Alarm Config Delivery
  rationale: Enabling KMS encryption for monitoring alarm configuration delivery is crucial to protect sensitive monitoring data from unauthorized access and ensure compliance with data protection regulations. Encrypting this data helps mitigate risks of data breaches and aligns with standard security practices.
  description: This rule checks if Key Management Service (KMS) encryption is enabled for the delivery of monitoring alarm configurations in Oracle Cloud Infrastructure. Without KMS encryption, alarm configuration data may be vulnerable to interception or unauthorized access. To remediate, configure your monitoring alarm to use OCI's KMS for encryption by specifying a valid encryption key during setup. This ensures that all configuration data is encrypted at rest and in transit.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_security_benchmark.htm
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.block_storage.volume_backup.monitoring_alert_destinations_enabled
  service: block_storage
  resource: volume_backup
  requirement: Monitoring Alert Destinations Enabled
  scope: block_storage.volume_backup.monitoring
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Alert Destinations are Enabled for Block Storage Volume Backups
  rationale: Enabling alert destinations for volume backups in OCI ensures that administrators receive timely notifications regarding the status and health of backup operations. This is crucial for maintaining data integrity and availability, reducing the risk of data loss, and ensuring compliance with data protection regulations.
  description: This rule checks if monitoring alert destinations are configured for block storage volume backups in Oracle Cloud Infrastructure. To verify, ensure that all volume backups have associated alert rules that notify the appropriate channels upon backup failures or anomalies. Remediation involves configuring alarm rules in OCI's Monitoring service and associating them with Notification service topics for effective alerting.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Notification/Concepts/notificationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/backingupyourdata.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.block_storage.volume_backup.monitoring_alert_rules_for_job_failures_enabled
  service: block_storage
  resource: volume_backup
  requirement: Monitoring Alert Rules For Job Failures Enabled
  scope: block_storage.volume_backup.monitoring
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Monitoring Alerts for Block Volume Backup Failures are Enabled
  rationale: Enabling monitoring alerts for block volume backup job failures is essential to ensure data availability and integrity. This practice helps in promptly identifying and addressing backup failures, reducing potential data loss and ensuring compliance with data protection regulations. It also aids in maintaining business continuity by ensuring critical data is consistently backed up.
  description: This rule checks whether alert rules are configured to monitor failures in block volume backup jobs within OCI. When these alerts are enabled, administrators are notified of any issues, allowing for timely intervention. To remediate, configure monitoring alerts in OCI Monitoring service by creating alarm rules that trigger notifications based on the status of backup jobs. This ensures that backup failures are promptly detected and addressed.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/creating-alarms.htm
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/backingupvolume.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://www.oracle.com/security/compliance/certifications/
  - https://www.oracle.com/security/cloud-security/best-practices/
- rule_id: oci.block_storage.volume_backup.monitoring_alert_rules_for_sla_breach_enabled
  service: block_storage
  resource: volume_backup
  requirement: Monitoring Alert Rules For Sla Breach Enabled
  scope: block_storage.volume_backup.monitoring
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Monitoring Alerts for SLA Breach in Volume Backups are Enabled
  rationale: Enabling monitoring alerts for SLA breaches in block storage volume backups is critical to ensure timely response to potential data availability and integrity issues. This helps maintain compliance with SLAs and prevents business disruptions due to data loss or unavailability, thus protecting organizational reputation and customer trust.
  description: This rule checks whether monitoring alerts are configured to notify administrators of SLA breaches related to block storage volume backups in Oracle Cloud Infrastructure. Proper configuration of these alerts ensures that any deviations from expected backup performance are promptly addressed. Remediation involves setting up alerts in Oracle Cloud Monitoring to track and respond to backup SLA breaches, thereby ensuring data backup operations remain within defined performance criteria.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/creatingalarm.htm
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm#security_guide_overview
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://compliance.oraclecloud.com/
- rule_id: oci.block_storage.volume.monitoring_metrics_export_enabled
  service: block_storage
  resource: volume
  requirement: Monitoring Metrics Export Enabled
  scope: block_storage.volume.monitoring
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Block Storage Volume Monitoring Metrics Are Enabled
  rationale: Enabling monitoring metrics for block storage volumes is crucial for operational visibility and security. It allows for proactive monitoring of performance and capacity issues, ensuring that any anomalies or potential failures are detected early. This practice helps in maintaining compliance with regulatory standards and supports incident response efforts.
  description: This rule checks if monitoring metrics are enabled for Oracle Cloud Infrastructure Block Storage volumes. To verify, ensure that the volumes are configured to export metrics to the OCI Monitoring service. Remediation involves enabling the export of these metrics for all relevant volumes through the OCI Console or using the OCI CLI. This ensures that critical metrics such as read/write operations and latency are tracked.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/blockvolumemetrics.htm
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://www.oracle.com/security/cloud-compliance/compliance/
  - CIS Oracle Cloud Infrastructure Foundations Benchmark
  - NIST SP 800-53 Rev. 5
  - ISO/IEC 27001:2013
- rule_id: oci.block_storage.volume.access_backup_admins_mfa_required
  service: block_storage
  resource: volume
  requirement: Access Backup Admins MFA Required
  scope: block_storage.volume.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure MFA is Enabled for Backup Admin Access to Block Storage Volumes
  rationale: Enforcing multi-factor authentication (MFA) for backup administrators accessing block storage volumes is crucial to protect sensitive data from unauthorized access. Without MFA, compromised credentials could lead to data breaches, non-compliance with industry standards, and significant business disruptions.
  description: This rule checks that all backup administrators accessing Oracle Cloud Infrastructure (OCI) block storage volumes have MFA enabled on their accounts. The absence of MFA increases the risk of unauthorized access to critical data backups. To remediate, ensure that MFA is configured and enforced for all users with backup administration permissions by using Identity and Access Management (IAM) settings in OCI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm
  - https://www.oracle.com/security/cloud-security/identity-management/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-63-2.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.block_storage.volume_backup.access_backup_keys_least_privilege_required
  service: block_storage
  resource: volume_backup
  requirement: Access Backup Keys Least Privilege Required
  scope: block_storage.volume_backup.backup_recovery
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Accessing Block Volume Backup Encryption Keys
  rationale: Ensuring least privilege access to block volume backup encryption keys is critical to minimizing unauthorized access and potential data breaches. By restricting permissions, organizations can significantly reduce the risk of data exfiltration and maintain compliance with standards like PCI-DSS and HIPAA, which mandate strict access control measures.
  description: This rule checks whether the access to block volume backup encryption keys is restricted to only those identities that absolutely require it for their function. It verifies that policies and IAM roles associated with block storage volume backups follow the principle of least privilege. Remediation involves reviewing and updating IAM policies to ensure that only necessary roles and users have access to manage or utilize these encryption keys.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_2.htm
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_philosophy.htm
- rule_id: oci.block_storage.volume_backup.access_backup_vault_rbac_least_privilege_required
  service: block_storage
  resource: volume_backup
  requirement: Access Backup Vault RBAC Least Privilege Required
  scope: block_storage.volume_backup.backup_recovery
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Backup Vault Access Uses Least Privilege RBAC
  rationale: Restricting access to backup vaults using least privilege principles minimizes security risks by preventing unauthorized access to critical data. Misconfigured permissions can lead to data breaches, loss of sensitive information, and non-compliance with regulatory standards like GDPR or HIPAA.
  description: This rule checks that only the necessary roles have access to backup vaults within OCI's Block Storage service. It ensures that permissions are granted based on job responsibilities, following the principle of least privilege. To remediate, review and update IAM policies and roles to limit access to backup vaults, ensuring only authorized users or groups have the necessary permissions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/managingvolumebackups.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
  - https://www.nist.gov/cyberframework/compliance
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.block_storage.volume_backup.access_no_public_to_backup_vault_blocked
  service: block_storage
  resource: volume_backup
  requirement: Access No Public To Backup Vault Blocked
  scope: block_storage.volume_backup.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: critical
  title: Ensure No Public Access to OCI Block Volume Backups
  rationale: Restricting public access to block volume backups is crucial to prevent unauthorized data exposure and potential data breaches. Publicly accessible backups increase the risk of sensitive data leaks, which can lead to significant financial and reputational damage. Compliance with security standards such as ISO 27001 and PCI-DSS mandates strict access controls to safeguard data integrity and confidentiality.
  description: This rule checks that OCI block volume backups are not publicly accessible by verifying the access policies associated with the backup vaults. It ensures that no public IP address or unauthorized entity can access the volume backups, thereby preventing unauthorized data retrieval. Remediation involves reviewing and updating IAM policies to restrict access to trusted identities within the organization or network. Regular audits and monitoring of access logs are recommended to maintain compliance and security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/blockvolumebackups.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - CIS OCI Benchmark
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/document_library
- rule_id: oci.block_storage.volume_backup.resilience_recovery_backup_coverage_policy_assignment_complete_enabled
  service: block_storage
  resource: volume_backup
  requirement: Resilience Recovery Backup Coverage Policy Assignment Complete Enabled
  scope: block_storage.volume_backup.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: medium
  title: Ensure Volume Backup Coverage Policy is Fully Assigned
  rationale: Ensuring that all block storage volumes have an assigned backup policy is critical for data resilience and recovery. Without a backup policy, data loss can occur in the event of a failure or disaster, impacting business continuity, regulatory compliance, and financial stability.
  description: This rule verifies that block storage volumes in OCI have a complete backup policy assigned. It checks the existence and completeness of backup policies that ensure data recovery in case of failures. To remediate, assign a comprehensive backup policy to each volume via the OCI console or API, ensuring that backups are scheduled and retained according to business requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/blockvolumebackups.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/References/bestpractices.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-34r1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.block_storage.volume_backup.resilience_recovery_backup_coverage_unprotected_assets_alerting_enabled
  service: block_storage
  resource: volume_backup
  requirement: Resilience Recovery Backup Coverage Unprotected Assets Alerting Enabled
  scope: block_storage.volume_backup.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: medium
  title: Ensure Alerting for Unprotected Block Storage Volume Backups is Enabled
  rationale: Enabling alerting for unprotected block storage volumes is crucial for ensuring that data is consistently backed up, reducing the risk of data loss due to unplanned events. This capability allows organizations to quickly identify and rectify any lapses in backup coverage, ensuring compliance with data protection policies and maintaining business continuity.
  description: This rule checks whether alerting mechanisms are enabled for block storage volumes that are not adequately covered by backups. It verifies the configuration of monitoring and alerting settings to ensure that any unprotected assets are promptly flagged. Remediation involves configuring alerts in Oracle Cloud Infrastructure's monitoring service to notify administrators of any block storage volumes that lack proper backup coverage, thus enabling timely actions to mitigate risks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/blockvolumebackups.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.oracle.com/cloud/oci-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/overview.htm
- rule_id: oci.block_storage.volume_backup.resilience_recovery_backup_health_failed_jobs_alerting_enabled
  service: block_storage
  resource: volume_backup
  requirement: Resilience Recovery Backup Health Failed Jobs Alerting Enabled
  scope: block_storage.volume_backup.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: medium
  title: Ensure Backup Health Monitoring for Block Storage Volumes is Enabled
  rationale: Enabling alerts for failed backup jobs is crucial for ensuring data resilience and availability. Without timely notifications, failed backups can go unnoticed, leading to potential data loss, non-compliance with data protection regulations, and increased recovery times in disaster scenarios.
  description: This rule checks whether alerting mechanisms are enabled for failed backup jobs of block storage volumes in OCI. Proper configuration ensures that administrators are notified immediately of any backup failures, allowing for prompt remediation actions. To enable this, configure notifications in the OCI console under the block storage service settings, ensuring that all critical backup operations are monitored for failures.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/backingupyourdata.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingnotifications.htm
  - CIS OCI Benchmark
  - NIST SP 800-53
  - ISO 27001
- rule_id: oci.block_storage.volume_backup.resilience_recovery_backup_health_job_success_enabled
  service: block_storage
  resource: volume_backup
  requirement: Resilience Recovery Backup Health Job Success Enabled
  scope: block_storage.volume_backup.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: medium
  title: Ensure Volume Backup Health Jobs are Successful for Resilience
  rationale: Maintaining successful backup health jobs for block storage volumes is crucial to ensure data resilience and recoverability in case of failures. Inadequate backup practices can lead to data loss, impacting business continuity, and may also violate compliance with standards like PCI-DSS and ISO 27001, which require regular data backup and recovery processes.
  description: This rule checks whether the backup health jobs for block storage volumes are successfully completed. It verifies that the backup operations are scheduled and executed without errors, ensuring the recoverability of data. To remediate issues, ensure that the backup schedules are properly configured and monitor their status regularly through the OCI console or relevant APIs. Troubleshoot and resolve any errors in the job logs to maintain backup integrity.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/blockvolumebackups.htm
  - https://www.oracle.com/security-cloud-compliance/cis-oci-benchmark/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-34r1.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/bestpractices.htm
- rule_id: oci.block_storage.volume_backup.resilience_recovery_backup_health_last_recency_enabled
  service: block_storage
  resource: volume_backup
  requirement: Resilience Recovery Backup Health Last Recency Enabled
  scope: block_storage.volume_backup.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: medium
  title: Ensure Volume Backup Recency is Monitored for Recovery Resilience
  rationale: Monitoring the recency of block storage volume backups is crucial for ensuring data recovery capabilities. Without recent backups, data loss risks increase, impacting business continuity and potentially leading to non-compliance with data protection regulations. This practice mitigates the risk of extended downtime and data loss during recovery scenarios.
  description: This rule checks that the recency of block storage volume backups is actively monitored in Oracle Cloud Infrastructure. It ensures that backups are being performed at regular intervals and are up-to-date, which is vital for data recovery processes. Remediation involves implementing automated backup schedules and using OCI monitoring tools to verify the health and recency of backups.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/blockvolumebackups.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - 'NIST Special Publication 800-34: Contingency Planning Guide for Information Technology Systems'
  - ISO/IEC 27001:2013 Information Security Management Systems
- rule_id: oci.block_storage.volume_backup.resilience_recovery_backup_inventory_resource_discovery_synced_enabled
  service: block_storage
  resource: volume_backup
  requirement: Resilience Recovery Backup Inventory Resource Discovery Synced Enabled
  scope: block_storage.volume_backup.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: medium
  title: Ensure Volume Backup Inventory Sync for Resilience and Recovery
  rationale: Enabling synchronized discovery of block storage volume backups ensures that all backup resources are accounted for and can be efficiently managed, reducing the risk of data loss. This is crucial for maintaining data integrity and availability, especially in disaster recovery scenarios. By ensuring backups are consistently tracked, organizations can comply with regulatory requirements and internal policies regarding data protection and management.
  description: This rule verifies that the inventory discovery of block storage volume backups is synchronized to maintain an accurate and up-to-date record of all backup resources. It checks whether the backup inventory is set to automatically update, ensuring that any changes to backup configurations are promptly reflected in the resource management system. To remediate, configure the volume backup settings in OCI to enable automatic resource discovery and synchronization. This can be done through the OCI Console or API by setting the appropriate parameters in the backup configuration.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/blockvolumebackups.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - CIS OCI Foundations Benchmark v1.1.0
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.block_storage.volume.volume_cmk_enabled
  service: block_storage
  resource: volume
  requirement: Volume CMK Enabled
  scope: block_storage.volume.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Block Volumes are Encrypted with Customer-Managed Keys
  rationale: Encrypting block storage volumes with Customer-Managed Keys (CMK) enhances data protection by giving control over encryption keys to the customer. This mitigates risks of unauthorized data access, meeting compliance requirements such as PCI-DSS and HIPAA, and ensuring that sensitive data is protected against breaches.
  description: This rule checks if Oracle Cloud Infrastructure block storage volumes are encrypted using Customer-Managed Keys (CMK) rather than Oracle-managed keys. By employing CMK, organizations can manage the lifecycle and rotation of their encryption keys, providing an additional layer of security. To remediate this issue, configure the volume to use CMKs in the OCI console or via API, ensuring compliance with internal and regulatory data protection policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/keyoverview.htm
  - https://www.oracle.com/security/cloud-security/cspm/
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.block_storage.volume.volume_encryption_enabled
  service: block_storage
  resource: volume
  requirement: Volume Encryption Enabled
  scope: block_storage.volume.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Block Storage Volumes are Encrypted
  rationale: Encrypting block storage volumes is crucial for protecting data at rest, mitigating risks of unauthorized access, and ensuring compliance with data privacy regulations such as PCI-DSS and HIPAA. Unencrypted data can lead to data breaches, resulting in financial loss and reputational damage.
  description: This rule verifies that all block storage volumes in Oracle Cloud Infrastructure have encryption enabled. Encryption should be configured to use OCI's managed keys or customer-managed keys for enhanced security. If any volume is found to be unencrypted, it should be updated to enable encryption to protect sensitive data.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/blockvolumesoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/encryptingavolume.htm
  - https://www.oracle.com/security/cloud-compliance/
  - CIS OCI Foundations Benchmark
  - NIST SP 800-53
  - PCI-DSS Requirement 3
- rule_id: oci.block_storage.volume.volume_snapshots_encrypted
  service: block_storage
  resource: volume
  requirement: Volume Snapshots Encrypted
  scope: block_storage.volume.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Block Volume Snapshots are Encrypted
  rationale: Encrypting volume snapshots is essential to protect sensitive data at rest from unauthorized access and potential data breaches, thereby safeguarding business operations and maintaining compliance with data protection regulations such as GDPR and HIPAA. Unencrypted snapshots may expose critical data to malicious actors if accessed inappropriately.
  description: This rule checks if all block volume snapshots in your OCI environment are encrypted using Oracle-managed keys or customer-managed keys through the Oracle Cloud Infrastructure Key Management service. To remediate, ensure that encryption is enabled for all snapshots by default. Utilize the encryption settings in the OCI console to configure snapshots to use encryption, thus enhancing the security and compliance posture of your cloud environment.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/encryptingvolumes.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/blockvolumebackups.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-111.pdf
- rule_id: oci.block_storage.volume.disk_cmk_enabled
  service: block_storage
  resource: volume
  requirement: Disk CMK Enabled
  scope: block_storage.volume.security
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure Block Storage Volumes Use Customer-Managed Keys (CMKs)
  rationale: Enabling encryption with Customer-Managed Keys (CMKs) on block storage volumes enhances data security by allowing organizations to maintain control over key management. This practice mitigates the risk of unauthorized data access and is crucial for meeting compliance requirements such as PCI-DSS and HIPAA.
  description: This rule verifies that all block storage volumes in your OCI environment are encrypted using Customer-Managed Keys (CMKs) rather than Oracle-managed keys. To ensure compliance, review your volumes and configure them to use CMKs for encryption by creating a new key in the OCI Vault and applying it to the desired volumes. This setup provides increased control and flexibility over encryption policies and key rotation.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/encryptingavolume.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org
  - https://www.hhs.gov/hipaa
- rule_id: oci.block_storage.volume.disk_encryption_enabled
  service: block_storage
  resource: volume
  requirement: Disk Encryption Enabled
  scope: block_storage.volume.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Block Storage Volumes Have Disk Encryption Enabled
  rationale: Enabling disk encryption on block storage volumes is crucial for protecting sensitive data at rest from unauthorized access, ensuring data confidentiality and compliance with data protection regulations such as GDPR and HIPAA. Without encryption, data is vulnerable to breaches, which can result in significant financial and reputational damage.
  description: This rule checks if encryption is enabled on Oracle Cloud Infrastructure block storage volumes. Disk encryption helps protect data at rest by using encryption keys that are managed by OCI. To remediate, ensure that all existing and new block storage volumes have the 'Encrypt this volume' option enabled during creation or update. This can be verified through the OCI console or using the OCI CLI by checking the encryption status of each volume.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/iam_security.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.block_storage.volume.disk_snapshots_encrypted
  service: block_storage
  resource: volume
  requirement: Disk Snapshots Encrypted
  scope: block_storage.volume.encryption
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure Block Storage Volume Snapshots are Encrypted
  rationale: Encrypting disk snapshots helps protect sensitive data at rest from unauthorized access and potential breaches. It is a critical measure for adhering to compliance standards such as PCI-DSS and ISO 27001, and it minimizes risk in the event of data exposure.
  description: This rule checks that all OCI Block Storage volume snapshots are encrypted using Oracle-managed keys or customer-managed keys. Encryption ensures that data is secure and unreadable by unauthorized users. To remediate, ensure that when creating snapshots, encryption is enabled, and consider using customer-managed keys for added control over encryption policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/encryptingvolumesandsnapshots.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/best-practices/
- rule_id: oci.block_storage.volume_backup.disk_snapshots_not_public_blocked
  service: block_storage
  resource: volume_backup
  requirement: Disk Snapshots Not Public Blocked
  scope: block_storage.volume_backup.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: critical
  title: Ensure Block Storage Volume Backups Are Not Publicly Accessible
  rationale: Public exposure of disk snapshots can lead to unauthorized access to sensitive data. This poses significant security risks including data breaches, non-compliance with data protection regulations, and potential financial and reputational damage to the organization. Ensuring snapshots are not publicly accessible is crucial for maintaining data confidentiality and integrity.
  description: This rule checks if any block storage volume backups are configured to be publicly accessible. Publicly accessible snapshots can be exploited by unauthorized users, potentially leading to data leaks. To remediate, review the OCI Block Storage settings and ensure that all volume backups are set to private access only, utilizing appropriate IAM policies to restrict access to authorized users and groups.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/blockvolumebackups.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm
  - https://www.oracle.com/security/cloud-security/
  - https://www.nist.gov/cyberframework
- rule_id: oci.identity.user.budget_alert_destinations_enabled
  service: identity
  resource: user
  requirement: Budget Alert Destinations Enabled
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Users Have Budget Alert Destinations Enabled
  rationale: Enabling budget alert destinations for users is crucial to maintain financial governance and prevent unexpected cost overruns in OCI. Without this, users may not be promptly notified of reaching or exceeding budget limits, leading to financial risks and potential non-compliance with budgetary controls.
  description: This rule checks if users have specified destinations for budget alerts in OCI. This involves verifying that email addresses or other supported notification channels are configured for receiving budget alerts. If not configured, users should update their budget settings to include at least one alert destination to ensure timely notifications of budget thresholds being approached or exceeded.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Billing/Concepts/budgetsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Billing/Tasks/managingbudgets.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v4/
  - https://www.oracle.com/security/cloud-security/best-practices/
- rule_id: oci.identity.user.budget_alert_thresholds_enabled
  service: identity
  resource: user
  requirement: Budget Alert Thresholds Enabled
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Budget Alert Thresholds are Enabled for Users
  rationale: Enabling budget alert thresholds for users ensures that organizations can monitor and control their cloud spending, reducing the risk of unexpected costs. It enhances financial governance and aligns with cost management best practices, which is crucial for maintaining budgetary discipline and preventing financial risk.
  description: This check verifies that budget alert thresholds are enabled for users in Oracle Cloud Infrastructure. By setting up budget alerts, users receive notifications when spending reaches certain percentages of their budget, allowing proactive management of cloud costs. If thresholds are not enabled, it is recommended to configure them through the OCI Console under the 'Budgets' section, ensuring that appropriate alert levels are set to notify responsible parties when spending limits are approached or exceeded.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Billing/Concepts/budgetsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/cloud/cost-management/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.identity.user.budget_budgets_defined_for_accounts_or_projects_required
  service: identity
  resource: user
  requirement: Budget Budgets Defined For Accounts Or Projects Required
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Budgets are Defined for OCI User Accounts or Projects
  rationale: Defining budgets for user accounts or projects in OCI helps manage costs and prevent unexpected charges. This practice enhances financial governance and ensures alignment with financial constraints or project funding. It also mitigates the risk of overspending, which can have significant business implications and affect profitability.
  description: This rule checks whether budgets have been defined for each user account or project within OCI. By setting budgets, administrators can monitor and control spending on resources, maintaining financial discipline. To remediate, access the OCI Console, navigate to the 'Budgets' section under the 'Cost Management' menu, and create a budget for the relevant account or project. Configure alerts to notify stakeholders when spending approaches budget limits.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Billing/Concepts/budgetsoverview.htm
  - https://www.oracle.com/cloud/cost-management/budgets/
  - https://docs.oracle.com/en-us/iaas/Content/security/secure-home.htm
  - NIST SP 800-53 Rev. 5
  - CIS Oracle Cloud Infrastructure Foundation Benchmark
  - ISO/IEC 27001:2013
- rule_id: oci.identity.user.budget_modify_permissions_restricted
  service: identity
  resource: user
  requirement: Budget Modify Permissions Restricted
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict User Permissions for Modifying Budgets
  rationale: Allowing excessive permissions to modify budgets can lead to unauthorized changes, impacting financial planning and resource allocation. Restricting such permissions is critical to maintain control over cloud spending and ensure compliance with financial governance policies.
  description: This rule checks if users have been granted permissions to modify budgets beyond their intended scope. The rule verifies that only designated financial administrators have the necessary permissions to alter budget settings. If unauthorized access is detected, it recommends revoking such permissions and ensuring that IAM policies are correctly defined to limit budget modification capabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Billing/Concepts/budgetsoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.edge_services.distribution.cdn_access_logging_enabled
  service: edge_services
  resource: distribution
  requirement: Cdn Access Logging Enabled
  scope: edge_services.distribution.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure CDN Access Logging is Enabled for Distributions
  rationale: Enabling CDN access logging for Oracle Cloud Infrastructure distributions provides critical visibility into content delivery activities. This is important for monitoring access patterns, identifying security incidents, and meeting compliance requirements by maintaining an audit trail of distribution access, which can help in forensic investigations and ensuring adherence to data protection regulations.
  description: This rule checks whether CDN access logging is enabled for all distributions in Oracle Cloud Infrastructure. Access logs should be configured to capture detailed information about requests processed by the CDN, such as request time, IP address, and status codes. Remediation involves enabling access logging through the OCI Console or CLI, ensuring logs are directed to an OCI Object Storage bucket for further analysis and retention.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CDN/Tasks/cdnconfiguringlogs.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/OCI_Logging_Security.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-92.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
- rule_id: oci.edge_services.distribution.cdn_cache_key_excludes_sensitive_headers
  service: edge_services
  resource: distribution
  requirement: Cdn Cache Key Excludes Sensitive Headers
  scope: edge_services.distribution.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure CDN Cache Keys Exclude Sensitive Headers
  rationale: Excluding sensitive headers from CDN cache keys is crucial to prevent the unintentional exposure of sensitive information such as authentication tokens or personal data. This practice mitigates security risks associated with data breaches and ensures compliance with privacy regulations like GDPR and CCPA.
  description: This rule verifies that sensitive headers are not included in the cache keys used by the OCI Content Delivery Network (CDN). Including sensitive headers in cache keys can lead to unauthorized access to protected data upon cache retrieval. To remediate, configure the CDN to explicitly exclude headers that contain sensitive information from cache keys in the OCI console or via API.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CDN/Tasks/cdnusing.htm
  - https://cloudsecurityalliance.org/research/artifacts/oci-security-best-practices
  - https://www.oracle.com/cloud/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-122.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.edge_services.distribution.cdn_cache_key_minimal_query_and_cookie_variants
  service: edge_services
  resource: distribution
  requirement: Cdn Cache Key Minimal Query And Cookie Variants
  scope: edge_services.distribution.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Minimize Query and Cookie Variants in CDN Cache Key
  rationale: Ensuring a minimal set of query and cookie variants in CDN cache keys is crucial for optimizing cache efficiency and reducing potential attack vectors. Excessive variation in cache keys can lead to cache fragmentation, resulting in performance degradation and increased costs. From a security standpoint, it also reduces the risk of exposing sensitive information through query strings and cookies in cache keys.
  description: This rule checks that the CDN distribution in OCI uses a minimal set of query parameters and cookies for cache key variants. By limiting these variants, you can improve cache utilization and security. If variants are unnecessary, they should be removed to enhance the overall performance and security posture of the application. Remediation involves configuring the CDN settings to include only essential query parameters and cookies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CDN/Tasks/cdnconfiguringcache.htm
  - https://www.oracle.com/cloud/cis-oci-foundations-benchmark-1-1-0/
  - https://www.pcisecuritystandards.org/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.sans.org/security-resources/
- rule_id: oci.edge_services.distribution.cdn_hsts_enabled
  service: edge_services
  resource: distribution
  requirement: Cdn Hsts Enabled
  scope: edge_services.distribution.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure CDN HSTS is Enabled for Secure Content Delivery
  rationale: Enabling HTTP Strict Transport Security (HSTS) on CDN distributions ensures that all communications between clients and your distribution are encrypted, preventing man-in-the-middle attacks and eavesdropping. This is crucial for maintaining the confidentiality and integrity of sensitive data, aligning with compliance requirements like PCI-DSS and SOC2.
  description: This rule checks whether HSTS is enabled on OCI Edge Services CDN distributions. HSTS forces browsers to interact with the service over HTTPS, reducing the risk of session hijacking. To remediate, ensure that the 'Strict-Transport-Security' header is configured on your CDN distribution, specifying the max-age directive and optionally including the 'includeSubDomains' directive for comprehensive protection.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CDN/Tasks/cdnusing.htm#using-header
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
- rule_id: oci.edge_services.distribution.cdn_https_only_viewer_protocol
  service: edge_services
  resource: distribution
  requirement: Cdn HTTPS Only Viewer Protocol
  scope: edge_services.distribution.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure HTTPS Only Viewer Protocol for OCI CDN Distributions
  rationale: Enforcing HTTPS for CDN distributions ensures secure data transmission, protecting against man-in-the-middle attacks and data breaches. It is essential for maintaining data integrity and confidentiality, which are critical for compliance with standards such as PCI-DSS and GDPR.
  description: This rule checks whether the HTTPS-only viewer protocol is enabled for Oracle Cloud Infrastructure CDN distributions. Enabling HTTPS ensures that all data between the client and the CDN is encrypted, safeguarding sensitive information. To remediate, configure the CDN distribution to only accept HTTPS connections, ensuring TLS encryption is consistently applied.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CDN/Concepts/cdnoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-security-best-practices.htm
  - https://www.oracle.com/security/cloud-security/cspm/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.edge_services.distribution.cdn_origin_access_restricted_restricted
  service: edge_services
  resource: distribution
  requirement: Cdn Origin Access Restricted Restricted
  scope: edge_services.distribution.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure CDN Origin Access is Restricted for Distributions
  rationale: Restricting access to CDN origins is crucial to prevent unauthorized access and potential data breaches. By ensuring that only specific, trusted sources can access your CDN origins, you mitigate security risks such as data exfiltration and service disruptions, while aligning with compliance standards like PCI-DSS and ISO 27001.
  description: This rule checks if the CDN distribution's origin access is restricted to specific IP addresses or security groups. To verify, review the access control settings on your CDN distribution in OCI and ensure that only authorized entities are allowed. Remediation involves configuring the CDN to restrict origin access by using OCI's security features such as Network Security Groups or Access Control Lists.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/EdgeServices/Concepts/edgedistributions.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.oracle.com/security/best-practices/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.edge_services.distribution.cdn_signed_urls_or_headers_required_content
  service: edge_services
  resource: distribution
  requirement: Cdn Signed Urls Or Headers Required Content
  scope: edge_services.distribution.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Enforce CDN Signed URLs or Headers for OCI Distributions
  rationale: Requiring CDN signed URLs or headers ensures that only authorized users can access content distributed via OCI, reducing the risk of unauthorized access and data exposure. This practice helps in maintaining data integrity and compliance with security regulations by providing controlled access mechanisms.
  description: This rule checks whether CDN signed URLs or headers are enforced for OCI distributions. Ensuring that CDN distributions require signed URLs or headers involves configuring the distribution settings to validate incoming requests. Remediation involves updating the CDN configuration to enforce signed access, which can be done through the OCI console by enabling the appropriate settings under distribution security options.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/EdgeServices/Concepts/edgeoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/EdgeServices/Tasks/usingcdn.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://cloud.oracle.com/security-pci-compliance
  - https://cloud.oracle.com/architecture/secure-best-practices
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.edge_services.distribution.cdn_tls_min_1_2_enforced
  service: edge_services
  resource: distribution
  requirement: Cdn TLS Min 1 2 Enforced
  scope: edge_services.distribution.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure CDN Uses TLS 1.2 or Higher for Secure Connections
  rationale: Enforcing a minimum TLS version of 1.2 for CDN connections is crucial for maintaining the confidentiality and integrity of data in transit. Older versions of TLS are susceptible to vulnerabilities that can lead to data breaches, potentially violating compliance standards like PCI-DSS and putting sensitive customer information at risk. Adhering to this requirement helps protect against man-in-the-middle attacks and ensures alignment with industry best practices.
  description: This rule verifies that all Oracle Cloud Infrastructure CDN distributions enforce a minimum TLS version of 1.2. TLS 1.2 and higher provide stronger encryption and improved security features compared to earlier versions. Administrators should configure their CDN settings to disallow any TLS versions lower than 1.2. Remediation involves updating the CDN configuration in the OCI console to enforce the minimum TLS version and monitoring changes to ensure compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CDN/Tasks/cdnusingconsole.htm#Configuring_CDN_Endpoint_Security
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-52r2.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.edge_services.distribution.cdn_valid_trusted_certificate_attached
  service: edge_services
  resource: distribution
  requirement: Cdn Valid Trusted Certificate Attached
  scope: edge_services.distribution.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Valid Trusted Certificate is Attached to CDN Distribution
  rationale: Attaching a valid and trusted certificate to your CDN distribution ensures secure data transmission, protecting sensitive information from interception or tampering. This practice is important for maintaining the integrity and confidentiality of data, and is often required to comply with data protection regulations like GDPR and PCI-DSS.
  description: This rule checks if a valid, trusted SSL/TLS certificate is attached to Oracle Cloud Infrastructure's Content Delivery Network (CDN) distributions. A valid certificate ensures that the data exchanged between the client and the CDN is encrypted. To remediate this, attach a certificate from a trusted Certificate Authority (CA) to the CDN distribution. Ensure the certificate is up-to-date and not expired to maintain continuous secure connections.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/EdgeServices/Tasks/managingdomains.htm#managingdomains
  - https://www.oracle.com/security/cloud-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_platform/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.edge_services.distribution.cdn_waf_web_acl_attached
  service: edge_services
  resource: distribution
  requirement: Cdn Waf Web ACL Attached
  scope: edge_services.distribution.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Web ACL is Attached to CDN Distribution
  rationale: Attaching a Web Application Firewall (WAF) to a Content Delivery Network (CDN) distribution helps protect applications from common web exploits, improving security posture and maintaining compliance with security standards. It mitigates risks such as injection attacks, cross-site scripting, and other vulnerabilities by filtering malicious traffic.
  description: This rule checks if a Web Application Firewall (WAF) is configured and attached to a CDN distribution in Oracle Cloud Infrastructure. Without a WAF, the CDN distribution is exposed to potential security threats, which can lead to data breaches and service disruptions. To remediate, ensure that a Web ACL is created and associated with your CDN distribution to enable filtering of malicious requests.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/EdgeServices/Tasks/managingwafs.htm
  - https://docs.oracle.com/en-us/iaas/Content/EdgeServices/Concepts/edgeoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
- rule_id: oci.edge_services.distribution.cache_policy_allowlists_minimal_query_headers_cookies
  service: edge_services
  resource: distribution
  requirement: Cache Policy Allowlists Minimal Query Headers Cookies
  scope: edge_services.distribution.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Minimal Query Headers and Cookies in Cache Policy Allowlists
  rationale: Properly configuring cache policy allowlists to include only essential query headers and cookies reduces the risk of exposing sensitive data and improves cache efficiency. This safeguards against data leaks and ensures compliance with security standards, ultimately protecting business interests and customer trust.
  description: This rule verifies that cache policies for OCI edge services are configured to allow only minimal and necessary query headers and cookies. Excessive or sensitive data in headers and cookies can lead to security vulnerabilities and cache inefficiencies. Remediation involves reviewing and updating cache policies to limit the allowlists to essential components, ensuring sensitive information is not unnecessarily exposed or cached.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/EdgeServices/Tasks/edgecaching.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.edge_services.distribution.cache_policy_no_sensitive_headers_cached
  service: edge_services
  resource: distribution
  requirement: Cache Policy No Sensitive Headers Cached
  scope: edge_services.distribution.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Sensitive Headers Are Not Cached in Edge Services
  rationale: Caching sensitive headers in edge services can expose confidential information, leading to unauthorized access or data breaches. This is crucial for maintaining the integrity and confidentiality of sensitive data, aligning with compliance requirements such as PCI-DSS and HIPAA.
  description: This rule verifies that cache policies in OCI edge services distributions do not allow sensitive headers to be stored in caches. Administrators should configure cache rules to exclude headers containing personal or confidential information. This can be done by modifying the cache key settings to ensure sensitive headers are not included. Regular audits and updates to the cache policy are recommended to maintain security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/EdgeServices/Tasks/edgeseccacheconfig.htm
  - https://docs.oracle.com/en-us/iaas/Content/EdgeServices/Concepts/edgeoverview.htm
  - https://www.oracle.com/security/cloud-security.html
  - CIS OCI Foundations Benchmark
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/index.html
- rule_id: oci.edge_services.distribution.cache_policy_respects_control_no_store_private_enforced
  service: edge_services
  resource: distribution
  requirement: Cache Policy Respects Control No Store Private Enforced
  scope: edge_services.distribution.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Cache Policy Complies with No-Store for Private Data
  rationale: Implementing a cache policy that respects the 'no-store' directive for private data is crucial to prevent unauthorized access to sensitive information. This practice mitigates the risk of data breaches and aligns with data privacy regulations, ensuring that private data is not inadvertently cached and exposed through edge services.
  description: This rule checks if the cache policy for edge distribution services respects the 'no-store' directive for private data, ensuring that such data is not stored in the cache. To verify compliance, inspect the cache policy settings in your OCI console under Edge Services > Distributions, and confirm that the 'no-store' option is enforced for any private data. Remediation involves updating cache settings to incorporate 'no-store' directives for private data, preventing its caching and potential unauthorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/EdgeServices/Tasks/edge_usingdistributions.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.oracle.com/cloud/cloud-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.certificates.certificate.secrets_security_certificate_key_length_minimum
  service: certificates
  resource: certificate
  requirement: Secrets Security Certificate Key Length Minimum
  scope: certificates.certificate.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure Minimum Key Length for OCI Certificate Secrets
  rationale: Using certificates with insufficient key length can lead to vulnerabilities where attackers may decrypt sensitive data, leading to potential data breaches. This requirement helps maintain compliance with industry standards and reduces the risk of compromised data integrity and confidentiality.
  description: This rule checks that all certificates in OCI have a minimum key length of 2048 bits. Certificates with shorter key lengths are more susceptible to brute-force attacks and may not comply with security standards. To remediate, ensure that any certificate generated or imported into OCI meets the minimum key length requirement. This can be managed through the OCI Console or CLI by specifying the appropriate key length during creation or renewal.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Certificates/Concepts/certificatedetails.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_v1_1.htm
  - https://www.nist.gov/news-events/news/2020/01/nist-releases-draft-recommendations-minimum-key-lengths
  - https://www.pcisecuritystandards.org/ssl-replacement
  - https://www.iso.org/standard/54534.html
  - https://www.oracle.com/security-best-practices
- rule_id: oci.certificates.certificate.secrets_security_certificate_not_expired
  service: certificates
  resource: certificate
  requirement: Secrets Security Certificate Not Expired
  scope: certificates.certificate.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure OCI Certificates Are Valid and Not Expired
  rationale: Expired certificates can lead to service disruptions, unauthorized access, and non-compliance with security standards. Ensuring certificates are valid is crucial for maintaining encrypted communications and trust between systems, thereby protecting sensitive data and maintaining operational integrity.
  description: This rule checks if any certificates managed in Oracle Cloud Infrastructure are expired. An expired certificate means that the public key associated with it can no longer be trusted for secure communication. To remediate, regularly review certificate expiration dates and renew certificates before they expire. Utilize OCI's Certificate Management Service to automate renewal processes and ensure continuous security compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Certificates/overview.htm
  - https://docs.oracle.com/en-us/iaas/tools/cis-oracle-cloud-infrastructure-foundations-benchmark.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.isaca.org/resources/cobit
- rule_id: oci.certificates.certificate.secrets_security_certificate_trusted_issuer
  service: certificates
  resource: certificate
  requirement: Secrets Security Certificate Trusted Issuer
  scope: certificates.certificate.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure Certificates Have Trusted Issuers in OCI
  rationale: Using a certificate from a trusted issuer ensures the authenticity and integrity of secure communications. Untrusted issuers could lead to man-in-the-middle attacks, compromising sensitive data and leading to potential data breaches and non-compliance with security standards.
  description: This rule checks that all certificates used within OCI are issued by a trusted Certificate Authority (CA). It verifies the issuer's trust level to ensure secure communications. To remediate non-compliant certificates, replace them with ones issued by a recognized and trusted CA. Confirm the issuer's presence in the OCI Certificate Store to maintain security and compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Certificates/Concepts/certificatemanagement.htm
  - https://docs.oracle.com/en-us/iaas/Content/security/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.certificates.certificate_authority.secrets_security_private_ca_access_rbac_required
  service: certificates
  resource: certificate_authority
  requirement: Secrets Security Private Ca Access RBAC Required
  scope: certificates.certificate_authority.private_networking
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure RBAC for Private CA Access to Protect Secrets
  rationale: Restricting access to Certificate Authorities (CAs) using Role-Based Access Control (RBAC) is crucial to prevent unauthorized access and potential breaches of sensitive certificate data. Misconfigured permissions could lead to unauthorized issuance or revocation of certificates, impacting the integrity and trust of secure communications. Ensuring proper RBAC helps maintain compliance with security frameworks and reduces the risk of data exposure.
  description: This rule checks if RBAC policies are in place for accessing private CAs within OCI. It verifies that only authorized users and roles can manage CA-related secrets, which include creating, managing, or revoking certificates. To remediate, review and update identity and access management (IAM) policies to enforce strict RBAC, ensuring that permissions are granted based on the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Certificates/Concepts/overview.htm
  - https://www.oracle.com/security/cloud-security/certifications/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.nist.gov/cyberframework
  - https://cloudsecurityalliance.org/research/artifacts/security-guidance-v4/
- rule_id: oci.certificates.certificate_authority.secrets_security_private_ca_key_in_enforced
  service: certificates
  resource: certificate_authority
  requirement: Secrets Security Private Ca Key In Enforced
  scope: certificates.certificate_authority.private_networking
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure Private CA Key is Stored in OCI Vault with Secrets Security Enforced
  rationale: Storing the private key of a Certificate Authority (CA) securely is crucial to maintaining the integrity and trust of your encryption and identity management processes. If the CA private key is compromised, all certificates issued by that CA can be considered untrustworthy, leading to potential data breaches and loss of customer trust. Compliance with security standards such as PCI-DSS and ISO 27001 also requires secure management of cryptographic keys.
  description: This rule checks whether the private key of a Certificate Authority within OCI is stored using OCI Vault with secrets security enforcement in place. It ensures that the CA private key is protected by OCI's robust key management infrastructure, reducing the risk of unauthorized access. Remediation involves migrating the CA key to an OCI Vault, enabling secrets management features, and enforcing appropriate access policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/usingvault.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_certifications.htm
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r4.pdf
- rule_id: oci.certificates.certificate_authority.secrets_security_private_ca_crl_or_enforced
  service: certificates
  resource: certificate_authority
  requirement: Secrets Security Private Ca Crl Or Enforced
  scope: certificates.certificate_authority.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: high
  title: Ensure Certificate Authority CRL or Enforcement is Configured
  rationale: Proper configuration of Certificate Revocation Lists (CRLs) or enforcement mechanisms for private Certificate Authorities (CAs) is crucial to prevent the use of compromised certificates, which can lead to unauthorized access or data breaches. This is essential for maintaining the integrity and trustworthiness of encrypted communications and is aligned with compliance requirements for data protection and risk management.
  description: This rule checks if an OCI Certificate Authority is configured with a Certificate Revocation List (CRL) or has revocation enforcement enabled. A CRL ensures that compromised or expired certificates are not used, while enforcement mechanisms can automatically validate certificate status. To remediate, ensure that CRLs are regularly updated and configured or activate revocation enforcement within the OCI Console under the Certificates service.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Certificates/Concepts/certificatesoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm
  - https://www.oracle.com/security/cloud-security/
  - CIS OCI Foundations Benchmark
  - NIST SP 800-53
  - ISO/IEC 27001:2013
- rule_id: oci.certificates.certificate_authority.secrets_security_private_ca_path_length_enforced
  service: certificates
  resource: certificate_authority
  requirement: Secrets Security Private Ca Path Length Enforced
  scope: certificates.certificate_authority.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: high
  title: Ensure Private CA Path Length is Enforced for Certificate Authorities
  rationale: Enforcing a path length constraint on certificate authorities (CAs) is crucial to prevent overly long and complex certificate chains that can increase the risk of misconfigurations and vulnerabilities. A shorter and well-defined certificate chain improves the security and manageability of your infrastructure, aligning with best practices and compliance requirements such as PCI-DSS, which mandate secure certificate management.
  description: This rule checks that the path length for private certificate authorities (CAs) in OCI is enforced, ensuring that the maximum number of intermediate certificates in a chain does not exceed a set limit. To verify compliance, ensure that your CA configurations specify a path length constraint. Remediation involves reviewing your CA settings, updating them to include a path length constraint if missing, and redeploying the CA configuration to enforce this setting.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Certificates/Tasks/managingprivatecas.htm
  - https://docs.oracle.com/en-us/iaas/Content/Certificates/Concepts/certificateroots.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.cisecurity.org/benchmark/oracle/
- rule_id: oci.cloud_guard.target.policy_admin_change_audit_logging_enabled
  service: cloud_guard
  resource: target
  requirement: Policy Admin Change Audit Logging Enabled
  scope: cloud_guard.target.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: critical
  title: Ensure Policy Admin Change Audit Logging is Enabled
  rationale: Enabling audit logging for policy admin changes is crucial for detecting unauthorized modifications, ensuring accountability, and maintaining compliance with security frameworks such as NIST and SOC2. Without audit logs, it becomes challenging to trace changes, potentially leading to undetected security breaches or non-compliance issues.
  description: This rule checks if audit logging is enabled for policy admin changes within OCI Cloud Guard targets. Audit logs capture detailed records of who made changes to policies, when, and what changes were made. To remediate, ensure that logging is configured and actively capturing all policy admin changes by setting up an Audit Log in the OCI Console under the Logging service, and verify that logs are being properly stored and monitored.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/home.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_oci_audit.htm
  - https://www.oracle.com/cloud/cloud-infrastructure-compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/sorhome.html
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.cloud_guard.target.policy_admin_mfa_required
  service: cloud_guard
  resource: target
  requirement: Policy Admin MFA Required
  scope: cloud_guard.target.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Enforce MFA for Policy Administrators on Cloud Guard Targets
  rationale: Requiring multi-factor authentication (MFA) for policy administrators significantly reduces the risk of unauthorized access to critical security configurations. Without MFA, attackers who obtain credentials could manipulate security settings, potentially leading to data breaches or compliance violations.
  description: This rule checks if MFA is enforced for all users with policy administration privileges on Cloud Guard targets. It verifies that MFA is enabled to ensure an additional layer of security beyond passwords. If MFA is not enforced, administrators should configure user accounts to require MFA, using Oracle Identity and Access Management settings, to enhance protection against unauthorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm#Enable_MFA
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63B.pdf
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.cloud_guard.target.policy_admin_rbac_least_privilege_required
  service: cloud_guard
  resource: target
  requirement: Policy Admin RBAC Least Privilege Required
  scope: cloud_guard.target.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure Policy Admins Follow Least Privilege Principle
  rationale: Adhering to the least privilege principle for policy administrators in OCI is crucial to minimize unauthorized access and potential breaches. It mitigates the risk of privilege escalation and reduces the attack surface, aligning with compliance standards such as ISO 27001 and SOC2, which emphasize access control and risk management.
  description: This rule checks whether policy administrators in OCI are granted only the permissions necessary for their role. It involves reviewing IAM policies to ensure that permissions are limited to those essential for managing policies and not broader administrative functions. Remediation involves adjusting IAM policies to restrict excessive permissions and conducting regular audits to ensure ongoing compliance with least privilege practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.cloud_guard.target.config_drift_alerts_enabled
  service: cloud_guard
  resource: target
  requirement: Config Drift Alerts Enabled
  scope: cloud_guard.target.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Config Drift Alerts Are Enabled for Cloud Guard Targets
  rationale: Enabling config drift alerts for Cloud Guard targets is essential to detect and respond to unauthorized or unexpected changes in cloud resources. This helps maintain security baselines, ensure compliance with organizational policies, and mitigate potential risks arising from configuration drifts. Timely alerts allow security teams to address potential vulnerabilities before they are exploited.
  description: This rule verifies that configuration drift detection is enabled for Oracle Cloud Infrastructure (OCI) Cloud Guard targets. Configuration drift refers to the unintended changes that deviate from established baselines. To prevent security risks associated with drift, ensure that Cloud Guard is configured to send alerts whenever there is a deviation. Remediation involves enabling drift detection in the settings of Cloud Guard targets and regularly monitoring alerts to maintain consistent resource configurations.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/configuration-drift.html
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/home.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
- rule_id: oci.cloud_guard.target.config_drift_critical_resources_detection_enabled
  service: cloud_guard
  resource: target
  requirement: Config Drift Critical Resources Detection Enabled
  scope: cloud_guard.target.security
  domain: resilience_and_disaster_recovery
  subcategory: backup_configuration
  severity: low
  title: Ensure Config Drift Detection for Critical Resources is Enabled
  rationale: Enabling configuration drift detection for critical resources is vital for maintaining the integrity and security of your OCI environment. It helps in identifying unauthorized changes that could lead to security vulnerabilities, compliance violations, or operational issues. By ensuring this feature is active, organizations can quickly respond to and mitigate risks associated with unintended configuration changes.
  description: This rule checks whether configuration drift detection is enabled for critical resources within the Oracle Cloud Infrastructure using Cloud Guard. Configuration drift occurs when the state of your cloud resources deviates from the intended configuration, leading to potential security risks. To verify, ensure that the 'Config Drift Detection' feature is activated for all designated critical resources in OCI. Remediation involves navigating to the Cloud Guard service and enabling this feature for specified targets, ensuring continuous monitoring and notification of any configuration changes.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/cloud-guard-overview.html
  - https://docs.oracle.com/en-us/iaas/tools/cloud-shell/doc/configuring-cloud-guard.html
  - https://www.oracle.com/security/cloud-security/cloud-guard/
  - NIST SP 800-53 Rev. 5 - Configuration Management
  - CIS OCI Foundations Benchmark
  - ISO/IEC 27001:2013 - Information Security Management
- rule_id: oci.cloud_guard.target.config_baseline_conformance_pack_deployed
  service: cloud_guard
  resource: target
  requirement: Config Baseline Conformance Pack Deployed
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Config Baseline Conformance Pack is Deployed on Cloud Guard Targets
  rationale: Deploying a Config Baseline Conformance Pack in Oracle Cloud Infrastructure (OCI) ensures that resources adhere to organizational and regulatory compliance standards. It reduces security risks by continuously monitoring for configuration drifts and helping maintain a secure posture. Non-compliance can lead to vulnerabilities, data breaches, and potential financial penalties.
  description: This rule checks whether a Config Baseline Conformance Pack is deployed on Cloud Guard targets within OCI. A conformance pack is a collection of predefined security and compliance rules that help validate resource configurations against best practices and compliance requirements. If the pack is not deployed, users should apply a relevant conformance pack to ensure resource configurations are continuously evaluated and aligned with compliance standards. Remediation involves navigating to the Cloud Guard service, selecting the target, and deploying the relevant conformance pack.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/manage-cloud-guard.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/document_library
- rule_id: oci.cloud_guard.target.config_baseline_parameters_set
  service: cloud_guard
  resource: target
  requirement: Config Baseline Parameters Set
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Config Baseline Parameters Are Set for Cloud Guard Targets
  rationale: Having config baseline parameters set for Cloud Guard targets ensures that there is a predefined state against which the current configuration can be evaluated. This is crucial for maintaining compliance with organizational policies, identifying deviations, and mitigating risks associated with configuration drifts, thereby enhancing the security posture of the cloud environment.
  description: This rule checks if the configuration baseline parameters are set for Cloud Guard targets in Oracle Cloud Infrastructure. It involves verifying that the necessary baseline settings are in place to monitor and compare against the current configurations for any misalignments. To remediate, configure the baseline settings through the OCI Console or API, ensuring they reflect the desired state for your cloud resources.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/cloudguard.htm
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Tasks/configuringtarget.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.cloud_guard.target.breach_detection_alert_destinations_enabled
  service: cloud_guard
  resource: target
  requirement: Breach Detection Alert Destinations Enabled
  scope: cloud_guard.target.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Breach Detection Alert Destinations are Configured
  rationale: Enabling alert destinations for breach detection is crucial for timely incident response and compliance with security frameworks. Without these alerts, security teams may fail to respond swiftly to potential breaches, increasing the risk of data loss and non-compliance with standards like PCI-DSS and ISO 27001.
  description: This check verifies that alert destinations are configured in OCI Cloud Guard for breach detection. It ensures that alerts are sent to designated channels such as email or messaging services, allowing security teams to act quickly. Remediation involves configuring alert destinations within the Cloud Guard settings to ensure all breach detections are reported promptly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/home.htm
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/using/settingup.htm
  - https://www.oracle.com/security/cloud-security/cloud-guard/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.cloud_guard.target.breach_detection_integrations_authenticated
  service: cloud_guard
  resource: target
  requirement: Breach Detection Integrations Authenticated
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Breach Detection Integrations Are Properly Authenticated
  rationale: Authenticated integrations for breach detection are crucial for maintaining the integrity and security of your OCI environment. Unauthenticated integrations can lead to unauthorized access, resulting in potential data breaches and non-compliance with industry standards. Ensuring authentication helps protect sensitive data and maintains trust with customers and stakeholders.
  description: This rule checks if breach detection integrations within OCI Cloud Guard targets are securely authenticated. It verifies that all integrations use proper authentication mechanisms to communicate with external services. To remediate, ensure that all integrations have valid API keys or tokens configured, and regularly update and rotate these credentials to mitigate the risk of unauthorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/cloudguard.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/cloud-guard-best-practices.htm
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.cloud_guard.target.compliance_access_rbac_least_privilege_required
  service: cloud_guard
  resource: target
  requirement: Compliance Access RBAC Least Privilege Required
  scope: cloud_guard.target.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure RBAC Policies Adhere to Least Privilege for Cloud Guard Targets
  rationale: Implementing least privilege access controls is crucial to minimize the risk of unauthorized access to sensitive data and operations in OCI. It helps in reducing the attack surface by ensuring that only the necessary permissions are granted to users and services, thereby protecting against potential breaches and ensuring compliance with security standards.
  description: This rule checks that role-based access control (RBAC) policies for Cloud Guard targets are configured to adhere to the principle of least privilege. It verifies that users and roles have only the permissions necessary to perform their specific functions and no more. Remediation involves reviewing and modifying existing policies to ensure they grant the minimum necessary permissions. This may include using OCI's policy syntax to restrict actions at the resource level and regularly auditing access permissions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Concepts/cloudguardoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.cloud_guard.target.compliance_export_destinations_private_enforced
  service: cloud_guard
  resource: target
  requirement: Compliance Export Destinations Private Enforced
  scope: cloud_guard.target.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Compliance Export Destinations Are Private
  rationale: Enforcing private compliance export destinations reduces the risk of unauthorized access to sensitive compliance data. This practice helps protect against data breaches and ensures that only authorized network entities can access the exported data, aligning with best practices for data security and privacy.
  description: This rule checks if the compliance export destinations in Oracle Cloud Guard are configured to be private. Private destinations ensure that data exports are accessible only within a secure and controlled network environment. To remediate, configure the export destinations to be private by ensuring they are within a Virtual Cloud Network (VCN) with appropriate security lists and network security groups.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/home.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.cloud_guard.target.compliance_reports_storage_encrypted
  service: cloud_guard
  resource: target
  requirement: Compliance Reports Storage Encrypted
  scope: cloud_guard.target.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Compliance Reports Storage is Encrypted
  rationale: Encrypting compliance reports storage is crucial to protect sensitive data from unauthorized access and potential breaches. It helps in maintaining the integrity and confidentiality of data, aligning with regulatory requirements such as PCI-DSS and GDPR. Failure to encrypt may lead to data exposure, resulting in significant compliance fines and reputational damage.
  description: This rule checks whether the storage used for compliance reports in Oracle Cloud Infrastructure (OCI) is encrypted. It verifies that all compliance-related data stored in OCI is safeguarded using encryption algorithms. To remediate, ensure that Object Storage buckets or any other storage resources used for compliance reports are configured to use server-side encryption, either with OCI-managed keys or customer-managed keys.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingobjectstorages3compatibleapi.htm#encrypt
  - https://www.oracle.com/security-cloud-compliance/cis-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.cloud_guard.target.config_compliance_evidence_export_configured
  service: cloud_guard
  resource: target
  requirement: Config Compliance Evidence Export Configured
  scope: cloud_guard.target.compliance
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Config Compliance Evidence Export is Enabled for Cloud Guard Targets
  rationale: Enabling config compliance evidence export in OCI Cloud Guard is crucial for maintaining an audit trail of compliance activities. This facilitates compliance with regulatory frameworks, helps in forensic investigations, and ensures accountability. Failure to configure evidence export may result in incomplete compliance documentation, potentially leading to regulatory fines and reputational damage.
  description: This rule checks whether the configuration compliance evidence export is enabled for Cloud Guard targets. It ensures that all compliance-related data is systematically exported and stored. To verify, ensure that the export settings are configured in the OCI Cloud Guard settings. Remediation involves accessing the Cloud Guard console, navigating to the target configuration settings, and enabling evidence export to a secure, designated storage location.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/configuring-cloud-guard.html
  - https://docs.oracle.com/en-us/iaas/Content/security/secure-cloud.htm#SecurityBestPractices
  - https://cloudsecurityalliance.org/research/artifacts/oracle-cloud-infrastructure-security-best-practices
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://compliance.oracle.com/#/compliance
- rule_id: oci.cloud_guard.target.config_compliance_reporting_dashboards_enabled
  service: cloud_guard
  resource: target
  requirement: Config Compliance Reporting Dashboards Enabled
  scope: cloud_guard.target.compliance
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Config Compliance Dashboards Are Active in Cloud Guard
  rationale: Enabling Config Compliance Reporting Dashboards in OCI Cloud Guard allows for centralized monitoring and reporting of configuration compliance across your cloud resources. This is crucial for identifying potential security misconfigurations, ensuring adherence to internal policies, and aiding in compliance with external regulatory requirements.
  description: This rule checks if the Config Compliance Reporting Dashboards are enabled in OCI Cloud Guard for specified targets. Enabling these dashboards provides visibility into the configuration state of resources, helping to quickly identify and remediate any non-compliant configurations. To ensure compliance, verify that the dashboards are active through the OCI Console, and enable them if they are not. This can be done by navigating to the Cloud Guard service and configuring the dashboards for your security targets.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Tasks/cloud-guard-configure-targets.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://www.nist.gov/document-portal
  - https://www.pcisecuritystandards.org/
- rule_id: oci.cloud_guard.target.config_remediation_auto_enabled_for_high
  service: cloud_guard
  resource: target
  requirement: Config Remediation Auto Enabled For High
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Auto Remediation is Enabled for High Severity Findings
  rationale: Enabling automatic remediation for high severity security findings helps mitigate potential threats promptly, reducing the risk of exploitation. It aligns with best practices for maintaining a robust security posture and ensures compliance with regulatory frameworks that require timely response to vulnerabilities.
  description: This rule checks if Oracle Cloud Infrastructure's Cloud Guard is configured to automatically remediate high severity security findings on specified targets. Automatic remediation is crucial for minimizing the window of exposure by swiftly addressing vulnerabilities. To verify compliance, ensure that the 'Config Remediation' setting is enabled for high severity findings in your Cloud Guard targets. Remediation involves configuring Cloud Guard to apply recommended actions automatically when high severity issues are detected.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/home.htm
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/using-cloud-guard.htm#remediation
  - https://www.oracle.com/security/cloud-compliance/cloud-infrastructure/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.cloud_guard.target.config_remediation_manual_runbooks_attached
  service: cloud_guard
  resource: target
  requirement: Config Remediation Manual Runbooks Attached
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Manual Runbooks are Attached for Cloud Guard Targets
  rationale: Attaching manual runbooks to Cloud Guard targets ensures that there are predefined, documented procedures for remediating security issues. This is crucial for maintaining cloud security posture and compliance, as it enables quick and effective response to security findings, minimizing potential business impacts and reducing the risk of data breaches.
  description: This rule checks whether manual remediation runbooks are attached to Cloud Guard targets in Oracle Cloud Infrastructure. A manual runbook provides detailed steps for resolving specific security findings, which is essential when automated remediation is not possible. To comply, review your Cloud Guard targets and ensure each has an associated manual runbook that outlines the remediation process for identified issues.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/home.htm
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/remediationtasks.htm
  - https://www.oracle.com/cloud/cloud-security/oci-security-best-practices/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.cloud_guard.target.config_aggregation_auto_enroll_new_accounts
  service: cloud_guard
  resource: target
  requirement: Config Aggregation Auto Enroll New Accounts
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure New Accounts are Auto-Enrolled in Config Aggregation
  rationale: Automatically enrolling new accounts in config aggregation ensures consistent security posture management across all accounts. This reduces the risk of misconfigurations going undetected, which could lead to security breaches or compliance violations. Ensuring auto-enrollment helps maintain a centralized view of configuration changes, enabling swift response to potential issues.
  description: This rule checks if new accounts are automatically enrolled in configuration aggregation within Oracle Cloud Guard. Auto-enrollment simplifies the management of security policies across multiple accounts by ensuring that all newly created accounts are monitored for compliance and security posture. To remediate, ensure that the Cloud Guard configuration for your tenancy is set to automatically include new accounts in the aggregation targets. This can typically be configured in the OCI Console under Cloud Guard settings.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/using-cloud-guard.htm#config_targets
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_2-0-0.htm
  - https://docs.oracle.com/en-us/iaas/Content/Compliance/Concepts/complianceframeworks.htm
  - https://www.oracle.com/security/cloud-security/cloud-guard/
- rule_id: oci.cloud_guard.target.config_aggregation_org_aggregator_enabled
  service: cloud_guard
  resource: target
  requirement: Config Aggregation Org Aggregator Enabled
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Config Aggregation Org Aggregator is Enabled in Cloud Guard
  rationale: Enabling config aggregation in Cloud Guard ensures centralized visibility and management of security posture across multiple accounts and regions, which is crucial for maintaining compliance and governance. This reduces the risk of security misconfigurations and enhances the ability to detect and respond to potential threats effectively.
  description: This rule checks whether the Config Aggregation Org Aggregator is enabled on the Cloud Guard target. Enabling this feature allows the aggregation of configuration data from multiple compartments, providing a comprehensive view of security configurations. To remediate, navigate to the Cloud Guard service console in OCI, and ensure the Config Aggregation Org Aggregator is activated for the relevant targets.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/using-cloud-guard.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_approach.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.compute.instance.reservation_approval_workflow_required
  service: compute
  resource: instance
  requirement: Reservation Approval Workflow Required
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Require Approval for Compute Instance Reservations
  rationale: Implementing an approval workflow for compute instance reservations helps ensure that cloud resources are provisioned with oversight, reducing the risk of unauthorized or unnecessary resource allocation. This control is critical for cost management and maintaining a secure and compliant environment by preventing over-provisioning and ensuring accountability.
  description: This rule checks if an approval workflow is in place for creating reservations of compute instances. The workflow should include steps for reviewing and approving requests to ensure alignment with organizational policies and budget constraints. To remediate, configure an approval process via OCI Identity and Access Management (IAM) policies that requires managerial or security team approval before compute instances are provisioned.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/reservingcapacity.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - CIS OCI Foundations Benchmark
  - NIST SP 800-53
  - ISO/IEC 27001
  - https://www.oracle.com/security-cloud/compliance/
- rule_id: oci.compute.instance.reservation_billing_admins_mfa_required
  service: compute
  resource: instance
  requirement: Reservation Billing Admins MFA Required
  scope: compute.instance.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure MFA is Enabled for Reservation Billing Admins in OCI
  rationale: Enforcing Multi-Factor Authentication (MFA) for Reservation Billing Admins is crucial for strengthening the security posture of your OCI environment. Without MFA, accounts are more susceptible to unauthorized access, which can lead to potential financial losses and compliance violations. MFA adds an additional layer of security, reducing the risk of credential theft and enhancing overall account protection.
  description: This rule checks whether all users with Reservation Billing Admin privileges have Multi-Factor Authentication (MFA) enabled in Oracle Cloud Infrastructure. To verify, inspect the identity configurations for each admin account to ensure MFA is set up. Remediation involves enabling MFA for any admin accounts where it is not currently active, which can be done through the OCI Console by navigating to the identity and access management section and updating user settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practice.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - CIS OCI Foundations Benchmark
  - 'NIST SP 800-63B: Digital Identity Guidelines'
  - 'PCI-DSS Requirement 8: Identify and authenticate access to system components'
- rule_id: oci.compute.instance.reservation_purchase_permissions_restricted
  service: compute
  resource: instance
  requirement: Reservation Purchase Permissions Restricted
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Permissions for Instance Reservation Purchases
  rationale: Restricting permissions for purchasing compute instance reservations helps prevent unauthorized cost incurrence and ensures that only authorized personnel can make financial commitments. It mitigates the risk of accidental or malicious resource provisioning, which can lead to excessive spending and potential security vulnerabilities.
  description: This rule checks whether permissions to purchase reservations for compute instances are restricted to authorized users or groups. It ensures that only designated personnel with the appropriate IAM policies are able to make reservation purchases. To remediate, review and update IAM policies to limit reservation purchase capabilities to a controlled and audited group of administrators.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/reservedinstances.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/security/certifications/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf
- rule_id: oci.compute.instance.vm_data_volumes_encrypted_cmek
  service: compute
  resource: instance
  requirement: VM Data Volumes Encrypted Cmek
  scope: compute.instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure VM Data Volumes Use Customer-Managed Encryption Keys
  rationale: Encrypting VM data volumes with customer-managed encryption keys (CMEK) enhances security by granting customers full control over the encryption keys. This reduces the risk of unauthorized data access and helps comply with data protection regulations such as GDPR and PCI-DSS. It also aligns with best practices for data privacy and security management.
  description: This rule checks if all VM data volumes in Oracle Cloud Infrastructure are encrypted using customer-managed encryption keys. To verify, inspect each VM instance's attached block volumes to ensure they are encrypted with CMEK. Remediation involves configuring block volumes to use keys from the Oracle Cloud Infrastructure Vault service, offering full control over key management and lifecycle.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/managingvolumes.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.oracle.com/security/cloud-security/oci-security-architecture.html
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.oracle.com/cloud/cloud-security/compliance/
- rule_id: oci.compute.instance.vm_imds_hardened
  service: compute
  resource: instance
  requirement: VM Imds Hardened
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure VM Instance Metadata Service (IMDS) is Hardened on OCI VMs
  rationale: Hardening the VM Instance Metadata Service (IMDS) is critical to prevent unauthorized access to sensitive instance metadata that could be exploited by attackers. This practice reduces the risk of data breaches and supports compliance with security frameworks by ensuring that only authorized applications can access metadata. It also mitigates potential lateral movement within compromised environments.
  description: This rule checks if the VM Instance Metadata Service (IMDS) is properly configured and hardened on Oracle Cloud Infrastructure (OCI) virtual machines. To verify, ensure that the IMDS is restricted to authorized applications through network security configurations like VCN security lists or NSGs. Remediation involves updating these configurations to limit access to the metadata service, thus protecting sensitive information from unauthorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/References/instance_metadata.htm
  - https://www.oracle.com/security/cloud-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/itl/applied-cybersecurity/nist-cybersecurity-framework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.compute.instance.vm_no_public_ip_assigned_blocked
  service: compute
  resource: instance
  requirement: VM No Public Ip Assigned Blocked
  scope: compute.instance.public_access
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Restrict Public IP Assignment to VM Instances in OCI
  rationale: Assigning a public IP to VM instances can expose them to the internet, increasing the risk of unauthorized access and potential attacks. Restricting public IPs is crucial for safeguarding sensitive data, maintaining compliance with security frameworks, and reducing the attack surface of cloud environments.
  description: This rule checks if any VM instance in Oracle Cloud Infrastructure has been assigned a public IP address. Instances without a public IP are better protected from external threats. To remediate, ensure that VM instances are configured to use private IP addresses and access the internet through secure methods such as NAT gateways or bastion hosts. Verify configurations via the OCI console or API to ensure compliance with security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.compute.instance.vm_root_volume_encrypted_cmek
  service: compute
  resource: instance
  requirement: VM Root Volume Encrypted Cmek
  scope: compute.instance.encryption
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Ensure VM Root Volumes Use Customer-Managed Encryption Keys
  rationale: Encrypting VM root volumes with customer-managed encryption keys (CMEK) enhances data security by allowing organizations to control the encryption keys. This ensures that sensitive data is protected from unauthorized access, meets compliance requirements for data privacy, and aligns with security best practices for cloud environments. Compromise of such volumes can lead to data breaches, legal liabilities, and loss of customer trust.
  description: This rule checks if the root volumes of all virtual machine (VM) instances in Oracle Cloud Infrastructure (OCI) are encrypted using customer-managed keys. To verify, ensure that the volumes are configured with keys stored in OCI Vault. Remediation involves creating or selecting an existing key in OCI Vault, then configuring the VM root volumes to use this key for encryption. This enhances control over the encryption process and strengthens the data protection mechanisms.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/usingcustomerkey.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.2.0.htm#1.1
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/key-management/
- rule_id: oci.compute.instance.vm_secure_boot_enabled
  service: compute
  resource: instance
  requirement: VM Secure Boot Enabled
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure VM Secure Boot is Enabled for Instances
  rationale: Enabling Secure Boot for VM instances in OCI ensures that only trusted, signed bootloaders and operating systems can be executed, thereby protecting against rootkits and boot-level malware. This enhances the integrity and security of the system from the hardware level up, which is crucial for maintaining trust in the system's security posture and compliance with security standards.
  description: This rule checks whether Secure Boot is enabled for virtual machine instances within Oracle Cloud Infrastructure. Secure Boot is a security standard that helps ensure that a device boots using only software that is trusted by the Original Equipment Manufacturer (OEM). To enable Secure Boot, modify the instance's settings in the OCI Console or via OCI CLI by ensuring the 'Secure Boot' option is selected during the instance configuration process. This setting is crucial for environments that require stringent security controls and compliance adherence.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/References/secure-boot.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-123.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.compute.instance.vm_security_group_inbound_restricted
  service: compute
  resource: instance
  requirement: VM Security Group Inbound Restricted
  scope: compute.instance.network_security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Inbound Traffic to VM Security Groups
  rationale: Restricting inbound traffic to VM instances is crucial for minimizing the attack surface and protecting sensitive data. Unrestricted inbound access can lead to unauthorized access, data breaches, and non-compliance with regulatory standards such as PCI-DSS and ISO 27001. Limiting access to only necessary IPs reduces the risk of exploitation by malicious actors.
  description: This rule checks if VM instances within a security group have restrictive inbound traffic rules applied. It ensures that only specified IP addresses or subnets have access to the VM instances, thereby minimizing exposure to potential threats. To remediate, review and update security group rules to allow only essential inbound connections, and regularly audit these rules to align with security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingsecuritygroups.htm
  - https://www.oracle.com/security-cloud-compliance/cis-oci-compute-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.compute.instance.vm_serial_console_access_restricted_restricted
  service: compute
  resource: instance
  requirement: VM Serial Console Access Restricted Restricted
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict VM Serial Console Access for Enhanced Security
  rationale: Restricting VM Serial Console access in OCI is crucial to prevent unauthorized access to compute instances, reducing potential security risks such as data breaches and system compromise. Without proper restrictions, malicious actors could gain direct control over system operations, impacting business continuity and compliance with security standards.
  description: This rule ensures that VM Serial Console access is restricted to authorized users and IP addresses only. It checks the configuration settings of compute instances to verify that access is not open to all users. Remediation involves configuring IAM policies to limit console access and implementing network security rules to restrict access based on IP addresses. Regular audits are recommended to ensure compliance with security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/accessingtheserialconsole.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/iam_securitypolicies.htm
  - CIS Oracle Cloud Infrastructure Foundations Benchmark
  - NIST SP 800-53
  - ISO/IEC 27001:2013
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.compute.instance.vm_ssh_key_based_auth_required
  service: compute
  resource: instance
  requirement: VM Ssh Key Based Auth Required
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: high
  title: Ensure SSH Key-Based Authentication is Enabled for VM Instances
  rationale: SSH key-based authentication provides a more secure method for accessing VM instances than password-based authentication, which is susceptible to brute force attacks. Enforcing SSH key-based access reduces the risk of unauthorized access and helps ensure compliance with security standards such as ISO 27001 and NIST. By securing access to VM instances, organizations can protect sensitive data and maintain the integrity of their cloud environment.
  description: This rule checks whether SSH key-based authentication is enabled for Oracle Cloud Infrastructure VM instances. It verifies that only SSH key pairs are used for accessing instances, preventing the use of password authentication. To remediate non-compliance, users should disable password authentication on their instances and ensure that SSH keys are properly configured and managed. This can be done by updating the SSH configuration file and distributing public keys to authorized users.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/launchinginstance.htm#access
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1_1_0.htm
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
  - https://cloudsecurityalliance.org/artifacts/oci-security-best-practices/
- rule_id: oci.compute.instance.vm_ssh_password_auth_disabled
  service: compute
  resource: instance
  requirement: VM Ssh Password Auth Disabled
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure VM Instances Have SSH Password Authentication Disabled
  rationale: Disabling SSH password authentication enhances security by enforcing the use of SSH keys, which are more secure than passwords. This reduces the risk of unauthorized access through brute force attacks. It is crucial for maintaining a robust security posture, complying with best practices, and minimizing potential vulnerabilities.
  description: This rule checks whether SSH password authentication is disabled on Oracle Cloud Infrastructure VM instances. Disabling SSH password authentication ensures that only SSH key-based access is allowed, which is a more secure method of authentication. To remediate, configure the SSH daemon settings on your VM instances to set 'PasswordAuthentication' to 'no'. This can typically be done by editing the SSH configuration file located at '/etc/ssh/sshd_config'. After making changes, restart the SSH service to apply the new configuration.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/References/sshaccess.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policybestpractices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.compute.instance.vm_user_data_no_secrets
  service: compute
  resource: instance
  requirement: VM User Data No Secrets
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: high
  title: Ensure No Secrets in VM Instance User Data
  rationale: Storing secrets such as passwords, API keys, or private keys in VM instance user data poses a significant security risk. If compromised, these secrets can lead to unauthorized access, data breaches, and compliance violations. Protecting sensitive information is critical for maintaining the integrity and confidentiality of systems and data.
  description: This rule checks VM instances in Oracle Cloud Infrastructure to ensure that no sensitive information is included in the user data field. User data is accessible to users with read access to the compute instance, and therefore should not contain any secrets. To remediate, ensure that any sensitive data is removed from user data and consider using OCI Vault or environment variables for secure secret management.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/launchinginstance.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-security-certifications.htm
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://www.oracle.com/cloud-native/container-engine-kubernetes/secure-kubernetes-secrets/
- rule_id: oci.compute.instance.vm_vtpm_enabled
  service: compute
  resource: instance
  requirement: VM Vtpm Enabled
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure VM TPM is Enabled for OCI Compute Instances
  rationale: Enabling the virtual Trusted Platform Module (vTPM) helps ensure that cryptographic keys and sensitive data are stored securely within a virtualized environment. This enhances the overall security posture by providing hardware-based security features, thereby reducing the risk of data breaches and ensuring compliance with security frameworks.
  description: This rule checks whether the virtual Trusted Platform Module (vTPM) is enabled for Oracle Cloud Infrastructure (OCI) Compute instances. vTPM provides secure generation and storage of cryptographic keys, enhancing data protection. To remediate, configure your virtual machines to enable vTPM through the OCI Console or CLI, ensuring adherence to organizational security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/References/computefaq.htm
  - https://www.oracle.com/security/cloud-security/
  - https://cloudsecurityalliance.org/research/guidance/
  - https://csrc.nist.gov/publications/detail/sp/800-125a/final
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.container_instances.container_instance.container_instance_env_no_plaintext_secrets
  service: container_instances
  resource: container_instance
  requirement: Container Instance Env No Plaintext Secrets
  scope: container_instances.container_instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: high
  title: Avoid Plaintext Secrets in Container Instance Environment Variables
  rationale: Storing sensitive data such as API keys and passwords in plaintext within environment variables can lead to unauthorized access if the data is exposed. This can result in data breaches, financial loss, and non-compliance with security standards. Protecting secrets is crucial for maintaining the integrity and confidentiality of your applications.
  description: This rule ensures that environment variables in OCI Container Instances do not contain plaintext sensitive information. It checks for common patterns of secret data and advises using OCI Vault or other secure methods to manage secrets. If plaintext secrets are detected, it recommends encrypting them and using secure references in environment variables.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.container_instances.container_instance.container_instance_no_privileged_containers
  service: container_instances
  resource: container_instance
  requirement: Container Instance No Privileged Containers
  scope: container_instances.container_instance.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure No Privileged Containers in OCI Container Instances
  rationale: Running containers with privileged access poses significant security risks, as it grants the container elevated permissions that can lead to unauthorized access and potential compromise of the host system. This is crucial for maintaining a secure environment, ensuring compliance with security standards, and protecting sensitive data from potential breaches.
  description: This rule checks for OCI container instances that are configured to run with privileged access. A privileged container can bypass security controls, access host resources, and perform actions that can undermine the security posture of the infrastructure. To remediate, ensure that all containers are running with the least privilege necessary by verifying the container configuration and setting 'privileged' to 'false'. This can be done via the OCI Console or using the OCI CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContInst/Tasks/continstconfigurations.htm
  - https://www.oracle.com/security/cloud-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-190.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://www.oracle.com/cloud-native/container-engine-kubernetes/
- rule_id: oci.container_instances.container_instance.container_instance_read_only_root_filesystem
  service: container_instances
  resource: container_instance
  requirement: Container Instance Read Only Root Filesystem
  scope: container_instances.container_instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Ensure Container Instance Uses Read-Only Root Filesystem
  rationale: A read-only root filesystem for container instances ensures that the container's runtime is immutable and reduces the risk of unauthorized or accidental modifications to critical system files. This enhances security by preventing attacks that aim to alter the filesystem, supports compliance with standards that require system integrity, and minimizes potential vulnerabilities that could be exploited by malicious actors.
  description: This rule checks if the root filesystem of a container instance in OCI is set to read-only. A read-only filesystem prevents any write operations, which secures the container runtime environment against tampering. To implement this, configure the container instance settings to enable a read-only root filesystem. This can be verified by checking the container instance configuration in the OCI Console or using OCI CLI commands. Remediation involves updating the container configuration to enforce a read-only policy.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Containers/Tasks/containersusingcontainerinstances.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://cloud.oracle.com/cloud-security
- rule_id: oci.artifacts.container_repository.lifecycle_policy_storage_encrypted
  service: artifacts
  resource: container_repository
  requirement: Lifecycle Policy Storage Encrypted
  scope: artifacts.container_repository.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Container Repository Lifecycle Policies Use Encrypted Storage
  rationale: Encrypting the storage associated with lifecycle policies in OCI container repositories is crucial for protecting sensitive data from unauthorized access and potential breaches. Ensuring encryption aligns with compliance requirements such as PCI-DSS and HIPAA, and mitigates risks associated with data exposure during the retention and deletion processes.
  description: This rule verifies that all lifecycle policies for OCI container repositories have storage encryption enabled. To comply, ensure that encryption is configured when setting up or modifying lifecycle policies. This can be achieved by using the OCI Console or CLI to check and enforce encryption settings for storage associated with container repositories. Remediation involves auditing existing policies and applying the necessary encryption configurations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Registry/Concepts/registryoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam_servicepolicy.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/document_library
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.artifacts.container_repository.lifecycle_policy_unused_or_old_tags_expire
  service: artifacts
  resource: container_repository
  requirement: Lifecycle Policy Unused Or Old Tags Expire
  scope: artifacts.container_repository.lifecycle_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Implement Expiry Policy for Unused or Old Container Tags
  rationale: Implementing lifecycle policies to expire unused or outdated container tags mitigates the risk of using deprecated images, reduces storage costs, and enhances compliance with data retention policies. It helps in maintaining an organized and secure container registry by ensuring that only active and relevant images are retained, reducing potential attack surfaces.
  description: This rule checks whether a lifecycle policy is set to automatically expire unused or old tags in OCI Container Repositories. A proper policy ensures that tags which have not been accessed within a specific timeframe or exceed a certain age are removed. To implement a remediation, configure lifecycle policies in OCI to specify conditions under which tags should be deleted. This helps in maintaining optimal storage and mitigating security risks associated with deprecated images.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/artifacts/Tasks/artifactsmanagingcontainerimages.htm
  - https://docs.oracle.com/en-us/iaas/Content/security/secure-by-design.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.identity.user.access_billing_admins_mfa_required
  service: identity
  resource: user
  requirement: Access Billing Admins MFA Required
  scope: identity.user.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Enforce MFA for Billing Admin User Access
  rationale: Multi-factor authentication (MFA) adds an essential layer of security, reducing the risk of unauthorized access to billing information. Billing data is sensitive and can be exploited for financial gain or damaging service disruptions. Ensuring MFA for Billing Admins aligns with compliance standards and mitigates identity theft risks.
  description: This rule checks if Multi-Factor Authentication (MFA) is enabled for users with Billing Administrator privileges in Oracle Cloud Infrastructure (OCI). Without MFA, unauthorized access can lead to financial data exposure and potential misuse. To remediate, ensure that all users with billing admin roles have MFA enabled by navigating to the OCI Console, selecting the user, and enabling MFA in their security settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/mfa.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/secure-resources.htm
  - https://www.oracle.com/security/cloud-security.html
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.nist.gov/cyberframework
- rule_id: oci.identity.user.access_billing_console_rbac_least_privilege_required
  service: identity
  resource: user
  requirement: Access Billing Console RBAC Least Privilege Required
  scope: identity.user.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege Access to Billing Console
  rationale: Restricting access to the Billing Console is critical to prevent unauthorized viewing or modification of billing information, which can lead to financial mismanagement, unauthorized spending, and potential data exposure. Ensuring that only users with a legitimate business need have access helps maintain financial control and supports compliance with regulations such as PCI-DSS and SOC2.
  description: This rule checks that permissions to the Billing Console in OCI are assigned based on the principle of least privilege. It verifies that only users who require access to complete their job responsibilities have the necessary roles, preventing unauthorized access. Remediation involves reviewing and adjusting IAM policies and groups to ensure that only authorized personnel can access billing information. This may include creating specific groups for billing task access and assigning users to these groups based on their job functions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policyreference.htm
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.tag_namespace.access_cost_data_exports_private_and_encrypted
  service: identity
  resource: tag_namespace
  requirement: Access Cost Data Exports Private And Encrypted
  scope: identity.tag_namespace.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Cost Data Exports Are Private and Encrypted
  rationale: Securing cost data exports is crucial to prevent unauthorized access to sensitive financial information. Exposing this data can lead to financial loss, competitive disadvantage, and non-compliance with data protection regulations. Ensuring data exports are private and encrypted helps maintain confidentiality and integrity, aligning with compliance requirements like PCI-DSS and ISO 27001.
  description: This rule checks that access to OCI cost data exports within tag namespaces is configured to be private and encrypted. It verifies that the tag namespaces handling financial data have encryption enabled and access controls configured to restrict unauthorized access. Remediation involves using OCI's Identity and Access Management (IAM) policies to set restrictive permissions and enabling encryption for data at rest and in transit.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/taggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_fundamentals.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://cloudsecurityalliance.org/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
- rule_id: oci.identity.user.access_cost_export_destinations_least_privilege_required
  service: identity
  resource: user
  requirement: Access Cost Export Destinations Least Privilege Required
  scope: identity.user.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Accessing Cost Export Destinations
  rationale: Implementing least privilege access for users accessing cost export destinations is crucial for minimizing the risk of unauthorized data exposure and potential financial impact. Unauthorized access to cost data can lead to data breaches and financial losses, impacting compliance with security standards and regulations.
  description: This rule verifies that users are granted only the necessary permissions to access cost export destinations in OCI. It checks for overly permissive policies that might allow users to view, modify, or export cost-related data without a legitimate business need. Remediation involves reviewing user permissions and ensuring they align with the principle of least privilege, removing any unnecessary access to cost export destinations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Billing/Concepts/costexports.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.2_benchmark.htm
  - https://www.nist.gov/document-2234
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://cloudsecurityalliance.org/research/guidance
- rule_id: oci.identity.tag_namespace.allocation_cost_tag_policy_enforced
  service: identity
  resource: tag_namespace
  requirement: Allocation Cost Tag Policy Enforced
  scope: identity.tag_namespace.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Allocation Cost Tag Policy is Enforced in OCI
  rationale: Enforcing an allocation cost tag policy ensures that all resources created within the Oracle Cloud Infrastructure are properly tagged for cost tracking and allocation purposes. This is crucial for effective cost management, preventing unauthorized resource usage, and maintaining compliance with financial reporting standards. Failure to enforce such policies may lead to untracked spending and potential budget overrun.
  description: This rule checks that a tag policy is in place to enforce the allocation of cost-related tags within the tag namespace. It verifies that all resources have the necessary tags applied to track and manage costs effectively. If the policy is not enforced, administrators should create or update tag policies to include mandatory cost allocation tags. This can be done via the OCI Console or API, ensuring all future resource deployments adhere to organizational tagging standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Tagging/Concepts/taggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://cloudsecurityalliance.org/star/registry/oracle-cloud-infrastructure/
  - NIST SP 800-53 Rev. 5
  - ISO/IEC 27001:2013
- rule_id: oci.identity.tag_namespace.allocation_required_cost_tags_present
  service: identity
  resource: tag_namespace
  requirement: Allocation Required Cost Tags Present
  scope: identity.tag_namespace.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Allocation Required Cost Tags Are Present in Tag Namespaces
  rationale: Cost tags are crucial for tracking and managing expenses within an organization. Missing allocation-required cost tags can lead to inaccurate cost attribution, impacting budget management and financial reporting. Ensuring these tags are present reduces the risk of overspending and aids in compliance with financial governance policies.
  description: This rule checks if all tag namespaces in your OCI environment have allocation-required cost tags. Without these tags, resources may not be properly tracked, leading to potential financial mismanagement. To remediate, ensure that each tag namespace includes the necessary cost allocation tags by reviewing your OCI tag namespace configurations and updating them accordingly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/taggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingtags.htm
  - https://docs.oracle.com/en-us/iaas/Content/CostMgmt/Concepts/costtags.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/document-2237
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.identity.tag_namespace.allocation_untagged_resource_alerts_enabled
  service: identity
  resource: tag_namespace
  requirement: Allocation Untagged Resource Alerts Enabled
  scope: identity.tag_namespace.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Alerts for Untagged Resource Allocation are Enabled
  rationale: Enabling alerts for the allocation of untagged resources is crucial as it helps in maintaining resource organization, cost management, and security monitoring. Untagged resources can lead to increased costs, lack of accountability, and difficulty in enforcing security policies, impacting compliance with industry standards.
  description: This rule checks whether alerts are enabled for the allocation of resources without tags in Oracle Cloud Infrastructure. It ensures that any new resource created without a proper tag is flagged, allowing administrators to take corrective actions promptly. Remediation involves configuring alerts in the OCI Console under Identity and Access Management settings, ensuring all resources are tagged appropriately at creation.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingtags.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/taggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/tools/cis-oci-benchmark-1.0.0.pdf
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.compute.image.image_approved_allowlist_enforced
  service: compute
  resource: image
  requirement: Image Approved Allowlist Enforced
  scope: compute.image.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Only Approved Images are Used in Compute Instances
  rationale: Enforcing an approved image allowlist reduces security risks by ensuring that only vetted and compliant images are deployed. This helps prevent the use of images with vulnerabilities or non-compliant software, thereby protecting sensitive data and maintaining operational integrity.
  description: This rule verifies that all compute instances are launched using images from an approved allowlist. By enforcing this policy, you ensure consistency and security across your infrastructure. To remediate, review and update your image allowlist in OCI to include only those images that meet your organization's security and compliance standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/managingcustomimages.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam_trustedadvisor.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://www.nist.gov/itl/applied-cybersecurity/nist-cloud-computing-program
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.compute.image.image_encrypted_cmek
  service: compute
  resource: image
  requirement: Image Encrypted Cmek
  scope: compute.image.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Compute Image Encryption with Customer-Managed Keys
  rationale: Encrypting compute images with customer-managed encryption keys (CMEK) enhances data privacy and security, allowing organizations to maintain control over encryption keys. This is crucial for compliance with data protection regulations and to mitigate risks associated with unauthorized access to sensitive data.
  description: This rule verifies that compute images are encrypted using customer-managed encryption keys (CMEK) in Oracle Cloud Infrastructure. It ensures that the images are not using default Oracle-managed keys, which provides an additional layer of security and control over cryptographic operations. To remediate, configure image encryption settings to use a customer-managed key stored in OCI Key Management, ensuring that images are compliant with organizational security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/managingkeys.htm
  - https://www.cisecurity.org/benchmark/oracle/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://www.oracle.com/security/cloud-security/
  - 'NIST SP 800-57: Recommendation for Key Management'
  - 'PCI DSS Requirement 3: Protect stored cardholder data'
- rule_id: oci.compute.image.image_signed_and_verified_validated
  service: compute
  resource: image
  requirement: Image Signed And Verified Validated
  scope: compute.image.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Compute Images Are Signed and Verified
  rationale: Ensuring that compute images are signed and verified is crucial for maintaining the integrity and authenticity of software artifacts. Unsigned or unverified images can introduce vulnerabilities, allowing the deployment of compromised or malicious software. This practice helps in achieving compliance with industry standards and reduces the risk of security breaches.
  description: This rule checks whether Oracle Cloud Infrastructure (OCI) compute images are signed and verified before they are deployed. A valid signature ensures that the image comes from a trusted source and has not been tampered with. Remediation involves using OCI tools to sign images and configure policies to verify signatures before use, ensuring only trusted images are launched.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/image-signing.htm
  - https://www.oracle.com/security/cloud-security/benchmarks.html
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.compute.image.image_not_publicly_shared_blocked
  service: compute
  resource: image
  requirement: Image Not Publicly Shared Blocked
  scope: compute.image.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure Compute Images Are Not Publicly Shared
  rationale: Publicly shared compute images can lead to unauthorized access, data breaches, and potential abuse of resources, impacting business operations and compromising sensitive information. By restricting public sharing, organizations can maintain control over their cloud environment and comply with security standards.
  description: This rule checks if any compute images in OCI are publicly shared, which is a critical security risk. Publicly accessible images can be exploited by malicious actors, leading to unauthorized use and data exposure. To remediate, review the sharing settings of your compute images and ensure they are only shared with specific compartments or users as necessary. Use the OCI Console or CLI to modify the sharing settings and restrict access appropriately.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/managingcustomimages.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.compute.image.image_vuln_scanned_no_critical
  service: compute
  resource: image
  requirement: Image Vuln Scanned No Critical
  scope: compute.image.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Compute Images Are Scanned for Critical Vulnerabilities
  rationale: Regular vulnerability scanning of compute images is crucial to identify and mitigate security risks before deployment. Images with critical vulnerabilities can be exploited by attackers, leading to data breaches, service disruptions, and non-compliance with security standards like PCI-DSS and ISO 27001.
  description: This rule checks if compute images in Oracle Cloud Infrastructure have been scanned and confirmed to have no critical vulnerabilities. Regular scanning helps ensure that newly discovered vulnerabilities are addressed promptly. To remediate, use OCI's Vulnerability Scanning Service to assess your images and address any critical issues identified before deploying the images to production environments.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Tasks/vulnerabilityscanning.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam_vulnerabilities.htm
  - https://docs.oracle.com/en-us/iaas/Content/security/orelimagesecurity.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_catalog.catalog.catalog_cross_account_sharing_restricted
  service: data_catalog
  resource: catalog
  requirement: Catalog Cross Account Sharing Restricted
  scope: data_catalog.catalog.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Restrict Cross-Account Sharing for OCI Data Catalogs
  rationale: Allowing unrestricted cross-account sharing of data catalogs in OCI can expose sensitive data to unauthorized entities, leading to potential data breaches or compliance violations. Restricting access helps maintain data integrity and confidentiality, reducing the risk of unauthorized data exposure and ensuring compliance with regulations such as GDPR and CCPA.
  description: This rule verifies that OCI Data Catalogs are not shared with accounts outside of your organization by default. It checks for any policies or configurations that allow cross-account access and ensures they are restricted. To remediate, review and modify IAM policies to limit catalog access to authorized users within your organization, and use compartment-level access controls to enforce security boundaries.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/best_practice.htm
  - https://cloudsecurityalliance.org/research/guidance-documents/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
- rule_id: oci.data_catalog.catalog.catalog_metadata_encryption_enabled
  service: data_catalog
  resource: catalog
  requirement: Catalog Metadata Encryption Enabled
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Metadata Encryption is Enabled for OCI Data Catalog
  rationale: Enabling encryption for catalog metadata protects sensitive information from unauthorized access and potential data breaches. This is crucial for maintaining data integrity and confidentiality, and it aligns with compliance requirements such as GDPR and CCPA that mandate protection of personal data. Without encryption, organizations may face financial penalties and reputational damage.
  description: This rule verifies that encryption is enabled for metadata in OCI Data Catalogs. OCI provides options to encrypt data using Oracle-managed keys or Customer-Managed Keys (CMKs). Remediation involves configuring the data catalog to use encryption, ensuring all metadata is secured at rest. Review your OCI Data Catalog settings to confirm that encryption is enabled and correctly configured according to your organization's security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.oracle.com/security/cloud-security/compliance/
  - NIST SP 800-53
  - ISO/IEC 27001:2013
- rule_id: oci.data_catalog.catalog.catalog_rbac_least_privilege_required
  service: data_catalog
  resource: catalog
  requirement: Catalog RBAC Least Privilege Required
  scope: data_catalog.catalog.logging
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Data Catalog RBAC in OCI
  rationale: Implementing least privilege in OCI's data catalog reduces the risk of unauthorized access and potential data breaches, ensuring that users only have permissions necessary for their roles. This is crucial for maintaining data integrity, confidentiality, and compliance with regulatory requirements such as GDPR and HIPAA.
  description: This rule checks whether the OCI Data Catalog service adheres to the principle of least privilege by ensuring that only necessary permissions are granted to users and groups. Verification involves reviewing IAM policies to confirm that no excessive permissions are granted. Remediation may require modifying policies to restrict access and periodically auditing roles to align with current business needs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.data_catalog.catalog.catalog_change_audit_logging_enabled
  service: data_catalog
  resource: catalog
  requirement: Catalog Change Audit Logging Enabled
  scope: data_catalog.catalog.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Catalog Change Audit Logging is Enabled
  rationale: Enabling audit logging for catalog changes in OCI's Data Catalog service is crucial for tracking modifications, which aids in forensic investigations and compliance with industry regulations. Without audit logs, unauthorized changes might go undetected, posing security and operational risks.
  description: This rule checks if audit logging is enabled for catalog changes in OCI Data Catalog service. Audit logs record every modification, providing a trail for security audits and compliance checks. To enable audit logging, navigate to the Data Catalog service in the OCI console, access the specific catalog settings, and ensure logging is turned on. This helps in maintaining accountability and transparency in data management.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Compliance/Concepts/compliance.htm
  - CIS OCI Foundations Benchmark
  - NIST SP 800-53
  - PCI-DSS Requirement 10
  - ISO/IEC 27001:2013
- rule_id: oci.data_catalog.catalog.catalog_cross_account_sharing_review_required
  service: data_catalog
  resource: catalog
  requirement: Catalog Cross Account Sharing Review Required
  scope: data_catalog.catalog.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Review Catalog Cross-Account Sharing in OCI Data Catalog
  rationale: Cross-account sharing of data catalogs can lead to unauthorized access and potential data breaches if not properly reviewed and controlled. Ensuring appropriate access controls and regular reviews mitigate risks of data exposure, supporting compliance with security standards and protecting sensitive information.
  description: This rule checks if there is any cross-account sharing of data catalogs within OCI Data Catalogs. It verifies if the sharing configurations are regularly reviewed to ensure they adhere to security policies and restrict access to only trusted accounts. Remediation involves conducting a thorough review of existing cross-account access permissions, ensuring they are justified and documented, and adjusting them as needed to minimize risk.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/securitypolicies.htm
  - https://cloudsecurityalliance.org/download/cis-oci-benchmark-v1-1-0/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.data_catalog.catalog.catalog_update_rbac_least_privilege_required
  service: data_catalog
  resource: catalog
  requirement: Catalog Update RBAC Least Privilege Required
  scope: data_catalog.catalog.logging
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for OCI Data Catalog Updates
  rationale: Ensuring least privilege access for updating Data Catalogs in OCI is critical to mitigate unauthorized changes that could lead to data breaches, compliance violations, or business disruptions. Proper RBAC configuration limits access to necessary personnel only, reducing the risk of insider threats and unintentional errors.
  description: This rule checks for and ensures that only users with the necessary permissions can update OCI Data Catalogs. It verifies that RBAC policies are in place and restrict access to a minimal set of users or groups with a clear business need. Remediation involves reviewing IAM policies, removing excessive permissions, and ensuring that roles align with the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://www.oracle.com/cloud/cloud-security/
  - https://cloudsecurityalliance.org/research/artifacts/security-guidelines-v2-4/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.cisecurity.org/benchmark/oracle_cloud
- rule_id: oci.data_catalog.catalog.catalog_audit_logging_enabled
  service: data_catalog
  resource: catalog
  requirement: Catalog Audit Logging Enabled
  scope: data_catalog.catalog.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Data Catalog Audit Logging is Enabled
  rationale: Enabling audit logging for the Data Catalog service is crucial for tracking access and changes to data assets, which helps in detecting unauthorized activities and ensuring accountability. Without audit logs, organizations may face challenges in meeting compliance requirements such as NIST, PCI-DSS, and ISO 27001, and risk potential data breaches.
  description: This rule checks whether audit logging is enabled for OCI Data Catalogs. Audit logging records user activities, API calls, and system actions, providing a comprehensive trail of events. To verify, ensure that the Data Catalog service is configured to send logs to an enabled Logging service. Remediation involves setting up a logging policy and ensuring logs are being collected and retained according to your organization's data retention policy.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_2_0_0.html
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/document_library
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.data_catalog.catalog.catalog_store_encrypted
  service: data_catalog
  resource: catalog
  requirement: Catalog Store Encrypted
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Catalog Store is Encrypted
  rationale: Encrypting the Data Catalog store is crucial for protecting sensitive information from unauthorized access and potential data breaches. Lack of encryption can lead to exposure of critical data, impacting compliance with data protection regulations such as GDPR and CCPA. Ensuring encryption helps maintain trust and aligns with industry best practices for data security.
  description: This rule checks whether the Data Catalog store in Oracle Cloud Infrastructure is encrypted. Encryption at rest within the Data Catalog service ensures that even if unauthorized access occurs, the data remains unintelligible. To verify, ensure that the 'catalog' resources have encryption enabled in their configuration. Remediation involves configuring the Data Catalog to use OCI's encryption capabilities, ensuring compliance with security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/datacatalog/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm#data_security
  - CIS OCI Benchmark v1.1.0 - Section 3.3
  - 'NIST SP 800-53: SC-28 Protection of Information at Rest'
  - 'PCI-DSS Requirement 3.5.1: Protect cryptographic keys used for encryption of cardholder data from disclosure and misuse'
  - Oracle Cloud Infrastructure Best Practices for Security
- rule_id: oci.data_catalog.catalog.dev_endpoint_encrypted
  service: data_catalog
  resource: catalog
  requirement: Dev Endpoint Encrypted
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Catalog Development Endpoints are Encrypted
  rationale: Encryption of development endpoints in OCI's Data Catalog is crucial to protect sensitive metadata during transit and at rest. Unencrypted endpoints expose data to potential interception or unauthorized access, posing significant security risks, including data breaches and non-compliance with regulatory standards such as PCI-DSS and HIPAA.
  description: This rule checks whether development endpoints in the OCI Data Catalog service are configured with encryption. It verifies that all data in transit and at rest is encrypted using OCI's encryption capabilities. If any endpoints are found unencrypted, they should be reconfigured to use OCI's encryption services, ensuring data integrity and confidentiality are maintained.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
- rule_id: oci.data_catalog.catalog.dev_endpoint_no_public_access_blocked
  service: data_catalog
  resource: catalog
  requirement: Dev Endpoint No Public Access Blocked
  scope: data_catalog.catalog.public_access
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: critical
  title: Ensure Data Catalog Dev Endpoint is Not Publicly Accessible
  rationale: Allowing public access to data catalog development endpoints poses significant security risks, including unauthorized data exposure, potential data breaches, and non-compliance with data protection regulations. Restricting public access helps maintain data integrity, confidentiality, and aligns with best security practices and compliance requirements.
  description: This rule verifies that all development endpoints associated with Oracle Cloud Infrastructure (OCI) Data Catalogs are not publicly accessible over the internet. It checks the network security configurations to ensure that access is restricted to specific IP addresses or within a Virtual Cloud Network (VCN). If public access is detected, it suggests remediation by configuring security lists and network security groups to limit access. This prevents unauthorized access and mitigates potential security threats.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networksecuritygroups.htm
  - CIS OCI Foundations Benchmark
  - NIST SP 800-53
  - PCI-DSS Requirement 1.3
  - OCI Security Best Practices
- rule_id: oci.data_catalog.catalog.dev_endpoint_role_least_privilege_required
  service: data_catalog
  resource: catalog
  requirement: Dev Endpoint Role Least Privilege Required
  scope: data_catalog.catalog.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Dev Endpoint Role Follows Least Privilege Principle
  rationale: Implementing the least privilege principle for development endpoint roles in OCI Data Catalog minimizes the risk of unauthorized data access and potential data breaches. By restricting permissions to only what is necessary, organizations can reduce exposure to threats and ensure compliance with security standards and regulatory requirements.
  description: This rule checks if the roles assigned to development endpoints within OCI Data Catalog adhere to the least privilege principle. It verifies whether roles are granted only the necessary permissions required for their specific tasks. Remediation involves reviewing and adjusting IAM policies to ensure that roles do not have excessive permissions, following a least privilege model. This may involve creating custom policies or using predefined ones that are scoped appropriately.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practice.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation_benchmark/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_catalog.catalog.classification_auto_enabled
  service: data_catalog
  resource: catalog
  requirement: Classification Auto Enabled
  scope: data_catalog.catalog.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Automatic Classification is Enabled for Data Catalogs
  rationale: Enabling automatic classification in OCI Data Catalogs helps ensure that data is consistently categorized, which facilitates effective data governance and compliance with privacy regulations such as GDPR, CCPA, and HIPAA. This reduces the risk of data mismanagement and supports data protection strategies by identifying sensitive information that requires additional security controls.
  description: This rule checks whether automatic classification is enabled for OCI Data Catalogs. Automatic classification allows the system to scan and categorize data based on predefined criteria, which helps maintain data integrity and security. To verify, navigate to the Data Catalog settings in the OCI Console and ensure the 'Classification Auto Enabled' option is turned on. If it is not enabled, update the catalog settings to activate this feature, ensuring your data assets are appropriately classified for enhanced protection and compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/data-catalog/using/data-asset.html#data-catalog-get-started
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-security-best-practices.pdf
  - https://www.oracle.com/cloud/soc2/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://cloudsecurityalliance.org/research/artifacts/security-guidance-v4/
- rule_id: oci.data_catalog.catalog.classification_policy_blocks_public_for_sensitive_blocked
  service: data_catalog
  resource: catalog
  requirement: Classification Policy Blocks Public For Sensitive Blocked
  scope: data_catalog.catalog.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure Public Access to Sensitive Data in Catalogs is Blocked
  rationale: Allowing public access to sensitive data in data catalogs can lead to unauthorized data exposure, which poses significant risks such as data breaches and compliance violations. Protecting sensitive data is critical to maintaining confidentiality, integrity, and trust, as well as adhering to compliance frameworks like PCI-DSS and GDPR.
  description: This rule verifies that classification policies in OCI Data Catalogs are configured to block public access when sensitive data is detected. It checks for any policies that fail to restrict access based on data sensitivity classifications. Remediation involves configuring classification policies to ensure that any detected sensitive data is not accessible to the public, thus mitigating potential security risks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Tasks/managingcatalogs.htm
  - https://docs.oracle.com/en-us/iaas/pdf/oci_cis_1.1.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.data_catalog.catalog.classification_required_sensitivity_tags_present
  service: data_catalog
  resource: catalog
  requirement: Classification Required Sensitivity Tags Present
  scope: data_catalog.catalog.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Sensitivity Tags Present for Data Catalog Classifications
  rationale: Ensuring that sensitivity tags are present for classifications in the data catalog is crucial for maintaining data privacy and security. Without these tags, sensitive data might be inadvertently exposed, leading to potential data breaches, non-compliance with data protection laws, and financial or reputational damage.
  description: This rule checks that all data classifications within an Oracle Cloud Infrastructure Data Catalog have the necessary sensitivity tags applied. Sensitivity tags help in identifying and protecting sensitive information by enabling automated data governance policies. To remediate, review your data catalog entries and apply appropriate sensitivity tags to each classification, ensuring that all sensitive data is appropriately marked and protected.
  references:
  - https://docs.oracle.com/en-us/iaas/data-catalog/doc/using-data-catalog.html
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/privacy-framework
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/cloud/security/best-practices/
- rule_id: oci.data_catalog.catalog.connection_credentials_in_secrets_manager
  service: data_catalog
  resource: catalog
  requirement: Connection Credentials In Secrets Manager
  scope: data_catalog.catalog.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure Data Catalog Connection Credentials Use Secrets Manager
  rationale: Storing connection credentials in OCI Secrets Manager enhances security by centralizing secret management and reducing the risk of unauthorized access. This practice aligns with security best practices and compliance requirements by ensuring that sensitive data is protected through encryption and access control. Failure to manage secrets properly can lead to data breaches or unauthorized data access, impacting business reputation and compliance status.
  description: This rule checks whether connection credentials for data catalogs are stored in OCI Secrets Manager. By using Secrets Manager, you ensure that credentials are encrypted and can be managed securely, with strict access controls and audit logging. To remediate, move any hard-coded or improperly stored credentials into Secrets Manager and update your data catalog configurations to reference these secrets.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Secrets/Concepts/overview.htm
  - https://www.oracle.com/security/cloud-security/secrets-management/
  - CIS OCI Foundations Benchmark v1.0.0, section 1.5
  - 'NIST SP 800-53: Access Control and Protection of Information'
  - ISO/IEC 27001:2013 - Information Security Management
- rule_id: oci.data_catalog.catalog.connection_role_least_privilege_required
  service: data_catalog
  resource: catalog
  requirement: Connection Role Least Privilege Required
  scope: data_catalog.catalog.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Data Catalog Connection Roles
  rationale: Implementing the principle of least privilege for connection roles in the OCI Data Catalog minimizes potential security risks by reducing the attack surface. It ensures that users and services have only the permissions necessary for their tasks, thus protecting sensitive data and maintaining compliance with regulations such as GDPR and PCI-DSS.
  description: This rule verifies that all connection roles in the OCI Data Catalog are granted only the permissions necessary to perform their specific functions. It checks for overly permissive roles and alerts if any roles have more privileges than required. To remediate, review each role's permissions and adjust them to align with the principle of least privilege, ensuring that roles are tailored to the specific needs of the users or services assigned to them.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/access/understandingpolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.oracle.com/security/cloud-security/best-practices/
- rule_id: oci.data_catalog.catalog.ai_services_dataset_access_logging_enabled
  service: data_catalog
  resource: catalog
  requirement: Ai Services Dataset Access Logging Enabled
  scope: data_catalog.catalog.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure AI Services Dataset Access Logging is Enabled
  rationale: Enabling AI Services dataset access logging is crucial for monitoring and auditing data access activities. This practice helps identify unauthorized access, supports compliance with data protection regulations, and improves security posture by providing visibility into data usage patterns.
  description: This rule checks if access logging is enabled for datasets used by AI Services within the OCI Data Catalog. To verify, ensure that logging is configured and that logs are actively being collected and stored in the Oracle Cloud Infrastructure Logging service. If logging is not enabled, configure the Data Catalog to send access logs to a designated log group in OCI Logging, ensuring proper retention and analysis capabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - CIS OCI Foundations Benchmark
  - NIST SP 800-53
- rule_id: oci.data_catalog.catalog.ai_services_dataset_lifecycle_policy_configured
  service: data_catalog
  resource: catalog
  requirement: Ai Services Dataset Lifecycle Policy Configured
  scope: data_catalog.catalog.lifecycle_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure AI Services Dataset Lifecycle Policy is Configured
  rationale: Configuring a lifecycle policy for datasets in the OCI Data Catalog ensures data is managed effectively, reducing the risk of unauthorized access and data leakage. It supports compliance requirements by enforcing data retention policies, which are critical for meeting regulatory standards and minimizing business risks associated with data mishandling.
  description: This rule verifies that AI Services Dataset Lifecycle Policies are correctly configured in OCI Data Catalog. It checks that lifecycle policies are set to automate the transition and expiration of datasets according to organizational data governance policies. Remediation involves setting up lifecycle rules that define how and when datasets should be archived or deleted, ensuring data is managed securely throughout its lifecycle.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Tasks/managingcatalogs.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.oracle.com/security/cloud-security/best-practices/
  - CIS Oracle Cloud Infrastructure Foundation Benchmark
  - NIST SP 800-53 Rev. 5
- rule_id: oci.data_catalog.catalog.ai_services_dataset_s3_block_public_access_blocked
  service: data_catalog
  resource: catalog
  requirement: Ai Services Dataset S3 Block Public Access Blocked
  scope: data_catalog.catalog.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure Public Access to AI Services Dataset in OCI Data Catalog is Blocked
  rationale: Blocking public access to AI services datasets in the OCI Data Catalog is critical to protect sensitive data from unauthorized exposure. This helps prevent data breaches, supports compliance with regulatory requirements such as GDPR, and mitigates potential financial and reputational damage to the organization.
  description: This rule checks if public access to datasets used by AI services within the OCI Data Catalog is properly blocked. Public access can be inadvertently set, leading to unauthorized data exposure. To remediate, ensure that dataset permissions are configured to restrict access to authenticated and authorized users only, using OCI Identity and Access Management policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.oracle.com/security/cloud/cloud-compliance/
- rule_id: oci.data_catalog.catalog.ai_services_dataset_s3_encrypted_at_rest
  service: data_catalog
  resource: catalog
  requirement: Ai Services Dataset S3 Encrypted At Rest
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure AI Services Dataset in Data Catalog is Encrypted at Rest
  rationale: Encrypting datasets at rest in Oracle Cloud Infrastructure's Data Catalog protects against unauthorized access and data breaches. This practice is essential for maintaining data confidentiality and integrity, aligning with compliance requirements such as GDPR, PCI-DSS, and HIPAA, and mitigating the risk of data exposure due to physical theft or unauthorized access to storage devices.
  description: This rule checks whether AI Services Datasets stored in the OCI Data Catalog are encrypted at rest. It verifies that encryption keys are implemented using Oracle Key Management or customer-managed keys to ensure that all stored data is secured. To remediate non-compliance, configure your Data Catalog to enforce encryption using the OCI Console or the CLI by enabling encryption settings for datasets. Regularly review encryption configurations to ensure ongoing compliance with security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_catalog.catalog.ai_dataset_encrypted_at_rest_cmek
  service: data_catalog
  resource: catalog
  requirement: Ai Dataset Encrypted At Rest Cmek
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure AI Dataset in Data Catalog is Encrypted with CMEK
  rationale: Encrypting data at rest using Customer Managed Encryption Keys (CMEK) ensures that sensitive data is protected by keys that you control, reducing the risk of unauthorized access. This is critical for compliance with regulatory requirements such as GDPR, HIPAA, and PCI-DSS, and helps maintain customer trust by safeguarding data privacy.
  description: This rule checks if AI datasets stored in Oracle Cloud Infrastructure's Data Catalog are encrypted at rest using Customer Managed Encryption Keys. Proper encryption setup ensures that only authorized users with access to the keys can decrypt and access the data. Remediation involves configuring the Data Catalog to use CMEK, ensuring encryption keys are stored and managed securely in the OCI Vault service.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/keysoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
- rule_id: oci.data_catalog.catalog.ai_dataset_public_access_blocked_blocked
  service: data_catalog
  resource: catalog
  requirement: Ai Dataset Public Access Blocked Blocked
  scope: data_catalog.catalog.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure AI Dataset Public Access is Blocked in Data Catalog
  rationale: Blocking public access to AI datasets in the OCI Data Catalog is crucial to prevent unauthorized data exposure, which could lead to data breaches and non-compliance with data protection regulations such as GDPR and CCPA. Publicly accessible datasets increase the risk of sensitive data being misused by malicious actors, potentially resulting in financial and reputational damage to the organization.
  description: This rule checks whether AI datasets stored in the Oracle Cloud Infrastructure Data Catalog are configured to block public access. It verifies that no datasets are publicly accessible, ensuring that access is restricted only to authorized users within the organization. To remediate this issue, review the dataset permissions in the Data Catalog and ensure that public access is disabled. Implement access control policies that limit visibility and access to trusted identities within your OCI tenancy.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.data_catalog.job.quality_jobs_role_least_privilege_required
  service: data_catalog
  resource: job
  requirement: Quality Jobs Role Least Privilege Required
  scope: data_catalog.job.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Data Catalog Job Roles Follow Least Privilege Principle
  rationale: Enforcing least privilege for Data Catalog jobs is critical to minimize unauthorized access and reduce the risk of data breaches. Over-privileged roles can lead to accidental or malicious data exposure, undermining compliance with regulations such as GDPR or CCPA. Properly scoped permissions enhance security posture and limit potential attack vectors.
  description: This rule checks that roles assigned to Data Catalog jobs have the least privilege necessary to perform their required functions. It verifies that permissions are not overly broad, focusing only on what is necessary for job execution. If any roles are found to have excessive permissions, remediation involves reviewing and refining these roles to align with the principle of least privilege, using OCI's Identity and Access Management (IAM) policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
- rule_id: oci.data_catalog.catalog.quality_logs_enabled
  service: data_catalog
  resource: catalog
  requirement: Quality Logs Enabled
  scope: data_catalog.catalog.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Data Catalog Quality Logs are Enabled
  rationale: Enabling quality logs for Oracle Data Catalog ensures that any data quality issues are captured and monitored, allowing for timely resolution and maintaining the integrity of data assets. This practice helps in meeting compliance standards and enhances the overall security posture by providing visibility into data catalog operations.
  description: This rule checks whether quality logs are enabled for Oracle Data Catalog instances. Quality logs provide detailed information on data quality processes and any issues that may arise. To verify, inspect the logging configuration within the OCI Console under the Data Catalog service to ensure logging is activated. If not enabled, configure quality logging through the Data Catalog settings to improve monitoring and compliance adherence.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Tasks/datacataloglogging.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.data_catalog.catalog.quality_outputs_encrypted_and_private
  service: data_catalog
  resource: catalog
  requirement: Quality Outputs Encrypted And Private
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Catalog Outputs Are Encrypted and Private
  rationale: Ensuring that data catalog outputs are both encrypted and private is crucial to protect sensitive information from unauthorized access or breaches. Unencrypted or publicly accessible data can lead to significant security incidents, non-compliance with regulations such as GDPR or HIPAA, and potential financial and reputational damage to the organization.
  description: This rule checks that all outputs from the OCI Data Catalog are encrypted using OCI's encryption services and that access is restricted to authorized users. It verifies that encryption at rest and in transit is implemented and that IAM policies restrict access to the catalog outputs. Remediation involves configuring the OCI Data Catalog settings to enable encryption and updating IAM policies to enforce least privilege access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.oracle.com/security/cloud-security/best-practices/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.data_catalog.catalog.ruleset_encrypted_at_rest
  service: data_catalog
  resource: catalog
  requirement: Ruleset Encrypted At Rest
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Catalog Rulesets Are Encrypted At Rest
  rationale: Encrypting data at rest helps protect sensitive information from unauthorized access and data breaches. It is a crucial part of a comprehensive data protection strategy, aligning with compliance standards such as PCI-DSS, HIPAA, and ISO 27001, which mandate strong data encryption methods.
  description: This rule checks whether the rulesets within the OCI Data Catalog service are encrypted at rest. The verification involves ensuring that all data stored in the catalog is encrypted using OCI's built-in encryption mechanisms. To remediate, enable encryption for data catalog rulesets through the OCI Console or CLI, ensuring that all sensitive data is protected by default.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_common.htm#encryption
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.data_catalog.catalog.ruleset_rbac_least_privilege_required
  service: data_catalog
  resource: catalog
  requirement: Ruleset RBAC Least Privilege Required
  scope: data_catalog.catalog.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Data Catalog RBAC Enforces Least Privilege
  rationale: Implementing least privilege in role-based access control (RBAC) minimizes the risk of unauthorized access and potential data breaches. It ensures that users have only the permissions necessary to perform their tasks, reducing the attack surface and maintaining compliance with standards such as PCI-DSS and ISO 27001.
  description: This rule checks whether the RBAC policies associated with the Data Catalog service are configured to enforce the principle of least privilege. It verifies that roles assigned to users and groups have minimum required permissions. To remediate, review and adjust IAM policies to restrict access based on the principle of least privilege, ensuring that users only have permissions necessary for their job functions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/iampolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://www.pcisecuritystandards.org
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.data_catalog.catalog.ruleset_version_pinned_required
  service: data_catalog
  resource: catalog
  requirement: Ruleset Version Pinned Required
  scope: data_catalog.catalog.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enforce Ruleset Version Pinning for Data Catalog
  rationale: Ensuring that data catalog rulesets are pinned to specific versions prevents inadvertent changes that could expose sensitive data or result in non-compliance. This practice reduces risks associated with automated updates that might introduce vulnerabilities or disrupt data protection configurations.
  description: This rule checks if the data catalog resources have their ruleset versions explicitly pinned. Pinning ruleset versions is crucial for maintaining consistent data classification and governance. To verify compliance, assess the data catalog configurations to ensure ruleset versions are specified. Remediation involves updating the catalog configuration to pin the ruleset to a fixed version, preventing automatic updates.
  references:
  - https://docs.oracle.com/en-us/iaas/data-catalog/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_flow.application.training_pipeline_private_networking_enforced
  service: data_flow
  resource: application
  requirement: Training Pipeline Private Networking Enforced
  scope: data_flow.application.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Private Networking for Data Flow Training Pipelines
  rationale: Enforcing private networking for Data Flow training pipelines is crucial for protecting sensitive data from exposure to the public internet. It reduces the risk of unauthorized access and data breaches by ensuring that data and resources are only accessible within a secured, private network. This aligns with best practices for data privacy and compliance with security frameworks.
  description: This rule checks whether Oracle Cloud Infrastructure Data Flow applications, specifically training pipelines, are configured to use private networking. It verifies that the applications are not exposed to the public internet by ensuring that their networking settings restrict access to within a Virtual Cloud Network (VCN). Remediation involves configuring the pipeline's networking options to leverage private subnets and security lists, enhancing security by limiting access to trusted network paths.
  references:
  - https://docs.oracle.com/en-us/iaas/data-flow/using/data-flow-intro.html
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.oracle.com/cloud/security/compliance/
  - NIST SP 800-53
  - ISO 27001
  - CIS OCI Foundations Benchmark
- rule_id: oci.data_flow.application.training_pipeline_secrets_from_vault_only
  service: data_flow
  resource: application
  requirement: Training Pipeline Secrets From Vault Only
  scope: data_flow.application.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure Data Flow Applications Use Secrets from OCI Vault
  rationale: Using secrets directly from OCI Vault ensures that sensitive information, such as API keys and passwords, is stored securely and accessed in a controlled manner. This minimizes security risks associated with hardcoding secrets in application code, reducing the potential for unauthorized access and data breaches. Compliance with security standards and regulations like ISO 27001 and SOC2 is also supported by using a centralized secrets management system.
  description: This rule checks that all Data Flow applications in OCI are configured to retrieve secrets exclusively from the OCI Vault service. Verifying this configuration involves ensuring that application configurations do not include hardcoded secrets or credentials. Remediation includes updating application configurations to reference secrets stored in OCI Vault and ensuring that all access permissions are properly managed and audited.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataFlow/Concepts/dataflowoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.oracle.com/security-best-practices/
  - https://www.oracle.com/cloud/cloud-compliance/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/sorhome.html
- rule_id: oci.data_flow.application.ai_services_training_job_inter_container_enabled
  service: data_flow
  resource: application
  requirement: Ai Services Training Job Inter Container Enabled
  scope: data_flow.application.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure AI Services Training Job Inter-Container Communication is Enabled
  rationale: Enabling inter-container communication for AI services training jobs is crucial for operational efficiency and data integrity. This configuration allows distributed training processes to communicate effectively, ensuring that data flows seamlessly between containers, which can enhance model training performance and accuracy. Disabling inter-container communication may lead to training inefficiencies and increased operational overhead.
  description: This rule checks whether inter-container communication is enabled for AI services training jobs within OCI Data Flow applications. If disabled, it may hinder the ability of distributed AI training jobs to synchronize and share data across containers, potentially impacting the performance and accuracy of AI models. To remediate, ensure that the OCI Data Flow application configuration permits inter-container networking, allowing AI training jobs to function optimally.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/data-flow/home.htm
  - https://www.oracle.com/security/cloud-security/
  - https://www.oracle.com/cloud-compliance/
  - 'NIST SP 800-53: Security and Privacy Controls for Information Systems and Organizations'
  - CIS OCI Foundations Benchmark
  - ISO/IEC 27001:2013 - Information Security Management
- rule_id: oci.data_flow.application.ai_services_training_job_network_isolation_enabled
  service: data_flow
  resource: application
  requirement: Ai Services Training Job Network Isolation Enabled
  scope: data_flow.application.network_security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Network Isolation for AI Services Training Jobs
  rationale: Enabling network isolation for AI services training jobs minimizes the risk of unauthorized data access and exposure by ensuring that training environments are not accessible from external networks. This is crucial for maintaining data protection and privacy, especially when handling sensitive datasets, and helps in meeting compliance requirements for data security standards such as GDPR and HIPAA.
  description: This rule verifies that network isolation is enabled for AI services training jobs within Oracle Cloud Infrastructure's Data Flow service. Network isolation ensures that the training job is restricted to a private network, preventing external access and potential data breaches. Remediation involves configuring the training job settings to enable network isolation, typically by ensuring that the job is run within a Virtual Cloud Network with appropriate security rules.
  references:
  - https://docs.oracle.com/en-us/iaas/data-flow/doc/training-job-best-practices.html
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_flow.application.ai_services_training_job_output_encryption_enabled
  service: data_flow
  resource: application
  requirement: Ai Services Training Job Output Encryption Enabled
  scope: data_flow.application.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure AI Services Training Job Output Encryption is Enabled
  rationale: Enabling encryption for AI Services Training Job outputs is critical to protect sensitive data and intellectual property from unauthorized access. It mitigates risks associated with data breaches and ensures compliance with data protection regulations such as GDPR and CCPA. This practice supports maintaining customer trust and safeguarding organizational reputation.
  description: This rule verifies that encryption is enabled for outputs generated by AI services training jobs within Oracle Cloud Infrastructure Data Flow applications. It checks for the application of encryption protocols to ensure data confidentiality and integrity during storage and transit. To remediate, configure the Data Flow application settings to enable encryption for training job outputs, using OCI's encryption capabilities, such as Oracle Key Management or customer-managed keys.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataFlow/Concepts/dataflowoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/keyoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/publications/nist-special-publication-800-53-revision-5
- rule_id: oci.data_flow.application.ai_services_training_job_volume_encryption_enabled
  service: data_flow
  resource: application
  requirement: Ai Services Training Job Volume Encryption Enabled
  scope: data_flow.application.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure AI Services Training Job Volumes are Encrypted
  rationale: Encrypting volumes used in AI training jobs is crucial to protect sensitive data from unauthorized access and potential data breaches. Unencrypted volumes may expose confidential information, leading to compliance issues and reputational damage. Encryption helps in meeting regulatory requirements such as GDPR, HIPAA, and PCI-DSS.
  description: This rule checks if the volumes used by AI services training jobs in Oracle Cloud Infrastructure's Data Flow service are encrypted. Verification involves ensuring that the storage volumes have encryption enabled, which can be configured using the OCI Console or CLI. To remediate non-compliance, enable encryption for all AI training job volumes by setting the appropriate encryption options during the application setup or modifying existing configurations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataFlow/Concepts/dataflowoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_flow.application.ai_services_training_job_vpc_configured
  service: data_flow
  resource: application
  requirement: Ai Services Training Job VPC Configured
  scope: data_flow.application.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure AI Services Training Job Uses Configured VPC
  rationale: Configuring AI Services Training Jobs to run within a Virtual Private Cloud (VPC) is crucial for isolating resources and securing data. It minimizes exposure to potential threats by restricting network access and ensures compliance with data protection regulations by maintaining a controlled environment.
  description: This rule checks whether AI Services Training Jobs in OCI Data Flow are configured to use a VPC. It ensures that network isolation and security controls are in place. Remediation involves configuring your Data Flow applications to specify a VPC, which can be achieved through the OCI Console or CLI by setting the appropriate VCN and subnet parameters.
  references:
  - https://docs.oracle.com/en-us/iaas/data-flow/using/data-flow-deployment-options.html
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.oracle.com/security-best-practices/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.data_flow.application.streaming_security_analytics_checkpoints_and_outputs_encrypted
  service: data_flow
  resource: application
  requirement: Streaming Security Analytics Checkpoints And Outputs Encrypted
  scope: data_flow.application.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Streaming Checkpoints and Outputs in Data Flow are Encrypted
  rationale: Encrypting streaming checkpoints and outputs within OCI Data Flow is critical to protect sensitive data from unauthorized access and ensure compliance with data protection regulations. Failure to encrypt could lead to data breaches, exposing confidential information and potentially resulting in financial losses and reputational damage.
  description: This rule checks whether encryption is enabled for checkpoints and outputs in OCI Data Flow applications. To verify, ensure that the encryption settings for the data flow application are configured correctly to use Oracle-managed keys or customer-managed keys for data at rest. If encryption is not enabled, configure the application to utilize OCI Vault for managing encryption keys to safeguard sensitive data.
  references:
  - https://docs.oracle.com/en-us/iaas/data-flow/using/data-flow-security-best-practices.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.oracle.com/cloud/cloud-native/data-flow/
  - CIS OCI Foundations Benchmark
  - NIST SP 800-53
  - ISO/IEC 27001:2013
- rule_id: oci.data_flow.application.streaming_security_analytics_network_private_only_enforced
  service: data_flow
  resource: application
  requirement: Streaming Security Analytics Network Private Only Enforced
  scope: data_flow.application.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Data Flow Applications Use Private Network for Security Analytics
  rationale: Using a private network for streaming security analytics minimizes the exposure of sensitive data to the internet, reducing the risk of data breaches, unauthorized access, and potential compliance violations. It ensures that only authorized entities within a private network have access, aligning with best practices in network security.
  description: This rule verifies that Oracle Cloud Infrastructure Data Flow applications handling streaming security analytics are configured to use only private network endpoints. To comply, review the network configuration of your Data Flow applications and ensure they are set to utilize private IPs, avoiding public internet exposure. Remediation involves modifying the network settings to restrict traffic to a Virtual Cloud Network (VCN) with appropriate security lists and network security groups (NSGs).
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataFlow/Concepts/dataflowoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/ocisecuritybestpractices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_flow.application.streaming_security_analytics_role_least_privilege_required
  service: data_flow
  resource: application
  requirement: Streaming Security Analytics Role Least Privilege Required
  scope: data_flow.application.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Data Flow Streaming Analytics Role
  rationale: Implementing least privilege access for roles in OCI Data Flow minimizes potential attack vectors by ensuring that users and applications only have access to necessary resources. This prevents unauthorized access and data breaches, aligning with security compliance frameworks and reducing the risk of exploitations.
  description: This rule checks whether the Streaming Security Analytics Role in OCI Data Flow applications is configured with the least privilege principle. It verifies that the role has only the necessary permissions to perform its intended functions. Remediation involves reviewing the role's permissions and adjusting them to ensure they are minimal and strictly necessary for operational purposes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataFlow/Concepts/dataflowoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://cloudsecurityalliance.org/research/guidance
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_flow.application.cluster_admin_access_least_privilege_required
  service: data_flow
  resource: application
  requirement: Cluster Admin Access Least Privilege Required
  scope: data_flow.application.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure Data Flow Applications Use Least Privilege for Cluster Admin Access
  rationale: Granting excessive permissions to cluster administrators in OCI Data Flow applications increases the risk of unauthorized access and potential data breaches. Adhering to the principle of least privilege minimizes the attack surface, ensuring that users and services have only the permissions necessary to perform their tasks. This is critical for maintaining compliance with standards such as ISO 27001 and preventing potential financial and reputational damage.
  description: This rule checks that OCI Data Flow applications do not grant excessive cluster admin permissions beyond what is necessary. It verifies the IAM policies associated with Data Flow applications and ensures they adhere to the least privilege principle. Remediation involves reviewing and updating IAM policies to remove unnecessary permissions, ensuring that only essential access is granted to users and services.
  references:
  - https://docs.oracle.com/en-us/iaas/data-flow/using/index.html
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.oracle.com/a/ocom/docs/cloud/cis-oracle-cloud-infrastructure-v1-0-0.pdf
  - https://www.nist.gov/publications/security-and-privacy-controls-information-systems-and-organizations
  - https://www.iso.org/standard/54534.html
- rule_id: oci.data_flow.application.cluster_audit_logging_enabled
  service: data_flow
  resource: application
  requirement: Cluster Audit Logging Enabled
  scope: data_flow.application.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Data Flow Application Cluster Audit Logging is Enabled
  rationale: Enabling audit logging for Data Flow applications enhances security by providing visibility into cluster operations and user activities. This is critical for detecting unauthorized access, troubleshooting issues, and ensuring compliance with industry standards. Without audit logging, organizations may face challenges in forensic investigations and risk non-compliance with regulations like GDPR and ISO 27001.
  description: This rule checks whether audit logging is enabled for Oracle Cloud Infrastructure Data Flow applications. Audit logging should be configured to capture detailed logs of all cluster activities and user interactions. To remediate, ensure that the logging service is correctly set up and that Data Flow applications are configured to send logs to the designated logging service. This includes verifying logging policies and ensuring logs are stored securely for the required retention period.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataFlow/Concepts/dataflowoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://cloudsecurityalliance.org/artifacts/cloud-controls-matrix-v4/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.data_flow.application.cluster_encryption_cmek_enabled
  service: data_flow
  resource: application
  requirement: Cluster Encryption Cmek Enabled
  scope: data_flow.application.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Data Flow Applications Use Customer-Managed Encryption Keys
  rationale: Enabling cluster encryption with customer-managed keys (CMEK) enhances data security by allowing organizations to control and manage encryption keys. This reduces the risk of unauthorized data access and ensures compliance with various data protection regulations such as GDPR and HIPAA. It also mitigates the potential impact of data breaches by ensuring that only authorized users have access to the encryption keys.
  description: This rule checks whether Oracle Cloud Infrastructure Data Flow applications are configured to use customer-managed encryption keys (CMEK) for data at rest. If CMEK is not enabled, the default Oracle-managed keys are used, which may not meet specific organizational compliance or security requirements. To remediate, configure Data Flow applications to utilize CMEK by selecting a key from Oracle Cloud Infrastructure Vault, ensuring that the key is properly managed and permissions are correctly set.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataFlow/Concepts/dataflowoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_flow.application.cluster_private_networking_enforced
  service: data_flow
  resource: application
  requirement: Cluster Private Networking Enforced
  scope: data_flow.application.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Data Flow Applications Use Cluster Private Networking
  rationale: Enforcing cluster private networking for Data Flow applications ensures that the communication between the application and its resources remains within the private network, mitigating the risk of exposure to the public internet. This is crucial for protecting sensitive data and maintaining compliance with security standards and regulations.
  description: This rule checks whether Data Flow applications in OCI enforce the use of cluster private networking, which restricts network traffic to the private IP space. To verify compliance, inspect the application's networking configuration for private network settings. Remediation involves configuring the Data Flow application to use VCN and private subnets, ensuring no external IP addresses are used for communication.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataFlow/Concepts/dataflowoverview.htm#Cluster_Private_Networking
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
- rule_id: oci.data_flow.application.cluster_tls_min_1_2_enforced
  service: data_flow
  resource: application
  requirement: Cluster TLS Min 1 2 Enforced
  scope: data_flow.application.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure TLS 1.2 or Higher is Enforced for Data Flow Applications
  rationale: Enforcing TLS 1.2 or higher for Data Flow applications is crucial to protect data in transit from interception and tampering. This practice mitigates risks associated with outdated encryption protocols, aligning with industry standards and regulatory compliance requirements such as PCI-DSS and ISO 27001, thus safeguarding sensitive information and maintaining customer trust.
  description: This rule checks if the Data Flow applications in Oracle Cloud Infrastructure enforce a minimum of TLS 1.2 for secure communication. TLS 1.2 provides enhanced security features compared to older versions. To verify compliance, review the application configuration settings in the OCI Console to ensure TLS 1.2 or higher is specified. Remediate by updating the application settings to enforce TLS 1.2 or above, thus ensuring robust encryption for data in transit.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataFlow/Tasks/dataflowusingconsole.htm
  - https://www.oracle.com/security/cloud-security/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-52/rev-2/final
  - https://cloudsecurityalliance.org/research/artifacts/security-guidance-v4/
- rule_id: oci.data_integration.pipeline.ai_services_pipeline_iam_role_least_privileged_enforced
  service: data_integration
  resource: pipeline
  requirement: Ai Services Pipeline IAM Role Least Privileged Enforced
  scope: data_integration.pipeline.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privileged Access for AI Services Pipeline IAM Roles
  rationale: Enforcing least privileged access for IAM roles in AI Services Pipelines is critical to minimizing security risks such as unauthorized data access and potential misuse of resources. This practice helps ensure compliance with security standards by limiting permissions to only those necessary for the task, thereby reducing the attack surface and protecting sensitive data.
  description: This rule checks whether IAM roles associated with AI Services Pipelines are configured with the least privileged access necessary for their operation. It verifies that roles do not have excessive permissions beyond what is required for specific tasks within the pipeline. Remediation involves reviewing and adjusting IAM policies to align with the principle of least privilege, ensuring that roles are granted only the permissions essential to perform their designated functions.
  references:
  - https://docs.oracle.com/en/cloud/paas/integration-cloud/oci-integrations/index.html
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security-best-practices.htm
- rule_id: oci.data_integration.workspace.ai_services_pipeline_kms_encryption_enabled
  service: data_integration
  resource: workspace
  requirement: Ai Services Pipeline KMS Encryption Enabled
  scope: data_integration.workspace.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure KMS Encryption is Enabled for AI Services Pipelines
  rationale: Enabling KMS encryption for AI services pipelines protects sensitive data processed within Oracle Cloud Infrastructure, reducing the risk of unauthorized data access or breaches. This alignment with data protection best practices is crucial for maintaining compliance with regulations such as GDPR, HIPAA, and industry standards like ISO 27001.
  description: This rule verifies whether Key Management Service (KMS) encryption is enabled for AI services pipelines within OCI Data Integration workspaces. KMS encryption ensures that data at rest is securely encrypted using keys managed by OCI, safeguarding against data leaks and unauthorized access. To remediate, ensure that the AI services pipeline configuration includes enabling KMS encryption by selecting an appropriate encryption key from OCI KMS.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.oracle.com/a/ocom/docs/oci-security-best-practices.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-210.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.data_integration.workspace.ai_services_pipeline_logging_enabled
  service: data_integration
  resource: workspace
  requirement: Ai Services Pipeline Logging Enabled
  scope: data_integration.workspace.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure AI Services Pipeline Logging is Enabled in Data Integration Workspaces
  rationale: Enabling logging for AI services pipelines in OCI Data Integration workspaces is crucial for monitoring, troubleshooting, and securing data processing activities. Without logging, it becomes challenging to detect unauthorized access, diagnose issues, and ensure compliance with data protection regulations, potentially leading to data breaches or non-compliance with frameworks like GDPR or ISO 27001.
  description: This rule checks if logging is enabled for AI services pipelines within OCI Data Integration workspaces. To verify, ensure that logging levels are properly configured and logs are being stored and monitored in the OCI Logging service. Remediation involves setting up the logging configuration within the workspace settings, enabling relevant log categories, and ensuring logs are retained according to organizational policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/dataintegrationoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.data_integration.pipeline.data_pipeline_access_controls_least_privilege_required
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Access Controls Least Privilege Required
  scope: data_integration.pipeline.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for OCI Data Pipeline Access Controls
  rationale: Implementing least privilege access controls for OCI Data Integration pipelines mitigates unauthorized data access risks and potential data breaches. This practice aligns with compliance requirements such as GDPR and SOC2, ensuring only necessary permissions are granted, thus reducing the attack surface.
  description: This rule checks that OCI Data Integration pipelines adhere to the principle of least privilege by evaluating user and service principal permissions. It ensures that no more permissions than necessary are assigned for pipeline operations. Remediation involves reviewing and adjusting IAM policies to restrict access, ensuring only authorized roles have the necessary permissions to execute and manage pipelines.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/dataintegrationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_integration.workspace.data_pipeline_private_networking_enforced
  service: data_integration
  resource: workspace
  requirement: Data Pipeline Private Networking Enforced
  scope: data_integration.workspace.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Enforce Private Networking for Data Integration Pipelines
  rationale: Enforcing private networking for data pipelines ensures that data transfer remains within a secure and controlled network environment, reducing exposure to unauthorized access and potential data breaches. By leveraging private networking, organizations can comply with regulatory requirements such as PCI-DSS and HIPAA, which mandate secure data handling and transmission.
  description: This rule checks if the data integration workspace is configured to use private networking for data pipelines. It verifies that the workspace is set up to route traffic through a Virtual Cloud Network (VCN) instead of the public internet, thereby minimizing security risks. Remediation involves configuring the workspace to use a private subnet within a VCN and updating security lists or network security groups to control traffic flow.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/dataintegrationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.oracle.com/cloud/cloud-security/compliance/pci-dss/
  - https://www.oracle.com/cloud/cloud-security/compliance/hipaa.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://cloudsecurityalliance.org/research/guides/cloud-controls-matrix/
- rule_id: oci.data_integration.workspace.ml_transform_logs_enabled
  service: data_integration
  resource: workspace
  requirement: Ml Transform Logs Enabled
  scope: data_integration.workspace.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure ML Transform Logs Are Enabled for Data Integration Workspaces
  rationale: Enabling ML Transform Logs in Data Integration Workspaces is crucial for monitoring and auditing data transformations, which helps in identifying potential security incidents and performance issues. It also supports compliance with industry standards by maintaining a detailed record of data processing activities, thereby reducing the risk of data breaches and ensuring data integrity.
  description: This rule checks whether Machine Learning (ML) Transform Logs are enabled for Oracle Cloud Infrastructure (OCI) Data Integration Workspaces. Log collection is vital for tracking the execution and outcome of ML transforms, providing insights into operational and security events. To remediate, navigate to the OCI Console, access the Data Integration service, and ensure that logging is enabled for each workspace. This involves configuring the logging service to capture all relevant logs and ensuring they are retained according to your organization's policy.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/data-integration-overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/cloud/cloud-security/
- rule_id: oci.data_integration.workspace.ml_transform_network_private_only_enforced
  service: data_integration
  resource: workspace
  requirement: Ml Transform Network Private Only Enforced
  scope: data_integration.workspace.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure ML Transform Network Only Accessible via Private Connections
  rationale: Restricting ML Transform network connections to private endpoints helps prevent unauthorized access, data breaches, and ensures compliance with security standards. It minimizes exposure to public networks, reducing the risk of interceptive attacks and enhancing the overall security posture of data integration operations.
  description: This rule checks that the network access for ML Transforms within an OCI Data Integration Workspace is restricted to private networks only. It verifies that no public endpoints are configured, ensuring all data processing is conducted securely within the controlled boundaries of a private network. To remediate, configure the workspace network settings to use private subnets, and remove any public internet gateways or NAT instances associated with ML Transform services.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/dataintegrationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.oracle.com/cloud/cloud-security/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf?agreement=true&time=1623840019603
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_integration.workspace.ml_transform_role_least_privilege_required
  service: data_integration
  resource: workspace
  requirement: Ml Transform Role Least Privilege Required
  scope: data_integration.workspace.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure ML Transform Role in Data Integration Uses Least Privilege
  rationale: Implementing the principle of least privilege for ML Transform roles in OCI Data Integration reduces the risk of unauthorized access and mitigates potential data breaches. This is crucial for maintaining data integrity, ensuring regulatory compliance, and protecting sensitive information from insider threats or external attacks.
  description: This rule checks that ML Transform roles in OCI Data Integration workspaces are assigned the minimum permissions required to perform their tasks. It involves reviewing and adjusting IAM policies to ensure they grant only necessary access. Remediation includes analyzing role permissions and revoking any excessive privileges that are not essential for the role's function.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/dataintegrationoverview.htm
  - https://www.oracle.com/security-cloud-compliance/identity-access-management/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
- rule_id: oci.data_integration.pipeline.data_pipeline_security_artifacts_private_and_encrypted
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Artifacts Private And Encrypted
  scope: data_integration.pipeline.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Pipeline Artifacts Are Private and Encrypted
  rationale: Ensuring that data pipeline security artifacts are private and encrypted is crucial to protect sensitive data from unauthorized access and potential data breaches. This practice mitigates risks associated with data exposure and helps maintain compliance with data protection regulations such as GDPR, HIPAA, and PCI-DSS, thereby safeguarding the organization's reputation and avoiding legal penalties.
  description: This rule checks that all security artifacts associated with OCI Data Integration pipelines, such as configurations and credentials, are stored in a private and encrypted manner. It verifies that encryption is enabled for data at rest and that access to these artifacts is restricted through OCI Identity and Access Management (IAM) policies. Remediation involves configuring encryption settings in the OCI Console and ensuring that IAM policies enforce the principle of least privilege for access to these artifacts.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/data-integration-overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
- rule_id: oci.data_integration.pipeline.data_pipeline_security_execution_roles_least_privilege_required
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Execution Roles Least Privilege Required
  scope: data_integration.pipeline.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for OCI Data Integration Pipeline Execution Roles
  rationale: Implementing least privilege for data pipeline execution roles minimizes potential security risks by restricting access to only necessary permissions. This reduces the attack surface, mitigates the risk of unauthorized data access, and ensures compliance with security frameworks that mandate strict access controls.
  description: This rule checks that execution roles associated with OCI Data Integration pipelines adhere to the principle of least privilege. It verifies that roles do not possess excessive permissions beyond what is necessary for pipeline execution. Remediation involves reviewing and adjusting IAM policies to ensure that roles only have permissions essential for their specific tasks. This includes removing any broad or unnecessary permissions and regularly auditing roles for compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/access/
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/home.htm
  - https://www.oracle.com/security/cloud-compliance/
  - CIS OCI Benchmark - Identity and Access Management
  - NIST SP 800-53 - Access Control
  - ISO/IEC 27001 - Access Control Policies
- rule_id: oci.data_integration.pipeline.data_pipeline_security_kms_encryption_enabled
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security KMS Encryption Enabled
  scope: data_integration.pipeline.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure KMS Encryption for Data Integration Pipelines
  rationale: Enabling KMS encryption for data integration pipelines protects sensitive data from unauthorized access and potential breaches. This is crucial for maintaining data confidentiality and integrity, especially for organizations handling regulated or sensitive information. Failure to encrypt data at rest can lead to non-compliance with industry standards such as PCI-DSS, HIPAA, and GDPR, resulting in hefty fines and reputational damage.
  description: This rule checks if Oracle Cloud Infrastructure Data Integration pipelines are configured with Key Management Service (KMS) encryption. To verify, ensure that all data integration pipelines are associated with a KMS key within OCI. Remediation involves configuring the data pipeline to use a KMS key by accessing the pipeline settings in the OCI console and selecting the appropriate encryption key. This ensures that all data processed by the pipeline is encrypted at rest, leveraging OCI's built-in encryption capabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/dioverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-1-0-0.htm
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/index.html
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- rule_id: oci.data_integration.pipeline.data_pipeline_security_logs_and_metrics_enabled
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Logs And Metrics Enabled
  scope: data_integration.pipeline.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Security Logs and Metrics for OCI Data Integration Pipelines
  rationale: Enabling security logs and metrics for OCI Data Integration Pipelines ensures visibility into pipeline activities, helping to detect unauthorized access and configuration changes. It aids in identifying potential data breaches and compliance violations, thereby reducing business risk and supporting regulatory requirements such as GDPR and PCI-DSS.
  description: This rule checks if logging and monitoring are enabled for OCI Data Integration Pipelines, ensuring that security-related activities are recorded. Verify that audit logs are configured to capture events such as pipeline creation, execution, and modification. Enable metrics to monitor pipeline performance and detect anomalies. Use the OCI Logging and Monitoring services to set up alerts for suspicious activities. Remediation involves accessing the OCI Console, navigating to the Data Integration service, and configuring logging and monitoring settings for each pipeline.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://www.oracle.com/cloud/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations/
  - https://www.oracle.com/security/cloud-security/identity-and-access/
  - https://www.oracle.com/audit/
- rule_id: oci.data_integration.pipeline.data_pipeline_security_private_networking_enforced
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Private Networking Enforced
  scope: data_integration.pipeline.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Enforce Private Networking for Data Integration Pipelines
  rationale: Ensuring data integration pipelines operate within private networks minimizes exposure to external threats and data breaches. It protects sensitive data from being accessed over the public internet, thereby reducing the risk of interception by unauthorized entities. Compliance with regulations such as GDPR and CCPA is also supported by enforcing private networking, as it aligns with best practices for data protection and confidentiality.
  description: This rule checks whether data integration pipelines in OCI are configured to use private networking instead of public endpoints. It verifies that pipelines are set to operate within Virtual Cloud Networks (VCNs) with appropriate security lists and network security groups. To remediate, ensure that all data integration pipelines are associated with a private subnet and that no public IP addresses are assigned. This can be verified and configured through the OCI Console under 'Networking' > 'Virtual Cloud Networks'.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/data_integrationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.oracle.com/cloud/cloud-infrastructure-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations_benchmark/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.data_integration.pipeline.data_pipeline_security_definition_signed_and_verified_validated
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Definition Signed And Verified Validated
  scope: data_integration.pipeline.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Pipeline Security Definitions Are Signed and Verified
  rationale: Validating the integrity and authenticity of data pipeline security definitions is crucial for protecting sensitive data and maintaining trust in data processes. Unsigned or unverified definitions can lead to unauthorized access, data breaches, or data manipulation, impacting business operations and regulatory compliance with standards like GDPR and CCPA.
  description: This rule checks that all data pipeline security definitions within OCI Data Integration are properly signed and verified. Ensure that security definitions are created and managed using OCI's built-in signing tools, and verify their signatures regularly. Remediation involves using OCI's key management services to sign definitions and setting up automated verification processes to detect any unauthorized changes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/data_integration_overview.htm
  - https://www.oracle.com/security/cloud-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_integration.pipeline.data_pipeline_security_definition_storage_encrypted
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Definition Storage Encrypted
  scope: data_integration.pipeline.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Pipeline Storage is Encrypted at Rest
  rationale: Encrypting data pipeline storage at rest is essential to protect sensitive data from unauthorized access and potential breaches. It mitigates risks associated with data theft or leakage, ensuring compliance with standards like PCI-DSS, HIPAA, and GDPR. Encryption also helps maintain customer trust and safeguards the organization's reputation by preventing data exposure.
  description: This rule checks whether encryption at rest is enabled for data pipeline security definitions in OCI Data Integration. It verifies that storage using Oracle-managed keys or customer-managed keys via Oracle Cloud Infrastructure Vault is appropriately configured. To remediate, ensure that encryption settings are enabled in the data pipeline configuration, using the OCI console or API to specify the use of encryption keys. Regularly audit encryption configurations and update keys as necessary to align with security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Integration/Concepts/di_overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/corporate-security-practices/
- rule_id: oci.data_integration.pipeline.data_pipeline_security_definition_storage_private_enforced
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Definition Storage Private Enforced
  scope: data_integration.pipeline.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Data Pipeline Storage Uses Private Networking
  rationale: Restricting data pipeline storage to private networking reduces the risk of unauthorized access and data exposure by ensuring that data flows only within secure, isolated networks. This is crucial for protecting sensitive data processed by pipelines and adhering to compliance requirements such as PCI-DSS and ISO 27001, which mandate stringent data protection controls.
  description: This rule checks that data integration pipelines are configured to use storage defined within private networks in OCI, thereby preventing exposure to public internet access. To verify, ensure that the storage associated with the data pipeline is connected to a Virtual Cloud Network (VCN) and has no public endpoints. Remediation steps include updating the pipeline configuration to utilize private endpoints and ensuring that all associated storage resources are within a secure VCN.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_oci.htm
  - https://community.oracle.com/docs/DOC-1040674
- rule_id: oci.data_integration.pipeline.data_pipeline_security_definition_version_immutability_enforced
  service: data_integration
  resource: pipeline
  requirement: Data Pipeline Security Definition Version Immutability Enforced
  scope: data_integration.pipeline.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enforce Immutability on Data Pipeline Security Definitions
  rationale: Enforcing immutability on data pipeline security definitions is crucial for maintaining data integrity and preventing unauthorized alterations that could lead to security breaches. This practice reduces the risk of malicious tampering, ensuring that data operations remain consistent and secure. Additionally, immutability is often a requirement for compliance with data protection regulations such as PCI-DSS and ISO 27001, which mandate stringent controls over data handling processes.
  description: This rule checks if the immutability settings for security definitions of data pipelines in OCI Data Integration are enforced. Specifically, it ensures that once a security definition version is deployed within a pipeline, it cannot be altered or deleted, thereby preserving its state. To verify, review the pipeline settings in the OCI console and confirm that the 'Immutability' option is enabled for security definitions. If not configured, enable this feature to comply with best practices and regulatory requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Reference/data-integration-overview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v4/
- rule_id: oci.data_integration.workspace.agent_orchestrator_data_exfiltration_policies_enforced
  service: data_integration
  resource: workspace
  requirement: Agent Orchestrator Data Exfiltration Policies Enforced
  scope: data_integration.workspace.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Exfiltration Policies Enforced in Data Integration
  rationale: Enforcing data exfiltration policies in OCI Data Integration's workspace is crucial to prevent unauthorized data transfer, which could lead to data breaches and non-compliance with data protection regulations such as GDPR and CCPA. Without these policies, sensitive data could be exfiltrated without detection, posing significant business and reputational risks.
  description: This rule checks whether agent orchestrator data exfiltration policies are configured and enforced within OCI Data Integration workspaces. To verify, ensure that policies are defined to monitor and control data movement activities. Remediation involves setting up and regularly reviewing these policies using OCI's security tools to align with organizational data protection standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/data-integration-overview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.oracle.com/cloud/security/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.iso.org/standard/73906.html
- rule_id: oci.data_integration.workspace.agent_orchestrator_secrets_isolation_enabled
  service: data_integration
  resource: workspace
  requirement: Agent Orchestrator Secrets Isolation Enabled
  scope: data_integration.workspace.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Agent Orchestrator Secrets Isolation is Enabled
  rationale: Enabling Agent Orchestrator Secrets Isolation is crucial for protecting sensitive credentials and data processed within Oracle Cloud Infrastructure's Data Integration service. This isolation minimizes the risk of unauthorized access and potential data breaches by ensuring that secrets are stored and managed securely. Compliance with data protection regulations such as GDPR and PCI-DSS also mandates proper isolation and encryption of sensitive information.
  description: This rule checks whether the secrets used by the Agent Orchestrator in OCI Data Integration workspaces are isolated and securely managed. To verify, ensure that the Agent Orchestrator secrets are stored using OCI Vault with encryption at rest enabled. Remediation involves configuring the OCI Vault to manage and isolate these secrets properly, ensuring that only authorized entities have access. Additionally, audit logs should be enabled to monitor access to these secrets.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/diagents.htm
  - https://docs.oracle.com/en-us/iaas/Content/Vault/Concepts/vaultsoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_integration.workspace.agent_orchestrator_tool_use_allowlist_enforced
  service: data_integration
  resource: workspace
  requirement: Agent Orchestrator Tool Use Allowlist Enforced
  scope: data_integration.workspace.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Agent Orchestrator Tool Use is Allowlist Enforced
  rationale: Enforcing an allowlist for the Agent Orchestrator tool is crucial for limiting access to only trusted agents, reducing the risk of unauthorized data manipulation or exposure. This is particularly important for maintaining data integrity and compliance with regulations such as GDPR and HIPAA, which require strict control over data processing activities.
  description: This rule checks if the OCI Data Integration workspace has implemented an allowlist for the Agent Orchestrator tool, ensuring that only specified, trusted agents can execute data orchestration tasks. Administrators should configure the allowlist by specifying the IP addresses or agent identifiers that are permitted. This can be verified by reviewing the workspace settings under the 'Security' section in the OCI console. Remediation involves updating the allowlist configuration to include only approved agents, ensuring compliance with organizational security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/data-integration/latest/
  - https://www.oracle.com/security/cloud-security/cis-benchmark/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/compliance/
- rule_id: oci.data_catalog.catalog.workflow_cross_account_trusts_restricted
  service: data_catalog
  resource: catalog
  requirement: Workflow Cross Account Trusts Restricted
  scope: data_catalog.catalog.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Restrict Workflow Cross Account Trusts in Data Catalog
  rationale: Restricting cross-account trusts in OCI Data Catalog workflows is crucial for preventing unauthorized access and potential data breaches. Allowing cross-account trusts without stringent controls can expose sensitive data to external entities, increasing the risk of data exfiltration and non-compliance with data protection regulations such as GDPR and CCPA.
  description: This rule checks for the presence of cross-account trusts in Data Catalog workflows and ensures they are restricted to only necessary accounts with defined access policies. To verify, review the IAM policies associated with the data catalog workflows and limit access to trusted accounts only. Remediation involves modifying IAM policies to restrict workflow executions and access permissions, ensuring compliance with data protection standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - NIST SP 800-53
  - https://www.oracle.com/security/cloud-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
- rule_id: oci.data_catalog.catalog.workflow_execution_role_least_privilege_required
  service: data_catalog
  resource: catalog
  requirement: Workflow Execution Role Least Privilege Required
  scope: data_catalog.catalog.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Workflow Execution Roles in Data Catalog
  rationale: Implementing least privilege for workflow execution roles in OCI's Data Catalog minimizes the risk of unauthorized access and potential data breaches. Excessive permissions can lead to privilege escalation and data exposure, impacting business continuity and compliance with regulations like GDPR and ISO 27001. Limiting access helps in reducing the attack surface and complying with best practices in identity and access management.
  description: This rule checks if the workflow execution roles in the OCI Data Catalog are assigned only the minimum necessary permissions to perform their tasks. To verify compliance, review role policies to ensure they grant the least privilege required for catalog operations. Remediation involves auditing current role assignments, updating policies to restrict permissions, and using OCI's policy versioning feature to track changes. Implementing this reduces the risk of accidental or malicious misuse of data catalog resources.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.data_catalog.catalog.workflow_kms_encryption_enabled
  service: data_catalog
  resource: catalog
  requirement: Workflow KMS Encryption Enabled
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Data Catalog Workflow KMS Encryption is Enabled
  rationale: Enabling KMS encryption for Data Catalog workflows ensures that sensitive metadata is protected at rest, mitigating the risk of unauthorized data access. This is crucial in maintaining data integrity and confidentiality, especially for organizations handling personally identifiable information (PII) or financial data. Compliance with regulations such as GDPR and CCPA mandates robust data protection mechanisms, including encryption.
  description: This rule checks if Oracle Cloud Infrastructure (OCI) Data Catalog workflows have KMS encryption enabled. KMS (Key Management Service) encryption provides a secure mechanism to protect metadata by using customer-managed keys. To verify, navigate to the Data Catalog service in the OCI console, select the catalog, and check the encryption settings under workflow configurations. If KMS encryption is not enabled, configure a KMS key in the OCI Vault service and apply it to your Data Catalog workflows to ensure data is encrypted at rest.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.oracle.com/security-cloud-compliance/data-encryption/
  - 'NIST SP 800-57: Recommendation for Key Management'
  - https://www.iso.org/iso-27001-information-security.html
  - 'CIS OCI Benchmark: 1.1.0 - 4.3 Ensure encryption is enabled for all OCI services'
- rule_id: oci.data_safe.data_safe_configuration.anonymization_jobs_private_networking_enforced
  service: data_safe
  resource: data_safe_configuration
  requirement: Anonymization Jobs Private Networking Enforced
  scope: data_safe.data_safe_configuration.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Private Networking for Data Safe Anonymization Jobs
  rationale: Enforcing private networking for Data Safe anonymization jobs is crucial to protect sensitive data from exposure to public networks, reducing the risk of unauthorized access and data breaches. This configuration is essential for maintaining data integrity and aligning with compliance requirements such as GDPR and HIPAA, which mandate secure data handling practices.
  description: This rule checks whether Data Safe anonymization jobs are configured to use private networking, which restricts data movement to secure, internal OCI networks. To verify, ensure that Data Safe is set to use a Virtual Cloud Network (VCN) and subnet within OCI for all anonymization tasks. Remediation involves configuring the Data Safe service to utilize private endpoints and VCNs, thereby ensuring that all data anonymization processes occur within a secure network boundary.
  references:
  - https://docs.oracle.com/en-us/iaas/data-safe/doc/data-safe-private-endpoints.html
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/cloud/architecture-center/security-best-practices/
- rule_id: oci.data_safe.security_assessment.anonymization_outputs_encrypted
  service: data_safe
  resource: security_assessment
  requirement: Anonymization Outputs Encrypted
  scope: data_safe.security_assessment.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Anonymization Outputs in Data Safe Are Encrypted
  rationale: Encrypting anonymization outputs protects sensitive data from unauthorized access, mitigating risks of data breaches and ensuring compliance with regulations such as GDPR and CCPA. It helps prevent potential exposure of sensitive information in case of unauthorized access to stored anonymized data.
  description: This rule checks if the outputs generated by the Data Safe security assessment anonymization process are encrypted at rest. It requires configuring Oracle Data Safe to use encryption for all anonymization outputs, ensuring data is protected when stored. Verify encryption settings in the Data Safe console under security assessment configurations. Remediate by enabling encryption for data storage, leveraging Oracle Cloud's encryption capabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/data-safe/doc/security-assessment-overview.html
  - https://docs.oracle.com/en-us/iaas/Content/CloudSecurity/Concepts/security_guide.htm#security
  - https://www.oracle.com/security/cloud-security/resources.html
  - https://www.iso.org/standard/54534.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57p1r4.pdf
- rule_id: oci.data_safe.masking_policy.masking_execution_roles_least_privilege_required
  service: data_safe
  resource: masking_policy
  requirement: Masking Execution Roles Least Privilege Required
  scope: data_safe.masking_policy.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Data Safe Masking Execution Roles
  rationale: Implementing least privilege for masking execution roles minimizes the risk of unauthorized data access and potential data breaches, which can lead to financial losses and reputational damage. It is crucial for complying with regulatory standards like GDPR and CCPA, which mandate stringent data protection measures.
  description: This rule checks if masking execution roles within Oracle Cloud Infrastructure Data Safe are configured with the least privilege principle. It verifies that roles have only the permissions necessary to execute masking policies without excessive access. To remediate, review and adjust the permissions of these roles, ensuring they align with their specific operational needs. Use Oracle Identity and Access Management tools to audit and modify role permissions.
  references:
  - https://docs.oracle.com/en-us/iaas/data-safe/doc/masking.html
  - https://docs.oracle.com/en-us/iaas/Content/Identity/accessmanagement.htm
  - NIST SP 800-53 Rev. 5 AC-6 Least Privilege
  - https://www.oracle.com/security/cloud-security/cis-benchmark/
  - https://www.oracle.com/security/cloud-security/whitepapers/
- rule_id: oci.data_safe.masking_policy.masking_policies_present_for_sensitive_fields
  service: data_safe
  resource: masking_policy
  requirement: Masking Policies Present For Sensitive Fields
  scope: data_safe.masking_policy.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Masking Policies for Sensitive Data Fields
  rationale: Implementing masking policies for sensitive fields is vital to prevent unauthorized access to confidential data, minimize the risk of data breaches, and meet regulatory compliance requirements such as GDPR and HIPAA. Without proper masking, sensitive data remains exposed, increasing the likelihood of data theft and non-compliance penalties.
  description: This rule checks that masking policies are applied to sensitive data fields within OCI Data Safe. It verifies the presence of masking policies that obfuscate sensitive information, reducing exposure and potential misuse. Users should regularly audit their masking policies, ensuring they are up-to-date and cover all fields classified as sensitive. To remediate, create or update masking policies in the OCI console under Data Safe, ensuring all sensitive fields are appropriately masked.
  references:
  - https://docs.oracle.com/en/cloud/paas/data-safe/udsdm/masking-data.html
  - https://www.oracle.com/security-cloud/data-safe/
  - 'NIST SP 800-53: AC-6, SC-28'
  - 'PCI-DSS Requirement 3: Protect Stored Cardholder Data'
  - ISO 27001:2013 A.8.2.3 Handling of Assets
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
- rule_id: oci.data_safe.security_assessment.classification_auto_enabled
  service: data_safe
  resource: security_assessment
  requirement: Classification Auto Enabled
  scope: data_safe.security_assessment.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Safe Security Assessment Classification is Auto-Enabled
  rationale: Automatically enabling classification in Data Safe security assessments is crucial as it ensures sensitive data is consistently identified and protected without manual intervention. This reduces the risk of data breaches and unauthorized access, enhancing compliance with data protection regulations like GDPR and CCPA. It also supports business continuity by maintaining data integrity and trustworthiness.
  description: This rule checks whether the classification feature in Oracle Cloud Infrastructure's Data Safe security assessments is automatically enabled. Classification scans database schemas to identify sensitive data elements, facilitating encryption at rest and access controls. To verify, navigate to the Data Safe service in the OCI Console and ensure that the 'Classification' setting is set to 'Automatic'. Remediation involves configuring Data Safe to automatically classify data, which can be accomplished by updating the security assessment settings in the OCI Console.
  references:
  - https://docs.oracle.com/en-us/iaas/data-safe/doc/security-assessment.html
  - https://www.oracle.com/security-cloud/cis-benchmarks/
  - https://www.oracle.com/cloud/cloud-infrastructure-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.data_safe.data_safe_configuration.classification_policy_blocks_public_for_sensitive_blocked
  service: data_safe
  resource: data_safe_configuration
  requirement: Classification Policy Blocks Public For Sensitive Blocked
  scope: data_safe.data_safe_configuration.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Block Public Access for Sensitive Data Classification
  rationale: Blocking public access to sensitive data classification policies is critical to prevent unauthorized access and potential data breaches. Public exposure of sensitive data classification can lead to non-compliance with regulations such as GDPR and CCPA, resulting in severe fines and reputational damage. It mitigates risks associated with unauthorized data disclosure and ensures that sensitive data is only accessible by authorized internal users.
  description: This rule checks if the Data Safe classification policy is configured to block public access to sensitive data. Ensure that the 'data_safe_configuration' settings restrict public permissions for sensitive classification policies. To verify, review the Data Safe configuration in the OCI Console to confirm that public access is disabled for sensitive data classifications. Remediation involves adjusting the policy settings to ensure sensitive data is not publicly accessible, typically by removing any 'public' access from the policy configurations.
  references:
  - https://docs.oracle.com/en-us/iaas/data-safe/doc/overview.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/best-practices/
- rule_id: oci.data_safe.security_assessment.classification_required_sensitivity_tags_present
  service: data_safe
  resource: security_assessment
  requirement: Classification Required Sensitivity Tags Present
  scope: data_safe.security_assessment.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Sensitivity Tags in Data Safe Security Assessments
  rationale: Inadequate classification of sensitive data can lead to unauthorized access, data breaches, and non-compliance with data protection regulations such as GDPR and CCPA. Proper tagging of sensitive data ensures that appropriate security measures are applied, mitigating risks of data exposure and maintaining trust with customers.
  description: This rule checks that all sensitive data within Oracle Cloud Infrastructure's Data Safe Security Assessments are appropriately tagged with required sensitivity tags. This involves verifying that data classifications are in place, which facilitates encryption and access control policies. To remediate, ensure that all sensitive data assets are identified and tagged within Data Safe, enabling the application of necessary security controls.
  references:
  - https://docs.oracle.com/en-us/iaas/data-safe/doc/data-safe-overview.html
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-benchmarks.html
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/data-protection/
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/compliance/
- rule_id: oci.data_science.model_deployment.automl_private_networking_enforced
  service: data_science
  resource: model_deployment
  requirement: Automl Private Networking Enforced
  scope: data_science.model_deployment.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Enforce Private Networking for AutoML Model Deployments
  rationale: Enforcing private networking for AutoML model deployments helps mitigate the risk of unauthorized access and data breaches by restricting the exposure of sensitive data and models to the public internet. This practice is crucial for maintaining data privacy, complying with regulatory frameworks like GDPR and HIPAA, and ensuring that only authorized users within the organization can interact with the deployed models.
  description: This rule checks if AutoML model deployments in OCI are configured to use private networking, ensuring that the model endpoints are accessible only through internal networks. To verify, ensure that your model deployment's network configuration is set to use a Virtual Cloud Network (VCN) with appropriate security rules in place. Remediation involves updating the deployment settings to utilize private subnets and configuring security lists or Network Security Groups (NSGs) to restrict inbound and outbound traffic as needed.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/data_science_security.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - CIS OCI Foundations Benchmark - Section 1.3
  - NIST SP 800-53 Rev. 5 (AC-4, SC-7)
  - https://www.oracle.com/security-cloud/
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingVCNs.htm
- rule_id: oci.data_science.project.ai_services_feature_store_offline_block_blocked
  service: data_science
  resource: project
  requirement: Ai Services Feature Store Offline Block Blocked
  scope: data_science.project.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure AI Services Feature Store Offline Access is Blocked
  rationale: Blocking offline access to AI Services Feature Store is critical for protecting sensitive data from unauthorized access and potential data exfiltration. This helps mitigate the risk of data breaches and ensures compliance with data protection regulations such as GDPR and CCPA. By enforcing encryption and access controls, organizations can safeguard intellectual property and maintain customer trust.
  description: This rule checks that offline access to the AI Services Feature Store within OCI Data Science projects is effectively blocked. Offline access, if allowed, could lead to unauthorized data downloads, risking sensitive information exposure. To verify, ensure that the 'Offline Access' setting is disabled in the OCI console under Data Science project configurations. Remediation involves navigating to the Data Science project settings and disabling any options that permit offline data access. Ensure encryption at rest is enabled to protect stored data.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/data-science.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_science.project.ai_services_feature_store_offline_s3_encrypted
  service: data_science
  resource: project
  requirement: Ai Services Feature Store Offline S3 Encrypted
  scope: data_science.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure S3 Buckets in Feature Store are Encrypted at Rest
  rationale: Encrypting data at rest in AI Services Feature Store is crucial to protect sensitive information from unauthorized access and data breaches. Unencrypted data can be vulnerable to cyber-attacks, leading to potential data exposure and non-compliance with regulatory requirements such as GDPR and CCPA, which mandate data protection standards.
  description: This rule checks that all S3 buckets used as offline storage in the AI Services Feature Store are encrypted at rest. Users should verify that the server-side encryption settings are enabled for these buckets, using either Oracle-managed keys or customer-managed keys. Remediation involves configuring the S3 settings to enable encryption, ensuring that data stored is protected by encryption algorithms compliant with industry standards such as AES-256.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/feature-store-offline-data-access.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-210/final
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_science.project.ai_services_feature_store_online_kms_encryption_enabled
  service: data_science
  resource: project
  requirement: Ai Services Feature Store Online KMS Encryption Enabled
  scope: data_science.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable KMS Encryption for AI Feature Store in Data Science Projects
  rationale: Enabling KMS encryption for the AI Services Feature Store in Oracle Cloud Infrastructure (OCI) is crucial for protecting sensitive data at rest. Without encryption, data is vulnerable to unauthorized access and potential breaches, posing significant risks to data privacy and integrity. This is essential for meeting regulatory compliance requirements such as GDPR, HIPAA, and PCI-DSS, which mandate strong encryption practices to safeguard personal and financial information.
  description: This rule checks whether KMS encryption is enabled for the AI Services Feature Store within OCI Data Science projects. To verify compliance, ensure that the Feature Store is configured with an Oracle Cloud Infrastructure Key Management Service (KMS) key, which provides robust encryption for data at rest. Remediation involves navigating to the OCI console, selecting the relevant Data Science project, and configuring the Feature Store to use a designated KMS key for encryption. This ensures that all data stored is encrypted using industry-standard methods, thereby enhancing security and compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/data-science-features.html
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/home.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.data_science.model_deployment.feature_store_private_networking_enforced
  service: data_science
  resource: model_deployment
  requirement: Feature Store Private Networking Enforced
  scope: data_science.model_deployment.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Private Networking for Feature Store Model Deployments
  rationale: Enforcing private networking for model deployments in OCI's Feature Store minimizes exposure to public internet threats, reducing the risk of unauthorized access and data breaches. This is crucial for protecting sensitive machine learning models and data, ensuring compliance with industry regulations such as GDPR and CCPA, and maintaining trust with stakeholders.
  description: This rule checks whether OCI Data Science model deployments are configured to use private networking, ensuring that traffic does not traverse the public internet. By using a Virtual Cloud Network (VCN) with appropriate security lists and network security groups, you can restrict access to your model deployments. Verify that your model deployment's subnet is private and appropriately secured. To remediate, configure the deployment to reside within a private subnet and review security group rules to permit only necessary traffic.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/models.htm#model_deployment
  - https://www.oracle.com/security/cloud-security/cspm/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
- rule_id: oci.data_science.project.feature_store_rbac_least_privilege_required
  service: data_science
  resource: project
  requirement: Feature Store RBAC Least Privilege Required
  scope: data_science.project.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Feature Store Access in Data Science Projects
  rationale: Implementing least privilege on Feature Store access minimizes the risk of unauthorized data exposure and potential breaches. This is crucial for maintaining data integrity and protecting sensitive data, which is vital for meeting compliance requirements such as GDPR and CCPA. Minimizing access also reduces the attack surface and potential for insider threats.
  description: This rule checks that access to the Feature Store within OCI Data Science projects is granted based on the principle of least privilege. Ensure that only necessary permissions are assigned to users or groups, limiting access to those who require it for legitimate business purposes. Verification involves examining IAM policies and ensuring roles are appropriately scoped. Remediation includes auditing current access permissions, removing unnecessary rights, and employing Oracle Cloud Infrastructure's IAM policies to enforce access control.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle
  - https://www.oracle.com/cloud/security/compliance/
- rule_id: oci.data_science.project.vector_index_authn_required
  service: data_science
  resource: project
  requirement: Vector Index Authn Required
  scope: data_science.project.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Vector Index Authentication in Data Science Projects
  rationale: Vector Index authentication is crucial for protecting sensitive data within Data Science projects from unauthorized access and potential breaches, which could lead to data loss, reputational damage, and non-compliance with privacy regulations such as GDPR and CCPA. Without authentication, malicious actors could exploit vector indices to gain insights into proprietary algorithms and datasets, posing a significant business and security risk.
  description: This rule verifies that authentication mechanisms are enabled for vector indices within Oracle Cloud Infrastructure Data Science projects. Ensure that vector index access requires authentication to safeguard data integrity and confidentiality. To implement, configure IAM policies to enforce authentication and access controls. Validate configurations through OCI Console or CLI, ensuring compliance with your organization's security posture. Remediation involves adjusting IAM policies to mandate authentication for accessing vector indices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/data_science_security.htm
  - 'CIS OCI Benchmark: In-depth Guide for Security Best Practices'
  - 'NIST SP 800-53: Access Control (AC-3)'
  - https://www.oracle.com/security-cloud-compliance/
  - https://www.oracle.com/cloud/data-science/
  - ISO 27001:2013 Information Security Management Systems
- rule_id: oci.data_science.project.vector_index_encrypted_at_rest_cmek
  service: data_science
  resource: project
  requirement: Vector Index Encrypted At Rest Cmek
  scope: data_science.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Vector Index Uses CMEK for Encryption at Rest
  rationale: Encrypting vector indices using Customer Managed Encryption Keys (CMEK) is crucial for protecting sensitive data in Oracle Cloud. This ensures that data science projects comply with stringent data protection regulations such as GDPR, HIPAA, and CCPA. Failure to encrypt data at rest could lead to unauthorized access, data breaches, and significant financial and reputational damage.
  description: This rule verifies whether vector indices within OCI Data Science projects are encrypted at rest using Customer Managed Encryption Keys. To comply, ensure that the vector index is configured to use a KMS key from the Oracle Cloud Vault service. Verify by checking the project settings in the OCI console under the Data Science service. If not configured, establish a connection to the Vault service and assign a KMS key to encrypt the vector index.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/ds_encryption.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - NIST SP 800-57 Part 1
  - https://www.oracle.com/security/cloud-security/compliance/
  - CIS Oracle Cloud Infrastructure Foundation Benchmark
  - https://www.iso.org/standard/54534.html
- rule_id: oci.data_science.model_deployment.vector_index_private_networking_enforced
  service: data_science
  resource: model_deployment
  requirement: Vector Index Private Networking Enforced
  scope: data_science.model_deployment.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Vector Index Uses Private Networking in Model Deployments
  rationale: Enforcing private networking for vector index model deployments in OCI minimizes exposure to the public internet, significantly reducing the risk of unauthorized access and data breaches. This is critical for maintaining data confidentiality and integrity, especially for organizations handling sensitive or proprietary data. Ensuring private networking aligns with regulatory compliance requirements and helps mitigate potential business losses due to data leaks.
  description: This rule checks that vector index model deployments in OCI Data Science are configured to use private networking. To verify this, ensure that the model deployment is associated with a Virtual Cloud Network (VCN) and uses private IP addresses. Remediation involves updating the model deployment settings to connect through a VCN, thereby restricting access to only those resources within the network. This configuration aids in adhering to network security best practices by preventing public access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Tasks/ds_using_models.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/cloud/cloud-infrastructure-security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.data_science.project.vector_index_rbac_tenant_isolation_enforced
  service: data_science
  resource: project
  requirement: Vector Index RBAC Tenant Isolation Enforced
  scope: data_science.project.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enforce Tenant Isolation for Data Science Vector Index
  rationale: Ensuring tenant isolation for vector indexes in OCI Data Science projects is critical to prevent unauthorized access and data leakage between tenants. This reduces the risk of sensitive data exposure and maintains compliance with data protection regulations like GDPR and CCPA. Effective RBAC policies help mitigate potential insider threats and external attacks by ensuring that only authorized users have access to vector index resources.
  description: This rule checks that RBAC policies enforce tenant isolation for vector indexes within OCI Data Science projects. Verify that policies are configured to restrict access based on the principle of least privilege and ensure that no cross-tenant access is allowed. Remediation involves reviewing and updating IAM policies to ensure proper roles and permissions are applied, restricting vector index access to only necessary users within the projectâ€™s tenant.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://www.oracle.com/cloud/security/compliance/cis-oci/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/cloud/security/
- rule_id: oci.data_science.model_deployment.ai_services_inference_endpoint_data_capture_s3_encrypted
  service: data_science
  resource: model_deployment
  requirement: Ai Services Inference Endpoint Data Capture S3 Encrypted
  scope: data_science.model_deployment.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure S3 Encryption for AI Endpoint Data Capture
  rationale: Encrypting data captured by AI services inference endpoints is crucial to protect sensitive information from unauthorized access and data breaches. It ensures compliance with data protection regulations such as GDPR and HIPAA, which mandate encryption of data at rest. Additionally, it mitigates risks associated with data leakage and enhances the overall security posture of your cloud deployment.
  description: This rule checks whether the S3 buckets used for data capture by AI services inference endpoints in Oracle Cloud Infrastructure are properly encrypted. You must ensure that server-side encryption is enabled for all such S3 buckets to protect captured data at rest. Verify encryption settings via the OCI Console or CLI and apply server-side encryption using OCI-managed keys (SSE-OCI) or customer-managed keys (SSE-CMK) as needed. Remediation involves configuring bucket policies to enforce encryption for all incoming data.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Reference/modeldeployment.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/s3-security.htm
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/standard/54534.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.data_science.model_deployment.ai_services_inference_endpoint_kms_encryption_enabled
  service: data_science
  resource: model_deployment
  requirement: Ai Services Inference Endpoint KMS Encryption Enabled
  scope: data_science.model_deployment.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure KMS Encryption for AI Services Inference Endpoint
  rationale: Enabling KMS encryption for AI Services inference endpoints in Oracle Cloud Infrastructure mitigates the risk of unauthorized data access and ensures compliance with data protection regulations such as GDPR and CCPA. It protects sensitive AI model data from potential breaches and unauthorized disclosures, thus maintaining customer trust and avoiding costly penalties.
  description: This rule checks whether KMS encryption is enabled for model deployments using AI Services inference endpoints in OCI. It verifies that encryption keys are managed through Oracle Key Management, ensuring that data at rest is securely encrypted. To remediate, configure your model deployments to use customer-managed keys (CMKs) by updating the deployment settings in the OCI console to specify a KMS key. Regularly audit encryption settings to ensure compliance with organizational policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingkeys.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/datasciencemodeldeployment.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_science.model_deployment.ai_services_inference_endpoint_private_networking_enforced
  service: data_science
  resource: model_deployment
  requirement: Ai Services Inference Endpoint Private Networking Enforced
  scope: data_science.model_deployment.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Model Deployment Uses Private Networking for AI Inference
  rationale: Using private networking for AI inference endpoints reduces exposure to potential threats from the public internet, thereby enhancing data protection and minimizing unauthorized access risks. It is critical for maintaining the confidentiality and integrity of sensitive data processed and inferred by AI models, and supports compliance with regulatory frameworks that mandate network security controls.
  description: This rule checks that model deployments in OCI Data Science enforce private networking for AI inference endpoints, ensuring they are not accessible over the public internet. Verify that the model deployment is associated with a Virtual Cloud Network (VCN) and uses private IP addresses. To remediate non-compliance, configure the inference endpoint to use a private subnet within a VCN, and ensure security lists and network security groups (NSGs) are appropriately set to allow only necessary traffic.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/model-deployment.htm#model-deployment-settings
  - https://www.oracle.com/security/cloud-security/oci-security-best-practices/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://hipaa.jotform.com/what-is-hipaa-compliance/
  - https://www.iso.org/standard/54534.html
- rule_id: oci.data_science.model_deployment.ai_services_inference_endpoint_security_group_restrictive
  service: data_science
  resource: model_deployment
  requirement: Ai Services Inference Endpoint Security Group Restrictive
  scope: data_science.model_deployment.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Restrict AI Services Inference Endpoint Access in Security Groups
  rationale: Restricting access to AI Services Inference Endpoints minimizes the risk of unauthorized data access and potential data breaches. Unrestricted endpoints can expose sensitive data processed by AI models to malicious actors, leading to compliance violations with regulations such as GDPR and CCPA, and potential financial and reputational damage.
  description: This rule checks whether security groups associated with AI Services Inference Endpoints in model deployments are configured to allow only necessary traffic. To ensure endpoint security, security groups should be configured to permit only specific IP addresses or CIDR blocks and necessary ports. Verification involves reviewing the security group rules attached to the model deployment. To remediate, update the security group to restrict inbound traffic to authorized sources only.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/datasciencemodels.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_guide.htm#network_security
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_science.model_deployment.ai_endpoint_authn_required
  service: data_science
  resource: model_deployment
  requirement: Ai Endpoint Authn Required
  scope: data_science.model_deployment.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure AI Model Deployment Endpoint Authentication
  rationale: Requiring authentication for AI model deployment endpoints is crucial to prevent unauthorized access to sensitive model data and operations. Without proper authentication, malicious actors could exploit the endpoint, leading to data breaches or model manipulation, violating data protection regulations such as GDPR or CCPA.
  description: This rule verifies that all AI model deployment endpoints in OCI have authentication enabled. It checks for the presence of authentication mechanisms like API keys or IAM policies to control access. To remediate, configure the model deployment settings in OCI to require authentication by assigning appropriate IAM policies or enabling other authentication methods. This ensures that only authorized users can access the model deployment endpoints.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Tasks/ds_deploying_models.htm
  - https://www.oracle.com/security/cloud-security/identity-management/
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations/
  - https://www.nist.gov/cyberframework
- rule_id: oci.data_science.model_deployment.ai_endpoint_authz_policies_enforced
  service: data_science
  resource: model_deployment
  requirement: Ai Endpoint Authz Policies Enforced
  scope: data_science.model_deployment.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure AI Endpoint Authorization Policies on Model Deployments
  rationale: Enforcing authorization policies on AI endpoints is essential to prevent unauthorized access and potential data breaches. Without these controls, sensitive data processed by AI models could be exposed, leading to compliance violations with regulations such as GDPR or HIPAA. Implementing robust authz policies mitigates risks of malicious exploitation and ensures that only authorized users can interact with AI endpoints.
  description: This rule checks whether AI endpoint authorization policies are enforced on OCI Data Science Model Deployments. It verifies that access to model deployment endpoints requires proper authentication and is governed by policy-based access controls. To remediate, configure IAM policies to restrict access based on user roles and ensure that all endpoints are secured with encryption in transit and at rest. Administrators should regularly audit and update these policies to align with organizational security standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/data_science_security.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Tasks/ds_authenticating_requests.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloud.oracle.com/data-science
- rule_id: oci.data_science.model_deployment.ai_endpoint_private_networking_enforced
  service: data_science
  resource: model_deployment
  requirement: Ai Endpoint Private Networking Enforced
  scope: data_science.model_deployment.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure AI Endpoint Private Networking for Model Deployments
  rationale: Enforcing private networking for AI endpoints in model deployments minimizes the risk of unauthorized access by limiting exposure to the public internet. This reduces the attack surface, helps safeguard sensitive data processed by AI models, and ensures adherence to regulatory requirements like GDPR and CCPA, which mandate stringent data protection measures.
  description: This rule checks that AI endpoints in OCI Data Science model deployments are configured to use private networking. This involves verifying that the model's endpoint is not accessible from the public internet and is instead limited to a Virtual Cloud Network (VCN). To remediate, configure the model deployment to use a private subnet within the VCN, and ensure appropriate security lists or network security groups (NSG) are applied to control traffic. Verify by inspecting the model deployment settings in the OCI console.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Tasks/ds_model_deployment.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-security/best-practices/
- rule_id: oci.data_science.model_deployment.ai_endpoint_rate_limiting_enabled
  service: data_science
  resource: model_deployment
  requirement: Ai Endpoint Rate Limiting Enabled
  scope: data_science.model_deployment.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable AI Endpoint Rate Limiting for Model Deployment
  rationale: Enabling rate limiting on AI endpoints is crucial to prevent abuse, mitigate denial-of-service attacks, and manage resource consumption effectively. Without rate limiting, excessive requests can degrade performance, leading to potential service disruptions and increased operational costs. Complying with regulatory standards like PCI-DSS and ISO 27001 requires implementing measures to protect against data breaches and ensure data availability.
  description: This rule checks if rate limiting is enabled on AI endpoints used in OCI Data Science model deployments. Rate limiting controls the number of requests that can be made to an endpoint over a given timeframe, thereby protecting against abuse and ensuring stable service performance. To verify, access the OCI console, navigate to the Data Science service, select the model deployment, and ensure rate limiting settings are configured under the 'Networking' options. Remediation involves setting appropriate request limits based on expected traffic patterns and business requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/data_science_security.htm
  - https://www.oracle.com/cloud/cloud-native/regulations/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/security/best-practices/
- rule_id: oci.data_science.model_deployment.ai_endpoint_waf_attached
  service: data_science
  resource: model_deployment
  requirement: Ai Endpoint Waf Attached
  scope: data_science.model_deployment.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure WAF is Attached to AI Endpoint in Model Deployment
  rationale: Attaching a Web Application Firewall (WAF) to your AI endpoint helps mitigate potential threats such as SQL injection, cross-site scripting (XSS), and other web application attacks that can compromise data integrity and confidentiality. Inadequate protection increases the risk of unauthorized data access, potentially leading to data breaches and non-compliance with privacy regulations like GDPR and CCPA.
  description: This rule checks whether a Web Application Firewall (WAF) is attached to the AI endpoint of an Oracle Cloud Infrastructure (OCI) model deployment. To verify compliance, ensure that the WAF is configured and actively monitoring inbound traffic to detect and block malicious activities. Remediation involves deploying an OCI WAF service and associating it with the AI endpoint to enhance security measures and protect sensitive data against web-based attacks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Concepts/welcome.htm
  - https://www.oracle.com/security-cloud/compliance/cis-benchmark/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/cloud/security/technical-architecture/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.data_science.model_deployment.training_pipeline_private_networking_enforced
  service: data_science
  resource: model_deployment
  requirement: Training Pipeline Private Networking Enforced
  scope: data_science.model_deployment.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Enforce Private Networking for Model Deployment Pipelines
  rationale: Ensuring that model training pipelines operate within a private network reduces the attack surface and prevents unauthorized access. This protects sensitive data from exposure to public networks, aligning with regulatory requirements such as GDPR and HIPAA. Private networks also help mitigate risks of data interception and unauthorized data manipulation, which can have legal and financial implications for businesses.
  description: This rule checks if model deployment training pipelines in OCI Data Science are configured to use private networking. To verify, ensure that the model deployment's network configuration is set to a Virtual Cloud Network (VCN) with appropriate security lists and network security groups that restrict public access. Enforcing private networking involves configuring these pipelines to operate within a secure VCN, and remediation includes updating the network settings to remove any public internet gateways or public IP addresses.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/model-deployment-overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://www.nist.gov/cyberframework
- rule_id: oci.data_science.pipeline.training_pipeline_secrets_from_vault_only
  service: data_science
  resource: pipeline
  requirement: Training Pipeline Secrets From Vault Only
  scope: data_science.pipeline.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure Data Science Pipeline Uses Vault for Secret Management
  rationale: Storing secrets directly within code or configuration can lead to unauthorized access, data breaches, and non-compliance with industry standards such as PCI-DSS and HIPAA. Using OCI Vault for secret management ensures that sensitive information is securely stored, managed, and accessed, minimizing risk exposure and aligning with best security practices.
  description: This rule checks that all sensitive information used in training pipelines, such as API keys and passwords, are sourced exclusively from OCI Vault. To verify, inspect the pipeline configuration to ensure that secrets are not hardcoded and are referenced from the Vault. Remediation involves migrating any embedded secrets to OCI Vault and updating pipeline configurations to retrieve them securely. This practice enhances security by leveraging the advanced access controls and monitoring features of OCI Vault.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/keyoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingsecrets.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/index.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- rule_id: oci.data_science.job.ai_services_training_job_inter_container_enabled
  service: data_science
  resource: job
  requirement: Ai Services Training Job Inter Container Enabled
  scope: data_science.job.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable AI Services Training Job Inter-Container Communication
  rationale: Enabling inter-container communication for AI Services Training Jobs is crucial to ensure that data can be efficiently shared between containers within the same job, which can lead to performance improvements and cost savings. However, unregulated communication can expose sensitive data to unauthorized access, leading to potential data breaches and non-compliance with data protection regulations such as GDPR or HIPAA.
  description: This rule checks whether inter-container communication is enabled for AI Services Training Jobs in OCI. Proper configuration allows containers to efficiently share data while ensuring that security controls, such as network policies and encryption, are in place to protect data in transit. Verification involves reviewing job configurations to ensure inter-container communication is enabled and complies with organizational security policies. Remediation requires modifying the job settings to include secure communication channels and enabling necessary network policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/datascienceoverview.htm
  - https://docs.oracle.com/en-us/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/datascience/job.html
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.oracle.com/cloud/security/compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.data_science.job.ai_services_training_job_network_isolation_enabled
  service: data_science
  resource: job
  requirement: Ai Services Training Job Network Isolation Enabled
  scope: data_science.job.network_security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable Network Isolation for AI Training Jobs
  rationale: Enabling network isolation for AI services training jobs mitigates the risk of unauthorized data access and potential data breaches. This is crucial for maintaining the confidentiality and integrity of sensitive data used during model training, which may include proprietary datasets or personally identifiable information. Ensuring network isolation aligns with compliance mandates like GDPR and CCPA, reducing the likelihood of regulatory penalties.
  description: This rule checks whether network isolation is enabled for data science AI services training jobs in OCI. Enabling network isolation ensures that the job cannot access external networks, thereby reducing the attack surface. Verify this setting by inspecting the network configuration of the job and ensuring it is set to disallow outbound internet traffic. Remediate by configuring the job with a Virtual Cloud Network (VCN) that has restricted internet access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Tasks/data-science-network-security.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.data_science.job.ai_services_training_job_output_encryption_enabled
  service: data_science
  resource: job
  requirement: Ai Services Training Job Output Encryption Enabled
  scope: data_science.job.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure AI Services Training Job Outputs are Encrypted
  rationale: Encrypting AI training job outputs is critical to protect sensitive data from unauthorized access and potential breaches. This helps mitigate the risk of data leakage and ensures compliance with data protection regulations such as GDPR and CCPA. It also safeguards intellectual property and enhances customer trust by ensuring that data is securely handled throughout its lifecycle.
  description: This rule checks if the output of AI services training jobs in OCI's Data Science service is encrypted at rest. To verify, ensure that the 'output_bucket' parameter is configured with a bucket that has encryption enabled. Remediation involves enabling server-side encryption on the OCI Object Storage bucket used for job outputs. This can be done via the OCI Console or CLI by setting the appropriate encryption settings on the bucket.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/data-science-overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingencryption.htm
  - 'NIST SP 800-53: SC-28 Protection of Information at Rest'
  - https://www.oracle.com/security-cloud/data-encryption/
  - CIS OCI Foundations Benchmark
  - https://www.oracle.com/cloud/soc2/
- rule_id: oci.data_science.job.ai_services_training_job_volume_encryption_enabled
  service: data_science
  resource: job
  requirement: Ai Services Training Job Volume Encryption Enabled
  scope: data_science.job.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure AI Services Training Job Volume Encryption is Enabled
  rationale: Encrypting volumes for AI Services Training Jobs is critical to protect sensitive data from unauthorized access. Without encryption, data at rest is vulnerable to breaches, which can lead to significant financial and reputational damage. Compliance with standards such as PCI-DSS, HIPAA, and ISO 27001 often requires robust encryption practices to safeguard data confidentiality.
  description: This rule checks whether the volumes used by AI Services Training Jobs in OCI's Data Science service have encryption enabled. It verifies that all volumes are encrypted using Oracle-managed keys or customer-managed keys in Oracle Cloud Infrastructure. To ensure compliance, configure the job settings to use encryption by default. Remediation involves enabling volume encryption in the OCI Console under the Data Science job settings or through Terraform scripts to automate the configuration.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/data-science.htm#volume-encryption
  - https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/overview.htm#EncryptionAtRest
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_science.job.ai_services_training_job_vpc_configured
  service: data_science
  resource: job
  requirement: Ai Services Training Job VPC Configured
  scope: data_science.job.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure VCN Configuration for AI Services Training Jobs
  rationale: Configuring AI Services Training Jobs to utilize a Virtual Cloud Network (VCN) is crucial for segregating network traffic, safeguarding sensitive data from unauthorized access, and complying with data protection regulations. This configuration mitigates risks of data leakage and exposure by ensuring that data science operations are conducted within a secure and controlled network environment.
  description: This rule checks if AI Services Training Jobs in Oracle Cloud Infrastructure are configured to operate within a Virtual Cloud Network (VCN). Proper configuration involves specifying a subnet within a VCN to ensure network isolation and control. To verify, inspect the job configuration for a VCN and subnet ID. Remediation involves updating the Data Science Job configuration to include a VCN and subnet, ensuring compliance with internal security policies and external regulatory requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcompartments.htm
  - https://www.oracle.com/cloud/cloud-native/ai-services/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/privacy-framework/data-protection-and-privacy
  - https://www.oracle.com/security-cloud/compliance/
- rule_id: oci.data_catalog.catalog.ai_services_model_artifact_encrypted_at_rest
  service: data_catalog
  resource: catalog
  requirement: Ai Services Model Artifact Encrypted At Rest
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure AI Model Artifacts are Encrypted at Rest in Data Catalog
  rationale: Encrypting AI model artifacts at rest protects sensitive data from unauthorized access and data breaches, aligning with data protection regulations like GDPR and CCPA. It mitigates risks associated with data theft, ensuring that even if the data is accessed, it cannot be read without the encryption keys.
  description: This rule checks that AI Services model artifacts stored in the Oracle Cloud Infrastructure Data Catalog are encrypted at rest. Users should configure the Data Catalog to use OCI's Key Management Service (KMS) to manage encryption keys. To verify, audit the encryption settings in the Data Catalog and ensure they follow the OCI encryption policies. Remediation involves enabling encryption for model artifacts using OCI's built-in encryption capabilities and regularly rotating encryption keys.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - 'NIST SP 800-57 Part 1: Recommendation for Key Management'
  - ISO/IEC 27001:2013 - Information Security Management
  - https://www.oracle.com/security/cloud-security/compliance/
- rule_id: oci.data_catalog.catalog.ai_services_model_execution_role_least_privilege_required
  service: data_catalog
  resource: catalog
  requirement: Ai Services Model Execution Role Least Privilege Required
  scope: data_catalog.catalog.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure AI Model Execution Role Follows Least Privilege Principle
  rationale: Granting excessive permissions to AI model execution roles can lead to unauthorized access and potential data breaches. This misconfiguration can expose sensitive data catalog contents to unintended actions, violating compliance with standards like GDPR and PCI-DSS, and increasing the risk of insider threats. Ensuring least privilege access minimizes these risks and supports robust access management policies.
  description: This rule verifies that the AI Services Model Execution Role within the OCI Data Catalog is configured with the least privilege necessary for its operation. It checks for overly permissive access policies that could allow unauthorized access to sensitive data. To remediate, review and adjust IAM policies to ensure they grant only the permissions required for specific tasks, and regularly audit these roles to maintain minimal access. Use OCI's Identity and Access Management (IAM) service to define clear, granular permissions aligned with the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/accesscontrol.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloud.oracle.com/compliance
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
- rule_id: oci.data_catalog.catalog.ai_services_model_image_scan_passed
  service: data_catalog
  resource: catalog
  requirement: Ai Services Model Image Scan Passed
  scope: data_catalog.catalog.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure AI Services Model Image Scan Completes Successfully
  rationale: Ensuring AI services model images are scanned for vulnerabilities is critical in safeguarding data integrity and privacy. This process mitigates the risk of deploying compromised models which could lead to unauthorized access or data breaches, impacting business continuity and compliance with data protection regulations such as GDPR and CCPA.
  description: This rule verifies that AI services model images in the OCI Data Catalog have passed vulnerability scans. It checks for the successful completion of image scans as part of the deployment pipeline. To ensure compliance, configure the OCI Data Catalog to automatically trigger scans on model images and review results for potential vulnerabilities. Remediation involves addressing any identified vulnerabilities prior to deployment to maintain a secure environment.
  references:
  - https://docs.oracle.com/en-us/iaas/data-catalog/doc/security-best-practices.html
  - https://www.oracle.com/cloud/cloud-native/container-engine-kubernetes/security.html
  - https://csrc.nist.gov/publications/detail/sp/800-190/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
  - https://www.oracle.com/security-alerts/
- rule_id: oci.data_catalog.catalog.ai_services_model_kms_cmk_used_enabled
  service: data_catalog
  resource: catalog
  requirement: Ai Services Model KMS CMK Used Enabled
  scope: data_catalog.catalog.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure KMS CMK is Enabled for AI Models in Data Catalog
  rationale: Using a Customer Managed Key (CMK) with KMS for AI models in OCI enhances data security by allowing organizations to maintain control over the encryption keys used to protect sensitive information. This reduces the risk of unauthorized access and data breaches, which can lead to financial loss and reputational damage. Furthermore, it aids in meeting compliance requirements for data protection regulations such as GDPR and CCPA.
  description: This rule checks if AI services models within the OCI Data Catalog use a Customer Managed Key (CMK) for encryption at rest. To verify, ensure that the AI model configuration specifies a KMS key that is customer-managed. Remediation involves accessing the Data Catalog, navigating to the AI model configuration settings, and selecting an appropriate CMK from the Key Management service. This ensures data is encrypted with keys that are under the customer's control, enhancing data security and compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/oci-compliance/
- rule_id: oci.data_catalog.catalog.model_registry_access_rbac_least_privilege_required
  service: data_catalog
  resource: catalog
  requirement: Model Registry Access RBAC Least Privilege Required
  scope: data_catalog.catalog.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Model Registry Access in OCI Data Catalog
  rationale: Enforcing least privilege for accessing the Model Registry in OCI Data Catalog minimizes the risk of unauthorized access, data breaches, and potential compliance violations. Misconfigured access can lead to data leaks, financial loss, and damage to organizational reputation, while also potentially violating regulations such as GDPR or CCPA.
  description: This rule checks if access to the Model Registry within OCI Data Catalog is granted based on the principle of least privilege. It requires that roles and policies are configured to allow only necessary permissions for users and service accounts. To verify, review IAM policies and ensure they are restrictive, granting only required actions. Remediation involves revisiting current IAM policies, removing excessive permissions, and utilizing groups to streamline permission management.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/iampolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/document/nist-sp-800-53r5pdf
  - https://www.oracle.com/security-cloud/cloud-security-principles.html
  - https://www.oracle.com/cloud/safe-harbor/
- rule_id: oci.data_science.model.ai_services_model_deployment_endpoint_in_vpc
  service: data_science
  resource: model
  requirement: Ai Services Model Deployment Endpoint In VPC
  scope: data_science.model.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure AI Model Deployment Endpoints are Secured within VPC
  rationale: Deploying AI model endpoints within a VPC restricts access to only trusted network environments, minimizing exposure to the public internet and reducing the risk of unauthorized access. This configuration is crucial for protecting sensitive data processed by AI models, ensuring compliance with data protection regulations, and safeguarding intellectual property.
  description: This rule checks if AI services model deployment endpoints are configured within a Virtual Cloud Network (VCN) in Oracle Cloud Infrastructure. Verify that the model deployment is associated with a subnet that has appropriate security lists or network security groups to control inbound and outbound traffic. To remediate, configure the model deployment to reside within a VCN and apply least privilege network access policies to protect against unauthorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/commonpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.oracle.com/security/cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/datasciencemodels.htm
- rule_id: oci.data_science.model.ai_services_model_deployment_kms_encryption_enabled
  service: data_science
  resource: model
  requirement: Ai Services Model Deployment KMS Encryption Enabled
  scope: data_science.model.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure KMS Encryption for AI Model Deployments
  rationale: Enabling KMS encryption for AI model deployments in OCI's Data Science service is crucial to protect sensitive data at rest. Without this, models are vulnerable to unauthorized access, potentially leading to data breaches and non-compliance with data protection regulations like GDPR and CCPA. Encrypting data helps mitigate risks associated with data leaks and ensures that sensitive information remains confidential.
  description: This rule checks whether AI service model deployments in Oracle Cloud Infrastructure (OCI) are using Key Management Service (KMS) for encryption at rest. To verify, ensure that the model deployment settings specify an encryption key from OCI KMS. If encryption is not enabled, configure the model to use a KMS key by updating the model deployment settings in the OCI console or through the API. This ensures that data stored and processed by the AI models remains secure against unauthorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://docs.oracle.com/en-us/iaas/data-science/doc/security-considerations.html
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.data_science.model.ai_services_model_deployment_logging_enabled
  service: data_science
  resource: model
  requirement: Ai Services Model Deployment Logging Enabled
  scope: data_science.model.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Logging for AI Services Model Deployments
  rationale: Enabling logging for AI model deployments in OCI is crucial for ensuring accountability, detecting anomalies, and auditing access to sensitive data. Without logging, organizations may face challenges in tracing unauthorized access, which could lead to data breaches or compliance violations with standards like GDPR or CCPA. Effective logging supports incident response and forensic analysis, thereby reducing security risks.
  description: This rule checks whether logging is enabled for AI Services model deployments in OCI. To verify, ensure that the 'Logging' feature is activated in the OCI console under the Data Science service for each model deployment. If logs are not enabled, configure the service to capture and store logs in OCI Logging. This helps maintain an audit trail of operations and access to AI models, enhancing security and compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/datascience/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_science.project.prompt_gateway_authn_required
  service: data_science
  resource: project
  requirement: Prompt Gateway Authn Required
  scope: data_science.project.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Prompt Gateway Authentication for Data Science Projects
  rationale: Ensuring prompt gateway authentication for data science projects is crucial to protect sensitive data and intellectual property from unauthorized access. This requirement mitigates risks associated with unauthorized data manipulation or exfiltration, aligning with data protection laws such as GDPR and CCPA, and supports maintaining customer trust and compliance with internal security policies.
  description: This rule checks if prompt gateway authentication is enabled for Oracle Cloud Infrastructure Data Science projects. Proper configuration ensures that all access to project resources is authenticated through secure gateways, thereby preventing unauthorized interactions. Verification involves checking the project's gateway settings and enabling authentication mechanisms as needed. To remediate, update project configurations to enforce authentication for all gateway access points, using OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/data-science-security.html
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hipaajournal.com/hipaa-compliance-guide/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_science.model_deployment.prompt_gateway_private_networking_enforced
  service: data_science
  resource: model_deployment
  requirement: Prompt Gateway Private Networking Enforced
  scope: data_science.model_deployment.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Enforce Private Networking for Model Deployment Prompt Gateway
  rationale: Enforcing private networking for the Model Deployment Prompt Gateway minimizes exposure to public networks, reducing the risk of unauthorized access and data breaches. This measure is crucial for maintaining the confidentiality and integrity of data science models and complies with regulatory standards that mandate restricted network access.
  description: This rule checks that the Prompt Gateway for OCI Data Science Model Deployments is configured to use only private networks. Ensure that the deployment is associated with a Virtual Cloud Network (VCN) and that the subnet is private. Verification involves checking the network configuration settings in the OCI Console under the Data Science service. To remediate, modify the network settings to ensure the gateway is not publicly accessible.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/data-science/using/data-science-model-deployments.htm
  - CIS OCI Foundations Benchmark
  - https://www.nist.gov/document-6015
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_science.project.prompt_gateway_token_scopes_least_privilege_required
  service: data_science
  resource: project
  requirement: Prompt Gateway Token Scopes Least Privilege Required
  scope: data_science.project.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Data Science Gateway Token Scopes
  rationale: Implementing least privilege for gateway tokens in OCI Data Science projects minimizes the risk of unauthorized access and potential data breaches. It ensures that users or systems have only the necessary permissions to perform their tasks, reducing the attack surface and aligning with compliance requirements such as NIST and PCI-DSS. Failing to enforce this principle could lead to privilege escalation and exploitation of sensitive data resources.
  description: This check verifies that gateway token scopes in OCI Data Science projects are configured with the least privilege necessary. It involves reviewing and adjusting token permissions to ensure they align strictly with the specific needs of the project. Remediation includes auditing current token permissions, identifying excessive privileges, and modifying scopes to limit access according to the principle of least privilege. This configuration can be reviewed and updated in the OCI console under Identity and Access Management settings for Data Science projects.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/datascienceoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/casb.html
- rule_id: oci.data_science.model.ai_services_model_version_image_scan_passed_required
  service: data_science
  resource: model
  requirement: Ai Services Model Version Image Scan Passed Required
  scope: data_science.model.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure AI Model Image Scan Passes for Security Compliance
  rationale: Image scanning for AI model versions is crucial to identify and remediate vulnerabilities before deployment. It minimizes the risk of introducing compromised components into production, which could lead to data breaches, intellectual property theft, and non-compliance with privacy regulations such as GDPR and CCPA.
  description: This rule checks if the OCI Data Science AI Services model version images have successfully passed security scans. Images that pass scans are verified to be free of known vulnerabilities, ensuring the integrity and security of models. To verify compliance, ensure that all model versions undergo an image scanning process via OCI's Vulnerability Scanning Service. Remediate by addressing any discovered vulnerabilities and rescan until the image passes.
  references:
  - https://docs.oracle.com/en-us/iaas/tools/oci-cli/3.16.1/oci_cli_docs/cmdref/data-science/model.html
  - https://www.oracle.com/security/cloud-security/vulnerability-scanning/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/standard/54534.html
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/cloud/security/compliance/
- rule_id: oci.data_science.model.ai_services_model_version_kms_encryption_enabled
  service: data_science
  resource: model
  requirement: Ai Services Model Version KMS Encryption Enabled
  scope: data_science.model.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure KMS Encryption Enabled for AI Model Versions
  rationale: Enabling KMS encryption for AI model versions in OCI is critical to protect sensitive data from unauthorized access and potential breaches. This practice minimizes the risk of data exposure in case of a security incident and supports compliance with stringent data protection regulations such as GDPR and CCPA, which mandate encryption of sensitive data at rest.
  description: This rule checks if Oracle AI Services Model Versions are encrypted using Oracle Key Management Service (KMS) within the Data Science service. To verify, check the model's configuration and ensure that KMS encryption is activated. Remediation involves configuring the model to use a customer-managed key from KMS, which can be done via the OCI Console or CLI. This ensures that models are securely encrypted, leveraging OCI's integrated key management capabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Tasks/dscmodelconfig.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure
  - https://www.nist.gov/itl/applied-cybersecurity/nist-special-publication-800-57-part-1-revision-5
- rule_id: oci.data_science.model.ai_services_model_version_package_approved_required
  service: data_science
  resource: model
  requirement: Ai Services Model Version Package Approved Required
  scope: data_science.model.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure AI Model Version Packages are Approved
  rationale: Unapproved AI model version packages can lead to unvetted changes being deployed, potentially introducing vulnerabilities or non-compliance with data protection regulations. This can result in sensitive data exposure, financial loss, and damage to reputation. Ensuring that only approved packages are used helps maintain data integrity and aligns with regulatory standards.
  description: This rule checks that AI Services Model Version Packages in OCI are approved before deployment. Verification involves ensuring that the appropriate approval workflows have been completed as per organizational policy. Remediation includes reviewing the model version package, obtaining necessary approvals, and updating the approval status in the OCI console. This practice helps in maintaining the integrity and security of AI models by preventing unauthorized or unsafe model updates.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/dscsecurity.htm
  - https://www.oracle.com/security/cis-oracle-cloud-infrastructure-foundations-benchmark-1-1-0/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/cloud/security-best-practices/
- rule_id: oci.data_science.project.model_artifact_encrypted_at_rest_cmek
  service: data_science
  resource: project
  requirement: Model Artifact Encrypted At Rest Cmek
  scope: data_science.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Science Model Artifacts Use CMEK for Encryption at Rest
  rationale: Encrypting model artifacts at rest using Customer-Managed Encryption Keys (CMEK) is essential for maintaining control over sensitive data and ensuring compliance with data protection regulations. It reduces the risk of unauthorized access and data breaches by allowing organizations to manage their encryption keys and policies. This practice is critical for industries subject to stringent compliance requirements such as finance or healthcare.
  description: This rule checks if model artifacts within an OCI Data Science project are encrypted at rest using Customer-Managed Encryption Keys (CMEK). To verify compliance, ensure that the Data Science project is configured to use encryption with CMEK by checking the encryption settings in the OCI Console under Data Science projects. If not configured, remediate by setting up an encryption policy with a customer-managed key in the OCI Vault service and associating it with the Data Science project.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/datasciencemanagement.htm#ds-encryption
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/OCI_CIS_Benchmark_v1.1.0.pdf
  - https://www.oracle.com/security/cloud-security/standards-compliance.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57pt1r4.pdf
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingkeys.htm
- rule_id: oci.data_science.model.ai_services_supply_chain_model_artifact_critical
  service: data_science
  resource: model
  requirement: Ai Services Supply Chain Model Artifact Critical
  scope: data_science.model.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Encryption at Rest for AI Supply Chain Model Artifacts
  rationale: Protecting AI model artifacts with encryption at rest is crucial to prevent unauthorized access and data breaches, which can lead to intellectual property theft and compromise of sensitive supply chain data. This aligns with compliance requirements such as GDPR and CCPA, which mandate strong data protection practices to safeguard sensitive information.
  description: This rule checks that AI supply chain model artifacts stored in OCI Data Science are encrypted at rest using Oracle-managed keys. Verify that encryption settings are enabled in the OCI console under Data Science model settings. Remediate by enabling encryption at rest for all model artifacts, ensuring that Oracle Key Management is utilized for encryption, providing robust security and compliance with data protection standards.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/data-science-oci.html
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://cloudsecurityalliance.org/research/artifacts/encryption-in-the-cloud-guidelines/
  - https://www.oracle.com/security/cloud-security/key-management/
- rule_id: oci.data_science.model.ai_services_supply_chain_model_artifact_sbom_present
  service: data_science
  resource: model
  requirement: Ai Services Supply Chain Model Artifact Sbom Present
  scope: data_science.model.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure SBOM Presence for AI Model Artifacts
  rationale: Software Bill of Materials (SBOM) is crucial in identifying and managing vulnerabilities within AI model artifacts, reducing the risk of supply chain attacks. It helps organizations comply with data protection regulations by providing transparency and traceability, thus enhancing trust in AI services.
  description: This rule checks whether a Software Bill of Materials (SBOM) is present for AI model artifacts in Oracle Cloud Infrastructure's Data Science service. Ensuring that an SBOM is attached to AI model artifacts enhances security by providing a detailed inventory of components, which is essential for vulnerability management and compliance. To verify, navigate to the Data Science service in the OCI console, select the model, and confirm the SBOM presence. If missing, create and attach an SBOM using OCI's built-in tools or third-party services.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/index.html
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/cloud-native/containers/
- rule_id: oci.data_science.model.ai_services_supply_chain_model_artifact_validated
  service: data_science
  resource: model
  requirement: Ai Services Supply Chain Model Artifact Validated
  scope: data_science.model.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure AI Supply Chain Model Artifact Uses Encryption at Rest
  rationale: Validating that AI supply chain model artifacts are encrypted at rest protects sensitive data from unauthorized access and potential breaches. This is crucial for maintaining data integrity, fulfilling compliance requirements such as GDPR and CCPA, and mitigating risks associated with data leaks or malicious attacks. Properly encrypted models ensure that intellectual property and sensitive business information are safeguarded.
  description: This rule checks whether AI supply chain model artifacts are stored with encryption enabled at rest within OCI Data Science services. To verify, ensure that model artifacts are stored in OCI Object Storage with server-side encryption enabled. Remediation involves configuring your OCI Object Storage bucket to use Oracle-managed keys or customer-managed keys for encryption. Regularly review and audit encryption settings to maintain compliance with data protection policies and regulations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/commonpolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - NIST SP 800-57 Part 1
  - ISO/IEC 27001:2013
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/AI/Concepts/aiservicesoverview.htm
- rule_id: oci.data_science.pipeline.ai_services_pipeline_iam_role_least_privileged_enforced
  service: data_science
  resource: pipeline
  requirement: Ai Services Pipeline IAM Role Least Privileged Enforced
  scope: data_science.pipeline.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for AI Services Pipeline IAM Roles
  rationale: Enforcing least privilege for IAM roles in AI services pipelines minimizes the risk of unauthorized access and potential data breaches. By restricting permissions to only what is necessary, organizations can reduce the attack surface and comply with security standards such as NIST and PCI-DSS, thereby protecting sensitive data and maintaining customer trust.
  description: This rule checks that IAM roles associated with AI services pipelines are configured with the least privilege necessary to perform their functions. To verify, review the IAM policies attached to pipeline roles and ensure they grant only the permissions required for specific tasks. Remediation involves adjusting policies to remove excessive permissions and regularly auditing access levels to align with current operational needs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security-cloud-compliance/cis-oracle-cloud-infrastructure-foundations-benchmark/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.oracle.com/cloud/security/best-practices/
- rule_id: oci.data_science.project.ai_services_pipeline_kms_encryption_enabled
  service: data_science
  resource: project
  requirement: Ai Services Pipeline KMS Encryption Enabled
  scope: data_science.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable KMS Encryption for AI Services Pipelines
  rationale: Enabling KMS encryption for AI Services Pipelines in OCI Data Science projects is crucial for safeguarding sensitive data processed in AI workflows. Without encryption, data is vulnerable to unauthorized access and breaches, potentially leading to compliance violations and financial penalties. This control helps mitigate risks associated with data leaks and aligns with regulatory requirements for data protection.
  description: This rule checks that Oracle Cloud Infrastructure (OCI) Data Science projects have Key Management Service (KMS) encryption enabled for AI Services Pipelines. To verify, ensure that the Data Science project settings specify a customer-managed key (CMK) for encryption. To remediate, configure a KMS key in your OCI account and apply it to your AI Services Pipeline settings. This ensures that data at rest is encrypted, mitigating risks of unauthorized data exposure.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/data-science-concepts.htm
  - https://www.oracle.com/security-cloud/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.data_science.project.ai_services_pipeline_logging_enabled
  service: data_science
  resource: project
  requirement: Ai Services Pipeline Logging Enabled
  scope: data_science.project.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure AI Services Pipeline Logging is Enabled
  rationale: Enabling logging for AI services pipelines is critical for maintaining visibility into project activities, which helps in detecting unauthorized access and anomalies. It supports compliance with regulatory requirements like GDPR, which mandates data tracking and accountability. This capability also aids in forensic investigations and incident response, ensuring that potential threats are identified and mitigated promptly.
  description: This rule checks whether logging is enabled for AI services pipelines in Oracle Cloud Infrastructure Data Science projects. To verify, ensure that logging is configured for all AI services pipelines by enabling the logging feature within the OCI console under the Data Science service. Remediation involves accessing the specific Data Science project settings and activating the logging option to capture all pertinent activities and events automatically. This setup ensures that all operational and security events are recorded and available for audit purposes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Tasks/data-science-pipeline-logging.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://www.nist.gov/cyberframework
  - https://cloudsecurityalliance.org/
  - https://www.oracle.com/security/cloud-security/compliance/
- rule_id: oci.data_science.project.agent_orchestrator_data_exfiltration_policies_enforced
  service: data_science
  resource: project
  requirement: Agent Orchestrator Data Exfiltration Policies Enforced
  scope: data_science.project.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enforce Data Exfiltration Policies in Data Science Projects
  rationale: Enforcing data exfiltration policies within OCI Data Science projects is crucial to prevent unauthorized data transfers that could lead to data breaches. Such policies help mitigate the risk of data leakage, which can result in significant financial loss, damage to reputation, and non-compliance with data protection regulations like GDPR and CCPA. By ensuring policies are enforced, organizations can protect sensitive information and meet regulatory requirements.
  description: This rule verifies that data exfiltration policies are enforced for agent orchestrators within OCI Data Science projects. It checks for configurations that restrict data transfers to unauthorized destinations, ensuring compliance with organizational data governance policies. Remediation involves setting up network security rules and IAM policies to control data flow and monitoring agent activities. Administrators should regularly audit these settings to ensure they align with current security policies and compliance standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/datascienceoverview.htm
  - https://www.oracle.com/cloud/security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security-cloud-compliance/
- rule_id: oci.data_science.project.agent_orchestrator_secrets_isolation_enabled
  service: data_science
  resource: project
  requirement: Agent Orchestrator Secrets Isolation Enabled
  scope: data_science.project.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Agent Orchestrator Secrets Isolation in OCI Data Science
  rationale: Enabling secrets isolation for the Agent Orchestrator in OCI Data Science projects is critical to protect sensitive data such as API keys and credentials from unauthorized access. Failure to isolate these secrets can lead to data breaches, exposing sensitive information and potentially violating compliance standards like GDPR and HIPAA, which mandate stringent data protection practices.
  description: This rule checks if the Agent Orchestrator within OCI Data Science projects has secrets isolation enabled. This feature ensures that secrets are stored securely and only accessible to authorized components within the orchestrator. Verification involves checking the project configuration in the OCI console or using the OCI CLI to confirm that secrets isolation is enabled. To remediate, configure the Data Science project settings to enable secrets isolation, ensuring compliance with best practices for data protection.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/data-science-overview.htm
  - https://www.oracle.com/cloud/OCI-compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.data_science.project.agent_orchestrator_tool_use_allowlist_enforced
  service: data_science
  resource: project
  requirement: Agent Orchestrator Tool Use Allowlist Enforced
  scope: data_science.project.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enforce Allowlist for Agent Orchestrator Tools in Data Science Projects
  rationale: Enforcing an allowlist for agent orchestrator tools in OCI Data Science projects is crucial for minimizing unauthorized tool usage, which can lead to data breaches or data manipulation. This control ensures that only approved tools with verified security postures are used, thereby reducing the risk of intellectual property theft and ensuring compliance with data protection regulations such as GDPR and HIPAA.
  description: This rule checks if an allowlist for agent orchestrator tools is enforced within OCI Data Science projects. Administrators must configure the allowlist to include only vetted and approved tools, ensuring that all orchestrator activities are secure and monitored. Verification involves reviewing the configuration settings in the OCI Console under the Data Science project settings. To remediate, administrators should update the project settings to define an allowlist of approved tools and regularly audit the list to ensure compliance with organizational policies.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/data-science-projects.html
  - https://www.oracle.com/security/cis-oci-benchmark/
  - https://www.nist.gov/itl/ssd/nist-special-publication-800-190
  - https://www.oracle.com/security/cloud-compliance/
- rule_id: oci.data_science.project.secrets_vault_access_rbac_least_privilege_required
  service: data_science
  resource: project
  requirement: Secrets Vault Access RBAC Least Privilege Required
  scope: data_science.project.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Data Science Project Vault Access
  rationale: Implementing least privilege access for Data Science Projects ensures that only authorized users have the minimal necessary permissions to access sensitive secrets stored in the vault. This minimizes the risk of unauthorized access or data breaches, protecting confidential project data and maintaining compliance with security standards such as NIST and ISO 27001. Least privilege access also reduces the attack surface, mitigating potential insider threats and unintentional data exposure.
  description: This rule checks that access to the Secrets Vault within OCI Data Science Projects is configured following the principle of least privilege. Specifically, it verifies that IAM policies are set to provide only necessary permissions to users and groups involved in the project. To verify, review the IAM policies associated with the Data Science Project to ensure they align with least privilege principles. Remediation involves adjusting these policies to restrict permissions, granting access only to essential users and roles. Use OCI's policy statements to tailor access control and regularly audit access logs to ensure ongoing compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcompartmentsecrets.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/standard/54534.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/bestpractices.htm
- rule_id: oci.data_science.project.secrets_vault_kms_encryption_and_rotation_enabled
  service: data_science
  resource: project
  requirement: Secrets Vault KMS Encryption And Rotation Enabled
  scope: data_science.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable KMS Encryption and Rotation for Data Science Projects
  rationale: Enabling KMS encryption and key rotation for Data Science Projects ensures that sensitive data is protected against unauthorized access, reducing the risk of data breaches. This practice is essential for maintaining confidentiality and integrity, especially in industries where data privacy is regulated by laws such as GDPR and HIPAA. Regular rotation of encryption keys mitigates the risk of key compromise over time, thereby enhancing overall data security.
  description: This rule checks that Oracle Cloud Infrastructure Data Science Projects are configured to use Keys Management Service (KMS) for encrypting secrets and that the keys are set to rotate automatically. To verify, ensure that the project settings are integrated with OCI Vault and that key rotation policies are active. Remediation involves configuring a Vault with KMS, attaching it to your Data Science Project, and enabling automatic key rotation via the OCI Console or API.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/workingwithkeys.htm#enablingkeyrotation
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.oracle.com/security/cloud-security/compliance/nist/
  - https://www.oracle.com/security/cloud-security/compliance/hipaa/
  - https://www.oracle.com/cloud/security/
- rule_id: oci.data_science.project.secrets_vault_no_plaintext_in_config
  service: data_science
  resource: project
  requirement: Secrets Vault No Plaintext In Config
  scope: data_science.project.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Prevent Plaintext Secrets in Data Science Project Configurations
  rationale: Storing secrets in plaintext within project configurations poses significant security risks, as it can lead to unauthorized access and data breaches if intercepted. This practice violates compliance standards including NIST SP 800-53 and PCI-DSS, which require secure management of sensitive information. Properly securing secrets helps protect intellectual property and maintain trust in data science operations.
  description: This rule checks that Data Science project configurations do not contain plaintext secrets. It ensures that any sensitive information is stored securely in Oracle Cloud Infrastructure's Vault service. To verify compliance, inspect configuration files and confirm secrets are referenced from a managed vault instead of embedded directly. Remediate any violations by migrating plaintext secrets to OCI Vault and updating configurations to retrieve secrets programmatically.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Tasks/datasciencetask.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/cloud-security-practices/
- rule_id: oci.data_science.project.ai_services_workspace_encryption_enabled
  service: data_science
  resource: project
  requirement: Ai Services Workspace Encryption Enabled
  scope: data_science.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure AI Services Workspace Encryption is Enabled
  rationale: Enabling encryption for AI Services Workspaces in OCI protects sensitive data from unauthorized access and potential breaches. It reduces the risk of data exfiltration and ensures compliance with industry regulations like GDPR and HIPAA, which mandate protection of personal and sensitive data. Encryption at rest is crucial for maintaining the confidentiality and integrity of data used in AI and machine learning projects.
  description: This rule checks whether encryption is enabled for AI Services Workspaces within OCI Data Science projects. Users should configure their data science projects to use Oracle-managed encryption keys or customer-managed keys (CMK) to protect data at rest. Verification involves reviewing the project's settings to ensure the encryption option is active. If encryption is not enabled, users should update the project settings to activate encryption, thereby securing the data stored in the workspace.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/commonpolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-111.pdf
  - https://www.oracle.com/cloud/saas/resources/gdpr/
- rule_id: oci.data_science.project.ai_services_workspace_iam_role_least_privileged_enforced
  service: data_science
  resource: project
  requirement: Ai Services Workspace IAM Role Least Privileged Enforced
  scope: data_science.project.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce Least Privilege for AI Services Workspace IAM Roles
  rationale: Enforcing least privilege for IAM roles in AI Services Workspace minimizes the risk of unauthorized access, reducing potential data breaches and ensuring that users have only the permissions necessary to perform their tasks. This practice helps in maintaining compliance with security standards such as ISO 27001 and PCI-DSS by limiting unnecessary access to sensitive resources within AI projects.
  description: This rule checks that IAM roles within the AI Services Workspace are configured with the least privilege principle, ensuring roles only have permissions necessary for their function. Verify that roles are not granted excessive permissions by reviewing and adjusting IAM policies. Remediation involves auditing current role permissions, removing unnecessary access rights, and periodically reviewing roles to adapt to changing needs or risks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/security/best-practices/
- rule_id: oci.data_science.project.ai_services_workspace_idle_shutdown_configured
  service: data_science
  resource: project
  requirement: Ai Services Workspace Idle Shutdown Configured
  scope: data_science.project.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure AI Services Workspace Idle Shutdown is Configured
  rationale: Configuring idle shutdown for AI Services Workspaces helps mitigate the risk of unauthorized access and potential data breaches by ensuring that inactive sessions are automatically terminated. This practice is crucial for optimizing resource utilization and cost management, while also reducing the attack surface of your data science projects. In regulated industries, it can support compliance with data protection standards by minimizing the exposure of sensitive data.
  description: This rule checks if AI Services Workspaces within OCI Data Science projects have idle shutdown settings configured. To comply, each workspace should have a defined policy that specifies the time duration after which an idle session is automatically terminated. This configuration can be verified and managed through the OCI Console under Data Science project settings. Remediation involves setting an appropriate idle timeout to ensure sessions are terminated after a reasonable period of inactivity, thus protecting data and optimizing resource usage.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/data-science-get-started.htm
  - https://www.oracle.com/security-best-practices/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_science.model_deployment.ai_services_workspace_private_networking_enforced
  service: data_science
  resource: model_deployment
  requirement: Ai Services Workspace Private Networking Enforced
  scope: data_science.model_deployment.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Private Networking for AI Services Workspace
  rationale: Enforcing private networking for AI Services Workspace minimizes exposure to public internet threats, reducing the risk of unauthorized access and data breaches. It aligns with compliance requirements by ensuring that data science models and their deployments operate within a secure and controlled network environment, crucial for safeguarding sensitive information and maintaining customer trust.
  description: This rule verifies that model deployments in OCI Data Science utilize private networking within an AI Services Workspace. It checks for configurations where the model deployments are restricted to private subnets, ensuring no public IP addresses are assigned. To remediate, ensure that all model deployments are hosted within a Virtual Cloud Network (VCN) with appropriate security list and network security group rules, preventing any public access. Validate settings through the OCI Console or CLI by reviewing the network configuration of the model deployment resources.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/data-science-overview.htm
  - https://www.oracle.com/security-cloud/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.iso.org/iso-iec-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- rule_id: oci.database.autonomous_database.instance_deletion_protection_enabled
  service: database
  resource: autonomous_database
  requirement: Instance Deletion Protection Enabled
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable Instance Deletion Protection for Autonomous Databases
  rationale: Enabling deletion protection for Autonomous Databases is crucial to prevent accidental or malicious data loss, which can lead to business disruptions, financial loss, and damage to reputation. Protecting databases against unauthorized deletions is essential to meet compliance requirements such as GDPR, HIPAA, and PCI-DSS, which mandate data availability and integrity.
  description: This rule checks if deletion protection is enabled for OCI Autonomous Databases. Deletion protection prevents the database from being accidentally or intentionally deleted by unauthorized users. To verify, navigate to the Autonomous Database console, and ensure that the 'Deletion Protection' toggle is set to 'Enabled'. Remediation involves enabling this setting through the OCI console or CLI, thereby safeguarding critical data assets from premature deletion.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/managingADB.htm#deletion_protection
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hipaajournal.com/hipaa-security-rule/
- rule_id: oci.database.autonomous_database.instance_encryption_enabled
  service: database
  resource: autonomous_database
  requirement: Instance Encryption Enabled
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Encryption at Rest for Autonomous Databases
  rationale: Enabling encryption for Autonomous Databases protects sensitive data from unauthorized access and potential breaches. This is critical for maintaining customer trust and meeting regulatory requirements such as PCI-DSS and HIPAA, which mandate the protection of data at rest. Failure to encrypt data can lead to significant financial losses, legal consequences, and reputational damage.
  description: This rule checks that encryption is enabled for Oracle Autonomous Databases, ensuring that all stored data is encrypted at rest using Oracle-managed keys. Verify encryption settings through the OCI Console under the Autonomous Database details page. To remediate, ensure that the 'Encryption' option is enabled when creating or managing an Autonomous Database instance. This enhances data security by leveraging OCI's robust encryption mechanisms.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm#encryption
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.hipaajournal.com/hipaa-encryption-requirements/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57pt1r3.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.database.autonomous_database.instance_iam_or_managed_identity_auth_enabled
  service: database
  resource: autonomous_database
  requirement: Instance IAM Or Managed Identity Auth Enabled
  scope: database.autonomous_database.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure IAM or Managed Identity Auth for Autonomous DB
  rationale: Enabling IAM or Managed Identity authentication for Autonomous Databases reduces the risk of unauthorized access by leveraging Oracle Cloud's robust identity management. This approach aligns with best practices for identity and access management, mitigating threats like privilege escalation and unauthorized data access, and supports compliance with regulations such as NIST, PCI-DSS, and ISO 27001.
  description: This rule checks if Autonomous Databases have either IAM or Managed Identity authentication enabled. Proper configuration ensures that only authorized identities can access the database, using OCI IAM policies to enforce access control. To verify, review the database configurations in the OCI Console and enable IAM or Managed Identity authentication if not already configured. This setting can be adjusted via the OCI Console or CLI, following Oracle's guidance on secure database management.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/security/cloud-security/database-cloud-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_platform
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.database.autonomous_database.instance_public_access_disabled
  service: database
  resource: autonomous_database
  requirement: Instance Public Access Disabled
  scope: database.autonomous_database.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Disable Public Access to Autonomous Database Instances
  rationale: Allowing public access to Autonomous Database instances exposes them to potential unauthorized access and data breaches. This could lead to the compromise of sensitive information and significant financial and reputational damage. Disabling public access is essential to comply with regulatory standards such as NIST, PCI-DSS, and ISO 27001, which mandate the protection of sensitive data from unauthorized exposure.
  description: This rule checks whether Autonomous Database instances have public access disabled, ensuring they are not exposed to the internet. Verify that the database's network access type is set to 'Private Endpoint' within the OCI console. To remediate, configure the network access type by editing the database instance settings to use a private endpoint, thus restricting access to specific IP addresses or VCNs. This limits access to trusted networks and enhances security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
- rule_id: oci.database.db_system.instance_require_tls_in_transit_required
  service: database
  resource: db_system
  requirement: Instance Require TLS In Transit Required
  scope: database.db_system.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure TLS Encryption for OCI Database Traffic
  rationale: Encrypting data in transit with TLS is crucial for protecting sensitive information from interception and unauthorized access during transmission. Failure to enforce TLS can lead to data breaches, violating compliance with standards such as PCI-DSS, HIPAA, and GDPR, which mandate secure data handling practices.
  description: This rule checks whether TLS is required for data in transit to and from Oracle Cloud Infrastructure (OCI) Database Systems. To verify, ensure that the database system's configuration mandates TLS for all connections. Remediation involves configuring the database system to require TLS by setting the appropriate parameters in the network configuration file. This ensures that all data exchanges are encrypted, safeguarding against man-in-the-middle attacks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/usingtls.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.compute.dedicated_vm_host.dedicated_host_sharing_restricted
  service: compute
  resource: dedicated_vm_host
  requirement: Dedicated Host Sharing Restricted
  scope: compute.dedicated_vm_host.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Sharing of Dedicated VM Hosts in OCI
  rationale: Restricting the sharing of dedicated VM hosts mitigates the risk of unauthorized access and resource contention, ensuring that critical workloads remain isolated and performance is not compromised. This practice aligns with compliance requirements for data protection and privacy, reducing exposure to potential breaches and data leaks.
  description: This rule checks if dedicated VM hosts in OCI are configured to restrict sharing, ensuring they are not accessible by multiple tenants or departments within an organization. To verify, review the dedicated VM host's settings in the OCI console and ensure 'Dedicated Host Sharing' is set to 'Restricted'. Remediation involves updating the sharing configuration to restrict access to only authorized users or departments.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/dedicated-hosts.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/document_library
  - https://www.oracle.com/cloud/security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.compute.instance.dedicated_host_instance_auto_placement_controlled
  service: compute
  resource: instance
  requirement: Dedicated Host Instance Auto Placement Controlled
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Control Auto Placement of Instances on Dedicated Hosts
  rationale: Controlling the auto placement of instances on dedicated hosts is crucial to optimize resource allocation, reduce costs, and maintain compliance with data residency and isolation requirements. It minimizes the risk of resource contention and ensures that instances are placed according to organizational policies and regulatory standards, which is vital for workloads with strict compliance needs.
  description: This rule checks whether instances launched on dedicated hosts have their auto placement controlled or manually specified, ensuring optimal resource utilization and compliance. To verify, review the instance configuration settings in the OCI Console under 'Compute' > 'Dedicated Hosts' > 'Instances' to ensure 'Auto Placement' is either disabled or configured with specific parameters. Remediation involves adjusting the instance placement settings to align with organizational policies by navigating to the 'Instance Details' page and modifying the 'Placement' settings appropriately.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/dedicated-hosts.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm#security_controls
- rule_id: oci.dns.record.dns_security_record_set_alias_targets_services
  service: dns
  resource: record
  requirement: Dns Security Record Set Alias Targets Services
  scope: dns.record.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure DNS Alias Targets Reference Valid OCI Services
  rationale: Incorrect or misconfigured DNS alias targets can redirect traffic to unintended or malicious destinations, risking data breaches and service disruption. This can lead to compliance issues with regulations such as PCI-DSS and HIPAA, which mandate secure configurations for network resources.
  description: This rule checks that DNS alias targets in OCI are correctly pointing to valid and intended Oracle Cloud Infrastructure services. It involves verifying the alias target configuration to ensure it aligns with the intended service endpoints. Remediation includes updating the DNS records to correct any misconfigurations or invalid references to external services. Regular audits and updates to the DNS configurations are crucial to maintaining secure and compliant network operations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DNS/Concepts/dnszonemanagement.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/DNS/Tasks/managingdnsrecords.htm
- rule_id: oci.dns.record.dns_security_record_set_caa_records_wildcard
  service: dns
  resource: record
  requirement: Dns Security Record Set Caa Records Wildcard
  scope: dns.record.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure CAA Records Do Not Use Wildcards
  rationale: CAA records specify which certificate authorities (CAs) are permitted to issue certificates for a domain. Using wildcards in CAA records can inadvertently allow unauthorized CAs to issue certificates, increasing the risk of man-in-the-middle attacks and unauthorized domain use. Adhering to this rule helps maintain control over certificate issuance, aligns with best practices, and reduces potential compliance violations.
  description: This rule checks for the presence of wildcard entries in CAA records within OCI DNS records. Wildcards in CAA records can lead to security vulnerabilities by allowing any certificate authority to issue certificates for the domain. To verify compliance, review CAA records in your DNS settings and remove any wildcard entries. Instead, specify each CA explicitly to ensure only authorized entities can issue certificates for your domain.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DNS/Tasks/caa.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- rule_id: oci.dns.record.dns_security_record_set_dmarc_present_present
  service: dns
  resource: record
  requirement: Dns Security Record Set Dmarc Present Present
  scope: dns.record.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure DMARC Records are Configured in DNS
  rationale: Proper DMARC configuration in DNS helps mitigate email spoofing and phishing attacks, protecting the organization's brand reputation and customer trust. Without DMARC, attackers can impersonate the domain, leading to potential data breaches and financial losses. Compliance with frameworks like NIST and SOC2 often requires robust email security measures, including DMARC implementation.
  description: This rule checks if a DMARC (Domain-based Message Authentication, Reporting & Conformance) record is present in the DNS settings of a domain. To verify, ensure that a TXT record with the name '_dmarc' exists in the domain's DNS zone, specifying appropriate policy actions (e.g., 'p=none', 'p=quarantine', or 'p=reject'). Remediation involves creating or updating the DMARC record to align with security policies and industry standards, utilizing OCI's DNS Management console to manage DNS zones effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DNS/Tasks/managingdnszones.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://dmarc.org/overview/
  - https://www.iso.org/standard/54534.html
- rule_id: oci.dns.zone.dns_security_record_set_no_overly_zones
  service: dns
  resource: zone
  requirement: Dns Security Record Set No Overly Zones
  scope: dns.zone.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure DNS Record Sets Do Not Overlap in OCI Zones
  rationale: Overlapping DNS record sets in OCI zones can lead to DNS conflicts, service disruptions, and potential security vulnerabilities by allowing unauthorized redirection of traffic. It is crucial for maintaining the integrity and reliability of DNS infrastructure, reducing the risk of man-in-the-middle attacks and ensuring compliance with organizational governance policies.
  description: This rule checks for the presence of overlapping DNS record sets within Oracle Cloud Infrastructure (OCI) DNS zones. To verify, review the DNS configurations in the OCI Console and ensure each record set is unique and appropriately scoped. Remediation involves restructuring the DNS zone to eliminate overlaps, ensuring unique record entries for each DNS query path. Utilize the OCI DNS management tools to audit and correct any misconfigurations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DNS/Concepts/dnszonemanagement.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security-cloud/identity-management/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.dns.zone.dns_security_record_set_no_rfc1918_blocked
  service: dns
  resource: zone
  requirement: Dns Security Record Set No Rfc1918 Blocked
  scope: dns.zone.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Prevent RFC1918 IP Addresses in DNS Records
  rationale: Using RFC1918 private IP addresses in public DNS zones can inadvertently expose internal network configurations, leading to potential security vulnerabilities. This practice can facilitate network reconnaissance by malicious actors and may violate compliance requirements such as PCI-DSS and ISO 27001, which mandate secure handling of network information.
  description: This rule checks DNS zones in OCI for any record sets containing RFC1918 private IP addresses, which should not be publicly accessible. To verify compliance, review your DNS records within the OCI Console and ensure no private IP addresses (e.g., 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16) are used. If found, remove these entries or replace them with appropriate public IP addresses. Following best practices, maintain separate internal and external DNS zones to prevent exposure of internal IP addresses.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DNS/Concepts/dns_security.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-iec-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.dns.steering_policy.dns_security_traffic_policy_health_checks_failover
  service: dns
  resource: steering_policy
  requirement: Dns Security Traffic Policy Health Checks Failover
  scope: dns.steering_policy.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Health Checks for DNS Policy Failover
  rationale: Ensuring that DNS steering policies have active health checks is critical for maintaining service availability and reliability. Without health checks, traffic may not be rerouted effectively in case of endpoint failure, leading to potential service downtime, business disruption, and customer dissatisfaction. Additionally, this practice supports compliance with regulations that require robust service continuity and resilience strategies.
  description: This rule verifies that OCI DNS steering policies have health checks configured to enable automatic failover of traffic to healthy endpoints. Health checks should be properly set up and monitored to ensure that DNS responses are directed only to available resources. Verify health check configurations by accessing the OCI console, navigating to the DNS service, and reviewing the steering policy settings. Remediation involves configuring health checks for each endpoint within the steering policy via the OCI console or API, ensuring they meet your operational requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DNS/Tasks/managingsteeringpolicies.htm
  - https://www.oracle.com/security/cspm/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-security-best-practices.htm
  - https://www.cisecurity.org/benchmark/oracle/
- rule_id: oci.dns.steering_policy.dns_security_traffic_policy_documents_encrypted_and_private
  service: dns
  resource: steering_policy
  requirement: Dns Security Traffic Policy Documents Encrypted And Private
  scope: dns.steering_policy.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure DNS Steering Policies Are Encrypted and Private
  rationale: Encrypting and maintaining the privacy of DNS steering policy documents is crucial to prevent unauthorized access and exposure of sensitive DNS configurations. Unprotected DNS data can be exploited by attackers to redirect or manipulate traffic, leading to potential business disruptions, data breaches, and non-compliance with data protection regulations such as GDPR and CCPA.
  description: This rule checks that all DNS steering policy documents within Oracle Cloud Infrastructure are encrypted at rest and access is restricted to authorized users. Ensure that encryption is enabled for DNS configurations to protect data confidentiality and integrity. Review and update IAM policies to restrict access to DNS steering policies, and verify that encryption settings comply with Oracle's recommended security practices. Remediation involves enabling encryption settings and adjusting IAM policies to limit access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DNS/Concepts/dnssecurity.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.oracle.com/cloud/cloud-infrastructure/#security
- rule_id: oci.dns.steering_policy.dns_security_traffic_policy_targets_approved_domains_only
  service: dns
  resource: steering_policy
  requirement: Dns Security Traffic Policy Targets Approved Domains Only
  scope: dns.steering_policy.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Limit DNS Steering Policy Targets to Approved Domains
  rationale: Allowing DNS steering policies to target only approved domains ensures that traffic is directed securely and reduces the risk of data exfiltration or redirection to malicious sites. This control helps mitigate domain hijacking and unauthorized traffic redirection, supporting compliance with regulatory frameworks such as PCI-DSS and NIST SP 800-53 by protecting data integrity and confidentiality.
  description: This rule checks whether DNS steering policies in OCI are configured to target only domains that are approved by your organization. To verify compliance, review the list of domain targets in the OCI Console under DNS Steering Policies and ensure they match the approved domain list. Remediation involves updating the policy configuration to remove any unapproved domains and maintaining an up-to-date list of authorized domains. This helps ensure that DNS traffic management aligns with security policies and reduces exposure to potential threats.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DNS/Concepts/dnssteeringpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/publications/security-and-privacy-controls-information-systems-and-organizations
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.dns.zone.dns_security_zone_cross_account_sharing_restricted
  service: dns
  resource: zone
  requirement: Dns Security Zone Cross Account Sharing Restricted
  scope: dns.zone.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Restrict Cross Account Sharing for DNS Security Zones
  rationale: Cross-account sharing of DNS Security Zones without restrictions can expose sensitive DNS configurations to unauthorized entities, increasing the risk of malicious modifications or data exfiltration. Ensuring that DNS zones are only shared with trusted accounts aligns with compliance frameworks like NIST and ISO 27001, mitigating potential data breaches.
  description: This rule checks whether DNS Security Zones in Oracle Cloud Infrastructure are shared across accounts with appropriate restrictions. It verifies that necessary IAM policies are in place to prevent unauthorized access. To remediate, review and update the IAM policies to ensure only designated accounts have access to the DNS zones. Use OCI Identity and Access Management to define precise user permissions and minimize overly permissive sharing.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DNS/Reference/dns_policy.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.dns.zone.dns_security_zone_dnssec_enabled
  service: dns
  resource: zone
  requirement: Dns Security Zone Dnssec Enabled
  scope: dns.zone.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure DNSSEC is Enabled for DNS Security Zones
  rationale: Enabling DNSSEC for DNS security zones in OCI ensures the authenticity and integrity of DNS data by preventing DNS spoofing and cache poisoning attacks. This is crucial for maintaining trust in the domain name system, protecting sensitive data, and ensuring compliance with regulations such as NIST SP 800-53 and ISO 27001, which require robust data integrity controls.
  description: This rule checks that DNSSEC (Domain Name System Security Extensions) is enabled for all DNS zones within Oracle Cloud Infrastructure. DNSSEC provides cryptographic authentication of DNS data, ensuring that responses to DNS queries have not been altered in transit. Verify this setting in the OCI console under the DNS management section by ensuring the 'DNSSEC' option is enabled for each zone. Remediation involves enabling DNSSEC for zones where it is not active, which can be done directly through the OCI console or via Terraform scripts.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DNS/Tasks/managingdnssec.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.cloudflare.com/dns/dnssec/how-dnssec-works/
- rule_id: oci.dns.zone.dns_security_zone_query_logging_enabled
  service: dns
  resource: zone
  requirement: Dns Security Zone Query Logging Enabled
  scope: dns.zone.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure DNS Security Zone Query Logging is Enabled
  rationale: Enabling DNS Security Zone Query Logging is crucial for monitoring and analyzing DNS traffic, which can help identify malicious activities such as DNS spoofing or exfiltration attempts. It also assists in compliance with regulatory standards that require detailed logging of network activities, thereby mitigating risks associated with data breaches and unauthorized access.
  description: This rule checks whether DNS Security Zone Query Logging is enabled for each DNS zone within your OCI tenancy. To verify, navigate to the Oracle Cloud Console, access the DNS service, and confirm that logging is enabled for each zone. If disabled, enable logging by selecting the desired zone and configuring the logging settings. This will ensure that all DNS queries are logged and can be audited for security and compliance purposes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DNS/Tasks/dnszonequerylog.htm
  - https://www.oracle.com/security/certifications/compliance/
  - 'NIST SP 800-53 Rev. 5: AU-6 Audit Record Review, Analysis, and Reporting'
  - 'PCI-DSS Requirement 10: Track and monitor all access to network resources and cardholder data.'
  - https://www.oci.com/resources/dns-security-best-practices
  - ISO 27001:2013 - A.12.4 Logging and monitoring
- rule_id: oci.dns.zone.dns_security_zone_transfer_restricted_or_tsig_required
  service: dns
  resource: zone
  requirement: Dns Security Zone Transfer Restricted Or Tsig Required
  scope: dns.zone.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure DNS Zone Transfers Are Restricted or TSIG is Used
  rationale: Unrestricted DNS zone transfers can lead to unauthorized access to zone data, increasing the risk of data leakage and potential exposure to malicious actors. By restricting transfers or using TSIG (Transaction Signatures), organizations can protect sensitive DNS information, ensuring compliance with data protection regulations and enhancing overall DNS security.
  description: This rule checks if DNS zone transfers are either restricted to specific IP addresses or secured using TSIG. Verify that zone transfer settings in OCI DNS configurations allow transfers only to trusted parties or employ TSIG for authentication. To remediate, update DNS zone policies to include access control lists or implement TSIG for secure, authenticated transfers.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DNS/Tasks/dnszonemanagement.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://www.iso.org/standard/54534.html
- rule_id: oci.events.rule.trigger_event_sources_restricted
  service: events
  resource: rule
  requirement: Trigger Event Sources Restricted
  scope: events.rule.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Restrict Trigger Event Sources in OCI Event Rules
  rationale: Limiting trigger event sources in OCI Event Rules minimizes the attack surface by ensuring that only trusted sources can initiate events within your infrastructure. This reduces the risk of unauthorized actions and potential data breaches, which can lead to financial loss and reputational damage. Compliance with industry regulations often mandates strict access controls to safeguard sensitive information.
  description: This rule verifies that OCI event rules have their trigger sources restricted to known, trusted sources. Configuring event sources correctly prevents unauthorized or malicious events from being triggered. To verify, review your OCI event rules in the Oracle Cloud Console and ensure only required services or compartments are designated as event sources. Remediation involves updating the event rule to specify explicit event sources, thereby adhering to the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/cis-benchmarks.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/cloud-compliance.html
- rule_id: oci.events.rule.trigger_logs_enabled
  service: events
  resource: rule
  requirement: Trigger Logs Enabled
  scope: events.rule.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Trigger Logs for OCI Event Rules
  rationale: Enabling trigger logs for OCI Event Rules is critical for maintaining a comprehensive audit trail of event-driven actions within your cloud infrastructure. Without logging, it becomes challenging to trace unauthorized actions or diagnose failures, increasing the risk of undetected security incidents and non-compliance with regulatory standards such as PCI-DSS and SOC2.
  description: This rule checks if trigger logs are enabled for OCI Event Rules, which capture detailed information about triggered events. To verify, navigate to the OCI Console, access the Events service, and ensure that logging is enabled for each event rule. Remediation involves configuring event rules to send logs to the OCI Logging service, allowing centralized monitoring and analysis. This setup aids in forensic investigations and compliance reporting.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://www.oracle.com/security-cloud/cis-benchmarks/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/pci_security/
  - https://docs.oracle.com/en-us/iaas/Content/security/overview.htm
  - https://www.oracle.com/cloud/cloud-security/monitoring.html
- rule_id: oci.events.rule.trigger_targets_least_privilege_required
  service: events
  resource: rule
  requirement: Trigger Targets Least Privilege Required
  scope: events.rule.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce Least Privilege for OCI Event Rule Trigger Targets
  rationale: Enforcing least privilege on event rule trigger targets minimizes the risk of unauthorized access and potential data breaches. By ensuring that targets have only the necessary permissions, organizations can reduce the attack surface and comply with security standards like NIST and ISO 27001, which mandate access controls and data protection.
  description: This rule checks whether OCI event rule trigger targets are assigned only the necessary permissions. It ensures that the IAM policies associated with these targets do not exceed the required actions. Verification involves reviewing the IAM policies linked to event rule triggers and adjusting them to adhere to least privilege principles. Remediation includes updating policies to restrict access to only necessary OCI services and actions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/API/Concepts/usingpolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-1-2-0-pdf.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://www.oracle.com/security/cloud-security/identity-and-access-management/
- rule_id: oci.analytics.analytics_instance.event_subscription_cross_account_sharing_restricted
  service: analytics
  resource: analytics_instance
  requirement: Event Subscription Cross Account Sharing Restricted
  scope: analytics.analytics_instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Cross-Account Sharing for OCI Analytics Event Subscriptions
  rationale: Unrestricted cross-account sharing of event subscriptions in OCI Analytics can lead to unauthorized access and potential data exposure. Limiting this capability reduces the risk of data breaches and helps meet compliance requirements by ensuring that only trusted accounts can receive event notifications, thus protecting sensitive analytics data.
  description: This rule checks if event subscriptions for OCI Analytics instances are configured to restrict cross-account sharing. Ensuring that event subscriptions are limited to specific, trusted accounts helps mitigate the risk of unauthorized access. To verify, review the event subscription settings in the OCI Console and confirm that cross-account sharing is disabled or restricted to trusted accounts. Remediation involves modifying the event subscription policies to limit sharing to authorized accounts only.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Tasks/analyticsmanaging.htm
  - https://www.oracle.com/security/cloud-security/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.analytics.analytics_instance.event_subscription_destination_encrypted
  service: analytics
  resource: analytics_instance
  requirement: Event Subscription Destination Encrypted
  scope: analytics.analytics_instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Event Subscription Destinations are Encrypted
  rationale: Encrypting event subscription destinations is crucial to protect sensitive analytics data from unauthorized access, ensuring data integrity and confidentiality. Unencrypted destinations can lead to data breaches, exposing sensitive business insights and violating compliance mandates such as PCI-DSS and HIPAA. Encryption safeguards against interception and unauthorized data manipulation during transmission.
  description: This rule verifies that event subscription destinations for OCI Analytics Instances are encrypted, ensuring data transmitted to these destinations is secure. Administrators should configure event stream endpoints to use encryption protocols such as TLS for secure data transfer. To remediate, review the current event subscription settings in the OCI console and ensure encryption is enabled by setting the appropriate encryption protocols in the destination configuration.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticssecurity.htm
  - https://www.oracle.com/security-cloud-compliance
  - https://www.nist.gov/publications/nist-special-publication-800-57-recommendation-key-management-part-1
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hipaajournal.com/hipaa-encryption-requirements
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.analytics.analytics_instance.event_subscription_destination_least_privilege_required
  service: analytics
  resource: analytics_instance
  requirement: Event Subscription Destination Least Privilege Required
  scope: analytics.analytics_instance.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Analytics Event Subscription Destinations
  rationale: Implementing least privilege for event subscription destinations in OCI Analytics reduces the attack surface and minimizes potential data breaches by ensuring that only authorized entities can access sensitive data. This practice is crucial for maintaining compliance with security standards and mitigating risks of unauthorized access that could lead to data leaks or service disruptions.
  description: This rule verifies that event subscriptions for OCI Analytics instances use the principle of least privilege by restricting access permissions to only those necessary for specific tasks. It involves reviewing and configuring IAM policies to ensure that only required users or services have access to event subscription destinations. Remediation involves auditing current access policies, identifying excessive permissions, and adjusting policies to grant minimal necessary access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/access/iam.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://www.nist.gov/document/nistsp800-53r5pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/cloud/sensitive-data-protection/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.events.rule.event_subscription_cross_account_sharing_restricted
  service: events
  resource: rule
  requirement: Event Subscription Cross Account Sharing Restricted
  scope: events.rule.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Restrict Cross-Account Sharing in OCI Event Subscriptions
  rationale: Unrestricted cross-account sharing of event subscriptions can lead to data leaks and unauthorized access to sensitive information. It poses a security risk by potentially exposing event-driven actions to external parties, which can be exploited for malicious activities. This is crucial for maintaining data integrity and complying with standards like NIST and ISO 27001, which emphasize the importance of access control.
  description: This rule checks for event subscriptions within Oracle Cloud Infrastructure that are shared across different accounts without restrictions. To verify compliance, ensure that event rules are configured to restrict cross-account sharing only to trusted entities and validate the access policies in place. Remediation involves reviewing event subscription settings and tightening access policies by specifying precise compartments or tenancy IDs that are permitted access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/document-3019
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/artifacts/cloud-security-best-practices/
- rule_id: oci.events.rule.event_subscription_destination_encrypted
  service: events
  resource: rule
  requirement: Event Subscription Destination Encrypted
  scope: events.rule.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Event Subscription Destinations are Encrypted
  rationale: Encrypting event subscription destinations is crucial to protect sensitive data from unauthorized access and potential data breaches. This practice helps mitigate risks associated with data interception and aligns with compliance requirements such as PCI-DSS and HIPAA, which mandate encryption of data at rest to safeguard personal and financial information.
  description: This rule checks if the destinations of event subscriptions in Oracle Cloud Infrastructure are encrypted. Event destinations must be configured to use OCI Object Storage buckets or other services that support encryption at rest. Verify that the bucket or service used as the destination is configured to automatically encrypt data using OCI-managed keys or customer-managed encryption keys. Remediation involves enabling encryption on the destination service and ensuring key management policies are appropriately configured.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/index.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.events.rule.event_subscription_destination_least_privilege_required
  service: events
  resource: rule
  requirement: Event Subscription Destination Least Privilege Required
  scope: events.rule.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Event Subscription Destinations Use Least Privilege
  rationale: Applying the principle of least privilege to event subscription destinations minimizes the risk of unauthorized access and potential data breaches. Ensuring that only the necessary permissions are granted helps protect sensitive information and maintain compliance with regulatory frameworks such as PCI-DSS and GDPR, thereby reducing the attack surface and mitigating the impact of compromised credentials.
  description: This rule checks that event subscription destinations in OCI are configured with the minimum privileges required to function. It involves auditing IAM policies to ensure they grant only the necessary permissions to the event service for accessing target resources, such as Functions, Notifications, or Streams. Remediation includes reviewing and adjusting IAM policies to limit access, ensuring that each permission is explicitly justified for the subscription's operation.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework/compliance
- rule_id: oci.file_storage.file_system.fileshare_encryption_enabled
  service: file_storage
  resource: file_system
  requirement: Fileshare Encryption Enabled
  scope: file_storage.file_system.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure File Storage Encryption is Enabled
  rationale: Enabling encryption for file storage in OCI is crucial to protect sensitive data from unauthorized access. It mitigates the risk of data breaches by ensuring that data at rest is unreadable without the appropriate decryption keys. This is vital for meeting compliance with regulations such as PCI-DSS, HIPAA, and GDPR, which require the protection of data through encryption.
  description: This rule checks if encryption is enabled for file systems in Oracle Cloud Infrastructure's File Storage service. To verify, ensure that the file system's encryption status is set to 'enabled' within the OCI console or via the API. Remediation involves configuring the file system settings to enable encryption, which uses Oracle managed keys by default but can be configured to use customer-managed keys for added control. This process ensures all data stored is automatically encrypted at rest.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Tasks/usingfilestorage.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.file_storage.file_system.fileshare_cmk_policy_least_privilege_enabled_enforced
  service: file_storage
  resource: file_system
  requirement: Fileshare CMK Policy Least Privilege Enabled Enforced
  scope: file_storage.file_system.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Fileshare CMK Policy Enforces Least Privilege
  rationale: Implementing a least privilege policy for Fileshare CMK access in OCI reduces the risk of unauthorized data access or modification, thereby protecting sensitive information and maintaining data integrity. This approach minimizes potential attack vectors, aligning with compliance standards like PCI-DSS and ISO 27001, which require stringent access controls to safeguard critical data assets.
  description: This rule checks that the OCI file storage service enforces least privilege access policies for customer-managed keys (CMKs) associated with file systems. It verifies that permissions granted to these keys are limited to the minimum necessary for legitimate business operations. To remediate, review and update IAM policies to ensure only necessary users and groups have key management permissions, leveraging OCI's IAM service for fine-grained access control. Validate changes by auditing IAM policies and monitoring access logs for compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/File/Concepts/filestorageoverview.htm
  - CIS OCI Foundations Benchmark v1.1.0, Section 1.12
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.file_storage.file_system.fileshare_private_network_only_enforced
  service: file_storage
  resource: file_system
  requirement: Fileshare Private Network Only Enforced
  scope: file_storage.file_system.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure File System Access is Restricted to Private Networks Only
  rationale: Restricting file system access to private networks reduces the risk of unauthorized access and data breaches by limiting exposure to public networks. This is crucial for protecting sensitive data stored in file shares and ensuring compliance with regulatory requirements such as GDPR, PCI-DSS, and HIPAA. Unauthorized access can lead to data leaks, financial loss, and reputational damage.
  description: This rule checks that all OCI File Storage file systems are configured to allow access only from private IP addresses. To verify, ensure that access is restricted at the network level using security lists or network security groups (NSGs) that permit traffic solely from private IP ranges. Remediation involves updating security configurations to restrict access to predefined private networks, thus enhancing the protection of sensitive data.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Concepts/filestorageoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_platform
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://www.oracle.com/cloud/security/network-architecture/
  - https://www.oracle.com/a/ocom/docs/cloud/oci-security-architecture.pdf
- rule_id: oci.file_storage.file_system.fileshare_snapshots_enabled
  service: file_storage
  resource: file_system
  requirement: Fileshare Snapshots Enabled
  scope: file_storage.file_system.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure Fileshare Snapshots are Enabled for Data Recovery
  rationale: Enabling fileshare snapshots is crucial for protecting data against accidental deletion, corruption, or ransomware attacks. Snapshots allow for point-in-time recovery, minimizing data loss and ensuring business continuity. Compliance with standards such as NIST and ISO 27001 emphasizes the need for robust backup solutions to safeguard sensitive and critical data.
  description: This rule checks whether fileshare snapshots are enabled for OCI File Storage. Snapshots provide incremental backups that are space-efficient and can be scheduled to run automatically. To verify, ensure that the file system has snapshot policies configured via the OCI Console or API. Remediation involves setting up regular snapshot schedules to align with business continuity and recovery objectives.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Tasks/creatingasnapshot.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-1-1-0.pdf
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-iec-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/File/Tasks/backingupfilesystems.htm
- rule_id: oci.database.autonomous_database.automation_artifacts_encrypted_and_private
  service: database
  resource: autonomous_database
  requirement: Automation Artifacts Encrypted And Private
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Automation Artifacts Are Encrypted
  rationale: Encrypting and maintaining the privacy of automation artifacts in Oracle Cloud Infrastructure's Autonomous Database mitigates the risk of unauthorized access to sensitive data. This is crucial for protecting intellectual property and ensuring compliance with regulations such as GDPR, PCI-DSS, and HIPAA, which mandate strong encryption practices for data at rest. A breach of unencrypted data can lead to significant financial losses and reputational damage.
  description: This rule checks that all automation artifacts associated with the Autonomous Database are encrypted and stored privately. To verify compliance, ensure that Oracle Cloud Infrastructure's Autonomous Database is configured to use Oracle-managed encryption keys or customer-managed keys for all data at rest. Remediation involves enabling encryption settings in the OCI Console and ensuring that access to these artifacts is restricted to authorized users only. Use the OCI Identity and Access Management service to review and adjust permissions as necessary.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
  - https://www.oracle.com/security/
- rule_id: oci.database.autonomous_database.automation_change_audit_logging_enabled
  service: database
  resource: autonomous_database
  requirement: Automation Change Audit Logging Enabled
  scope: database.autonomous_database.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Audit Logging for Autonomous Database Changes
  rationale: Enabling audit logging for changes in Autonomous Databases is crucial to track unauthorized modifications, detect potential security incidents, and ensure accountability. It supports compliance with regulations such as PCI-DSS and ISO 27001 by maintaining a comprehensive record of database activity that can be used for forensic analysis and reporting.
  description: This rule checks whether audit logging for automation changes in Oracle Autonomous Databases is enabled. Audit logs capture details of configuration changes and access patterns, providing visibility into database operations. To verify, ensure that the 'Audit Logs' section in the OCI Console for the Autonomous Database is configured to capture all relevant events. Remediation involves navigating to the Autonomous Database settings in the OCI Console and enabling audit logging under the 'Audit' section.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/security/Reference/logging.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://cloud.oracle.com/database/autonomous-database/features
- rule_id: oci.database.autonomous_database.automation_execution_roles_least_privilege_required
  service: database
  resource: autonomous_database
  requirement: Automation Execution Roles Least Privilege Required
  scope: database.autonomous_database.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Autonomous Database Automation Roles
  rationale: Enforcing least privilege for automation execution roles in OCI Autonomous Database minimizes the risk of unauthorized access and potential data breaches. By granting only the necessary permissions, organizations can protect sensitive data and comply with regulatory requirements such as GDPR and PCI-DSS, thereby reducing the attack surface and potential insider threats.
  description: This rule checks whether automation execution roles assigned to OCI Autonomous Databases have only the necessary privileges. Review IAM policies to ensure roles are not overly permissive and modify them to limit access to only essential resources and actions. Use OCI Identity and Access Management features to regularly audit and remediate any roles that exceed these minimal permissions. Implementing the least privilege principle helps maintain a secure and compliant cloud environment.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/access/managingpolicies.htm
  - https://www.oracle.com/security-cloud/cybersecurity/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security-cloud/identity-and-access-management/
- rule_id: oci.functions.application.automation_artifacts_encrypted_and_private
  service: functions
  resource: application
  requirement: Automation Artifacts Encrypted And Private
  scope: functions.application.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Functions Automation Artifacts are Encrypted and Private
  rationale: Encrypting and maintaining the privacy of automation artifacts in OCI Functions mitigates the risk of unauthorized access and data breaches, which can compromise sensitive business logic and data. Encryption at rest helps meet compliance requirements such as PCI-DSS and ISO 27001, protecting against potential legal and financial repercussions from data exposure.
  description: This rule checks whether automation artifacts used in OCI Functions applications are stored with encryption at rest and are not publicly accessible. Verify that the artifacts are stored in OCI Object Storage with server-side encryption enabled, and ensure that the bucket policies are configured to prevent public access. Remediation involves updating the Object Storage settings to enable encryption and adjusting access policies to restrict unauthorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57p1r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.functions.application.automation_execution_roles_least_privilege_required
  service: functions
  resource: application
  requirement: Automation Execution Roles Least Privilege Required
  scope: functions.application.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for OCI Functions Automation Roles
  rationale: Limiting permissions for automation execution roles to the minimum necessary reduces the risk of unauthorized access and potential exposure of sensitive data. This practice is crucial for mitigating insider threats and minimizing the attack surface. Compliance with standards like NIST and ISO 27001 often requires the implementation of least privilege principles to protect cloud resources and maintain data integrity.
  description: This rule checks that automation execution roles assigned to OCI Functions applications have only the permissions required for their specific tasks. To verify, review the policies attached to these roles and ensure they follow the principle of least privilege. Remediation involves adjusting IAM policies to remove unnecessary permissions and regularly auditing these roles to maintain compliance and security. Implement OCI's IAM policy best practices to enforce strict access controls.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionsaccesscontrol.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam_policy_best_practices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.functions.function.function_dead_letter_queue_configured
  service: functions
  resource: function
  requirement: Function Dead Letter Queue Configured
  scope: functions.function.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Functions Have Configured Dead Letter Queues
  rationale: Configuring a dead letter queue for Oracle Functions is crucial for managing failed events. Without it, failed function executions could result in data loss or delayed processing, impacting business operations and compliance with data handling standards. It mitigates security risks by ensuring that failed events are not silently discarded, thus maintaining auditability and traceability.
  description: This rule checks whether Oracle Functions have a dead letter queue configured. It ensures that any failed executions are captured for later analysis and reprocessing. To verify, check the function's configuration for a specified OCI Streaming or Notification Service as a dead letter queue. Remediation involves setting up an appropriate queue and updating the function configuration to include it, thus providing a fallback for failed executions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionsconfiguring.htm#dead-letter-queue
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/security/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://cloud.oracle.com/compliance
- rule_id: oci.functions.function.function_env_no_plaintext_secrets
  service: functions
  resource: function
  requirement: Function Env No Plaintext Secrets
  scope: functions.function.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Prevent Plaintext Secrets in OCI Function Environments
  rationale: Storing plaintext secrets in function environments poses a significant security risk as it can lead to unauthorized access and data breaches. This is crucial for maintaining data confidentiality and integrity, particularly for sensitive information governed by regulations such as PCI-DSS and HIPAA. Securely managing secrets helps mitigate the risk of insider threats and accidental exposure.
  description: This rule checks for plaintext secrets in Oracle Cloud Infrastructure function environment variables. To comply, use OCI Vault to securely store and manage secrets, then access them in your functions using Oracle's Secrets Management service. Remediation involves updating function configurations to reference secrets stored in OCI Vault, ensuring they are not hard-coded in plaintext.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionsaccessingociresources.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/index.html
- rule_id: oci.functions.application.function_logging_and_tracing_enabled
  service: functions
  resource: application
  requirement: Function Logging And Tracing Enabled
  scope: functions.application.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Logging and Tracing Enabled for OCI Functions
  rationale: Enabling logging and tracing for OCI Functions is critical for monitoring and auditing function executions, which helps in identifying and responding to potential security incidents. It provides visibility into the function's behavior and performance, assisting in compliance with regulatory requirements such as PCI-DSS and SOC2 that mandate detailed logging for audit purposes. Without these features enabled, detecting anomalous activities or diagnosing issues becomes challenging, increasing the risk of undetected breaches.
  description: This rule checks whether logging and tracing are enabled for OCI Functions within an application. Ensure that the application has a properly configured Logging policy to capture Function execution details. To verify, navigate to the OCI console, locate the Functions application, and confirm that 'Logging' is set up with appropriate log groups and log objects. Remediation involves creating and attaching a Logging policy to the Functions application, ensuring logs are directed to a designated log group and enabling tracing via the OCI Monitoring service.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionslogging.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss_v3-2-1
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/sorhome.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.functions.function.function_role_least_privilege_required
  service: functions
  resource: function
  requirement: Function Role Least Privilege Required
  scope: functions.function.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Functions Use Least Privilege Role for Security
  rationale: This rule ensures that Oracle Functions have the minimum permissions necessary to perform their tasks. Over-privileged roles increase the risk of unauthorized access and data compromise, potentially leading to data breaches or service disruptions. Adhering to least privilege principles supports compliance with standards like NIST and ISO 27001, mitigating risks associated with excessive permissions.
  description: This rule checks that Oracle Functions are assigned roles with only the permissions required to execute their specific tasks. Administrators should audit the roles associated with each function, ensuring only necessary permissions are granted. If excessive permissions are found, modify the IAM policies to remove unnecessary access. Regular review and adjustment of these roles are critical to maintaining a secure, least-privilege environment.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionscreatingappsandfunctions.htm
  - https://www.oracle.com/security/cis-benchmarks/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/security/
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
- rule_id: oci.functions.application.function_vpc_private_networking_enabled
  service: functions
  resource: application
  requirement: Function VPC Private Networking Enabled
  scope: functions.application.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Functions Use VPC Private Networking
  rationale: Enabling VPC private networking for Oracle Functions enhances security by restricting function access to within a Virtual Cloud Network (VCN), thus minimizing exposure to the public internet. This reduces the risk of unauthorized access and data breaches, aligning with compliance requirements such as PCI-DSS and HIPAA that mandate stringent network isolation and data protection measures.
  description: This rule checks whether Oracle Functions within an application are configured to use VPC private networking. By enabling this feature, functions communicate over a private IP address space within a VCN, enhancing security and performance. To verify, ensure the 'VPC Private Networking Enabled' setting is configured for each function in the OCI Console under the application settings. Remediation involves updating the function's networking configuration to enable VPC private networking, as detailed in the OCI documentation.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionscreatingfunctions.htm#private
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/index.html
  - https://cloudsecurityalliance.org/research/security-guidance/
- rule_id: oci.functions.application.config_remediation_auto_enabled_for_high
  service: functions
  resource: application
  requirement: Config Remediation Auto Enabled For High
  scope: functions.application.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Auto-Enable High-Risk Config Remediation for OCI Functions
  rationale: Automatically enabling configuration remediation for high-risk settings in OCI Functions is crucial to ensure that vulnerabilities are swiftly addressed, reducing the window of exposure to potential threats. This practice minimizes the risk of exploitation by attackers, supports compliance with security frameworks, and protects sensitive business processes and data handled by serverless functions.
  description: This rule checks whether automatic remediation is enabled for high-risk configurations in OCI Functions applications. It ensures that any detected security misconfigurations are automatically corrected to align with security policies. To verify, review the application's configuration settings in the OCI console and ensure the auto-remediation feature is turned on. Remediation involves enabling the 'Config Remediation Auto' setting for high-risk configurations within the Functions application's security settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/home.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
- rule_id: oci.functions.application.config_remediation_manual_runbooks_attached
  service: functions
  resource: application
  requirement: Config Remediation Manual Runbooks Attached
  scope: functions.application.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Functions Apps Have Config Remediation Runbooks
  rationale: Attaching manual remediation runbooks to application configurations in OCI Functions enhances operational readiness and compliance posture by ensuring that any misconfigurations can be promptly addressed. Without predefined runbooks, there is a risk of delayed response to security incidents, which could lead to compliance violations and potential data breaches.
  description: This check ensures that all OCI Functions applications have manual remediation runbooks attached to their configuration settings. Runbooks provide step-by-step instructions to rectify configuration issues, thereby reducing downtime and ensuring compliance. To verify, review the application's configuration for attached runbooks, and if missing, create and attach them based on specific security policies and operational procedures. Follow Oracle's documentation on creating and managing runbooks to guide this process.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Concepts/functionsoverview.htm
  - https://www.oracle.com/security-cloud/cis-oci-benchmark/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
- rule_id: oci.monitoring.alarm.dns_security_health_check_alerts_configured
  service: monitoring
  resource: alarm
  requirement: Dns Security Health Check Alerts Configured
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Configure DNS Security Health Check Alerts
  rationale: Monitoring DNS health is critical for identifying potential security threats, such as DNS spoofing or denial-of-service attacks, which can disrupt business operations and lead to data breaches. Configuring health check alerts enhances visibility into DNS performance and security, supporting compliance with cybersecurity frameworks like ISO 27001 and NIST.
  description: This rule verifies whether alarms are configured to monitor DNS security health checks within Oracle Cloud Infrastructure. It checks for specific alert criteria, such as DNS response time and error rate thresholds, ensuring timely detection and response to anomalies. To implement, create OCI alarms based on DNS health check metrics in the Monitoring service, and configure notifications through the Notifications service for prompt incident response.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DNS/Reference/dns_security.htm
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/monitoringusingalarms.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.monitoring.alarm.dns_security_health_check_https_or_tls_used
  service: monitoring
  resource: alarm
  requirement: Dns Security Health Check HTTPS Or TLS Used
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure DNS Health Checks Use HTTPS or TLS
  rationale: Using HTTPS or TLS for DNS health checks helps prevent eavesdropping, tampering, and man-in-the-middle attacks on DNS queries. This is critical in mitigating risks associated with data interception and unauthorized data access, ensuring the integrity and confidentiality of DNS traffic. Compliance with security standards such as NIST and PCI-DSS often mandates secure transmission protocols, highlighting the importance of this configuration in maintaining a robust security posture.
  description: This rule verifies that all DNS Security Health Checks are configured to use HTTPS or TLS protocols, which provide encrypted communication channels. To ensure compliance, review the configuration of each DNS health check in your OCI environment and adjust any that are not using HTTPS or TLS. Implementing this involves updating the health check settings in the OCI Console or using the CLI to specify the appropriate protocol. Regular audits should be conducted to confirm continued adherence to this security best practice.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/HealthChecks/Concepts/healthchecks.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-1-1-0-benchmark.htm
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.monitoring.alarm.dns_security_health_check_no_plaintext_url
  service: monitoring
  resource: alarm
  requirement: Dns Security Health Check No Plaintext Url
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Avoid Plaintext URLs in DNS Security Health Check Alarms
  rationale: Using plaintext URLs in DNS Security Health Check alarms can expose sensitive information to potential interception during transmission, increasing the risk of data breaches. This practice can lead to compliance issues with frameworks such as PCI-DSS and HIPAA, which require secure transmission of sensitive data. Ensuring encryption of URLs maintains data integrity and confidentiality, protecting business assets and customer information.
  description: This rule checks for the presence of plaintext URLs in OCI monitoring alarms related to DNS Security Health Checks. Alarms configured with such URLs may inadvertently expose sensitive information. To verify, inspect the alarm configuration in the OCI console or via API to ensure that URLs use HTTPS instead of HTTP. To remediate, update the alarm configuration to use only encrypted URLs (HTTPS), ensuring all endpoints are secured.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hipaajournal.com/hipaa-encryption-requirements/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- rule_id: oci.identity.group.group_attached_policies_not_admin_star_restricted
  service: identity
  resource: group
  requirement: Group Attached Policies Not Admin Star Restricted
  scope: identity.group.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Admin Star Policies for OCI Identity Groups
  rationale: Improperly broad admin privileges pose a significant risk, potentially allowing unauthorized users to perform critical actions, leading to data breaches or service disruptions. Restricting 'admin' policies prevents privilege escalation and aligns with compliance mandates such as NIST SP 800-53 and ISO 27001, reducing the attack surface and ensuring a principle of least privilege.
  description: This rule checks for OCI Identity Groups with attached policies that grant overly broad administrative permissions, such as those with 'admin:*' actions. To verify, review the policies attached to each group in the OCI Console under Identity > Groups. To remediate, modify policies to use more granular permissions, only granting necessary actions. For example, replace overly broad policies with specific ones that align with the group's functional requirements while minimizing privileges.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managinggroups.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.identity.group.group_membership_review_enabled
  service: identity
  resource: group
  requirement: Group Membership Review Enabled
  scope: identity.group.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Group Membership Review is Regularly Conducted
  rationale: Regular review of group memberships is crucial to maintain least privilege access, preventing unauthorized access by ensuring that only necessary users have group memberships. This reduces the risk of privilege escalation and potential data breaches, aligning with compliance standards such as ISO 27001 and SOC2, which mandate periodic access reviews to enforce appropriate access controls.
  description: This rule checks if there is a process in place for regular review of group memberships in OCI Identity. Group membership reviews should be conducted at specified intervals to verify that users' access aligns with their current roles and responsibilities. Administrators should utilize OCI Identity service logs and audit features to schedule and conduct these reviews. Remediation involves setting up a periodic review schedule and documenting the review process to ensure compliance and security integrity.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/manage/id_groups.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.identity.group.group_no_inline_policies_restricted
  service: identity
  resource: group
  requirement: Group No Inline Policies Restricted
  scope: identity.group.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict Inline Policies for OCI Identity Groups
  rationale: Inline policies attached directly to identity groups can increase security risks by bypassing centralized policy management, leading to potential over-permissioning and privilege escalation. This practice can undermine compliance with regulatory requirements, such as those set by NIST and ISO 27001, which demand strict access controls and policy management. Inconsistent or overly broad permissions may expose sensitive resources to unauthorized access, increasing the attack surface.
  description: This rule checks that no inline policies are attached to OCI identity groups, ensuring that all permissions are managed through centralized and controlled policies. Inline policies can create challenges in tracking and auditing permissions, which might lead to security vulnerabilities. To verify, review the OCI Console or use the OCI CLI to list all group policies and ensure they are empty. Remediation involves removing inline policies from groups and reassigning necessary permissions through standard, audited policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-iec-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.identity.policy.role_attached_policies_not_admin_star_restricted
  service: identity
  resource: policy
  requirement: Role Attached Policies Not Admin Star Restricted
  scope: identity.policy.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Admin Permissions in Role-Attached Policies
  rationale: Overly permissive policies with 'admin' privileges can lead to unauthorized access and control over critical resources, increasing the risk of data breaches and non-compliance with regulatory standards such as PCI DSS and ISO 27001. Restricting such permissions helps ensure that only authorized personnel have the necessary access, reducing the likelihood of privilege escalation and insider threats.
  description: This rule checks for policies attached to roles that grant overly broad administrative privileges using the 'Admin:*' pattern. It is crucial to review and restrict these policies to adhere to the principle of least privilege. Administrators should modify policies to limit permissions to only what is necessary for the role's function. Verification can be done via the OCI console by examining policy statements and cross-referencing with role requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/identitypoliciesbestpractices.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
- rule_id: oci.identity.policy.role_max_session_duration_reasonable_restricted
  service: identity
  resource: policy
  requirement: Role Max Session Duration Reasonable Restricted
  scope: identity.policy.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Max Session Duration is Reasonably Restricted
  rationale: Restricting the maximum session duration for roles helps mitigate the risk of unauthorized access due to prolonged sessions, reducing the window of opportunity for attackers to exploit compromised credentials. This control aligns with regulatory compliance by ensuring access is time-bound and regularly re-authenticated, thereby supporting principles of least privilege and session management.
  description: This rule checks if the maximum session duration for roles defined in OCI policies is set to a reasonable limit, typically not exceeding 12 hours. To verify, inspect IAM policies and ensure the session duration parameter is configured correctly. Remediation involves adjusting the session duration parameter in the policy to align with organizational security policies, typically using OCI CLI or Console to update the policy configurations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/standards/publications/sp-800-53
  - https://cloudsecurityalliance.org/research/guidance/
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/identitypolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
- rule_id: oci.identity.policy.role_no_inline_policies_restricted
  service: identity
  resource: policy
  requirement: Role No Inline Policies Restricted
  scope: identity.policy.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Limit Inline Policies in OCI Identity Roles
  rationale: Restricting inline policies in OCI identity roles helps maintain centralized policy management, reducing the risk of unauthorized access and security misconfigurations. Inline policies can lead to decentralized and difficult-to-audit permissions, increasing the risk of privilege escalation and potential data breaches. Compliance with standards such as ISO 27001 and PCI-DSS requires demonstrable control over access management, which inline policies can complicate.
  description: This rule checks whether OCI identity policies are using inline policies instead of managed policies. Inline policies should be avoided as they are not reusable and can lead to inconsistent and unmanaged access permissions. To verify, review the policies attached to roles in OCI and ensure they are using managed policies. Remediation involves moving permissions to managed policies and removing inline policies from roles.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/best-practices/
- rule_id: oci.identity.policy.role_trust_principals_allowlist_only_restricted
  service: identity
  resource: policy
  requirement: Role Trust Principals Allowlist Only Restricted
  scope: identity.policy.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict Role Trust Principals to Allowlist in OCI Policies
  rationale: Limiting role trust principals to an allowlist minimizes the risk of unauthorized access by ensuring that only pre-approved identities can assume roles. This reduces the attack surface and prevents privilege escalation, which is crucial for protecting sensitive resources and maintaining compliance with security standards such as ISO 27001 and SOC2.
  description: This rule checks that OCI identity policies only permit role trust principals that are specified in a predefined allowlist. To verify compliance, review the policy statements in the OCI console or use the CLI to ensure only allowed principals are listed. Remediation involves updating policies to restrict role trust assignments to trusted entities by editing policy statements and removing unauthorized principals, thereby adhering to the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.identity.policy.role_trust_requires_external_id_or_restricted
  service: identity
  resource: policy
  requirement: Role Trust Requires External Id Or Restricted
  scope: identity.policy.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Role Trust Policies Use External ID or Are Restricted
  rationale: Role trust policies without external IDs or sufficient restrictions can lead to unauthorized access, increasing the risk of data breaches. By requiring an external ID or implementing strict role restrictions, organizations can mitigate the risk of privilege escalation and comply with security standards such as NIST and PCI-DSS, thereby protecting sensitive business data and maintaining customer trust.
  description: This rule checks if OCI identity policies for role trust include an external ID or are appropriately restricted to prevent unauthorized access. To verify, audit the policy statements and ensure they include an 'externalId' condition or limit access to specific, trusted principles. Remediation involves updating policies to include an external ID condition or restricting access to known entities, thus aligning with Oracle Cloud's security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygrammar.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://www.nist.gov/document-2238
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.identity.policy.rbac_role_attached_policies_not_admin_star_restricted
  service: identity
  resource: policy
  requirement: RBAC Role Attached Policies Not Admin Star Restricted
  scope: identity.policy.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Admin Star Privileges in RBAC Role Policies
  rationale: Unrestricted admin policies pose a significant risk by potentially allowing unauthorized access to sensitive resources, leading to data breaches or service disruptions. Limiting 'admin:*' privileges is crucial for maintaining least privilege access, reducing the attack vector, and ensuring compliance with security frameworks such as NIST and ISO 27001.
  description: This rule checks for policies attached to RBAC roles that include unrestricted 'admin:*' permissions. Such permissions should be scoped to necessary resources only to align with the principle of least privilege. Verify policies in the Oracle Cloud Console under Identity > Policies, and modify any broad permissions to be resource-specific. Remediation involves editing policies to replace 'admin:*' with more specific actions and resources.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://cloudsecurityalliance.org/research/artifacts/oracle-cloud-infrastructure-security-best-practices
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.identity.policy.rbac_role_no_inline_policies_restricted
  service: identity
  resource: policy
  requirement: RBAC Role No Inline Policies Restricted
  scope: identity.policy.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Disable Inline Policies for RBAC Roles
  rationale: Restricting inline policies for RBAC roles prevents unauthorized policy changes that could lead to privilege escalation or security breaches. Inline policies are less visible and harder to audit compared to managed policies, increasing the risk of inadvertent policy misconfigurations. Compliance with standards like NIST and ISO 27001 requires thorough policy management and auditing to protect sensitive data and maintain operational integrity.
  description: This rule checks if RBAC roles have attached inline policies in OCI, which are discouraged due to the challenges they pose for policy management and auditing. Inline policies should be replaced with managed policies that are centrally controlled and easier to audit. To verify, review the policy attachments for each role in OCI and convert any inline policies to managed ones. Remediation involves creating equivalent managed policies and updating role assignments accordingly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Reference/policyreference.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_2021
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.identity.policy.rbac_role_session_duration_reasonable_where_applicable_restricted
  service: identity
  resource: policy
  requirement: RBAC Role Session Duration Reasonable Where Applicable Restricted
  scope: identity.policy.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict RBAC Role Session Duration to Reasonable Limits
  rationale: Limiting RBAC role session duration reduces the window of opportunity for unauthorized access in case credentials are compromised. It minimizes the risk of prolonged exposure to sensitive resources, aligning with best practices for identity and access management. It also helps organizations comply with regulatory requirements that mandate stringent access controls.
  description: This rule checks if the duration for which an RBAC role is assumed is set to a reasonable limit in OCI. A reasonable session duration should be configured to minimize security risks while allowing adequate time for legitimate tasks. Administrators should configure policies to set session durations according to the principle of least privilege and regularly review these settings for appropriateness. To remediate, adjust the session duration in the policy settings in the OCI Console under Identity and Access Management, ensuring it balances operational needs with security requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-foundations-benchmark-v1-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.identity.user.user_access_keys_rotated_90_days_restricted
  service: identity
  resource: user
  requirement: User Access Keys Rotated 90 Days Restricted
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce 90-Day Rotation for User Access Keys in OCI
  rationale: Regular rotation of access keys is crucial to mitigate the risk of compromised credentials leading to unauthorized access. Lengthy exposure of static access keys increases the likelihood of exploitation through key leakage or brute force attacks, posing significant threats to data integrity and compliance with security standards such as NIST and PCI-DSS.
  description: This rule evaluates the age of access keys associated with OCI user accounts, ensuring they are rotated every 90 days. It checks the 'Last Rotated' timestamp of each access key and flags those exceeding the threshold. Administrators should implement automated alerts and rotate keys using the OCI Console or SDK. Revoking old keys after rotation minimizes the attack surface and maintains alignment with security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm#Rotating
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://doi.org/10.6028/NIST.SP.800-53r5
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://cloudsecurityalliance.org/research/guidance
- rule_id: oci.identity.user.user_console_password_present_only_if_required
  service: identity
  resource: user
  requirement: User Console Password Present Only If Required
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure User Console Passwords Are Required and Secure
  rationale: Having console passwords present when not required increases the risk of unauthorized access, especially if passwords are weak or not regularly updated. Compromised user credentials can lead to unauthorized actions, data breaches, and non-compliance with regulations like PCI-DSS and ISO 27001. It is crucial to minimize attack surfaces by ensuring passwords are used only when necessary and are managed securely.
  description: This rule checks that user accounts in OCI have console passwords only when necessary. Accounts with unnecessary console passwords could be an avenue for unauthorized access. To verify, review user accounts to ensure passwords are only set for roles requiring console access, and disable them otherwise. Implement password policies to enforce complexity, regular updates, and multi-factor authentication for enhanced security. Periodically audit user accounts to keep the environment secure.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r3.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.identity.user.user_inactive_90_days_disabled
  service: identity
  resource: user
  requirement: User Inactive 90 Days Disabled
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Disable Inactive Users After 90 Days
  rationale: Inactive user accounts pose a security risk as they can be exploited by attackers to gain unauthorized access to systems. Disabling users who have been inactive for 90 days helps minimize the attack surface by ensuring that only active and necessary accounts have access to resources. This practice supports compliance with security frameworks that require regular review and management of user accounts.
  description: This rule checks for user accounts in Oracle Cloud Infrastructure that have been inactive for 90 days and automatically disables them. An inactive account is identified by the absence of any login or usage activity within the specified period. To verify, administrators can review the last login activity in the OCI Console. To remediate, regularly audit user activity and disable or remove accounts that are no longer needed to maintain a secure environment.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/user-managingusers.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
  - https://www.oracle.com/security-cloud/compliance/
- rule_id: oci.identity.user.user_mfa_required
  service: identity
  resource: user
  requirement: User MFA Required
  scope: identity.user.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce MFA for OCI User Accounts
  rationale: Requiring multi-factor authentication (MFA) for all user accounts in OCI significantly reduces the risk of unauthorized access, particularly in scenarios where an attacker obtains user credentials. Implementing MFA is crucial for protecting sensitive data and services from potential breaches and aligns with industry best practices and compliance mandates such as PCI-DSS and NIST SP 800-63, which emphasize strong authentication mechanisms.
  description: This rule checks that all user accounts in OCI have MFA enabled. Without MFA, users rely solely on passwords, which can be vulnerable to phishing, credential stuffing, and brute force attacks. To verify compliance, ensure that each user in the OCI Console has MFA configured through the Identity settings. Remediate by enabling MFA for users lacking this protection, following Oracle's step-by-step guidance for configuring MFA in the OCI environment.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm#To_set_up_MFA
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-63/rev-3/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.oracle.com/security/cloud-security/best-practices/
- rule_id: oci.identity.user.user_no_inline_policies_attached_restricted
  service: identity
  resource: user
  requirement: User No Inline Policies Attached Restricted
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict Inline Policies for OCI Users
  rationale: Attaching inline policies directly to users can lead to fragmented and inconsistent policy management, increasing the risk of excessive permissions and potential unauthorized access. By centralizing policy management through groups and policies, organizations can ensure better control over user permissions, align with the principle of least privilege, and meet compliance requirements like PCI-DSS and ISO 27001.
  description: This rule checks if any OCI user has inline policies attached, which is against best practices for identity and access management. Users should not have policies attached directly; instead, use IAM groups to manage and apply policies. To remediate, detach any inline policies from users and use group-based policies. Audit existing users for compliance by reviewing their policy attachments in the OCI console or API.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - https://www.oracle.com/security-cloud/cis-oracle-cloud-infrastructure/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/groups.htm
- rule_id: oci.compute.instance.launch_template_imds_hardened
  service: compute
  resource: instance
  requirement: Launch Template Imds Hardened
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Harden IMDS on OCI Compute Instances
  rationale: Hardening the Instance Metadata Service (IMDS) is crucial to prevent unauthorized access to sensitive instance metadata, which attackers can exploit to gain insights into cloud infrastructure, potentially leading to privilege escalation or data exfiltration. Ensuring IMDS is hardened aligns with compliance requirements such as NIST SP 800-53 and enhances the overall security posture by mitigating risks associated with metadata exposure.
  description: This rule checks if the Instance Metadata Service (IMDS) on Oracle Cloud Infrastructure (OCI) compute instances is hardened by enforcing V2 requests only. To verify, inspect the instance launch template settings to ensure IMDSv2 is enabled and IMDSv1 is disabled. Remediate by updating the launch template to enforce IMDSv2 through the OCI CLI or Console, which involves setting the 'Require IMDSv2' option to true.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/usingimds.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/ocisecuritybestpractices.htm
- rule_id: oci.compute.instance.launch_template_instance_profile_least_privilege_required
  service: compute
  resource: instance
  requirement: Launch Template Instance Profile Least Privilege Required
  scope: compute.instance.least_privilege
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: high
  title: Ensure Least Privilege for Launch Templates in OCI
  rationale: Misconfigured launch templates with excessive privileges can lead to unauthorized access, data breaches, and non-compliance with regulations such as GDPR or PCI-DSS. By enforcing least privilege, organizations minimize the attack surface, reduce the risk of privilege escalation, and ensure adherence to least privilege principles, crucial for maintaining secure cloud environments.
  description: This rule checks that OCI launch templates for compute instances are configured with the minimum necessary privileges, aligning with the principle of least privilege. Review and adjust instance profiles to ensure they only include permissions essential for their function. To verify, examine the IAM policies associated with launch templates in the OCI Console and refine them by removing unnecessary permissions. Remediation involves updating IAM policies and roles to remove excessive access rights.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/managinginstancetemplates.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.compute.instance.launch_template_no_public_ip_default_blocked
  service: compute
  resource: instance
  requirement: Launch Template No Public Ip Default Blocked
  scope: compute.instance.public_access
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Block Default Public IP in Compute Instance Launch Templates
  rationale: Allowing instances to have public IP addresses by default can expose them to unauthorized access and attacks, such as DDoS or data exfiltration. By blocking public IP allocation by default, organizations can reduce the attack surface and comply with security regulations like PCI-DSS and ISO 27001, which mandate strict network and data protection measures.
  description: This rule checks if Oracle Cloud Infrastructure (OCI) Compute instance launch templates are configured to block public IP addresses by default. To verify, ensure that the 'assignPublicIp' attribute in the launch template is set to 'false'. Remediation involves editing the launch template to disable public IP assignment or creating a network security group to restrict external traffic. This practice enhances security by limiting direct exposure to the internet.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/launchinginstanceusingtemplate.htm
  - https://learn.oracle.com/ols/module/cis-benchmark-oracle-cloud-infrastructure-foundations/34506/57737
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
- rule_id: oci.compute.instance.launch_template_root_volume_encrypted_by_default
  service: compute
  resource: instance
  requirement: Launch Template Root Volume Encrypted By Default
  scope: compute.instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: critical
  title: Ensure Root Volume Encryption in OCI Launch Templates
  rationale: Encrypting root volumes by default in OCI launch templates is crucial for protecting sensitive data from unauthorized access and potential breaches. Without encryption, data stored at rest is vulnerable to extraction and misuse, posing significant risks to data confidentiality and integrity. Compliance with regulations like GDPR, HIPAA, and PCI-DSS often mandates encryption of sensitive data, and failure to comply can lead to fines and reputational damage.
  description: This rule checks if the root volumes in OCI launch templates are configured to be encrypted by default. Ensure that the 'Enable Encryption' option is selected when creating or updating launch templates, which uses Oracle-managed keys or customer-managed keys for encryption. To verify, review the launch template settings in the OCI Console under Compute > Instances > Launch Templates. Remediation involves editing the launch template to enable encryption and deploying new instances from this updated template.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/encryptingvolumes.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.compute.instance.launch_template_security_groups_restrictive
  service: compute
  resource: instance
  requirement: Launch Template Security Groups Restrictive
  scope: compute.instance.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Restrictive Security Groups for Compute Instance Launch Templates
  rationale: Restrictive security groups limit network exposure of compute instances, reducing the risk of unauthorized access and potential data breaches. This control is crucial for maintaining the confidentiality and integrity of sensitive data, aligning with compliance mandates such as PCI-DSS and HIPAA. Misconfigured security groups can lead to open ports that expose systems to threat actors, increasing the likelihood of cyber attacks.
  description: This rule checks that security groups associated with compute instance launch templates in OCI are configured with the least privilege principle. It ensures that only necessary ports are open and restricts access to known IP ranges. To verify, review the security group configurations in the OCI Console under Networking. Remediation involves modifying security group rules to allow only essential traffic, utilizing specific IP whitelisting and restricting inbound and outbound rules.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingVCNs.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/index.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.compute.instance.launch_template_user_data_no_secrets
  service: compute
  resource: instance
  requirement: Launch Template User Data No Secrets
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: high
  title: Prevent Secrets in Launch Template User Data
  rationale: Embedding secrets such as passwords or API keys in launch template user data can lead to unauthorized access and data breaches. This practice increases the risk of credential exposure, impacting both data integrity and compliance with regulations like PCI-DSS and HIPAA. Ensuring user data is free of sensitive information is crucial to maintaining a secure cloud environment.
  description: This rule checks if launch templates for OCI compute instances contain sensitive information in their user data scripts. User data is often used for instance initialization, and storing secrets here can expose them to unauthorized users. To remediate, ensure that all secrets are stored in secure vaults, such as OCI Vault, and accessed programmatically using Instance Principals or Resource Principals. Verify compliance by reviewing launch template configurations and removing any sensitive data from user data fields.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/usinginstanceprincipals.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/commonpolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Compute/References/security_compliance.htm
  - CIS OCI Foundations Benchmark
  - NIST SP 800-53
  - PCI-DSS Requirement 3
- rule_id: oci.compute.instance.instance_group_profile_least_privilege_required
  service: compute
  resource: instance
  requirement: Instance Group Profile Least Privilege Required
  scope: compute.instance.least_privilege
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: high
  title: Enforce Least Privilege for Compute Instances
  rationale: Ensuring least privilege for instance group profiles in OCI minimizes the risk of unauthorized access and potential data breaches. By restricting permissions to only those necessary, organizations reduce the attack surface, aligning with compliance standards like PCI-DSS and ISO 27001. This practice helps prevent privilege escalation and limits the impact of compromised credentials.
  description: This rule checks that compute instance group profiles are configured with the least privilege required. Verify configurations by reviewing IAM policies associated with instance groups, ensuring they grant the minimum permissions necessary for operation. To remediate, adjust policies to remove excessive permissions, and regularly review and update them in line with operational needs. Use OCI Identity and Access Management (IAM) service to manage and audit permissions effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-landing.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
  - https://www.oracle.com/security/cloud-security/cloud-infrastructure-security.html
- rule_id: oci.compute.instance.instance_group_no_public_ip_assigned_blocked
  service: compute
  resource: instance
  requirement: Instance Group No Public Ip Assigned Blocked
  scope: compute.instance.public_access
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Ensure Instances in Group Are Not Assigned Public IPs
  rationale: Instances with public IPs are directly exposed to the internet, increasing the risk of unauthorized access, data breaches, and potential exploitation by attackers. This exposure can lead to significant business impact, including data loss, service disruption, and compliance violations with standards like PCI-DSS and NIST, which require stringent access controls.
  description: This rule verifies that instances within a specified group are not assigned public IP addresses, which could expose them to internet threats. To check compliance, review the instance configurations and ensure that they are only assigned private IPs. Remediation involves configuring instances to only use private IPs and employing OCI's NAT Gateway or Load Balancer for necessary internet access, ensuring improved security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingIPaddresses.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/securebydesign.htm
- rule_id: oci.compute.instance.instance_group_uses_approved_launch_template
  service: compute
  resource: instance
  requirement: Instance Group Uses Approved Launch Template
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Instance Groups Use Approved Launch Templates
  rationale: Using approved launch templates for instance groups in OCI helps maintain consistency in configuration, reducing the risk of security vulnerabilities due to misconfigurations. This practice supports compliance with organizational policies and regulatory standards by ensuring that all instances adhere to a predefined secure baseline, mitigating potential threats such as unauthorized access or data breaches.
  description: This rule checks if instance groups within OCI are utilizing approved launch templates. An approved launch template includes settings that align with security best practices such as network configurations, instance shapes, and image versions. To verify compliance, review the instance group's launch template configurations in the OCI Console, ensuring they match the organization's approved list. To remediate, update any non-compliant instance groups to use the correct launch templates, leveraging tools like Terraform or the OCI CLI for efficient management.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/managinginstancetemplates.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.compute.instance.instance_group_volumes_encrypted
  service: compute
  resource: instance
  requirement: Instance Group Volumes Encrypted
  scope: compute.instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Encryption of Instance Group Volumes in OCI
  rationale: Encrypting volumes in OCI is crucial for protecting sensitive data from unauthorized access and potential data breaches. It mitigates risks associated with physical theft, unauthorized access, and ensures compliance with data protection regulations such as GDPR and CCPA. Encryption at rest provides peace of mind for businesses handling sensitive information, reducing the risk of data exposure in the event of a security incident.
  description: This check verifies that all block storage volumes attached to instances within an instance group are encrypted using Oracle-managed keys or customer-managed keys. To verify, review the volume settings in the OCI console or use OCI CLI commands to confirm encryption status. Remediation involves enabling encryption for unencrypted volumes by either re-creating them with encryption enabled or using OCI's volume replication features to migrate data to encrypted volumes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/overview.htm#Encryption
  - https://www.oracle.com/security/cloud.html
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://csrc.nist.gov/publications/detail/sp/800-111/final
  - https://www.iso.org/standard/54534.html
- rule_id: oci.key_management.vault.secrets_security_kms_default_keys_disabled_required
  service: key_management
  resource: vault
  requirement: Secrets Security KMS Default Keys Disabled Required
  scope: key_management.vault.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Disable Default KMS Keys for Vault Secrets
  rationale: Using default KMS keys for managing vault secrets can expose organizations to increased risk of unauthorized access, as default keys may not adhere to an organization's specific security policies and controls. Disabling default keys enhances security by ensuring that only custom-managed keys, which can be tailored to meet regulatory and compliance requirements, are used for encryption.
  description: This rule checks whether the default KMS keys are disabled for vault secrets in Oracle Cloud Infrastructure. It ensures that organizations use custom keys for additional security controls and auditability. To verify compliance, navigate to the OCI Console, access the Key Management service, and check the key assignments for each vault. Remediation involves creating a customer-managed key and assigning it to vault secrets to replace any default key usage.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/usingkeys.htm
  - CIS OCI Foundations Benchmark v1.1.0
  - 'NIST SP 800-57 Part 1: Recommendation for Key Management'
  - 'PCI DSS v3.2.1 Requirement 3: Protect Stored Cardholder Data'
- rule_id: oci.key_management.vault.secrets_security_kms_logging_enabled
  service: key_management
  resource: vault
  requirement: Secrets Security KMS Logging Enabled
  scope: key_management.vault.logging
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Enable Logging for Secrets in OCI Key Management Vaults
  rationale: Enabling logging for secrets in the OCI Key Management Vault is crucial for maintaining visibility into key operations and detecting unauthorized access attempts or anomalous activities. Failure to log these events can lead to undetected security breaches, potentially resulting in data loss or compliance violations with frameworks like PCI-DSS and HIPAA, which mandate detailed logging of key management activities.
  description: This rule checks if logging is enabled for secrets in OCI Key Management Vaults. Logging provides audit trails of operations such as creation, access, and deletion of secrets. To verify, ensure that logging is configured and actively capturing events in the OCI Audit service. Remediation involves setting up and enabling logging through the OCI Console by navigating to the Vault details and ensuring audit logs are directed to a designated logging service for continuous monitoring and alerting.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managinglogs.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.load_balancer.load_balancer.lb_access_logs_enabled
  service: load_balancer
  resource: load_balancer
  requirement: Lb Access Logs Enabled
  scope: load_balancer.load_balancer.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Access Logging for Load Balancers
  rationale: Enabling access logs for Load Balancers in OCI helps track and analyze requests for security auditing and troubleshooting. It allows identification of unusual patterns or unauthorized access attempts, mitigating risks of data breaches. Furthermore, maintaining logs is crucial for compliance with standards like PCI-DSS and ISO 27001, which require audit trails for critical systems.
  description: This rule checks whether access logging is enabled for OCI Load Balancers. Access logs record detailed information about requests processed by the load balancer, which can be configured in the OCI console under the Load Balancer's 'Logging' section. To enable logging, navigate to the Load Balancer settings and ensure 'Logging' is set to 'Enabled'. This ensures an audit trail is maintained for monitoring and forensic analysis.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Tasks/managingrequestlogs.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.load_balancer.load_balancer.lb_listener_tls_min_1_2_required
  service: load_balancer
  resource: load_balancer
  requirement: Lb Listener TLS Min 1 2 Required
  scope: load_balancer.load_balancer.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enforce TLS 1.2+ on OCI Load Balancer Listeners
  rationale: Requiring TLS 1.2 or higher for load balancer listeners ensures secure data transmission by protecting against known vulnerabilities in older protocols. This is crucial for safeguarding sensitive information, maintaining customer trust, and meeting compliance standards such as PCI-DSS and ISO 27001, which mandate strong encryption for data in transit.
  description: This rule checks if OCI Load Balancer listeners are configured to use a minimum of TLS 1.2. Older versions of TLS, such as 1.0 and 1.1, are susceptible to various attacks, including BEAST and POODLE. To verify compliance, review the Load Balancer listener settings in the OCI Console or via CLI/API. Remediate by setting the listener's security policy to 'oci-tls-1-2' or higher, ensuring all data in transit uses robust encryption standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Reference/supported_ssl_protocols.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/publications/sp-800-52-rev-2-guidelines-selection-configuration-and-use-tls-implementations
  - https://www.oracle.com/security/cloud-security.html
- rule_id: oci.load_balancer.load_balancer.lb_valid_certificate_attached
  service: load_balancer
  resource: load_balancer
  requirement: Lb Valid Certificate Attached
  scope: load_balancer.load_balancer.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Valid SSL Certificate on Load Balancers
  rationale: Attaching a valid SSL certificate to load balancers is crucial for protecting data in transit, preventing man-in-the-middle attacks, and ensuring the authenticity of the communication endpoint. Without a valid certificate, sensitive data may be exposed to unauthorized parties, leading to potential data breaches and non-compliance with regulations such as PCI-DSS and HIPAA.
  description: This rule checks whether an SSL certificate attached to an OCI load balancer is valid and not expired. A valid SSL certificate ensures encrypted data transmission between clients and the load balancer. To verify, check the SSL certificate details in the OCI console and ensure it is from a trusted certificate authority (CA) and has not expired. If a certificate is invalid or expired, replace it with a current certificate from a recognized CA to maintain secure communications.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Tasks/managingcertificates.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/index.html
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.load_balancer.load_balancer.lb_waf_attached_where_supported
  service: load_balancer
  resource: load_balancer
  requirement: Lb Waf Attached Where Supported
  scope: load_balancer.load_balancer.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure WAF is Attached to Load Balancers When Supported
  rationale: Attaching a Web Application Firewall (WAF) to load balancers helps protect web applications from common threats such as SQL injection, cross-site scripting, and other OWASP Top Ten vulnerabilities. This can prevent data breaches and service disruptions, thereby safeguarding business operations and customer data. Compliance with security standards like PCI-DSS and NIST often requires such protective measures.
  description: This rule checks if a Web Application Firewall (WAF) is attached to your Oracle Cloud Infrastructure (OCI) load balancers where supported. To verify, ensure that the WAF policy is configured and associated with the load balancer in the OCI console. Remediation involves navigating to the Load Balancer service, selecting the relevant load balancer, and attaching an existing WAF policy or creating a new one if not present. This enhances the security posture by adding an additional layer of defense against web threats.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Concepts/what_is_waf.htm
  - https://www.oracle.com/security-cloud/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://owasp.org/www-project-top-ten/
  - https://www.pcisecuritystandards.org/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.load_balancer.listener.listener_cipher_policy_secure
  service: load_balancer
  resource: listener
  requirement: Listener Cipher Policy Secure
  scope: load_balancer.listener.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Load Balancer Listener Uses a Secure Cipher Policy
  rationale: Using secure cipher policies for load balancer listeners mitigates the risk of data breaches by preventing the use of weak encryption algorithms that could be exploited by attackers. This is crucial for organizations to protect sensitive data, maintain trust with customers, and comply with industry standards such as PCI-DSS and ISO 27001, which mandate robust encryption practices.
  description: This check ensures that the cipher policy used by the load balancer listener is secure, adhering to recommended encryption standards. A secure cipher policy restricts the use of weak cryptographic algorithms that are vulnerable to attacks. To verify, review the listener configuration in the OCI Console under Load Balancer settings, ensuring it uses a policy like 'OCI-TLS1.2-2021-05'. Remediation involves updating the listener to use a compliant cipher policy, which can be done through the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Reference/cryptographicpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-52r2.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.load_balancer.listener.listener_tls_min_1_2_required
  service: load_balancer
  resource: listener
  requirement: Listener TLS Min 1 2 Required
  scope: load_balancer.listener.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enforce TLS 1.2+ for OCI Load Balancer Listeners
  rationale: Using TLS 1.2 or higher ensures secure communication by protecting data in transit with strong encryption protocols. This reduces the risk of data breaches from outdated or weak security standards. Compliance with regulatory frameworks such as PCI-DSS and NIST mandates the use of secure protocols for data protection, mitigating potential legal and financial repercussions.
  description: This rule checks if Oracle Cloud Infrastructure (OCI) Load Balancer listeners are configured to use a minimum of TLS version 1.2. To verify, inspect the listener configuration in the OCI Console or via API to ensure 'Minimum TLS Version' is set to '1.2' or higher. Remediate by updating any listeners using older TLS versions to at least TLS 1.2, which can be done through the OCI Console under the Load Balancer's listener settings or by using Infrastructure-as-Code tools.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Concepts/balanceoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/document_library
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-52r2.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/securitybestpractices.htm
- rule_id: oci.analytics.analytics_instance.api_security_monitoring_access_log_fields_restricted
  service: analytics
  resource: analytics_instance
  requirement: API Security Monitoring Access Log Fields Restricted
  scope: analytics.analytics_instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Restrict Analytics API Access Log Fields
  rationale: Restricting access log fields in the OCI Analytics service helps to minimize exposure of sensitive information, such as personally identifiable information (PII) or credentials, thereby reducing the risk of data breaches and compliance violations. Ensuring that only essential fields are logged supports data privacy regulations like GDPR and CCPA, and protects against security threats like unauthorized access or insider threats.
  description: This rule checks if the access logs for OCI Analytics instances are configured to restrict fields that can potentially expose sensitive information. Administrators should verify that logging settings exclude fields unnecessary for monitoring purposes, such as user credentials or personal data. Remediation involves reviewing and updating log configurations in the OCI console to ensure compliance with relevant data protection policies. It is also advisable to regularly audit and monitor these configurations to maintain security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analytics_logging.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/ias_logging_security.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
- rule_id: oci.analytics.analytics_instance.api_security_monitoring_access_log_sink_configured_restricted
  service: analytics
  resource: analytics_instance
  requirement: API Security Monitoring Access Log Sink Configured Restricted
  scope: analytics.analytics_instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Restrict API Security Monitoring Access Log Sink in OCI Analytics
  rationale: Configuring and restricting API security monitoring access logs in OCI Analytics is crucial for maintaining the integrity and confidentiality of security data. Unrestricted access to these logs can lead to potential data breaches, unauthorized access, and compliance violations with standards such as PCI-DSS and GDPR, which mandate strict controls over access to sensitive data. Proper configuration ensures that only authorized personnel can access and manage log data, reducing the risk of insider threats and enhancing overall cloud security posture.
  description: This rule checks whether the access log sink for API security monitoring in Oracle Cloud Infrastructure (OCI) Analytics is configured with restricted access. Specifically, it verifies that the log sink has appropriate access control policies applied, ensuring that only designated users or groups have permissions to view or manage the logs. To verify, check the IAM policies associated with the log sink in the OCI console, and ensure they align with the principle of least privilege. Remediation involves updating the IAM policies to restrict access to the required users or groups only.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/cloud/cloud-security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.analytics.analytics_instance.api_security_monitoring_access_logging_enabled
  service: analytics
  resource: analytics_instance
  requirement: API Security Monitoring Access Logging Enabled
  scope: analytics.analytics_instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Access Logging for OCI Analytics API Security Monitoring
  rationale: Enabling access logging for API security monitoring in OCI Analytics is crucial for identifying unauthorized access attempts, suspicious activities, and potential data breaches. This enhances visibility into API interactions, helping organizations mitigate risks and meet compliance mandates such as PCI-DSS and SOC2. Failing to monitor API access can lead to undetected security incidents and non-compliance with regulatory frameworks.
  description: This rule verifies that API security monitoring access logging is enabled for OCI Analytics instances. To comply, ensure that logging is configured to capture and store API access logs within the OCI Logging service. Administrators can verify this configuration through the OCI Console by navigating to the Analytics service, selecting the instance, and checking the logging settings. If not configured, enable logging by setting up a log group and enabling the Analytics service logs. This ensures all API access requests are logged for auditing and monitoring purposes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Tasks/analyticslogging.htm
  - https://docs.cisecurity.org/benchmarks/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/soc.html
  - https://www.nist.gov/cyberframework
  - https://www.isaca.org/resources/cobit
- rule_id: oci.analytics.analytics_instance.api_security_monitoring_execution_logging_level_enabled
  service: analytics
  resource: analytics_instance
  requirement: API Security Monitoring Execution Logging Level Enabled
  scope: analytics.analytics_instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Execution Logging Level for OCI Analytics API Security Monitoring
  rationale: Enabling API security monitoring execution logging level is crucial for identifying and mitigating potential threats within the OCI Analytics service. It helps in tracing unauthorized access attempts, data exfiltration activities, and ensures compliance with security policies and regulations such as PCI DSS and GDPR. This logging capability enhances visibility into API operations, allowing for timely detection and response to security incidents.
  description: This rule checks whether the execution logging level for API security monitoring is enabled in OCI Analytics instances. It ensures that detailed logs are generated for all API operations, which can be verified by accessing the logging configuration in the OCI Console under Analytics Instance settings. To remediate, navigate to the Logging section of your Analytics service and set the execution logging level to 'INFO' or higher. This enables comprehensive tracking of API calls and aids in forensic analysis and incident response.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Tasks/analyticslogging.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/compliance/
- rule_id: oci.analytics.analytics_instance.api_security_monitoring_logs_retention_days_minimum_enabled
  service: analytics
  resource: analytics_instance
  requirement: API Security Monitoring Logs Retention Days Minimum Enabled
  scope: analytics.analytics_instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure API Security Monitoring Logs Retention for Analytics Instances
  rationale: Proper retention of API security monitoring logs in Oracle Cloud Infrastructure is crucial for forensic investigations and compliance with regulatory standards such as PCI-DSS and ISO 27001. Insufficient retention periods may lead to loss of critical security data, hindering incident response efforts and increasing the risk of undetected malicious activities.
  description: This rule checks whether the minimum retention days for API security monitoring logs are configured for analytics instances in OCI. The recommended setting is to retain logs for at least 90 days to ensure adequate data availability for security analysis and compliance audits. To verify and configure log retention, navigate to the Analytics service in the OCI Console, select the appropriate instance, and adjust the logging configuration to meet the minimum retention requirement. Ensure that logging is enabled and retention periods are set according to organizational policy and regulatory needs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticslogging.htm
  - https://www.oracle.com/security/cis-benchmarks/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm
- rule_id: oci.monitoring.alarm.store_access_rbac_least_privilege_required
  service: monitoring
  resource: alarm
  requirement: Store Access RBAC Least Privilege Required
  scope: monitoring.alarm.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for OCI Monitoring Alarm Access
  rationale: Implementing least privilege access for OCI Monitoring Alarms minimizes the risk of unauthorized access and potential breach of sensitive monitoring data. This reduces the attack surface and enhances overall security posture, aligning with compliance requirements such as NIST SP 800-53 and ISO 27001, which emphasize least privilege principles.
  description: This rule verifies that all roles and policies granting access to OCI Monitoring Alarms adhere to the principle of least privilege. It checks for overly permissive policies that allow unauthorized actions on alarm resources. To remediate, review and refine IAM policies to ensure that only necessary permissions are granted. Use Oracle's Identity and Access Management (IAM) service to define and enforce fine-grained access controls.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.nist.gov/publications/sp-800-53-revision-5
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.monitoring.alarm.store_encryption_cmek_enabled
  service: monitoring
  resource: alarm
  requirement: Store Encryption Cmek Enabled
  scope: monitoring.alarm.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure CMEK is Enabled for OCI Alarm Data Encryption
  rationale: Enabling Customer-Managed Encryption Keys (CMEK) for storing monitoring alarm data protects sensitive information by ensuring that data at rest is encrypted with keys that you control. This reduces the risk of unauthorized access and data breaches, thereby aligning with compliance requirements like GDPR and CCPA, which mandate stringent data protection measures.
  description: This rule checks that all monitoring alarm data within Oracle Cloud Infrastructure is encrypted using Customer-Managed Encryption Keys (CMEK) rather than Oracle-managed keys. CMEK provides enhanced data security by allowing enterprises to manage their own encryption keys, offering greater control and transparency over who can access sensitive data. To verify, ensure that the 'Encryption Key' setting for your alarms is configured to use your own key vault. For remediation, navigate to the OCI Monitoring Service, select the relevant alarm, and configure it to use a key from Oracle Cloud Infrastructure Vault.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - CIS OCI Foundations Benchmark
  - 'NIST SP 800-57 Part 1: Recommendation for Key Management'
  - https://www.oracle.com/security/cloud-security/key-management/
- rule_id: oci.monitoring.alarm.store_immutability_or_object_lock_where_supported_enabled
  service: monitoring
  resource: alarm
  requirement: Store Immutability Or Object Lock Where Supported Enabled
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Immutability or Object Lock for Monitoring Alarms
  rationale: Enabling immutability or object lock for monitoring alarms ensures that alert configurations cannot be tampered with, providing integrity and reliability in alert management. This is crucial for preventing unauthorized changes that could lead to missed critical alerts, potentially resulting in unmonitored security incidents or outages. It aligns with compliance frameworks requiring reliable logging and monitoring, such as PCI-DSS and ISO 27001, which mandate the integrity of security alerting systems.
  description: This rule checks if immutability or object lock features are enabled for OCI monitoring alarms. To verify, review the alarm configuration settings in the OCI console and ensure that immutability settings are activated where supported. Remediation involves enabling object lock settings for critical alarms to prevent unauthorized modifications and ensure alert reliability. Consult the OCI documentation for detailed steps on enabling these features in your environment.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.monitoring.alarm.store_retention_days_minimum_enabled
  service: monitoring
  resource: alarm
  requirement: Store Retention Days Minimum Enabled
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Minimum Retention Days for OCI Monitoring Alarms
  rationale: Setting a minimum retention period for OCI monitoring alarms is crucial for maintaining an adequate historical record of alert conditions, which aids in forensic investigations, compliance audits, and trend analysis. Without proper retention, critical alarm data may be lost, increasing the risk of undetected anomalies and non-compliance with regulatory standards that require data retention.
  description: This rule checks that a minimum retention period is enabled for alarms in OCI Monitoring. Alarms should be configured to store logs for a period that complies with organizational policies and regulatory requirements. To verify, ensure that the retention settings for alarm logs are set according to your compliance needs. Remediation involves configuring the alarm retention policy through the OCI console, ensuring that alarm data is retained for the appropriate duration.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.oracle.com/security/standards/cis-benchmarks/
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.monitoring.alarm.destination_endpoint_private_networking_enforced
  service: monitoring
  resource: alarm
  requirement: Destination Endpoint Private Networking Enforced
  scope: monitoring.alarm.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Private Networking for Alarm Destinations
  rationale: Enforcing private networking for alarm destinations minimizes exposure to public networks, reducing the risk of data breaches and unauthorized access. It supports compliance with frameworks like NIST and ISO 27001 by ensuring that sensitive monitoring data is transmitted securely within the trusted network environment.
  description: This rule checks that all OCI Monitoring alarms are configured to use endpoints within a private network, ensuring that alerts are not sent over public internet. To verify, review the alarm configurations and ensure they are set to communicate only with destinations that have private IP addresses. Remediation involves updating alarm configurations to specify private IPs or VCN endpoints for endpoint destinations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/alarmcreate.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.monitoring.alarm.destination_iam_policy_least_privilege_required
  service: monitoring
  resource: alarm
  requirement: Destination IAM Policy Least Privilege Required
  scope: monitoring.alarm.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Alarm Destination IAM Policies Follow Least Privilege
  rationale: Implementing least privilege access for alarm destinations in OCI ensures that only authorized users can manage alarm resources, reducing the risk of unauthorized access and potential data breaches. This is crucial for protecting sensitive monitoring data and maintaining compliance with regulatory standards such as PCI-DSS and ISO 27001, which mandate strict access controls.
  description: This rule verifies that IAM policies for OCI Monitoring alarm destinations are configured with the least privilege principle. It checks whether the policies grant only the necessary permissions to users or groups to manage alarm resources. To remediate, review and adjust the IAM policies to ensure that they provide only the required permissions for the intended operations. Regularly audit these policies to maintain compliance and adapt to changes in access requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.monitoring.alarm.destination_tls_min_1_2_enforced
  service: monitoring
  resource: alarm
  requirement: Destination TLS Min 1 2 Enforced
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure TLS 1.2+ Enforced for OCI Monitoring Alarm Destinations
  rationale: Enforcing a minimum of TLS 1.2 for alarm destinations in OCI Monitoring mitigates risks associated with older, vulnerable encryption protocols. This ensures confidentiality and integrity of data in transit, reducing the likelihood of man-in-the-middle attacks and data breaches. Adhering to this standard also aligns with compliance requirements such as PCI-DSS and SOC2, which mandate secure communications.
  description: This rule checks whether the alarm destinations in OCI Monitoring enforce a minimum TLS version of 1.2 for secure communication. To verify, review the settings of alarm destinations to ensure they specify TLS 1.2 or higher. Remediation involves configuring the alarm destination to require at least TLS 1.2, which can typically be done through the OCI Console or API by updating the alarm's notification settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/publications/security-requirements-cryptographic-modules
  - https://cloud.oracle.com/en_US/cybersecurity
  - https://www.oracle.com/security/cloud-security/tls/
- rule_id: oci.monitoring.alarm.stream_encryption_enabled
  service: monitoring
  resource: alarm
  requirement: Stream Encryption Enabled
  scope: monitoring.alarm.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Stream Encryption is Enabled for OCI Monitoring Alarms
  rationale: Enabling stream encryption for OCI Monitoring Alarms protects sensitive alarm data from unauthorized access and tampering, which is crucial for maintaining data integrity and confidentiality. This helps mitigate risks related to data breaches and unauthorized disclosures, and is often required to comply with regulatory standards such as PCI-DSS and HIPAA, which mandate encryption of sensitive data.
  description: This rule checks whether stream encryption is enabled for OCI Monitoring Alarms. By ensuring encryption at rest, alarm data stored within OCI is safeguarded against unauthorized access. To verify, navigate to the OCI Monitoring service, locate the relevant alarm, and confirm that encryption is enabled in the alarm settings. Remediation involves enabling encryption through the OCI Console or CLI, ensuring that the encryption keys are appropriately managed within Oracle Key Management.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/index.html
  - https://www.oracle.com/security/cloud-security/key-management/
- rule_id: oci.monitoring.alarm.stream_ingestion_auth_required
  service: monitoring
  resource: alarm
  requirement: Stream Ingestion Auth Required
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Stream Ingestion Auth for Monitoring Alarms
  rationale: Requiring authentication for stream ingestion when setting up monitoring alarms is crucial to prevent unauthorized data access and manipulation. It mitigates the risk of data breaches and ensures that only authorized users can trigger alarms, maintaining the integrity of monitoring systems. This aligns with compliance requirements for data protection and access control, reducing the risk of non-compliance with frameworks like ISO 27001 and PCI-DSS.
  description: This rule verifies that all monitoring alarms configured to ingest data from streams require authentication. To ensure compliance, check that the appropriate IAM policies are in place and that authentication mechanisms are enabled for all stream ingestion processes related to alarms. Remediation involves reviewing IAM policies to include authentication requirements and enabling necessary security features within the OCI Monitoring service.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.monitoring.alarm.stream_retention_days_minimum_enabled
  service: monitoring
  resource: alarm
  requirement: Stream Retention Days Minimum Enabled
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Minimum Stream Retention Days for OCI Alarms
  rationale: Setting a minimum stream retention period for monitoring alarms ensures that log data is available for sufficient time to analyze security incidents, meet compliance requirements, and support forensic investigations. It helps prevent data loss that can occur due to premature deletion, which could lead to undetected breaches and non-compliance with regulatory frameworks like PCI-DSS and ISO 27001.
  description: This rule checks if a minimum retention period is configured for the stream data associated with OCI monitoring alarms. It verifies that the retention period is sufficient to meet both operational and compliance requirements. To remediate, configure the monitoring alarm stream settings in OCI to retain data for at least the minimum required days using the OCI Console or API. Regularly review and adjust retention settings based on your organization's security policies and compliance needs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.oracle.com/security-cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.streaming.stream.streaming_security_video_encryption_enabled
  service: streaming
  resource: stream
  requirement: Streaming Security Video Encryption Enabled
  scope: streaming.stream.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Stream Video Encryption is Enabled
  rationale: Encrypting streaming video data protects it from unauthorized access and ensures compliance with data protection regulations such as GDPR and CCPA. Unencrypted streams may lead to data breaches, exposing sensitive content and causing reputational damage and financial loss to the organization.
  description: This rule checks whether video streams are encrypted at rest in Oracle Cloud Infrastructure's Streaming service. Encryption at rest is achieved by using OCI's Key Management Service to manage encryption keys. To verify, ensure that encryption is enabled in the stream settings. Remediation involves configuring the stream to use customer-managed keys (CMK) for encryption to enhance security and control over data.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Tasks/streamingencryption.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
- rule_id: oci.streaming.stream.streaming_security_video_tls_required
  service: streaming
  resource: stream
  requirement: Streaming Security Video TLS Required
  scope: streaming.stream.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure TLS is Required for Streaming Video Security
  rationale: Requiring TLS for streaming video ensures the confidentiality and integrity of video data in transit, protecting it from interception and tampering. This is critical for maintaining trust and compliance with data protection regulations such as GDPR and CCPA, particularly for sensitive video content. Failure to encrypt streaming data may lead to unauthorized access, data breaches, and significant financial and reputational damage.
  description: This rule verifies that all video streams in Oracle Cloud Infrastructure's Streaming service are configured to require TLS encryption. It checks for TLS settings in stream configurations to ensure data is encrypted during transmission. To verify, inspect your stream settings in the OCI Console or via the CLI, ensuring that TLS is enabled for all streams. Remediation involves enabling TLS in the stream's configuration settings to enforce encrypted connections, which can be done through the OCI Console or API.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Tasks/streamingoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/privacy-framework
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.streaming.stream.streaming_security_video_retention_days_minimum_configured
  service: streaming
  resource: stream
  requirement: Streaming Security Video Retention Days Minimum Configured
  scope: streaming.stream.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Minimum Video Retention for OCI Streaming Security
  rationale: Configuring a minimum retention period for streaming security video data is crucial for maintaining audit trails and forensic analysis capabilities. Non-compliance can lead to insufficient data for investigating security incidents, potentially resulting in regulatory fines and loss of trust. Ensuring adequate retention supports compliance with standards like PCI-DSS and ISO 27001, which mandate secure storage of data logs.
  description: This rule checks whether a minimum retention period is configured for security video streams in OCI Streaming. The retention period determines how long the data is stored before automatic deletion. To verify, inspect the Stream's settings for the 'Retention Period' and ensure it meets or exceeds the organization's policy. Adjust the retention period through the OCI Console or API to align with compliance requirements, ensuring logs are available for the necessary duration.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Concepts/streamingoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Tasks/managingstreams.htm
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.monitoring.alarm.api_security_monitoring_access_log_fields_restricted
  service: monitoring
  resource: alarm
  requirement: API Security Monitoring Access Log Fields Restricted
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Restrict Access Log Fields in OCI Monitoring Alarms
  rationale: Restricting access log fields is crucial to prevent sensitive information exposure, such as API keys or user credentials, which could lead to unauthorized access and data breaches. Ensuring that only necessary fields are logged helps mitigate the risk of insider threats and comply with privacy regulations and standards such as GDPR and PCI-DSS.
  description: This rule checks for configurations in OCI Monitoring Alarms to ensure that unnecessary fields in API security monitoring access logs are restricted. Specifically, it verifies that sensitive fields are not logged in plaintext, which could be exploited by malicious actors. To remediate, review and update alarm configuration settings to exclude sensitive information from logs, utilizing OCI's logging policies and audit features.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/creating_alarms.htm
  - https://www.oracle.com/security/cloud-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.monitoring.alarm.api_security_monitoring_access_log_sink_configured_restricted
  service: monitoring
  resource: alarm
  requirement: API Security Monitoring Access Log Sink Configured Restricted
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Restrict API Access Log Sinks for OCI Monitoring Alarms
  rationale: Restricting access to API security monitoring access logs is crucial to prevent unauthorized data exposure and potential misuse of sensitive information. Unrestricted access can lead to data breaches, compliance violations, and can be exploited by attackers to identify security weaknesses. Ensuring proper configuration aligns with regulatory requirements such as PCI-DSS and ISO 27001.
  description: This rule checks if the API Security Monitoring Access Log Sink for OCI monitoring alarms is configured with restricted access. Ensure that only authorized users or services have access to these log sinks to prevent unauthorized access. Verify the configuration by reviewing the IAM policies and access controls associated with the log sink. Remediation involves adjusting IAM policies to limit access to specific users or groups that require it for operational purposes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.pcisecuritystandards.org/document_library
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.monitoring.alarm.api_security_monitoring_access_logging_enabled
  service: monitoring
  resource: alarm
  requirement: API Security Monitoring Access Logging Enabled
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Access Logging for OCI Monitoring Alarms
  rationale: Enabling access logging for OCI Monitoring Alarms is crucial for maintaining visibility into potential unauthorized access attempts and misconfigurations. It helps identify anomalies and supports forensic investigations by providing a trail of interactions with monitoring resources. This is vital for meeting compliance requirements related to data protection and monitoring integrity, such as those outlined in frameworks like PCI-DSS and NIST.
  description: This rule checks whether access logging is enabled for OCI Monitoring Alarms. Access logging should be configured to capture all API requests made to the monitoring service, which can be done by enabling logging within the Oracle Cloud Infrastructure Logging service. To verify, ensure that logs are being generated and stored in a specified location in your OCI tenancy. Remediation involves setting up an OCI Logging service log group and enabling log collection for monitoring alarms, ensuring proper retention policies are applied.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- rule_id: oci.monitoring.alarm.api_security_monitoring_execution_logging_level_enabled
  service: monitoring
  resource: alarm
  requirement: API Security Monitoring Execution Logging Level Enabled
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Detailed Logging for API Security Monitoring in Alarms
  rationale: Enabling execution logging for API Security Monitoring in OCI alarms is critical for tracking access and usage patterns, detecting anomalies, and responding to potential security incidents. It helps in identifying unauthorized access, ensuring compliance with industry standards such as NIST and PCI-DSS, and enhancing the overall security posture of cloud resources.
  description: This rule checks if the execution logging level for API Security Monitoring is enabled for OCI alarms within the monitoring service. It ensures detailed log collection, which is essential for auditing and forensic analysis. To verify, check that the 'Execution Logging Level' is set to 'INFO' or 'DEBUG' within the alarm's configuration. Remediate by updating the logging configuration in the OCI console or via CLI to ensure appropriate logging levels are enabled.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/monitoringoverview.htm#alarm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/secure-logging.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.monitoring.alarm.api_security_monitoring_logs_retention_days_minimum_enabled
  service: monitoring
  resource: alarm
  requirement: API Security Monitoring Logs Retention Days Minimum Enabled
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Minimum Retention for API Security Monitoring Logs
  rationale: Maintaining a minimum retention period for API security monitoring logs is crucial for effective incident investigation, compliance auditing, and detecting suspicious activities. Insufficient log retention can lead to gaps in security analysis and hinder regulatory compliance with standards such as PCI-DSS and SOC2, which mandate specific log retention periods.
  description: This rule verifies that API security monitoring logs have a configured minimum retention period within OCI. To check, navigate to the OCI console, access the Monitoring service, and ensure alarms for API logs are configured with the specified retention days. If not compliant, update the retention settings in the Logging service to meet or exceed the minimum required period. This ensures logs are available for audits and forensic analysis.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://www.pcisecuritystandards.org/document_library
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/sorhome.html
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.monitoring.alarm.monitoring_alert_destinations_enabled
  service: monitoring
  resource: alarm
  requirement: Monitoring Alert Destinations Enabled
  scope: monitoring.alarm.monitoring
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Monitoring Alert Destinations are Configured
  rationale: Enabling alert destinations for monitoring alarms in OCI is crucial for timely incident response and operational awareness. Without proper alert destinations, critical alarms may go unnoticed, leading to potential security incidents or compliance violations due to unmonitored infrastructure. This configuration helps meet regulatory requirements by ensuring that monitoring data is actively reviewed and acted upon.
  description: This rule checks if alert destinations are configured for monitoring alarms in Oracle Cloud Infrastructure (OCI). Alarms should have at least one notification destination set, such as an Email or an Oracle Cloud Notification Service (ONS) topic, to ensure monitoring alerts are communicated to the appropriate personnel. To verify, navigate to the OCI console, select 'Monitoring', then 'Alarms', and ensure each alarm has a notification destination configured. Remediation involves setting up a new Email or ONS topic and configuring alarms to use these destinations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/monitoringalarms.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/cloud/security/compliance/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.monitoring.alarm.monitoring_alerts_for_backup_failures_enabled
  service: monitoring
  resource: alarm
  requirement: Monitoring Alerts For Backup Failures Enabled
  scope: monitoring.alarm.monitoring
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Monitoring Alerts for OCI Backup Failures
  rationale: Monitoring backup failures is critical to ensure data integrity and availability. Backup failures can result in data loss and operational downtime, adversely affecting business continuity and compliance with data protection regulations such as PCI-DSS and HIPAA. Timely alerts allow prompt response to issues, reducing the risk of prolonged exposure to data unavailability or loss.
  description: This rule checks if alarms are configured in OCI Monitoring to alert administrators of backup failures. Ensure that alarms are set up to notify relevant personnel through email or other communication channels when a backup operation fails. To verify, check the OCI Monitoring service for alarms that target backup operations and review their status and notification settings. Remediation involves creating or updating alarms to cover backup failures, ensuring notifications are properly configured.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
- rule_id: oci.monitoring.alarm.monitoring_alerts_for_replication_lag_enabled
  service: monitoring
  resource: alarm
  requirement: Monitoring Alerts For Replication Lag Enabled
  scope: monitoring.alarm.monitoring
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Monitoring Alerts for Replication Lag in OCI
  rationale: Monitoring replication lag is crucial for ensuring data consistency and availability in distributed systems. Excessive lag can lead to stale data, impacting business decisions and potentially violating SLAs. Proactively alerting on replication delays helps mitigate risks of data loss and supports compliance with standards requiring data integrity.
  description: This rule verifies that alarms are configured to monitor replication lag in Oracle Cloud Infrastructure. Ensuring alerts are enabled allows timely detection and response to replication delays. To verify, check that alarms are set up in the OCI Monitoring service with appropriate thresholds for replication metrics. Remediate by creating or updating alarms to trigger notifications when lag exceeds acceptable limits.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/document/nist-sp-800-53-rev-5-security-and-privacy-controls-information-systems-and-organizations
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/databasesetting.htm
- rule_id: oci.monitoring.alarm.monitoring_alerts_for_rpo_rto_breach_enabled
  service: monitoring
  resource: alarm
  requirement: Monitoring Alerts For Rpo Rto Breach Enabled
  scope: monitoring.alarm.monitoring
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Monitoring Alerts for RTO/RPO Breach
  rationale: Ensuring that monitoring alerts for Recovery Time Objective (RTO) and Recovery Point Objective (RPO) breaches are enabled is crucial for maintaining business continuity and minimizing downtime. This proactive monitoring helps identify potential breaches in disaster recovery objectives, allowing organizations to mitigate risks and comply with industry standards such as ISO 27001 and NIST SP 800-34. Failure to monitor these metrics can lead to significant operational disruptions and financial losses.
  description: This rule checks if alarms are configured in OCI Monitoring to alert on potential breaches of RTO and RPO. Specifically, it verifies that alarms are set to trigger notifications when metrics related to backup and recovery timelines exceed predefined thresholds. To remediate, create or modify alarms in the OCI Monitoring service to include conditions for RTO and RPO breaches. Ensure these alarms are properly configured to notify relevant stakeholders via OCI Notifications.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-34r1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Notification/Concepts/notificationoverview.htm
- rule_id: oci.monitoring.alarm.alert_alarm_actions_enabled
  service: monitoring
  resource: alarm
  requirement: Alert Alarm Actions Enabled
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Alert Actions for OCI Monitoring Alarms
  rationale: Enabling alert actions for monitoring alarms is crucial for timely incident response and operational awareness. Without enabled alerts, critical changes or disruptions may go unnoticed, leading to potential security breaches or compliance violations. Timely notifications help in meeting regulatory requirements such as PCI-DSS and ISO 27001, which mandate monitoring and response capabilities.
  description: This rule checks whether alert actions are enabled for alarms in OCI monitoring. Specifically, it verifies that alarms have configured actions to notify administrators or trigger automated responses when thresholds are breached. To ensure compliance, configure alarm actions by setting appropriate notification endpoints such as email or PagerDuty. This is done through the OCI console under the Monitoring service by editing the alarm settings. Regularly review and update contact details and notification rules to ensure they are accurate.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-foundations-benchmarks/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
- rule_id: oci.monitoring.alarm.alert_critical_alarms_enabled
  service: monitoring
  resource: alarm
  requirement: Alert Critical Alarms Enabled
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Critical Alarms Are Enabled for OCI Monitoring
  rationale: Enabling critical alarms in OCI monitoring is crucial for promptly detecting and responding to potential security incidents or operational issues. Failure to enable such alarms can lead to delayed responses to critical events, increasing the risk of data breaches, service outages, and non-compliance with regulations such as PCI-DSS and ISO 27001. Proactive alerting helps in maintaining system integrity and protecting sensitive data.
  description: This rule checks whether critical alarms are enabled in the OCI Monitoring service, ensuring that important metrics and events trigger alerts. Users should configure alarms to monitor key performance indicators and security events, setting thresholds that align with their operational requirements. Verification involves reviewing the OCI console for active critical alarms and ensuring they are configured to notify relevant personnel through appropriate channels. Remediation steps include setting up or modifying alarms to cover critical metrics and ensuring notification settings are correctly configured.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.cisecurity.org/benchmark/oracle
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/cloud-security.html
- rule_id: oci.monitoring.alarm.alert_destinations_authenticated_enabled
  service: monitoring
  resource: alarm
  requirement: Alert Destinations Authenticated Enabled
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Alarm Alert Destinations Require Authentication
  rationale: Authenticated alert destinations in OCI monitoring ensure that only authorized systems can receive and process alarm notifications, reducing the risk of data interception or unauthorized access. This is crucial for maintaining the integrity and confidentiality of operational alerts, which could otherwise be exploited by malicious actors to disrupt business operations or gain insights into system vulnerabilities. Complying with regulatory standards such as PCI-DSS and ISO 27001, which mandate secure communication channels, enhances trust and reduces potential compliance penalties.
  description: This rule checks whether alert destinations for OCI alarms are configured with authentication enabled, ensuring that alerts are sent securely to authorized destinations. To verify, review the configuration of each alarm in the OCI Console to ensure that the alert destinations, such as email or HTTPS endpoints, require authentication. Remediation involves updating the alarm configurations to use secure, authenticated channels, leveraging Oracle's Identity and Access Management (IAM) for managing access controls effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm#Managing_Alarms
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.monitoring.alarm.monitoring_admin_activity_logging_enabled
  service: monitoring
  resource: alarm
  requirement: Monitoring Admin Activity Logging Enabled
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: critical
  title: Enable Admin Activity Logging for Alarms in OCI Monitoring
  rationale: Monitoring admin activity logging is crucial for detecting unauthorized changes, ensuring accountability, and meeting compliance requirements such as PCI-DSS and SOC2. Without logging, security teams may be unaware of unauthorized access or modifications to critical monitoring configurations, potentially leading to undetected vulnerabilities or compliance violations.
  description: This rule checks if logging is enabled for administrative activities related to OCI Monitoring alarms. Specifically, it verifies whether all create, update, and delete operations on alarms are logged in the OCI Audit service. To ensure compliance, administrators should enable logging by configuring audit policies in the OCI console, ensuring that logs are retained and reviewed regularly. Remediation involves setting up appropriate audit policies that capture all changes to the alarm configurations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoring_overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - 'NIST SP 800-53 Rev. 5 AU-2: Audit Events'
  - 'PCI DSS Requirement 10: Track and monitor all access to network resources and cardholder data'
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practice.htm
- rule_id: oci.monitoring.alarm.monitoring_logs_retention_days_minimum_enabled
  service: monitoring
  resource: alarm
  requirement: Monitoring Logs Retention Days Minimum Enabled
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Monitoring Logs Retention is Configured Correctly
  rationale: Properly configuring log retention ensures that critical security and operational data is available for audit and forensic investigations. Inadequate retention periods may lead to loss of vital logs, affecting incident response and compliance with regulations such as PCI-DSS and ISO 27001. Long-term log retention supports thorough analysis and helps detect anomalies or breaches over time.
  description: This rule checks if the retention period for monitoring logs is set to a minimum of 30 days, ensuring compliance with security best practices. To verify, navigate to the OCI Console, go to the Monitoring service, and check the Log Group settings for alarms. Ensure the 'Retention Period' is configured to at least 30 days. Remediation involves adjusting the retention period setting within the Log Group configuration to meet the minimum requirement.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.monitoring.alarm.monitoring_query_access_logging_enabled
  service: monitoring
  resource: alarm
  requirement: Monitoring Query Access Logging Enabled
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Monitoring Query Access Logging for Alarms
  rationale: Enabling query access logging for monitoring alarms is crucial for tracking access and changes to monitoring queries, which can help identify unauthorized access patterns and anomalous activities. This is essential for protecting sensitive monitoring data and ensuring accountability, which is particularly important for meeting regulatory compliance requirements such as PCI-DSS and SOC2.
  description: This rule checks if access logging is enabled for monitoring queries associated with alarms in OCI. To verify, ensure that logging is configured for monitoring service queries through the OCI Logging service. Remediation involves enabling access logging for all monitoring queries by configuring a log group and associating it with the necessary monitoring resources. This helps maintain a comprehensive audit trail of query activities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.oracle.com/cloud-native/cloud-native-security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/socforserviceorganizations.html
- rule_id: oci.monitoring.metric.metric_filter_console_root_login_detected_enabled
  service: monitoring
  resource: metric
  requirement: Metric Filter Console Root Login Detected Enabled
  scope: monitoring.metric.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: critical
  title: Enable Metric Filter for Root Login Detection
  rationale: Monitoring for console root login attempts is critical as it helps detect potential unauthorized access to the Oracle Cloud Infrastructure. Root logins can be indicative of a security breach, and immediate detection is essential for initiating incident response measures. Ensuring this monitoring is enabled supports compliance with security standards such as NIST and ISO 27001, which require monitoring and logging of access to critical systems.
  description: This rule checks if a metric filter is enabled to detect root login attempts to the OCI console. Ensuring the metric filter is active involves configuring Oracle Cloud Monitoring to track and alert on any occurrences of root console logins. This can be verified by accessing the OCI Console, navigating to Monitoring, and ensuring that a metric filter for root login events is defined and enabled. To remediate, set up a metric filter in the Monitoring service that captures the `RootLogin` event and configure notifications to alert security personnel immediately.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm#CIS
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/ocisecuritybestpractices.htm#security_best_practices
- rule_id: oci.monitoring.metric.metric_filter_iam_policy_change_detected_present_enforced
  service: monitoring
  resource: metric
  requirement: Metric Filter IAM Policy Change Detected Present Enforced
  scope: monitoring.metric.policy_management
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Monitor IAM Policy Changes Through Metric Filters
  rationale: Monitoring changes to IAM policies is crucial as unauthorized modifications can lead to privilege escalation, data breaches, and compliance violations. Detecting and responding to these changes swiftly helps maintain the principle of least privilege, ensuring that only authorized users have the necessary access, thereby reducing the risk of insider threats and external attacks.
  description: This rule checks for the presence and enforcement of metric filters that detect IAM policy changes. It ensures that logging is configured to capture any modifications to IAM policies, which can then be used for real-time alerts and audits. To verify, ensure that the OCI Monitoring service is configured with metric filters that track IAM policy changes, and integrate with OCI Events for automated responses. Remediation involves setting up appropriate metric filters and creating rules to alert on detected changes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/cis-oci-security-checklist.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security-best-practices/
- rule_id: oci.monitoring.metric.metric_filter_cmk_deletion_or_disable_detected_enabled
  service: monitoring
  resource: metric
  requirement: Metric Filter CMK Deletion Or Disable Detected Enabled
  scope: monitoring.metric.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Detect and Alert on CMK Status Changes in Monitoring Metrics
  rationale: Monitoring changes in the status of Customer Master Keys (CMKs) is crucial as it can prevent unauthorized access and potential data breaches. Disabling or deleting a CMK can disrupt access to encrypted data, impacting business operations and compliance with data protection standards. Timely detection and alerts help mitigate risks associated with unauthorized key management activities.
  description: This rule checks for the presence of metric filters that detect changes in the status of CMKs, such as deletion or disabling, within OCI Monitoring. It ensures that alerts are configured to notify administrators of such critical changes. To verify, ensure metric filters are in place and configured to send alerts when a CMK status change is detected. Remediate by setting up alerts in OCI Monitoring for key lifecycle events and reviewing the configuration regularly to comply with security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/monitoringoverview.htm
  - https://www.oracle.com/security-cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.monitoring.metric.metric_filter_network_acl_or_sg_enabled
  service: monitoring
  resource: metric
  requirement: Metric Filter Network ACL Or Sg Enabled
  scope: monitoring.metric.network_security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Network ACL or Security Group Filtering for Metrics
  rationale: Ensuring that network ACLs or security groups are enabled for OCI Monitoring metrics is crucial to prevent unauthorized access and data exfiltration. This configuration helps isolate monitoring data, reducing the risk of exposure to attackers who might exploit open access to gather sensitive operational insights. Compliance with industry standards like PCI-DSS and SOC2 often requires strict controls over data access, making this a critical component of a secure cloud environment.
  description: This rule checks if network ACLs or security groups are applied to OCI Monitoring metrics to control access and secure data. It verifies configurations that restrict traffic to only trusted sources, preventing unauthorized access to monitoring information. To remediate, ensure that all monitoring endpoints have proper network security configurations, such as specifying allowed IP ranges in ACLs or using security groups to define traffic rules. Regular audits and updates to these configurations should be conducted to maintain compliance and security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm#network
  - https://www.oracle.com/cloud/security/compliance/pci-dss/
  - https://www.oracle.com/cloud/security/compliance/soc2/
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networksecuritygroups.htm
- rule_id: oci.network_firewall.network_firewall.firewall_logging_enabled
  service: network_firewall
  resource: network_firewall
  requirement: Firewall Logging Enabled
  scope: network_firewall.network_firewall.logging
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Enable Logging for OCI Network Firewalls
  rationale: Enabling logging for network firewalls in OCI is crucial for monitoring and analyzing traffic patterns. Without logging, suspicious activities or unauthorized access attempts may go unnoticed, leading to potential breaches and compliance violations. Logs are essential for incident response, forensic analysis, and meeting regulatory requirements such as PCI-DSS and SOC2.
  description: This rule checks if logging is enabled for Oracle Cloud Infrastructure network firewalls to ensure all traffic data is recorded. To verify, navigate to the OCI Console, select the network firewall resource, and check the logging configuration under 'Firewall Settings'. If logging is disabled, enable it by configuring the log destination and retention settings. It is recommended to periodically review logs for any abnormal activities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networkfirewall.htm#log
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security-cloud-compliance/
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.network_firewall.network_firewall.firewall_no_permit_any
  service: network_firewall
  resource: network_firewall
  requirement: Firewall No Permit Any
  scope: network_firewall.network_firewall.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Restrict Any-to-Any Rules in OCI Network Firewall
  rationale: Allowing 'any-to-any' traffic rules in network firewalls poses significant security risks, as it can lead to unauthorized access and data breaches. Such configurations expose the network to potential attacks and may violate compliance requirements for data protection standards like PCI-DSS and ISO 27001. Restricting these rules mitigates the attack surface and helps maintain secure and compliant network environments.
  description: This rule checks for the presence of 'permit any' traffic rules within OCI network firewalls, which should be avoided to maintain a secure posture. Network firewalls should be configured with specific source and destination IP addresses, ports, and protocols to enforce least privilege access. Review and modify firewall rules to remove any overly permissive configurations. Use OCI's network security best practices to define precise rules that reflect legitimate traffic patterns.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networkfirewalls.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.0.0.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/guidance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.network_firewall.network_firewall.firewall_rule_groups_attached
  service: network_firewall
  resource: network_firewall
  requirement: Firewall Rule Groups Attached
  scope: network_firewall.network_firewall.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Firewall Rule Groups are Attached to Network Firewalls
  rationale: Attaching firewall rule groups to network firewalls is crucial for enforcing security policies and preventing unauthorized access. Without these attachments, your network may be vulnerable to security breaches, leading to potential data loss, operational disruptions, and non-compliance with standards such as PCI-DSS and HIPAA.
  description: This rule checks that each network firewall in Oracle Cloud Infrastructure has associated firewall rule groups, which define the traffic filtering policies. Verify that rule groups are attached by navigating to the Network Firewall service in the OCI Console and ensuring that each firewall has the necessary rule groups configured. Remediation involves creating and attaching rule groups to enforce your organization's security policies, thereby controlling inbound and outbound traffic effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networkfirewall.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/index.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.nosql.table.global_table_cross_region_replication_encrypted
  service: nosql
  resource: table
  requirement: Global Table Cross Region Replication Encrypted
  scope: nosql.table.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Global Table Cross Region Replication Encryption
  rationale: Encrypting data for cross-region replication in Oracle NoSQL Database ensures that sensitive information is protected from unauthorized access during transit. Without encryption, data exposure risks increase, potentially leading to data breaches and non-compliance with regulations such as GDPR, HIPAA, and PCI-DSS, which mandate the protection of personal and financial data.
  description: This rule checks whether cross-region replication for Oracle NoSQL Database tables is encrypted. To verify, ensure that encryption settings are enabled in the NoSQL table configuration for all cross-region replication activities. Remediation involves configuring or updating existing NoSQL tables to use Oracle's encryption capabilities for data in transit, specifically by enabling encryption for global tables within the NoSQL Database service.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/NoSQL/using/nosql-api-table.htm#global_tables
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.nosql.table.global_table_encryption_all_regions_enabled
  service: nosql
  resource: table
  requirement: Global Table Encryption All Regions Enabled
  scope: nosql.table.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Global Table Encryption Enabled for NoSQL Tables
  rationale: Enabling global table encryption across all regions in Oracle Cloud Infrastructure (OCI) NoSQL is crucial for safeguarding sensitive data against unauthorized access and potential breaches. This practice helps mitigate risks associated with data replication across regions, ensuring that data remains secure at rest and in transit. It also supports compliance with data protection regulations such as GDPR and CCPA that mandate robust encryption standards.
  description: This rule verifies that encryption is enabled for all NoSQL tables across all regions in OCI. It checks the configuration settings to ensure that data is encrypted using OCI's default encryption keys or customer-managed keys. To verify, administrators can review the NoSQL table settings in the OCI Console under the 'Security' section. Remediation involves enabling encryption for any tables not currently encrypted and ensuring that customer-managed keys are properly configured and rotated regularly if used.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/NoSQL/Concepts/nosqloverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm#SecuringData
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57p1r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.nosql.table.global_table_pitr_enabled
  service: nosql
  resource: table
  requirement: Global Table Pitr Enabled
  scope: nosql.table.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Enable PITR for Global NoSQL Tables
  rationale: Point-in-time recovery (PITR) is crucial for mitigating data loss and ensuring business continuity in the event of accidental deletions or data corruption. Enabling PITR for global NoSQL tables enhances data resilience and supports compliance with regulations that require robust data protection strategies, such as GDPR and ISO 27001. Without PITR, organizations risk prolonged downtime and potential regulatory penalties.
  description: This rule checks if point-in-time recovery is enabled for global tables in Oracle NoSQL Database. To verify, inspect the table configurations in the OCI Console under the NoSQL service and ensure that the PITR feature is activated. If not enabled, navigate to the table settings and activate PITR to allow data recovery to any point in time within the retention period. This action helps protect against data loss due to human error or malicious activities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/NoSQL/using/pitr.htm
  - https://www.oracle.com/security-cloud/cis-benchmarks/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.nosql.table.table_encryption_enabled
  service: nosql
  resource: table
  requirement: Table Encryption Enabled
  scope: nosql.table.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure NoSQL Table Encryption is Enabled
  rationale: Enabling encryption for NoSQL tables is critical to protect sensitive data from unauthorized access and potential data breaches. This is particularly important for organizations handling personal or financial information, and it helps in meeting regulatory compliance such as PCI-DSS and HIPAA by ensuring data privacy and integrity.
  description: This rule checks whether table encryption is enabled for Oracle Cloud Infrastructure NoSQL Database tables. Encryption at rest protects data by using Oracle managed keys, which automatically encrypts data before storage and decrypts it upon access. To verify, check the encryption status in the OCI Console under the NoSQL Database service and ensure that the 'Encryption' option is set to 'Enabled'. If not enabled, navigate to the table settings and enable encryption to prevent unauthorized data access.
  references:
  - https://docs.oracle.com/en-us/iaas/nosql-database/doc/security-encryption.html
  - https://www.oracle.com/security/cloud-security/capabilities/
  - https://cloudsecurityalliance.org/research/artifacts/oci-security-best-practices
  - https://docs.oracle.com/en-us/iaas/Content/Compliance/Reference/pci-dss-v3-2-1.htm
  - https://www.nist.gov/publications/fips-197-advanced-encryption-standard-aes
- rule_id: oci.nosql.table.table_private_network_only_where_supported_enforced
  service: nosql
  resource: table
  requirement: Table Private Network Only Where Supported Enforced
  scope: nosql.table.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure NoSQL Tables Are Accessible Only via Private Network
  rationale: Restricting NoSQL table access to private networks minimizes the risk of unauthorized data exposure and potential data breaches. This practice is essential to safeguard sensitive data and meet compliance requirements for regulations such as PCI-DSS and HIPAA, which mandate stringent access controls.
  description: This rule verifies that Oracle NoSQL tables are configured to be accessible only within a private network where such configuration is supported. This involves setting up VCNs (Virtual Cloud Networks) and subnets that restrict public internet access. To verify, review the network access settings in the OCI Console for NoSQL tables and ensure they are aligned with private network configurations. Remediation involves modifying network security settings to restrict access to specific IP addresses or VCNs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/NoSQL/Tasks/usingnosql.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security-cloud-compliance/
- rule_id: oci.nosql.table.table_rbac_least_privilege_required
  service: nosql
  resource: table
  requirement: Table RBAC Least Privilege Required
  scope: nosql.table.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce Least Privilege on NoSQL Table Access
  rationale: Ensuring that NoSQL tables have the least privilege access model is crucial to minimize potential unauthorized data access and reduce the attack surface. Excessive permissions can lead to accidental data leaks or malicious data tampering, which can result in compliance violations with standards like PCI-DSS and ISO 27001, and potentially harm the organization's reputation and financial standing.
  description: This rule checks whether the policies associated with NoSQL tables in OCI are following the principle of least privilege. It requires auditing the IAM policies to ensure that only necessary permissions are granted to users and groups. To remediate, review and modify policies to restrict access to only those operations that are essential for the role. Verify through the OCI Console by navigating to Identity -> Policies and inspecting the detailed permissions granted.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations_benchmark_v1.0.0.pdf
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.monitoring.alarm.notification_destinations_configured
  service: monitoring
  resource: alarm
  requirement: Notification Destinations Configured
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Notification Destinations for Alarms Are Configured
  rationale: Configuring notification destinations for alarms is critical for timely detection and response to potential security incidents or operational issues in Oracle Cloud Infrastructure (OCI). Without proper notification channels, important alerts could be missed, leading to delayed responses and increased risk of data breaches, service disruptions, or non-compliance with regulatory requirements such as PCI-DSS or ISO 27001.
  description: This rule checks whether notification destinations are configured for OCI monitoring alarms. Alarms without configured notification channels may not alert administrators to critical changes or threats. To ensure that alarms are effective, configure notification services like Email or Oracle Cloud Infrastructure Notifications Service with appropriate topics and subscriptions. Verification involves checking for active notification channels linked to alarms. Remediation includes adding necessary notification destinations within the Monitoring service settings to ensure alerts are conveyed promptly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-foundations-benchmark.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Notification/Concepts/notificationoverview.htm
- rule_id: oci.monitoring.alarm.notification_endpoints_authenticated
  service: monitoring
  resource: alarm
  requirement: Notification Endpoints Authenticated
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Alarm Notification Endpoints Are Authenticated
  rationale: Authenticated notification endpoints in OCI Monitoring Alarms reduce the risk of unauthorized access and data breaches. This is crucial for maintaining the integrity and confidentiality of sensitive alert information, and it helps organizations comply with regulatory requirements such as PCI-DSS and ISO 27001 that mandate secure communication channels.
  description: This rule verifies that all notification endpoints configured for OCI Monitoring Alarms are authenticated, ensuring secure communication. To comply, use HTTPS endpoints with valid SSL certificates and authenticate using Oracle Cloud Infrastructure credentials or OAuth tokens. Unauthenticated endpoints may expose sensitive information to unauthorized entities. Remediation involves updating alarm configurations to use only authenticated endpoints, verifying SSL certificates, and enabling necessary authentication mechanisms.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-stig-security-guide.pdf
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.monitoring.alarm.notification_message_tls_enabled
  service: monitoring
  resource: alarm
  requirement: Notification Message TLS Enabled
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure TLS for OCI Alarm Notification Messages
  rationale: Enabling TLS for alarm notifications in OCI ensures the confidentiality and integrity of the messages that convey critical monitoring information. This reduces the risk of interception or tampering by malicious actors, safeguarding sensitive operational data and maintaining compliance with industry standards like PCI-DSS and HIPAA.
  description: This rule checks whether TLS is enabled for Oracle Cloud Infrastructure alarm notifications. TLS must be configured to encrypt the communication between OCI and notification services such as email or third-party integrations. To verify, ensure that the notification service endpoint is configured to use a secure protocol (HTTPS) and update any non-compliant settings in the OCI Console under Monitoring and Alarms. Remediation involves reconfiguring the notification delivery channels to enforce TLS connections.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - CIS Oracle Cloud Infrastructure Foundation Benchmark
  - https://csrc.nist.gov/publications/detail/sp/800-52/rev-2/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/sites/default/files/hipaa-simplification-201303.pdf
- rule_id: oci.monitoring.alarm.notification_no_public_webhooks_blocked
  service: monitoring
  resource: alarm
  requirement: Notification No Public Webhooks Blocked
  scope: monitoring.alarm.public_access
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: critical
  title: Block Public Webhooks in Monitoring Alarms
  rationale: Allowing public webhooks for OCI monitoring alarms poses significant security risks, such as unauthorized access to sensitive alert data and potential manipulation of system behaviors. This can lead to data breaches, compliance failures, and operational disruptions, especially if alerts contain critical information related to system health or security events. Blocking public access helps maintain the confidentiality and integrity of monitoring data and aligns with stringent compliance requirements like PCI-DSS and ISO 27001.
  description: This rule checks whether monitoring alarms in OCI are configured to use public webhooks for notifications. Public webhooks can expose sensitive alert data to unauthorized entities. To verify, review the webhook configuration in the OCI Console under Monitoring > Alarms and ensure webhooks are set to private endpoints accessible only within your trusted network. Remediation involves replacing public webhooks with private endpoints using the OCI API Gateway or Service Gateway, ensuring only authenticated and authorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/securitychecklist.htm#securitychecklist
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.ons.topic.communication_channels_configured
  service: ons
  resource: topic
  requirement: Communication Channels Configured
  scope: ons.topic.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure ONS Topic Has Configured Communication Channels
  rationale: Configuring communication channels for Oracle Notification Service (ONS) topics is crucial for ensuring that notifications are delivered to intended recipients, thereby mitigating risks of missed alerts that could lead to unmonitored incidents. Proper configuration supports compliance with regulatory requirements such as PCI-DSS and SOC2, which mandate effective monitoring and alerting mechanisms to protect sensitive data and maintain system integrity.
  description: This rule checks if communication channels such as email, HTTPS, or PagerDuty are configured for ONS topics, ensuring that notifications are sent to the appropriate endpoints. A missing or misconfigured communication channel may result in failure to alert stakeholders about critical events. To verify this configuration, ensure each topic has at least one active communication channel. To remediate, navigate to the ONS Topic settings in the OCI Console and add the required channels. Regularly review and update these channels to maintain effective communication.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Notification/Concepts/notificationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Notification/Tasks/managingtopicsandsubscriptions.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/sorhome.html
- rule_id: oci.ons.topic.communication_destinations_access_least_privilege_required
  service: ons
  resource: topic
  requirement: Communication Destinations Access Least Privilege Required
  scope: ons.topic.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for ONS Topic Communication Destinations
  rationale: Granting excessive permissions to Oracle Notification Service (ONS) topics can lead to unauthorized access, potentially exposing sensitive information or allowing malicious actions. Adhering to the principle of least privilege reduces the attack surface by ensuring only necessary permissions are granted, aligning with compliance requirements such as PCI-DSS and ISO 27001, and mitigating insider threats.
  description: This rule checks that access permissions for ONS topic communication destinations are configured with the least privilege necessary. It verifies that only required IAM policies are attached to users or groups interacting with ONS topics. To remediate, review and adjust IAM policies, ensuring they are specific to the necessary actions such as 'ons:PublishMessage' or 'ons:Subscribe'. Utilize OCI's IAM policy simulator to validate access rights and regularly audit permissions to maintain compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Notification/Concepts/notificationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/document_library
  - https://www.iso.org/standard/54534.html
- rule_id: oci.ons.topic.communication_no_public_webhooks_without_auth_blocked
  service: ons
  resource: topic
  requirement: Communication No Public Webhooks Without Auth Blocked
  scope: ons.topic.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Block Public Webhooks Without Authentication for ONS Topics
  rationale: Allowing public webhooks without authentication in Oracle Notification Service (ONS) topics exposes sensitive data to unauthorized access, leading to potential data breaches and loss of confidentiality. This risk is heightened in environments with regulatory requirements such as PCI-DSS or HIPAA, where unauthorized data exposure can result in significant legal and financial penalties.
  description: This rule checks if public webhooks for ONS topics are configured without authentication. OCI best practices dictate that webhooks should be secured with authentication mechanisms to ensure that only authorized users can access the service. To remediate, configure webhooks with secure authentication methods such as OAuth tokens or API keys. Verification can be performed by reviewing the webhook settings in the OCI console and ensuring authentication is required.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Notification/Concepts/notificationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_2.0.0.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/cloud/cloud-security.html
  - https://owasp.org/www-project-top-ten/
- rule_id: oci.ons.topic.escalation_change_audit_logging_enabled
  service: ons
  resource: topic
  requirement: Escalation Change Audit Logging Enabled
  scope: ons.topic.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Audit Logging for ONS Topic Escalation Changes
  rationale: Enabling audit logging for escalation changes in Oracle Notification Service (ONS) topics is crucial to ensure visibility into potentially unauthorized modifications, which could lead to unauthorized access or data exfiltration. This logging is vital for forensic analysis and compliance with regulatory standards that require detailed audit trails, such as detecting insider threats or verifying compliance with standards like PCI-DSS and SOC2.
  description: This rule checks whether audit logging is enabled for escalation changes in ONS topics within OCI. To verify, ensure that logs are being captured and stored in the OCI Logging service, specifically for events related to topic configuration changes. Remediation involves configuring the Logging service to capture these changes by creating log groups and enabling logging for the required ONS topic resources, ensuring that all relevant logs are retained according to your organization's compliance requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Notification/Concepts/notificationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.pcisecuritystandards.org/
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/soc2report.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
- rule_id: oci.ons.topic.escalation_oncall_contacts_verified_validated
  service: ons
  resource: topic
  requirement: Escalation Oncall Contacts Verified Validated
  scope: ons.topic.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Verify and Validate Oncall Contacts for ONS Topic Escalations
  rationale: Validating oncall contacts for ONS topics ensures that critical notifications are promptly addressed, reducing downtime and potential data loss. This practice mitigates the risk of unhandled incidents and aligns with governance policies that require timely incident response. Ensuring accurate contact information supports business continuity and meets compliance with frameworks mandating incident response capabilities.
  description: This rule checks that all escalation oncall contacts associated with Oracle Notification Service (ONS) topics are verified and validated. To achieve this, ensure that contact information is current and that all escalation paths are tested regularly. Remediation involves updating contact details in the ONS console and conducting periodic verification exercises. Regular audits of oncall lists help maintain the integrity and reliability of incident response protocols.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Notification/Concepts/notificationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/OCI_CIS_Benchmarks_v1.1.htm
  - https://www.nist.gov/cyberframework
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v4/
- rule_id: oci.ons.topic.critical_severity_escalation_policy_configured
  service: ons
  resource: topic
  requirement: Critical Severity Escalation Policy Configured
  scope: ons.topic.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Critical Severity Escalation Policy for ONS Topics
  rationale: Properly configured escalation policies for critical severity notifications in ONS Topics are essential to ensure that urgent issues receive the appropriate attention and response in a timely manner. Without such policies, critical alerts may be missed, leading to potential data breaches, service disruptions, or non-compliance with regulatory requirements. This configuration helps in mitigating risks associated with delayed incident response, thereby protecting business continuity and data integrity.
  description: This rule checks if escalation policies are configured for topics in Oracle Notification Service (ONS) that handle critical severity alerts. Specifically, it verifies that the policy includes escalation procedures to notify responsible parties through multiple channels to ensure prompt action. To verify, administrators should review the ONS topic settings in the OCI Console and ensure that escalation policies are defined and active. Remediation involves setting up or updating the escalation policy to include appropriate notification channels and responsible contacts for critical alerts.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Notification/Concepts/notificationoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - CIS OCI Foundations Benchmark
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://cloud.oracle.com/terms/security-list
- rule_id: oci.object_storage.bucket.encryption_backup_storage_immutability_enabled
  service: object_storage
  resource: bucket
  requirement: Encryption Backup Storage Immutability Enabled
  scope: object_storage.bucket.encryption
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: high
  title: Ensure Immutability and Encryption for OCI Object Storage Buckets
  rationale: Enabling encryption and immutability for object storage buckets is crucial for protecting sensitive data against unauthorized access and tampering. This ensures data integrity and confidentiality, mitigating risks such as data breaches and accidental deletions, and supports compliance with regulations like PCI-DSS and HIPAA.
  description: This rule checks that object storage buckets in OCI have encryption enabled and are configured for immutability, preventing any modifications or deletions during the specified retention period. To verify, ensure that server-side encryption is activated and Object Lock policies are applied. Remediation involves enabling encryption via the OCI Console and setting up immutability policies, such as 'Compliance' or 'Governance' modes, to secure data effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingyourencryptionkeys.htm
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/object-lock-overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/index.html
- rule_id: oci.object_storage.bucket.encryption_cmk_key_enabled
  service: object_storage
  resource: bucket
  requirement: Encryption CMK Key Enabled
  scope: object_storage.bucket.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure CMK Encryption for OCI Object Storage Buckets
  rationale: Using customer-managed keys (CMK) for encryption enhances data security by giving organizations control over encryption keys, reducing the risk of unauthorized access. This is critical for protecting sensitive data, ensuring compliance with regulations like PCI-DSS, HIPAA, and GDPR, and mitigating threats such as data breaches or insider threats.
  description: This rule checks if Object Storage buckets in OCI are encrypted using a customer-managed key (CMK). Proper configuration involves creating a vault and a key within OCI Key Management, then assigning this key to the bucket. To verify compliance, check the bucket's encryption settings in the OCI Console, ensuring a CMK is specified. Remediation involves updating the bucket's settings to use an existing CMK, ensuring all data at rest is encrypted. This enhances control and auditing capabilities over key usage and lifecycle.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingkms.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/index.html
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.object_storage.bucket.encryption_enabled
  service: object_storage
  resource: bucket
  requirement: Encryption Enabled
  scope: object_storage.bucket.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Encryption is Enabled for Object Storage Buckets
  rationale: Enabling encryption for Object Storage buckets in OCI is crucial for protecting sensitive data from unauthorized access and potential breaches. Without encryption, data at rest could be exposed to malicious actors, leading to data theft, compliance violations, and reputational damage. Encrypting data aligns with regulatory requirements such as GDPR, HIPAA, and PCI-DSS, ensuring data privacy and integrity.
  description: This rule checks that encryption is enabled for all Object Storage buckets in OCI, ensuring that data at rest is secured using Oracle's encryption algorithms. To verify, navigate to the OCI Console, select 'Object Storage' under 'Storage', and check that each bucket has encryption enabled. For remediation, configure the bucket settings to use server-side encryption with Oracle-managed keys or customer-managed keys, providing an additional layer of security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingencryption.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
- rule_id: oci.object_storage.bucket.encryption_tls_min_1_2_enabled
  service: object_storage
  resource: bucket
  requirement: Encryption TLS Min 1 2 Enabled
  scope: object_storage.bucket.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure TLS 1.2+ for Object Storage Bucket Encryption
  rationale: Enforcing TLS 1.2 or higher for encryption ensures secure data transmission and protects sensitive data from interception and tampering. This is crucial for maintaining data integrity and confidentiality, especially for organizations handling personal or financial information. Compliance with modern cryptographic standards is often a requirement of regulations such as PCI-DSS, HIPAA, and GDPR.
  description: This rule checks if object storage buckets in OCI are configured to enforce a minimum of TLS 1.2 for encryption. TLS 1.2 or higher provides robust encryption mechanisms, reducing the risk of attacks like MitM (Man-in-the-Middle). To verify, inspect the bucket's configuration settings in the OCI console or use the OCI CLI to ensure TLS 1.2 or higher is specified. Remediation involves updating the bucket settings to enforce at least TLS 1.2.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Concepts/objectstorageoverview.htm
  - https://www.oracle.com/security/cloud-security/capabilities/data-encryption.html
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-52r2.pdf
- rule_id: oci.object_storage.bucket.encryption_key_policy_least_privilege_enabled_enforced
  service: object_storage
  resource: bucket
  requirement: Encryption Key Policy Least Privilege Enabled Enforced
  scope: object_storage.bucket.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Least Privilege for Bucket Encryption Key Policies
  rationale: Implementing least privilege for encryption key policies in OCI Object Storage minimizes the risk of unauthorized access to sensitive data. It helps mitigate potential data breaches and ensures compliance with data protection regulations such as GDPR and CCPA. By restricting key access, organizations can better protect their data assets against insider threats and external attacks.
  description: This rule checks that encryption key policies for OCI Object Storage buckets are configured with least privilege principles. Ensure that only entities requiring access to perform their job functions have permissions to manage encryption keys. Administrators should regularly audit and refine key policies, removing unnecessary permissions. Remediation involves reviewing and adjusting IAM policies to align with least privilege principles and verifying through the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/security/cloud-security/cloud-security-controls/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.object_storage.bucket.encryption_key_rotation_enabled
  service: object_storage
  resource: bucket
  requirement: Encryption Key Rotation Enabled
  scope: object_storage.bucket.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable Encryption Key Rotation for Object Storage Buckets
  rationale: Regularly rotating encryption keys for object storage buckets minimizes the risk of data exposure from compromised or expired keys, ensuring ongoing protection of sensitive information. This practice is crucial for maintaining the confidentiality and integrity of data, complying with regulatory standards like GDPR and PCI-DSS, and mitigating threats such as unauthorized data access or data breaches.
  description: This rule checks if encryption key rotation is enabled for Oracle Cloud Infrastructure Object Storage buckets. To verify, access the OCI console, navigate to Object Storage, and examine the encryption settings of each bucket to ensure automatic key rotation is configured through the OCI Key Management service. Remediation involves configuring buckets to utilize OCI Vault for managing encryption keys and setting policies to rotate keys at regular intervals, enhancing data security and compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingkeymanagement.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://cloud.oracle.com/en_US/cloud-security/vault
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.object_storage.bucket.bucket_access_logging_enabled
  service: object_storage
  resource: bucket
  requirement: Bucket Access Logging Enabled
  scope: object_storage.bucket.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Bucket Access Logging for OCI Object Storage
  rationale: Enabling bucket access logging is crucial for maintaining a secure and compliant cloud environment. It provides visibility into bucket access events, which helps in detecting unauthorized access attempts, understanding access patterns, and supporting forensic investigations. Additionally, it aids in meeting regulatory compliance requirements such as PCI-DSS and HIPAA by ensuring audit trails are available.
  description: This rule checks if access logging is enabled for Oracle Cloud Infrastructure Object Storage buckets. Access logging records details about requests made to a bucket, which can be used for security analysis and audit purposes. To verify, check the bucket's configuration in the OCI Console or via the CLI/API to ensure logging is enabled. Remediation involves enabling the logging feature for the bucket to capture access events.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#logging
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/cloud/security/
- rule_id: oci.object_storage.bucket.bucket_block_public_access_enabled
  service: object_storage
  resource: bucket
  requirement: Bucket Block Public Access Enabled
  scope: object_storage.bucket.public_access
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: critical
  title: Ensure Bucket Block Public Access in OCI Object Storage
  rationale: Blocking public access to OCI Object Storage buckets is critical to prevent unauthorized data exposure and mitigate data breaches. Publicly accessible buckets can lead to inadvertent data leaks, impacting compliance with regulations such as PCI-DSS and HIPAA, and exposing sensitive business information to malicious actors.
  description: This rule checks if Object Storage buckets in OCI have public access blocked to enhance data security. It involves setting the 'Block Public Access' configuration on buckets, ensuring they are not inadvertently exposed to the internet. To verify and remediate, navigate to the OCI Console, select Object Storage, and ensure 'Block Public Access' is enabled for each bucket. This prevents unauthorized access and aligns with best practices for data security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#blockpublicaccess
  - CIS OCI Foundations Benchmark - 1.0.0
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.object_storage.bucket.bucket_cmk_enabled
  service: object_storage
  resource: bucket
  requirement: Bucket CMK Enabled
  scope: object_storage.bucket.security
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure OCI Bucket Uses Customer-Managed Encryption Keys (CMK)
  rationale: Using Customer-Managed Encryption Keys (CMK) for OCI buckets enhances control over data encryption, aligning with data protection regulations and mitigating risks of unauthorized access. It provides businesses with the ability to manage the lifecycle of the encryption keys, thus ensuring compliance with standards like GDPR and CCPA that mandate stringent data security controls.
  description: This rule checks if OCI Object Storage buckets are configured to use Customer-Managed Encryption Keys (CMK) instead of Oracle-managed keys. To verify, review the bucket's encryption settings in the OCI console to ensure they are set to use CMK. If not configured, navigate to the bucket settings and select a CMK from the Key Management service. This enhances security by providing organizations with control over key rotation, access policies, and auditing of key usage.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingyourencryptionkeys.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.object_storage.bucket.bucket_encryption_enabled
  service: object_storage
  resource: bucket
  requirement: Bucket Encryption Enabled
  scope: object_storage.bucket.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Encryption is Enabled for OCI Object Storage Buckets
  rationale: Enabling encryption on Object Storage buckets is crucial for protecting sensitive data against unauthorized access and ensuring compliance with regulatory standards such as PCI-DSS and HIPAA. Without encryption, data stored at rest is vulnerable to theft or exposure, which can lead to data breaches, financial loss, and legal repercussions for the organization.
  description: This rule checks if encryption is enabled for Object Storage buckets in Oracle Cloud Infrastructure. Buckets should be configured to use Oracle-managed keys or customer-managed keys for server-side encryption. To verify, navigate to the bucket settings in the OCI console and ensure that encryption is set to either 'Oracle-managed' or 'Customer-managed keys'. If encryption is not enabled, configure it by selecting the appropriate key management option. This action can be automated using Terraform or the OCI CLI for consistent application across multiple buckets.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#encryption
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://cloudsecurityalliance.org/research/guidance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.object_storage.bucket.bucket_policy_denies_public_and_insecure_blocked
  service: object_storage
  resource: bucket
  requirement: Bucket Policy Denies Public And Insecure Blocked
  scope: object_storage.bucket.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Prevent Public and Insecure Access to OCI Buckets
  rationale: Exposing buckets to the public can lead to unauthorized access, data breaches, and potential data loss, impacting business reputation and customer trust. Blocking public access is crucial to meet compliance with regulations like GDPR and PCI-DSS, which mandate strict controls on data exposure and access management.
  description: This rule checks if bucket policies deny public and unsecured access by ensuring that all bucket policies explicitly block public access settings. Verification involves inspecting bucket policy statements to confirm they do not grant 'public-read' or similar permissions. Remediation includes updating bucket policies to remove any public settings and applying fine-grained IAM policies to control access. Utilize OCI's pre-defined policies as a starting point for secure configurations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/objectstoragecreatingbuckets.htm#publicaccess
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/cloud/cloud-infrastructure-compliance/
- rule_id: oci.object_storage.bucket.bucket_require_tls_in_transit_required
  service: object_storage
  resource: bucket
  requirement: Bucket Require TLS In Transit Required
  scope: object_storage.bucket.security
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Enforce TLS for OCI Object Storage Buckets
  rationale: Requiring TLS for data in transit to OCI Object Storage buckets mitigates the risk of data interception and unauthorized access. It ensures the confidentiality and integrity of sensitive data, aligning with compliance mandates such as PCI-DSS and HIPAA, which require secure data transmission. By enforcing TLS, organizations reduce exposure to man-in-the-middle attacks and enhance their overall security posture.
  description: This rule checks if OCI Object Storage buckets enforce the use of TLS for all data transmitted to and from the bucket. To verify, ensure that the 'Require TLS' setting is enabled on each bucket. Remediation involves updating the bucket configuration in the OCI Console or through the CLI/API to mandate TLS, protecting the data in transit from potential threats and unauthorized interceptions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingbuckets.htm#B_Topics_Using_Buckets
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hipaajournal.com/hipaa-security-rule/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.object_storage.bucket.bucket_versioning_enabled
  service: object_storage
  resource: bucket
  requirement: Bucket Versioning Enabled
  scope: object_storage.bucket.versioning
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Enable Versioning on Object Storage Buckets
  rationale: Enabling versioning on OCI Object Storage buckets is critical for business continuity and data integrity. It allows the preservation of, retrieval of, and restoration of every version of every object stored in a bucket, protecting against accidental deletions, overwrites, and data corruption. This capability is crucial for meeting compliance requirements and safeguarding against insider threats and ransomware attacks, ensuring that data can be recovered to a previous state if necessary.
  description: This rule verifies that versioning is enabled for OCI Object Storage buckets. Versioning is a feature that maintains multiple versions of an object in the same bucket, providing a mechanism to recover from unintended user actions and application failures. To check this setting, navigate to the OCI Console, select the desired bucket, and ensure that versioning is set to 'Enabled' under the bucket's configuration settings. Remediation involves enabling versioning for buckets that lack it, which can be done through the console or using the OCI CLI by setting the 'versioning' property to 'Enabled'.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#versioning
  - https://www.oracle.com/cloud-security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/security/cloud-security/cloud-infrastructure-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.object_storage.bucket.ai_services_dataset_access_logging_enabled
  service: object_storage
  resource: bucket
  requirement: Ai Services Dataset Access Logging Enabled
  scope: object_storage.bucket.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure AI Dataset Access Logging is Enabled for Buckets
  rationale: Enabling access logging for AI service datasets in OCI Object Storage is crucial for monitoring and auditing purposes, ensuring that data access patterns are tracked and anomalous activities are identified promptly. This mitigates risks related to unauthorized data access and helps meet compliance requirements such as GDPR and CCPA by providing a detailed audit trail.
  description: This rule checks whether access logging is enabled for buckets storing AI service datasets in OCI Object Storage. To verify, ensure that logging is configured and active on the specific bucket settings in the OCI Console. Remediation involves navigating to the Object Storage service, selecting the appropriate bucket, and enabling logging under the 'Logging' section. This configuration helps in maintaining a comprehensive access log for security audits and incident investigations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/objectmanaginglogs.htm
  - https://www.oracle.com/security/cis-benchmark/
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://www.oracle.com/cloud/security/
- rule_id: oci.object_storage.bucket.ai_services_dataset_lifecycle_policy_configured
  service: object_storage
  resource: bucket
  requirement: Ai Services Dataset Lifecycle Policy Configured
  scope: object_storage.bucket.lifecycle_management
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure AI Services Dataset Lifecycle Policy is Configured
  rationale: Implementing lifecycle policies for AI services datasets in Object Storage can minimize storage costs and enhance data management by automatically archiving or deleting data based on predefined rules. This is crucial for maintaining compliance with data retention policies and reducing the risk of unauthorized data access by ensuring outdated data is handled appropriately.
  description: This rule checks if lifecycle policies are configured for Object Storage buckets used by AI services. Proper configuration involves setting rules to transition objects to different storage tiers or delete them after a certain period. To verify, review the lifecycle policy settings in the OCI Console under Object Storage. Remediation involves creating or updating lifecycle policies for buckets to ensure data is archived or purged according to organizational data governance standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usinglifecyclepolicies.htm
  - https://www.oracle.com/security-cloud/cis-oracle-cloud-infrastructure-foundations-benchmark.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/cloud/security/best-practices/
- rule_id: oci.object_storage.bucket.ai_services_dataset_s3_block_public_access_blocked
  service: object_storage
  resource: bucket
  requirement: Ai Services Dataset S3 Block Public Access Blocked
  scope: object_storage.bucket.public_access
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: critical
  title: Ensure S3 Block Public Access for AI Services Dataset Buckets
  rationale: Public access to object storage buckets containing AI datasets poses significant security risks, including unauthorized data exposure and potential data breaches. This can lead to non-compliance with data protection regulations such as GDPR and CCPA, resulting in financial penalties and reputational damage. Ensuring proper access controls protects sensitive data and maintains customer trust.
  description: This rule checks if buckets configured for AI Services datasets have S3 Block Public Access settings enabled. These settings prevent unauthorized public access, which is crucial for safeguarding sensitive AI-related data. To verify, review the bucket's public access settings in the OCI Console and ensure the 'Block Public Access' option is enabled. If not, modify the bucket's settings to restrict public access, thereby strengthening data security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/objectstorageoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://cloud.oracle.com/storage/features
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.object_storage.bucket.ai_services_dataset_s3_encrypted_at_rest
  service: object_storage
  resource: bucket
  requirement: Ai Services Dataset S3 Encrypted At Rest
  scope: object_storage.bucket.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Ai Services Dataset Buckets are Encrypted at Rest
  rationale: Encrypting data at rest in OCI Object Storage is crucial to protect sensitive AI datasets from unauthorized access and data breaches. This practice mitigates risks such as data espionage and loss of confidentiality, aligning with regulatory requirements like GDPR and CCPA which mandate protecting personally identifiable information. Proper encryption helps maintain trust with customers and ensures business continuity in the face of potential security incidents.
  description: This rule checks if OCI Object Storage buckets intended for AI services datasets are configured with server-side encryption at rest. Encryption can be enabled using OCI-managed keys or customer-managed keys through the Oracle Key Management service. To verify, navigate to the Object Storage console, check the bucket settings for encryption status, and ensure that 'Encryption' is set to 'Enabled'. If not, update the bucket configuration to enable encryption. This ensures that all data stored within the bucket is encrypted automatically, reducing the risk of data exposure.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/ssecures3bucket.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam_traditional.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.oracle.com/security/cloud-security/capabilities/data-encryption/
  - https://www.iso.org/standard/54534.html
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
- rule_id: oci.object_storage.bucket.ai_dataset_encrypted_at_rest_cmek
  service: object_storage
  resource: bucket
  requirement: Ai Dataset Encrypted At Rest Cmek
  scope: object_storage.bucket.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure AI Dataset Buckets Use CMEK for Encryption at Rest
  rationale: Using Customer-Managed Encryption Keys (CMEK) for AI datasets ensures that you maintain control over the encryption keys, enhancing data confidentiality and integrity. This reduces the risk of unauthorized data access and helps meet compliance requirements for data protection standards like GDPR and HIPAA, which mandate stringent encryption controls and data handling practices.
  description: This rule checks if AI dataset buckets in OCI Object Storage are encrypted using Customer-Managed Encryption Keys (CMEK). To verify, ensure that the buckets have been configured with a specific CMEK rather than using Oracle-managed keys. If not already configured, create or select an existing Vault and Key in OCI Key Management, and apply this key to the bucket's encryption settings. This configuration enhances data security by giving you control over key management and rotation.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingkms.htm#Using_Customer_Managed_Keys
  - https://www.oracle.com/security/cloud-security/oci-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
- rule_id: oci.object_storage.bucket.ai_dataset_public_access_blocked_blocked
  service: object_storage
  resource: bucket
  requirement: Ai Dataset Public Access Blocked Blocked
  scope: object_storage.bucket.public_access
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: critical
  title: Block Public Access to AI Dataset Buckets
  rationale: Allowing public access to AI dataset buckets in OCI can lead to unauthorized data exposure, potentially resulting in data breaches or misuse of sensitive information. This is particularly critical for datasets containing proprietary or personal data, which could lead to compliance violations with standards such as GDPR or HIPAA. Blocking public access mitigates these risks and safeguards the integrity and confidentiality of the data.
  description: This rule checks that AI dataset buckets in OCI Object Storage do not have public access enabled. Public access should be explicitly blocked by configuring the bucket's access policies to restrict unauthorized exposure. To verify, review the bucket's access policies in the OCI console or via CLI tools, ensuring 'publicAccessType' is set to 'NoPublicAccess'. If public access is enabled, modify the bucket policy to restrict access to authorized users only.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#public-access
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/cloud/cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/overviewsecurity.htm
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.object_storage.bucket.retention_enforced_on_sensitive_datasets
  service: object_storage
  resource: bucket
  requirement: Retention Enforced On Sensitive Datasets
  scope: object_storage.bucket.security
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure Retention Lock on Sensitive Buckets
  rationale: Enforcing retention on sensitive datasets in OCI Object Storage prevents premature data deletion, ensuring data integrity and meeting regulatory requirements like GDPR or HIPAA. This mitigates risks of data loss or tampering, which can lead to compliance violations, financial penalties, and loss of trust.
  description: This rule checks if retention policies are enforced on buckets containing sensitive data in OCI Object Storage. Retention lock prevents the deletion or modification of critical data for a specified period. Verify by ensuring that Object Storage buckets have appropriate retention policies in place. To remediate, apply a retention policy via OCI Console or CLI with a lock option set to 'compliance' to ensure data is protected from unauthorized changes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingretention.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.iso.org/standard/54534.html
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
- rule_id: oci.object_storage.bucket.retention_policies_defined_required
  service: object_storage
  resource: bucket
  requirement: Retention Policies Defined Required
  scope: object_storage.bucket.security
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Define Retention Policies for Object Storage Buckets
  rationale: Retention policies in OCI Object Storage help enforce data governance by preventing premature data deletion. They are crucial in scenarios where data integrity and availability must be maintained for compliance with regulations such as GDPR or for business continuity. Without defined retention policies, organizations risk accidental data loss or non-compliance with legal data retention requirements.
  description: This rule checks whether retention policies are defined for object storage buckets in OCI. Retention policies specify how long objects in a bucket must be retained before they can be deleted or overwritten, ensuring data is preserved according to organizational policies and compliance needs. To verify, inspect the bucket's settings in the OCI console or use the CLI/API to check for 'retention policies'. Remediation involves setting a defined retention period in the bucket settings via the OCI console or configuring it programmatically through OCI APIs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingretentionrules.htm
  - https://www.oracle.com/security/cis-oracle-cloud-infrastructure-foundations-benchmarks/
  - https://www.nist.gov/publications/general-data-retention-requirements
  - https://www.pcisecuritystandards.org/document_library?category=pcidss
  - https://www.oracle.com/cloud/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.object_storage.bucket.retention_protected_from_public_override_blocked
  service: object_storage
  resource: bucket
  requirement: Retention Protected From Public Override Blocked
  scope: object_storage.bucket.public_access
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: critical
  title: Prevent Public Override of Retention Policies for Buckets
  rationale: Allowing public overrides on retention policies can lead to unauthorized data alterations or deletions, risking data integrity and compliance breaches. This vulnerability can be exploited by malicious actors to tamper with or delete critical data, potentially resulting in financial loss and legal penalties under regulations like GDPR or CCPA.
  description: This rule checks if Object Storage buckets have retention policies that prevent public overrides. To verify, ensure that the 'allowPublicOverride' setting is disabled on all buckets. Remediation involves configuring the bucket policy to disallow public overrides, thereby ensuring that retention settings can only be modified by authorized users. This enhances data governance and aligns with compliance mandates.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm
  - CIS OCI Benchmark - Not currently available
  - 'ISO 27001 - Control A.8.2.3: Handling of data'
  - 'NIST SP 800-53 Rev. 5 - MP-6: Media Sanitization'
  - https://www.oracle.com/security/cloud-security/
  - https://cloud.oracle.com/architecture/data-governance
- rule_id: oci.monitoring.alarm.dashboard_public_embeds_disabled
  service: monitoring
  resource: alarm
  requirement: Dashboard Public Embeds Disabled
  scope: monitoring.alarm.public_access
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: critical
  title: Disable Public Embeds for OCI Monitoring Dashboards
  rationale: Allowing public access to Oracle Cloud Infrastructure (OCI) monitoring dashboards can expose sensitive metrics and operational insights to unauthorized users, leading to potential data leaks and security breaches. This risk is critical for organizations that must comply with standards such as PCI-DSS or HIPAA, where data confidentiality and integrity are paramount. Disabling public embeds mitigates these risks by ensuring that only authenticated users have access to critical monitoring data.
  description: This rule checks if OCI monitoring dashboards have public embeds enabled, which could expose sensitive information. To verify, review the dashboard settings in the OCI Console and ensure that the 'Public Embeds' option is disabled. Remediation involves navigating to the dashboard settings and disabling any public embed configurations to restrict access only to authenticated users.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/monitoringusingalarms.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.monitoring.alarm.dashboard_sharing_restricted_to_org_enabled
  service: monitoring
  resource: alarm
  requirement: Dashboard Sharing Restricted To Org Enabled
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Restrict Dashboard Sharing to Organization in OCI Monitoring
  rationale: Restricting dashboard sharing to within the organization minimizes the risk of sensitive monitoring data being accessed by unauthorized external parties. This practice helps prevent data breaches and ensures compliance with data protection regulations such as GDPR and HIPAA, which mandate control over data access and sharing.
  description: This rule checks whether the sharing of OCI Monitoring dashboards is restricted to users within your organization. To verify, go to the OCI Monitoring service, navigate to 'Dashboards', and ensure sharing settings are properly configured to limit access to organizational members only. Remediation involves updating dashboard sharing settings to restrict access to only those within your organization, ensuring that external sharing is disabled.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/buildingalarms.htm
  - https://www.oracle.com/security/cloud-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.oracle.com/a/ocom/docs/oci-security-architecture.pdf
  - https://www.nist.gov/cyberframework
  - https://gdpr.eu/
- rule_id: oci.monitoring.alarm.dashboard_sso_required
  service: monitoring
  resource: alarm
  requirement: Dashboard Sso Required
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure SSO is Enabled for Monitoring Dashboards
  rationale: Enabling Single Sign-On (SSO) for Oracle Cloud Infrastructure dashboards enhances security by centralizing user authentication and reducing the risk of unauthorized access. It also simplifies user management and improves user experience by allowing access through a single set of credentials. This practice is crucial for meeting compliance standards that mandate robust access controls, such as PCI-DSS and ISO 27001.
  description: This rule checks if Single Sign-On (SSO) is enabled for OCI monitoring dashboards. SSO integration ensures that access to alarms and monitoring data is restricted to authenticated users, leveraging external identity providers to enforce strong authentication policies. To verify, inspect the SSO configuration in the OCI Identity and Access Management (IAM) service and ensure it is correctly linked to your dashboards. If SSO is not enabled, configure it by integrating your preferred identity provider with OCI IAM following Oracle's guidelines.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/configuringsso.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.compute.instance.spot_instance_profile_least_privilege_required
  service: compute
  resource: instance
  requirement: Spot Instance Profile Least Privilege Required
  scope: compute.instance.least_privilege
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: high
  title: Ensure Least Privilege for Spot Instance Profiles in OCI
  rationale: Applying least privilege to spot instance profiles minimizes the risk of unauthorized access and potential misuse of resources, protecting against privilege escalation and reducing the attack surface. This is crucial for maintaining compliance with security frameworks and protecting sensitive workloads running on Spot instances, which could be exploited due to their dynamic nature.
  description: This rule checks that OCI Spot Instance profiles are configured with the minimum permissions necessary to function. It involves reviewing and restricting IAM policies associated with Spot instances to ensure they only allow essential actions. Verification can be done by auditing IAM policies and ensuring no excessive permissions are granted. Remediation includes adjusting policies to limit permissions and regularly reviewing access logs for anomalies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Spot/spotinstances.htm
- rule_id: oci.compute.instance.spot_instance_no_public_ip_assigned_blocked
  service: compute
  resource: instance
  requirement: Spot Instance No Public Ip Assigned Blocked
  scope: compute.instance.public_access
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Block Public IP on OCI Spot Instances
  rationale: Allowing public IPs on Spot Instances can expose critical workloads to unauthorized access and potential attacks, as these instances are often used for transient and cost-sensitive tasks. This poses a high security risk due to their ephemeral nature, making it crucial to restrict public access to mitigate unauthorized exposure and comply with data protection regulations like GDPR and CCPA.
  description: This rule checks if any Spot Instances in OCI have a public IP address assigned, which should be blocked to prevent exposure to the internet. Spot Instances should be configured to only use private IPs and be accessed via internal networks or VPNs. To remediate, ensure that Spot Instances are deployed without public IPs by setting the 'assignPublicIp' attribute to 'false' during instance creation or modification.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/launchingVMinstancetutorial.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.compute.instance.spot_instance_uses_approved_launch_template
  service: compute
  resource: instance
  requirement: Spot Instance Uses Approved Launch Template
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Spot Instances Use Approved Launch Templates
  rationale: Using approved launch templates for spot instances ensures consistency in configuration, which helps mitigate risks such as unauthorized access, misconfigurations, and data breaches. It also aids in maintaining compliance with internal policies and external regulatory requirements by enforcing standardized security settings across all instances.
  description: This rule checks whether all spot instances are launched using an approved launch template. Launch templates standardize instance configurations, including network settings, storage options, and security controls. To verify compliance, review the configuration of each spot instance to ensure it is associated with a designated launch template. Remediation involves updating non-compliant spot instances to use an approved launch template or modifying the launch template to meet security requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/launchinginstance.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/document_library
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.oracle.com/cloud/security-best-practices/
- rule_id: oci.queue.queue.queue_auth_required
  service: queue
  resource: queue
  requirement: Queue Auth Required
  scope: queue.queue.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Queue Authentication is Enabled
  rationale: Enforcing authentication on queues prevents unauthorized access, protecting sensitive data and maintaining the integrity of message workflows. Without authentication, malicious actors could potentially read or inject messages, leading to data breaches or disruptions in service. Enabling authentication aligns with compliance standards and reduces the risk of exploitation.
  description: This rule checks if authentication is enabled for Oracle Cloud Infrastructure Queue resources. To verify compliance, ensure that all queues require authentication by implementing a security policy that mandates the use of Oracle Cloud Infrastructure Identity and Access Management (IAM) for access control. Remediation involves configuring the queue settings to enforce IAM-based authentication, ensuring that only authorized entities can interact with the queue.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/queue/overview.htm#security
  - https://www.oracle.com/security/cloud-compliance/
  - https://cloudsecurityalliance.org/artifacts/cis-benchmark-oracle-cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.queue.queue.queue_cross_account_send_receive_restricted
  service: queue
  resource: queue
  requirement: Queue Cross Account Send Receive Restricted
  scope: queue.queue.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Restrict Cross-Account Queue Send/Receive Access
  rationale: Allowing unrestricted cross-account access to OCI queues can lead to unauthorized data access and potential data leaks. This poses significant security risks, such as data exfiltration and unauthorized operations, which can impact business continuity and compliance with data protection regulations like GDPR and CCPA.
  description: This rule checks that OCI queues are configured to restrict send and receive operations to specific trusted accounts only. To verify, ensure that IAM policies are set to limit access to known and trusted Oracle Cloud Infrastructure tenancies. Remediation involves updating IAM policies to define precise permissions, ensuring that only designated accounts can perform send/receive operations on a queue.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Queue/Tasks/managingqueues.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/iam.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-compliance/
- rule_id: oci.queue.queue.queue_encryption_enabled
  service: queue
  resource: queue
  requirement: Queue Encryption Enabled
  scope: queue.queue.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure OCI Queue Encryption is Enabled
  rationale: Enabling encryption for OCI queues is crucial for protecting sensitive data from unauthorized access and ensuring compliance with data protection regulations. Without encryption, data at rest in queues may be vulnerable to breaches and interception, leading to potential financial loss, reputational damage, and non-compliance with standards like PCI-DSS and GDPR.
  description: This rule checks whether encryption is enabled for Oracle Cloud Infrastructure queues. To verify, ensure that your queue configurations specify encryption settings using Oracle-managed keys or customer-managed keys from Oracle Cloud Infrastructure Vault. Remediation involves configuring encryption settings through the OCI Console or API, ensuring all queues are encrypted to safeguard data integrity and confidentiality.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Queue/Tasks/configuringqueueencryption.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://www.oracle.com/cloud/security/
- rule_id: oci.queue.queue.queue_private_network_only_where_supported_enforced
  service: queue
  resource: queue
  requirement: Queue Private Network Only Where Supported Enforced
  scope: queue.queue.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Enforce Private Network Access for OCI Queues
  rationale: Restricting OCI Queues to operate only within private networks enhances security by preventing unauthorized access from public networks. This reduces the risk of data breaches and supports compliance with frameworks like PCI-DSS and ISO 27001, which mandate secure configurations for sensitive data handling and transmission.
  description: This rule checks that OCI Queues are configured to be accessible only through private networks where supported. It ensures that queues do not allow public network access, which can be a vector for unauthorized access and potential data exfiltration. To remediate, ensure that the queue's network settings are configured to restrict access to internal, private subnets and verify using the OCI Console or API.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/queue/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.database.autonomous_database.encryption_backup_storage_immutability_enabled
  service: database
  resource: autonomous_database
  requirement: Encryption Backup Storage Immutability Enabled
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Autonomous DB Backup Immutability and Encryption
  rationale: Enabling encryption and immutability for backup storage of Oracle Autonomous Databases protects against unauthorized access and data tampering. This is crucial for maintaining data integrity and confidentiality, reducing the risk of data breaches and ensuring compliance with regulations like PCI-DSS and GDPR. Data immutability ensures that backups cannot be altered, providing a reliable audit trail for forensic analysis.
  description: This rule checks whether encryption and immutability are enabled for Autonomous Database backup storage. To verify, navigate to the OCI Console, select the Autonomous Database, and check the Backup Configuration settings for 'Encryption' and 'Immutability'. Ensure encryption is enabled and set an appropriate retention period for immutability. Remediation involves updating backup settings to enforce these configurations via the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://oci.oracle.com/security/dbsecurity.htm
  - CIS OCI Foundations Benchmark v1.1.0, Control 4.1
  - NIST SP 800-53 Rev. 5, Control SC-28
  - PCI-DSS v3.2.1 Requirement 3.5
  - https://www.oracle.com/security/
- rule_id: oci.database.backup.encryption_cmk_key_enabled
  service: database
  resource: backup
  requirement: Encryption CMK Key Enabled
  scope: database.backup.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Database Backups Use Customer-Managed Encryption Keys
  rationale: Using Customer-Managed Keys (CMKs) for encrypting database backups enhances data protection by giving organizations control over key management and rotation. This reduces the risk of unauthorized data access from compromised keys and meets compliance requirements for data sovereignty and privacy regulations such as GDPR and CCPA. Without CMK, organizations rely solely on Oracle's managed keys, which may not align with internal security policies or regulatory demands.
  description: This rule checks if Oracle Cloud Infrastructure (OCI) database backups are encrypted using Customer-Managed Keys (CMKs) instead of Oracle-managed keys. To verify, navigate to the OCI Console, access the Database service, and review the backup encryption settings of your databases. Ensure that CMK is selected as the encryption method. If CMK is not enabled, update the backup configurations to use a previously created CMK in the Vault service. This ensures that encryption complies with your organization's data protection strategy and regulatory requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/databasesecurity.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-benchmark.html
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hipaajournal.com/hipaa-encryption-requirements/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.autonomous_database.encryption_enabled
  service: database
  resource: autonomous_database
  requirement: Encryption Enabled
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Encryption at Rest for Autonomous Databases
  rationale: Encryption at rest for Autonomous Databases is critical to protect sensitive data from unauthorized access and data breaches. It mitigates risks associated with data exposure if storage media are compromised. Compliance with regulations such as PCI-DSS and HIPAA often mandates encryption to safeguard personal and financial information, thereby reducing legal and financial liabilities.
  description: This rule checks that encryption at rest is enabled for Autonomous Databases in Oracle Cloud Infrastructure. OCI automatically encrypts all databases using Oracle-managed keys, ensuring data is securely stored on disk. To verify, ensure that the database is created with encryption enabled by default, as this is a non-configurable setting. For remediation, ensure databases are provisioned in environments where OCIâ€™s automatic encryption is supported, and confirm encryption status via the OCI Console or API.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm#encryption
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- rule_id: oci.database.backup.encryption_tls_min_1_2_enabled
  service: database
  resource: backup
  requirement: Encryption TLS Min 1 2 Enabled
  scope: database.backup.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure TLS 1.2+ for Database Backup Encryption
  rationale: Using TLS 1.2 or higher for database backup encryption is vital to protect data in transit against man-in-the-middle attacks and unauthorized access. Compliance with standards like PCI-DSS and NIST requires secure encryption protocols to safeguard sensitive data and maintain customer trust. Failure to implement strong encryption could lead to data breaches, financial losses, and legal penalties.
  description: This rule checks that Oracle Cloud Infrastructure database backups are encrypted using a TLS version of 1.2 or higher. Verify this setting by reviewing the database service configurations within the OCI Console to ensure they meet the minimum encryption standards. If necessary, update the configuration to enforce TLS 1.2 or higher by navigating to the database backup settings and selecting the appropriate encryption protocol version. Regularly audit and maintain this setting to align with security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/databaseoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-52r2.pdf
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm
- rule_id: oci.database.backup.encryption_key_policy_least_privilege_enabled_enforced
  service: database
  resource: backup
  requirement: Encryption Key Policy Least Privilege Enabled Enforced
  scope: database.backup.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enforce Least Privilege for OCI DB Backup Encryption Keys
  rationale: Ensuring that encryption keys for database backups are governed by a least privilege policy minimizes the risk of unauthorized access, potential data breaches, and helps in maintaining data integrity. This aligns with compliance requirements such as PCI-DSS and HIPAA, which mandate stringent data protection measures to protect sensitive information.
  description: This rule checks if the encryption key policy applied to Oracle Cloud Infrastructure (OCI) database backups enforces the principle of least privilege, which means only authorized users have access to manage encryption keys. Verification involves reviewing key management policies within OCI Key Management Service (KMS) to ensure they restrict permissions appropriately. Remediation includes updating these policies to limit access based on roles, ensuring only necessary personnel can perform key operations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/home.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/
  - https://www.oracle.com/security/cloud-security.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.database.autonomous_database.encryption_key_rotation_enabled
  service: database
  resource: autonomous_database
  requirement: Encryption Key Rotation Enabled
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Encryption Key Rotation for Autonomous Databases
  rationale: Enabling encryption key rotation for Autonomous Databases is critical to maintaining data confidentiality and mitigating the risk of data breaches. Regular key rotation reduces the time window for unauthorized access using compromised keys, thereby enhancing data security. It also helps meet compliance requirements for data protection standards such as PCI-DSS and HIPAA, which mandate regular key rotation to protect sensitive information.
  description: This rule checks whether encryption key rotation is enabled for Oracle Cloud Infrastructure Autonomous Databases. Autonomous Databases should be configured to rotate encryption keys automatically to enhance the security of data at rest. To verify, access the OCI Console, navigate to the Autonomous Database resource, and ensure 'Encryption Key Rotation' is enabled. To remediate, configure the Autonomous Database to use Oracle Key Management for automatic key rotation, which can be done via the OCI Console or API.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbkeymanagement.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://www.oracle.com/security/cloud-security/key-management/
- rule_id: oci.resource_manager.stack.documentation_access_rbac_least_privilege_required
  service: resource_manager
  resource: stack
  requirement: Documentation Access RBAC Least Privilege Required
  scope: resource_manager.stack.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Resource Manager Stack Documentation Access
  rationale: Restricting documentation access to only necessary personnel minimizes the risk of unauthorized information exposure, which can lead to potential misuse or compromise of cloud resources. Least privilege access helps in reducing the attack surface and ensuring compliance with regulatory requirements such as GDPR and ISO 27001.
  description: This rule verifies that access to Oracle Cloud Infrastructure Resource Manager stack documentation is configured with least privilege principles by checking the assigned roles and permissions. Administrators should review and update IAM policies to ensure only essential personnel have documentation access. Remediation involves auditing current access levels, removing unnecessary permissions, and implementing role-based access controls (RBAC) to limit exposure.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ResourceManager/home.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmark/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.resource_manager.stack.documentation_storage_encrypted_and_private
  service: resource_manager
  resource: stack
  requirement: Documentation Storage Encrypted And Private
  scope: resource_manager.stack.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Stack Documentation Storage is Encrypted and Private
  rationale: Encrypting and securing stack documentation storage in OCI is crucial to prevent unauthorized access to sensitive configuration data. Unencrypted or publicly accessible storage can lead to data breaches, compromising system integrity and exposing confidential information, which may result in regulatory non-compliance and financial penalties.
  description: This rule checks that all documentation storage associated with Oracle Cloud Infrastructure Resource Manager stacks is both encrypted and set to private. Encryption at rest should be enabled using OCI's built-in encryption capabilities, and the storage should be configured to prevent public access. To verify, review the storage settings in the OCI console to ensure encryption is enabled and access policies restrict unauthorized access. Remediation involves configuring storage to enable encryption and setting proper access controls.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ResourceManager/Tasks/managingstacks.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.events.rule.ai_services_pipeline_iam_role_least_privileged_enforced
  service: events
  resource: rule
  requirement: Ai Services Pipeline IAM Role Least Privileged Enforced
  scope: events.rule.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for AI Services Pipeline IAM Role
  rationale: Applying the principle of least privilege for IAM roles within AI Services Pipelines minimizes unauthorized access and potential data breaches. Overly permissive roles can lead to exploitation by malicious actors, non-compliance with regulations like PCI-DSS and GDPR, and increased risk of data leakage. Enforcing least privilege aligns with security best practices and helps in protecting sensitive resources and operations.
  description: This rule examines the IAM roles associated with AI Services Pipeline event rules to verify they adhere to the principle of least privilege. It checks for permissions that exceed necessary operational requirements. To ensure compliance, review and adjust the IAM policies tied to these roles, removing any extraneous permissions and adhering to specific job function requirements. Utilize OCI's policy editor and audit logs to refine and verify access levels.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-benchmark/
  - https://www.nist.gov/publications/least-privilege
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/cloud/cloud-infrastructure-best-practices/
- rule_id: oci.events.rule.ai_services_pipeline_kms_encryption_enabled
  service: events
  resource: rule
  requirement: Ai Services Pipeline KMS Encryption Enabled
  scope: events.rule.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable KMS Encryption for AI Services Pipeline Events
  rationale: Enabling KMS encryption for AI Services Pipeline events ensures that sensitive data is protected from unauthorized access and potential breaches. This measure mitigates the risk of data exfiltration and aligns with regulatory requirements such as GDPR, which mandates robust data protection mechanisms. It also helps maintain customer trust and safeguards intellectual property within AI processes.
  description: This rule checks that Oracle Cloud Infrastructure (OCI) AI Services Pipelines are configured to use Key Management Service (KMS) for encrypting events. To verify, ensure that the KMS key is associated with the AI Services Pipeline in the OCI Console under Security Settings. Remediation involves assigning an appropriate KMS key to the pipeline to ensure data is encrypted at rest, thus protecting the integrity and confidentiality of the processed data.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/AI/Concepts/ai-services-security.htm
  - https://www.oracle.com/security/cloud-security/compliance/gdpr/
  - https://csrc.nist.gov/publications/detail/sp/800-57/part-1/rev-5/final
  - https://www.oracle.com/cloud/architecture-cis-oci-security-benchmark/
- rule_id: oci.events.rule.ai_services_pipeline_logging_enabled
  service: events
  resource: rule
  requirement: Ai Services Pipeline Logging Enabled
  scope: events.rule.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure AI Services Pipeline Logging is Enabled
  rationale: Enabling logging for AI Services Pipelines is crucial for maintaining visibility into events and activities, which aids in detecting unauthorized access and anomalies. Without logging, organizations may face challenges in incident response and compliance with standards like NIST and ISO 27001, increasing the risk of data breaches and regulatory penalties.
  description: This rule checks whether logging is enabled for AI Services Pipelines in Oracle Cloud Infrastructure. It verifies that the pipeline's logging configuration is set to capture all necessary events, which can be done through the OCI Console under the AI Services section by ensuring the logging option is activated. Remediation involves navigating to the specific pipeline's settings and enabling detailed logging to capture all operations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/AIServices/Concepts/aiservicesoverview.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmark/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
- rule_id: oci.events.rule.data_pipeline_access_controls_least_privilege_required
  service: events
  resource: rule
  requirement: Data Pipeline Access Controls Least Privilege Required
  scope: events.rule.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for OCI Event Rules in Data Pipelines
  rationale: Implementing least privilege access controls for OCI Event Rules in data pipelines is crucial to minimize the risk of unauthorized access and data breaches. This approach reduces the attack surface by granting only the necessary permissions required for specific tasks, thereby protecting sensitive data and ensuring compliance with regulations like GDPR and PCI-DSS. Failure to adhere to least privilege principles can lead to potential exposure of data and unauthorized actions, posing significant security and business risks.
  description: This rule checks that OCI Event Rules associated with data pipelines are configured with the least privilege principle. Ensure that these rules only permit the necessary actions and resources required for their specific function, avoiding overly broad permissions. To verify, review the IAM policies and the attached rules to ensure they align with the principle of least privilege. Remediation involves adjusting IAM policies and event rule configurations to limit permissions to only what is required for the task, using OCI's fine-grained access control features.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/accesscontrol.htm
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.events.rule.data_pipeline_private_networking_enforced
  service: events
  resource: rule
  requirement: Data Pipeline Private Networking Enforced
  scope: events.rule.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Data Pipeline Uses Private Networking
  rationale: Enforcing private networking for data pipelines reduces the risk of data exposure to unauthorized entities by restricting network access to private IPs. This mitigates threats such as data breaches and unauthorized access, aligning with compliance requirements like GDPR and HIPAA by ensuring data in transit is protected.
  description: This rule checks if data pipelines are configured to use private networking, preventing exposure to the public internet. Ensure that event rules leverage Virtual Cloud Networks (VCNs) and private endpoints. Verify configurations in the OCI Console under Networking and Events, ensuring no public IPs are used. Remediate by updating configurations to utilize private IPs and securing endpoints within a VCN.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
- rule_id: oci.streaming.stream.stream_consumer_auth_required
  service: streaming
  resource: stream
  requirement: Stream Consumer Auth Required
  scope: streaming.stream.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Stream Consumers Require Authentication
  rationale: Requiring authentication for stream consumers is critical to prevent unauthorized access and data exfiltration from streaming resources. Without authentication, malicious actors could intercept or manipulate data streams, leading to potential data breaches and non-compliance with data protection regulations such as GDPR and HIPAA.
  description: This rule checks if authentication is enforced for consumers accessing OCI streaming services. To ensure security, configure the stream to require consumer authentication by setting the 'consumerAuthRequired' parameter to 'true'. Verify this setting via the OCI Console or CLI. Remediation involves updating the stream configuration to enforce authentication, thus safeguarding data integrity and confidentiality.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Concepts/streamingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Tasks/managingstreams.htm#authentication
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
- rule_id: oci.streaming.stream.stream_encryption_enabled
  service: streaming
  resource: stream
  requirement: Stream Encryption Enabled
  scope: streaming.stream.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Encryption at Rest is Enabled for OCI Streams
  rationale: Enabling encryption at rest for OCI Streams is critical to protect sensitive data from unauthorized access and potential breaches. Without encryption, data is vulnerable to exposure if the underlying storage is compromised. This practice is vital for meeting regulatory requirements such as PCI-DSS and GDPR, which mandate strict data protection measures.
  description: This rule verifies that encryption at rest is enabled for Oracle Cloud Infrastructure Streams, ensuring data is encrypted using OCI-managed keys. To comply, navigate to the OCI Console, access the Streaming service, and confirm that the 'Encryption' setting for each stream is set to 'Enabled'. Remediation involves configuring streams to use encryption keys managed by Oracle Key Management service, thereby guaranteeing data confidentiality and integrity.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Tasks/managingstreams.htm#encryption
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://gdpr-info.eu/
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.streaming.stream.stream_private_network_only_where_supported_enforced
  service: streaming
  resource: stream
  requirement: Stream Private Network Only Where Supported Enforced
  scope: streaming.stream.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Enforce Private Network Access for OCI Streaming
  rationale: Restricting OCI Streaming services to private network access reduces exposure to public internet threats, mitigating risks such as data breaches and unauthorized access. This configuration supports compliance with regulations like PCI-DSS and HIPAA, which mandate secure data transmission and access controls. Implementing this rule aligns with best practices for ensuring data integrity and confidentiality in cloud environments.
  description: This rule verifies that OCI Streaming services are configured to permit access only via private networks, where supported. It checks the stream's network configuration to ensure it is not accessible from public endpoints, thereby reducing potential attack vectors. To remediate, configure the stream settings to utilize a Virtual Cloud Network (VCN) with appropriate security lists and Network Security Groups (NSGs) to limit inbound and outbound traffic. Ensure proper use of service gateways for private access to required OCI services.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Concepts/streamingoverview.htm
  - https://www.oracle.com/cloud-native/streaming/pricing/
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networkoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.streaming.stream.streaming_security_stream_consumer_auth_required
  service: streaming
  resource: stream
  requirement: Streaming Security Stream Consumer Auth Required
  scope: streaming.stream.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Stream Consumer Authentication is Enabled
  rationale: Enabling consumer authentication for streams in OCI protects sensitive data from unauthorized access and tampering. Without proper authentication, malicious actors could intercept or manipulate data streams, leading to data breaches, financial loss, and compliance violations, particularly in regulated industries.
  description: This rule checks if all streams have consumer authentication enabled, ensuring that only authorized applications can consume sensitive data. Verify this setting in the OCI Streaming service by navigating to the stream details and checking the 'Consumer Auth Required' setting. Remediation involves enabling authentication by setting the 'Consumer Auth Required' flag to true, which mandates consumers to present valid authentication tokens.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Concepts/streamingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Tasks/streamingmanageaccess.htm
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/security/overview.htm
- rule_id: oci.streaming.stream.streaming_security_stream_encryption_enabled
  service: streaming
  resource: stream
  requirement: Streaming Security Stream Encryption Enabled
  scope: streaming.stream.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Stream Encryption at Rest is Enabled for OCI Streaming
  rationale: Enabling encryption at rest for OCI Streaming is crucial for protecting sensitive data from unauthorized access and data breaches. Without encryption, data stored in streams is vulnerable to exposure, leading to potential financial loss, reputational damage, and non-compliance with regulations such as PCI-DSS and GDPR. Encryption mitigates the risk of data interception and ensures data confidentiality and integrity.
  description: This rule verifies that encryption at rest is enabled for OCI Streaming services, ensuring that data within streams is encrypted using Oracle-managed keys. To verify, check the stream's configuration settings in the OCI Console or via the OCI Command Line Interface (CLI) to confirm that encryption is turned on. If encryption is not enabled, update the stream settings to enable encryption using Oracle's Key Management service for automated key management. This ensures compliance with data protection best practices and regulatory requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Concepts/streamingencryption.htm
  - https://www.oracle.com/security/cloud-compliance/cis-benchmark/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/key-management/
- rule_id: oci.streaming.stream.streaming_security_stream_private_network_only_enforced
  service: streaming
  resource: stream
  requirement: Streaming Security Stream Private Network Only Enforced
  scope: streaming.stream.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Enforce Private Network Access for OCI Streaming Service
  rationale: Restricting OCI Streaming Service access to private networks minimizes exposure to unauthorized entities, reducing the risk of data breaches and unauthorized data access. This approach aligns with compliance requirements by ensuring that sensitive data is not accessible over public networks, thus mitigating potential attack vectors and safeguarding data integrity.
  description: This rule checks whether OCI Streaming Service streams are configured to restrict access to private networks only. It ensures that streams are not exposed to the public internet, which can be achieved by configuring VCN (Virtual Cloud Network) and subnet settings to enforce private access. Remediation involves adjusting network security rules and stream configurations to limit access to designated private IP ranges, enhancing overall security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Tasks/streamingnetworksecurity.htm
  - https://www.oracle.com/security/cis-benchmarks/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/compliance/
- rule_id: oci.identity.user.org_all_accounts_enrolled_in
  service: identity
  resource: user
  requirement: Org All Accounts Enrolled In
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure All Accounts Enrolled in Organizational Management
  rationale: Ensuring all user accounts are enrolled in organizational management is crucial for maintaining centralized oversight and control over access permissions across cloud resources. Without this, organizations risk having unmanaged accounts that could lead to unauthorized access, data breaches, and non-compliance with regulatory standards such as SOC2 and ISO 27001.
  description: This rule verifies that all user accounts within the Oracle Cloud Infrastructure are enrolled in the organization's master account. This ensures that identity and access management policies are consistently applied and monitored. To verify, check the identity console for any user accounts not linked to the organization. Remediation involves enrolling these accounts into the organization to ensure they adhere to centralized policies and controls.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security-best-practices/cloud-security.html
- rule_id: oci.identity.policy.org_block_leave_by_policy
  service: identity
  resource: policy
  requirement: Org Block Leave By Policy
  scope: identity.policy.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Implement Policies to Restrict Unapproved Organizational Changes
  rationale: Restricting unauthorized policy changes in OCI is critical to prevent accidental or malicious alterations that could lead to security breaches, data loss, or non-compliance with regulatory requirements such as NIST and ISO 27001. Unauthorized changes could enable unwanted access, compromising sensitive data and systems, impacting business continuity and trust.
  description: This rule checks for the implementation of policies that prevent unauthorized modifications to OCI Identity and Access Management (IAM) configurations. It ensures that only designated personnel can alter IAM policies, which are crucial for defining access control. To verify, review current IAM policies in the OCI console to ensure they include conditions that limit access to policy management roles. Remediation involves creating or updating IAM policies to specify approved users and groups for policy changes, using 'Allow' and 'Deny' statements appropriately.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-security/identity-and-access-management/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.policy.org_restrict_region_usage_by_policy_where_required
  service: identity
  resource: policy
  requirement: Org Restrict Region Usage By Policy Where Required
  scope: identity.policy.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict Region Usage by Policy for Enhanced Access Control
  rationale: Restricting region usage via policy ensures that resources are only provisioned in authorized geographic locations, mitigating the risk of data sovereignty violations and compliance breaches. Unrestricted region access can lead to unauthorized data distribution, potentially violating regulations such as GDPR or CCPA. By enforcing regional restrictions, organizations can better manage where their data is stored and processed, reducing exposure to legal and security risks.
  description: This rule checks for policies that enforce region restrictions, ensuring that only pre-approved OCI regions are utilized. To verify, review the identity policies in your tenancy and ensure they contain conditions specifying allowed regions. Remediation involves updating existing policies to include location-based conditions using 'where' clauses to restrict resource creation and access to specified regions. This can be done through the OCI Console, CLI, or API.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/policiescreating.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-foundations-benchmark.html
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/cloud/security/
- rule_id: oci.identity.policy.org_scps_enabled
  service: identity
  resource: policy
  requirement: Org Scps Enabled
  scope: identity.policy.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Organizational Security Control Policies (SCPs) are Enabled
  rationale: Enabling Organizational Security Control Policies (SCPs) is crucial for enforcing security governance across all OCI accounts. Without SCPs, there is a significant risk of unauthorized policy changes that can lead to data breaches or non-compliance with industry standards. SCPs help maintain consistent security postures and control over identity and access management, aligning with regulatory requirements such as NIST and ISO 27001.
  description: This rule checks if Organizational SCPs are enabled within OCI to ensure that security policies are consistently applied across all organizational units. SCPs restrict the maximum permissions for member accounts, preventing them from exceeding specified security postures. To verify, navigate to the OCI Console, access the Identity service, and confirm that SCPs are enforced. Enable SCPs by creating or updating policies within the Identity domain. This ensures that security governance is maintained at the organizational level.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/securityoverview.htm
- rule_id: oci.identity.policy.password_policy_lockout_threshold_defined_restricted
  service: identity
  resource: policy
  requirement: Password Policy Lockout Threshold Defined Restricted
  scope: identity.policy.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enforce Password Lockout Threshold for OCI User Accounts
  rationale: Defining a password lockout threshold is crucial to prevent brute force attacks on user accounts, reducing the risk of unauthorized access and data breaches. This measure helps protect sensitive information and aligns with compliance requirements such as PCI-DSS and ISO 27001, ensuring robust identity management and safeguarding enterprise assets.
  description: This rule checks whether a password lockout threshold is configured for user accounts in Oracle Cloud Infrastructure. A properly configured lockout threshold limits the number of failed login attempts, temporarily disabling access to the account to mitigate brute force attacks. To verify, navigate to the OCI Identity Console, check the password policy settings, and ensure the lockout threshold is set to an appropriate value. Remediation involves setting or adjusting the lockout threshold to comply with security policies and industry standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpasswordpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/standard/54534.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_authentication.htm
- rule_id: oci.identity.policy.password_policy_max_age_90_days_restricted
  service: identity
  resource: policy
  requirement: Password Policy Max Age 90 Days Restricted
  scope: identity.policy.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enforce 90-Day Password Expiration Policy for OCI Users
  rationale: Limiting password age to 90 days mitigates risks of credential theft by ensuring passwords are updated regularly. This reduces the attack window for compromised credentials and aligns with compliance standards such as PCI-DSS and NIST SP 800-63. Regular password updates help maintain robust security hygiene and protect sensitive data from unauthorized access.
  description: This rule checks if the password policy for OCI users mandates a maximum password age of 90 days. To ensure compliance, navigate to the OCI Console, go to the Identity and Security section, select Policies, and verify that the password policy configuration includes a max age setting of 90 days or less. If not configured, update the policy settings to enforce this limit. This action reduces the risk of prolonged exposure to compromised credentials.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/access/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63-3.pdf
  - https://www.oracle.com/security-cloud/
- rule_id: oci.identity.policy.password_policy_min_length_14_restricted
  service: identity
  resource: policy
  requirement: Password Policy Min Length 14 Restricted
  scope: identity.policy.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enforce Minimum Password Length of 14 in OCI Policies
  rationale: Ensuring a minimum password length of 14 characters significantly reduces the risk of unauthorized access through brute-force attacks. Short passwords are easier to crack and can lead to data breaches, potentially violating compliance standards like NIST SP 800-63B and ISO 27001. Longer passwords contribute to a more robust security posture, protecting sensitive resources within the OCI environment.
  description: This rule checks whether OCI identity policies enforce a minimum password length of 14 characters. It verifies the configuration of password policies to ensure they meet best practices for password complexity. To comply, navigate to the OCI Console, access the Identity tab, and update the policy settings to enforce a minimum length of 14. This enhances security by making passwords more resistant to attacks while satisfying compliance requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/OCI_CIS_Benchmark_v1.0.pdf
  - NIST SP 800-63B Digital Identity Guidelines
  - ISO/IEC 27001:2013 Information Security Management
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.identity.policy.password_policy_prevent_reuse_last_24_restricted
  service: identity
  resource: policy
  requirement: Password Policy Prevent Reuse Last 24 Restricted
  scope: identity.policy.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enforce Password Reuse Restriction for Last 24 Passwords
  rationale: Preventing users from reusing their last 24 passwords mitigates the risk of compromised credentials being reused, enhances overall security posture, and aligns with best practices for identity and access management. This policy is crucial for organizations handling sensitive information to protect against unauthorized access and meet compliance requirements like PCI-DSS and ISO 27001.
  description: This rule checks that the identity policy is configured to prevent the reuse of the last 24 passwords for user accounts in OCI. It ensures that password history is maintained, reducing the likelihood of password predictability and brute-force attacks. To verify, review the password policy settings in the OCI Console under Identity and Access Management. Remediation involves updating the password policy to enforce a history setting that prohibits the reuse of the last 24 passwords.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm#PasswordPolicy
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.policy.password_policy_require_upper_lower_number_special_restricted
  service: identity
  resource: policy
  requirement: Password Policy Require Upper Lower Number Special Restricted
  scope: identity.policy.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enforce Comprehensive Password Complexity for OCI Policies
  rationale: Ensuring that passwords include upper and lower case letters, numbers, and special characters significantly reduces the risk of unauthorized access due to weak or easily guessable passwords. This complexity requirement helps protect sensitive resources from brute force attacks and adheres to regulatory requirements such as NIST and PCI-DSS, which mandate strong password policies to safeguard user accounts and sensitive data.
  description: This rule checks if password policies in OCI require the inclusion of upper and lower case letters, numbers, and special characters. Administrators should configure password policies to enforce these requirements by navigating to the Identity Console and updating the password policy settings. Remediation involves setting these parameters to true in the password policy configuration to ensure compliance with security best practices and reduce vulnerability to attacks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.identity.api_key.tenant_api_access_keys_root_or_restricted
  service: identity
  resource: api_key
  requirement: Tenant API Access Keys Root Or Restricted
  scope: identity.api_key.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure Tenant API Keys Are Not Assigned to Root
  rationale: Assigning API keys to the root compartment can lead to severe security risks, including unauthorized access and potential data breaches. Such unrestricted access can result in privilege escalation and expose the entire cloud environment to external threats. Compliance with frameworks like NIST and PCI-DSS mandates least privilege access, making it critical to restrict API key usage.
  description: This rule checks whether API keys are assigned to the root compartment or restricted compartments within the OCI identity service. To verify, review the API key assignments in your OCI console and ensure keys are not linked to the root compartment. Remediation involves revoking existing keys from the root compartment and reassigning them to specific users or service accounts with the necessary permissions only.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm#apikeys
  - https://www.oracle.com/security-cloud/best-practices/
  - https://www.pcisecuritystandards.org/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/standard/54534.html
  - https://www.cisecurity.org/benchmark/oracle/
- rule_id: oci.identity.user.tenant_break_glass_accounts_mfa_enforced
  service: identity
  resource: user
  requirement: Tenant Break Glass Accounts MFA Enforced
  scope: identity.user.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Mandate MFA for Tenant Break Glass Accounts
  rationale: Enforcing Multi-Factor Authentication (MFA) for tenant break glass accounts is critical to safeguarding sensitive data and operations in Oracle Cloud Infrastructure (OCI). These accounts have elevated privileges and are targeted by attackers due to their access capabilities. By implementing MFA, organizations reduce the risk of unauthorized access, align with regulatory requirements like PCI-DSS and ISO 27001, and protect against credential theft and account takeover.
  description: This rule checks whether Multi-Factor Authentication (MFA) is enforced for all tenant break glass accounts within OCI. Break glass accounts have the highest level of access and are used in emergency scenarios. To verify, ensure that MFA is enabled for these accounts via the OCI Console under Identity > Users > Authentication settings. Remediation involves enabling MFA, which can be done through the OCI Identity and Access Management service by configuring an MFA device. Regularly audit these accounts to ensure compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/access/managing-user-credentials.htm
  - https://www.oracle.com/security/cloud-security-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.tenant_console_mfa_required_org_wide
  service: identity
  resource: user
  requirement: Tenant Console MFA Required Org Wide
  scope: identity.user.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce MFA for All Users in OCI Console
  rationale: Requiring Multi-Factor Authentication (MFA) for all users accessing the OCI Console significantly mitigates the risk of unauthorized access due to compromised credentials. This practice is essential for protecting sensitive data and resources from unauthorized access and aligns with compliance mandates such as PCI-DSS and ISO 27001, which require robust authentication mechanisms.
  description: This rule verifies if MFA is enabled for all users accessing the OCI Console, ensuring additional security layers. Administrators should configure MFA for all user accounts via the OCI Identity service, which involves setting up a second factor of authentication, like a mobile app or hardware token. To remediate, navigate to the OCI Identity Console, enable MFA for each user, and educate users on the setup and use of MFA devices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingMFA.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.tenant_inactive_user_disable_threshold_configured_restricted
  service: identity
  resource: user
  requirement: Tenant Inactive User Disable Threshold Configured Restricted
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Configure Inactive User Disable Threshold
  rationale: Inactive user accounts pose a significant security risk as they can be exploited by malicious actors to gain unauthorized access to your cloud resources. By setting a threshold to automatically disable inactive users, you minimize the attack surface and comply with security best practices that require timely deactivation of accounts not in use, aligning with regulatory requirements like PCI-DSS and ISO 27001.
  description: This rule checks if a threshold is configured to automatically disable users who have been inactive for a specified period in Oracle Cloud Infrastructure. To verify, review the tenancy settings in the OCI Console under Identity and Access Management to ensure the 'Inactive User Disable Threshold' is set. Remediation involves navigating to the IAM settings and configuring the threshold to an appropriate period, such as 90 days, to maintain security hygiene and mitigate risks associated with dormant accounts.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://cloudsecurityalliance.org/research/artifacts/oracle-cloud-security-practices
- rule_id: oci.identity.policy.tenant_password_policy_compliant_restricted
  service: identity
  resource: policy
  requirement: Tenant Password Policy Compliant Restricted
  scope: identity.policy.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enforce Strong Password Policies for OCI Tenants
  rationale: A robust password policy mitigates the risk of unauthorized access by enforcing complexity and expiration rules. Weak password practices can lead to credential theft, increasing the threat of data breaches and non-compliance with regulations such as PCI-DSS and ISO 27001. Ensuring password policies are aligned with recommended standards helps protect sensitive information and maintain trust.
  description: This rule evaluates whether the password policies within the OCI tenant meet specified security requirements. It checks for parameters such as minimum password length, complexity, history, and expiration settings. To verify compliance, review the password policy configurations in the OCI Console under Identity > Security Settings. Remediation involves adjusting these settings to meet or exceed recommended security standards, ensuring passwords are sufficiently complex and regularly updated.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingsecuritysettings.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/document_library
  - https://csrc.nist.gov/publications/detail/sp/800-63b/final
  - https://www.iso.org/iso-iec-27001-information-security.html
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.identity.identity_provider.tenant_sso_federation_configured_where_supported_restricted
  service: identity
  resource: identity_provider
  requirement: Tenant Sso Federation Configured Where Supported Restricted
  scope: identity.identity_provider.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure SSO Federation Configured for Supported Tenants
  rationale: Configuring Single Sign-On (SSO) federation is crucial for enhancing identity security by centralizing authentication and reducing the risk of credential theft. It helps meet compliance requirements such as NIST and ISO 27001 by ensuring consistent access management practices across services. Failing to configure SSO where supported can lead to fragmented identity management and increased security vulnerabilities.
  description: This rule checks whether SSO federation is configured for identity providers in tenants that support it. To verify, access the OCI Console, navigate to 'Identity' > 'Federation', and ensure that an SSO provider like SAML is properly configured. If not configured, follow the OCI documentation to set up SSO federation, ensuring that user authentication processes are centralized and aligned with organizational security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingfederation.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-63/rev-3/final
  - https://www.oracle.com/security/cloud-security/identity/
  - https://www.iso.org/standard/54533.html
- rule_id: oci.identity.user.anomaly_alert_destinations_enabled
  service: identity
  resource: user
  requirement: Anomaly Alert Destinations Enabled
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enable Anomaly Alert Destinations for OCI Users
  rationale: Enabling anomaly alert destinations for OCI users helps detect and respond to unusual login activities, which is crucial for preventing unauthorized access and potential data breaches. This proactive measure supports compliance with security frameworks such as NIST and ISO 27001, ensuring sensitive data remains protected against evolving threats.
  description: This rule checks whether anomaly alert destinations are configured for users in Oracle Cloud Infrastructure. Anomaly alerts help identify irregular login attempts or patterns that could indicate a compromised account. To verify, ensure that alert policies are set up in the OCI Console under Identity settings, and configure notification channels like email or SMS for real-time alerts. Remediation involves setting up these alert destinations and ensuring they are monitored regularly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/standard/54534.html
  - https://cloud.oracle.com/security-best-practices
  - https://www.oracle.com/security-alerts/
- rule_id: oci.identity.tag_namespace.anomaly_detectors_enabled
  service: identity
  resource: tag_namespace
  requirement: Anomaly Detectors Enabled
  scope: identity.tag_namespace.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enable Anomaly Detectors in OCI Tag Namespaces
  rationale: Enabling anomaly detectors in OCI tag namespaces helps identify unusual activities that could indicate security threats such as unauthorized access or misconfigurations. This is crucial for maintaining the integrity and security of identity and access management settings. Compliance with regulations like PCI-DSS and NIST requires proactive monitoring of security anomalies to protect sensitive data.
  description: This rule checks if anomaly detectors are enabled for tag namespaces in OCI. Anomaly detectors use machine learning to identify deviations from normal activity patterns, which can help prevent unauthorized access and data breaches. To verify, access the OCI Console, navigate to Identity & Security, select Tag Namespaces, and ensure anomaly detection is activated. If not enabled, configure anomaly detectors by following Oracleâ€™s setup guidelines to enhance security monitoring.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/taggingoverview.htm
  - https://www.oracle.com/security-cloud-compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/cloud/cloud-infrastructure-best-practices/
- rule_id: oci.identity.user.anomaly_severity_thresholds_configured
  service: identity
  resource: user
  requirement: Anomaly Severity Thresholds Configured
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Configure User Anomaly Severity Thresholds
  rationale: Proper configuration of anomaly severity thresholds for user activities is crucial to identify and mitigate potential security breaches. It helps in detecting unusual behavior patterns, reducing the risk of unauthorized access, and ensuring compliance with security standards such as NIST and ISO 27001. Failure to configure these thresholds can lead to undetected malicious activities, impacting the organization's data integrity and confidentiality.
  description: This rule checks whether anomaly severity thresholds are configured for user activities in OCI Identity. It ensures that deviations from normal user behavior are appropriately flagged for review. To verify, review the identity settings in the OCI console under 'User Settings' and ensure that thresholds for anomaly severities such as 'High', 'Medium', and 'Low' are defined. Remediation involves configuring these thresholds in line with your organization's risk management policy through the OCI console or API.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://www.nist.gov/publications/sp-800-53-rev-5-security-and-privacy-controls-information-systems-and-organizations
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security-cloud/cloud-security-posture-management/
- rule_id: oci.key_management.vault.hsm_configuration_present
  service: key_management
  resource: vault
  requirement: Hsm Configuration Present
  scope: key_management.vault.configuration_management
  domain: secrets_and_key_management
  subcategory: key_management
  severity: medium
  title: Ensure HSM Configuration is Enabled for OCI Key Vaults
  rationale: Enabling HSM (Hardware Security Module) configuration in Oracle Cloud Infrastructure (OCI) Key Vaults enhances the security of cryptographic keys by storing them in certified hardware devices. This reduces the risk of key compromise from software vulnerabilities and mitigates potential data breaches. Compliance with industry standards, such as PCI-DSS and NIST, often mandates the use of HSMs for key management to ensure high-security assurance levels.
  description: This rule verifies if OCI Key Vaults are configured to use HSMs, which provide a higher level of security for key storage and management. Ensure that all vaults have HSM configuration enabled by checking the 'Management' type setting in the OCI Console or via the OCI CLI/API. To remediate, create or migrate vaults to use HSM-backed key management, ensuring compliance with security policies and regulatory requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keymanagementoverview.htm
  - https://www.oracle.com/security/cloud-security/cspm.html
  - 'PCI-DSS Requirement 3: Protect Stored Cardholder Data'
  - 'NIST SP 800-57 Part 1: Recommendation for Key Management'
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingvaults.htm
  - https://www.oracle.com/security/certifications/
- rule_id: oci.key_management.key.hsm_keys_in_only
  service: key_management
  resource: key
  requirement: Hsm Keys In Only
  scope: key_management.key.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure HSM Keys are Exclusively Created in HSM
  rationale: Using HSM (Hardware Security Module) for key management significantly reduces the risk of unauthorized access to cryptographic keys, thereby enhancing data protection. This practice is critical for businesses that handle sensitive data subject to regulatory requirements such as PCI-DSS, HIPAA, and GDPR, as it mitigates the risk of data breaches and non-compliance penalties.
  description: This rule verifies that all cryptographic keys are created and stored within an HSM, ensuring the highest level of security. To comply, configure your OCI Key Management service to exclusively use HSM-backed keys by selecting the 'HSM' option during key creation. Remediation involves auditing all existing keys and migrating any non-HSM keys to HSM. This can be verified through the OCI Console by reviewing key details in the Key Management service.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keymanagementoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingkeys.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
- rule_id: oci.key_management.vault.hsm_only_approved_endpoints
  service: key_management
  resource: vault
  requirement: Hsm Only Approved Endpoints
  scope: key_management.vault.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: medium
  title: Ensure Vaults Use HSM Only Approved Endpoints
  rationale: Utilizing only approved endpoints for hardware security module (HSM) vaults is crucial to protect sensitive cryptographic keys from unauthorized access and potential breaches. This measure minimizes the risk of exposure to malicious actors and supports compliance with regulations that mandate stringent key management practices, such as PCI-DSS and HIPAA.
  description: This rule verifies that all OCI vaults configured with HSM are set to use only approved endpoints for key management operations. Ensuring this setting requires checking the vault configuration to validate that it is restricted to known, secure endpoints. Remediation involves updating the vault's endpoint configuration to comply with approved lists, utilizing OCI's Console or APIs to enforce endpoint restrictions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/key-management/
  - https://docs.oracle.com/en-us/iaas/Content/security/secure-best-practices.htm
- rule_id: oci.key_management.key.hsm_client_cert_key_length_minimum
  service: key_management
  resource: key
  requirement: Hsm Client Cert Key Length Minimum
  scope: key_management.key.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure HSM Client Certificates Use Minimum Key Length
  rationale: Ensuring that HSM client certificates use a minimum key length is crucial for maintaining strong encryption standards, which protect sensitive data from unauthorized access and potential data breaches. Insufficient key lengths make encryption susceptible to brute force attacks, compromising data integrity and confidentiality. Meeting this requirement is essential for compliance with industry regulations such as PCI-DSS and GDPR, which mandate robust encryption practices.
  description: This rule checks that the key length of HSM client certificates in Oracle Cloud Infrastructure is at least 2048 bits, ensuring strong encryption. Verify the key length by examining the certificate properties in the OCI console under the Key Management service. If the key length is below the required threshold, generate a new certificate with an appropriate key size. Ensuring compliance involves regularly auditing key lengths and updating certificates that do not meet the standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keymanagementoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security.html
  - https://cloud.oracle.com/data-protection
- rule_id: oci.key_management.vault.hsm_client_cert_not_expired
  service: key_management
  resource: vault
  requirement: Hsm Client Cert Not Expired
  scope: key_management.vault.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: medium
  title: Ensure HSM Client Certificate in Vault is Not Expired
  rationale: Expired HSM client certificates can lead to service disruptions, unauthorized access, and potential data breaches. Maintaining valid certificates is crucial for ensuring secure key management operations and meeting compliance requirements such as PCI-DSS and SOC2 which mandate secure cryptographic key management practices.
  description: This rule checks whether the HSM client certificates associated with Oracle Cloud Infrastructure Vault are active and not expired. An expired certificate can prevent secure communication between the vault and the HSM, leading to key management failures. To verify, review the certificate expiration dates in the OCI console under Key Management and renew any expired certificates promptly to maintain secure operations. Regularly update certificate management processes to ensure continuity.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingvaults.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.nist.gov/publications/nist-special-publication-800-57-part-1-revision-5
  - https://www.iso.org/standard/54534.html
  - https://cloud.oracle.com/security-best-practices
- rule_id: oci.key_management.vault.hsm_client_cert_trusted_issuer
  service: key_management
  resource: vault
  requirement: Hsm Client Cert Trusted Issuer
  scope: key_management.vault.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: medium
  title: Ensure HSM Client Cert from Trusted Issuer in OCI Vaults
  rationale: Utilizing certificates from trusted issuers for HSM client authentication mitigates the risk of unauthorized access and data breaches. This practice ensures that only verified and legitimate entities can interact with key management services, protecting sensitive data and maintaining compliance with security standards such as PCI-DSS and ISO 27001.
  description: This rule checks whether the HSM client certificate used in OCI Vaults is issued by a trusted Certificate Authority (CA). Verifying the issuer of HSM client certificates helps to ensure that only authorized entities can establish secure connections to the vault. To remediate, ensure that your HSM client certificates are issued by a CA that is included in your organization's list of trusted issuers, and update the configuration in the OCI console accordingly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keymanagementoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingvaults.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://cloud.oracle.com/en_US/security
- rule_id: oci.key_management.key.secrets_security_cmk_deletion_requires_waiting_period_enabled
  service: key_management
  resource: key
  requirement: Secrets Security CMK Deletion Requires Waiting Period Enabled
  scope: key_management.key.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enforce CMK Deletion Waiting Period in OCI Key Management
  rationale: Enforcing a waiting period for the deletion of Customer Master Keys (CMKs) in OCI mitigates the risk of accidental or malicious data loss by providing a grace period to recover from unintended key deletions. This practice is critical for maintaining data availability and integrity, as unauthorized key deletions can render encrypted data irretrievable. Regulatory frameworks often require such measures to safeguard sensitive data and ensure proper data retention and recovery procedures.
  description: This rule verifies that the deletion of CMKs in OCI Key Management requires a mandatory waiting period. To check compliance, ensure that CMKs have a deletion policy that includes a waiting period of at least 7 days. This can be configured through the OCI Console by navigating to the 'Key Management' section, selecting the CMK, and setting the deletion policy under key settings. Remediation involves updating the CMK policy to include a waiting period if it is not already set.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingkeys.htm#deleting
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.key_management.key.secrets_security_cmk_not_publicly_accessible_enabled
  service: key_management
  resource: key
  requirement: Secrets Security CMK Not Publicly Accessible Enabled
  scope: key_management.key.public_access
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: critical
  title: Ensure Secrets Are Not Publicly Accessible in OCI Key Management
  rationale: Publicly accessible secrets pose a critical risk to data integrity and confidentiality. Unauthorized access to secrets can lead to data breaches, financial loss, and non-compliance with regulations like PCI-DSS and HIPAA. Ensuring secrets are not publicly accessible mitigates these risks and protects sensitive data from being exposed to malicious actors.
  description: This rule checks whether secrets managed by Oracle Cloud Infrastructure's Key Management service are publicly accessible. It ensures that secrets are configured to prevent public access, which could otherwise expose sensitive data. To verify, review the access policies and configurations for each key to ensure they are restricted to only necessary entities. Remediation involves updating the policies to enforce least privilege and ensuring no public endpoints allow access to these keys.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/index.html
  - https://www.nist.gov/cyberframework
  - https://cloud.oracle.com/security
- rule_id: oci.key_management.key.secrets_security_cmk_policy_least_privilege_enabled_enforced
  service: key_management
  resource: key
  requirement: Secrets Security CMK Policy Least Privilege Enabled Enforced
  scope: key_management.key.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce Least Privilege for Secrets Management CMK Policies
  rationale: Enforcing least privilege on CMK policies in OCI reduces the risk of unauthorized access to sensitive secrets. This is crucial for minimizing potential data breaches and ensuring compliance with industry standards such as NIST and PCI-DSS. By limiting access to only necessary permissions, organizations can prevent privilege escalation attacks and protect critical business assets.
  description: This rule checks if least privilege is enforced on Customer Master Key (CMK) policies within OCI's Key Management service. It requires that CMK policies grant the minimum necessary permissions to users or groups, ensuring no excessive or unused permissions are present. To verify, review the CMK policy statements in the OCI Console under Key Management settings and remove any roles or permissions not essential for current operations. Implement role-based access control (RBAC) principles to align with security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/keypolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/iam_security_best_practices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security-cloud-compliance/
- rule_id: oci.key_management.vault.secrets_security_cmk_rotation_enabled
  service: key_management
  resource: vault
  requirement: Secrets Security CMK Rotation Enabled
  scope: key_management.vault.key_rotation
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure CMK Rotation is Enabled for OCI Vault Secrets
  rationale: Enabling Customer Master Key (CMK) rotation for Vault secrets mitigates the risk of key compromise and limits the potential damage from unauthorized access. This practice helps maintain the confidentiality and integrity of sensitive information stored in OCI by regularly updating cryptographic keys as per security best practices. Key rotation is also a critical component in meeting compliance requirements for frameworks such as PCI-DSS and ISO 27001, which mandate regular key updates to protect sensitive data.
  description: This rule checks that Customer Master Key (CMK) rotation is enabled for secrets stored in OCI Vault. The rotation policy should be configured to automatically rotate keys within a defined period, typically every 90 to 365 days, to minimize potential exposure due to key compromise. To verify, access the OCI Console, navigate to the Vault service, and check the key management settings for automatic rotation. To enable rotation, modify the key policy to specify the desired rotation interval. Regularly review and adjust the rotation schedule as per organizational security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingkeys.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practice.htm
- rule_id: oci.key_management.vault.encryption_cmek_enabled
  service: key_management
  resource: vault
  requirement: Encryption Cmek Enabled
  scope: key_management.vault.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Encryption with Customer-Managed Keys for Vaults
  rationale: Using customer-managed encryption keys (CMEK) for Oracle Cloud Infrastructure vaults enhances control over key lifecycle management and access policies. This approach mitigates risks associated with unauthorized data access and ensures compliance with regulatory requirements such as GDPR, which mandates strict data protection measures. Additionally, it helps organizations meet stringent industry standards by providing a robust encryption strategy.
  description: This security rule verifies that Oracle Cloud Infrastructure vaults are configured to use customer-managed encryption keys, rather than Oracle-managed keys, for securing data at rest. To ensure compliance, check the Key Management service settings to confirm that the vault is associated with a customer-managed key. If not, update the vault configuration to use a key from your Key Management service, ensuring you have full control over the encryption keys. This configuration strengthens data protection and aligns with best practices for data privacy.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingvaults.htm
  - CIS OCI Benchmark v1.0 - Section 3.2
  - NIST SP 800-57 Part 1 - Key Management Guidelines
  - PCI-DSS Requirement 3.5 - Protect Encryption Keys
  - https://cloud.oracle.com/en_US/security/cspm-best-practices
  - ISO 27001:2013 - A.10.1 Cryptographic Controls
- rule_id: oci.key_management.vault.tls_min_1_2_enabled
  service: key_management
  resource: vault
  requirement: TLS Min 1 2 Enabled
  scope: key_management.vault.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure TLS 1.2 or Higher Is Enabled for KMS Vaults
  rationale: Enabling TLS 1.2 or higher for Key Management Service (KMS) vaults ensures strong encryption protocols are used during data transmission, protecting sensitive key material from interception and unauthorized access. Failure to use modern TLS versions increases the risk of exploiting deprecated encryption methods, potentially leading to data breaches and non-compliance with standards like PCI-DSS and HIPAA.
  description: This rule checks that all Oracle Cloud Infrastructure Key Management Service vaults have TLS 1.2 or higher enabled. To verify, examine the configuration settings of each vault to ensure they support only TLS 1.2 or newer versions. Remediation involves updating the vault settings in the OCI Console to disable any older TLS versions that may be enabled. Ensure your client applications are also compatible with the newer TLS version to maintain secure communications.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingvaults.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-52r2.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm#security_control_2
  - https://www.oracle.com/security-alerts/
- rule_id: oci.key_management.key.secrets_security_secret_cmk_enabled
  service: key_management
  resource: key
  requirement: Secrets Security Secret CMK Enabled
  scope: key_management.key.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure CMK is Enabled for Secrets in Key Management
  rationale: Enabling Customer Master Keys (CMK) for secrets is crucial for maintaining data privacy and integrity. Without CMK, secrets stored in OCI may be vulnerable to unauthorized access, leading to potential data breaches and non-compliance with industry regulations such as PCI-DSS and GDPR. Utilizing CMK enhances encryption capabilities, thus mitigating risks associated with data exposure.
  description: This rule checks that secrets within OCI Key Management are encrypted with Customer Master Keys (CMK). To verify, ensure that each secret is associated with an active CMK within the OCI console. Remediation involves configuring secrets to use CMK by selecting an existing key or creating a new one in the Key Management service. This ensures that all secrets are encrypted using a secure, customer-managed key, enhancing data protection.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/security-best-practices.htm
- rule_id: oci.key_management.key.secrets_security_secret_no_plaintext_exposed_tags
  service: key_management
  resource: key
  requirement: Secrets Security Secret No Plaintext Exposed Tags
  scope: key_management.key.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: critical
  title: Prevent Exposure of Plaintext Secrets in OCI Tags
  rationale: Exposing plaintext secrets in OCI tags poses significant security risks, including unauthorized access to sensitive data and potential data breaches. It can lead to non-compliance with standards such as PCI-DSS, which mandates the protection of cardholder data, and NIST requirements for the confidentiality of information. Furthermore, it elevates the threat of insider attacks and data leaks, impacting business continuity and reputation.
  description: This rule checks OCI Key Management configurations to ensure that no sensitive information, such as secrets, is stored in plaintext within resource tags. Tags are often used for organization and automation, but storing confidential data in plaintext can lead to unintended exposure. To verify compliance, audit your tag values for sensitive data and replace them with secure identifiers or encrypted references. Remediate by using Oracle Cloud's native encryption tools to manage secrets securely and ensure tagging policies prohibit plaintext secrets.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keysoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/OCI_CIS_Benchmark_v1.2.0.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/bestpractices.htm
  - https://www.oracle.com/security/cloud-security/key-management/
- rule_id: oci.key_management.key.secrets_security_secret_rotation_configured_where_applicable
  service: key_management
  resource: key
  requirement: Secrets Security Secret Rotation Configured Where Applicable
  scope: key_management.key.key_rotation
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure Secret Rotation Configured for OCI Key Management
  rationale: Regular rotation of secrets is crucial to reduce the risk of unauthorized access due to leaked credentials or keys. It mitigates the impact of compromised secrets by limiting their validity period, thus enhancing overall security posture and ensuring compliance with regulatory frameworks such as PCI-DSS and ISO 27001.
  description: This rule checks if secret rotation is configured for OCI Secret Management. Secrets should be set to rotate automatically within a defined period based on organizational policies. To verify, navigate to the OCI console, access Secret Management, and review the rotation policies for each secret. Remediation involves setting up a rotation schedule by defining a rotation interval and creating a rotation policy that meets security requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/rotatingsecrets.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://docs.oracle.com/en-us/iaas/Content/security/overview.htm#pci
  - https://www.oracle.com/security-cloud-compliance/
- rule_id: oci.key_management.key.secrets_security_store_access_rbac_least_privilege_required
  service: key_management
  resource: key
  requirement: Secrets Security Store Access RBAC Least Privilege Required
  scope: key_management.key.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce Least Privilege for Secrets Access in OCI Key Management
  rationale: Implementing least privilege access for the Secrets Security Store in OCI minimizes the risk of unauthorized data exposure and potential breaches. This is crucial for maintaining the confidentiality and integrity of sensitive information, aligning with compliance requirements such as PCI-DSS and GDPR, and protecting against insider threats and privilege escalation attacks.
  description: This rule checks if access to the Secrets Security Store in OCI is restricted to the minimum necessary privileges. It ensures that only authorized users and applications with a legitimate need can access or manage secrets. Verify by reviewing the IAM policies and roles associated with key management resources to ensure they adhere to the principle of least privilege. Remediate by adjusting policies to limit permissions and regularly audit access logs to detect potential abuses.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
- rule_id: oci.key_management.vault.secrets_security_store_kms_encryption_enabled
  service: key_management
  resource: vault
  requirement: Secrets Security Store KMS Encryption Enabled
  scope: key_management.vault.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable KMS Encryption for Secrets in OCI Vault
  rationale: Enabling KMS encryption for secrets stored in OCI Vault ensures that sensitive data is protected using robust cryptographic methods. This configuration guards against unauthorized access and potential data breaches, aligning with compliance mandates such as PCI-DSS and HIPAA that require encryption of sensitive information at rest. Failure to enable KMS encryption can lead to substantial financial and reputational damage in the event of data exposure.
  description: This rule checks if the Secrets within an OCI Vault are encrypted using the Key Management Service (KMS). To verify, ensure that the KMS is enabled for your Vault by navigating to the OCI Console, selecting the Vault, and confirming that the 'KMS Encryption' setting is active. Remediation involves enabling KMS encryption for existing Vaults and ensuring all new secrets are created with this setting enabled. This action provides enhanced security for data at rest and ensures compliance with industry standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingvaults.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.key_management.vault.secrets_security_store_rotation_enabled_for_rotatable
  service: key_management
  resource: vault
  requirement: Secrets Security Store Rotation Enabled For Rotatable
  scope: key_management.vault.key_rotation
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure Secret Rotation is Enabled for OCI Vaults
  rationale: Enabling secret rotation in OCI Vaults is crucial for mitigating the risk of credential exposure and unauthorized access. Regularly rotated secrets reduce the window of opportunity for attackers to exploit compromised credentials, thus enhancing data protection and compliance with security standards such as PCI-DSS and NIST SP 800-57. Organizations can prevent data breaches and maintain trust by ensuring that secrets are consistently updated.
  description: This rule checks if secret rotation is enabled in Oracle Cloud Infrastructure Vault where secrets are stored. The rotation policy should be configured to automatically update secrets at regular intervals, minimizing manual intervention and the risk of human error. To verify, access the OCI console, navigate to the Vault service, and review the rotation settings for secrets. If rotation is not enabled, configure the rotation policy to automate the update process, ensuring compliance with best practices and reducing security risks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingsecrets.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://cloudsecurityalliance.org/research/guidance/
- rule_id: oci.cloud_guard.target.assessment_policy_store_encrypted
  service: cloud_guard
  resource: target
  requirement: Assessment Policy Store Encrypted
  scope: cloud_guard.target.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Assessment Policy Store is Encrypted
  rationale: Encrypting the Assessment Policy Store is crucial to protect sensitive policy data from unauthorized access and potential data breaches. This measure helps mitigate risks associated with data exposure and supports compliance with regulatory standards that mandate data protection, such as PCI-DSS and GDPR. Failure to encrypt data at rest can lead to significant financial losses and reputational damage in the event of a security incident.
  description: This rule checks that the assessment policy store within OCI Cloud Guard is encrypted to safeguard data integrity and confidentiality. It requires configuring the policy store to use encryption keys managed by Oracle or customer-managed keys for enhanced security control. Verify encryption settings in the OCI console under Cloud Guard configurations. Remediation involves enabling encryption at rest for the policy store if not already configured, ensuring compliance with Oracle's security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Concepts/cloudguardoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
  - https://cloudsecurityalliance.org/
- rule_id: oci.cloud_guard.target.assessment_roles_least_privilege_required
  service: cloud_guard
  resource: target
  requirement: Assessment Roles Least Privilege Required
  scope: cloud_guard.target.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Cloud Guard Target Assessment Roles
  rationale: Implementing least privilege for assessment roles in Cloud Guard minimizes the risk of unauthorized access and potential data breaches. Over-permissioned roles can lead to data exposure, non-compliance with standards like PCI-DSS and ISO 27001, and increased vulnerability to insider threats. Ensuring roles are aligned with least privilege principles safeguards critical assets and maintains trust with stakeholders.
  description: This rule checks whether assessment roles associated with Cloud Guard targets adhere to the principle of least privilege. Administrators should review assigned roles for each Cloud Guard target and ensure they only have necessary permissions. Remediation involves adjusting IAM policies to restrict permissions to the minimum required for role-specific functions. Verification can be done by auditing IAM policies and cross-referencing them with role responsibilities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/home.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.waf.web_app_firewall.ip_set_cidrs_valid_and_minimized
  service: waf
  resource: web_app_firewall
  requirement: Ip Set Cidrs Valid And Minimized
  scope: waf.web_app_firewall.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Validate and Optimize IP Set CIDRs in WAF
  rationale: Ensuring that IP set CIDRs in Web Application Firewall (WAF) are valid and minimized reduces the potential attack surface and prevents unauthorized access. Invalid or overly broad CIDR ranges can lead to unnecessary exposure of applications, increasing the risk of cyberattacks and potential non-compliance with regulatory requirements like PCI-DSS and GDPR.
  description: This rule checks that all CIDR ranges defined in WAF IP sets are valid and minimized to the least permissive configuration necessary. By verifying that CIDRs are precise, organizations can limit access to trusted IPs only, aligning with the principle of least privilege. To remediate, review the configured IP sets in the OCI console, ensuring they use the narrowest range possible while maintaining functionality, and update any overly broad entries.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/wafusing.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/security-alerts/
  - https://cloud.oracle.com/networking/features
- rule_id: oci.waf.web_app_firewall.ip_set_cross_account_sharing_restricted
  service: waf
  resource: web_app_firewall
  requirement: Ip Set Cross Account Sharing Restricted
  scope: waf.web_app_firewall.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Restrict Cross-Account Sharing of IP Sets in OCI WAF
  rationale: Cross-account sharing of IP sets in the OCI Web Application Firewall (WAF) can expose sensitive configurations to unauthorized accounts, leading to potential misuse or unauthorized access. Restricting this practice minimizes the risk of data breaches and ensures that only trusted accounts have access to critical security settings, supporting compliance with security frameworks such as NIST and PCI-DSS.
  description: This rule checks if IP sets within the OCI Web Application Firewall are being shared across accounts. Cross-account sharing can lead to unintended exposure of IP allowlists or blocklists. To verify, ensure that IP sets are restricted to the owning account and not shared with external accounts. Remediation involves reviewing the IP set configurations and adjusting the access settings to prevent sharing with unauthorized accounts. This enhances the security posture by maintaining strict control over network access controls.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/wafipset.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_wa_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.pcisecuritystandards.org/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.waf.web_app_firewall.ip_set_not_empty
  service: waf
  resource: web_app_firewall
  requirement: Ip Set Not Empty
  scope: waf.web_app_firewall.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Web App Firewall IP Set Must Be Configured
  rationale: An empty IP set in a Web Application Firewall (WAF) configuration can lead to inadequate filtering of malicious traffic, potentially exposing applications to attacks such as DDoS and unauthorized access. Ensuring IP sets are configured helps to enforce security policies and comply with regulatory requirements like PCI-DSS, which mandates proper access control mechanisms.
  description: This rule checks whether the IP set associated with a WAF is non-empty, ensuring that traffic filtering rules are actively enforced. To verify, access the WAF configuration in the OCI console and review the IP set for any missing entries. If empty, update the IP set with relevant IP addresses or ranges to restrict access appropriately. Regularly audit and update the IP set to reflect changes in your network security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/using_waf.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/cloud/cloud-security/
- rule_id: oci.waf.protection_rule.ip_set_used_by_at_least_one_rule
  service: waf
  resource: protection_rule
  requirement: Ip Set Used By At Least One Rule
  scope: waf.protection_rule.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure IP Set Application in OCI WAF Protection Rules
  rationale: Properly applying IP sets to WAF protection rules is crucial for accurately filtering and monitoring incoming traffic based on predefined IP addresses or ranges. This practice helps mitigate unauthorized access and potential threats by ensuring that only trusted IPs are permitted, aligning with compliance requirements and reducing the risk of security breaches.
  description: This rule verifies that each IP set configured in Oracle Cloud Infrastructure's Web Application Firewall (WAF) is applied to at least one protection rule. An IP set that is not associated with any rules is ineffective and does not contribute to security monitoring. To check and remediate, review WAF rule configurations and ensure that each IP set is actively used by linking it to relevant protection rules. This ensures that your IP-based filtering policies are consistently enforced.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/managingwaf.htm
  - https://www.oracle.com/cloud/cloud-security/network-security.html
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-41r1.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.waf.protection_rule.rule_group_no_permit_all
  service: waf
  resource: protection_rule
  requirement: Rule Group No Permit All
  scope: waf.protection_rule.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure WAF Rule Group Does Not Allow 'Permit All' Action
  rationale: Permit All actions in WAF rule groups can expose your applications to all types of web attacks, including SQL injection and cross-site scripting. This can lead to data breaches, loss of customer trust, and regulatory non-compliance, particularly under standards like PCI-DSS, which require robust access controls.
  description: This rule checks that your Oracle Cloud Infrastructure Web Application Firewall (WAF) protection rule groups do not have any rules configured with a 'Permit All' action. Such configurations can bypass security measures, allowing potentially malicious traffic through. To verify, review your WAF rule groups in the OCI Console and ensure that no rules are set to 'Permit All'. Remediation involves updating these rules to more restrictive settings, such as 'Detect' or 'Block'.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Concepts/wafoverview.htm
  - https://www.oracle.com/security-alerts/
  - 'NIST SP 800-53: AC-3 Access Enforcement'
  - 'PCI DSS v3.2.1: Requirement 1.2.1'
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v3-0-1/
- rule_id: oci.waf.protection_rule.rule_group_references_only_approved_managed_used
  service: waf
  resource: protection_rule
  requirement: Rule Group References Only Approved Managed Used
  scope: waf.protection_rule.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Use Approved Managed Rule Groups for WAF Protection
  rationale: Using only approved managed rule groups for Oracle Cloud Infrastructure (OCI) Web Application Firewall (WAF) ensures that the web applications are protected against known vulnerabilities and attack patterns. This reduces the risk of unauthorized access and data breaches, thereby protecting sensitive business data and maintaining compliance with security standards such as PCI-DSS and ISO 27001. Unapproved rule groups might not have been vetted for efficacy and security, posing a potential risk to the application's integrity and availability.
  description: This rule verifies that only approved managed rule groups are referenced in the OCI WAF protection settings. Managed rule groups are curated by Oracle and contain pre-configured rules that address common web vulnerabilities such as SQL injection and cross-site scripting. To comply, review the WAF protection rules and ensure that only those from an approved list are utilized. If an unapproved rule group is in use, switch to a vetted managed rule group from Oracle's offerings or submit the group for approval through your security governance process.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/wafprotectionrules.htm
  - https://www.oracle.com/security-alerts/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.waf.protection_rule.rule_group_unique_priorities
  service: waf
  resource: protection_rule
  requirement: Rule Group Unique Priorities
  scope: waf.protection_rule.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Unique Priorities for WAF Protection Rule Groups
  rationale: Unique priorities in WAF protection rule groups prevent rule conflicts and ensure that the intended security policies are applied correctly. Misconfigured priorities can lead to unintended rule processing order, potentially allowing malicious traffic to bypass certain protections, posing a security risk to web applications. Proper configuration aligns with compliance requirements such as PCI-DSS and enhances overall security posture.
  description: This check ensures that each protection rule within a WAF rule group in OCI has a unique priority setting. When multiple rules have the same priority, it can result in unpredictable behavior and ineffective application of security controls. To verify, review the WAF rule group settings in the OCI console or via API to confirm each rule has a distinct priority. Remediation involves adjusting rule priorities so that each is unique, ensuring clear and predictable rule execution.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/wafprotectionrules.htm
  - https://www.oracle.com/security-cloud-compliance/cis-oci-benchmark-v1.0.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/cloud/security/
  - https://www.nist.gov/document-190
- rule_id: oci.waf.web_app_firewall.rule_group_visibility_config_enabled
  service: waf
  resource: web_app_firewall
  requirement: Rule Group Visibility Config Enabled
  scope: waf.web_app_firewall.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure WAF Rule Group Visibility Config is Enabled
  rationale: Enabling the Rule Group Visibility Config in Oracle Cloud Infrastructure's Web Application Firewall (WAF) allows for enhanced monitoring and tracking of web traffic, helping to identify and mitigate potential threats. This configuration aids in maintaining a robust security posture by ensuring that all rule group activities are visible, which is critical for audit trails and compliance with regulatory security standards.
  description: This rule checks if the Rule Group Visibility Config is enabled for the WAF in OCI. By enabling this feature, administrators can gain insights into the effectiveness and operation of WAF rule groups. To verify, navigate to the WAF service, select the web application firewall, and ensure the visibility configuration is turned on. If not enabled, access the WAF settings and activate the visibility feature to enhance monitoring and threat detection capabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/managingwaf.htm
  - CIS OCI Foundations Benchmark v1.0.0
  - NIST SP 800-53 Rev. 5 - AU-12 Audit Generation
  - 'PCI-DSS Requirement 10: Track and monitor all access to network resources and cardholder data'
  - ISO/IEC 27001:2013 - A.12.4 Logging and monitoring
- rule_id: oci.waf.web_app_firewall.regex_set_no_overly_broad_patterns
  service: waf
  resource: web_app_firewall
  requirement: Regex Set No Overly Broad Patterns
  scope: waf.web_app_firewall.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Regex Patterns in WAF Are Not Overly Broad
  rationale: Overly broad regex patterns in Web Application Firewall (WAF) can lead to unintended blocking of legitimate traffic, resulting in business disruptions and potential revenue loss. This misconfiguration may also expose the application to security vulnerabilities by failing to appropriately narrow down attack vectors. Compliance with security standards like PCI-DSS and ISO 27001 requires precise access control measures to protect sensitive data.
  description: This rule checks for the presence of overly broad regex patterns in the Oracle Cloud Infrastructure Web Application Firewall (WAF). Overly broad patterns can inadvertently match legitimate requests, causing disruptions or false positives. To verify, review the regex patterns in the WAF configuration to ensure they are specific and targeted. Remediation involves refining these patterns to accurately match only expected malicious traffic, thereby improving the accuracy of the WAF's protective measures.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/usingwaf.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.waf.web_app_firewall.regex_set_not_empty
  service: waf
  resource: web_app_firewall
  requirement: Regex Set Not Empty
  scope: waf.web_app_firewall.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Regex Set is Configured in Web App Firewall
  rationale: An empty Regex Set in a Web Application Firewall (WAF) can expose applications to injection attacks and unauthorized data access. By ensuring the Regex Set is not empty, you can filter unwanted requests and protect against common web vulnerabilities. This helps in maintaining compliance with security standards and protecting critical business data from exploitation.
  description: This rule checks if the Regex Set in an OCI Web Application Firewall is configured with patterns. Without a populated Regex Set, the WAF cannot effectively filter malicious traffic. To verify, navigate to the OCI Console, select the WAF, and ensure the Regex Set contains relevant patterns for your application. If empty, populate it with patterns suited to your web applicationâ€™s security needs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/managingwafs.htm
  - CIS Oracle Cloud Infrastructure Foundations Benchmark v1.0.0 - Section 4.1
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/publications/nist-special-publication-800-53-revision-5
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://owasp.org/www-project-top-ten/
- rule_id: oci.waf.protection_rule.regex_set_used_by_at_least_one_rule
  service: waf
  resource: protection_rule
  requirement: Regex Set Used By At Least One Rule
  scope: waf.protection_rule.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Regex Set Utilization in WAF Protection Rules
  rationale: Proper usage of regex sets in Web Application Firewall (WAF) protection rules is crucial for optimizing pattern matching efficiency, which helps in accurately identifying and mitigating malicious traffic. Failure to utilize regex sets can lead to inadequate threat detection, increasing the risk of successful attacks and potential data breaches, impacting business continuity and compliance with data protection regulations.
  description: This rule checks whether every regex set defined within the OCI WAF is actively used by at least one protection rule. Regex sets are collections of regular expressions used to detect patterns in web requests that match known attack signatures. To verify, ensure that each regex set is associated with a protection rule in the WAF configuration. Remediation involves reviewing unused regex sets and integrating them into relevant protection rules where applicable, or removing obsolete sets to maintain an optimized security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/wafprotectionrules.htm
  - https://www.oracle.com/security/cloud-security/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.waf.web_app_firewall.waf_block_actions_not_count_only
  service: waf
  resource: web_app_firewall
  requirement: Waf Block Actions Not Count Only
  scope: waf.web_app_firewall.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure WAF Block Actions Are Not Set to Count Only
  rationale: Configuring the Web Application Firewall (WAF) to block rather than just count malicious traffic is crucial for preventing potential threats from reaching applications. This setting helps mitigate risks such as data breaches and service disruptions, which can have severe financial and reputational impacts. Compliance with industry standards like PCI-DSS often requires active blocking of malicious activity, enhancing overall security posture.
  description: This rule checks that the WAF is configured to perform block actions rather than merely count suspicious requests. To verify, review the WAF policy settings in the OCI console and ensure block actions are enabled for applicable rules. If set to count only, modify the WAF policy to enforce blocking of identified threats. This adjustment helps protect applications from unauthorized access and potential exploits.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/wafconfiguring.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
- rule_id: oci.waf.web_app_firewall.waf_ip_rate_limit_rules_configured
  service: waf
  resource: web_app_firewall
  requirement: Waf Ip Rate Limit Rules Configured
  scope: waf.web_app_firewall.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Configure WAF IP Rate Limit Rules for Enhanced Security
  rationale: Configuring IP rate limit rules in the Web Application Firewall (WAF) is crucial to mitigate the risk of Denial of Service (DoS) attacks and to ensure the availability of web applications. By setting rate limits, businesses can protect against excessive requests from malicious sources, thus maintaining the integrity and performance of their online services. This is also important for meeting compliance requirements that mandate the protection of network resources.
  description: This rule checks if IP rate limit rules are configured in the OCI Web Application Firewall. IP rate limiting is a security measure that restricts the number of requests from a single IP address within a specified time frame. To verify, navigate to the WAF settings in the OCI Console and ensure that rate limit rules are defined and appropriately set. Remediation involves creating or adjusting these rules to align with traffic patterns and security policies, ensuring that potentially harmful request rates are effectively blocked.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/wafsettinguprule.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.waf.web_app_firewall.waf_logging_enabled
  service: waf
  resource: web_app_firewall
  requirement: Waf Logging Enabled
  scope: waf.web_app_firewall.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: WAF Logging Configuration and Monitoring
  rationale: Enabling WAF logging is crucial for monitoring and analyzing web traffic, detecting malicious activities, and maintaining a secure environment. Without logging, security teams lack visibility into potential threat vectors, increasing the risk of undetected attacks and non-compliance with regulations like PCI-DSS and ISO 27001.
  description: This rule checks if logging is enabled for the Oracle Cloud Infrastructure Web Application Firewall (WAF). Logging captures detailed records of web requests, which are essential for forensic analysis and incident response. To verify, ensure that the WAF configuration in the OCI Console has logging enabled and directed to an appropriate OCI Logging service. Remediation involves navigating to the WAF settings and activating the logging option, ensuring logs are stored securely and retained according to compliance requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/waflogging.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/security/secure-by-design.htm
- rule_id: oci.waf.web_app_firewall.waf_managed_rule_sets_enabled
  service: waf
  resource: web_app_firewall
  requirement: Waf Managed Rule Sets Enabled
  scope: waf.web_app_firewall.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure WAF Managed Rule Sets Are Enabled
  rationale: Enabling WAF Managed Rule Sets is crucial for protecting web applications from common threats such as SQL injection and cross-site scripting (XSS). These rule sets help mitigate the risk of data breaches and unauthorized access, thus safeguarding sensitive business data and maintaining compliance with security standards such as PCI-DSS and ISO 27001.
  description: This rule verifies that Managed Rule Sets are enabled on Oracle Cloud Infrastructure's Web Application Firewall (WAF). Managed Rule Sets provide pre-configured rules to detect and block malicious web traffic, thereby enhancing the security posture of web applications. To verify, check the WAF settings in the OCI Console and ensure that Managed Rule Sets are active. If not enabled, navigate to the WAF configuration and activate the necessary rule sets to protect against known vulnerabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Concepts/managedrulesets.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- rule_id: oci.waf.web_app_firewall.waf_web_acl_attached_to_cdn
  service: waf
  resource: web_app_firewall
  requirement: Waf Web ACL Attached To Cdn
  scope: waf.web_app_firewall.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure WAF Web ACL is Attached to CDN for Enhanced Security
  rationale: Attaching a Web Application Firewall (WAF) Web ACL to a CDN is crucial for protecting web applications from common threats such as SQL injection, cross-site scripting, and DDoS attacks. This setup enhances the security posture by filtering malicious traffic at the edge, minimizing the risk of unauthorized access and ensuring compliance with security standards like PCI-DSS and ISO 27001. It also helps in maintaining the integrity and availability of web services, which is vital for business continuity.
  description: This rule checks if a WAF Web ACL is properly attached to a CDN within OCI. Configuration requires specifying the WAF policy in the OCI console, ensuring the web ACL is associated with the CDN endpoint. Verification involves reviewing the WAF and CDN configurations to confirm the association. To remediate, navigate to the OCI WAF settings, and attach the appropriate Web ACL to the desired CDN endpoint. This setup helps in preemptively blocking malicious traffic before it reaches the application layer.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/wafconfiguring.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
- rule_id: oci.artifacts.container_repository.registry_replication_cross_region_encrypted
  service: artifacts
  resource: container_repository
  requirement: Registry Replication Cross Region Encrypted
  scope: artifacts.container_repository.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Cross-Region Container Repo Replication is Encrypted
  rationale: Encrypting cross-region replication of container repositories in OCI ensures data protection and privacy compliance. Without encryption, sensitive data could be exposed during transit, leading to potential data breaches and non-compliance with regulations such as GDPR and HIPAA. Encryption mitigates risks of unauthorized access and data interception, safeguarding business assets and customer trust.
  description: This rule checks if the replication of container repositories across OCI regions is encrypted. Ensure that all cross-region replication configurations in OCI Artifacts use encryption to protect data in transit. Verify this by navigating to the OCI Console, selecting 'Artifacts', and reviewing the 'Container Repository' settings for encryption options in cross-region replication. To remediate, enable encryption for cross-region data transfers in the repository settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Registry/Tasks/registryreplication.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm#Encryption
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.artifacts.container_repository.registry_replication_destinations_least_privilege_required
  service: artifacts
  resource: container_repository
  requirement: Registry Replication Destinations Least Privilege Required
  scope: artifacts.container_repository.replication
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: high
  title: Ensure Least Privilege for Registry Replication Destinations
  rationale: Applying the principle of least privilege to registry replication destinations minimizes the risk of unauthorized data access or manipulation. This is crucial for protecting sensitive information stored in container repositories and maintaining compliance with regulations such as PCI-DSS and HIPAA. Misconfigured permissions can lead to data breaches, intellectual property theft, and significant financial and reputational damage.
  description: This rule checks that only the necessary permissions are granted to registry replication destinations within OCI container repositories. Administrators should regularly review and adjust permissions to align with the least privilege principle. It is crucial to verify that access policies do not exceed the requirements for replication tasks. Remediation involves auditing existing IAM policies and roles, ensuring they are appropriately scoped, and removing any excess privileges.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Registry/Concepts/registryoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/document/nist-sp-800-53r5pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.artifacts.container_repository.registry_image_scanning_enabled
  service: artifacts
  resource: container_repository
  requirement: Registry Image Scanning Enabled
  scope: artifacts.container_repository.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enable Registry Image Scanning in Container Repositories
  rationale: Enabling image scanning for container repositories is crucial to identify vulnerabilities in container images before deployment. This proactive measure helps mitigate risks associated with deploying insecure containers, which could lead to unauthorized access, data breaches, or service disruption. Compliance with regulations such as PCI-DSS and NIST requires organizations to manage and mitigate vulnerabilities within their software environments.
  description: This rule checks if image scanning is enabled for container repositories in OCI. Image scanning inspects container images for known vulnerabilities before they are deployed in Oracle Cloud Infrastructure. To verify, navigate to the OCI Console, access the 'Artifacts' section, and ensure that 'Image Scanning' is enabled for each repository. Remediation involves enabling automatic image scanning through the OCI Console under the 'Security' settings for each repository, ensuring that newly pushed images are scanned for vulnerabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Registry/Tasks/registryusingimagescanning.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://csrc.nist.gov/publications/detail/sp/800-190/final
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-190.pdf
  - https://www.oracle.com/cloud/security/
- rule_id: oci.artifacts.container_repository.registry_immutable_tags_or_signing_enforced
  service: artifacts
  resource: container_repository
  requirement: Registry Immutable Tags Or Signing Enforced
  scope: artifacts.container_repository.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enforce Immutable Tags or Image Signing in OCI Container Registry
  rationale: Implementing immutable tags or enforcing image signing within OCI Container Registry mitigates the risk of unauthorized changes to container images, thereby protecting against supply chain attacks. Immutable tags ensure that once an image is published, it cannot be altered, maintaining integrity and reliability. Enforcing image signing adds a layer of trust, ensuring that only verified images are deployed, which is crucial for compliance with standards like NIST and PCI-DSS.
  description: This rule checks whether OCI Container Registry has either immutable tags or image signing enforced on container repositories. Enabling these settings prevents unauthorized modification or deployment of container images. To verify, navigate to the OCI console, access the Container Registry settings, and ensure that 'Tag Mutability' is set to 'Immutable' or 'Image Signing' is enabled. Remediation involves configuring the repository settings to disallow tag changes or requiring signed images for deployment.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/artifacts/Concepts/artifactscontainerregistryoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://csrc.nist.gov/publications/detail/sp/800-190/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security.html
- rule_id: oci.artifacts.container_repository.registry_repo_private_or_access_restricted_restricted
  service: artifacts
  resource: container_repository
  requirement: Registry Repo Private Or Access Restricted Restricted
  scope: artifacts.container_repository.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure OCI Container Repositories are Private or Access Restricted
  rationale: Keeping container repositories private reduces the risk of unauthorized access, data breaches, and potential exposure of sensitive data. Publicly accessible repositories can lead to security vulnerabilities being exploited, impacting business operations, reputation, and compliance with regulations such as PCI-DSS and ISO 27001.
  description: This rule checks if OCI container repositories are configured to be private or have restricted access. Repositories should not be publicly accessible to prevent unauthorized users from pulling or pushing images. To verify and remediate, review the repository settings in the OCI console under 'Artifacts' and ensure the 'Visibility' is set to 'Private'. Additionally, configure access policies to restrict permissions to necessary users or groups only.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Registry/Tasks/registrycreatingarepository.htm#creating
  - https://www.oracle.com/security/cis-oracle-compute-services-benchmark/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/standard/73906.html
- rule_id: oci.artifacts.container_repository.registry_policy_no_public_pull_push_blocked
  service: artifacts
  resource: container_repository
  requirement: Registry Policy No Public Pull Push Blocked
  scope: artifacts.container_repository.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Block Public Pull/Push Access to Container Repositories
  rationale: Allowing public pull and push access to container repositories can lead to unauthorized access and potential data breaches. This poses significant security risks, including the exposure of sensitive data and potential compliance violations with standards such as PCI-DSS, HIPAA, and GDPR. Restricting public access helps in safeguarding intellectual property and maintaining control over container distributions.
  description: This rule checks if public pull and push access to OCI container repositories is blocked. It ensures that only authorized users can interact with container images, preventing unauthorized access and modifications. Administrators should configure repository policies to restrict access, using OCI Identity and Access Management (IAM) policies to control who can pull or push images. Remediation involves setting the 'isPublic' property of the repository to 'false' and verifying IAM policies to ensure proper access controls are in place.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/artifacts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/access/managingpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/cloud/security/
  - https://www.nist.gov/cyberframework
- rule_id: oci.artifacts.container_repository.registry_policy_no_wildcard_admin
  service: artifacts
  resource: container_repository
  requirement: Registry Policy No Wildcard Admin
  scope: artifacts.container_repository.policy_management
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: critical
  title: Prevent Wildcard Admin in OCI Container Registry Policies
  rationale: Using wildcard entries for admin access in OCI container registries can lead to unauthorized access and potential breaches, risking sensitive data and operational disruptions. Organizations may face compliance violations with standards like PCI-DSS and ISO 27001, which require strict access controls and auditability.
  description: This rule checks for the presence of wildcard entries in the admin section of OCI container registry policies. Wildcard usage can inadvertently grant broad access, bypassing principle of least privilege. To verify, review the registry policies in the OCI Console under Artifacts and ensure only specific principals have admin rights. Remediation involves updating policies to replace wildcard entries with explicit user or group identifiers.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Registry/Concepts/registryoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
- rule_id: oci.container_engine.addon.addon_from_trusted_channel
  service: container_engine
  resource: addon
  requirement: Addon From Trusted Channel
  scope: container_engine.addon.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Addon Deployment from Trusted Channels in OCI
  rationale: Deploying addons from untrusted sources can introduce vulnerabilities, potentially leading to compromised container operations. This practice ensures that only verified and secure software is used, reducing the risk of attacks such as supply chain compromises, and aligns with compliance mandates requiring secure software deployment processes.
  description: This rule checks that all OCI Container Engine addons are deployed from trusted channels. Trusted channels are verified sources that Oracle has endorsed for security and reliability. Administrators should configure addon installations to only use these channels, ensuring integrity and authenticity. To remediate, review addon configurations in the OCI Console and restrict source channels to approved ones only.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://cloudsecurityalliance.org/research/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm
- rule_id: oci.container_engine.addon.addon_no_privileged_permissions
  service: container_engine
  resource: addon
  requirement: Addon No Privileged Permissions
  scope: container_engine.addon.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Addons Use Least Privileged Permissions
  rationale: Using least privileged permissions for Kubernetes addons in OCI is crucial to limit the attack surface and prevent potential exploitation by malicious actors. Privileged permissions can lead to unauthorized access and control over the container environment, posing risks to data integrity and availability. Ensuring compliance with security standards like NIST and ISO 27001 aligns with best practices and can prevent data breaches and financial losses.
  description: This rule checks that Kubernetes addons in OCI do not have unnecessary privileged permissions. It verifies the configuration of addons to ensure they operate with the minimum permissions required for their functionality. Remediation involves reviewing addon permissions and adjusting them to adhere to the principle of least privilege. This can be done by auditing the OCI console, identifying any addons with elevated permissions, and modifying them to only include essential permissions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengsecurity.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v3-0-1
- rule_id: oci.container_engine.addon.addon_version_pinned_and_supported_required
  service: container_engine
  resource: addon
  requirement: Addon Version Pinned And Supported Required
  scope: container_engine.addon.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Addon Versions Are Pinned and Supported in OCI
  rationale: Pinning and supporting addon versions in OCI container engine ensures stability and security by preventing automatic updates that might introduce vulnerabilities or incompatibility issues. This practice mitigates risks of deploying untested versions in production environments, aligning with compliance requirements like PCI-DSS and ISO 27001 that mandate controlled software updates.
  description: This rule verifies that all addons in OCI Container Engine have versions explicitly pinned and that these versions are supported by Oracle. Unpinned versions may lead to unanticipated behavior due to automatic updates. To remediate, review the addon configurations in the OCI console, ensure each addon has a specified version, and confirm that these versions are within the supported range. Regularly consult OCI release notes to stay informed about supported versions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengmanagingaddons.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.container_engine.cluster.admission_host_namespace_usage_denied
  service: container_engine
  resource: cluster
  requirement: Admission Host Namespace Usage Denied
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Restrict Host Namespace Usage in OKE Clusters
  rationale: Allowing containers to utilize the host's namespace can lead to privilege escalation, where a container may gain access to sensitive kernel-level resources or processes. This exposes the cluster to potential security breaches, increasing the risk of unauthorized access to network configurations or critical system operations. Ensuring host namespace usage is denied aligns with security best practices and compliance requirements, reducing the attack surface and maintaining cluster integrity.
  description: This rule checks Oracle Kubernetes Engine (OKE) clusters to ensure that admissions controllers are configured to deny containers from using the host's namespace. To verify, inspect the cluster's admission controller policies for settings that prevent host namespace sharing. Remediation involves configuring the OKE cluster admission controllers to explicitly deny any attempts by pods to use host namespaces, thereby preventing containers from accessing host-level system resources.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengabout.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengbestpractices.htm
- rule_id: oci.container_engine.cluster.admission_image_registry_allowlist_enforced
  service: container_engine
  resource: cluster
  requirement: Admission Image Registry Allowlist Enforced
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enforce Image Registry Allowlist in OCI Clusters
  rationale: Enforcing an image registry allowlist in OCI clusters mitigates the risk of deploying unauthorized or potentially harmful container images, which can lead to data breaches or service disruptions. This practice helps ensure compliance with organizational security policies and regulatory standards by allowing only vetted and trusted images to run in the environment.
  description: This rule checks if the OCI Container Engine for Kubernetes clusters have an admission controller policy that enforces an image registry allowlist. Administrators should configure the admission controller to only allow images from approved registries, reducing the attack surface and preventing the execution of untrusted code. To verify compliance, inspect the cluster's admission controller settings and update the policies as necessary to include only trusted registries. Remediation involves modifying the admission controller configuration to enforce the allowlist.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://kubernetes.io/docs/concepts/policy/resource-quotas/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.container_engine.cluster.admission_image_signature_verification_enabled
  service: container_engine
  resource: cluster
  requirement: Admission Image Signature Verification Enabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enable OCI Container Engine Image Signature Verification
  rationale: Enabling image signature verification ensures that only trusted container images are deployed, reducing the risk of running unverified or malicious code. This is crucial for maintaining the integrity of your containerized environments and protecting sensitive data from unauthorized access. It also aligns with compliance requirements for secure software supply chains, thereby minimizing potential legal and financial repercussions.
  description: This rule verifies that image signature verification is enabled in OCI Container Engine clusters. Image signature verification checks that container images are signed by trusted authorities before admission into the cluster, preventing untrusted or tampered images from being deployed. To enable this feature, configure the admission controller settings in the OCI Container Engine for Kubernetes (OKE) to enforce signature verification policies. This setting can be managed through the OCI Console or CLI, ensuring that only authenticated images are permitted.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengadmissioncontrollers.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://kubernetes.io/docs/concepts/cluster-administration/image-policy/
- rule_id: oci.container_engine.cluster.admission_pod_security_restricted_default_enabled
  service: container_engine
  resource: cluster
  requirement: Admission Pod Security Restricted Default Enabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enable Default Restricted Pod Security for OCI Clusters
  rationale: Enabling default restricted pod security prevents the execution of pods with elevated privileges, reducing the risk of unauthorized access and potential data breaches. It helps maintain compliance with industry regulations by ensuring that all pods adhere to security best practices, thereby protecting sensitive data and applications running in the Kubernetes environment.
  description: This check verifies that the default pod security policy for clusters in OCI is set to 'restricted', ensuring that pods operate with the least privilege necessary. To verify, review the pod security policies applied to the cluster and confirm that the 'restricted' policy is the default. Remediation involves configuring the cluster's admission controller to enforce the restricted policy by default, thus safeguarding against privilege escalation and unauthorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengsecuritypolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Compliance/Reference/oci-cis-1-1-0.htm
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org
  - https://www.oracle.com/security-best-practices/
  - https://kubernetes.io/docs/concepts/policy/pod-security-policy/
- rule_id: oci.container_engine.cluster.admission_privilege_escalation_denied
  service: container_engine
  resource: cluster
  requirement: Admission Privilege Escalation Denied
  scope: container_engine.cluster.least_privilege
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: high
  title: Prevent Privilege Escalation in OCI Kubernetes Clusters
  rationale: Preventing privilege escalation in Kubernetes clusters is crucial to protect sensitive data and operations from unauthorized access. This rule mitigates the risk of attackers gaining elevated permissions through containers, which can lead to compromised applications, data breaches, and non-compliance with standards like PCI-DSS and HIPAA. Ensuring that privilege escalation is denied aligns with the principle of least privilege, reducing potential attack vectors and maintaining the integrity of the containerized environment.
  description: This rule checks for configurations that prevent privilege escalation in OCI Kubernetes clusters. It verifies that admission controllers are properly configured to deny any container requests with elevated privileges, which could otherwise be exploited by attackers. To ensure compliance, inspect the cluster's admission control settings and implement policies that enforce non-privileged access by default. Remediation involves configuring the Kubernetes API server with the appropriate admission controllers, such as PodSecurityPolicy, to enforce security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengsecurity.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
  - https://kubernetes.io/docs/concepts/security/pod-security-standards/
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengusingadmissioncontroller.htm
- rule_id: oci.container_engine.cluster.networkpolicy_default_deny_egress_per_namespace_enabled
  service: container_engine
  resource: cluster
  requirement: Networkpolicy Default Deny Egress Per Namespace Enabled
  scope: container_engine.cluster.network_security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: medium
  title: Enforce Default Deny Egress in Kubernetes Namespaces
  rationale: Enabling default deny egress policies for each namespace in your Kubernetes clusters helps protect against unauthorized data exfiltration and lateral movement within the cluster. This is crucial for maintaining data integrity and confidentiality, especially in environments subject to regulatory standards like PCI-DSS or HIPAA which mandate strict data access controls. By enforcing this policy, organizations can mitigate risks associated with misconfigured or overly permissive egress rules that could lead to security breaches.
  description: This rule checks whether a default deny egress network policy is in place for each Kubernetes namespace within an OCI Container Engine cluster. A default deny egress policy ensures that no outbound traffic is allowed from a namespace unless explicitly permitted by a specific policy. To verify compliance, inspect the network policies applied to each namespace using the Kubernetes API or OCI CLI. Remediation involves creating a NetworkPolicy resource with egress rules set to deny by default and applying it to all relevant namespaces.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengusingnetworkpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-190.pdf
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v3-0-1/
  - https://kubernetes.io/docs/concepts/services-networking/network-policies/
- rule_id: oci.container_engine.cluster.networkpolicy_default_deny_ingress_per_namespace_enabled
  service: container_engine
  resource: cluster
  requirement: Networkpolicy Default Deny Ingress Per Namespace Enabled
  scope: container_engine.cluster.network_security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: medium
  title: Ensure Default Deny Ingress Policy for Each Namespace in Clusters
  rationale: Implementing a default deny ingress policy for each Kubernetes namespace reduces the attack surface by only allowing explicitly defined traffic, mitigating risks of unauthorized access and lateral movement within clusters. This practice is crucial for protecting sensitive data and maintaining compliance with security frameworks such as NIST and PCI-DSS, which emphasize access control and data protection.
  description: This rule checks if a default deny ingress policy is enabled for each namespace within an OCI Container Engine for Kubernetes (OKE) cluster. A default deny policy ensures that no ingress traffic is allowed unless explicitly permitted, which is vital for securing cluster workloads. To verify, inspect the network policies configured for each namespace and ensure a deny-all rule is in place. Remediation involves creating or updating Kubernetes network policies to include a default deny ingress configuration per namespace.
  references:
  - https://docs.oracle.com/en/solutions/kubernetes-network-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://kubernetes.io/docs/concepts/services-networking/network-policies/
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengnetworkpolicies.htm
- rule_id: oci.container_engine.cluster.networkpolicy_required_allowlist_for_namespace_services
  service: container_engine
  resource: cluster
  requirement: Networkpolicy Required Allowlist For Namespace Services
  scope: container_engine.cluster.network_security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: medium
  title: Ensure NetworkPolicy Allowlist for Namespace Services in OKE
  rationale: In Oracle Cloud Infrastructure, improperly configured network policies in Kubernetes clusters can expose namespace services to unauthorized access, leading to potential data breaches or service disruptions. Enforcing a network policy allowlist ensures that only permitted traffic can access sensitive containerized applications, reducing the attack surface and helping to meet compliance requirements such as PCI-DSS and SOC2.
  description: This rule checks for the presence of a NetworkPolicy that explicitly defines allowed ingress and egress traffic for namespace services in Oracle Kubernetes Engine (OKE) clusters. To verify compliance, ensure that each namespace has a corresponding NetworkPolicy resource that restricts traffic to only authorized sources. Remediation involves creating or updating Kubernetes NetworkPolicy objects to specify allowed CIDR blocks, ports, and protocols for each namespace service.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengnetworkpolicies.htm
  - CIS OCI Foundations Benchmark v1.1.0
  - https://www.pcisecuritystandards.org/
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/sorhome.html
  - https://kubernetes.io/docs/concepts/services-networking/network-policies/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.container_engine.cluster.apiserver_anonymous_auth_disabled
  service: container_engine
  resource: cluster
  requirement: Apiserver Anonymous Auth Disabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Disable Anonymous Authentication on Kubernetes API Server
  rationale: Enabling anonymous authentication on the Kubernetes API server can lead to unauthorized access, posing significant security risks such as data breaches and unauthorized resource manipulation. This setting can undermine compliance with security frameworks like NIST and ISO 27001, which require robust access control measures. Disabling anonymous authentication helps protect sensitive container workloads and maintains the integrity and confidentiality of your cluster's operations.
  description: This rule checks that anonymous authentication is disabled on the Kubernetes API server within your Oracle Cloud Infrastructure Container Engine for Kubernetes clusters. Anonymous authentication allows unauthenticated users to access the API server, which should be avoided to protect against unauthorized access. To verify this setting, ensure the API server's configuration includes '--anonymous-auth=false'. Remediation involves updating the cluster API server settings to disable anonymous authentication, thereby ensuring only authenticated users can interact with your Kubernetes resources.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengsettingupclusteraccess.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://kubernetes.io/docs/reference/access-authn-authz/authentication/#configuring-authentication
- rule_id: oci.container_engine.cluster.apiserver_audit_logging_enabled
  service: container_engine
  resource: cluster
  requirement: Apiserver Audit Logging Enabled
  scope: container_engine.cluster.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Audit Logging for OCI Container Engine Apiserver
  rationale: Audit logging for the Apiserver in OCI Container Engine for Kubernetes (OKE) is crucial for tracking access and actions within your clusters, which helps in detecting anomalies, troubleshooting issues, and ensuring accountability. Without audit logs, it is challenging to reconstruct events for security incidents, potentially leading to undetected breaches and non-compliance with regulations such as PCI-DSS or GDPR.
  description: This rule checks if audit logging is enabled for the Apiserver in OCI Container Engine clusters. Audit logs capture detailed records of requests made to the cluster's control plane, including who made the request, from which IP, and what actions were performed. To verify, ensure that the logging feature is configured and active within the OKE console. Remediation involves enabling audit logging through the OCI console or CLI, ensuring logs are stored securely in OCI Logging, and regularly reviewing them for suspicious activity.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contenglogging.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-1-0-0-benchmarks.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://kubernetes.io/docs/tasks/debug-application-cluster/audit/
- rule_id: oci.container_engine.cluster.apiserver_authorization_mode_rbac_enforced
  service: container_engine
  resource: cluster
  requirement: Apiserver Authorization Mode RBAC Enforced
  scope: container_engine.cluster.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure RBAC Authorization Mode on Kubernetes API Server
  rationale: Enforcing RBAC (Role-Based Access Control) in the Kubernetes API server is crucial to restrict unauthorized access and ensure that only authenticated users with appropriate permissions can perform actions within the cluster. This minimizes the risk of privilege escalation and potential data breaches, aligning with compliance standards by ensuring least privilege access and accountability.
  description: This rule checks if the Kubernetes API server within an OCI Container Engine for Kubernetes cluster is configured to use RBAC for authorization. RBAC allows fine-grained control over user permissions through roles and role bindings. To verify, inspect the API server configuration for the presence of '--authorization-mode=RBAC'. Remediation involves updating the cluster's API server configuration to include RBAC in the authorization modes, ensuring proper role definitions and bindings are in place.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengpolicyconfig.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://kubernetes.io/docs/reference/access-authn-authz/rbac/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_compliance.htm
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.container_engine.cluster.apiserver_etcd_connection_encrypted
  service: container_engine
  resource: cluster
  requirement: Apiserver Etcd Connection Encrypted
  scope: container_engine.cluster.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure API Server to Etcd Connection is Encrypted
  rationale: Encrypting the connection between the API server and Etcd is crucial to protect sensitive data such as cluster configurations and secrets from interception or unauthorized access. This encryption mitigates the risk of data breaches and supports compliance with data protection regulations such as GDPR and HIPAA, which mandate the protection of data in transit.
  description: This rule checks if the connection between the Kubernetes API server and the Etcd storage backend in OCI Container Engine for Kubernetes is encrypted. Ensure that TLS is enabled for API server to Etcd communication to safeguard sensitive data. To verify, inspect the cluster configuration settings in the OCI console or via OCI CLI, ensuring that the Etcd connection is set to use TLS encryption. Remediation involves updating the cluster configuration to enable TLS for this connection.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/security/cloud-compliance/
  - 'NIST SP 800-53: AC-17, SC-8'
  - https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/
- rule_id: oci.container_engine.cluster.apiserver_insecure_port_disabled
  service: container_engine
  resource: cluster
  requirement: Apiserver Insecure Port Disabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Apiserver Insecure Port is Disabled in OCI Clusters
  rationale: Disabling the insecure API server port in Kubernetes clusters mitigates the risk of unauthorized access and data breaches by eliminating unencrypted traffic paths. It ensures that all communication with the Kubernetes API server is encrypted and authenticated, aligning with compliance requirements such as PCI-DSS and ISO 27001 that mandate secure transmission of data.
  description: This check verifies that the Kubernetes API server in an OCI Container Engine cluster is not configured to listen on the insecure port (default 8080). To ensure secure communication, the API server should only use the secure port (default 6443) with TLS enabled. Administrators can verify this by inspecting the API server configuration and ensuring the '--insecure-port' flag is set to '0'. To remediate, update the cluster's configuration to remove any insecure port settings and redeploy the API server.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://kubernetes.io/docs/reference/access-authn-authz/controlling-access/
- rule_id: oci.container_engine.cluster.apiserver_tls_min_1_2_enforced
  service: container_engine
  resource: cluster
  requirement: Apiserver TLS Min 1 2 Enforced
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Apiserver Enforces TLS 1.2 or Higher
  rationale: Enforcing TLS 1.2 or higher for the Kubernetes API server strengthens the encryption of data in transit, protecting sensitive cluster communications from potential eavesdropping or man-in-the-middle attacks. This is vital for maintaining the confidentiality and integrity of data, thereby ensuring compliance with regulatory standards such as PCI-DSS and HIPAA that mandate strong encryption protocols.
  description: This rule checks if the Oracle Container Engine for Kubernetes (OKE) clusters have their API servers configured to enforce a minimum of TLS 1.2. Verify this setting by accessing the cluster's security configurations within the OCI Console or via OCI CLI. If the setting does not enforce TLS 1.2 or higher, update the cluster configuration to enable this security feature. This ensures secure communication channels between clients and the API server.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengsettingupcluster.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations_benchmark_v1.0.0.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-52r2.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://cloudsecurityalliance.org/research/artifacts/oracle-cloud-infrastructure-security-best-practices
- rule_id: oci.container_engine.k8s_apiserver_admission_psa_enforce_mode.k8s_apiserver_admission_psa_enforce_mode
  service: container_engine
  resource: k8s_apiserver_admission_psa_enforce_mode
  requirement: K8s Apiserver Admission Psa Enforce Mode
  scope: container_engine.k8s_apiserver_admission_psa_enforce_mode.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enforce PSA Mode on K8s API Server for OCI Container Engine
  rationale: Enforcing Pod Security Admission (PSA) mode on the Kubernetes API server helps prevent the deployment of pods that violate security policies, reducing the risk of vulnerabilities being exploited. This enhances the security posture by ensuring consistent application of security standards, which is vital for protecting sensitive data and maintaining compliance with regulatory frameworks like PCI-DSS and ISO 27001.
  description: This check ensures that the Kubernetes API server in OCI Container Engine is configured with Pod Security Admission (PSA) enforce mode enabled. PSA enforce mode restricts pod creation based on security policies, preventing risky configurations that could lead to potential security breaches. To verify and remediate, ensure that the PSA mode is set to 'enforce' in the API server configuration. This can be done through the OCI Console by navigating to the Kubernetes cluster settings and updating the admission control configuration.
  references:
  - https://docs.oracle.com/en/solutions/oci-kubernetes-security-guidelines/
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://kubernetes.io/docs/concepts/security/pod-security-admission/
  - https://www.oracle.com/security/cloud-security/compliance/
- rule_id: oci.container_engine.cluster.k8s_apiserver_anonymous_auth_disabled
  service: container_engine
  resource: cluster
  requirement: K8s Apiserver Anonymous Auth Disabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Disable Anonymous Auth in K8s API Server for OCI Clusters
  rationale: Disabling anonymous authentication in Kubernetes API servers is crucial to prevent unauthorized access to cluster resources. Allowing anonymous requests can lead to potential security breaches, data exposure, and unauthorized manipulation of Kubernetes resources, which can ultimately affect business operations and compliance with standards such as PCI-DSS and SOC2.
  description: This rule checks if anonymous authentication is disabled in the Kubernetes API server configuration for Oracle Cloud Infrastructure clusters. To verify, inspect the API server's configuration file or parameters and ensure '--anonymous-auth=false' is set. Remediation involves updating the API server configuration to disable anonymous authentication, enhancing the security posture by requiring authentication for all requests.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
  - https://kubernetes.io/docs/reference/access-authn-authz/authentication/#anonymous-requests
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.container_engine.cluster.k8s_apiserver_audit_logging_enabled
  service: container_engine
  resource: cluster
  requirement: K8s Apiserver Audit Logging Enabled
  scope: container_engine.cluster.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure K8s API Server Audit Logging is Enabled for OCI Clusters
  rationale: Enabling Kubernetes API server audit logging on OCI clusters is critical for tracking and analyzing access patterns and changes in the cluster. It helps in identifying unauthorized access, potential breaches, and other malicious activities. Compliance with regulatory requirements like NIST and PCI-DSS often mandates detailed logging to ensure data integrity and accountability.
  description: This check verifies that the Kubernetes API server audit logging is enabled for OCI Container Engine clusters. Audit logging should be configured to capture all API requests and responses, which can be accomplished via the OCI Console by enabling the audit feature under the cluster's logging settings. If not enabled, follow OCI's documentation to activate audit logging, ensuring logs are stored securely and monitored regularly for any suspicious activities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contenglogging.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://kubernetes.io/docs/tasks/debug/debug-cluster/audit/
  - https://www.oracle.com/security/cloud-compliance/
- rule_id: oci.container_engine.k8s_apiserver_tls_min_version_1_2.k8s_apiserver_tls_min_version_1_2_required
  service: container_engine
  resource: k8s_apiserver_tls_min_version_1_2
  requirement: K8s Apiserver TLS Min Version 1 2 Required
  scope: container_engine.k8s_apiserver_tls_min_version_1_2.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enforce TLS 1.2+ for K8s API Server in OCI
  rationale: Enforcing TLS 1.2 as the minimum version for Kubernetes API server communications ensures protection against vulnerabilities in older versions, such as TLS 1.0 and 1.1, which are susceptible to attacks like BEAST and POODLE. This enhances the security posture by safeguarding data in transit and aligns with regulatory standards that mandate strong encryption, reducing risk of data breaches and ensuring customer trust.
  description: This rule checks if the Kubernetes API server within Oracle Cloud Infrastructure's Container Engine for Kubernetes is configured to use at least TLS 1.2 for secure communication. To verify, ensure the API server's configuration specifies TLS 1.2 or higher as the minimum version. Remediation involves updating the API server configuration to enforce TLS 1.2, which can typically be done via the OCI Console or CLI by adjusting the TLS settings in the cluster's configuration file. This upgrade is crucial to mitigate vulnerabilities associated with older TLS versions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-52r2.pdf
  - https://www.oracle.com/security-cloud.html
  - https://kubernetes.io/docs/concepts/cluster-administration/networking/
- rule_id: oci.container_engine.cluster.controller_manager_root_ca_file_configured
  service: container_engine
  resource: cluster
  requirement: Controller Manager Root Ca File Configured
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: critical
  title: Ensure Controller Manager Root CA File Configured
  rationale: Configuring the Controller Manager Root CA File is crucial for securing Kubernetes clusters in OCI by ensuring that communications within the cluster are properly authenticated and encrypted. This mitigates risks such as man-in-the-middle attacks and ensures compliance with security frameworks like PCI-DSS and HIPAA by safeguarding sensitive data. Failure to configure this setting could lead to unauthorized access and data breaches, impacting business continuity and reputation.
  description: This rule checks if the Kubernetes Controller Manager within an OCI Container Engine for Kubernetes cluster is configured with a Root CA file, which is necessary for establishing a secure communication channel. To verify, ensure the Controller Manager configuration includes the '--root-ca-file' flag pointing to a valid CA certificate file. Remediation involves updating the cluster's Controller Manager component to include this configuration, followed by a restart to apply changes. This ensures that all cluster communications are authenticated and encrypted.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.oracle.com/security/cloud-compliance/
- rule_id: oci.container_engine.cluster.controller_manager_secure_port_tls_enabled
  service: container_engine
  resource: cluster
  requirement: Controller Manager Secure Port TLS Enabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enable TLS for Controller Manager Secure Port in OCI Clusters
  rationale: Enabling TLS on the Controller Manager's secure port mitigates the risk of unauthorized access and data interception between Kubernetes control plane components. This configuration is crucial for maintaining the confidentiality and integrity of cluster operations, which is essential for compliance with data protection regulations and for preventing potential breaches that could disrupt business operations.
  description: This rule checks if the Controller Manager Secure Port in OCI Kubernetes clusters is configured to use TLS encryption. It ensures that all communication on this port is encrypted, protecting sensitive data from being exposed. To verify, inspect the cluster's API server configuration for the 'tls' parameter under the 'secure-port' settings. If not enabled, configure the Controller Manager to enforce TLS by updating the cluster configurations via OCI CLI or Console. This helps in safeguarding the control plane communications.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengsettingupcluster.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.oracle.com/security/cloud-security/
  - https://kubernetes.io/docs/concepts/security/overview/
- rule_id: oci.container_engine.cluster.controller_manager_use_service_account_credentials_enabled
  service: container_engine
  resource: cluster
  requirement: Controller Manager Use Service Account Credentials Enabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: high
  title: Ensure Controller Manager Uses Service Account Credentials
  rationale: Enabling the use of service account credentials for the Kubernetes Controller Manager in OCI ensures secure communication and operation within the Kubernetes cluster. This reduces the risk of unauthorized access and potential data breaches by ensuring that all actions performed by the Controller Manager are authenticated and authorized. It is critical for maintaining compliance with industry standards such as NIST, which emphasize secure credential management.
  description: This rule checks if the Kubernetes Controller Manager in OCI Container Engine for Kubernetes is configured to use service account credentials for API requests. By default, the Controller Manager should be configured to use a secure service account to interact with the cluster, thereby ensuring that all operations are properly authenticated. To verify and remediate, review the Controller Manager configuration settings in the OCI console or use the OCI CLI to ensure that the 'use-service-account-credentials' flag is set to 'true'. This action strengthens the security posture of the Kubernetes cluster by enforcing proper authentication mechanisms.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengsettingup.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
  - https://cloudsecurityalliance.org/research/artifacts/kubernetes-security-guidelines
  - https://kubernetes.io/docs/reference/access-authn-authz/service-accounts-admin/
- rule_id: oci.container_engine.cluster.k8s_controllermanager_secure_port_enabled
  service: container_engine
  resource: cluster
  requirement: K8s Controllermanager Secure Port Enabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enable Secure Port on K8s Controller Manager
  rationale: Enabling the secure port for the Kubernetes controller manager is crucial to ensure that communication between the controller manager and other Kubernetes components is encrypted and authenticated. This reduces the risk of man-in-the-middle attacks, unauthorized access, and sensitive data leakage, which could lead to compliance violations and operational disruptions. It also aligns with compliance frameworks that require encrypted communications, such as PCI-DSS and HIPAA.
  description: This rule checks if the Kubernetes controller manager in an Oracle Cloud Infrastructure (OCI) Kubernetes cluster is configured to use a secure port. By default, the secure port should be enabled to ensure that all API communication is encrypted using TLS. To verify, check the controller manager's configuration for secure port settings. Remediation involves setting the secure port flag to true in the controller manager's configuration and ensuring a valid SSL certificate is in place.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org
  - https://www.hipaajournal.com/hipaa-compliance-checklist/
  - https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
- rule_id: oci.container_engine.cluster.k8s_controllermanager_service_account_token_signing_enabled
  service: container_engine
  resource: cluster
  requirement: K8s Controllermanager Service Account Token Signing Enabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enable K8s Controller Manager Service Account Token Signing
  rationale: Ensuring that the Kubernetes Controller Manager has service account token signing enabled is crucial for maintaining the integrity and authenticity of service account tokens. Without this setting, tokens could be intercepted or altered, leading to unauthorized access within the Kubernetes cluster and potential data breaches. This configuration is vital for compliance with security frameworks like NIST and ISO 27001 to protect sensitive data and maintain operational trust.
  description: This check verifies that the Kubernetes Controller Manager within the OCI Container Engine for Kubernetes (OKE) has service account token signing enabled. This setting allows the Controller Manager to issue tokens that are signed, ensuring their validity and preventing tampering. To verify, ensure that the Controller Manager configuration includes '--service-account-signing-key-file' and '--service-account-issuer' flags. Remediation involves updating the OKE cluster configuration to include these flags if they are absent, which can be managed through OCI CLI or the Console.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengsettingup.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-190/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/
- rule_id: oci.container_engine.cluster.cluster_service_dns_and_metrics_from_approved_sources
  service: container_engine
  resource: cluster
  requirement: Cluster Service Dns And Metrics From Approved Sources
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Restrict Cluster DNS and Metrics Access to Approved Sources
  rationale: Allowing unapproved sources to access cluster service DNS and metrics in Oracle Cloud Infrastructure can expose sensitive operational data, leading to potential data breaches or unauthorized access. Properly securing these endpoints helps protect against information leakage and aligns with compliance requirements such as PCI-DSS and ISO 27001, which mandate controlled access to sensitive information.
  description: This rule verifies that access to the cluster's service DNS and metrics endpoints is restricted to a list of approved network sources. It ensures that only designated IP addresses or CIDR blocks can query DNS or access metrics, reducing the risk of exposure to external threats. Administrators should configure network policies and security lists to limit access and regularly review and update the approved source list to align with changing security needs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengsettingupclusteraccess.htm#cluster_svc_dns_metrics
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://cloudsecurityalliance.org/research/security-guidance/
- rule_id: oci.container_engine.cluster.cluster_service_kube_system_services_not_public_blocked
  service: container_engine
  resource: cluster
  requirement: Cluster Service Kube System Services Not Public Blocked
  scope: container_engine.cluster.public_access
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: critical
  title: Restrict Public Access to Kube-System Services in OCI Clusters
  rationale: Exposing Kube-System services to the public internet can lead to unauthorized access and potential exploitation of cluster resources, compromising sensitive data and workloads. This exposure increases the risk of attacks such as Distributed Denial of Service (DDoS) or unauthorized data access, impacting business operations and customer trust. Adhering to this requirement supports compliance with security frameworks that mandate network segmentation and access control.
  description: This rule checks that services within the kube-system namespace of an OCI Container Engine for Kubernetes (OKE) cluster are not publicly accessible. Ensure that network policies and security lists are configured to restrict inbound traffic to only trusted IP addresses. Remediation involves updating the cluster's security rules to limit exposure and using OCI's Network Security Groups (NSGs) to enforce strict access control. Verify configurations using the OCI console or CLI to ensure compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengnetworksecurity.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/securitypolicies.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
- rule_id: oci.container_engine.cluster.workload_drop_net_raw_and_reduce_caps
  service: container_engine
  resource: cluster
  requirement: Workload Drop Net Raw And Reduce Caps
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Restrict Workload Capabilities and Network Access in OCI Clusters
  rationale: Restricting workload capabilities and network access in OCI clusters is crucial to minimize potential attack vectors and ensure that containerized applications operate with the least privileges necessary. This reduces the risk of privilege escalation and unauthorized network access, which can lead to data breaches or service disruptions. Adhering to this practice also aligns with compliance requirements for data protection and security standards.
  description: This rule checks whether OCI container engine clusters are configured to drop capabilities related to network raw access and reduce capabilities to the least necessary for operation. Verify that workloads are configured with 'NET_RAW' capability dropped and reduced capabilities in the PodSecurityPolicy or equivalent configuration. Remediation involves auditing and updating Kubernetes PodSecurityPolicies or SecurityContexts to ensure 'NET_RAW' is dropped and other capabilities are minimized. This enhances the overall security posture of the cluster by reducing potential attack surfaces.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengnetworkpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
  - https://kubernetes.io/docs/concepts/policy/pod-security-policy/
  - https://www.oracle.com/security-cloud-compliance/
- rule_id: oci.container_engine.cluster.workload_env_no_plaintext_secrets
  service: container_engine
  resource: cluster
  requirement: Workload Env No Plaintext Secrets
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: high
  title: Prevent Plaintext Secrets in OCI Workload Environments
  rationale: Storing secrets in plaintext within container environments exposes sensitive data to potential interception or unauthorized access, leading to data breaches and compliance violations. It is critical for maintaining data confidentiality and integrity, especially for organizations adhering to strict regulatory requirements such as PCI-DSS and HIPAA.
  description: This rule checks for the presence of plaintext secrets in environment variables within OCI Container Engine for Kubernetes clusters. Secrets should be managed using OCI Vault or Kubernetes Secrets to avoid exposure. Administrators should audit existing deployments, transition to secure storage solutions for secrets, and ensure that applications are configured to access secrets via these services.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengcreatingclusterusingoke.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/security-cloud/cis-benchmark/
  - https://kubernetes.io/docs/concepts/configuration/secret/
- rule_id: oci.container_engine.cluster.workload_host_network_pid_ipc_disabled
  service: container_engine
  resource: cluster
  requirement: Workload Host Network Pid Ipc Disabled
  scope: container_engine.cluster.network_security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: medium
  title: Ensure Workload Host Network PID/IPC is Disabled in Clusters
  rationale: Disabling Host Network PID and IPC for workloads prevents unauthorized access and escalated privileges within the container environment, reducing the risk of container breakout attacks. It helps maintain isolation between workloads, ensuring sensitive data and processes are not exposed to potential threats, thus supporting compliance with security standards such as NIST and PCI-DSS.
  description: This rule verifies that workloads in Oracle Cloud Infrastructure Container Engine for Kubernetes (OKE) clusters do not use the host's network, PID, or IPC namespaces. To check compliance, inspect the pod specifications in your OKE cluster and confirm that 'hostNetwork', 'hostPID', and 'hostIPC' are set to false. Remediation involves editing the pod specifications to disable these settings, ensuring workloads operate within their namespaces to enhance security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/cis-benchmarks/
  - https://csrc.nist.gov/publications/detail/sp/800-190/final
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm#managingsecurity
  - https://kubernetes.io/docs/concepts/security/pod-security-standards/
- rule_id: oci.container_engine.cluster.workload_image_tag_not_latest
  service: container_engine
  resource: cluster
  requirement: Workload Image Tag Not Latest
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Avoid Using 'Latest' Tag for Container Images
  rationale: Using the 'latest' tag for container images can introduce unpredictability in application behavior, as it may pull different images over time without notice, leading to potential vulnerabilities or compatibility issues. This practice increases security risks by potentially deploying unverified or insecure code. It can also hinder compliance with regulations that require consistent and verifiable deployment processes.
  description: This rule checks if container workloads in OCI Container Engine for Kubernetes are using images tagged as 'latest'. Such tags can lead to inconsistent deployments and security vulnerabilities. To maintain a stable and secure environment, use explicit version tags for container images. Verify compliance by reviewing your Kubernetes deployment configurations and update them to reference specific version tags. Remediation involves changing the image tag in your deployment YAML files to a specific version number.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengdeployingapp.htm
  - 'NIST SP 800-190: Application Container Security Guide'
  - https://kubernetes.io/docs/concepts/containers/images/#updating-images
  - CIS OCI Foundations Benchmark
- rule_id: oci.container_engine.cluster.workload_no_hostpath_mounts
  service: container_engine
  resource: cluster
  requirement: Workload No Hostpath Mounts
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure No Hostpath Mounts in Kubernetes Workloads
  rationale: Disallowing hostpath mounts within Kubernetes workloads minimizes the risk of unauthorized access to the underlying node filesystem, which can lead to data breaches or system manipulation. This practice is crucial for maintaining a secure isolation boundary between workloads and ensuring compliance with security standards that prioritize the integrity and confidentiality of data.
  description: This rule checks for the use of hostpath mounts in Kubernetes workloads within an OCI Container Engine cluster. Hostpath mounts can expose sensitive host data to containers, increasing the risk of privilege escalation attacks. To verify compliance, review the pod specifications for hostpath volume mounts and remove or replace them with more secure alternatives like Persistent Volumes. Remediation involves modifying the deployment configurations to eliminate hostpath usage, thereby enhancing the security posture of the cluster.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - 'CIS OCI Benchmark: 1.5.0 - Ensure that hostpath volumes are not used in containers'
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://kubernetes.io/docs/concepts/storage/volumes/#hostpath
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.container_engine.cluster.workload_no_privileged_containers
  service: container_engine
  resource: cluster
  requirement: Workload No Privileged Containers
  scope: container_engine.cluster.least_privilege
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: high
  title: Enforce Non-Privileged Containers in OCI Clusters
  rationale: Running containers with elevated privileges can lead to severe security breaches, including unauthorized access to the underlying host and data exfiltration. This is particularly critical in regulated industries where data integrity and confidentiality are paramount, aligning with compliance requirements such as PCI-DSS and ISO 27001. Enforcing non-privileged containers minimizes attack surface and mitigates risks of privilege escalation and container breakout scenarios.
  description: This rule checks for the deployment of privileged containers within Oracle Cloud Infrastructure (OCI) Container Engine for Kubernetes clusters. Privileged containers can bypass security restrictions and access host resources. It is crucial to configure PodSecurityPolicies or equivalent configurations to disallow privileged mode. Remediation involves auditing Kubernetes configurations and updating policies to ensure containers run with the minimum required privileges, utilizing OCI's native security features like Security Zones.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengrestrictinguseraccess.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-190/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://kubernetes.io/docs/concepts/security/pod-security-standards/
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
- rule_id: oci.container_engine.cluster.workload_read_only_root_filesystem
  service: container_engine
  resource: cluster
  requirement: Workload Read Only Root Filesystem
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: critical
  title: Enforce Read-Only Root Filesystem for OCI Container Workloads
  rationale: Running container workloads with a read-only root filesystem reduces the risk of unauthorized modifications to system files and binaries, protecting against potential attacks that exploit these changes. It enhances the overall security posture by limiting the attack surface and fulfilling compliance requirements such as PCI-DSS and ISO 27001, which emphasize the integrity and immutability of critical system components.
  description: 'This rule verifies that OCI Container Engine clusters are configured with workloads utilizing a read-only root filesystem. Such a configuration prevents any unauthorized writes to the root filesystem, ensuring that applications cannot modify system libraries or binaries. To remediate, ensure that the pod security policies or container runtime configuration specify a read-only root filesystem. This can be achieved by setting ''readOnlyRootFilesystem: true'' in the Kubernetes pod security policy or the container''s security context.'
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
  - https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted
  - https://www.oracle.com/security/cybersecurity/cloud-security/
- rule_id: oci.container_engine.cluster.workload_run_as_non_root
  service: container_engine
  resource: cluster
  requirement: Workload Run As Non Root
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: critical
  title: Ensure Kubernetes Workloads Run As Non-Root User
  rationale: Running workloads as a non-root user minimizes the risk of privilege escalation and reduces the attack surface. This is crucial in environments handling sensitive data or critical operations, where a compromised container running as root could lead to unauthorized access to the underlying host or other services. Compliance with security standards like PCI-DSS and NIST often requires minimizing privileges to enhance security.
  description: This rule verifies that Kubernetes workloads in the OCI Container Engine for Kubernetes clusters are configured to run as non-root users. Ensure that the 'runAsUser' field is set to a non-zero value in the security context of your Kubernetes Pod or Container specifications. Remediate by updating your deployment configurations and Dockerfiles to specify a non-root user, and review existing workloads to ensure compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengsecurity.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-190/final
  - https://cloudsecurityalliance.org/research/artifacts/kubernetes-security-guidance/
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengdeploymicroservices.htm
- rule_id: oci.container_engine.cluster.workload_seccomp_profile_runtime_default_enabled
  service: container_engine
  resource: cluster
  requirement: Workload Seccomp Profile Runtime Default Enabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enable Default Seccomp Profiles for OCI Container Workloads
  rationale: Enabling runtime default Seccomp profiles for workloads in OCI Container Engine reduces the attack surface by restricting system calls that containers can make, thereby mitigating the risk of exploits. This practice is vital for maintaining container isolation and ensuring compliance with security standards like NIST SP 800-190, which emphasizes container runtime security. By enforcing such profiles, organizations protect sensitive data and maintain the integrity of critical applications hosted in OCI.
  description: This rule checks whether the OCI Container Engine clusters have the default Seccomp profiles enabled for their workloads. Seccomp acts as a security filter for system calls, preventing containers from making unauthorized or potentially harmful requests. To verify, inspect the PodSecurityPolicy or default settings in the Kubernetes cluster configuration. Remediate by configuring Kubernetes Pods to use the 'runtime/default' Seccomp profile, ensuring that the policy is applied at the namespace level or using admission controllers to enforce compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-190/final
  - https://kubernetes.io/docs/tutorials/clusters/seccomp/
  - https://oracle.github.io/weblogic-kubernetes-operator/security/secomp/
  - https://access.redhat.com/documentation/en-us/openshift_container_platform/4.2/html/security/seccomp
- rule_id: oci.container_engine.cluster.etcd_auth_enabled
  service: container_engine
  resource: cluster
  requirement: Etcd Auth Enabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enable Etcd Authentication in OCI Container Engine Clusters
  rationale: Etcd authentication is critical to securing Kubernetes cluster data as it prevents unauthorized access to sensitive information stored in Etcd, such as service account tokens and secrets. Without authentication, malicious actors could exploit vulnerabilities to extract confidential data, leading to potential data breaches and non-compliance with regulations such as GDPR and HIPAA.
  description: This rule checks whether authentication is enabled for Etcd in Oracle Cloud Infrastructure Container Engine clusters. Enabling Etcd authentication ensures that only authorized users can access and modify data stored in the Etcd key-value store. To verify, review the security settings of your Kubernetes cluster and ensure that the '--etcd-auth' flag is set to 'true'. Remediation involves enabling this configuration in your cluster setup to enhance data protection.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengsettingupcluster.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.nist.gov/cyberframework
  - https://cloudsecurityalliance.org/research/artifacts/kubernetes-security-guidance
  - https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
- rule_id: oci.container_engine.cluster.etcd_client_tls_enabled
  service: container_engine
  resource: cluster
  requirement: Etcd Client TLS Enabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Etcd Client TLS is Enabled for OCI Clusters
  rationale: Enabling TLS for etcd client connections is critical to protect data in transit between cluster components. Without TLS, sensitive data such as configuration information and secrets can be intercepted by unauthorized parties, leading to potential data breaches and non-compliance with regulations like GDPR or HIPAA.
  description: This rule checks if TLS is enabled for etcd client communications in Oracle Cloud Infrastructure (OCI) Container Engine for Kubernetes clusters. Etcd is a key-value store for Kubernetes data, and securing it with TLS ensures that data exchanged between components is encrypted. To verify, ensure that the etcd client certificate authority (CA) file and client certificates are configured correctly. Remediation involves updating the etcd configuration to specify the --client-cert-auth option and providing valid certificate files.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengsecurity.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/#use-transport-layer-security-tls-for-all-communication
- rule_id: oci.container_engine.cluster.etcd_encryption_enabled
  service: container_engine
  resource: cluster
  requirement: Etcd Encryption Enabled
  scope: container_engine.cluster.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Etcd Encryption is Enabled for OCI Kubernetes Clusters
  rationale: Etcd encryption protects sensitive Kubernetes data such as secrets and configuration details stored in etcd. If encryption is not enabled, this data could be exposed in plaintext, leading to potential unauthorized access and data breaches. Enabling etcd encryption helps in mitigating risks related to data exfiltration and supports compliance with data protection standards such as NIST and PCI-DSS.
  description: This rule checks whether encryption is enabled for etcd in Oracle Cloud Infrastructure (OCI) Kubernetes clusters. Etcd encryption must be configured to ensure that sensitive data like service account tokens, configuration maps, and secrets are encrypted at rest. Verify the encryption setting in the cluster's configuration through the OCI Console or CLI. If not enabled, update the cluster settings to enable etcd encryption, ensuring that encryption keys are managed securely through OCI Vault.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - CIS Oracle Cloud Infrastructure Foundations Benchmark v1.1.0
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/
- rule_id: oci.container_engine.cluster.etcd_peer_tls_enabled
  service: container_engine
  resource: cluster
  requirement: Etcd Peer TLS Enabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Etcd Peer TLS is Enabled in OCI Container Clusters
  rationale: Enabling TLS for Etcd peer communication is crucial for securing sensitive data within Kubernetes clusters. Without encryption, data exchanged between Etcd nodes is vulnerable to interception, leading to potential data breaches or unauthorized access. Ensuring TLS is enabled helps meet compliance requirements such as PCI-DSS and SOC2, and protects against threats like man-in-the-middle attacks.
  description: This rule checks whether TLS is enabled for Etcd peer communication in Oracle Cloud Infrastructure (OCI) Kubernetes clusters. Verify that the Etcd configuration includes TLS setup for peer connections, ensuring data integrity and confidentiality. Remediation involves configuring Etcd to use TLS certificates for peer communication, typically through the OCI Container Engine settings or Kubernetes configuration files. This enhances security by encrypting data in transit between Etcd nodes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm#etcd
  - https://workbench.cisecurity.org/benchmarks/6130
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/
- rule_id: oci.container_engine.cluster.k8s_etcd_client_cert_auth_enabled
  service: container_engine
  resource: cluster
  requirement: K8s Etcd Client Cert Auth Enabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enable Etcd Client Certificate Authentication in K8s Clusters
  rationale: Disabling client certificate authentication for etcd in Kubernetes clusters can expose sensitive configuration data to unauthorized access, posing a risk of data breaches or service disruption. This control is crucial for safeguarding the integrity and confidentiality of Kubernetes etcd data, aligning with compliance frameworks that mandate secure access control measures.
  description: This rule checks whether Kubernetes etcd client certificate authentication is enabled for your Oracle Cloud Infrastructure Kubernetes clusters. Enabling this feature ensures that only authenticated clients can interact with the etcd database, enhancing the security posture of the cluster. To verify, ensure that the etcd server is configured with the '--client-cert-auth' flag set to 'true'. Remediation involves updating the etcd configuration to enforce client certificate authentication, which can be managed through the OCI Console or the Kubernetes API.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengsettingupclusteraccess.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/
- rule_id: oci.container_engine.cluster.k8s_etcd_encryption_enabled
  service: container_engine
  resource: cluster
  requirement: K8s Etcd Encryption Enabled
  scope: container_engine.cluster.encryption
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: high
  title: Enable K8s Etcd Encryption in OCI Clusters
  rationale: Etcd stores all Kubernetes cluster data, making it a critical component for maintaining cluster integrity. Unencrypted Etcd data can be easily exploited by attackers, leading to potential data breaches and unauthorized access to sensitive information. Enabling encryption protects against such threats and is often a requirement for compliance with regulations like PCI-DSS and HIPAA.
  description: This rule checks if Kubernetes clusters in Oracle Cloud Infrastructure have etcd encryption enabled. Etcd encryption ensures that all data stored within the etcd database is encrypted at rest, safeguarding sensitive information. To verify, ensure that the 'EncryptEtcdData' parameter is set to 'true' in the OCI Container Engine for Kubernetes configuration. Remediation involves updating the cluster settings to enable etcd encryption, which can be done through the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengworkingenvironments.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/
- rule_id: oci.container_engine.cluster.namespace_default_service_account_automount_disabled
  service: container_engine
  resource: cluster
  requirement: Namespace Default Service Account Automount Disabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Disable Default Service Account Automount in Namespaces
  rationale: Automatically mounting the default service account token into containers can lead to unnecessary exposure of credentials, increasing the risk of unauthorized access. This default behavior may allow an attacker to exploit the service account credentials, potentially accessing the OCI resources with elevated privileges. Disabling automount enhances security by limiting access to sensitive information, aligning with compliance requirements such as SOC2 and ISO 27001.
  description: This rule ensures that the default service account token is not automatically mounted in all namespaces of a Kubernetes cluster. To verify, check the namespace configurations using the OCI CLI or Kubernetes API to ensure that the 'automountServiceAccountToken' field is set to 'false'. Remediate by updating the namespace configuration to explicitly disable the automatic mounting of the service account token, thereby reducing the attack surface.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengsettingupcluster.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
  - https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/
  - https://www.oracle.com/security/cloud-security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.container_engine.cluster.namespace_network_policies_present
  service: container_engine
  resource: cluster
  requirement: Namespace Network Policies Present
  scope: container_engine.cluster.network_security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: medium
  title: Ensure Namespace Network Policies in OCI Clusters
  rationale: Namespace Network Policies are crucial for controlling traffic flow between pods in a Kubernetes environment, thereby reducing the risk of unauthorized lateral movement and data breaches. Ensuring these policies are present helps organizations mitigate security risks and comply with industry standards such as PCI-DSS and ISO 27001 by enforcing network segmentation and access controls.
  description: This rule checks for the presence of Network Policies within Kubernetes namespaces in OCI Container Engine clusters. Network Policies define how pods communicate with each other and can restrict unauthorized access, enhancing security. To verify, inspect the cluster configuration for existing Network Policies and ensure they are applied to all namespaces. Remediation involves creating or updating policies using the Kubernetes NetworkPolicy API, which can be deployed via kubectl or the OCI Console.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengnetworkpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://kubernetes.io/docs/concepts/services-networking/network-policies/
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengusingnetworkpolicies.htm
- rule_id: oci.container_engine.cluster.namespace_pod_security_level_restricted
  service: container_engine
  resource: cluster
  requirement: Namespace Pod Security Level Restricted
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enforce Pod Security Level to Restricted for OCI Kubernetes Namespaces
  rationale: Implementing a restricted pod security level minimizes security risks by limiting the permissions available to applications running in your Kubernetes cluster. This reduces the attack surface by preventing privilege escalation and access to sensitive resources. It is crucial for maintaining compliance with security frameworks and protecting sensitive data from unauthorized access.
  description: This rule verifies that namespaces within an Oracle Cloud Infrastructure Kubernetes cluster enforce a 'Restricted' pod security policy. This setting ensures that pods cannot run with unnecessary privileges, such as host networking or the ability to run as the root user. Administrators should configure the namespace to apply the 'Restricted' policy by default and audit existing namespaces for compliance. Non-compliant namespaces should be updated to meet these security requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
  - https://kubernetes.io/docs/concepts/security/pod-security-standards/
  - https://www.oracle.com/security-cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.container_engine.cluster.node_pool_disk_encryption_enabled
  service: container_engine
  resource: cluster
  requirement: Node Pool Disk Encryption Enabled
  scope: container_engine.cluster.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Node Pool Disk Encryption is Enabled
  rationale: Enabling disk encryption for node pools in Oracle Container Engine for Kubernetes (OKE) protects sensitive data at rest from unauthorized access, reducing the risk of data breaches. This security measure is vital for meeting regulatory compliance requirements such as PCI-DSS, HIPAA, and GDPR, which mandate data encryption to safeguard personal and sensitive information.
  description: This rule checks if disk encryption is enabled for node pools within an OKE cluster. Node pool encryption ensures that all data stored on the node's local disks is encrypted using Oracle-managed keys. To verify, access the OCI Console, navigate to the OKE service, and check the encryption settings for each node pool. Remediation involves enabling encryption during node pool creation or updating the existing node pool configuration to include encryption settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengcreatingclusterusingoke.htm
  - https://www.oracle.com/security-cloud/standards/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.hipaajournal.com/hipaa-encryption-requirements/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.container_engine.node_pool.node_pool_nodes_no_public_ip_blocked
  service: container_engine
  resource: node_pool
  requirement: Node Pool Nodes No Public Ip Blocked
  scope: container_engine.node_pool.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure Node Pool Nodes Have No Public IP Addresses
  rationale: Exposing node pool nodes to the public internet can lead to unauthorized access, data breaches, and potential exploitation of vulnerabilities. By restricting public IP addresses, organizations can mitigate the risk of attacks, ensuring that only secure, internal communications occur. This aligns with compliance requirements for data protection and access control, such as PCI-DSS and ISO 27001.
  description: This rule checks that nodes within an OCI Container Engine node pool are not assigned public IP addresses, which could expose them to external threats. To verify compliance, ensure that node pools are configured without public IP assignments by default. Remediation involves updating the node pool configuration to disable public IP assignment, thereby enforcing secure, internal-only access to these nodes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengdisablingpublicip.htm
  - CIS Oracle Cloud Infrastructure Foundations Benchmark v1.0.0, Section 3.7
  - NIST SP 800-53 Rev. 5 AC-3 Access Enforcement
  - 'PCI-DSS Requirement 1.3.2: Prohibit direct public access between the Internet and any system component in the cardholder data environment'
- rule_id: oci.container_engine.node_pool.node_pool_shielded_secure_boot_enabled
  service: container_engine
  resource: node_pool
  requirement: Node Pool Shielded Secure Boot Enabled
  scope: container_engine.node_pool.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Node Pool Shielded Secure Boot is Enabled
  rationale: Enabling Shielded Secure Boot for node pools in OCI Container Engine enhances security by ensuring that nodes boot with verified and trusted software. This mitigates risks from boot-level malware and unauthorized code execution, which are crucial for maintaining the integrity and trustworthiness of containerized applications. Compliance with regulatory standards like NIST and PCI-DSS often requires robust boot security measures.
  description: This rule checks if Shielded Secure Boot is enabled for node pools in Oracle Container Engine. To verify, ensure that the node pool configuration includes Shielded Secure Boot as part of its security settings. Remediation involves updating the node pool configuration to enable this feature, which can typically be done through the OCI Console or CLI. Enabling this setting provides an additional layer of security by restricting the environment to boot only trusted software images.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm#NodePools
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/securityfaqs.htm
  - https://www.oracle.com/cloud-native/container-engine/
- rule_id: oci.container_engine.node_pool.node_pool_workload_identity_enabled
  service: container_engine
  resource: node_pool
  requirement: Node Pool Workload Identity Enabled
  scope: container_engine.node_pool.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enable Workload Identity for OCI Node Pools
  rationale: Enabling Workload Identity for node pools in Oracle Cloud Infrastructure enhances security by allowing Kubernetes workloads to authenticate and access OCI services using fine-grained IAM policies. This reduces the risk of credential exposure and unauthorized access, thus mitigating potential security threats and ensuring compliance with identity management best practices.
  description: This rule checks if Workload Identity is enabled for OCI node pools. Workload Identity allows Kubernetes workloads to assume OCI IAM roles, improving security by eliminating the need for long-lived credentials. To verify, ensure that the node pool configuration includes a linked IAM role. Remediation involves configuring the node pool with the necessary IAM policy and role bindings to enable Workload Identity.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengusingworkloadidentity.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://kubernetes.io/docs/concepts/workloads/pods/
- rule_id: oci.container_engine.cluster.rbac_authorization_mode_enabled
  service: container_engine
  resource: cluster
  requirement: RBAC Authorization Mode Enabled
  scope: container_engine.cluster.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enable RBAC Authorization Mode for OCI Container Clusters
  rationale: Enabling RBAC authorization mode in OCI Container Engine clusters is crucial for maintaining granular access control and ensuring only authorized users can perform actions on cluster resources. This reduces the risk of unauthorized access and potential data breaches, aligning with compliance requirements such as NIST and ISO 27001. Additionally, it helps in maintaining a secure and auditable environment for managing containerized applications.
  description: This check verifies if RBAC authorization mode is enabled for all container clusters within OCI. RBAC allows for fine-grained control over who can access and perform operations on cluster resources. To verify, ensure the 'rbac.authorization.kubernetes.io' setting is configured in the cluster's API server configuration. Remediation involves editing the cluster configuration to enable RBAC, which can be done via the OCI Console or CLI by setting the appropriate API server parameters.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_foundation/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://kubernetes.io/docs/reference/access-authn-authz/rbac/
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.container_engine.cluster.rbac_no_cluster_admin_bindings_to_users_enforced
  service: container_engine
  resource: cluster
  requirement: RBAC No Cluster Admin Bindings To Users Enforced
  scope: container_engine.cluster.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Prevent Direct User Assignment to Cluster Admin Role
  rationale: Directly assigning users to the cluster-admin role in OCI can lead to excessive permissions, violating the principle of least privilege. This poses a security risk by potentially allowing unauthorized access to cluster resources, which can lead to data breaches or service disruptions. Ensuring that cluster-admin roles are assigned only to groups, not individual users, helps maintain secure and manageable access control in compliance with regulatory standards.
  description: This rule checks for Kubernetes clusters in OCI where users are directly bound to the cluster-admin role. It is crucial to enforce role-based access control (RBAC) policies that prevent individual users from being assigned to the cluster-admin role, minimizing the risk of privilege escalation. To remediate, review and update the Kubernetes RBAC policies to ensure that only groups that require administrative access are bound to the cluster-admin role, and verify configurations through the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengiam.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.container_engine.cluster.rbac_no_wildcard_rules_in_clusterroles_enforced
  service: container_engine
  resource: cluster
  requirement: RBAC No Wildcard Rules In Clusterroles Enforced
  scope: container_engine.cluster.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict Wildcard Rules in OCI ClusterRoles
  rationale: Allowing wildcard rules in ClusterRoles can lead to excessive permissions that increase the risk of unauthorized access and actions within your Kubernetes cluster. This can result in potential data breaches, service disruptions, and non-compliance with security standards like NIST and PCI-DSS that mandate least privilege access control. Adhering to this rule helps protect sensitive workloads and maintain a secure posture.
  description: This rule checks for the absence of wildcard verbs ('*') in ClusterRoles within OCI Container Engine for Kubernetes. Wildcard rules can grant broad permissions, undermining the principle of least privilege. To remediate, audit ClusterRoles to remove wildcard entries and specify exact permissions needed. Use the OCI Console or CLI to update ClusterRoles, ensuring that each role has only the necessary permissions for its purpose.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengsettingupclusteraccess.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://kubernetes.io/docs/reference/access-authn-authz/rbac/
- rule_id: oci.container_engine.cluster.rbac_subjects_scoped_to_namespaces_enforced
  service: container_engine
  resource: cluster
  requirement: RBAC Subjects Scoped To Namespaces Enforced
  scope: container_engine.cluster.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enforce RBAC Subject Namespace Scoping in Clusters
  rationale: Enforcing RBAC subjects scoped to namespaces ensures that permissions are limited to specific areas within the cluster, reducing the risk of privilege escalation and unauthorized access. This is crucial for maintaining least privilege principles, protecting sensitive data, and meeting compliance requirements such as PCI-DSS and HIPAA, which mandate strict access controls.
  description: This rule checks if RBAC subjects in OCI Container Engine for Kubernetes clusters are scoped to specific namespaces, ensuring granular access control. Verify that roles and bindings are configured to limit access within namespace boundaries. Remediation involves updating RBAC policies to include namespace constraints, using Kubernetes Role and RoleBinding resources instead of ClusterRole and ClusterRoleBinding where applicable.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org
  - https://www.hhs.gov/hipaa/index.html
  - https://kubernetes.io/docs/reference/access-authn-authz/rbac/
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Reference/rbacpolicyreference.htm
- rule_id: oci.container_engine.k8s_rbac_default_sa_not_cluster_admin.k8s_rbac_default_sa_not_cluster_admin_enforced
  service: container_engine
  resource: k8s_rbac_default_sa_not_cluster_admin
  requirement: K8s RBAC Default Sa Not Cluster Admin Enforced
  scope: container_engine.k8s_rbac_default_sa_not_cluster_admin.authorization
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: critical
  title: Enforce Default Service Account Limited Access in K8s
  rationale: Assigning cluster-admin role to the default service account in Kubernetes can lead to unauthorized access and potential compromise of the entire cluster. Such over-privilege elevates the risk of data breaches and non-compliance with security standards like CIS and NIST, which mandate least privilege access to reduce attack vectors.
  description: This rule checks whether the default service account in Kubernetes is not granted cluster-admin permissions. To verify, inspect RoleBindings and ClusterRoleBindings in each namespace ensuring the default service account is not bound to the cluster-admin role. Remediation involves removing or modifying any bindings that grant excessive permissions, adhering to the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-190.pdf
  - https://kubernetes.io/docs/reference/access-authn-authz/rbac/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_guide.htm
- rule_id: oci.container_engine.k8s_rbac_no_cluster_admin_to_authenticated.k8s_rbac_no_cluster_admin_to_authenticated_enforced
  service: container_engine
  resource: k8s_rbac_no_cluster_admin_to_authenticated
  requirement: K8s RBAC No Cluster Admin To Authenticated Enforced
  scope: container_engine.k8s_rbac_no_cluster_admin_to_authenticated.authorization
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: critical
  title: Restrict Cluster Admin Role to Authenticated Users in OCI
  rationale: Allowing broad access to the 'cluster-admin' role can lead to unauthorized access and potential system compromises, posing significant security risks such as data breaches and service disruptions. Properly restricting this role helps in maintaining principle of least privilege, which is critical for minimizing attack surfaces and aligning with compliance standards like PCI-DSS and ISO 27001.
  description: This rule checks if 'cluster-admin' privileges are improperly granted to any authenticated user group in Oracle Cloud Infrastructure's Kubernetes RBAC settings. To verify, audit the RBAC configuration to ensure that the 'cluster-admin' role is only assigned to specific users or groups that require it. Remediate by adjusting the RBAC policies to remove the 'cluster-admin' role from broad assignments and restrict it to necessary personnel only, using OCI's Identity and Access Management (IAM) features.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://kubernetes.io/docs/reference/access-authn-authz/rbac/
  - https://cloud.oracle.com/cloud-infrastructure/compliance
- rule_id: oci.container_engine.k8s_rbac_wildcard_verbs_disallowed.k8s_rbac_wildcard_verbs_disallowed_enforced
  service: container_engine
  resource: k8s_rbac_wildcard_verbs_disallowed
  requirement: K8s RBAC Wildcard Verbs Disallowed Enforced
  scope: container_engine.k8s_rbac_wildcard_verbs_disallowed.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Prohibit Wildcard Verbs in K8s RBAC Policies
  rationale: Using wildcard verbs in Kubernetes RBAC policies can grant excessive permissions, posing a security risk by allowing unintended actions that may lead to privilege escalation or unauthorized access. Restricting wildcard usage helps maintain the principle of least privilege, essential for compliance with security frameworks like NIST, PCI-DSS, and ISO 27001.
  description: This rule checks for the presence of wildcard verbs ('*') in Kubernetes RBAC role and cluster role configurations within OCI's Container Engine. Wildcards should be replaced with specific verbs to limit permissions. To verify, review RBAC policies for wildcards and update them to specify precise actions. Remediation involves editing the RBAC policies in your Kubernetes cluster to replace '*' with a defined set of verbs applicable to the resource.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengcreatingclusterusingoke.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.container_engine.cluster.scheduler_authentication_kubeconfig_configured
  service: container_engine
  resource: cluster
  requirement: Scheduler Authentication Kubeconfig Configured
  scope: container_engine.cluster.authentication
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: high
  title: Ensure Kubeconfig Authentication for Scheduler in OCI Clusters
  rationale: Proper kubeconfig authentication for the Kubernetes scheduler in OCI clusters is crucial to prevent unauthorized access and potential malicious activity. This configuration mitigates risks such as privilege escalation and data exfiltration, ensuring compliance with regulatory standards like PCI-DSS and ISO 27001. By securing scheduler authentication, organizations can protect sensitive workloads and maintain the integrity of their container orchestration environment.
  description: This rule checks if kubeconfig authentication is configured for the Kubernetes scheduler in OCI Container Engine clusters. The scheduler must be set up to use kubeconfig for authentication to restrict access to authorized users only. Verification involves examining the scheduler's configuration for proper authentication parameters. Remediation requires updating the scheduler's kubeconfig file with valid credentials and enabling authentication in the cluster's settings. This measure helps maintain secure operations within OCI's container orchestration framework.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengsettingupclusteraccess.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://kubernetes.io/docs/concepts/cluster-administration/authentication/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
- rule_id: oci.container_engine.cluster.scheduler_authorization_kubeconfig_configured
  service: container_engine
  resource: cluster
  requirement: Scheduler Authorization Kubeconfig Configured
  scope: container_engine.cluster.authorization
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Kubeconfig Scheduler Authorization is Configured
  rationale: Configuring scheduler authorization in Kubernetes clusters is critical to prevent unauthorized access and actions. This reduces the risk of privilege escalation and unauthorized resource manipulation, addressing compliance with security frameworks such as NIST and ISO 27001. It ensures that only authenticated and authorized users can schedule workloads, thus protecting sensitive data and maintaining service availability.
  description: This rule checks if the Kubernetes cluster's kubeconfig file includes scheduler authorization settings. Ensuring proper configuration involves verifying that the kubeconfig file contains the necessary authentication and authorization settings. Remediation includes updating the kubeconfig file to include appropriate access controls and permissions, ensuring that scheduler operations are restricted to authorized users only.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengsecurity.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://kubernetes.io/docs/concepts/security/
- rule_id: oci.container_engine.cluster.scheduler_secure_port_tls_enabled
  service: container_engine
  resource: cluster
  requirement: Scheduler Secure Port TLS Enabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Scheduler Secure Port TLS is Enabled for Clusters
  rationale: Enabling TLS on the scheduler's secure port is crucial to protect sensitive communication between Kubernetes components against man-in-the-middle attacks and data interception. This configuration helps maintain the integrity and confidentiality of the cluster management operations, reducing the risk of unauthorized access and potential data breaches. Compliance with security frameworks such as NIST and ISO 27001 often requires robust encryption methods for data in transit.
  description: This rule checks whether the Kubernetes scheduler within an OCI Container Engine cluster has its secure port configured to use TLS. The secure port should be enabled and properly configured with TLS certificates to ensure encrypted communication. To verify, inspect the cluster's scheduler configuration file and ensure the `--secure-port` flag is set with a valid certificate. Remediation involves updating the scheduler configuration to enable TLS with appropriate certificates and keys, ensuring that the `--tls-cert-file` and `--tls-private-key-file` parameters are correctly specified.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://oracle.github.io/weblogic-kubernetes-operator/security/security-considerations/
- rule_id: oci.container_engine.cluster.k8s_scheduler_leader_election_enabled
  service: container_engine
  resource: cluster
  requirement: K8s Scheduler Leader Election Enabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure K8s Scheduler Leader Election is Enabled
  rationale: Enabling Kubernetes Scheduler Leader Election is crucial for high availability and fault tolerance in OCI Container Engine clusters. Without it, the cluster's scheduler may become a single point of failure, leading to potential disruptions in workload scheduling. This configuration enhances the resilience of Kubernetes operations, aligning with compliance frameworks that mandate robust availability and failover mechanisms.
  description: 'This rule checks if the Kubernetes Scheduler Leader Election is enabled in OCI Container Engine clusters. Leader Election ensures that a backup scheduler can assume control if the current leader fails, maintaining cluster operations seamlessly. To verify, ensure that the scheduler configuration file includes ''leaderElection: true''. Remediation involves updating the scheduler''s configuration to enable leader election, followed by a restart to apply changes.'
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengsettingupcluster.htm
  - CIS OCI Foundations Benchmark - Section 4.1
  - NIST SP 800-53 Rev. 5 - CP-9 Contingency Planning
  - https://kubernetes.io/docs/reference/command-line-tools-reference/kube-scheduler/
  - PCI-DSS v3.2.1 - Requirement 6.5
  - ISO/IEC 27001:2013 - A.12.1.3 Capacity Management
- rule_id: oci.container_engine.cluster.k8s_scheduler_profiling_disabled
  service: container_engine
  resource: cluster
  requirement: K8s Scheduler Profiling Disabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Disable Profiling on K8s Scheduler in OCI Clusters
  rationale: Disabling profiling on Kubernetes schedulers in OCI clusters minimizes the risk of exposing sensitive performance data that could be exploited by attackers. Profiling data may inadvertently reveal information about the internal workings of the scheduler, which could lead to targeted attacks or performance bottlenecks. Ensuring profiling is disabled aligns with industry best practices and supports compliance with frameworks that emphasize the principle of least privilege and data protection.
  description: This rule verifies that the profiling feature is disabled on Kubernetes schedulers within Oracle Cloud Infrastructure (OCI) Container Engine for Kubernetes clusters. Profiling, if enabled, can expose detailed performance metrics that may aid malicious actors in crafting attacks. To ensure profiling is disabled, review the scheduler configuration through the OCI Console or use the OCI CLI to check the scheduler settings. Remediation involves updating the scheduler configuration to disable profiling, thus reducing potential attack vectors.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://kubernetes.io/docs/tasks/debug-application-cluster/resource-metrics-pipeline/
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.container_engine.cluster.k8s_scheduler_secure_port_enabled
  service: container_engine
  resource: cluster
  requirement: K8s Scheduler Secure Port Enabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enable Secure Port for K8s Scheduler in OCI Clusters
  rationale: Enabling the secure port for the Kubernetes scheduler is crucial as it ensures that communications are encrypted and authenticated, protecting against unauthorized access and potential man-in-the-middle attacks. This enhances the security posture by safeguarding sensitive data transmitted between the scheduler and other Kubernetes components, aligning with security best practices and compliance mandates.
  description: This rule checks if the Kubernetes scheduler within an OCI Container Engine cluster is configured to operate on a secure port. The secure port (typically 10259) should be enabled to ensure that all API communications are encrypted using TLS. To verify, inspect the scheduler's configuration file for the '--secure-port' flag and ensure it is set to a valid port number with TLS certificates correctly configured. Remediation involves updating the scheduler configuration to enable and properly configure the secure port, followed by a restart of the scheduler component.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/#use-transport-layer-security-tls-for-all-communications
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_implementation_kubernetes.htm
- rule_id: oci.container_engine.cluster.service_account_keys_not_used_or_restricted
  service: container_engine
  resource: cluster
  requirement: Service Account Keys Not Used Or Restricted
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: high
  title: Restrict and Avoid Use of Service Account Keys in OKE Clusters
  rationale: Service account keys in Kubernetes clusters can be exploited if mismanaged, leading to unauthorized access and potential data breaches. Restricting or avoiding their use reduces attack surfaces and aligns with compliance frameworks like PCI-DSS and ISO 27001, enhancing the security of sensitive applications running on Oracle Kubernetes Engine (OKE).
  description: This rule checks for the presence and usage of service account keys in Oracle Kubernetes Engine (OKE) clusters. It ensures that service account keys are either not used or have restrictions applied to minimize exposure. Administrators should configure OKE clusters to use more secure alternatives like workload identity or short-lived tokens, and regularly review IAM policies to ensure minimal necessary permissions. Remediation involves rotating keys frequently, applying strict IAM policies, and using Oracle Cloud's built-in security tools to monitor key usage.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-iec-27001-information-security.html
  - https://cloudsecurityalliance.org/artifacts/securing-containers-and-microservices/
- rule_id: oci.container_engine.cluster.service_account_no_user_managed_long_restricted
  service: container_engine
  resource: cluster
  requirement: Service Account No User Managed Long Restricted
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Restrict User-Managed Service Accounts in OCI Clusters
  rationale: Restricting user-managed service accounts in OCI clusters reduces the risk of unauthorized access and minimizes potential attack vectors. It ensures that service accounts are not misconfigured or used to escalate privileges, aligning with security best practices and compliance mandates such as PCI-DSS and ISO 27001.
  description: This rule checks for user-managed Kubernetes service accounts within OCI Container Engine clusters that have broad permissions. It ensures that long-lived credentials are avoided, and service accounts are appropriately scoped to their intended use. To verify compliance, review service account configurations in your OCI Console and limit permissions by using roles and policies. Remediation involves auditing service accounts and adjusting their permissions to the minimum necessary for their function.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_oci_cis.htm
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.container_engine.cluster.service_account_scopes_or_roles_least_privilege_required
  service: container_engine
  resource: cluster
  requirement: Service Account Scopes Or Roles Least Privilege Required
  scope: container_engine.cluster.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for OCI Container Engine Service Accounts
  rationale: Adhering to the principle of least privilege for OCI Container Engine service accounts minimizes potential security breaches by restricting permissions to only those necessary for specific tasks. This reduces the risk of unauthorized access or actions within your Kubernetes clusters, protecting sensitive data and ensuring compliance with industry regulations such as PCI-DSS and ISO 27001.
  description: This rule checks that service accounts in OCI Container Engine clusters have the minimum necessary scopes or roles assigned. Service accounts should be configured to limit permissions to what is strictly required for their function. Administrators should audit and adjust the permissions regularly by reviewing the IAM policies associated with these accounts. Remediation involves evaluating current permissions, removing unnecessary permissions, and applying OCI IAM policies that reflect least privilege principles.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengusingserviceaccounts.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_fundamentals.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.container_engine.cluster.service_account_workload_identity_federation_used_restricted
  service: container_engine
  resource: cluster
  requirement: Service Account Workload Identity Federation Used Restricted
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Restrict Service Account Workload Identity Federation Usage
  rationale: Restricting Service Account Workload Identity Federation reduces the surface area for potential attacks by minimizing access to only necessary services and users. This control helps prevent unauthorized access and misuse of federated identities, which could lead to data breaches and compliance violations, particularly relevant in regulated industries handling sensitive information.
  description: This rule checks if Service Account Workload Identity Federation is restricted to only necessary users and services within an OCI Container Engine cluster. It ensures that federated identities are not overly permissive, which could expose the system to unauthorized access. To verify, audit the IAM policies and identity mappings to confirm that they align with the principle of least privilege. Remediation involves adjusting the IAM policies to restrict access appropriately and continuously monitoring for unauthorized changes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengusingworkloadidentity.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/compliance/
- rule_id: oci.container_engine.cluster.service_external_ips_not_used
  service: container_engine
  resource: cluster
  requirement: Service External Ips Not Used
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Avoid Using External IPs in Kubernetes Clusters
  rationale: Using external IPs for services in Kubernetes clusters increases the attack surface by exposing internal services to the internet, which can lead to unauthorized access and data breaches. This practice can also violate compliance requirements like PCI-DSS, which mandates securing cardholder data environments, and can result in significant financial and reputational damage if exploited.
  description: This rule checks for the presence of external IPs in services within Oracle Cloud Infrastructure's Kubernetes clusters. External IPs should be avoided to minimize exposure to the internet. Instead, use internal networking options such as Virtual Cloud Networks (VCNs) with proper security lists and network security groups to control access. Remediation involves updating service configurations to eliminate external IP assignments and implementing ingress controllers or API gateways for controlled public access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengnetworking.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.container_engine.node_pool.service_nodeport_usage_restricted
  service: container_engine
  resource: node_pool
  requirement: Service Nodeport Usage Restricted
  scope: container_engine.node_pool.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Restrict Service NodePort Usage in OCI Node Pools
  rationale: Exposing services via NodePort can increase the attack surface of Kubernetes clusters by allowing external traffic to access internal services. This can lead to unauthorized access and potential data breaches. Compliance with security standards such as PCI-DSS and NIST requires minimizing exposed entry points to sensitive systems.
  description: This rule checks if NodePort services are restricted within OCI Container Engine node pools. NodePort allows external traffic to access services which can be a security risk. Ensure NodePort services are only used when absolutely necessary and that proper network security rules are applied. To verify, review the Kubernetes service configuration and OCI network security rules. Remediate by using LoadBalancer service types or configuring Ingress controllers for controlled access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-190/final
  - https://kubernetes.io/docs/concepts/services-networking/service/
- rule_id: oci.container_engine.cluster.service_type_loadbalancer_internal_only_where_required
  service: container_engine
  resource: cluster
  requirement: Service Type Loadbalancer Internal Only Where Required
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Restrict Load Balancer Service Type to Internal Only Where Necessary
  rationale: Using internal-only load balancers reduces the attack surface by limiting exposure to internal network communications, thereby protecting sensitive applications and data. External load balancers increase the risk of unauthorized access and data breaches, which can lead to non-compliance with regulations like PCI-DSS and HIPAA.
  description: This rule checks for Kubernetes clusters in OCI where load balancer services are unnecessarily exposed externally. It verifies that load balancers are configured as internal-only unless external access is explicitly required. To remediate, configure the load balancer's service type to 'Internal' in the OCI Console or through the Kubernetes service manifest when external access is not needed.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengusingloadbalancer.htm
  - https://docs.cisecurity.org/benchmarks/OCI
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/
  - https://kubernetes.io/docs/concepts/services-networking/service/
- rule_id: oci.container_engine.cluster.kubelet_anonymous_auth_disabled
  service: container_engine
  resource: cluster
  requirement: Kubelet Anonymous Auth Disabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Disable Kubelet Anonymous Authentication on OCI Clusters
  rationale: Enabling anonymous authentication on kubelets can expose Kubernetes nodes to unauthorized access, increasing the risk of malicious actors exploiting cluster resources or compromising sensitive data. Disabling this setting helps protect against unauthorized control plane interactions and supports compliance with security frameworks by restricting unauthenticated access.
  description: This rule checks whether kubelet anonymous authentication is disabled on Oracle Container Engine for Kubernetes clusters. The kubelet is responsible for managing pods and containers on each node. By default, anonymous access could allow unauthenticated users to interact with the kubelet API, posing a security risk. To verify and remediate, ensure the kubelet configuration file on each node includes `--anonymous-auth=false`. Remediation involves updating the kubelet config and restarting the kubelet service.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengmodifyingcluster.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://kubernetes.io/docs/reference/access-authn-authz/kubelet-authn-authz/
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
- rule_id: oci.container_engine.cluster.kubelet_authz_webhook_or_rbac_enabled
  service: container_engine
  resource: cluster
  requirement: Kubelet Authz Webhook Or RBAC Enabled
  scope: container_engine.cluster.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Kubelet Authorization Webhook or RBAC is Enabled
  rationale: Enabling Kubelet authorization using Webhook or RBAC on OCI Container Engine clusters is crucial for enforcing granular access controls, minimizing unauthorized access risks, and protecting sensitive workloads. Without these mechanisms, clusters are vulnerable to privilege escalation and unauthorized actions, which can lead to data breaches and non-compliance with security regulations such as PCI-DSS and HIPAA.
  description: This rule checks if an OCI Container Engine cluster has Kubelet authorization configured using either the Webhook or RBAC method. Proper authorization settings ensure only authenticated requests are executed, reducing the threat landscape. To verify, inspect the cluster configuration for Webhook or RBAC settings and enable them if absent. Remediation involves updating the Kubelet configuration file to include either a valid authorization webhook URL or setting up RBAC policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengsettingupcluster.htm#RBAC
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
  - https://kubernetes.io/docs/reference/access-authn-authz/rbac/
  - https://kubernetes.io/docs/reference/access-authn-authz/webhook/
- rule_id: oci.container_engine.cluster.kubelet_read_only_port_disabled
  service: container_engine
  resource: cluster
  requirement: Kubelet Read Only Port Disabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Disable Kubelet Read Only Port in OCI Kubernetes Clusters
  rationale: Disabling the Kubelet read-only port is important to prevent unauthorized access to sensitive cluster information, which could be exploited by attackers to gain insights into the cluster's configuration and status. By securing this port, you reduce the attack surface, helping to protect against data breaches and unauthorized data manipulation, thus maintaining compliance with security frameworks like NIST SP 800-53 and ISO 27001.
  description: This rule checks if the Kubelet read-only port is disabled on all nodes within an OCI Kubernetes cluster. The read-only port, typically exposed on port 10255, should be disabled to prevent unauthenticated access to the Kubelet's API. To verify, ensure that the Kubelet's configuration file or startup parameters do not include '--read-only-port=10255'. Remediation involves updating the Kubelet configuration and restarting it to apply changes, using OCI's managed Kubernetes services to apply these changes across all nodes efficiently.
  references:
  - https://docs.oracle.com/en/solutions/deploy-kubernetes/index.html
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/
- rule_id: oci.container_engine.cluster.kubelet_tls_min_1_2_enforced
  service: container_engine
  resource: cluster
  requirement: Kubelet TLS Min 1 2 Enforced
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enforce TLS 1.2 for Kubelet in OCI Kubernetes Clusters
  rationale: Enforcing TLS 1.2 for Kubelet ensures data integrity and confidentiality between Kubernetes components, reducing the risk of man-in-the-middle attacks and data breaches. This configuration is crucial for protecting sensitive workloads running on OCI and is often required to meet regulatory standards like PCI-DSS and ISO 27001.
  description: This rule checks if TLS 1.2 is enforced for Kubelet communication within OCI Kubernetes clusters. Kubelet is a key component that interacts with container runtimes and ensures the correct running of pods. To verify, inspect the cluster's Kubelet configuration and ensure the 'tls-min-version' parameter is set to '1.2'. If not compliant, update the Kubelet configuration through the OCI Console or CLI to enforce TLS 1.2, thus enhancing the cluster's security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengsettingupcluster.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/
- rule_id: oci.container_engine.cluster.k8s_kubelet_anonymous_auth_disabled
  service: container_engine
  resource: cluster
  requirement: K8s Kubelet Anonymous Auth Disabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Kubelet Anonymous Authentication is Disabled
  rationale: Allowing anonymous authentication on Kubelet can expose the Kubernetes API to unauthorized access, leading to potential data breaches and unauthorized resource manipulations. Disabling this feature reduces the attack surface by ensuring that only authenticated and authorized users can interact with the cluster, thus aligning with security best practices and compliance requirements.
  description: This check verifies that the Kubelet configuration on an OCI Kubernetes cluster has anonymous authentication disabled. To comply, ensure the Kubelet's configuration file has the 'anonymous-auth' parameter set to 'false'. This prevents unauthenticated access to the Kubelet API, mitigating risks of unauthorized actions. Remediation involves updating the Kubelet configuration file and restarting the Kubelet service for changes to take effect.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengsecurity.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-190.pdf
  - https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-authentication-authorization/
  - https://www.oracle.com/cloud/security/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.container_engine.cluster.k8s_kubelet_client_cert_rotation_enabled
  service: container_engine
  resource: cluster
  requirement: K8s Kubelet Client Cert Rotation Enabled
  scope: container_engine.cluster.key_rotation
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enable K8s Kubelet Client Certificate Rotation in OCI Clusters
  rationale: Rotating Kubelet client certificates reduces the risk of unauthorized access due to credential compromise by ensuring certificates are regularly updated. This practice mitigates potential attack vectors, such as man-in-the-middle attacks, and aligns with security best practices and compliance frameworks that emphasize credential management.
  description: This rule verifies that K8s clusters in OCI have Kubelet client certificate rotation enabled, ensuring that certificates are automatically renewed before expiration. To check this, navigate to the OCI Container Engine settings for your cluster and verify the rotation policy. Enabling certificate rotation can be done through the OCI Console or CLI by configuring the cluster's certificate settings appropriately. Regularly review and update these settings to ensure they meet security standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengcustompolicy.htm
  - https://kubernetes.io/docs/tasks/tls/certificate-rotation/
- rule_id: oci.container_engine.cluster.k8s_kubelet_protect_kernel_defaults_enabled
  service: container_engine
  resource: cluster
  requirement: K8s Kubelet Protect Kernel Defaults Enabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure K8s Kubelet Protect Kernel Defaults is Enabled
  rationale: Enabling the K8s Kubelet Protect Kernel Defaults setting helps prevent unauthorized kernel modifications, which could lead to security vulnerabilities and non-compliance with industry standards. This setting ensures that the default kernel parameters are maintained, reducing the risk of kernel-level attacks and ensuring consistent security posture across Kubernetes nodes.
  description: This rule checks if the 'ProtectKernelDefaults' setting is enabled for the K8s Kubelet in an OCI container engine cluster. When enabled, it ensures that the kubelet does not allow changes to kernel parameters, which could weaken the security of the cluster. To verify, inspect the kubelet configuration file and ensure 'ProtectKernelDefaults' is set to true. Remediation involves updating the kubelet configuration and restarting the kubelet service to apply the changes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
  - https://kubernetes.io/docs/tasks/administer-cluster/sysctl-cluster/
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
- rule_id: oci.container_engine.cluster.k8s_kubelet_read_only_port_disabled
  service: container_engine
  resource: cluster
  requirement: K8s Kubelet Read Only Port Disabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Disable K8s Kubelet Read Only Port in OCI Clusters
  rationale: Disabling the Kubelet read-only port is crucial to prevent unauthorized access to cluster nodes, which can lead to data exposure, unauthorized operations, and potential lateral movement within the cluster. This setting is particularly important for maintaining data integrity and confidentiality, and is often required for compliance with security frameworks such as NIST and PCI-DSS.
  description: This rule checks that the Kubelet read-only port is disabled on all nodes within an Oracle Cloud Infrastructure Kubernetes cluster. The Kubelet read-only port, typically exposed on port 10255, does not require authentication and can be exploited by attackers to gain insights into the cluster's operations. To disable it, ensure that the Kubelet configuration does not expose the --read-only-port flag or explicitly sets it to 0. Verify this configuration by inspecting the Kubelet's startup parameters or configuration files. Remediation involves updating the Kubelet configuration and restarting the service.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengmodifyingcluster.htm
  - CIS Kubernetes Benchmark https://www.cisecurity.org/benchmark/kubernetes
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
  - https://cloud.oracle.com/containers
  - https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/
- rule_id: oci.analytics.analytics_instance.dashboard_export_controls_enabled
  service: analytics
  resource: analytics_instance
  requirement: Dashboard Export Controls Enabled
  scope: analytics.analytics_instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Enable Dashboard Export Controls for OCI Analytics Instances
  rationale: Enabling dashboard export controls in OCI Analytics is crucial to prevent unauthorized data extraction, which could lead to data breaches or compliance violations. This control helps organizations protect sensitive business insights and comply with data protection regulations by ensuring that only authorized users can export critical dashboard information.
  description: This rule checks if export controls are enabled on OCI Analytics dashboards, which restricts unauthorized exporting of dashboard data. To verify, ensure that the 'Export Data' option is configured to allow only specific user roles or groups. Remediation involves adjusting the permissions within the Analytics service to enforce strict access controls on data export functionalities, aligning with organizational security policies.
  references:
  - https://docs.oracle.com/en/cloud/paas/analytics-cloud/acabi/administering-oracle-analytics-cloud.html#GUID-12345
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/cloud/security/
- rule_id: oci.analytics.analytics_instance.dashboard_public_embeds_disabled
  service: analytics
  resource: analytics_instance
  requirement: Dashboard Public Embeds Disabled
  scope: analytics.analytics_instance.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Disable Public Embeds for OCI Analytics Dashboards
  rationale: Enabling public embeds for analytics dashboards can expose sensitive data to unauthorized users, leading to potential data breaches and non-compliance with data protection regulations. Unrestricted dashboard access increases the risk of information leakage and can compromise business intelligence integrity. Mitigating this exposure is crucial for maintaining confidentiality and adhering to privacy standards.
  description: This rule checks if public embeds are disabled for Oracle Cloud Infrastructure (OCI) Analytics dashboards. Publicly accessible dashboards may inadvertently share sensitive data with unauthorized parties. To verify, ensure that the 'Public Embed' setting is turned off in the OCI Analytics Instance settings. Remediation involves reviewing all dashboard configurations and disabling the public embed feature, ensuring only authenticated users have access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/analytics-home.htm
  - https://www.oracle.com/security/cloud-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.analytics.analytics_instance.dashboard_sharing_restricted_to_org
  service: analytics
  resource: analytics_instance
  requirement: Dashboard Sharing Restricted To Org
  scope: analytics.analytics_instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Dashboard Sharing to Organization in OCI Analytics
  rationale: Restricting dashboard sharing to within the organization mitigates the risk of sensitive data exposure to unauthorized external parties. It helps maintain data confidentiality and integrity by ensuring that only trusted users within the organization can access the dashboards. This is crucial for compliance with data protection regulations like GDPR and CCPA, which mandate strict controls over data sharing and access.
  description: This rule checks if the sharing settings of dashboards in OCI Analytics instances are restricted to the organization. By default, dashboards can be shared externally, posing a risk of data leakage. To verify, ensure that the 'Sharing Settings' are configured to limit access to organizational users only. Remediation involves adjusting the sharing settings in the OCI Analytics console to restrict access to users within the organization, following the principle of least privilege.
  references:
  - https://docs.oracle.com/en/cloud/paas/analytics-cloud/acabi/manage-access.html
  - https://www.oracle.com/security/cloud-security.html
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/cloud/cloud-compliance/
- rule_id: oci.analytics.analytics_instance.dashboard_sso_required
  service: analytics
  resource: analytics_instance
  requirement: Dashboard Sso Required
  scope: analytics.analytics_instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure SSO is Required for OCI Analytics Dashboards
  rationale: Requiring Single Sign-On (SSO) for accessing OCI Analytics Dashboards enhances security by centralizing authentication and reducing the risk of unauthorized access. This mitigates potential data breaches and ensures compliance with regulations that mandate secure user access management. SSO also improves user experience by simplifying access to multiple services with one set of credentials.
  description: This rule checks that SSO is enabled for OCI Analytics Instances to ensure that users authenticate through a centralized identity provider before accessing dashboards. To verify, review the identity provider settings in the OCI Console under the Analytics Instance's security configuration. Remediation involves configuring SSO by integrating your identity provider with OCI and enforcing its use for all dashboard access. This process typically involves setting up identity federation and configuring access policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/federatingIDPs.htm
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Reference/analyticssecurity.htm
  - 'NIST SP 800-53 AC-7: Unsuccessful Login Attempts'
  - CIS OCI Foundations Benchmark v1.0.0
- rule_id: oci.functions.application.app_env_secrets_from_vault_only
  service: functions
  resource: application
  requirement: App Env Secrets From Vault Only
  scope: functions.application.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure Functions App Secrets are Managed via OCI Vault
  rationale: Storing application secrets directly in the OCI Vault adds a layer of security by leveraging centralized, secure secret management. This minimizes the risk of unauthorized access, accidental exposure, or data breaches due to misconfigured permissions. Compliance frameworks such as PCI-DSS and ISO 27001 emphasize secure key management as a critical component of data protection strategies.
  description: This check verifies that all environment variables classified as secrets within Oracle Cloud Infrastructure Functions applications are sourced only from OCI Vault. To ensure this, configure your function applications to reference secrets stored in the OCI Vault service using the Oracle Functions' environment variables feature. Remediation involves auditing current environment variables, migrating hard-coded secrets to the OCI Vault, and updating function configurations to retrieve these secrets dynamically.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionsusingvaultsecrets.htm
  - https://www.oracle.com/security/cloud-security/vault/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.functions.application.app_logging_enabled
  service: functions
  resource: application
  requirement: App Logging Enabled
  scope: functions.application.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure App Logging is Enabled for OCI Functions Applications
  rationale: Enabling application logging for OCI Functions is critical as it provides visibility into function execution, aids in troubleshooting issues, and helps detect unauthorized access or anomalies. Without logging, organizations face increased risk of undetected security incidents, potentially leading to data breaches, compliance violations, and business disruptions. Logs are essential for meeting regulatory requirements and performing forensic analysis in case of security events.
  description: This rule checks if application logging is enabled for OCI Functions applications. To verify, ensure that the logging service is configured to capture function execution logs by navigating to the 'Logging' section under your Function application settings in the OCI Console. Remediation involves enabling logging and specifying the appropriate log group and log stream. This setup allows for capturing detailed logs of function executions, errors, and performance metrics, thereby facilitating effective monitoring and alerting.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionslogging.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance_overview.htm
- rule_id: oci.functions.application.app_private_networking_enforced
  service: functions
  resource: application
  requirement: App Private Networking Enforced
  scope: functions.application.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Functions Applications Use Private Networking
  rationale: Enforcing private networking for Oracle Functions applications minimizes exposure to public internet threats, reducing the risk of unauthorized access and data breaches. This enhances security by ensuring that functions can only be accessed through a specified private network, aligning with compliance requirements such as PCI-DSS and HIPAA for protecting sensitive data.
  description: This rule checks if Oracle Functions applications are configured to use App Private Networking, ensuring they are only accessible within a private subnet. Verification involves inspecting the networking configuration in the OCI Console or via CLI to confirm private endpoints are enabled. Remediation requires configuring the function's VCN and subnet settings to ensure they are set to private, thereby restricting public access and securing communication channels.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionssettingupnetwork.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2.pdf
  - https://www.hipaajournal.com/hipaa-security-rule/
- rule_id: oci.functions.application.app_tls_min_1_2_enforced
  service: functions
  resource: application
  requirement: App TLS Min 1 2 Enforced
  scope: functions.application.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure TLS 1.2 Enforced for OCI Functions Applications
  rationale: Enforcing a minimum of TLS 1.2 for OCI Functions applications is critical for protecting data in transit against interception and tampering. By not enforcing modern encryption protocols, organizations risk exposure to vulnerabilities in older TLS versions, which can lead to data breaches and non-compliance with regulatory standards such as PCI-DSS and GDPR.
  description: This rule checks whether OCI Functions applications enforce a minimum of TLS 1.2 for secure communications. To verify compliance, inspect the application configuration within the OCI Console to ensure that the TLS version is set to at least 1.2. Remediation involves updating the application's security settings to enforce TLS 1.2 or higher, thereby ensuring robust encryption for data in transit.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionsconfiguring.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-52/rev-2/final
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.container_engine.cluster.cluster_audit_logging_enabled
  service: container_engine
  resource: cluster
  requirement: Cluster Audit Logging Enabled
  scope: container_engine.cluster.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Audit Logging for OCI Container Engine Clusters
  rationale: Enabling audit logging for OCI Container Engine clusters is crucial for maintaining visibility over cluster activities, which helps in detecting unauthorized access, tracking configuration changes, and ensuring accountability. This practice supports compliance with regulatory standards such as PCI-DSS and ISO 27001, mitigating risks of data breaches and insider threats.
  description: This rule ensures that audit logging is enabled for OCI Container Engine clusters. Audit logs capture events related to Kubernetes API activities, providing critical insights for security monitoring and incident investigation. Verify this setting by checking the 'Audit Logs' in the OCI console under the Logging service. To enable audit logging, navigate to the cluster's settings in the OCI console and configure the logging policy to capture relevant events. Regularly review these logs to identify any suspicious activities and maintain security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/cis-benchmarks/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://kubernetes.io/docs/tasks/debug-application-cluster/audit/
- rule_id: oci.container_engine.cluster.cluster_default_service_account_automount_disabled
  service: container_engine
  resource: cluster
  requirement: Cluster Default Service Account Automount Disabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Disable Automount for Default Service Account in OCI Clusters
  rationale: Disabling automount for the default service account in OCI clusters reduces the risk of unauthorized access to the Kubernetes API server by limiting the attack surface. Service accounts with unnecessary access can be exploited by attackers to gain access to sensitive resources, leading to potential data breaches. This practice aligns with security best practices and compliance requirements by ensuring least privilege is maintained.
  description: This rule checks if the automount feature of the default service account in OCI Kubernetes clusters is disabled. By default, Kubernetes automatically mounts tokens into pods, which could be misused if not controlled. To verify, inspect the service account settings in your cluster and ensure the 'automountServiceAccountToken' is set to 'false' for the default service account. Remediation involves updating the service account configuration using OCI CLI or the Kubernetes API to disable automounting, thereby reducing unnecessary exposure.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengsettingfirewallbut.html
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
  - https://kubernetes.io/docs/concepts/configuration/secret/#service-account-token-volume-projection
  - https://cloud.oracle.com/security/compliance
  - https://www.oracle.com/security/cloud-compliance/
- rule_id: oci.container_engine.cluster.cluster_private_control_plane_endpoint_enabled
  service: container_engine
  resource: cluster
  requirement: Cluster Private Control Plane Endpoint Enabled
  scope: container_engine.cluster.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Enable Private Control Plane Endpoint for OCI Clusters
  rationale: Enabling a private control plane endpoint for OCI Container Engine clusters minimizes exposure to the public internet, reducing potential attack vectors and enhancing security. This is particularly critical for protecting sensitive workloads and maintaining compliance with data protection standards that require restricted access to management interfaces. It helps mitigate risks associated with unauthorized access and data breaches.
  description: This rule checks whether the OCI Container Engine cluster is configured with a private control plane endpoint, ensuring that access to the Kubernetes API server is restricted to a private network. To verify, ensure the cluster's control plane endpoint is set to private in the OCI Console or via CLI. Remediation involves configuring the cluster with a private endpoint, which may require setting up a VCN and appropriate security rules to manage access. This enhances security by limiting control plane access to within the specified network.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengcreatingcluster.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.oracle.com/security/cloud-security/cspm/
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
- rule_id: oci.container_engine.cluster.cluster_secrets_encryption_kms_enabled
  service: container_engine
  resource: cluster
  requirement: Cluster Secrets Encryption KMS Enabled
  scope: container_engine.cluster.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable KMS for Cluster Secrets Encryption in OCI
  rationale: Encrypting cluster secrets with KMS in OCI mitigates the risk of unauthorized access to sensitive data, enhancing data protection and aligning with compliance mandates such as GDPR and HIPAA. This ensures that even if the infrastructure is compromised, the secrets remain secure and inaccessible without proper decryption keys.
  description: This rule checks whether Oracle Cloud Infrastructure Container Engine for Kubernetes (OKE) clusters have Key Management Service (KMS) enabled for encrypting Kubernetes secrets. To verify, assess cluster configurations for KMS integration. Remediation involves configuring the cluster to use OCI KMS for secret encryption, ensuring all secrets are encrypted at rest using managed keys. This enhances security by leveraging OCI's robust key management capabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/cloud/cloud-native/container-engine/
- rule_id: oci.compute.instance.app_env_secrets_from_vault_only
  service: compute
  resource: instance
  requirement: App Env Secrets From Vault Only
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: high
  title: Ensure Compute Instances Use Vault for App Secrets
  rationale: Storing application secrets directly on compute instances poses a significant security risk as it increases the potential for unauthorized access. Using Oracle Cloud Infrastructure Vault to manage secrets enhances security by providing centralized management, encryption, and auditing capabilities. This practice mitigates risks of data breaches, supports compliance with regulations such as PCI-DSS and HIPAA, and ensures that sensitive information is accessed only by authorized entities.
  description: This rule verifies that all application environment secrets on OCI compute instances are sourced exclusively from the Oracle Cloud Infrastructure Vault service. This check ensures that secrets are stored and managed securely, leveraging OCI Vault's encryption and access management capabilities. To comply, review instance configurations and ensure that secrets are not hard-coded or stored in plaintext on the instance. Use OCI Vault to create and manage secrets, and modify applications to retrieve secrets dynamically from the Vault.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingvaults.htm
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/computeusinginstancecredentials.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-security/vault/
- rule_id: oci.compute.instance.app_logging_enabled
  service: compute
  resource: instance
  requirement: App Logging Enabled
  scope: compute.instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Application Logging Is Enabled for Compute Instances
  rationale: Enabling application logging on OCI compute instances is crucial for monitoring system behavior, detecting unauthorized access attempts, and troubleshooting operational issues. This logging capability helps in maintaining a secure and compliant environment by providing visibility into application activities, which is essential for meeting regulatory requirements such as PCI-DSS and HIPAA. Failure to enable logging can result in undetected security incidents and non-compliance with industry standards.
  description: This rule checks if application logging is enabled for OCI compute instances by verifying that the OCI Logging service is configured to capture application logs. To comply, ensure that the logging agent is installed and properly configured on each instance to send logs to the OCI Logging service. Remediation involves setting up the OCI Logging service, configuring the logging agent on the instance, and ensuring logs are being captured and retained according to your organization's policy.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/computeinstanceagent.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss_v3-2-1
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.compute.instance.app_private_networking_enforced
  service: compute
  resource: instance
  requirement: App Private Networking Enforced
  scope: compute.instance.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Enforce App Private Networking for Compute Instances
  rationale: Ensuring that compute instances are configured with private networking reduces the attack surface by limiting exposure to public internet threats. This helps protect sensitive applications and data from unauthorized access and mitigates risks associated with public IP addresses. Compliance with regulations such as PCI-DSS and ISO 27001 often requires strict controls on network access, making private networking a crucial component of a secure cloud environment.
  description: This rule verifies that all Oracle Cloud Infrastructure (OCI) compute instances are configured to use App Private Networking, preventing direct public internet exposure. Administrators should ensure that instances are placed within private subnets and access is managed through secure bastion hosts or VPN connections. To remediate, detach any public IPs from instances and configure the Virtual Cloud Network (VCN) to use private subnets with appropriate security lists and network security groups to control inbound and outbound traffic.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_security_baseline.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.compute.instance.app_tls_min_1_2_enforced
  service: compute
  resource: instance
  requirement: App TLS Min 1 2 Enforced
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Enforce Minimum TLS 1.2 for Compute Instances
  rationale: Enforcing TLS 1.2 or higher is critical to protect data in transit against eavesdropping and man-in-the-middle attacks, ensuring the confidentiality and integrity of sensitive data. Failure to enforce this can lead to potential data breaches and non-compliance with industry standards like PCI-DSS and HIPAA, which mandate the use of secure encryption protocols.
  description: This rule checks if compute instances are configured to enforce a minimum TLS version of 1.2 for applications handling sensitive data. To verify, ensure that your applications running on these instances are configured to reject connections that do not meet this TLS version requirement. Remediation involves updating the application configuration settings or using a load balancer that enforces the appropriate TLS version. Regular audits and updates are recommended to maintain compliance with evolving security standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/encryptingdata.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org
  - https://csrc.nist.gov/publications/detail/sp/800-52/rev-2/final
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_compliance.htm
- rule_id: oci.compute.instance.patch_approval_rules_defined_required
  service: compute
  resource: instance
  requirement: Patch Approval Rules Defined Required
  scope: compute.instance.patch_management
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: medium
  title: Ensure Patch Approval Rules Defined for OCI Compute Instances
  rationale: Without defined patch approval rules, compute instances in OCI may be vulnerable to unpatched security vulnerabilities, potentially leading to unauthorized access or data breaches. This configuration is critical for maintaining the integrity and availability of applications, ensuring compliance with regulatory frameworks like PCI-DSS and SOC2 that mandate regular patch management.
  description: This rule checks for the existence of patch approval rules for OCI compute instances, which dictate how and when patches are applied. Patch approval rules help automate the patching process, reducing the risk of human error and ensuring timely updates. To verify, navigate to the Compute service in the OCI console and review the instance patch management settings. To remediate, ensure that patch approval rules are defined by creating or updating the instance configuration to include a patch schedule aligned with organizational security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/compute_instancepatchmanagement.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security.html
- rule_id: oci.compute.instance.patch_baseline_defined_for_os_families_required
  service: compute
  resource: instance
  requirement: Patch Baseline Defined For OS Families Required
  scope: compute.instance.patch_management
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: medium
  title: Ensure Patch Baseline Set for OS Families on Compute Instances
  rationale: Defining a patch baseline for OS families in OCI compute instances is critical to maintaining system security and operational integrity. Without a standardized patching process, instances may be vulnerable to exploits targeting unpatched software, leading to potential data breaches and service disruptions. This practice supports compliance with regulatory frameworks that mandate regular security updates and system hardening.
  description: This rule checks if a patch baseline is defined and associated with OCI compute instances for specific operating system families. A patch baseline ensures that all instances adhere to a standard set of patches, reducing the risk of vulnerabilities. To verify compliance, navigate to the Oracle Cloud Infrastructure console, and ensure that each compute instance has an associated patch baseline under the 'Instance Management' section. Remediation involves creating and applying a patch baseline that includes critical updates and security patches for each OS family used in your environment.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/creatingandusingcustompatchbaselines.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.oracle.com/security-cloud-compliance/
- rule_id: oci.compute.instance.patch_maintenance_windows_configured
  service: compute
  resource: instance
  requirement: Patch Maintenance Windows Configured
  scope: compute.instance.patch_management
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: medium
  title: Ensure Patch Maintenance Windows are Configured for Instances
  rationale: Configuring patch maintenance windows for compute instances in OCI is crucial for minimizing downtime and ensuring the availability of critical applications. Without scheduled maintenance windows, instances may experience unexpected patches, leading to potential disruptions. Adhering to this practice supports compliance with operational continuity policies and enhances the security posture by applying timely patches.
  description: This rule checks whether OCI compute instances have patch maintenance windows configured, allowing for timely and predictable updates. To verify compliance, ensure that each compute instance in your environment has a defined maintenance window for applying patches. Remediation involves accessing the OCI console, navigating to the compute instance settings, and setting a preferred maintenance window that aligns with your operational requirements. This configuration aids in maintaining system stability and security by ensuring patches are applied during non-critical hours.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/schedulingmaintenance.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.compute.instance.maintenance_execution_roles_least_privilege_required
  service: compute
  resource: instance
  requirement: Maintenance Execution Roles Least Privilege Required
  scope: compute.instance.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for OCI Compute Instance Maintenance Roles
  rationale: Restricting maintenance execution roles to the least privilege principle minimizes the risk of unauthorized access and potential data breaches. It ensures that only essential permissions are granted, reducing the attack surface and helping to comply with stringent regulatory standards such as ISO 27001 and SOC 2. This practice safeguards sensitive data and maintains operational integrity by preventing privilege escalation and insider threats.
  description: This rule checks for compliance with the least privilege principle for OCI compute instance maintenance roles. It verifies that roles assigned to instances have only the necessary permissions required for maintenance tasks. To validate, review IAM policies and ensure that roles do not have excessive permissions beyond maintenance needs. Remediation involves adjusting IAM policies to limit permissions strictly to what is necessary for maintenance operations, using OCI's policy editing tools.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/policiesdefault.htm
  - https://www.oracle.com/cloud/security/cloud-security-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/cloud-security.html
- rule_id: oci.compute.instance.maintenance_window_defined_required
  service: compute
  resource: instance
  requirement: Maintenance Window Defined Required
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Enforce Maintenance Window for Compute Instances
  rationale: Defining a maintenance window for OCI compute instances mitigates the risk of unexpected downtime by scheduling updates and patches during non-peak hours. This practice minimizes potential business disruptions and aligns with best practices for operational resilience and compliance with IT governance frameworks. Failure to schedule maintenance can lead to unplanned outages that may affect availability and operational continuity.
  description: This rule checks whether a maintenance window is defined for OCI compute instances. A maintenance window specifies a time period for applying critical updates and patches, ensuring that instances remain secure and operational. To verify, navigate to the OCI Console, select 'Compute', then 'Instances', and check the 'Maintenance Preferences'. To remediate, set a maintenance window by selecting the desired instance, clicking 'Edit', and configuring maintenance preferences under 'Maintenance Options'.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/maintenancewindows.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.virtual_network.security_list.endpoint_policy_least_privilege_required
  service: virtual_network
  resource: security_list
  requirement: Endpoint Policy Least Privilege Required
  scope: virtual_network.security_list.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Security List Policies Follow Least Privilege Principle
  rationale: Implementing endpoint policies with the least privilege required reduces the attack surface by allowing only necessary traffic. This minimizes the potential for unauthorized access and data breaches, aligning with compliance requirements such as PCI-DSS and NIST. It is crucial for maintaining a secure cloud environment and protecting sensitive data from exploitation.
  description: This rule checks that security lists in OCI's virtual networks enforce endpoint policies which adhere to the principle of least privilege. Security lists should be configured to allow only specific IP addresses and ports necessary for operations. Verifying configurations involves reviewing security list rules in the OCI console to ensure minimal access permissions. Remediation includes removing overly permissive rules and adjusting them to restrict access to essential services only.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
- rule_id: oci.virtual_network.vcn.endpoint_private_dns_enabled
  service: virtual_network
  resource: vcn
  requirement: Endpoint Private Dns Enabled
  scope: virtual_network.vcn.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Enable Private DNS for VCN Endpoints
  rationale: Enabling private DNS for VCN endpoints reduces the risk of data exposure by ensuring that sensitive DNS queries do not traverse the public internet, which can help in mitigating man-in-the-middle attacks. This configuration enhances data privacy and supports compliance with data protection regulations by ensuring that DNS traffic remains within your Oracle Cloud Infrastructure, thereby reducing the attack surface.
  description: This rule checks that the Virtual Cloud Network (VCN) within Oracle Cloud Infrastructure has private DNS enabled for its endpoints. To verify, ensure that the VCN's DNS configuration is set to use private DNS zones. Remediation involves navigating to the OCI Console, selecting the appropriate VCN, and configuring its DNS settings to enable private DNS. This ensures that DNS queries are resolved using Oracle's private resolver, maintaining confidentiality and integrity of data exchanges.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/vcns.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-1-0-0-benchmark.htm
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/standard/54534.html
- rule_id: oci.database.backup.restore_from_encrypted_backups_only
  service: database
  resource: backup
  requirement: Restore From Encrypted Backups Only
  scope: database.backup.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Database Restores from Encrypted Backups Only
  rationale: Restoring databases from encrypted backups ensures that sensitive data remains protected during the backup and restore process, mitigating the risk of unauthorized data access or exposure. This practice is critical for maintaining data confidentiality, integrity, and compliance with regulations such as PCI-DSS and HIPAA, which mandate strict data protection measures. Failure to enforce encryption on backup restorations can lead to data breaches and significant financial and reputational damage.
  description: This rule verifies that all database restorations are performed using encrypted backups in Oracle Cloud Infrastructure. Administrators should ensure that backups are configured with encryption at rest, leveraging Oracle's encryption features such as TDE (Transparent Data Encryption). To verify compliance, review the encryption settings of your Oracle database backups via the OCI console or CLI, and ensure encryption is enabled. If not, reconfigure the backup settings to enable encryption and re-initiate the backup process.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/databaseoverview.htm#BackupandRestore
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/index.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.database.backup.restore_logs_and_artifacts_encrypted
  service: database
  resource: backup
  requirement: Restore Logs And Artifacts Encrypted
  scope: database.backup.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Backup Restore Logs and Artifacts Are Encrypted
  rationale: Encrypting restore logs and artifacts is crucial for protecting sensitive data from unauthorized access during restoration processes. Failure to encrypt these materials can expose sensitive information, leading to potential data breaches and non-compliance with regulations such as PCI-DSS and GDPR. Ensuring encryption helps mitigate risks of data exposure and supports organizational data protection policies.
  description: This rule checks whether the restore logs and artifacts associated with database backups in OCI are encrypted. It verifies that all restoration-related materials are secured using encryption standards provided by Oracle. To ensure compliance, users should configure database backups to utilize Oracle's built-in encryption capabilities. Remediation involves enabling encryption for database backups through the OCI console or API, ensuring that all data at rest, including logs and artifacts, are protected.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/backingup.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/capabilities/cryptography/
- rule_id: oci.resource_manager.stack.automation_change_audit_logging_enabled
  service: resource_manager
  resource: stack
  requirement: Automation Change Audit Logging Enabled
  scope: resource_manager.stack.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Audit Logging for Resource Manager Stack Automation Changes
  rationale: Enabling audit logging for automation changes in Resource Manager stacks is critical for tracking configuration changes, which helps in identifying unauthorized access and potential security breaches. This logging supports compliance with regulations such as PCI-DSS and ISO 27001, which require detailed audit trails for all changes to cloud resources. It also aids in forensic analysis by providing a clear history of actions taken on infrastructure resources.
  description: This rule checks whether audit logging is enabled for automation changes in OCI Resource Manager stacks. Audit logs capture and store all changes made to the stacks, enabling administrators to review who initiated changes and when. To verify and enable this setting, navigate to the Resource Manager console, select the specific stack, and ensure that audit logging is activated in the stack settings. Remediation involves enabling audit logging for each stack to ensure all automation changes are logged and monitored.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ResourceManager/Tasks/rmanagingstacks.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-92.pdf
- rule_id: oci.resource_manager.stack.automation_execution_roles_least_privilege_required
  service: resource_manager
  resource: stack
  requirement: Automation Execution Roles Least Privilege Required
  scope: resource_manager.stack.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Automation Stack Roles Follow Least Privilege Principle
  rationale: Applying the least privilege principle to automation execution roles in OCI Resource Manager minimizes the risk of unauthorized access and potential data breaches. Inadequate access control can lead to elevated privileges being exploited, increasing the risk of insider threats and exposing sensitive configurations. Adhering to least privilege also aligns with compliance requirements such as PCI-DSS and ISO 27001, which mandate strict access controls.
  description: This rule checks that roles assigned to automation stacks in OCI Resource Manager have only the necessary permissions required for their tasks. Review and modify IAM policies associated with automation execution roles to ensure they do not exceed the permissions needed for stack operations. Use OCI's policy editor to refine permissions and regularly audit these roles for any unnecessary privileges that could be exploited.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ResourceManager/Concepts/resourcemanager.htm
  - https://docs.oracle.com/en-us/iaas/Content/IAM/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/artifacts/cloud-controls-matrix-v4/
- rule_id: oci.resource_manager.stack.runbook_access_rbac_least_privilege_required
  service: resource_manager
  resource: stack
  requirement: Runbook Access RBAC Least Privilege Required
  scope: resource_manager.stack.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Runbook Access in OCI Resource Manager
  rationale: Implementing least privilege for runbook access minimizes potential security breaches by restricting permissions to only necessary users, thereby reducing the attack surface. This practice helps protect sensitive configurations and data within Oracle Cloud Infrastructure, ensuring compliance with regulatory standards and maintaining business integrity.
  description: This rule verifies that access to runbooks in OCI Resource Manager is restricted based on least privilege principles. It requires configuring Identity and Access Management (IAM) policies to ensure that users only have the minimum permissions necessary to perform their tasks. To remediate, review and update IAM policies to tighten access controls, ensuring that only authorized users can execute or modify runbooks. Regularly audit these policies to maintain compliance with security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - 'CIS OCI Benchmark: https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure'
  - 'NIST SP 800-53: https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf'
  - 'PCI-DSS: https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf'
  - 'OCI Resource Manager Security Best Practices: https://docs.oracle.com/en-us/iaas/Content/Security/Reference/resource-manager-security-best-practices.htm'
  - 'ISO 27001: https://www.iso.org/isoiec-27001-information-security.html'
- rule_id: oci.resource_manager.stack.runbook_change_audit_logging_enabled
  service: resource_manager
  resource: stack
  requirement: Runbook Change Audit Logging Enabled
  scope: resource_manager.stack.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Audit Logging for Resource Manager Runbook Changes
  rationale: Enabling audit logging for runbook changes in OCI Resource Manager allows organizations to track modifications, providing a historical record that is crucial for troubleshooting, forensic analysis, and compliance with regulatory standards such as PCI-DSS and SOC2. Lack of logging can result in undetected unauthorized changes, potentially leading to security breaches and non-compliance penalties.
  description: This rule verifies that audit logging is enabled for any changes made to runbooks in OCI Resource Manager stacks. To ensure logging is active, audit logs should be configured to capture all operations including creation, modification, and deletion of runbooks. Users can verify this setting by checking the 'Audit Log' settings within the OCI Console under Resource Manager configurations. Remediation involves setting up an appropriate audit policy and ensuring that logs are being collected and retained according to organizational policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ResourceManager/Concepts/resourcemanager.htm
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/sorhome.html
  - https://www.oracle.com/security/cloud-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
- rule_id: oci.resource_manager.stack.runbook_storage_encrypted_and_private
  service: resource_manager
  resource: stack
  requirement: Runbook Storage Encrypted And Private
  scope: resource_manager.stack.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Runbook Storage is Encrypted and Private
  rationale: Encrypting and restricting access to runbook storage protects sensitive operational procedures from unauthorized access and data breaches. This is vital for preventing potential leaks of proprietary information and maintaining compliance with industry regulations such as PCI-DSS and HIPAA. By ensuring runbook storage is both encrypted and private, organizations mitigate the risk of data tampering and unauthorized disclosure.
  description: This rule checks that all runbook storage within OCI Resource Manager Stacks is encrypted using Oracle-managed keys and is set to private access. Verify that encryption is enabled by checking the stack configuration in the OCI Console. To remediate, ensure the encryption settings are configured correctly and access policies are set to restrict visibility to authorized users only. Utilize OCI's Identity and Access Management (IAM) service to enforce strict access controls.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ResourceManager/Concepts/resourcemanageroverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm#encryption
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
- rule_id: oci.virtual_network.security_list.nacl_egress_restricted
  service: virtual_network
  resource: security_list
  requirement: Nacl Egress Restricted
  scope: virtual_network.security_list.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Restrict Egress Traffic in Security Lists
  rationale: Restricting egress traffic in Oracle Cloud Infrastructure Security Lists minimizes the risk of data exfiltration and reduces the attack surface by limiting unneeded outbound network connections. This is crucial for maintaining the integrity and confidentiality of sensitive data, meeting compliance requirements such as PCI-DSS, and protecting against unauthorized data transfers.
  description: This rule checks for overly permissive egress rules in OCI Security Lists. Egress rules should be configured to allow only necessary outbound traffic to specific IP addresses or CIDR blocks. To verify, review the Security List settings in the OCI Console or via CLI/API. Remediation involves modifying egress rules to restrict traffic to essential destinations only, ensuring compliance with organizational security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingsecuritylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security-cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networksecurity.htm
- rule_id: oci.virtual_network.security_list.nacl_no_allow_all_rules
  service: virtual_network
  resource: security_list
  requirement: Nacl No Allow All Rules
  scope: virtual_network.security_list.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Restrict All-Permissive Rules in Security Lists
  rationale: Allowing all traffic through security lists can lead to unauthorized access to your OCI resources, increasing the risk of data breaches and malicious activities. Restrictive rules are essential to enforce the principle of least privilege, thereby minimizing exposure to potential threats. Compliance with regulations such as PCI-DSS and ISO 27001 often requires stringent access controls to protect sensitive data.
  description: This rule examines security lists within your OCI virtual network to ensure that no rules are configured to allow all traffic, which could inadvertently expose the network to security vulnerabilities. To verify compliance, inspect each security list for rules with overly permissive settings, such as 0.0.0.0/0 for ingress or egress. Remediation involves adjusting these rules to allow only necessary traffic, based on source/destination and port/protocol requirements, using OCI console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingsecuritylists.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.cloud_guard.target.scp_mandatory_block_disabling_guardrail_services
  service: cloud_guard
  resource: target
  requirement: Scp Mandatory Block Disabling Guardrail Services
  scope: cloud_guard.target.security
  domain: resilience_and_disaster_recovery
  subcategory: backup_configuration
  severity: low
  title: Enforce SCP to Block Disabling Guardrail Services
  rationale: Enforcing Service Control Policies (SCPs) to prevent the disabling of guardrail services is crucial for maintaining the integrity and availability of critical cloud operations. This helps mitigate risks of accidental or malicious disruptions that could lead to service outages or data loss, ensuring compliance with resilience and disaster recovery mandates.
  description: This rule checks if SCPs are in place and enforced to prevent the disabling of essential guardrail services within OCI. It examines the configuration of Cloud Guard targets to ensure that policies are designed to block unauthorized changes to backup and recovery settings. Administrators should verify SCP configurations via the OCI Console or CLI and adjust policies to align with organizational security protocols, ensuring that critical services remain operational and protected.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Concepts/cloudguardoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/OCI_CIS_Benchmark_v1.1.0.pdf
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.cloud_guard.target.scp_mandatory_deny_iam_star_admin_enforced
  service: cloud_guard
  resource: target
  requirement: Scp Mandatory Deny IAM Star Admin Enforced
  scope: cloud_guard.target.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Mandatory Deny for IAM Star Admin Roles Enforced
  rationale: Enforcing a mandatory deny policy for IAM Star Admin roles is crucial because it prevents unauthorized elevation of privileges, which could lead to full control over cloud resources. This reduces the risk of accidental or malicious changes that could impact business operations, data integrity, and confidentiality. It also supports compliance with regulatory standards by ensuring that access is granted on a least privilege basis, reducing attack surfaces.
  description: This rule checks if a Service Control Policy (SCP) is in place to enforce a mandatory deny for IAM Star Admin roles within the OCI Cloud Guard target. The implementation of this policy ensures that no user or service can escalate privileges to a full admin level without explicit approval. To verify, review the current SCP configurations in the OCI console and confirm that deny rules for star admin actions are included. Remediation involves updating the SCP to include these deny rules, ensuring they are correctly applied to all relevant compartments.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/securityoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://cloudsecurityalliance.org/download/cloud-controls-matrix-v4/
- rule_id: oci.cloud_guard.target.scp_mandatory_require_mfa_for_console_where_supported
  service: cloud_guard
  resource: target
  requirement: Scp Mandatory Require MFA For Console Where Supported
  scope: cloud_guard.target.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce MFA for Console Access on OCI Cloud Guard Targets
  rationale: Requiring Multi-Factor Authentication (MFA) for console access significantly reduces the risk of unauthorized access due to compromised credentials. This control is vital for protecting sensitive resources and maintaining regulatory compliance, as it mitigates risks associated with phishing attacks and credential theft. Enforcing MFA aligns with security best practices and compliance mandates such as PCI-DSS and NIST SP 800-63B.
  description: This rule verifies that Multi-Factor Authentication (MFA) is enabled for all users accessing the OCI console on Cloud Guard targets where supported. Administrators should configure MFA by setting up identity provider integrations or using Oracle's native MFA capabilities. To remediate non-compliance, enable MFA in the OCI Identity and Access Management (IAM) settings under 'Authentication Policies'. Verify compliance by checking that all users have MFA enabled in their user profiles and audit logs indicate MFA usage.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm
  - https://www.oracle.com/security/cloud-security/cloud-guard/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-63b/final
  - https://www.oracle.com/cloud/security/compliance/
- rule_id: oci.cloud_guard.target.scp_no_allow_star_on_resources
  service: cloud_guard
  resource: target
  requirement: Scp No Allow Star On Resources
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Prevent Wildcard Permissions in Cloud Guard Targets
  rationale: Allowing wildcard '*' permissions on resources can lead to unintended access and privilege escalation. This poses a security risk as it may enable threat actors to exploit broad permissions, potentially resulting in unauthorized access to sensitive data or critical systems. Ensuring precise permission scopes supports regulatory compliance with standards such as NIST and PCI-DSS, protecting the organization's data integrity and confidentiality.
  description: This rule checks for the absence of wildcard '*' permissions in Cloud Guard target configurations, which can grant overly permissive access. To verify, review the IAM policies associated with Cloud Guard targets to ensure no permissions use '*'. Remediation involves specifying explicit resource identifiers in policy statements, thereby limiting access only to necessary entities. This control helps maintain a principle of least privilege, restricting access to essential operations only.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/policies_commonreference.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.events.rule.config_delivery_destination_access_least_privilege_required
  service: events
  resource: rule
  requirement: Config Delivery Destination Access Least Privilege Required
  scope: events.rule.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for OCI Event Rules Config Delivery
  rationale: Applying the principle of least privilege to OCI Event Rules reduces the risk of unauthorized access to sensitive configurations and prevents potential data breaches by limiting access to only necessary permissions. This is critical for compliance with security standards such as NIST and PCI-DSS, which emphasize the importance of minimal access rights to mitigate insider threats and external attacks.
  description: This rule verifies that OCI Event Rules responsible for delivering configuration data adhere to the principle of least privilege by ensuring that only necessary permissions are granted to the delivery destination. To validate, review the IAM policies associated with the Event Rules and adjust them to restrict access to only essential permissions needed for configuration delivery. Remediation involves auditing current permissions and applying stricter policies to limit potential exposure.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis.htm
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security-cloud/
- rule_id: oci.events.rule.config_delivery_kms_encryption_enabled
  service: events
  resource: rule
  requirement: Config Delivery KMS Encryption Enabled
  scope: events.rule.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure KMS Encryption for OCI Events Config Delivery
  rationale: Enabling KMS encryption for OCI Events Config Delivery ensures that configuration data is protected at rest, mitigating the risk of unauthorized access and data breaches. This is crucial for maintaining data integrity and confidentiality, especially for organizations handling sensitive information. Compliance with standards such as HIPAA or PCI-DSS often mandates encryption to safeguard sensitive data, thereby reducing legal and financial liabilities.
  description: This rule verifies that Oracle Cloud Infrastructure Events Config Delivery is configured with Key Management Service (KMS) encryption. To check, ensure that the Event Service's configuration settings specify a KMS key for encryption. If not enabled, update the configuration to integrate with OCI Vault and select an appropriate KMS key. This enhances data protection by encrypting event data at rest, leveraging OCI's managed encryption keys.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.oracle.com/security/cloud-security/
  - https://www.pcisecuritystandards.org/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.events.rule.communication_channels_configured
  service: events
  resource: rule
  requirement: Communication Channels Configured
  scope: events.rule.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Communication Channels Configured for OCI Event Rules
  rationale: Proper configuration of communication channels for OCI Event Rules is crucial for maintaining security visibility and prompt incident response. Inadequately configured channels can lead to missed alerts, resulting in delayed responses to security incidents, compliance violations, and potential data breaches. Ensuring all event rules have appropriately configured communication channels supports compliance with regulatory frameworks like PCI-DSS and ISO 27001, which mandate timely incident detection and reporting.
  description: This rule checks that communication channels, such as email or notifications, are configured for OCI Event Rules to ensure alerts are reliably sent to administrators or incident response teams. Verify that all event rules have at least one active and tested communication method associated with them. Remediation involves configuring or updating the notification service in OCI to link with event rules, ensuring messages are delivered to the correct channels. This can be done through the OCI console by navigating to the Notifications service and creating or modifying existing topics and subscriptions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Notifications/Concepts/notificationoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.events.rule.communication_destinations_access_least_privilege_required
  service: events
  resource: rule
  requirement: Communication Destinations Access Least Privilege Required
  scope: events.rule.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for OCI Events Rule Destinations
  rationale: Implementing least privilege for communication destinations in OCI Events rules is crucial for minimizing security risks by ensuring that only authorized users and systems have access to sensitive data or actions. This reduces the attack surface and mitigates the potential impact of compromised credentials or insider threats. Additionally, it supports compliance with regulations such as NIST and PCI-DSS, which mandate strict access controls and audit capabilities.
  description: This check verifies that OCI Events rules are configured to use the least privilege principle for their communication destinations. It ensures that the roles and policies associated with these rules grant only the minimum necessary permissions required to perform specific actions. Administrators should review and update IAM policies to restrict access to critical resources and regularly audit permissions to prevent privilege creep. Use the Oracle Cloud Console or CLI to inspect and modify the policies attached to each event rule.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-1-1-0-benchmark.htm
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://cloudsecurityalliance.org/artifacts/oci-security-best-practices/
- rule_id: oci.events.rule.communication_no_public_webhooks_without_auth_blocked
  service: events
  resource: rule
  requirement: Communication No Public Webhooks Without Auth Blocked
  scope: events.rule.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Block Unauthorized Public Webhook Access in OCI Events
  rationale: Public webhooks without authentication expose sensitive event data to potential eavesdropping and unauthorized access, increasing the risk of data breaches. Misconfigured webhooks can be exploited to trigger unauthorized actions, leading to operational disruptions and compliance violations under standards like PCI-DSS and SOC2.
  description: This rule checks for the presence of public webhooks in OCI Events that lack authentication mechanisms. Webhooks should be secured with a robust authentication strategy, such as OAuth tokens, to ensure that only authorized entities can access or trigger events. Remediation involves configuring webhooks with required authentication settings and ensuring they are not publicly accessible unless absolutely necessary.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://www.oracle.com/security/cspm/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/systems-management/security.html
- rule_id: oci.events.rule.streaming_security_firehose_destination_encrypted
  service: events
  resource: rule
  requirement: Streaming Security Firehose Destination Encrypted
  scope: events.rule.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Streaming Firehose Destination is Encrypted
  rationale: Encrypting data at rest in OCI Streaming ensures that sensitive data is protected from unauthorized access, reducing the risk of data breaches and ensuring compliance with regulations like GDPR and CCPA. Unencrypted data could be exposed if an unauthorized user gains access to the storage location, leading to potential legal and financial repercussions.
  description: This rule checks whether the destination for OCI Streaming Security Firehose is encrypted. It verifies if the data at rest in the specified destination is using Oracle-managed keys or customer-managed keys for encryption. To remediate, ensure that the stream's destination is set to use encryption by configuring encryption settings in the OCI Console or using the OCI CLI. Verify the encryption status by reviewing the configuration settings of the streaming destination in the OCI Console.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Concepts/streamingencryption.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.events.rule.streaming_security_firehose_destination_least_privilege_required
  service: events
  resource: rule
  requirement: Streaming Security Firehose Destination Least Privilege Required
  scope: events.rule.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for OCI Streaming Firehose Destinations
  rationale: Implementing least privilege for Streaming Firehose destinations is crucial to minimize the risk of unauthorized data access and potential data breaches. By restricting access, organizations can protect sensitive information, maintain compliance with regulatory standards like PCI-DSS and HIPAA, and prevent privilege escalation attacks that could compromise critical business operations.
  description: This check verifies that OCI Events rules configured to forward data to Streaming Firehose destinations use the least privilege principle. It ensures that IAM policies grant only the necessary permissions to resources that require access. Administrators should review policies and adjust them to remove excessive rights, ensuring roles are tightly scoped to necessary actions only. Remediation involves auditing current IAM policies, identifying over-privileged roles, and modifying them to adhere to least privilege practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Reference/iampolicyreference.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.oracle.com/cloud/cloud-compliance/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.events.rule.streaming_security_firehose_logging_enabled
  service: events
  resource: rule
  requirement: Streaming Security Firehose Logging Enabled
  scope: events.rule.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Logging for OCI Streaming Security Firehose Events
  rationale: Ensuring that logging is enabled for Streaming Security Firehose events is crucial for maintaining a secure and compliant environment. It allows for the monitoring of potentially suspicious activities, supports the detection of unauthorized access attempts, and aids in forensic investigations. This is vital for meeting regulatory requirements such as PCI-DSS and ISO 27001, which mandate comprehensive logging and monitoring practices.
  description: This rule checks whether logging is enabled for Streaming Security Firehose events in OCI. To verify, ensure that the event rule is configured to use an Oracle Cloud Infrastructure Logging service to capture and store logs. Remediation involves setting up a logging destination and associating it with the event rule to capture relevant security events. This can be done through the OCI Console by navigating to the Logging service and configuring a log group and log objects for the required streaming service.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
- rule_id: oci.events.rule.workflow_approval_steps_required_for_destructive_actions
  service: events
  resource: rule
  requirement: Workflow Approval Steps Required For Destructive Actions
  scope: events.rule.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Require Approval for Destructive Event Rules
  rationale: Requiring workflow approval for destructive actions in OCI event rules mitigates risks such as accidental or malicious deletions and modifications of critical resources. This control helps maintain compliance with regulatory standards by ensuring that potentially harmful operations are vetted through an approval process. It also aids in maintaining operational integrity and accountability in cloud environments.
  description: This rule checks whether OCI event rules that trigger destructive actions are configured with workflow approval steps. Administrators should configure event rules to require multi-level approval for actions that delete or significantly alter resources to prevent unauthorized or inadvertent execution. To verify, review the configuration of event rules in the OCI Console, ensuring that approval processes are integrated. Remediation involves setting up Oracle Cloud Infrastructure's native approval workflows or integrating with external approval systems to enforce this requirement.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/events.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_approach.htm
  - https://cloudsecurityalliance.org/artifacts/security-guidelines-for-critical-areas-of-focus-in-cloud-computing-v4-0/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations_benchmark_v1.1.0.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- rule_id: oci.events.rule.workflow_integrations_least_privilege_required
  service: events
  resource: rule
  requirement: Workflow Integrations Least Privilege Required
  scope: events.rule.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for Workflow Integrations in OCI Events
  rationale: Enforcing least privilege for workflow integrations reduces the risk of unauthorized access and potential data breaches. This principle ensures that entities have only the permissions necessary to perform their functions, minimizing the attack surface and helping meet compliance requirements such as PCI-DSS and ISO 27001.
  description: This rule checks that OCI Event rules configured for workflow integrations adhere to the principle of least privilege. Review and verify that the IAM policies grant the minimal permissions required for the workflow integrations to function. Remediation involves modifying policies to remove any excessive permissions that are not essential for the integration's operational needs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.events.rule.workflow_kms_encryption_enabled
  service: events
  resource: rule
  requirement: Workflow KMS Encryption Enabled
  scope: events.rule.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure KMS Encryption is Enabled for OCI Event Rules
  rationale: Enabling KMS encryption for OCI event rules is critical for protecting sensitive data that might be processed or stored during event handling. Without encryption, unauthorized access could lead to data breaches, violating privacy regulations such as GDPR and CCPA, and potentially resulting in financial losses and reputational damage. Compliance with security standards like PCI-DSS and ISO 27001 often mandates data encryption to safeguard against these risks.
  description: This rule checks whether Key Management Service (KMS) encryption is enabled for OCI event rules. KMS encryption helps secure the event data at rest by using encryption keys managed through Oracle's Key Management service. To verify, ensure that the event rule's configuration includes KMS encryption settings. Remediation involves configuring the event rule to use a suitable KMS key, ensuring that all data processed by the rule is encrypted. Regular audits should be conducted to ensure compliance with encryption policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.oracle.com/security/cloud-security/cspm.html
  - 'CIS OCI Benchmark: https://www.cisecurity.org/benchmark/oracle_cloud'
  - 'NIST SP 800-57: https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-4/final'
  - 'ISO/IEC 27001: https://www.iso.org/isoiec-27001-information-security.html'
- rule_id: oci.events.rule.sink_cross_account_destinations_restricted_enabled
  service: events
  resource: rule
  requirement: Sink Cross Account Destinations Restricted Enabled
  scope: events.rule.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Restrict Cross-Account Event Rule Sinks
  rationale: Restricting cross-account destinations for OCI Event Rule sinks is crucial to prevent unauthorized data flow and potential data exfiltration between tenants. Misconfigured event rules can lead to sensitive data being sent to untrusted accounts, increasing the risk of data breaches and non-compliance with data protection regulations such as GDPR and CCPA.
  description: This check ensures that Event Rules in OCI are configured to restrict sink destinations to only those within the same account. Verify that all event rules have their sink destinations properly scoped to internal resources. If cross-account access is needed, ensure that stringent IAM policies are in place. Remediation involves reviewing and updating the sink configuration and IAM policies to prevent unauthorized external data flows.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/secure-cloud-event-service.htm
  - 'CIS OCI Benchmark: 3.6 Ensure Event Rules are scoped to internal destinations'
  - 'NIST SP 800-53: AC-4 Information Flow Enforcement'
  - 'PCI-DSS Requirement 7: Restrict access to cardholder data by business need to know'
  - https://cloud.oracle.com/en_US/architecture/security-architecture
- rule_id: oci.events.rule.sink_destination_encrypted
  service: events
  resource: rule
  requirement: Sink Destination Encrypted
  scope: events.rule.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure OCI Event Sink Destinations are Encrypted
  rationale: Encrypting sink destinations for OCI Events protects sensitive data from unauthorized access and data breaches, which can lead to financial loss, reputational damage, and non-compliance with regulations like GDPR and HIPAA. Encryption at rest ensures that even if storage media are accessed or stolen, the data remains secure.
  description: This rule checks whether the sink destinations for OCI Events rules are encrypted. To verify, ensure that the target services, such as OCI Object Storage or Streaming, have encryption enabled. Remediation involves configuring the sink destination to use OCI's built-in encryption features, such as enabling server-side encryption with Oracle-managed keys or customer-managed keys. Regularly review and audit these configurations to maintain compliance and security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingyourencryptionkeys.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/privacy/laws-regulations/index.html
- rule_id: oci.events.rule.sink_destination_least_privilege_required
  service: events
  resource: rule
  requirement: Sink Destination Least Privilege Required
  scope: events.rule.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for OCI Events Sink Destinations
  rationale: Applying the principle of least privilege to OCI Events sink destinations minimizes the risk of unauthorized access and potential data breaches. Excessive permissions can expose critical systems to accidental or malicious misuse, violating compliance mandates such as PCI-DSS and ISO 27001. Properly scoped permissions protect sensitive data and maintain the integrity of event-driven workflows.
  description: This rule checks that OCI Events sink destinations are configured with the minimal permissions necessary for their operation. Administrators should audit and adjust IAM policies to ensure that each sink destination, such as Object Storage, Functions, or Notifications, has only the permissions it strictly requires. To verify, review IAM policies associated with your events rules and follow OCI's least privilege best practices. Remediate by updating overly permissive policies and regularly reviewing permissions to align with current operational needs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - https://cloudsecurityalliance.org/research/working-groups/cloud-controls-matrix
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/iamsecuritybestpractices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
- rule_id: oci.compute.cis_3_1_1_needs_development.cis_3_1_needs_development
  service: compute
  resource: cis_3_1_1_needs_development
  requirement: Cis 3 1 Needs Development
  scope: compute.cis_3_1_1_needs_development.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Compute Instances Do Not Have Public IPs in Development
  rationale: Limiting public IP exposure in development environments reduces the risk of unauthorized access and data breaches. Development instances are often less secure and more vulnerable to attacks, which can lead to data leaks or unauthorized infrastructure manipulation. Ensuring these instances are not publicly accessible aligns with best practices for security and compliance, minimizing potential attack vectors.
  description: This rule checks if compute instances in development environments are assigned public IP addresses. Instances should be configured to only use private IP addresses to reduce exposure to external threats. Verification involves reviewing instance network settings in the OCI Console to ensure public IP is not assigned. To remediate, detach any public IP from the instance and configure a private network setup using OCI Virtual Cloud Network (VCN) and subnets.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingVCNs.htm
  - https://www.oracle.com/cloud/cloud-native/cis-benchmark/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/security/cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_services.htm
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.compute.cis_3_2_11_needs_development.cis_3_2_11_needs_development
  service: compute
  resource: cis_3_2_11_needs_development
  requirement: Cis 3 2 11 Needs Development
  scope: compute.cis_3_2_11_needs_development.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Instance Configuration Uses Compartmentalized Resources
  rationale: Compartmentalizing resources in OCI helps enforce resource isolation, minimizing the risk of unauthorized access or data leakage between different workloads. Ensuring proper compartmentalization aligns with security best practices and compliance frameworks such as NIST and ISO 27001, reducing the attack surface and meeting regulatory requirements for data segregation.
  description: This rule checks if the instance configuration is using resources that are properly compartmentalized within OCI. It verifies that compute instances are assigned to the correct compartments, which helps in enforcing access controls and monitoring. To remediate, review the instance configurations and ensure they are assigned to appropriate compartments based on their functional requirements and sensitivity of data they handle. This can be done through the OCI console by navigating to the Compute service and adjusting the compartment settings for each instance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcompartments.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.streaming.stream.streaming_security_consumer_access_least_privilege_required
  service: streaming
  resource: stream
  requirement: Streaming Security Consumer Access Least Privilege Required
  scope: streaming.stream.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for OCI Streaming Consumer Access
  rationale: Restricting consumer access to OCI Streaming resources based on the principle of least privilege minimizes the potential for unauthorized data access or alteration. This approach reduces the risk of data breaches, supports compliance with regulatory frameworks like PCI-DSS and ISO 27001, and enhances overall data governance by ensuring that users have only the necessary permissions for their roles.
  description: This rule checks if OCI Streaming consumers are granted only the necessary permissions required for their specific tasks. It involves auditing IAM policies to verify that users, groups, or dynamic groups accessing the streams are not assigned excessive permissions. Remediation includes reviewing and updating policies to align with the least privilege principle, ensuring that roles are appropriately defined, and periodically reassessing access requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Tasks/streamingusingconsole.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.streaming.stream.streaming_security_consumer_auth_required
  service: streaming
  resource: stream
  requirement: Streaming Security Consumer Auth Required
  scope: streaming.stream.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Require Consumer Authentication for OCI Streaming
  rationale: Requiring consumer authentication for OCI Streaming ensures that only authorized applications and users can access streaming data. This mitigates the risk of unauthorized data access, which could lead to data breaches or leaks of sensitive information. It also helps organizations comply with data protection regulations such as GDPR and CCPA, which require strict access controls and data protection measures.
  description: This rule checks if consumer authentication is enabled for OCI Streaming services. Enabling this setting requires consumers to authenticate before accessing streams, ensuring that only authorized entities can read or process the data. Verification involves checking the stream's configuration in the OCI Console or using the OCI CLI. To remediate, enable consumer authentication by updating the stream settings in the OCI Console under the 'Security' section or use the CLI to modify the stream's configuration.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Concepts/streamingoverview.htm
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Tasks/managingstreams.htm#auth
  - https://www.oracle.com/cloud/native-streaming.html
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.nist.gov/cyberframework
- rule_id: oci.virtual_network.subnet.subnet_private_subnets_no_igw_route_enforced
  service: virtual_network
  resource: subnet
  requirement: Subnet Private Subnets No Igw Route Enforced
  scope: virtual_network.subnet.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Private Subnets Lack Internet Gateway Routes
  rationale: Allowing private subnets to route traffic through an Internet Gateway can expose sensitive resources to unauthorized access, increasing the risk of data breaches and unauthorized data exfiltration. It is crucial to adhere to security best practices by ensuring private subnets remain isolated from the public internet, aligning with compliance requirements such as PCI-DSS and SOC2.
  description: This check verifies that Oracle Cloud Infrastructure (OCI) private subnets do not have route table entries pointing to an Internet Gateway (IGW). A private subnet should be fully isolated from the internet to prevent unauthorized inbound and outbound traffic. To remediate, review the route tables associated with private subnets and ensure no routes direct traffic to an IGW. Update the route table configurations if necessary to maintain network isolation.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingroutetables.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.virtual_network.subnet.subnet_public_subnets_use_nacl_restrictions_blocked
  service: virtual_network
  resource: subnet
  requirement: Subnet Public Subnets Use Nacl Restrictions Blocked
  scope: virtual_network.subnet.public_access
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: critical
  title: Restrict Public Subnet Access with Network ACLs
  rationale: Public subnets in OCI without Network ACL restrictions can expose critical infrastructure to unauthorized access, increasing the risk of data breaches and service disruptions. By implementing and enforcing ACLs, organizations can mitigate risks associated with unauthorized access and comply with regulatory standards such as PCI-DSS and ISO 27001 that mandate controlled network access.
  description: This rule checks for the presence of Network ACL restrictions on public subnets in OCI. Public subnets should have ACLs configured to explicitly permit or deny traffic based on IP addresses and protocols to protect against unauthorized access. To verify, review the Network ACLs associated with each public subnet to ensure they have restrictive rules. Remediation involves creating or updating ACLs to apply appropriate inbound and outbound traffic restrictions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networkACLs.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_benchmark.htm
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://cloudsecurityalliance.org/
- rule_id: oci.virtual_network.subnet.subnet_route_table_association_present
  service: virtual_network
  resource: subnet
  requirement: Subnet Route Table Association Present
  scope: virtual_network.subnet.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Subnet Has an Associated Route Table
  rationale: Associating a route table with a subnet is crucial for controlling network traffic flow and ensuring correct routing of packets to and from your cloud resources. Without a proper route table, network traffic could be misrouted or dropped, leading to potential business disruptions and exposure to security risks. This also aids in meeting compliance requirements by enforcing network segmentation and access control.
  description: This check verifies that every subnet within your OCI environment has an associated route table, which is essential for defining the flow of traffic between subnets or to external networks. Without a route table, subnets may not communicate effectively, leading to connectivity issues. To remediate, ensure that each subnet is configured with a route table by navigating to the OCI Console, selecting the subnet, and ensuring a route table is set under the 'Route Table' section. Adjust configurations to include necessary routes for desired traffic flow.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingroutetables.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.key_management.key.secrets_security_alias_points_to_active_key
  service: key_management
  resource: key
  requirement: Secrets Security Alias Points To Active Key
  scope: key_management.key.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Secrets Must Reference Active Encryption Keys
  rationale: Using inactive or deleted keys for secrets can lead to data inaccessibility and potential data loss, impacting business continuity and compliance. Active keys ensure that secrets remain accessible and can be decrypted when needed, supporting regulatory requirements and protecting sensitive information from unauthorized access.
  description: This rule checks if the security alias of a secret in OCI's Key Management service points to an active key. An active key is necessary for encrypting and decrypting secrets. If a secret is associated with an inactive or deleted key, it may become unreadable. To verify, ensure that all secret aliases reference active keys in the OCI console. Remediation involves reassigning the secret to an active key or reactivating the key if it has been mistakenly deactivated.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingsecrets.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark-v1.1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/API/Concepts/signingrequests.htm
- rule_id: oci.key_management.key.secrets_security_alias_key_has
  service: key_management
  resource: key
  requirement: Secrets Security Alias Key Has
  scope: key_management.key.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure Secrets Have Associated Security Alias Key
  rationale: Properly managing secret keys is critical to maintaining the confidentiality and integrity of sensitive data. Without a security alias, secrets may become difficult to manage, leading to increased risk of unauthorized access and potential data breaches. Compliance with standards like PCI-DSS and NIST requires strict key management practices to protect sensitive information.
  description: This rule checks whether all secrets in Oracle Cloud Infrastructure (OCI) Key Management have an associated security alias key. Security aliases provide an additional layer of management and control, ensuring that secrets are correctly referenced and accessed. To verify, access the OCI console, navigate to Key Management, and ensure each secret is linked to an alias key. Remediation involves creating a security alias for any secret without one to align with best practices and compliance requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingsecrets.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/key-management.html
- rule_id: oci.key_management.key.secrets_security_kms_grant_constraints_enabled
  service: key_management
  resource: key
  requirement: Secrets Security KMS Grant Constraints Enabled
  scope: key_management.key.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Enable KMS Grant Constraints for Enhanced Secret Security
  rationale: Enabling Key Management Service (KMS) grant constraints is crucial to preventing unauthorized access to sensitive secrets, which can lead to data breaches and compliance violations. Access control granularity ensures that only designated entities have the necessary permissions, aligning with least privilege principles and regulatory requirements such as PCI-DSS and ISO 27001.
  description: This check verifies that KMS grant constraints are enabled for secrets managed in OCI. The configuration ensures that secret access is strictly controlled and audited by applying specific grants that limit the operations and resources available to users. To verify, review the KMS settings to ensure constraints are applied to secret keys, and adjust policies to restrict access based on roles and responsibilities. Remediation involves updating IAM policies to enforce grant constraints and regularly auditing permissions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/home.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managinggrants.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.key_management.key.secrets_security_kms_grant_grantee_principal_valid_enabled
  service: key_management
  resource: key
  requirement: Secrets Security KMS Grant Grantee Principal Valid Enabled
  scope: key_management.key.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure KMS Grants Have Valid and Enabled Grantee Principals
  rationale: Ensuring that KMS grants are assigned to valid and enabled grantee principals is critical to maintaining secure access controls over cryptographic keys. Unauthorized or outdated grantee principals can lead to unauthorized access, data breaches, and non-compliance with regulations such as PCI-DSS and ISO 27001. Proper management of these grants helps protect sensitive data and supports compliance with industry standards.
  description: This rule checks that all KMS grants are associated with valid and enabled grantee principals in Oracle Cloud Infrastructure. It ensures that each grantee principal is currently active and authorized to access the cryptographic keys. To verify compliance, review the KMS grants and confirm that each grantee principal is active in the OCI Identity and Access Management service. Remediation involves updating or removing any grants with invalid or disabled principals, and ensuring proper role assignments through OCI IAM policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
- rule_id: oci.key_management.key.secrets_security_kms_grant_lessthan_wildcard_permissions_enabled
  service: key_management
  resource: key
  requirement: Secrets Security KMS Grant Lessthan Wildcard Permissions Enabled
  scope: key_management.key.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure KMS Grants Do Not Use Wildcard Permissions
  rationale: Using wildcard permissions in KMS grants significantly increases the attack surface by allowing excessive access to cryptographic operations, which can lead to unauthorized data decryption or encryption, violating data integrity and confidentiality. It poses a risk of non-compliance with regulations such as PCI-DSS and ISO 27001, which mandate the principle of least privilege in access management.
  description: This rule checks for any KMS grants that use wildcard permissions, as they can lead to unintentional exposure of sensitive data. Administrators must configure KMS grants with specific, explicit permissions to ensure only authorized entities have the minimum required access. Remediation involves reviewing existing grants and modifying them to replace wildcard entries with precise permissions, using the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managinggrants.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.virtual_network.subnet.route_table_no_0_from_private_subnets_enforced
  service: virtual_network
  resource: subnet
  requirement: Route Table No 0 From Private Subnets Enforced
  scope: virtual_network.subnet.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Prevent Default Route Table Usage in Private Subnets
  rationale: Using the default route table in private subnets can inadvertently expose sensitive resources to unnecessary network routes, increasing the risk of unauthorized data access and potential security breaches. Adhering to this rule helps to ensure that private subnets remain isolated from public internet and unauthorized networks, aligning with security best practices and regulatory requirements.
  description: This rule checks for the enforcement of custom route tables without a direct 0.0.0.0/0 route in private subnets. Verify that each private subnet is associated with a custom route table that does not include a default route, preventing unintended internet exposure. Remediation involves creating a custom route table tailored to the specific needs of the private subnet, ensuring all routes comply with the desired security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/route_tables.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations_benchmark_v1.1.0
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://www.iso.org/standard/54534.html
- rule_id: oci.virtual_network.route_table.route_table_vpc_endpoints_used_for_supported
  service: virtual_network
  resource: route_table
  requirement: Route Table VPC Endpoints Used For Supported
  scope: virtual_network.route_table.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure VPC Endpoints in Route Tables Are for Supported Services
  rationale: Using VPC endpoints for supported services minimizes the risk of data exposure by ensuring that traffic between your VCN and Oracle Cloud services does not traverse the public internet. This reduces the attack surface and meets compliance requirements by enforcing secure communication channels. It also aligns with regulatory requirements like GDPR and PCI-DSS, which mandate secure data handling practices.
  description: This rule checks that route tables in Oracle Cloud Infrastructure utilize VPC endpoints for supported services, ensuring secure and private communication paths within the cloud environment. Verify that your route tables are configured with the correct service gateway targets for specific Oracle services. To remediate, update the route table to include routes that direct traffic to the appropriate service gateway, ensuring it is used for supported services only.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/usingvncs.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.virtual_network.security_list.segmentation_default_deny_between_tiers_enabled
  service: virtual_network
  resource: security_list
  requirement: Segmentation Default Deny Between Tiers Enabled
  scope: virtual_network.security_list.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Implement Default Deny Policy Between Network Tiers
  rationale: Implementing a default deny policy between network tiers is crucial for minimizing the risk of lateral movement within the cloud environment. This approach ensures that only explicitly allowed traffic can pass between tiers, reducing the attack surface and protecting sensitive data and applications from unauthorized access. It supports compliance with security frameworks such as PCI-DSS and NIST, which mandate strict network segmentation controls.
  description: This check verifies that security lists in OCI are configured to deny all traffic by default between different network tiers unless explicitly allowed. To verify, ensure that the ingress and egress rules within the security list are restrictive, allowing only specific traffic necessary for business operations. Remediation involves reviewing and updating security list rules to implement a 'deny by default' policy, ensuring that all unnecessary ports and protocols are blocked.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-41r1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.virtual_network.vcn.segmentation_exception_approvals_required
  service: virtual_network
  resource: vcn
  requirement: Segmentation Exception Approvals Required
  scope: virtual_network.vcn.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: VCN Segmentation Exception Approvals Mandatory
  rationale: Requiring approvals for segmentation exceptions in Oracle Cloud Infrastructure Virtual Cloud Networks (VCNs) mitigates the risk of unauthorized access and data breaches. It ensures that any deviation from standard network segmentation is reviewed and justified, reducing the likelihood of misconfigurations that could expose sensitive data. This practice aligns with compliance requirements such as PCI-DSS and ISO 27001, which mandate controlled and documented network changes.
  description: This rule checks if segmentation exceptions within a VCN have received the necessary approvals before being implemented. It ensures that any changes to network configurations that could lead to broader access or reduced segmentation are documented and reviewed. To verify compliance, review the change management logs and approval workflows in OCI to confirm that all exceptions have been duly approved. Remediation involves establishing a process where network changes are only implemented following documented approvals from authorized personnel.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networkoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/cloud/security/
- rule_id: oci.virtual_network.security_list.segmentation_tier_to_policies_defined_required
  service: virtual_network
  resource: security_list
  requirement: Segmentation Tier To Policies Defined Required
  scope: virtual_network.security_list.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Define Segmentation Tier Policies in OCI Security Lists
  rationale: Inadequate segmentation policies in security lists can lead to unintentional exposure of sensitive data and critical resources to unauthorized access. This increases the risk of data breaches, non-compliance with regulatory frameworks like PCI-DSS and ISO 27001, and potential financial and reputational damage. Properly defined segmentation policies help ensure that network traffic is appropriately restricted and monitored, aligning with best practices for network security and compliance.
  description: This rule checks whether security lists in OCI define explicit segmentation tier policies to control traffic between different network segments. Properly configured security lists should include ingress and egress rules that limit access to only necessary ports and protocols, based on the principle of least privilege. To verify, review the security list configurations in the OCI Console or via the OCI CLI, ensuring that specific rules segment traffic effectively. Remediation involves updating security lists to define clear rules that enforce segmentation based on the organization's network architecture and security requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/securenetwork.htm
  - https://cloudsecurityalliance.org/research/artifacts/network-segmentation-in-the-cloud
- rule_id: oci.virtual_network.security_list.isolation_automated_supported
  service: virtual_network
  resource: security_list
  requirement: Isolation Automated Supported
  scope: virtual_network.security_list.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Automate Network Isolation via OCI Security Lists
  rationale: Automating network isolation in OCI using Security Lists minimizes human error, reduces exposure to unauthorized access, and aligns with best practices for maintaining a secure cloud environment. It ensures that network segments are protected against lateral movement by malicious actors, meeting compliance requirements for data protection and access control.
  description: This rule checks if OCI Security Lists are configured to support automated isolation of network traffic, which involves using defined security rules to restrict ingress and egress traffic by default. Specific configuration settings should include setting the default rule to 'deny all' and only allowing explicitly permitted traffic. Verification involves reviewing the security list configurations via the OCI console or API. Remediation includes modifying security list rules to ensure only necessary traffic is allowed, leveraging automation tools such as Terraform or Ansible for consistent application across environments.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/standard/54534.html
  - https://www.oracle.com/cloud/security/
- rule_id: oci.virtual_network.security_list.isolation_quarantine_network_defined_required
  service: virtual_network
  resource: security_list
  requirement: Isolation Quarantine Network Defined Required
  scope: virtual_network.security_list.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Isolation Quarantine Network is Defined
  rationale: Defining an isolation quarantine network is crucial to contain and mitigate the impact of security incidents, such as malware outbreaks or unauthorized access attempts. This practice helps minimize potential data breaches by isolating compromised resources, thus protecting critical assets and maintaining business continuity. Compliance with regulatory standards often requires such proactive measures to safeguard sensitive information.
  description: This rule checks whether an isolation quarantine network is defined within your OCI security lists. Such networks should be configured with restrictive security rules that limit ingress and egress traffic, effectively isolating compromised systems. To verify, ensure that a dedicated subnet with stringent security list configurations is in place. Remediation involves creating or updating security lists to include rules that deny unauthorized access while allowing necessary internal communication for remediation purposes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.oracle.com/security-cloud/cis-benchmarks.html
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.oracle.com/security-best-practices/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_security_guide.htm
- rule_id: oci.analytics.analytics_instance.subnet_group_private_subnets_only_enforced
  service: analytics
  resource: analytics_instance
  requirement: Subnet Group Private Subnets Only Enforced
  scope: analytics.analytics_instance.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Analytics Instances Use Private Subnets Only
  rationale: Restricting analytics instances to private subnets reduces exposure to the public internet, minimizing the risk of unauthorized access and data breaches. This is crucial for protecting sensitive analytics data and maintaining compliance with privacy regulations such as GDPR and CCPA. By ensuring private networking, organizations can enforce tighter access controls and reduce the attack surface.
  description: This rule checks whether Oracle Cloud Infrastructure (OCI) Analytics instances are configured to operate only within private subnets. Private subnets do not have a public IP address, which helps safeguard analytics workloads from external threats. To verify, review the subnet configurations in the OCI Console under the Analytics service settings. Remediation involves adjusting subnet settings to ensure they are designated as private, which can be done through the OCI Console or API adjustments.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticsoverview.htm
  - https://www.oracle.com/security/cloud-security/
  - https://cloudsecurityalliance.org/research/oci/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.virtual_network.security_list.vpc_dns_hostnames_and_support_configured
  service: virtual_network
  resource: security_list
  requirement: VPC Dns Hostnames And Support Configured
  scope: virtual_network.security_list.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure VPC DNS Hostnames and Support are Properly Configured
  rationale: Configuring VPC DNS hostnames and support is crucial for network resource identification and communication within OCI. It helps avoid potential misconfigurations that can lead to network isolation or unauthorized access, impacting business operations and data integrity. Proper configuration is also essential to meet compliance requirements like ISO 27001 and NIST SP 800-53, which mandate secure and identifiable network communication.
  description: This rule checks if DNS hostnames and support are enabled for virtual network configurations. Ensuring that DNS hostnames are configured allows resources within the VPC to be easily identified and accessed, facilitating seamless communication. To verify, navigate to the VCN settings in the OCI Console and ensure that both 'DNS Hostnames' and 'DNS Support' are enabled. Remediation involves enabling these options in the 'DNS Resolution' settings of your VCN to ensure proper network operation.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/vcns.htm#dns
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1_1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.virtual_network.vcn.vpc_flow_logs_enabled
  service: virtual_network
  resource: vcn
  requirement: VPC Flow Logs Enabled
  scope: virtual_network.vcn.logging
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Enable VPC Flow Logs for Enhanced Network Monitoring
  rationale: Enabling VPC Flow Logs is critical for monitoring, analyzing, and troubleshooting network traffic within your Virtual Cloud Network (VCN). This provides visibility into network traffic patterns and aids in detecting suspicious activities, thereby reducing the risk of data breaches. It also supports compliance with regulatory frameworks that require detailed network logging, such as PCI-DSS and SOC2.
  description: This check verifies whether VPC Flow Logs are enabled for all Virtual Cloud Networks (VCNs) in Oracle Cloud Infrastructure. Enabling flow logs involves configuring logging at the subnet level to capture traffic data for analysis. To enable flow logs, navigate to the OCI Console, select your VCN, and configure logging in the subnet settings. This facilitates the identification of unusual patterns and unauthorized access attempts. Remediation steps include reviewing OCI documentation on configuring and enabling VPC Flow Logs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/vcns.htm#FlowLogs
  - https://www.oracle.com/security-best-practices/
  - https://www.oracle.com/cloud/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
- rule_id: oci.virtual_network.route_table.vpc_route_tables_no_unintended_internet_paths
  service: virtual_network
  resource: route_table
  requirement: VPC Route Tables No Unintended Internet Paths
  scope: virtual_network.route_table.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Prevent Unintended Internet Paths in VPC Route Tables
  rationale: Unintended internet paths in VPC route tables can lead to unauthorized exposure of sensitive data and resources to the public internet, increasing the risk of data breaches and cyberattacks. Properly managing route tables helps maintain network segmentation, ensuring that only intended traffic routes are enabled, aligning with compliance requirements and reducing the attack surface.
  description: This rule checks for any unintended internet access paths in OCI VPC route tables, ensuring that only explicitly allowed routes are configured. It requires reviewing the route rules to verify that no default or overly permissive routes are present that could allow traffic to bypass intended security controls. To remediate, remove or modify route rules that direct traffic to the internet unless explicitly required and documented. Regular audits and updates to route tables should be conducted to maintain secure configurations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingroutetables.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.virtual_network.security_list.eni_security_groups_present
  service: virtual_network
  resource: security_list
  requirement: Eni Security Groups Present
  scope: virtual_network.security_list.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Security Groups are Assigned to Network Interfaces
  rationale: Associating Security Groups with Elastic Network Interfaces (ENIs) is crucial for defining and enforcing network access controls. Without this configuration, there is a risk of unauthorized access to resources, potentially leading to data breaches or service disruption. Properly configured security groups help in maintaining compliance with regulatory frameworks such as PCI-DSS and ISO 27001 by ensuring that only approved traffic can reach the resources.
  description: This rule checks whether Security Groups are properly assigned to ENIs in OCI. Security Groups define a set of firewall rules that control inbound and outbound traffic at the instance level. To verify, ensure that each ENI attached to your instances has at least one Security Group configured in the OCI Console under the Virtual Cloud Network (VCN) section. Remediation involves creating or assigning existing Security Groups to ENIs to ensure proper traffic filtering and network access control.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingsecuritygroups.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.virtual_network.security_list.eni_security_groups_restrictive
  service: virtual_network
  resource: security_list
  requirement: Eni Security Groups Restrictive
  scope: virtual_network.security_list.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Restrict ENI Security Groups in Security Lists
  rationale: Restricting security groups within security lists reduces the attack surface by ensuring only authorized traffic is allowed. This minimizes potential exposure to unauthorized access, data breaches, and service disruptions, aligning with compliance requirements such as PCI-DSS and ISO 27001.
  description: This check verifies that security lists associated with Elastic Network Interfaces (ENIs) are configured to allow only necessary and specific traffic. It examines the ingress and egress rules to ensure they are not overly permissive. Remediation involves reviewing and tightening these rules, utilizing OCI's built-in features like stateful and stateless rules, to align with the principle of least privilege. Administrators should periodically audit and update these configurations to adapt to evolving security needs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/ocisecuritybestpractices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.cloud_guard.target.scan_agents_or_scanners_deployed
  service: cloud_guard
  resource: target
  requirement: Scan Agents Or Scanners Deployed
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Deployment of OCI Scan Agents or Scanners
  rationale: Deploying scan agents or scanners within OCI Cloud Guard is crucial for identifying vulnerabilities, misconfigurations, and compliance issues in real-time. This reduces the risk of data breaches, unauthorized access, and potential non-compliance with regulatory frameworks such as PCI-DSS and GDPR. Failing to deploy these tools can result in missed threats and increased exposure to cyber attacks.
  description: This rule verifies that OCI Cloud Guard targets have scan agents or scanners deployed to continuously monitor resources for vulnerabilities and security posture. To ensure compliance, check that all designated targets have either OCI Vulnerability Scanning Service agents or third-party scanner integrations active. Remediation involves deploying the necessary agents via the OCI console and configuring them to cover all critical assets, thereby enhancing monitoring and security coverage.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Concepts/scanagent.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/cis_oci_benchmark.htm
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.cloud_guard.target.scan_results_export_destination_encrypted
  service: cloud_guard
  resource: target
  requirement: Scan Results Export Destination Encrypted
  scope: cloud_guard.target.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Encrypt Scan Results Export Destination
  rationale: Encrypting scan result export destinations is crucial to protect sensitive data from unauthorized access and potential breaches. Unencrypted data at rest can be exposed to various risks, including data theft and compliance violations with standards such as PCI-DSS and GDPR, which mandate strong encryption practices to safeguard data integrity and privacy.
  description: This rule checks whether the export destinations for Cloud Guard scan results are encrypted using Oracle Cloud Infrastructure's native encryption capabilities. To verify, ensure that all storage buckets or databases used for storing scan results have encryption enabled, leveraging OCI's Key Management service. Remediation involves applying encryption to existing resources by configuring the storage destination to use OCI-managed keys or customer-managed keys for data encryption.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Concepts/overview.htm
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57p1r4.pdf
  - https://www.oracle.com/security/cloud-security/key-management/
- rule_id: oci.cloud_guard.target.scan_scope_includes_all_asset_groups
  service: cloud_guard
  resource: target
  requirement: Scan Scope Includes All Asset Groups
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Cloud Guard Scans All Asset Groups
  rationale: Ensuring Cloud Guard scans all asset groups is crucial for comprehensive threat detection and compliance management across your OCI environment. Without full scope coverage, critical vulnerabilities or policy violations in unscanned asset groups may go undetected, increasing the risk of data breaches or non-compliance with regulations such as NIST or ISO 27001.
  description: This rule checks whether the scan scope for a Cloud Guard target includes all asset groups to ensure thorough monitoring and threat detection. To verify, navigate to the Cloud Guard service in OCI, review the target configurations, and ensure that all available asset groups are included in the scan scope. If any asset groups are excluded, modify the target's configuration to include them, thereby ensuring no asset group is left unmonitored for security threats.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/overview.htm
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/configuring-targets.htm
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/standard/73906.html
  - https://docs.oracle.com/en-us/iaas/Content/CloudSecurity/Concepts/cloudsecurity.htm
- rule_id: oci.cloud_guard.target.baseline_exemptions_have_expiry_and_owner
  service: cloud_guard
  resource: target
  requirement: Baseline Exemptions Have Expiry And Owner
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Baseline Exemptions Have Expiry and Owner
  rationale: Having baseline exemptions without an expiry and owner can lead to prolonged security gaps, increasing the risk of undetected vulnerabilities. Assigning an owner ensures accountability and regular review of exemptions, while setting an expiry ensures that exemptions are periodically re-evaluated, reducing the risk of complacency and ensuring adherence to compliance standards.
  description: This rule checks that all Cloud Guard target baseline exemptions have an assigned owner and an expiry date. The owner is responsible for reviewing and renewing the exemption if necessary, ensuring that exemptions are not left unchecked indefinitely. To verify compliance, review the Cloud Guard configuration settings for each target and confirm that exemptions include both an expiry date and an owner. If not, update the configuration in the OCI Console by navigating to Cloud Guard, selecting the target, and editing the exemption details to include the required fields.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Concepts/cloudguardoverview.htm
  - https://www.oracle.com/security-cis-benchmarks/
  - https://www.nist.gov/cyberframework
  - https://blog.oracle.com/cloud-security/post/cloud-guard-improving-your-cloud-security-posture
- rule_id: oci.cloud_guard.target.baseline_required_controls_present
  service: cloud_guard
  resource: target
  requirement: Baseline Required Controls Present
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Baseline Security Controls Are Present for Cloud Guard Targets
  rationale: Having a baseline of required security controls for Cloud Guard targets is essential to maintain a consistent security posture across your OCI environment. It helps mitigate risks by ensuring critical security controls are not inadvertently omitted, which could lead to vulnerabilities being exploited. This practice supports compliance with industry standards and regulations by establishing a foundational security framework.
  description: This check verifies that all Cloud Guard targets have the baseline required security controls configured. It ensures that each target has the necessary policies and monitoring settings activated to detect and respond to security threats. To verify, review the configuration of Cloud Guard targets and ensure they include mandatory controls such as logging, alerting, and intrusion detection. Remediation involves updating any targets lacking these controls to align with the baseline security requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/index.html
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/overview.htm
  - https://cloudsecurityalliance.org/artifacts/cloud-controls-matrix-v4/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.pcisecuritystandards.org/
- rule_id: oci.waf.web_app_firewall.ip_set_sources_trusted
  service: waf
  resource: web_app_firewall
  requirement: Ip Set Sources Trusted
  scope: waf.web_app_firewall.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure IP Set Sources in WAF are Trusted
  rationale: Configuring Web Application Firewall (WAF) with trusted IP sets is crucial for mitigating unauthorized access and preventing potential attacks. Using untrusted IP sources can expose critical applications to threats such as DDoS attacks or bot traffic, impacting business continuity and potentially violating compliance requirements like PCI-DSS and ISO 27001.
  description: This rule checks whether the IP sets configured in the Oracle Cloud Infrastructure WAF are marked as trusted sources. To ensure security, review and update the IP sets to include only known and trusted IP addresses. This can be verified by examining the WAF policy settings within the OCI Console or via the OCI CLI. To remediate, access the WAF configuration in the OCI Console, navigate to the IP sets, and ensure that only legitimate and trusted IP addresses are listed.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/wafusing.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
  - https://cloudsecurityalliance.org/research/guidance/
- rule_id: oci.waf.web_app_firewall.ip_set_storage_encrypted
  service: waf
  resource: web_app_firewall
  requirement: Ip Set Storage Encrypted
  scope: waf.web_app_firewall.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure IP Set Storage is Encrypted for WAF
  rationale: Encrypting IP Set storage in Oracle Cloud Infrastructure's Web Application Firewall (WAF) is crucial to protecting sensitive IP address data from unauthorized access and potential data breaches. Unencrypted data at rest can be exploited by threat actors, leading to severe compliance violations and financial losses, especially for organizations handling regulated data or operating in industries with stringent privacy requirements.
  description: This rule checks if IP Set storage within the Oracle Cloud Infrastructure WAF is encrypted. Encryption at rest ensures that data is unreadable without proper decryption keys, mitigating risks of unauthorized access. To verify, ensure that encryption settings are enabled in the WAF configuration for IP Set storage. Remediate by navigating to the OCI Console, selecting the WAF service, and enabling encryption under the IP Set storage settings, using Oracle-managed keys or customer-managed keys as required.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Concepts/wafoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.waf.web_app_firewall.ip_set_used_by_detectors
  service: waf
  resource: web_app_firewall
  requirement: Ip Set Used By Detectors
  scope: waf.web_app_firewall.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure IP Sets are Utilized in WAF Detectors
  rationale: Using IP Sets in Web Application Firewall (WAF) detectors helps protect web applications from malicious traffic by allowing or blocking specific IPs. This reduces the attack surface and enhances security posture, preventing unauthorized access and mitigating potential data breaches. Compliance with security standards often requires stringent access controls, making this practice essential for regulatory adherence.
  description: This rule checks if IP Sets are actively used in WAF detectors within Oracle Cloud Infrastructure. IP Sets enable administrators to define a list of IP addresses that can be used to allow or block traffic in WAF policies. To validate, ensure that configured WAF policies reference IP Sets for traffic filtering. Remediation involves creating or updating WAF rules to incorporate IP Sets, which can be managed via the OCI Console under the WAF service section.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Task/wafipsets.htm
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Concepts/wafoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI-DSS-v3_2_1.pdf
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.waf.web_app_firewall.firewall_logging_enabled
  service: waf
  resource: web_app_firewall
  requirement: Firewall Logging Enabled
  scope: waf.web_app_firewall.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Web Application Firewall Logging is Enabled
  rationale: Enabling logging for the Web Application Firewall (WAF) is critical for monitoring and analyzing access patterns, detecting potential threats, and maintaining compliance with regulatory requirements. Without logging, organizations may miss signs of malicious activity and have limited visibility into the security posture of their web applications, increasing the risk of data breaches and non-compliance with standards like PCI-DSS and ISO 27001.
  description: This rule checks whether logging is enabled for OCI's Web Application Firewall (WAF) to capture and store traffic data for analysis. Logging should be configured to send data to OCI Logging service, where it can be reviewed and used to trigger alerts. To enable logging, navigate to the OCI console, select the WAF service, and configure the logging settings to ensure traffic data is captured. This includes setting up log groups and ensuring that logs are retained as per your organizational policy. Regularly review logs to identify and mitigate security threats promptly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/waflogging.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.waf.web_app_firewall.firewall_no_permit_any
  service: waf
  resource: web_app_firewall
  requirement: Firewall No Permit Any
  scope: waf.web_app_firewall.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Restrict 'Permit Any' Rules in Web Application Firewall Policies
  rationale: Allowing 'Permit Any' rules in Web Application Firewall (WAF) configurations can expose your web applications to unauthorized access and potential exploits, which may lead to data breaches, service disruptions, and non-compliance with regulations like PCI-DSS and GDPR. It is crucial to define specific, least-privileged access rules to protect sensitive data and maintain the integrity of your cloud environment.
  description: This rule checks for WAF policies configured with overly permissive 'Permit Any' rules, which can allow unrestricted access to web applications. To verify, review the WAF policy configurations in the OCI console and ensure that access rules specify allowed IPs or CIDRs rather than using 'Permit Any'. Remediation involves updating the WAF policies to include specific, restricted access controls that align with the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/wafpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security-best-practices
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.waf.web_app_firewall.firewall_rule_groups_attached
  service: waf
  resource: web_app_firewall
  requirement: Firewall Rule Groups Attached
  scope: waf.web_app_firewall.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure WAF Firewall Rule Groups Are Attached
  rationale: Attaching firewall rule groups to a Web Application Firewall (WAF) is crucial for protecting web applications from common threats like SQL injection and cross-site scripting. Without these rules, applications are vulnerable to attacks that could lead to data breaches, service disruptions, and non-compliance with standards such as PCI-DSS. Ensuring appropriate rule groups are attached mitigates these risks and enhances security posture.
  description: This rule checks if firewall rule groups are attached to the Web Application Firewall in OCI. A properly configured WAF should have rule groups that provide protection against known vulnerabilities and attacks. To verify, review the WAF configuration in the Oracle Cloud Console and ensure that rule groups are attached and configured according to your security policy. Remediation involves attaching appropriate rule groups via the Console, which can be done by navigating to the WAF service, selecting the desired WAF, and attaching necessary rule groups.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/usingwaf.htm
  - https://cloudsecurityalliance.org/blog/2021/02/01/cis-oracle-cloud-infrastructure-foundations-benchmark/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security-cloud-compliance/
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.identity.user.checks_configured
  service: identity
  resource: user
  requirement: Checks Configured
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure User Security Configurations are Properly Set
  rationale: Proper configuration of user security settings in OCI is crucial for protecting sensitive data and maintaining secure access controls. Misconfigurations can lead to unauthorized access, data breaches, and non-compliance with regulations such as PCI-DSS and SOC2. Ensuring these settings are correctly configured minimizes the risk of exposing critical resources to potential threats.
  description: This rule checks that all user accounts in OCI have appropriate security configurations set, such as multi-factor authentication (MFA) and strong password policies. Verifying these settings involves reviewing user profiles in the Oracle Cloud console to ensure compliance with security best practices. Remediation includes enabling MFA for all users, enforcing password complexity, and regularly reviewing user access logs. These steps help maintain a secure identity environment in OCI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-foundations-benchmark.html
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://cloud.oracle.com/en_US/security-best-practices
- rule_id: oci.certificates.certificate.certificates_expiration_monitored
  service: certificates
  resource: certificate
  requirement: Certificates Expiration Monitored
  scope: certificates.certificate.monitoring
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Monitor and Alert on OCI Certificate Expiration
  rationale: Monitoring certificate expirations is crucial to prevent service disruptions and maintain secure communications. Expired certificates can lead to system downtime and potential security breaches, impacting business operations and customer trust. Regular monitoring aligns with compliance requirements such as PCI DSS and ISO 27001, which mandate secure handling of cryptographic keys and certificates.
  description: This rule checks whether Oracle Cloud Infrastructure (OCI) certificates are being monitored for expiration events. Proper configuration involves setting up OCI Monitoring and Notifications to alert administrators before certificates expire. This can be achieved by configuring alarms that trigger notifications based on predefined threshold conditions related to certificate expiration dates. Remediation involves setting up these alarms in the OCI Monitoring service to ensure timely renewal of certificates.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Certificates/Tasks/managingcertificates.htm
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.container_engine.cluster.clusters_created_with_private_nodes
  service: container_engine
  resource: cluster
  requirement: Clusters Created With Private Nodes
  scope: container_engine.cluster.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure OCI Clusters Are Created With Private Nodes
  rationale: Private nodes in OCI Container Engine clusters mitigate the risk of unauthorized access by limiting exposure to the public internet. This reduces potential attack surfaces, enhances data confidentiality, and helps meet regulatory compliance such as PCI-DSS and HIPAA, which require stringent network access controls.
  description: This rule checks if OCI Container Engine clusters are configured with private nodes, ensuring nodes are not accessible over the public internet. Private networking involves configuring the cluster with a private endpoint, thus restricting access to specific IP ranges or VPN connections. To verify, inspect the cluster configuration in the OCI Console or via OCI CLI and ensure 'private networking' is enabled. Remediation involves modifying existing clusters to use private nodes and ensuring new clusters are configured with this option by default.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengcreatingcluster.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
- rule_id: oci.container_engine.cluster.clusters_public_access_disabled
  service: container_engine
  resource: cluster
  requirement: Clusters Public Access Disabled
  scope: container_engine.cluster.public_access
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: critical
  title: Disable Public Access to OCI Container Clusters
  rationale: Disabling public access to container clusters is crucial as it reduces the attack surface, preventing unauthorized access and potential data breaches. Publicly accessible clusters can be targeted by attackers to exploit vulnerabilities, leading to potential downtime, data theft, or service disruptions. Ensuring clusters are private aligns with compliance requirements such as PCI DSS and ISO 27001, promoting a secure and controlled environment.
  description: This rule checks for OCI Container Engine clusters that have public access enabled. Public access should be disabled to ensure that clusters are not exposed to the internet, minimizing the risk of unauthorized access. To verify, review the 'Endpoint' configuration of the cluster and ensure it is set to 'Private'. Remediation involves modifying the cluster settings to disable public access via the OCI Console or CLI, ensuring the cluster is only accessible through secure, private networks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/security-guidance/
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.analytics.analytics_instance.instance_network_endpoint_access_restricted
  service: analytics
  resource: analytics_instance
  requirement: Instance Network Endpoint Access Restricted
  scope: analytics.analytics_instance.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Restrict Network Endpoint Access for Analytics Instances
  rationale: Restricting network endpoint access for OCI Analytics Instances is crucial to prevent unauthorized access and potential data breaches. Limiting access ensures that only trusted networks and IP addresses can interact with critical analytics resources, reducing the risk of exposure to malicious actors. Compliance requirements such as PCI-DSS and ISO 27001 emphasize the need for stringent network access controls to protect sensitive data.
  description: This rule checks whether the network endpoint access for OCI Analytics Instances is appropriately restricted. The configuration involves setting up VCN security rules and network security groups (NSGs) to limit inbound and outbound traffic to specified IP addresses or CIDR blocks. Verification can be performed by reviewing the VCN and NSG configurations in the OCI console. Remediation involves updating security list rules and NSG policies to enforce the principle of least privilege, only allowing necessary traffic.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Tasks/analyticsnetworksecurity.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final
- rule_id: oci.analytics.analytics_instance.workgroup_encryption
  service: analytics
  resource: analytics_instance
  requirement: Workgroup Encryption
  scope: analytics.analytics_instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Workgroup Encryption for OCI Analytics Instances
  rationale: Encrypting workgroups within OCI Analytics is crucial to protect sensitive data from unauthorized access and breaches. Without encryption, data at rest is vulnerable to malicious actors and could lead to significant business losses, reputational damage, and regulatory non-compliance. Encryption supports compliance with standards such as PCI-DSS, HIPAA, and ISO 27001, which mandate data protection mechanisms.
  description: This rule checks if OCI Analytics Instances have workgroup encryption enabled by verifying the encryption settings in the OCI Console. To ensure data at rest is protected, configure the Analytics Instance to use Oracle-managed keys or your own customer-managed keys within the Key Management service. Remediation involves navigating to the Analytics Instance settings in the OCI Console, selecting the 'Security' tab, and enabling encryption for the workgroup if it is not already enabled.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticsoverview.htm#encryption
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.apigateway.certificate.certificate_enabled
  service: apigateway
  resource: certificate
  requirement: Certificate Enabled
  scope: apigateway.certificate.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure API Gateway Certificate is Enabled
  rationale: Enabling certificates for API Gateway ensures secure data transmission by encrypting data in transit. This mitigates risks of data interception and unauthorized access, aligning with compliance requirements like PCI-DSS and HIPAA which mandate encryption for data protection. Failure to enable certificates can lead to data breaches, reputational damage, and financial penalties.
  description: This rule checks if certificates are enabled for API Gateway in OCI, ensuring that data exchanged through the gateway is encrypted. Verify that SSL/TLS certificates are configured and active by accessing the API Gateway settings in the OCI Console. Remediation involves generating a certificate through OCI Certificate Service or importing a pre-existing one, and configuring the API Gateway to use it, ensuring certificate validity and renewal practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusingcerts.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_certificates.htm
  - 'PCI-DSS Requirement 4.1: Use strong cryptography and security protocols to safeguard sensitive cardholder data during transmission over open, public networks.'
  - 'NIST SP 800-53 Rev. 5: SC-12 Cryptographic Key Establishment and Management'
  - https://cloudsecurityalliance.org/research/artifacts/oci-security-best-practices/
- rule_id: oci.apigateway.gateway.gateway_restapi_logging_enabled
  service: apigateway
  resource: gateway
  requirement: Gateway Restapi Logging Enabled
  scope: apigateway.gateway.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure API Gateway Logging is Enabled
  rationale: Enabling logging for API Gateway helps in tracking and analyzing requests, which is crucial for identifying potential security incidents, debugging issues, and ensuring compliance with regulatory frameworks. Without logging, organizations risk undetected breaches and non-compliance with standards like PCI-DSS and SOC2, which require thorough audit trails.
  description: This rule checks if logging is enabled for API Gateways in OCI. API Gateway logging should be configured to capture all request-response activities, which can be verified by reviewing the API Gateway logging configuration in the OCI console. To enable logging, navigate to the API Gateway resource, select the appropriate gateway, and ensure that logging is turned on with the desired log level and retention settings. This helps in auditing and monitoring API usage effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewaylogging.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
- rule_id: oci.apigateway.gateway.gateway_restapi_tracing_enabled
  service: apigateway
  resource: gateway
  requirement: Gateway Restapi Tracing Enabled
  scope: apigateway.gateway.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Enable Rest API Tracing in API Gateway
  rationale: Enabling tracing for API Gateway provides visibility into request paths and latencies, which is crucial for identifying performance bottlenecks and detecting anomalous behaviors indicative of security threats. This feature aids in meeting compliance requirements by ensuring thorough monitoring and auditing capabilities, thereby supporting incident response and forensic analysis.
  description: This rule checks if tracing is enabled for REST APIs in Oracle Cloud Infrastructure's API Gateway. To ensure comprehensive monitoring, tracing should be activated, which can be done via the OCI Console by navigating to the API Gateway, selecting the specific gateway, and enabling tracing under the 'Logs & Tracing' section. This allows for detailed examination of API calls, aiding in performance tuning and security analysis.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewaytracing.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm#securitybestpractices
  - https://www.oracle.com/cloud-native/api-gateway/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.apigateway.gateway.gateway_api_https_required
  service: apigateway
  resource: gateway
  requirement: Gateway API HTTPS Required
  scope: apigateway.gateway.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Enforce HTTPS for OCI API Gateway Communication
  rationale: Requiring HTTPS for API Gateway ensures data integrity, confidentiality, and authenticity by encrypting data in transit. This mitigates risks such as Man-in-the-Middle (MITM) attacks and eavesdropping, which could lead to data leaks or unauthorized data manipulation. Compliance with regulations like PCI-DSS and GDPR often mandates encryption to protect sensitive information.
  description: This rule verifies that all API endpoints within the Oracle Cloud Infrastructure API Gateway enforce HTTPS protocols, ensuring secure communication channels. Administrators should configure API Gateways to only allow HTTPS and disable HTTP where possible. Remediation involves updating the API Gateway's configuration settings to enforce HTTPS, which can be verified through the Oracle Cloud Console or API. Ensure that SSL/TLS certificates are correctly configured and maintained.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusing.htm#HTTPS
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-52r1.pdf
- rule_id: oci.apigateway.gateway.gateway_restapi_waf_acl_attached
  service: apigateway
  resource: gateway
  requirement: Gateway Restapi Waf ACL Attached
  scope: apigateway.gateway.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure WAF ACL is Attached to API Gateway Rest APIs
  rationale: Attaching a Web Application Firewall (WAF) Access Control List (ACL) to your API Gateway protects the APIs from common web vulnerabilities such as SQL injection and cross-site scripting. This helps mitigate potential data breaches and service disruptions, ensuring compliance with industry standards like PCI-DSS and NIST by protecting sensitive data and maintaining service integrity.
  description: This rule checks whether a WAF ACL is attached to API Gateway Rest APIs in OCI. Without a WAF ACL, APIs are vulnerable to attacks, which can lead to data leaks and unauthorized access. To verify, review the API Gateway configuration under the OCI Console to ensure a WAF ACL is associated. Remediation involves attaching a pre-configured WAF ACL to the gateway to filter and monitor incoming traffic effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusing.htm
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/wafusing.htm
  - https://www.pcisecuritystandards.org/pci_security/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/standard/54534.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.apigateway.gateway.restapi_client_certificate_enabled
  service: apigateway
  resource: gateway
  requirement: Restapi Client Certificate Enabled
  scope: apigateway.gateway.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure REST API Client Certificate is Enabled on API Gateway
  rationale: Enabling client certificates for REST APIs on Oracle API Gateway ensures that only trusted clients can access your APIs, mitigating risks such as unauthorized access and data breaches. It supports compliance with data protection regulations like GDPR and PCI-DSS by ensuring secure client-server communication.
  description: This rule checks if client certificates are enabled for REST APIs on Oracle API Gateway. Client certificates provide an additional layer of security by requiring authentication from clients before they can connect to the gateway. To verify, ensure that the 'Client Certificate' option is enabled in the API Gateway settings. If not, update the API Gateway configuration to enforce client certificate authentication.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusingclientcerts.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_Cloud_Computing_Guidelines.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.apigateway.gateway.restapi_logging_enabled
  service: apigateway
  resource: gateway
  requirement: Restapi Logging Enabled
  scope: apigateway.gateway.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable REST API Logging for API Gateway
  rationale: Enabling logging for REST APIs in OCI API Gateway is crucial for monitoring API usage, detecting anomalies, and diagnosing issues. Without logging, it is challenging to trace requests and responses, potentially leading to undetected security incidents or compliance violations. Logging supports regulatory requirements such as PCI-DSS and enhances visibility into API operations.
  description: This rule checks whether logging is enabled for REST APIs in the OCI API Gateway. Logging should be configured to capture request and response details, which can be done through the OCI Console by navigating to the API Gateway settings and enabling logging under the 'Logging' section. To remediate, ensure that detailed logging is activated and properly configured to store logs in an OCI Logging service for analysis and retention.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewaylogging.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.apigateway.gateway.api_access_logging_enabled
  service: apigateway
  resource: gateway
  requirement: API Access Logging Enabled
  scope: apigateway.gateway.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure API Gateway Access Logging is Enabled
  rationale: Enabling API access logging is crucial for monitoring and auditing API interactions, which helps in detecting and responding to unauthorized access attempts or anomalous behavior. Without logging, organizations may struggle to meet compliance requirements such as PCI-DSS and ISO 27001, and face increased risk of data breaches due to lack of visibility into API activities.
  description: This rule checks if access logging is enabled on Oracle Cloud Infrastructure API Gateways. To verify, ensure that access log settings are configured to capture request and response data for all API endpoints. Remediation involves navigating to the API Gateway service in the OCI Console, selecting the gateway, and configuring the 'Access Logs' section to enable logging to an OCI Logging service. This action helps in retaining logs for analysis and compliance reporting.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewaylogging.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://docs.oracle.com/en-us/iaas/Content/GSG/References/compliance.htm
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.functions.application.function_identity_without_admin_privileges
  service: functions
  resource: application
  requirement: Function Identity Without Admin Privileges
  scope: functions.application.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure Function Identities Lack Admin Privileges
  rationale: Restricting administrative privileges for function identities minimizes the attack surface and helps prevent unauthorized access to sensitive resources. Functions with excessive permissions can be exploited by attackers to escalate privileges, exfiltrate data, or disrupt services, posing serious security risks. This aligns with the principle of least privilege, ensuring compliance with regulatory standards like PCI-DSS and ISO 27001, which mandate strict access controls.
  description: This rule checks that OCI function identities are not granted administrative privileges, which could lead to potential misuse or abuse. Ensure that function identities have only the necessary permissions required to perform their tasks. Verify IAM policies attached to function applications, and remove any broad or high-level permissions. Remediation involves auditing current permissions, removing excessive privileges, and implementing least privilege access using fine-grained IAM policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Concepts/functionsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/document_library
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/artifacts/oracle-cloud-security-practices/
- rule_id: oci.functions.application.function_public_access_blocked
  service: functions
  resource: application
  requirement: Function Public Access Blocked
  scope: functions.application.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure OCI Functions Application Blocks Public Access
  rationale: Blocking public access to OCI Functions applications is crucial to prevent unauthorized execution of functions, which can lead to data breaches, unauthorized data manipulation, and potential service disruptions. Ensuring functions are not publicly accessible aligns with compliance requirements such as PCI-DSS and ISO 27001, which mandate secure access controls and data protection measures.
  description: This rule checks if OCI Functions applications have been configured to prevent public access, ensuring that only authorized users within the organization can invoke functions. Verify the configuration by reviewing the associated IAM policies and network settings to ensure they restrict public access. To remediate, adjust the IAM policies to limit access to specific IP ranges or VCNs, and configure network security groups to enforce these restrictions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionscreating.htm
  - https://www.oracle.com/cloud/security/compliance/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Concepts/functionsoverview.htm
  - https://www.nist.gov/cyberframework
- rule_id: oci.functions.application.http_logs_enabled
  service: functions
  resource: application
  requirement: Http Logs Enabled
  scope: functions.application.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable HTTP Logging for OCI Functions Applications
  rationale: Enabling HTTP logs for OCI Functions applications is critical for monitoring and auditing access to serverless operations. It helps in identifying unauthorized access attempts, debugging application issues, and ensuring regulatory compliance by maintaining detailed records of HTTP requests and responses. Without logging, organizations face increased risks of undetected breaches and non-compliance with standards such as PCI-DSS and SOC2.
  description: This rule checks whether HTTP logging is enabled for applications deployed on Oracle Cloud Infrastructure Functions. To verify, ensure that the logging service is configured to capture HTTP request and response details for each function within the application. Remediation involves navigating to the OCI Console, accessing the Functions service, and enabling logging within the application's settings. This helps maintain visibility into function execution and supports compliance and security monitoring objectives.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionslogging.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
- rule_id: oci.functions.application.minimum_tls_version_12
  service: functions
  resource: application
  requirement: Minimum TLS Version 12
  scope: functions.application.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enforce Minimum TLS 1.2 for OCI Functions Applications
  rationale: Enforcing a minimum TLS version of 1.2 for OCI Functions Applications is crucial to protect data integrity and confidentiality in transit. Older TLS versions are susceptible to vulnerabilities such as POODLE and BEAST, which could lead to data breaches or unauthorized data access. Adhering to minimum TLS standards helps maintain compliance with regulatory frameworks like PCI-DSS and ensures secure communications.
  description: This rule checks if OCI Functions Applications are configured to enforce a minimum TLS version of 1.2 for secure communications. To verify compliance, review the TLS settings within the application configuration to ensure TLS 1.2 or higher is enabled. Remediation involves updating the TLS settings in the OCI Console by navigating to the specific Function Application's settings and setting the minimum TLS version to 1.2. This enhances the security posture by preventing the use of outdated and vulnerable encryption protocols.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Concepts/functions.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/OCI_CIS_Benchmark_v1.1.0.pdf
  - https://www.pcisecuritystandards.org/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-52r1.pdf
  - https://www.oracle.com/security-alerts/
  - https://csrc.nist.gov/publications/detail/sp/800-52/rev-2/final
- rule_id: oci.apigateway.gateway.field_level_logging_enabled
  service: apigateway
  resource: gateway
  requirement: Field Level Logging Enabled
  scope: apigateway.gateway.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Field Level Logging for API Gateway
  rationale: Field level logging in API Gateway is crucial for tracking specific user actions and detecting anomalies. It helps in understanding the usage patterns and identifying potential security threats, such as unauthorized access attempts. Enabling this feature is vital for meeting compliance requirements like PCI-DSS and HIPAA, where granular logging is necessary to ensure data integrity and security.
  description: This rule checks if field level logging is enabled in Oracle Cloud Infrastructure's API Gateway service. Field level logging captures detailed information about API requests and responses, which is essential for audit and incident response processes. To verify, ensure that the logging policy in the API Gateway configuration includes specific fields such as headers and request/response bodies. If not enabled, configure the API Gateway logging settings to capture these details and integrate with OCI Logging for centralized management.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewaylogging.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/sites/default/files/hipaa-simplification-201303.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.artifacts.container_repository.container_analysis_enabled
  service: artifacts
  resource: container_repository
  requirement: Container Analysis Enabled
  scope: artifacts.container_repository.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enable Container Analysis for OCI Container Repositories
  rationale: Enabling container analysis in Oracle Cloud Infrastructure (OCI) helps identify vulnerabilities, misconfigurations, and malicious content within container images, reducing the risk of deploying compromised containers in production environments. This proactive measure is vital for organizations to maintain security posture, protect sensitive data, and comply with industry standards such as PCI-DSS and ISO 27001, which mandate regular vulnerability assessments.
  description: This rule checks if container analysis is enabled for OCI container repositories, ensuring that all container images are scanned for vulnerabilities. To verify, log into the OCI Console, navigate to the 'Artifacts' service, select 'Container Repositories', and ensure that 'Container Analysis' is activated for each repository. If not enabled, configure the 'Container Analysis' settings to automatically scan images upon upload and periodically thereafter. This helps in maintaining a secure container environment by identifying and addressing security issues early in the development lifecycle.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Registry/Tasks/registryconfiguringcontaineranalysis.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/standard/54534.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_approach.htm
- rule_id: oci.analytics.analytics_instance.workgroup_logging_enabled
  service: analytics
  resource: analytics_instance
  requirement: Workgroup Logging Enabled
  scope: analytics.analytics_instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Workgroup Logging for OCI Analytics Instances
  rationale: Enabling workgroup logging on OCI Analytics instances is crucial for maintaining visibility into user activities and configurations. This provides a trail of actions for security audits, supports compliance with regulations such as PCI-DSS and SOC2, and helps identify potential unauthorized access or misconfigurations that could lead to data breaches or service disruptions.
  description: This rule checks if workgroup logging is enabled for OCI Analytics instances to ensure all user activities and changes are captured in logs. To verify, access the OCI Console, navigate to the Analytics service, and confirm that logging is turned on for each instance. If logging is not enabled, configure it by selecting the instance and enabling the 'Workgroup Logging' option. This helps in tracking user actions and supporting incident response efforts.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Tasks/analyticslogging.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/security/cloud-compliance/
- rule_id: oci.audit.configuration.cloudwatch_logging_enabled
  service: audit
  resource: configuration
  requirement: Cloudwatch Logging Enabled
  scope: audit.configuration.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure OCI Audit Logs are Integrated with Cloudwatch
  rationale: Enabling Cloudwatch logging for OCI audit logs is crucial for centralized log management, which enhances the ability to detect and respond to security incidents. It supports compliance with various regulatory standards by ensuring that audit logs are retained and accessible for auditing purposes. Failure to enable this integration can lead to fragmented logging, making it difficult to trace unauthorized activities or breaches.
  description: This rule checks whether OCI audit logs are configured to export to Cloudwatch. This involves setting up a service connector from OCI to AWS Cloudwatch, ensuring that all audit events are logged centrally. To verify compliance, ensure that the service connector is active and properly configured in your OCI console. Remediation involves creating or updating the service connector to include the Cloudwatch service as a target, ensuring that all audit logs are consistently exported and monitored.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/service-connector-hub/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/standard/54534.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.audit.configuration.enabled
  service: audit
  resource: configuration
  requirement: Enabled
  scope: audit.configuration.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure OCI Audit Configuration is Enabled
  rationale: Enabling audit logging in Oracle Cloud Infrastructure is crucial for tracking user activity and API calls, which helps in identifying security incidents and potential unauthorized access. Without audit logs, organizations face increased risk of undetected breaches and non-compliance with regulations such as PCI-DSS and ISO 27001. Audit logs provide a forensic trail necessary for investigations and support operational insights.
  description: This rule verifies that audit logging is enabled in OCI, ensuring that all API calls and user actions are recorded. To check if audit logging is enabled, navigate to the OCI Console, select the Audit service, and ensure that logging is active for all compartments. If not enabled, configure audit policies to cover all relevant compartments. Regularly review audit logs and implement alerts for suspicious activities. This setup is essential for maintaining visibility into your cloud environment and meeting compliance requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.1.htm#1.1
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.audit.configuration.kms_encryption_enabled
  service: audit
  resource: configuration
  requirement: KMS Encryption Enabled
  scope: audit.configuration.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure KMS Encryption is Enabled for Audit Logs
  rationale: Enabling KMS encryption for audit logs in OCI ensures that sensitive log data is secured at rest, mitigating the risk of unauthorized access and data breaches. This practice is critical for meeting compliance requirements such as PCI-DSS and GDPR, which mandate the protection of sensitive information. Failure to encrypt audit logs could lead to significant business impact, including financial penalties and reputational damage.
  description: This rule checks whether Key Management Service (KMS) encryption is enabled for audit logs in Oracle Cloud Infrastructure. To verify, navigate to the OCI Audit service configuration settings and ensure that encryption is set up using KMS. If not enabled, configure a KMS key and apply it to encrypt your audit logs. This ensures that the logs are protected using a robust encryption mechanism, enhancing data security and compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.audit.configuration.log_file_validation_enabled
  service: audit
  resource: configuration
  requirement: Log File Validation Enabled
  scope: audit.configuration.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Log File Validation is Enabled for OCI Audit Service
  rationale: Enabling log file validation ensures the integrity and authenticity of audit logs in Oracle Cloud Infrastructure. This is crucial for detecting unauthorized changes or tampering with logs, which can obscure malicious activities and hinder incident response efforts. It also supports compliance with standards requiring log integrity, such as PCI-DSS and ISO 27001.
  description: This rule checks whether log file validation is enabled in the OCI Audit service configuration. Log file validation uses cryptographic methods to confirm that logs have not been altered, which is vital for maintaining trustworthy audit trails. To verify, navigate to the OCI Audit service settings and ensure 'Log File Validation' is switched to 'Enabled'. If not, update the configuration accordingly. This will enhance your security posture by ensuring the reliability of your audit logs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1_0_0/oci_cis_1_0_0.htm
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-92.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.audit.configuration.logging_enabled
  service: audit
  resource: configuration
  requirement: Logging Enabled
  scope: audit.configuration.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure OCI Audit Logging is Enabled for Configurations
  rationale: Enabling audit logging for configurations in OCI is crucial for maintaining visibility into changes within your cloud environment, which is essential for detecting unauthorized access and potential security breaches. This is vital for incident response, forensic investigations, and ensuring compliance with regulatory frameworks like PCI-DSS and ISO 27001, which require comprehensive logging and monitoring practices.
  description: This rule checks that logging is enabled for all configurations in the Oracle Cloud Infrastructure's audit service. Audit logs provide a detailed record of API calls and actions performed on your OCI resources, which can be verified by accessing the OCI Console and navigating to the 'Audit' service under 'Governance and Administration'. To ensure compliance, configure audit logging by enabling it for all compartments and maintaining a retention policy that aligns with your compliance requirements. Remediation involves verifying that logging is enabled and properly configured through the OCI Console or by using the OCI CLI to ensure all critical actions are captured.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1_1.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/securityoverview.htm
- rule_id: oci.audit.configuration.logs_s3_bucket_access_logging_enabled
  service: audit
  resource: configuration
  requirement: Logs S3 Bucket Access Logging Enabled
  scope: audit.configuration.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Access Logging for OCI Object Storage Buckets
  rationale: Enabling access logging for OCI Object Storage buckets is crucial for tracking and analyzing access patterns, which helps in identifying unauthorized access attempts and data breaches. This logging capability supports compliance with regulatory frameworks such as PCI-DSS and ISO 27001, which mandate detailed access tracking and audit trails to protect sensitive data and ensure accountability.
  description: This rule checks whether access logging is enabled for OCI Object Storage buckets. Access logs provide detailed records of requests made to the bucket, including the requester, operation type, and request details. To verify, ensure that Object Storage buckets have logging enabled through the OCI Console or CLI. Remediation involves configuring the bucket to log access requests to a designated log bucket for monitoring and analysis.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingobjectstoragelogging.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss_v3-2-1
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm#ObjectStorage
- rule_id: oci.audit.configuration.logs_s3_bucket_is_public_access_blocked
  service: audit
  resource: configuration
  requirement: Logs S3 Bucket Is Public Access Blocked
  scope: audit.configuration.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: critical
  title: Ensure OCI Audit Logs Bucket Blocks Public Access
  rationale: Allowing public access to audit log buckets in OCI can lead to unauthorized access and potential data breaches, exposing sensitive information about infrastructure activities and system configurations. This poses significant security risks, including potential compliance violations with regulations like PCI-DSS and GDPR, which mandate the protection of sensitive data. Blocking public access ensures that only authorized personnel can view and manage logs, reducing the attack surface and safeguarding critical data.
  description: This rule checks if the Oracle Cloud Infrastructure (OCI) audit logs bucket has public access blocked. Specifically, it ensures that access policies and bucket configurations do not allow public read or write permissions. To verify, administrators should review OCI bucket policies and ensure they align with recommended security settings, such as disabling 'Anonymous Access'. Remediation involves updating the bucket's access policies to ensure that only specific IAM roles have permission to access audit logs, following the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/identitypolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-compliance/
- rule_id: oci.audit.configuration.monitoring_logging_enabled
  service: audit
  resource: configuration
  requirement: Monitoring Logging Enabled
  scope: audit.configuration.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Audit Configuration Logging is Enabled
  rationale: Enabling audit configuration logging is crucial for tracking activity and changes within your OCI environment, which can help identify unauthorized access or configuration changes that may lead to security breaches. It supports regulatory compliance by providing a detailed record of actions, which is essential for audits and forensic investigations. Without logging, detecting suspicious activities or policy violations becomes significantly challenging, increasing the risk of data exposure or loss.
  description: This rule checks if logging is enabled for audit configurations in Oracle Cloud Infrastructure. To verify, ensure that audit logs are being collected and retained in the Logging service, as this facilitates tracking of all API calls and changes to configuration settings. Remediation involves setting up the Logging service to capture audit events and configuring appropriate retention policies to meet your organization's needs. Refer to the OCI Audit service documentation for detailed setup instructions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - CIS Oracle Cloud Infrastructure Benchmark v1.1.0 - 1.2 Ensure audit configuration logging is enabled
  - NIST SP 800-53 Rev. 5 - AU-2 Audit Events
  - 'PCI-DSS v3.2.1 - Requirement 10: Track and monitor all access to network resources and cardholder data'
  - ISO/IEC 27001:2013 - A.12.4 Logging and monitoring
- rule_id: oci.audit.configuration.multi_region_enabled
  service: audit
  resource: configuration
  requirement: Multi Region Enabled
  scope: audit.configuration.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Multi-Region Audit Logging is Enabled
  rationale: Enabling multi-region audit logging in OCI enhances security by ensuring that audit logs are preserved even if a regional failure occurs. This is critical for meeting regulatory compliance requirements such as GDPR and PCI-DSS, which mandate the availability and integrity of logs for forensic and monitoring purposes. A failure to maintain these logs across regions can lead to data loss, incomplete audit trails, and potential legal penalties.
  description: This rule checks if audit logging is configured to operate across multiple OCI regions. Multi-region audit logging ensures that all API calls and activities are logged and duplicated in a secondary region, providing resilience against regional outages. To verify, ensure that the audit service is configured to use Object Storage in at least two regions. Remediation involves setting up a cross-region replication policy for Object Storage buckets that store audit logs, ensuring they are synchronized and available in both primary and secondary locations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations_benchmark/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://cloud.oracle.com/en_US/cloud-security/overview
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practice.htm
- rule_id: oci.audit.configuration.oke_access_verification
  service: audit
  resource: configuration
  requirement: Oke Access Verification
  scope: audit.configuration.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Verify Access to Oracle Kubernetes Engine (OKE) via Audit Logs
  rationale: Ensuring that access to Oracle Kubernetes Engine (OKE) is properly monitored helps prevent unauthorized access, data breaches, and potential service disruptions. Audit logs provide a traceable record of access attempts and modifications, crucial for incident response and compliance with regulations like PCI-DSS and ISO 27001.
  description: This rule checks the configuration of audit logs to verify that all access to Oracle Kubernetes Engine (OKE) is logged. It ensures that audit logs capture events related to authentication and authorization activities. To verify, ensure that audit logs are enabled and properly configured to capture relevant OKE access events. Remediation involves enabling audit logs and reviewing log configurations to include all critical access events.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/pci_security
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.audit.configuration.s3_dataevents_read_enabled
  service: audit
  resource: configuration
  requirement: S3 Dataevents Read Enabled
  scope: audit.configuration.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable S3 Data Events Read Logging in OCI Audit
  rationale: Enabling read logging of S3 data events is crucial for monitoring access and detecting unauthorized data exposure. This helps organizations mitigate data breach risks and meet compliance requirements such as GDPR and CCPA by ensuring visibility into how sensitive data is accessed.
  description: This rule checks whether logging for S3 data events, specifically read operations, is enabled in OCI Audit. To verify, ensure that the audit policy includes a statement for capturing read events on S3 buckets. Remediation involves creating or updating the audit policy to include logging of read actions on all applicable S3 resources, providing better oversight and security incident response capabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-foundations-benchmark-v1-0-pdf.pdf
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/compliance/gdpr/
  - https://www.oracle.com/security/cloud-security/compliance/ccpa/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.audit.configuration.s3_dataevents_write_enabled
  service: audit
  resource: configuration
  requirement: S3 Dataevents Write Enabled
  scope: audit.configuration.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable S3 Data Events Write Logging in OCI Audit
  rationale: Enabling S3 Data Events Write logging is crucial for detecting unauthorized access and potential data exfiltration activities. This practice supports compliance with data protection regulations by ensuring that write operations to S3 buckets are logged and monitored, thereby mitigating risks associated with data breaches and unauthorized data manipulations.
  description: This rule checks if write operations on S3 data events are logged in the OCI Audit service. To verify, ensure that OCI Audit is configured to capture and store logs of S3 data write activities. Remediation involves enabling logging for S3 write events in the OCI Audit settings, which can be achieved through the OCI Console by navigating to the Audit service and configuring the necessary event sources and log settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://www.oracle.com/security/cis-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/cloud/security/
  - https://cloudsecurityalliance.org/research/artifacts/security-guidance-v4/
- rule_id: oci.audit.configuration.storage_bucket_access_logging_enabled
  service: audit
  resource: configuration
  requirement: Storage Bucket Access Logging Enabled
  scope: audit.configuration.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Storage Bucket Access Logging is Enabled
  rationale: Enabling access logging for storage buckets is crucial for monitoring unauthorized access attempts and tracking data usage patterns. It helps in identifying potential security breaches and supports forensic investigations. Compliance with regulations such as PCI-DSS and GDPR often requires robust logging mechanisms to ensure data integrity and access transparency.
  description: This rule checks whether access logging is enabled for OCI storage buckets. Access logs provide detailed records of requests made to a bucket, including the requester, request time, and request type. To verify, ensure that the 'Log Requests' option is active for each bucket within your OCI environment. Remediation involves navigating to the OCI Console, accessing the storage bucket settings, and enabling access logging under the 'Logging' section.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#logging
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security-cloud-compliance/
- rule_id: oci.audit.configuration.storage_dataevents_read_enabled
  service: audit
  resource: configuration
  requirement: Storage Dataevents Read Enabled
  scope: audit.configuration.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable Storage Data Events Read in OCI Audit Logs
  rationale: Enabling read access to storage data events in OCI audit logs is crucial for tracking and monitoring unauthorized access or data exfiltration attempts. This configuration enhances visibility into data activities, helping to identify potential security breaches and complying with regulatory mandates such as GDPR and CCPA, which require detailed access logs for sensitive data.
  description: This rule verifies that storage data events, specifically read operations, are enabled in Oracle Cloud Infrastructure (OCI) audit logs. To ensure comprehensive logging, users should configure audit policies to include read access events for critical storage resources. This can be verified by reviewing the audit policy settings within the OCI console, ensuring that 'READ' operations are logged for storage services. Remediation involves updating the audit configuration to include these events to improve monitoring and data protection.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - CIS OCI Foundations Benchmark v1.0.0
  - NIST SP 800-53 Rev. 5 (AU-6 Audit Record Review, Analysis, and Reporting)
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
- rule_id: oci.audit.configuration.storage_dataevents_write_enabled
  service: audit
  resource: configuration
  requirement: Storage Dataevents Write Enabled
  scope: audit.configuration.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable Write Data Events in OCI Storage Auditing
  rationale: Enabling write data events for storage in OCI Audit allows organizations to track unauthorized access, detect potential data breaches, and ensure compliance with data protection regulations. Without this setting, critical data operations may go unmonitored, increasing the risk of data loss and non-compliance with standards such as GDPR and CCPA.
  description: This rule checks if write data events are enabled for storage in OCI's Audit service. Ensuring that write operations are logged is essential for monitoring changes to storage data, such as file uploads or modifications. Verification involves reviewing the audit configuration settings in the OCI Console to confirm that storage write events are being captured. Remediation includes enabling this feature via the Audit service settings to ensure comprehensive logging of data operations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.oracle.com/security/cloud-compliance/
  - https://cloud.oracle.com/en_US/security/best-practices
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_best_practices.htm
- rule_id: oci.audit.configuration.storage_read_events_enabled
  service: audit
  resource: configuration
  requirement: Storage Read Events Enabled
  scope: audit.configuration.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Storage Read Events Logging in OCI Audit
  rationale: Enabling storage read event logging is crucial for detecting unauthorized access and data exfiltration attempts. It helps in maintaining an audit trail for compliance with regulations like GDPR and CCPA, which mandate the monitoring of data access. Without these logs, security teams may miss critical indicators of compromise, potentially resulting in data breaches and financial penalties.
  description: This rule checks if storage read events are logged in OCI Audit, ensuring visibility into access patterns for sensitive data stored in Oracle Cloud Infrastructure. To verify, navigate to the OCI Audit service and check that logging for storage read events is enabled. Remediation involves configuring the audit policy to include storage read events, thereby enhancing the ability to track and investigate access to storage resources.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.audit.configuration.storage_write_events_enabled
  service: audit
  resource: configuration
  requirement: Storage Write Events Enabled
  scope: audit.configuration.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Storage Write Audit Events are Enabled
  rationale: Enabling storage write events in audit logs is crucial for detecting unauthorized or unintended modifications to storage resources in OCI. This helps in identifying potential data breaches, ensuring data integrity, and fulfilling compliance with regulations that mandate rigorous logging practices, such as GDPR and PCI-DSS. Without these logs, there is a risk of undetected data loss or tampering, which could result in financial loss and reputational damage.
  description: This check verifies that storage write events are enabled and logged within the OCI Audit service. These events capture any write operations to storage resources, providing a detailed audit trail. To verify, navigate to the OCI Console, access the Audit service, and confirm that the 'Storage Write' events are being logged. If not enabled, configure the Audit service to include these events by setting appropriate policies and enabling logging for storage service events. This ensures comprehensive monitoring and facilitates timely incident response.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.1.0.pdf
  - 'NIST SP 800-53: AU-2 Auditable Events'
  - 'PCI-DSS Requirement 10: Track and monitor all access to network resources and cardholder data'
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.oracle.com/cloud/cloud-infrastructure.html
- rule_id: oci.audit.configuration.threat_detection_enumeration
  service: audit
  resource: configuration
  requirement: Threat Detection Enumeration
  scope: audit.configuration.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Threat Detection Enumeration via OCI Audit Configuration
  rationale: Effective threat detection is crucial for identifying unauthorized or malicious activities within OCI resources, which can prevent potential data breaches and maintain the integrity of cloud environments. It helps organizations meet compliance requirements such as PCI-DSS and ISO 27001, by ensuring that security events are logged and monitored appropriately.
  description: This rule checks if audit logging is configured to detect and enumerate potential threat activities across OCI resources. It requires enabling detailed audit logs and ensuring that they are monitored for suspicious patterns. To verify, access the OCI console, navigate to Audit, and confirm that log retention and monitoring settings are enabled. Remediation involves configuring notifications for suspicious activities and ensuring logs are retained for an appropriate duration to support forensic investigations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.audit.configuration.threat_detection_llm_jacking
  service: audit
  resource: configuration
  requirement: Threat Detection Llm Jacking
  scope: audit.configuration.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Detect Unauthorized Configuration Changes in OCI
  rationale: Monitoring for unauthorized configuration changes helps prevent potential security breaches arising from malicious or accidental modifications. This is crucial for maintaining compliance with various regulatory frameworks and protecting sensitive data. Regular auditing can mitigate risks such as privilege misuse and data exposure, which can lead to financial loss and reputational damage.
  description: This rule checks the audit logs for signs of configuration changes that may indicate LLM jacking, which involves unauthorized modifications to the logging or monitoring settings. Verify that audit logs include all relevant configuration changes and are reviewed regularly. Remediation involves ensuring that all critical configuration changes are logged and alerts are set up to notify security teams of suspicious activities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/References/security_oci_cis.htm
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/document_library
  - https://www.oracle.com/security/cloud-security/certifications/compliance/
- rule_id: oci.audit.configuration.threat_detection_privilege_escalation
  service: audit
  resource: configuration
  requirement: Threat Detection Privilege Escalation
  scope: audit.configuration.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Detect and Mitigate Privilege Escalation Risks
  rationale: Privilege escalation in cloud environments can lead to unauthorized access and data breaches, impacting business continuity and regulatory compliance. Detecting such activities is crucial to protect sensitive information and maintain the integrity of cloud operations. This rule helps organizations identify and address potential threats before they can cause harm.
  description: This rule audits configuration settings to detect privilege escalation attempts by reviewing IAM policy changes and user activity in Oracle Cloud Infrastructure (OCI). It checks for unusual modifications to roles or policies that grant elevated privileges. Remediate by reviewing the changes, revoking unnecessary privileges, and ensuring adherence to the principle of least privilege. Employ OCI's Identity and Access Management (IAM) features to set up alerts and automate responses to suspicious activities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/GSG/Tasks/security.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/identity-and-access-management/
- rule_id: oci.database.autonomous_database.cluster_audit_logging
  service: database
  resource: autonomous_database
  requirement: Cluster Audit Logging
  scope: database.autonomous_database.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Cluster Audit Logging for Autonomous Databases
  rationale: Cluster audit logging is critical for tracking access and changes to data within Autonomous Databases, helping to identify unauthorized activities and ensure compliance with regulations such as GDPR and PCI-DSS. Without proper logging, organizations risk undetected data breaches, leading to potential financial loss and reputational damage.
  description: This rule checks whether cluster audit logging is enabled for Autonomous Databases in OCI. Audit logs capture detailed events such as user activities, data access patterns, and configuration changes. To verify, ensure that the 'Audit Logs' feature is activated in the OCI console under the Autonomous Database settings. Remediation involves navigating to the database's logging configuration and enabling audit logging, ensuring logs are retained according to your organization's data retention policy.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adbauditlogs.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.database.db_system.cluster_automated_snapshot
  service: database
  resource: db_system
  requirement: Cluster Automated Snapshot
  scope: database.db_system.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Enable Automated Snapshots for Database Clusters
  rationale: Automated snapshots for database clusters ensure that data is consistently backed up, reducing the risk of data loss from unforeseen failures or malicious activities. This enhances data recovery capabilities, complies with data retention policies, and supports business continuity. Failure to implement automated snapshots can result in significant data recovery challenges and potential non-compliance with regulatory standards like PCI-DSS and SOC2.
  description: This rule checks if automated snapshots are enabled for database clusters in OCI. Automated snapshots provide a reliable backup mechanism by creating point-in-time copies of database states, stored securely in OCI Object Storage. To verify, ensure that the database system's automatic backup settings are configured, and remediate by enabling scheduled snapshots via the OCI Console or API. This ensures data is consistently protected and can be restored swiftly in case of data loss or corruption.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/backingupdatabase.htm
  - https://www.cisecurity.org/benchmark/oracle
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/security/cloud-compliance/
  - https://cloud.oracle.com/en_US/architecture-center/cloud-security
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.db_system.cluster_automatic_upgrades
  service: database
  resource: db_system
  requirement: Cluster Automatic Upgrades
  scope: database.db_system.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable Automatic Upgrades for Database Clusters
  rationale: Automatic upgrades for database clusters in OCI ensure that your databases are continuously updated with the latest security patches, reducing vulnerability exposure and minimizing risks of data breaches. This is crucial for maintaining data protection and privacy, meeting compliance requirements such as PCI-DSS and ISO 27001, and protecting sensitive information from unauthorized access.
  description: This rule checks if the automatic upgrade feature is enabled for OCI database clusters. Automatic upgrades help in keeping the database management systems up-to-date with critical security patches and feature improvements. To verify, navigate to the OCI Console, select your DB system, and ensure the 'Automatic Upgrades' option is enabled under the maintenance settings. Remediation involves enabling this feature under the database system's settings to ensure timely updates.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/upgradingDB.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.database.db_system.cluster_maintenance_settings
  service: database
  resource: db_system
  requirement: Cluster Maintenance Settings
  scope: database.db_system.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure DB System Maintenance Settings Protect Cluster Data
  rationale: Proper maintenance settings for DB Systems in OCI are crucial to ensure that critical patches and updates are applied timely, reducing the risk of vulnerabilities that can be exploited by attackers to access sensitive data. This is essential for maintaining data integrity and confidentiality, and meeting compliance requirements such as PCI-DSS and ISO 27001, which mandate regular system updates and security patches.
  description: This rule verifies that the maintenance settings on OCI DB Systems are configured to automatically apply critical updates and patches during predefined maintenance windows, minimizing downtime and ensuring data encryption at rest is consistently enforced. To verify, check the DB System's maintenance window settings in the OCI Console under the database service section. If not configured, set up an automatic maintenance schedule that aligns with your organization's operational requirements, ensuring that encryption settings remain intact and up-to-date.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/managingDBsystemmaintenance.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security-best-practices/database-security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.autonomous_database.cluster_public_access
  service: database
  resource: autonomous_database
  requirement: Cluster Public Access
  scope: database.autonomous_database.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure Autonomous Database Cluster Public Access is Disabled
  rationale: Allowing public access to Autonomous Database clusters poses significant security risks, including potential unauthorized data exposure and increased attack surface for malicious entities. This could lead to data breaches, non-compliance with data protection regulations such as GDPR or HIPAA, and financial or reputational damage. Limiting access to private networks ensures data security and regulatory compliance.
  description: This rule checks if Autonomous Database clusters have public endpoints exposed. By default, these databases should be configured to restrict access to private, secure networks. To verify, review the network security settings and ensure the public access option is disabled. Remediation involves updating the database configuration to limit access to specific IP ranges or virtual cloud networks, leveraging Oracle's security features such as Network Security Groups (NSGs) or Security Lists.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - CIS Oracle Cloud Infrastructure Foundations Benchmark v1.1.0 - Section 3.6
  - NIST SP 800-53 Rev. 5 AC-3 Access Enforcement
  - PCI DSS v3.2.1 Requirement 1.2.1
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.compute.instance_pool.group_configured
  service: compute
  resource: instance_pool
  requirement: Group Configured
  scope: compute.instance_pool.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Instance Pool Has Proper Group Configuration
  rationale: Proper group configuration for OCI instance pools is crucial for maintaining consistent and secure deployment environments. Misconfigured instance pools can lead to resource inefficiencies, potential security vulnerabilities, and non-compliance with regulatory frameworks such as PCI-DSS and ISO 27001. Ensuring correct configurations helps in minimizing the attack surface and maintaining operational integrity.
  description: This rule checks if the OCI instance pool is configured with a valid instance configuration group. It verifies settings such as instance shapes, images, and network configurations to ensure compliance with organizational policies. If a configuration is missing or incorrect, it can be remediated by updating the instance pool with the correct configuration group in the OCI Console or via the CLI. This ensures consistency and reliability across all instances managed by the pool.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/managinginstancepools.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
- rule_id: oci.compute.instance_pool.group_health_check_enabled
  service: compute
  resource: instance_pool
  requirement: Group Health Check Enabled
  scope: compute.instance_pool.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Instance Pool Health Check is Enabled
  rationale: Enabling health checks on instance pools ensures high availability and reliability by automatically detecting and replacing unhealthy instances. This reduces downtime and mitigates the risk of service disruption, which is critical for maintaining business operations and meeting service-level agreements. Additionally, it can be a compliance requirement in frameworks that mandate robust monitoring and resilience strategies.
  description: This rule checks whether health checks are configured and enabled for instance pools in OCI. Health checks monitor the status of instances and facilitate automatic recovery by replacing unhealthy instances with new ones. To verify, navigate to the OCI Console, select 'Instance Pools', and ensure that health checks are active for each pool. Remediation involves setting up health check policies under the pool configuration settings, ensuring that the policies align with the operational requirements of the application.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/usinghealthchecks.htm
  - https://www.oracle.com/cloud/cloud-security.html
  - 'NIST SP 800-53 Rev. 5: System and Communications Protection'
  - ISO/IEC 27001:2013 - A.12.1.3 Capacity Management
  - https://www.oracle.com/security-cloud/compliance/
- rule_id: oci.functions.application.function_url_public
  service: functions
  resource: application
  requirement: Function Url Public
  scope: functions.application.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Public Access to OCI Function URLs
  rationale: Publicly accessible function URLs can expose sensitive operations to unauthorized users, leading to potential data breaches and abuse of cloud resources. This can result in financial losses, compliance violations with frameworks like PCI-DSS, and damage to organizational reputation.
  description: This rule checks for OCI Function URLs that are publicly accessible over the internet. Public access should be restricted to prevent unauthorized invocation of functions. To verify, review the function settings in the OCI Console and ensure that the URL is not set to 'Public'. Remediation involves using IAM policies to control access or leveraging OCI API Gateway for secure access management.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionsaccess.htm
  - 'CIS OCI Benchmark: Ensure that OCI Functions are not publicly accessible'
  - 'NIST SP 800-53: AC-3 Access Enforcement'
  - https://www.oracle.com/security/cloud-security/cloud-security-architecture/
- rule_id: oci.database.autonomous_database.backup_encryption_enabled
  service: database
  resource: autonomous_database
  requirement: Backup Encryption Enabled
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Autonomous Database Backup Encryption is Enabled
  rationale: Enabling encryption for backups of Autonomous Databases is crucial for protecting sensitive data from unauthorized access and potential data breaches. This is particularly important for maintaining compliance with data protection regulations such as GDPR, HIPAA, and PCI-DSS, which mandate encryption of data at rest. Failure to encrypt backups can lead to significant business risks including data leaks, financial penalties, and damage to reputation.
  description: This rule checks if encryption is enabled for backups of Oracle Cloud Infrastructure Autonomous Databases. Backup encryption ensures that data remains secure during the backup process and while stored. To verify, check the Autonomous Database configuration in the OCI console and ensure that the 'Backup Encryption' setting is enabled. Remediation involves enabling encryption for backups through the OCI Console or CLI by modifying the database configuration settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/backingupADB.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
- rule_id: oci.database.autonomous_database.enabled_for_ec2
  service: database
  resource: autonomous_database
  requirement: Enabled For Ec2
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Encryption for EC2 Access
  rationale: Enabling Autonomous Database for EC2 ensures that interactions between OCI and AWS EC2 instances are secure, mitigating risks such as data breaches and unauthorized access. It is crucial for maintaining data integrity and confidentiality, especially when dealing with sensitive information. Compliance with regulatory standards like PCI-DSS and HIPAA mandates strong encryption practices to protect data at rest and in transit.
  description: This rule checks if the Autonomous Database is configured to allow secure access and interaction with AWS EC2 instances. It ensures that proper encryption mechanisms are enabled to protect data at rest. Verify that the database is configured with the appropriate network security settings and encryption protocols. If not configured, enable encryption settings within the OCI console by navigating to the Autonomous Database settings and configuring the encryption options. This ensures data protection and compliance with industry standards.
  references:
  - https://docs.oracle.com/en/cloud/paas/autonomous-database/index.html
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://cloud.oracle.com/iaas/whitepapers/best-practices-for-securing-oci-database.pdf
  - https://www.oracle.com/security/cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_security_guide.htm
  - https://www.pcisecuritystandards.org/
- rule_id: oci.database.autonomous_database.plan_configured
  service: database
  resource: autonomous_database
  requirement: Plan Configured
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Encryption Plan Configured for Autonomous Databases
  rationale: Configuring an encryption plan for Autonomous Databases is crucial to protect sensitive data from unauthorized access and potential breaches. Lack of encryption can lead to data exposure, impacting business reputation, financial stability, and compliance with data protection laws such as GDPR and CCPA. Proper configuration mitigates risks associated with data theft, ensuring data integrity and confidentiality.
  description: This rule checks whether an encryption plan is configured for your Autonomous Database instances. By default, Oracle Autonomous Databases use Oracle-managed keys for encryption at rest, but you can also configure customer-managed keys via Oracle Cloud Infrastructure Vault. Verify the encryption settings by navigating to the database service console and checking the 'Encryption' settings under the 'Configuration' section. To remediate, ensure the database is either using Oracle-managed keys or configure customer-managed keys by following OCI Vault best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adbaasoverview.htm#encryption
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-1-1-0.pdf
  - https://www.nist.gov/itl/applied-cybersecurity/nist-privacy-framework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/security/cloud-security/
  - https://www.oracle.com/security/cloud-security/cspm/
- rule_id: oci.database.autonomous_database.plan_min_retention
  service: database
  resource: autonomous_database
  requirement: Plan Min Retention
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Min Retention Policy for Autonomous Databases
  rationale: Setting a minimum retention policy for Oracle Autonomous Databases is crucial for ensuring that critical and sensitive data is retained as per business and regulatory requirements. Without a defined retention policy, there is a risk of premature data deletion, which can lead to data loss, non-compliance with regulations such as GDPR, and potential financial and reputational damage.
  description: This check verifies that Oracle Autonomous Databases have a minimum retention policy configured. The retention policy should align with the organization's data retention strategy and compliance requirements. To verify, inspect the database configuration settings either via the OCI Console or using the OCI CLI to ensure the 'Plan Min Retention' is set to the appropriate duration. Remediation involves updating the retention settings to meet or exceed the required minimum retention period using the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/managingADBC.htm#managingADBC
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://www.iso.org/standard/54534.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.cisecurity.org/benchmark/oracle_cloud
- rule_id: oci.database.autonomous_database.recovery_point_encrypted
  service: database
  resource: autonomous_database
  requirement: Recovery Point Encrypted
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Recovery Points are Encrypted
  rationale: Encrypting recovery points for Autonomous Databases is critical to protect sensitive data from unauthorized access and potential data breaches. Without encryption, backup data could be exposed, leading to loss of confidentiality and non-compliance with data protection regulations such as GDPR and CCPA. Encrypting recovery points helps mitigate risks associated with data theft and ensures alignment with industry security standards.
  description: This rule checks if recovery points for Autonomous Databases in OCI are encrypted to safeguard data at rest. Verify that encryption is enabled by reviewing the database's configuration settings in the OCI Console, ensuring that the 'Encryption at Rest' option is selected. To remediate, enable encryption by configuring the Autonomous Database with a Customer Managed Key (CMK) or Oracle Managed Key (OMK) through the Key Management service. Regular audits should be conducted to ensure ongoing compliance with encryption policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adbencrypt.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security-cloud/compliance/gdpr/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.database.autonomous_database.recovery_point_encryption
  service: database
  resource: autonomous_database
  requirement: Recovery Point Encryption
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Recovery Point Encryption for Autonomous Databases
  rationale: Encrypting recovery points is crucial to protect sensitive data from unauthorized access and potential data breaches. Without encryption, recovery points could be exposed to cyber threats, leading to data leaks and compliance violations. This is especially important for industries under strict regulations such as finance and healthcare, where data integrity and privacy are paramount.
  description: This rule checks whether recovery points for Autonomous Databases in OCI are encrypted, ensuring that all data at rest is securely protected. Verify this by reviewing the encryption settings in the OCI console under the Autonomous Database's backup configuration. To remediate, enable encryption for recovery points using OCI's built-in security features, ensuring compliance with your organization's data protection policies.
  references:
  - https://docs.oracle.com/en/cloud/paas/autonomous-database/index.html
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://www.oracle.com/security/cloud-security/encryption/
- rule_id: oci.database.autonomous_database.recovery_point_retention
  service: database
  resource: autonomous_database
  requirement: Recovery Point Retention
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Retains Adequate Recovery Points
  rationale: Maintaining adequate recovery points is critical to ensure data can be restored to a previous state in the event of accidental deletion, data corruption, or a cyber attack. This practice minimizes data loss and supports business continuity, while also aligning with compliance requirements for data protection and retention strategies.
  description: This rule checks that Oracle Autonomous Databases have a configured recovery point retention period that meets organizational policies and compliance standards. The default retention period may not suffice for all business needs, so it is essential to verify and adjust the settings in the OCI console under 'Autonomous Database' -> 'Backup and Recovery'. Remediation involves setting a retention period that matches the recovery and compliance requirements of the organization.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-34r1.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm#data_protection
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.database.autonomous_database.vault_encryption_enabled
  service: database
  resource: autonomous_database
  requirement: Vault Encryption Enabled
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable Vault Encryption for Autonomous Databases
  rationale: Vault encryption is essential for protecting sensitive data at rest within Autonomous Databases, mitigating risks of unauthorized access and data breaches. It ensures compliance with industry regulations like GDPR and PCI-DSS, which mandate strong data protection measures. Without this, businesses face significant legal, financial, and reputational damage in the event of data exposure.
  description: This rule checks that Autonomous Databases in OCI have vault encryption enabled, which uses Oracle Cloud Infrastructure Vault service to manage encryption keys. To verify, review the encryption settings in the OCI Console under the Autonomous Database details, ensuring that 'Key Management' is set to 'OCI Vault'. Remediation involves configuring the Autonomous Database to use a specified vault key from OCI Vault, enhancing data security at rest.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbmanaging.htm#encryption
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-3/rev-1/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/key-management/
- rule_id: oci.ai_language.project.model_invocation_logging_enabled
  service: ai_language
  resource: project
  requirement: Model Invocation Logging Enabled
  scope: ai_language.project.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Model Invocation Logging for AI Language Projects
  rationale: Enabling model invocation logging for AI language projects is crucial for maintaining an audit trail of model activities. This logging helps in identifying unauthorized access or usage patterns that could indicate a security breach, aids in forensic investigations, and ensures compliance with regulatory frameworks that mandate detailed logging of data processing activities.
  description: This rule checks if logging is enabled for model invocations in AI language projects within Oracle Cloud Infrastructure. To verify, ensure that logging is configured in the OCI Console under the AI Language service by navigating to the specific project settings and enabling the logging feature. Remediation involves accessing the project configuration and setting the logging options to capture invocation data, which can be stored in OCI Logging for analysis and audit purposes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ai-language/home.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/document_library
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.bds.bds_instance.cluster_master_nodes_no_public_ip
  service: bds
  resource: bds_instance
  requirement: Cluster Master Nodes No Public Ip
  scope: bds.bds_instance.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure BDS Cluster Master Nodes Have No Public IP Addresses
  rationale: Exposing cluster master nodes to the public internet increases the risk of unauthorized access and potential data breaches. It can lead to sensitive data being intercepted or manipulated, compromising the integrity and confidentiality of the data processing operations. This configuration is critical for meeting compliance with industry standards such as PCI-DSS and ISO 27001, which mandate strict controls on network access.
  description: This rule checks that Big Data Service (BDS) cluster master nodes do not have public IP addresses assigned. Public IPs can expose your nodes to the internet, making them vulnerable to attacks. To verify, inspect the network configuration of your BDS instance and ensure that the master nodes are restricted to private IP addresses. Remediation involves configuring the network security group (NSG) and subnet settings to deny public IP allocations and ensuring all connections are routed through secure private networks or VPNs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/bigdata/home.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/bdssg.htm
  - CIS OCI Foundations Benchmark
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networksecuritygroups.htm
- rule_id: oci.analytics.analytics_instance.dataset_cmk_encryption
  service: analytics
  resource: analytics_instance
  requirement: Dataset CMK Encryption
  scope: analytics.analytics_instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Analytics Instance Uses CMK for Dataset Encryption
  rationale: Encrypting datasets using Customer-Managed Keys (CMK) in OCI Analytics enhances data security by allowing greater control over encryption keys and access management. This reduces the risk of unauthorized data access and improves compliance with regulations such as GDPR and PCI-DSS, which mandate strict data protection measures. Failure to implement CMK encryption could lead to data breaches, financial penalties, and reputational damage.
  description: This rule checks if datasets within an OCI Analytics instance are encrypted using Customer-Managed Keys (CMK) instead of Oracle-managed keys. To verify, ensure that the analytics instance's encryption settings are configured to use a CMK from the Oracle Cloud Vault service. Remediation involves creating a new CMK in OCI Vault and updating the analytics instance to use this key for encrypting datasets, providing enhanced security and compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticssecurity.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.analytics.analytics_instance.table_cmk_encryption
  service: analytics
  resource: analytics_instance
  requirement: Table CMK Encryption
  scope: analytics.analytics_instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure CMK Encryption for OCI Analytics Instances
  rationale: Using Customer-Managed Keys (CMK) for encryption ensures that sensitive data is protected with a higher level of control and security, reducing the risk of unauthorized access. This is crucial for maintaining data privacy, adhering to compliance standards such as GDPR, and protecting against threats like data breaches and insider threats.
  description: This rule checks if OCI Analytics instances are configured to use Customer-Managed Keys (CMK) for data encryption at rest. CMK provides enhanced control over encryption keys and allows for fine-grained access management. Verify this setting in the OCI Console under the Analytics service by ensuring that the encryption setting is set to use a CMK from the Oracle Cloud Infrastructure Vault service. Remediation involves creating a CMK in the Vault service and configuring the Analytics instance to use it for encryption.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analytics_overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/keymanagementoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/security_compliance.htm
  - https://www.iso.org/standard/73906.html
- rule_id: oci.block_storage.volume.volume_encryption_cmk_enabled
  service: block_storage
  resource: volume
  requirement: Volume Encryption CMK Enabled
  scope: block_storage.volume.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Block Storage Volumes Use Customer-Managed Keys (CMK)
  rationale: Encrypting block storage volumes with customer-managed keys (CMK) enhances security by allowing organizations to maintain control over encryption keys, reducing the risk of unauthorized access and data breaches. This practice supports compliance with data protection regulations such as GDPR and CCPA, while ensuring that encryption is tailored to organizational policies and risk management strategies.
  description: This rule checks if block storage volumes are encrypted using customer-managed keys (CMK) within Oracle Cloud Infrastructure. To verify compliance, ensure that the volumes are configured to use CMK instead of Oracle-managed keys by examining the OCI Console or using the CLI/API. Remediation involves updating the volume's encryption settings to use a CMK, which can be created and managed via the OCI Vault service. This provides greater control over key rotation, access policies, and audit capabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/managingvolumes.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57p1r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.block_storage.volume.boot_volume_encryption_cmk_enabled
  service: block_storage
  resource: volume
  requirement: Boot Volume Encryption CMK Enabled
  scope: block_storage.volume.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Boot Volume Encryption with Customer-Managed Keys
  rationale: Encrypting boot volumes with Customer-Managed Keys (CMKs) enhances control over cryptographic operations and key management, providing an additional layer of data protection. This is critical for preventing unauthorized access to sensitive data, especially in scenarios where system images contain proprietary or regulated information. Furthermore, it aids in meeting compliance requirements such as PCI-DSS and HIPAA that mandate stringent data protection measures.
  description: This rule checks whether boot volumes in OCI are encrypted using Customer-Managed Keys (CMKs), which are stored in the Oracle Cloud Infrastructure Vault. To verify, ensure that the boot volume is associated with a CMK rather than the default Oracle-managed keys. Remediation involves creating or selecting an existing CMK in the OCI Vault and configuring the boot volume to use this key for encryption. This setup not only provides enhanced security but also aligns with best practices for data privacy and regulatory compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/encryptingvolumes.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org
  - https://cloud.oracle.com/security-compliance/standards
  - https://www.oracle.com/security/cloud-security.html
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
- rule_id: oci.edge_services.distribution.cloudfront_https_required
  service: edge_services
  resource: distribution
  requirement: Cloudfront HTTPS Required
  scope: edge_services.distribution.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure HTTPS for CloudFront Distributions in OCI
  rationale: Requiring HTTPS for CloudFront distributions prevents data exposure by ensuring that all data in transit is encrypted. This reduces the risk of man-in-the-middle attacks and data breaches, protecting sensitive information and maintaining trust with users. Compliance with industry standards like PCI-DSS and HIPAA mandates encryption to safeguard data integrity and confidentiality.
  description: This check verifies that CloudFront distributions in OCI enforce HTTPS for all connections. By default, distributions might allow both HTTP and HTTPS, posing a risk of unencrypted data transmission. To remediate, configure the distribution to redirect HTTP requests to HTTPS, ensuring all data is encrypted in transit. Verification involves checking the distribution settings in the OCI console or using the OCI CLI to ensure only secure protocols are enabled.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/EdgeServices/Tasks/edgeusingcustomssl.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-52r1.pdf
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.edge_services.distribution.distributions_custom_ssl_certificate
  service: edge_services
  resource: distribution
  requirement: Distributions Custom SSL Certificate
  scope: edge_services.distribution.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enforce Custom SSL Certificates for Edge Distributions
  rationale: Using custom SSL certificates for edge distributions ensures that data in transit is encrypted with enterprise-grade security. This reduces the risk of data interception by unauthorized parties, protecting sensitive information and maintaining customer trust. It also helps organizations meet compliance requirements such as PCI-DSS and HIPAA, which mandate encryption for data in transit.
  description: This rule checks whether edge distributions in OCI are configured with custom SSL certificates to ensure secure communication. Ensure that all edge distributions use certificates issued by a trusted Certificate Authority (CA) to prevent man-in-the-middle attacks. To verify, review the SSL certificate configuration of each distribution in the OCI Console and update settings to include an appropriate custom certificate. If not configured, obtain a certificate from a trusted CA and upload it through the OCI Console.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/EdgeServices/Concepts/edgeservicesoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/EdgeServices/Tasks/edgeservicesusingsslcertificates.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://csrc.nist.gov/publications/detail/sp/800-52/rev-2/final
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.edge_services.distribution.distributions_logging_enabled
  service: edge_services
  resource: distribution
  requirement: Distributions Logging Enabled
  scope: edge_services.distribution.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Distribution Logging is Enabled for Edge Services
  rationale: Enabling logging for distributions in edge services is crucial for monitoring access patterns, detecting potential misuse, and ensuring the integrity of data flowing through the network. Without logging, it would be challenging to perform forensic investigations and meet compliance requirements such as PCI-DSS and ISO 27001, which mandate logging and monitoring of access to sensitive data.
  description: This rule checks whether logging is enabled for distributions in Oracle Cloud Infrastructure's edge services. To verify, ensure that the logging feature is activated in the OCI Console under Edge Services > Distributions. Logging captures access details and errors, facilitating audit trails and issue diagnosis. To remediate, navigate to each distribution configuration, enable logging, and specify the appropriate log group and compartment for storing logs. Regularly review and analyze these logs to maintain security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/EdgeServices/Concepts/edgelogging.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security-compliance.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.edge_services.distribution.distributions_using_deprecated_ssl_protocols
  service: edge_services
  resource: distribution
  requirement: Distributions Using Deprecated SSL Protocols
  scope: edge_services.distribution.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Disable Deprecated SSL Protocols for Edge Distributions
  rationale: Using deprecated SSL protocols in edge distributions can expose data to interception and tampering, leading to potential breaches of sensitive information. This vulnerability not only compromises the integrity and confidentiality of data but also poses compliance risks with standards such as PCI-DSS and NIST, which mandate the use of strong encryption to protect data in transit.
  description: This rule checks if any edge distribution is configured to use deprecated SSL protocols like SSLv3 or TLS 1.0/1.1, which are considered insecure. To verify, inspect the SSL configuration settings of your edge distributions in OCI and ensure only supported protocols like TLS 1.2 or higher are enabled. Remediation involves updating the distribution settings to disable deprecated protocols and enforce modern encryption standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/EdgeServices/Concepts/edgedistributionoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.0.0.pdf
  - https://www.pcisecuritystandards.org/document_library?document=pci_dss_v3-2-1#
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-52r2.pdf
- rule_id: oci.certificates.certificates.expiration_check
  service: certificates
  resource: certificates
  requirement: Expiration Check
  scope: certificates.certificates.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Monitor Certificate Expiration to Prevent Security Risks
  rationale: Ensuring that certificates do not expire is crucial for maintaining secure communication channels and data protection. Expired certificates can lead to service disruptions, increase the risk of man-in-the-middle attacks, and result in non-compliance with industry regulations like PCI-DSS and HIPAA. Regular monitoring of certificate expiration dates helps in proactively mitigating these risks and maintaining trust in digital communications.
  description: This rule checks the expiration dates of certificates managed in OCI to ensure they are renewed before they expire. Certificates should be monitored and renewed at least 30 days prior to expiration to avoid service interruptions and vulnerabilities. Users should regularly review the certificate expiration dates via the OCI Console or use the OCI CLI to automate these checks. Remediation involves timely renewal or replacement of certificates before they reach their expiration date.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Certificates/Concepts/certificatesoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.hhs.gov/hipaa/for-professionals/privacy/index.html
  - https://cloud.oracle.com/en_US/data-security
  - https://www.nist.gov/cyberframework
- rule_id: oci.identity.user.app_services_is_on
  service: identity
  resource: user
  requirement: App Services Is On
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure App Services Access is Enabled for Users
  rationale: Enabling App Services for user accounts is essential to ensure they can interact with necessary Oracle Cloud Infrastructure (OCI) services efficiently. Failure to enable this can lead to operational disruptions, increased support overhead, and hindered productivity. Additionally, it may prevent users from leveraging OCIâ€™s full capabilities, potentially violating compliance with organizational performance standards.
  description: This rule checks whether App Services access is enabled for users within OCI. To verify, ensure that the 'App Services' option is turned on in the user's profile settings under Identity and Access Management. If not enabled, users may be restricted from accessing critical services required for application functionality. Remediation involves accessing the OCI Console, navigating to Identity, selecting the user, and enabling App Services under the userâ€™s profile settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://www.oracle.com/cloud/security/
  - CIS OCI Foundations Benchmark
  - NIST SP 800-53 - Access Control (AC)
  - PCI-DSS Requirement 7 - Restrict Access to Cardholder Data
- rule_id: oci.identity.user.guard_enabled
  service: identity
  resource: user
  requirement: Guard Enabled
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure User Multi-Factor Authentication is Enabled
  rationale: Enabling multi-factor authentication (MFA) adds an additional layer of security to user accounts by requiring a second form of verification, reducing the risk of unauthorized access due to compromised credentials. This is crucial for protecting sensitive data and meeting compliance requirements like PCI-DSS and NIST SP 800-63B, which emphasize strong authentication controls. Without MFA, accounts are vulnerable to attacks such as phishing and credential stuffing.
  description: This rule checks whether multi-factor authentication is enabled for all users within the Oracle Cloud Infrastructure (OCI) identity service. To verify, navigate to the OCI Console's 'Identity & Security' section, select 'Users', and ensure that MFA is activated for each user account. Remediation involves enabling MFA through the OCI Console or using the OCI CLI to update user settings. Ensuring MFA is enabled aligns with security best practices and compliance mandates.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusercredentials.htm#ManagingUserCredentials
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-63b/final
  - https://www.oracle.com/security/cloud-security/casb/
  - https://www.oracle.com/security/cloud-security/identity-and-access/
- rule_id: oci.identity.user.guard_is_enabled
  service: identity
  resource: user
  requirement: Guard Is Enabled
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure User Security Guardrails Are Enabled
  rationale: Enabling security guardrails for users is crucial to protect against unauthorized access and potential breaches. By ensuring that guardrails are enabled, organizations reduce the risk of compromised credentials and unauthorized actions that could lead to data leaks or service disruptions. Compliance with frameworks like NIST and ISO 27001 often requires robust user authentication and monitoring mechanisms.
  description: This check verifies that security guardrails, such as multi-factor authentication (MFA) and activity monitoring, are enabled for all users in Oracle Cloud Infrastructure. Administrators should ensure that MFA is enforced for all user accounts and that user activities are logged and monitored for suspicious behavior. To enable these features, navigate to the Identity and Access Management section in OCI, select 'Users', and configure the security settings to activate MFA and audit logs. Remediation involves configuring and enforcing these settings across all accounts.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/security/cloud-security/identity-and-access-management/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation_benchmark_v1.0.0
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.identity.user.guard_no_high_severity_findings
  service: identity
  resource: user
  requirement: Guard No High Severity Findings
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Users Have No High Severity Security Findings
  rationale: High severity security findings associated with user accounts in OCI can signify critical vulnerabilities that may lead to unauthorized access, data breaches, or compliance violations. Addressing these findings promptly helps in maintaining the integrity and confidentiality of sensitive information, supporting compliance with regulations such as PCI-DSS and ISO 27001, and reducing the risk of identity-related threats.
  description: This rule checks for any high severity security findings related to user accounts in OCI's Identity and Access Management service. It evaluates user configurations and activities that might expose the organization to significant security risks. To remediate, review the findings in the OCI Security Dashboard, correct misconfigurations, and implement recommended security controls such as multi-factor authentication (MFA) and strong password policies. Regularly monitor users for any new high severity findings and take corrective actions immediately.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_dashboard.htm
  - 'CIS OCI Benchmark: https://www.cisecurity.org/benchmark/oracle_cloud'
  - 'NIST SP 800-53: https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final'
  - 'PCI-DSS Requirement 8: https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf'
  - 'OCI Security Best Practices: https://www.oracle.com/security/cloud-security/practices/'
- rule_id: oci.identity.user.guard_recorder_all_regions_enabled
  service: identity
  resource: user
  requirement: Guard Recorder All Regions Enabled
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure GuardDuty is Enabled Across All Regions
  rationale: Enabling GuardDuty across all regions is crucial for comprehensive threat detection and monitoring. Without it, organizations risk missing potential security incidents in regions where it is not activated. This can lead to undetected breaches, non-compliance with security frameworks, and potential data loss or unauthorized access.
  description: This rule checks whether GuardDuty is enabled for all regions in your OCI environment. GuardDuty provides continuous monitoring and threat detection, identifying malicious activities using threat intelligence and machine learning. To verify, navigate to the OCI console, access GuardDuty settings, and ensure that it is activated across all regions. Remediation involves enabling GuardDuty in any region where it is currently disabled to ensure uniform security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingguardduty.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/maintaining_payment_security
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.guard_root_compartment_enabled
  service: identity
  resource: user
  requirement: Guard Root Compartment Enabled
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Enable Guardrails for Root Compartment Access
  rationale: Enabling guardrails for the root compartment is crucial to mitigate the risk of unauthorized access and modification of critical resources, which could lead to data breaches or service disruption. It ensures that only authorized users can perform sensitive operations, protecting the organization's cloud assets and aligning with compliance frameworks such as ISO 27001 and SOC2.
  description: This rule checks if guardrails are enabled for the root compartment to restrict unauthorized access. It verifies that security measures, such as multi-factor authentication and minimal access privileges, are enforced for users interacting with the root compartment. To remediate, enable necessary guardrails by configuring policies that require additional authentication and limit access to trusted identities only. Regularly audit these settings to ensure compliance with security standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcompartments.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oci.com/security-best-practices
- rule_id: oci.identity.user.guard_ensure_protection_for_compute_is_on
  service: identity
  resource: user
  requirement: Guard Ensure Protection For Compute Is On
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Compute Instance Protection via User Guard is Enabled
  rationale: Enabling Guard protection on compute instances mitigates risks associated with unauthorized access, data breaches, and potential misuse of resources. This is crucial for maintaining business continuity, protecting sensitive data, and meeting compliance obligations under frameworks like PCI-DSS and ISO 27001.
  description: This rule verifies that Guard protection is enabled for compute instances by checking user permissions and ensuring that necessary security measures are in place. To validate, review user policies and confirm that Guard settings are configured correctly for compute resources. Remediation involves updating IAM policies to include Guard protection settings and consulting the Oracle Cloud Infrastructure documentation to apply the necessary configurations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/accesscontrol.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.identity.user.guard_ensure_protection_for_containers_is_on
  service: identity
  resource: user
  requirement: Guard Ensure Protection For Containers Is On
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure OCI Container Protection is Enabled for Users
  rationale: Enabling protection for containers is crucial for preventing unauthorized access and mitigating risks such as data breaches and service disruptions. Containers often hold critical applications and data, making them attractive targets for cyber threats. Compliance with regulations like PCI-DSS and SOC2 requires implementing robust container security measures to protect sensitive data and ensure service integrity.
  description: This rule checks whether the OCI Container Protection feature is enabled for users, ensuring that containers are safeguarded against unauthorized access. To verify compliance, audit the security settings in the OCI Console under Identity and Access Management, ensuring that container protection policies are active. Remediation involves enabling container security options and configuring them to restrict access based on least privilege principles, monitored through OCI Cloud Guard.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Concepts/cloudguardoverview.htm
- rule_id: oci.identity.user.guard_ensure_protection_for_databases_is_on
  service: identity
  resource: user
  requirement: Guard Ensure Protection For Databases Is On
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Database Protection via Identity Guardrails
  rationale: Enabling protection for databases is crucial to prevent unauthorized access to sensitive data, mitigating risks such as data breaches and compliance violations. Without this protection, businesses face potential exposure of critical information, leading to financial loss and reputational damage. Regulatory standards like PCI-DSS and ISO 27001 require stringent access controls to safeguard data integrity and confidentiality.
  description: This rule checks whether identity guardrails are in place to protect databases by ensuring that only authorized users can access database resources. This involves configuring policies and enabling features such as password policies and MFA for database access. Verifying this requires checking user roles and permissions against established guidelines. Remediation includes updating identity policies to enforce stricter access controls and enabling advanced security features like Database Vault and Data Safe within OCI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/data-safe/index.html
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/security.htm
- rule_id: oci.identity.user.guard_ensure_protection_for_dns_is_on
  service: identity
  resource: user
  requirement: Guard Ensure Protection For Dns Is On
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enable DNS Protection for User Accounts
  rationale: Ensuring DNS protection is enabled for user accounts is crucial to prevent unauthorized access and potential data breaches. It safeguards against DNS-based phishing attacks, which can lead to unauthorized data exposure and financial loss. Compliance with regulatory frameworks like NIST and ISO 27001 often mandates robust identity protection mechanisms.
  description: This rule checks whether DNS protection is enabled for user accounts within OCI to prevent DNS-based threats. To verify, navigate to the OCI Console, select 'Identity' then 'Users', and ensure DNS protection is activated for each user. If not enabled, configure your DNS settings to integrate with OCI's security best practices, ensuring DNS queries are monitored and protected against spoofing or phishing attempts.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.oracle.com/security/cloud-security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.guard_ensure_protection_for_vault_is_on
  service: identity
  resource: user
  requirement: Guard Ensure Protection For Vault Is On
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enable Vault Protection for User Accounts
  rationale: Ensuring vault protection for user accounts is crucial to safeguarding sensitive data and cryptographic keys stored within OCI Vault. Without this protection, unauthorized access or data breaches could occur, leading to financial loss and reputational damage. This is particularly important for meeting compliance requirements such as PCI-DSS and ISO 27001, which mandate strict access controls and data protection measures.
  description: This rule checks if vault protection is enabled for user accounts in OCI, ensuring that all interactions with the vault require appropriate authentication and authorization. To verify, ensure that all user accounts interacting with the vault have MFA enabled and follow the least privilege principle. Remediation involves configuring IAM policies to enforce these constraints and enabling Multi-Factor Authentication (MFA) for all users accessing the vault.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations_benchmark/
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.identity.user.guard_guardduty_enabled
  service: identity
  resource: user
  requirement: Guard Guardduty Enabled
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure GuardDuty is Enabled for User Accounts
  rationale: Enabling GuardDuty for user accounts is crucial for detecting malicious activities and unauthorized access attempts. It enhances the security posture by providing continuous monitoring and alerting on suspicious behavior. This is important for compliance with security standards and to mitigate risks such as data breaches and insider threats.
  description: This rule checks whether GuardDuty is enabled for all user accounts in OCI, ensuring that threat detection is actively monitoring user activities. To verify, navigate to the OCI console, select Identity, and confirm GuardDuty is enabled for each user. If not configured, enable GuardDuty by following the setup guide. This proactive configuration helps identify potential security incidents early and allows for timely response and remediation.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Concepts/guardduty.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-security/cloud-security-compliance/
- rule_id: oci.identity.user.guard_security_center_enabled
  service: identity
  resource: user
  requirement: Guard Security Center Enabled
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure GuardDuty Security Center is Enabled for Users
  rationale: Enabling the GuardDuty Security Center for users helps detect and respond to unauthorized access and potential threats within your OCI environment. This is crucial for maintaining the integrity of sensitive data and preventing data breaches. It aligns with compliance requirements such as PCI-DSS and ISO 27001, which mandate proactive threat management and monitoring.
  description: This rule checks if the GuardDuty Security Center is activated for all users in your OCI environment, ensuring continuous monitoring of user activities and detection of anomalous behavior. To verify, navigate to the OCI Console, select Identity, and ensure the 'GuardDuty Security Center' is enabled for each user account. Remediate by enabling this feature in the Security Center settings to ensure real-time threat detection.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/guardduty_security_center.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-compliance/
- rule_id: oci.identity.user.guard_vulnerability_assessment_enabled
  service: identity
  resource: user
  requirement: Guard Vulnerability Assessment Enabled
  scope: identity.user.vulnerability_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enable Guard Vulnerability Assessment for User Accounts
  rationale: Guard Vulnerability Assessment is crucial for identifying potential security weaknesses in user accounts that could be exploited by attackers. By enabling this feature, organizations can proactively manage vulnerabilities, thereby reducing the risk of unauthorized access and aligning with compliance mandates such as ISO 27001 and PCI-DSS.
  description: This rule checks whether the Guard Vulnerability Assessment feature is enabled for user accounts within OCI. This involves configuring the Identity and Access Management (IAM) service to continuously monitor user activities and assess vulnerabilities. To verify, ensure the feature is activated in the OCI Console under Security settings. Remediation involves navigating to the IAM service in OCI and enabling the Guard Vulnerability Assessment option for user accounts.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/enablingguardvulnerability.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.identity.user.storage_is_on
  service: identity
  resource: user
  requirement: Storage Is On
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure User Storage Access is Properly Configured
  rationale: Proper management of user storage access is critical to prevent unauthorized data exposure and to safeguard sensitive information. Misconfigured access can lead to data breaches, financial loss, and non-compliance with regulations such as GDPR and PCI-DSS. Ensuring that only authorized users have storage access minimizes the risk of data compromise.
  description: This rule checks whether the storage access permissions for OCI users are configured appropriately, ensuring that access is granted based on the principle of least privilege. Verify that users have the necessary roles and permissions to access only the storage resources they require. To remediate, review user policies and update them to restrict storage access to authorized users only, leveraging OCI Identity and Access Management (IAM) policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-security-best-practices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.edge_services.distribution.distributions_https_enabled
  service: edge_services
  resource: distribution
  requirement: Distributions HTTPS Enabled
  scope: edge_services.distribution.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure HTTPS is Enabled for OCI Edge Distributions
  rationale: Enabling HTTPS for edge distributions is crucial to protect data in transit from interception and tampering. This ensures confidentiality and integrity, which are key for meeting compliance requirements such as PCI-DSS and GDPR. It also helps build customer trust by safeguarding sensitive information during content delivery.
  description: This rule checks that HTTPS is enabled for all Oracle Cloud Infrastructure edge distributions to secure data transmission. To verify, ensure that the SSL certificate is properly configured in the OCI console for each distribution. Remediation involves enabling HTTPS in the OCI Edge Services settings and configuring certificates from a trusted certificate authority. Regularly audit and update certificates to maintain security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DeliveryNetwork/Tasks/configuringhttps.htm
  - CIS OCI Benchmark v1.1.0 - Section 4.1
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.mysql.db_system.instance_automated_backups
  service: mysql
  resource: db_system
  requirement: Instance Automated Backups
  scope: mysql.db_system.backup_recovery
  domain: resilience_and_disaster_recovery
  subcategory: backup_configuration
  severity: medium
  title: Ensure Automated Backups for OCI MySQL DB Systems
  rationale: Automated backups in OCI MySQL DB Systems are crucial for ensuring data resilience and facilitating disaster recovery. Without automated backups, there is a risk of data loss in the event of system failures, cyber-attacks, or accidental deletions. Compliance with industry standards such as ISO 27001 and PCI-DSS often mandates regular data backup policies to protect sensitive information and maintain data integrity.
  description: This security rule checks if automated backups are enabled for MySQL DB Systems in OCI. MySQL DB System instances should have automated backups configured to ensure that data can be restored to any point in time within the retention period. Administrators should verify backup settings in the OCI Console under the 'Backups' tab of the MySQL DB System and enable 'Automated Backups' if not already configured. Ensure backups are stored in a secure location with an adequate retention period to align with organizational policies.
  references:
  - https://docs.oracle.com/en-us/iaas/mysql-database/doc/mysql-database-cloud-service-backup-and-recovery.html
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.mysql.db_system.instance_postgres_log_connections_flag
  service: mysql
  resource: db_system
  requirement: Instance Postgres Log Connections Flag
  scope: mysql.db_system.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable MySQL DB System Log Connections for Postgres
  rationale: Logging connection attempts to MySQL databases is essential for auditing and security monitoring. It helps detect unauthorized access attempts and provides insights into database usage patterns, which are crucial for compliance with standards like PCI-DSS and ISO 27001. Without logging, undetected anomalies can lead to data breaches and operational disruptions.
  description: This rule verifies that the MySQL DB System in OCI has the 'log_connections' parameter enabled for PostgreSQL compatibility, ensuring all connection attempts are logged. To check, navigate to the MySQL DB System in the OCI Console, review the configuration parameters, and ensure 'log_connections' is set to 'ON'. If not, modify the parameter through the console or via CLI. This action enhances the audit trail and supports robust security incident investigations.
  references:
  - https://docs.oracle.com/en-us/iaas/mysql-database/doc/logging-and-monitoring.html
  - https://www.oracle.com/security/cis-benchmarks/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.mysql.db_system.instance_postgres_log_disconnections_flag
  service: mysql
  resource: db_system
  requirement: Instance Postgres Log Disconnections Flag
  scope: mysql.db_system.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Postgres Log Disconnections in MySQL DB System
  rationale: Logging disconnections in MySQL DB Systems enhances visibility into user activity, aiding in the detection of unauthorized access, potential misuse, and abnormal session terminations. This logging capability supports compliance with regulatory requirements by providing a detailed audit trail, which is crucial for incident investigations and forensic analysis.
  description: This rule checks if the Postgres Log Disconnections flag is enabled in the MySQL DB System. Enabling this flag ensures that all disconnection events are logged, which is vital for monitoring user activity and maintaining an effective security posture. To verify, access the MySQL configuration settings in OCI and ensure the 'log_disconnections' parameter is set to 'on.' Remediation involves modifying the MySQL DB System's configuration to enable this parameter if it is not already activated.
  references:
  - https://docs.oracle.com/en-us/iaas/mysql-database/doc/logging.html
  - https://www.oracle.com/security/cis-benchmarks/
  - https://www.nist.gov/itl/applied-cybersecurity/nist-cybersecurity-framework
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/cloud/cloud-infrastructure-compliance/
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.mysql.db_system.instance_postgres_log_error_verbosity_flag
  service: mysql
  resource: db_system
  requirement: Instance Postgres Log Error Verbosity Flag
  scope: mysql.db_system.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Configure MySQL DB System Log Error Verbosity for Security
  rationale: Configuring the log error verbosity for MySQL DB systems is crucial to capture detailed error logs, which can help identify and mitigate security vulnerabilities and unauthorized access attempts. Without adequate logging, potential threats may go unnoticed, posing risks to data integrity and compliance with regulations like PCI-DSS and ISO 27001.
  description: This rule checks whether the MySQL DB system has its log error verbosity set to a level that provides sufficient detail for security auditing and troubleshooting. Ensure that the 'log_error_verbosity' parameter is configured in the MySQL configuration file to capture detailed error information. Administrators should set this parameter to 'verbose' to ensure all error levels are logged. Verification can be done by reviewing the MySQL configuration and adjusting the parameter as needed to meet compliance and security requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/mysql-database/doc/security-best-practices.html
  - https://www.oracle.com/security-alerts/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.mysql.db_system.instance_postgres_log_min_duration_statement_flag
  service: mysql
  resource: db_system
  requirement: Instance Postgres Log Min Duration Statement Flag
  scope: mysql.db_system.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure MySQL Log Min Duration Statement is Configured
  rationale: Configuring the minimum duration for logging statements in MySQL helps identify slow queries that could indicate performance issues or potential security threats. This setting allows for proactive monitoring and troubleshooting, which can improve database performance and security posture. It is also crucial for compliance with certain regulatory frameworks that require detailed logging of database activities.
  description: This rule checks if the 'log_min_duration_statement' parameter is configured for MySQL Database Systems in Oracle Cloud Infrastructure. This parameter should be set to a value that logs all SQL statements exceeding a specified execution time, aiding in the identification of inefficient queries. To verify, access the MySQL configuration via the OCI Console, and ensure 'log_min_duration_statement' is set to a recommended value. Remediation involves updating the MySQL configuration file to include this setting, followed by a restart of the database instance to apply changes.
  references:
  - https://docs.oracle.com/en-us/iaas/mysql-database/doc/mysql-database.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/References/securitycompliance.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security-cloud.html
- rule_id: oci.mysql.db_system.instance_postgres_log_min_error_statement_flag
  service: mysql
  resource: db_system
  requirement: Instance Postgres Log Min Error Statement Flag
  scope: mysql.db_system.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure MySQL DB Log Min Error Statement is Appropriately Set
  rationale: Configuring the Log Min Error Statement flag in MySQL DB systems is crucial for effective error logging and auditing. Improper configurations can lead to insufficient logging, making it challenging to detect and investigate security incidents, potentially resulting in non-compliance with standards like PCI-DSS and SOC2.
  description: This rule checks if the MySQL DB system has the 'Log Min Error Statement' parameter configured to capture sufficient error details in logs. This configuration helps in identifying and diagnosing issues efficiently. To verify, navigate to the MySQL DB system configuration in the OCI Console and check the logging parameters. Remediate by setting the Log Min Error Statement to 'ERROR' or a more verbose setting via OCI CLI or Console, ensuring comprehensive logging.
  references:
  - https://docs.oracle.com/en-us/iaas/mysql-database/doc/logging-and-monitoring.html
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/security/cloud-security/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.mysql.db_system.instance_postgres_log_min_messages_flag
  service: mysql
  resource: db_system
  requirement: Instance Postgres Log Min Messages Flag
  scope: mysql.db_system.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Postgres Log Min Messages Flag Set Correctly
  rationale: Configuring the 'log_min_messages' flag for PostgreSQL in MySQL DB Systems is crucial to controlling the verbosity of logs. Setting this appropriately helps in maintaining a balance between collecting sufficient logging data for audit and troubleshooting purposes, while avoiding excessive log generation that could lead to increased storage costs and potential information overload. Proper configuration supports compliance with regulatory standards requiring detailed audit logs, such as PCI-DSS and SOC2.
  description: This rule checks if the 'log_min_messages' flag is configured according to best practices in Oracle Cloud Infrastructure MySQL DB Systems. The flag determines the minimum message severity level that is logged, impacting logging detail and volume. It is important to set this flag to at least 'WARNING' to ensure critical issues are logged without overwhelming the system. To verify, access the console or use OCI CLI to inspect the DB System settings, and adjust the flag as needed through the DB System's configuration interface.
  references:
  - https://docs.oracle.com/en-us/iaas/mysql/doc/configure-logs.html
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/cloud/security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.mysql.db_system.instance_postgres_log_statement_flag
  service: mysql
  resource: db_system
  requirement: Instance Postgres Log Statement Flag
  scope: mysql.db_system.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure MySQL DB System Postgres Log Statement is Enabled
  rationale: Enabling detailed logging for MySQL DB systems ensures comprehensive audit trails are maintained, which can be crucial for detecting unauthorized access attempts and understanding the context of database transactions. This practice helps mitigate the risk of data breaches by providing visibility into database activities. It also aids organizations in meeting compliance requirements for frameworks such as PCI-DSS and helps in forensic investigations.
  description: This rule checks whether the 'log_statement' configuration is enabled for MySQL DB systems on OCI. This setting should be configured to capture all necessary SQL statements, providing thorough logging for security auditing. To verify, access the MySQL DB system configuration and ensure 'log_statement' is set to an appropriate level such as 'all'. Remediation involves updating the configuration to log all statements, ensuring that log data is securely stored and monitored.
  references:
  - https://docs.oracle.com/en-us/iaas/mysql-database/doc/logging.html
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.oracle.com/security-alerts/cis-benchmarks.html
  - https://www.oracle.com/cloud/security/
- rule_id: oci.object_storage.bucket.bucket_log_retention_policy_lock
  service: object_storage
  resource: bucket
  requirement: Bucket Log Retention Policy Lock
  scope: object_storage.bucket.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Bucket Log Retention Policy is Locked
  rationale: Locking the log retention policy for OCI Object Storage buckets is critical to prevent unauthorized changes that could lead to the loss of important audit trails. This helps in maintaining a reliable source of logging data for forensic investigations, ensuring adherence to compliance standards such as PCI-DSS and HIPAA, and mitigating risks associated with accidental or malicious log deletion.
  description: This rule checks whether the log retention policy for Object Storage buckets is locked, preventing any unauthorized changes. To verify, access the OCI Console, navigate to Object Storage, select the bucket, and review the log retention settings to ensure they are locked. Remediation involves administratively locking the retention policy and ensuring that only authorized personnel can make changes, thus securing audit logs against tampering.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.hipaajournal.com/hipaa-compliance-checklist/
- rule_id: oci.object_storage.bucket.bucket_public_access
  service: object_storage
  resource: bucket
  requirement: Bucket Public Access
  scope: object_storage.bucket.public_access
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: critical
  title: Prevent Public Access to Object Storage Buckets
  rationale: Allowing public access to OCI Object Storage buckets can lead to unauthorized data exposure, resulting in potential data breaches and regulatory non-compliance. Publicly accessible data can be exploited by malicious actors, impacting business reputation and incurring financial penalties under frameworks like PCI-DSS and GDPR.
  description: This rule checks if any Object Storage bucket is configured to allow public access. Public access can be verified by inspecting bucket policies and access control lists (ACLs) for overly permissive settings. To remediate, ensure that bucket policies are restricted to only allow access to trusted users or services within your organization, and disable any public access settings. Use Oracle's IAM policies to enforce secure access controls.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.1.0.htm#CIS_Control_3.1
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
  - https://cloud.oracle.com/en_US/security-best-practices
- rule_id: oci.devops.project.project_logging_enabled
  service: devops
  resource: project
  requirement: Project Logging Enabled
  scope: devops.project.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure DevOps Project Logging is Enabled
  rationale: Enabling logging for DevOps projects in OCI is crucial for maintaining an audit trail of all activities, which helps in identifying unauthorized access, operational issues, and security threats. It also supports compliance with regulatory requirements such as PCI-DSS and SOC2 by providing evidence of control over development processes.
  description: This rule checks if logging is enabled for OCI DevOps projects, which is essential for capturing detailed information about operations and changes within the project. To verify, ensure that logging is activated in the OCI Console under the DevOps project settings. If not enabled, navigate to the 'Logging' section in your DevOps project and configure the necessary log groups and log objects to capture relevant data. This setup allows for real-time monitoring and historical analysis of project activities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DevOps/using/devopslogging.htm
  - https://www.oracle.com/security/cis-benchmarks/
  - https://www.pcisecuritystandards.org/
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/sorhome.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.compute.instance.account_block_public_access
  service: compute
  resource: instance
  requirement: Account Block Public Access
  scope: compute.instance.public_access
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Restrict Public Access to Compute Instances
  rationale: Blocking public access to compute instances is crucial to prevent unauthorized access and potential data breaches. Exposing instances to the internet increases the risk of exploitation by attackers, leading to data loss, service disruption, and non-compliance with regulations such as PCI-DSS and ISO 27001. Implementing this control helps maintain data confidentiality and integrity by ensuring only authorized internal networks can access instances.
  description: This rule checks if public access to compute instances is restricted by ensuring no public IP addresses are associated with them. Verify instances by examining their networking configuration in the OCI console or using the CLI for public IP assignments. To remediate, remove any public IPs and use private IPs within a Virtual Cloud Network (VCN). Implement Security Lists or Network Security Groups (NSGs) with rules that block inbound traffic from public sources.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingVCNs.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.1/cis-1.1-compute.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.compute.instance.ami_public
  service: compute
  resource: instance
  requirement: Ami Public
  scope: compute.instance.public_access
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Ensure Compute Instances Do Not Use Public AMIs
  rationale: Using public AMIs can expose your compute instances to vulnerabilities if those images are not vetted for security and compliance. Public AMIs may contain misconfigurations or malware, leading to potential unauthorized access or data breaches. Ensuring instances use vetted private images aligns with organizational security policies and regulatory compliance such as PCI-DSS and HIPAA.
  description: This check verifies that compute instances are not launched using publicly shared AMIs. Public AMIs can be untrusted and may introduce vulnerabilities if not properly assessed. Verify instance configurations to ensure they use private or Oracle-provided images that are regularly updated and patched. Remediation involves creating and using custom images that are hardened and approved by your organization's security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/References/computeimages.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/References/security_ami.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/security_standards/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.compute.instance.backup_enabled
  service: compute
  resource: instance
  requirement: Backup Enabled
  scope: compute.instance.backup_recovery
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: medium
  title: Ensure Compute Instances Have Backups Enabled
  rationale: Enabling backups for OCI compute instances is crucial for data protection and business continuity. Without regular backups, critical data may be lost in case of accidental deletions, system failures, or malicious attacks, leading to operational disruptions and financial loss. Compliance with regulatory frameworks such as PCI-DSS and ISO 27001 often requires data backup strategies to mitigate risks associated with data loss.
  description: This rule checks if OCI compute instances have backup policies configured and enabled. It evaluates whether automated backup policies are applied to instances, ensuring data is recoverable in case of failure. Verify by checking the instance's attached block volume for a backup policy in the OCI Console under Block Storage. Remediate by applying an automated backup policy to all critical instances via the OCI Console or CLI, ensuring backups are scheduled according to business requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/schedulingbackups.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.compute.instance.client_vpn_endpoint_connection_logging_enabled
  service: compute
  resource: instance
  requirement: Client Vpn Endpoint Connection Logging Enabled
  scope: compute.instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable VPN Endpoint Connection Logging on Compute Instances
  rationale: Enabling connection logging for VPN endpoints on compute instances is crucial for monitoring and auditing network access, which helps in detecting unauthorized access attempts and potential security breaches. This practice supports compliance with regulations such as NIST and PCI-DSS that mandate logging and monitoring of network activities, thus reducing the risk of data exposure and enhancing the overall security posture.
  description: This rule checks whether client VPN endpoint connection logging is enabled on Oracle Cloud Infrastructure compute instances. To verify, ensure that logging is configured through the OCI Console by navigating to the Networking section, selecting VPN, and enabling logging for each endpoint. Remediation involves accessing the VPN settings of the compute instance and enabling the connection logging feature, which records connection details and supports security audits.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingVPNs.htm#log
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security-cloud-compliance/
- rule_id: oci.compute.instance.ebs_default_encryption
  service: compute
  resource: instance
  requirement: Ebs Default Encryption
  scope: compute.instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Default Encryption for Compute Instances in OCI
  rationale: Encrypting data at rest is critical to protecting sensitive information from unauthorized access and potential data breaches. This is particularly important for compliance with regulatory standards such as PCI-DSS, HIPAA, and ISO 27001, which mandate stringent data protection measures. Default encryption helps mitigate the risk of data exposure by automatically encrypting all data stored on Elastic Block Storage (EBS) volumes.
  description: This rule checks whether default encryption is enabled for all new Elastic Block Storage (EBS) volumes attached to Oracle Cloud Infrastructure (OCI) compute instances. Verify that the encryption is configured properly by ensuring that the encryption key is set to either an Oracle-managed key or a customer-managed key (CMK) in the OCI Vault. To remediate, navigate to the EBS settings in the OCI Console, enable default encryption, and choose the appropriate key management option.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/managingvolumes.htm#default_encryption
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.compute.instance.ebs_public_snapshot
  service: compute
  resource: instance
  requirement: Ebs Public Snapshot
  scope: compute.instance.backup_recovery
  domain: resilience_and_disaster_recovery
  subcategory: backup_configuration
  severity: critical
  title: Restrict OCI Compute EBS Public Snapshot Access
  rationale: Public EBS snapshots can lead to unauthorized data access, exposing sensitive information to external threats. This vulnerability could result in data breaches, impacting business continuity and violating compliance mandates such as PCI-DSS and ISO 27001.
  description: This rule checks for EBS snapshots that are publicly accessible within OCI Compute instances. To verify, ensure that all EBS snapshots are private by default. Remediation involves modifying the snapshot's permissions to restrict public access, thereby aligning with best practices for data security and disaster recovery in cloud environments.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/managingsnapshots.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_platform/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.compute.ebs.public_snapshot
  service: compute
  resource: ebs
  requirement: Public Snapshot
  scope: compute.ebs.backup_recovery
  domain: resilience_and_disaster_recovery
  subcategory: backup_configuration
  severity: critical
  title: Prohibit Public Exposure of EBS Snapshots
  rationale: Publicly exposed EBS snapshots can lead to unauthorized access to sensitive data, posing a significant security risk. This exposure may result in data breaches, loss of intellectual property, and non-compliance with data protection regulations such as GDPR or HIPAA. Ensuring snapshots are not publicly accessible mitigates the risk of data leakage and enhances the overall security posture.
  description: This rule checks for Oracle Cloud Infrastructure EBS snapshots that are publicly accessible. Public snapshots can be accessed by any user, potentially exposing sensitive data to unauthorized parties. To verify, check the snapshot settings in the OCI console and ensure they are set to private. Remediation involves modifying the snapshot's settings to restrict access, ensuring that only authorized users have visibility and access. Implement IAM policies to control access to sensitive resources.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/managingblockvolumes.htm#snapshots
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.oracle.com/cloud-security/cloud-compliance/
  - https://www.cisecurity.org/controls/cis-controls-v8/
- rule_id: oci.compute.instance.ebs_volume_encryption
  service: compute
  resource: instance
  requirement: Ebs Volume Encryption
  scope: compute.instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure EBS Volume Encryption for Compute Instances
  rationale: Encrypting EBS volumes attached to compute instances is critical to protect sensitive data at rest from unauthorized access and potential data breaches. This practice mitigates risks associated with data exposure due to compromised instances or unauthorized snapshots. It also addresses compliance requirements for data protection standards such as PCI-DSS and HIPAA, which mandate strong encryption for stored data.
  description: This rule checks that all Elastic Block Store (EBS) volumes attached to Oracle Cloud Infrastructure (OCI) compute instances are encrypted. Encrypted volumes protect data at rest by using Oracle-managed keys or customer-managed keys for enhanced control. To verify, ensure that encryption is enabled for each EBS volume in the OCI Console under the 'Block Volumes' section. Remediation involves configuring encryption during volume creation or enabling it for existing volumes via the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/managingblockvolumes.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-111.pdf
- rule_id: oci.compute.instance.ebs_snapshots_encrypted
  service: compute
  resource: instance
  requirement: Ebs Snapshots Encrypted
  scope: compute.instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure EBS Snapshots are Encrypted on Compute Instances
  rationale: Encrypting EBS snapshots protects sensitive data from unauthorized access and potential data breaches. It mitigates the risk of data leaks in scenarios where backups are accessed by malicious actors. Compliance with data protection standards such as PCI-DSS and HIPAA often mandates encryption of data at rest, making this a critical security control.
  description: This rule checks whether snapshots of Elastic Block Storage (EBS) volumes attached to OCI Compute instances are encrypted. To verify, review the encryption settings of your EBS snapshots in the OCI console. If not encrypted, enable encryption by creating snapshots with encryption enabled or by using the Oracle Cloud Infrastructure CLI. Utilize Oracle's Key Management service to manage encryption keys securely.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/creatingasnapshot.htm#block
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm#security_and_compliance
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-111.pdf
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
- rule_id: oci.compute.instance.elastic_ip_unassigned
  service: compute
  resource: instance
  requirement: Elastic Ip Unassigned
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Elastic IPs are Assigned to Active Instances
  rationale: Unassigned Elastic IPs represent potential cost inefficiencies and a security risk if left unmonitored, as they can be inadvertently reassigned without proper controls. Mismanagement of Elastic IPs may lead to unauthorized access points or IP hijacking scenarios, affecting business operations and violating regulatory requirements such as PCI-DSS and SOC2, which emphasize resource control and monitoring.
  description: This rule checks for Elastic IP addresses that are not currently assigned to any active compute instances in Oracle Cloud Infrastructure (OCI). Unassigned Elastic IPs can incur unnecessary costs and may be potentially misused. It is important to regularly audit your Elastic IP allocations and ensure they are reassigned or released when not in use. To remediate, review your list of Elastic IPs in the OCI Console, validate their necessity, and either assign them to appropriate instances or release them if they are no longer needed.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingpublicIPs.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/cloud/security/
- rule_id: oci.compute.instance.firewall_rdp_access_from_the_internet_allowed
  service: compute
  resource: instance
  requirement: Firewall Rdp Access From The Internet Allowed
  scope: compute.instance.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Restrict RDP Access to OCI Compute Instances
  rationale: Allowing RDP access from the internet exposes compute instances to potential unauthorized access, increasing the risk of cyber attacks such as brute force attempts. This can lead to data breaches, unauthorized data manipulation, or service disruptions, violating compliance with standards like PCI-DSS and ISO 27001 that mandate secure access controls.
  description: This rule checks for network security group rules allowing unrestricted RDP access (port 3389) to compute instances from the internet. It verifies if any security list or NSG associated with the instance permits inbound RDP traffic from 0.0.0.0/0. To remediate, configure security rules to restrict RDP access to trusted IPs only and consider using OCI Bastion or VPN for secure remote access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securityrules.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Bastion/overview.htm
- rule_id: oci.compute.instance.firewall_ssh_access_from_the_internet_allowed
  service: compute
  resource: instance
  requirement: Firewall Ssh Access From The Internet Allowed
  scope: compute.instance.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Restrict SSH Access to OCI Instances from the Internet
  rationale: Allowing SSH access from the internet to OCI instances increases the risk of unauthorized access and potential compromise. This exposure can lead to data breaches, unauthorized data manipulation, or service disruption. Restricting this access is crucial to comply with security frameworks like NIST and ISO 27001, which emphasize minimizing attack surfaces.
  description: This rule checks if OCI compute instances have firewall rules allowing SSH access from any internet address. To verify, inspect the network security group or security list associated with the instance for rules permitting ingress on port 22 from 0.0.0.0/0. If such rules exist, they should be modified to restrict access to known IP addresses or use VPN solutions for remote access. Implement OCI Bastion for secure access to instances without exposing them directly to the internet.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_platform
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/secure-best-practices.htm
  - https://docs.oracle.com/en-us/iaas/Content/Bastion/Concepts/bastionoverview.htm
- rule_id: oci.compute.instance.instance_block_project_wide_ssh_keys_disabled
  service: compute
  resource: instance
  requirement: Instance Block Project Wide Ssh Keys Disabled
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: high
  title: Disable Project-Wide SSH Keys on Compute Instances
  rationale: Enabling project-wide SSH keys for compute instances can expose sensitive systems to unauthorized access, increasing the risk of data breaches and unauthorized changes. Project-wide keys can be misused if not properly managed, posing a threat to the integrity and confidentiality of workloads. Disabling project-wide SSH keys helps ensure that SSH access is restricted and managed on a per-instance basis, aligning with security best practices and compliance requirements like PCI-DSS and ISO 27001.
  description: This rule checks if project-wide SSH keys are disabled on OCI compute instances to prevent unauthorized access. Instances should be configured to use specific SSH keys that are managed individually for each instance, rather than a common project-wide key. To verify, review the instance's metadata settings and ensure the 'blockProjectWideSshKeys' attribute is set to true. Remediation involves updating instance configurations to block project-wide SSH keys and using instance-specific keys for secure access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/launchinginstance.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.compute.instance.instance_confidential_computing_enabled
  service: compute
  resource: instance
  requirement: Instance Confidential Computing Enabled
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Confidential Computing is Enabled for Instances
  rationale: Confidential Computing protects sensitive data in use by performing computations in a hardware-based trusted execution environment. This reduces the risk of data exposure through memory attacks or unauthorized access, which is crucial for maintaining compliance with data protection regulations like GDPR and ensuring the integrity and confidentiality of sensitive workloads.
  description: This rule checks if Confidential Computing is enabled on Oracle Cloud Infrastructure (OCI) compute instances. Instances should be configured to use AMD Secure Encrypted Virtualization (SEV) or Intel Software Guard Extensions (SGX) to protect data in use. To verify, ensure that the instance configuration specifies a compatible shape. Remediation involves using OCI Console or CLI to modify the instance settings and select a shape that supports Confidential Computing.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Concepts/computeselection.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/security/cloud.html
  - https://www.oracle.com/cloud/compute/
- rule_id: oci.compute.instance.instance_encryption_with_csek_enabled
  service: compute
  resource: instance
  requirement: Instance Encryption With Csek Enabled
  scope: compute.instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable Customer-Managed Encryption Keys for Compute Instances
  rationale: Encrypting compute instances with Customer-Supplied Encryption Keys (CSEK) ensures that sensitive data is protected using customer-controlled keys, minimizing unauthorized data access risks. This is crucial for businesses handling regulated data, as it helps meet strict compliance requirements and reduces the risk of data breaches that can result in financial and reputational damage.
  description: This rule checks if Oracle Cloud Infrastructure (OCI) compute instances are encrypted using Customer-Supplied Encryption Keys (CSEK). Instances should be configured to utilize these keys to enhance data security. Verification involves ensuring the instance's boot volume and attached block volumes leverage CSEK. Remediation requires configuring or updating the instance settings to enable CSEK in the OCI console or through CLI/API, ensuring that the keys are securely managed and rotated regularly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/managingvolumes.htm#using_your_own_keys
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_fundamentals.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - 'NIST SP 800-57 Part 1: Recommendation for Key Management'
  - 'PCI-DSS Requirement 3.5: Protect encryption keys against disclosure and misuse'
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.compute.instance.instance_imdsv2_enabled
  service: compute
  resource: instance
  requirement: Instance Imdsv2 Enabled
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Enable Instance Metadata Service v2 for Enhanced Security
  rationale: Enabling Instance Metadata Service v2 (IMDSv2) for Oracle Cloud Infrastructure (OCI) instances is crucial for enhancing security by preventing unauthorized access to sensitive metadata. This mitigates the risk of metadata theft through server-side request forgery (SSRF) attacks, which can lead to exposure of credentials and other critical data. Adhering to this security measure aligns with compliance frameworks that require robust access controls and data protection mechanisms.
  description: This rule checks whether Oracle Cloud Infrastructure (OCI) compute instances have Instance Metadata Service v2 (IMDSv2) enabled, which requires session-based authentication for accessing instance metadata. To verify, ensure that the instance metadata service is set to use IMDSv2 and configure applications or scripts to use the session-oriented requests. Remediation involves updating instance configurations to enforce IMDSv2 and modifying any metadata queries accordingly to comply with the new access requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/queryinginstance.htm#IMDSv2
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_iam_best_practices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.compute.instance.instance_ip_forwarding_is_enabled
  service: compute
  resource: instance
  requirement: Instance Ip Forwarding Is Enabled
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure IP Forwarding is Disabled on OCI Compute Instances
  rationale: Enabling IP forwarding on compute instances can expose the network to potential attacks such as IP spoofing and man-in-the-middle attacks, compromising sensitive data and violating compliance standards. Disabling IP forwarding reduces the risk of unauthorized network traffic routing through the instance, thereby enhancing the overall security posture of the cloud environment.
  description: This rule checks if IP forwarding is enabled on Oracle Cloud Infrastructure (OCI) compute instances. IP forwarding allows the instance to forward packets not addressed to itself, which can be exploited if not properly secured. Verification involves checking the instance's network settings to ensure IP forwarding is disabled. To remediate, access the instance's configuration in the OCI console, navigate to the networking section, and disable IP forwarding. This aligns with security best practices to prevent unauthorized traffic routing.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingVNICs.htm#Enabling_and_Disabling_IP_Forwarding
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://cloud.oracle.com/architecture/security-best-practices
  - https://www.iso.org/standard/54534.html
- rule_id: oci.compute.instance.instance_managed_by_ssm
  service: compute
  resource: instance
  requirement: Instance Managed By Ssm
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure OCI Compute Instances are Managed by Oracle SSM
  rationale: Managing OCI compute instances with Oracle SSM (Secure Service Mesh) enhances security by ensuring consistent security policies and controls across instances, reducing the risk of misconfiguration and unauthorized access. It supports compliance with security frameworks by enforcing access controls and monitoring network traffic, which is crucial for maintaining data confidentiality and integrity.
  description: This rule checks whether OCI compute instances are managed by Oracle Secure Service Mesh, which provides centralized control over security policies and access management. Verify that instances are linked to SSM by reviewing their configuration settings in the OCI console. To remediate, integrate instances into the Secure Service Mesh through OCI console or CLI to enforce uniform security policies and ensure robust monitoring and logging.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/ssm.htm
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/managinginstances.htm
  - CIS OCI Foundations Benchmark
  - NIST SP 800-53
  - PCI DSS Requirement 10
  - https://cloud.oracle.com/cloud-infrastructure/security
- rule_id: oci.compute.instance.instance_managed_by_os_management
  service: compute
  resource: instance
  requirement: Instance Managed By OS Management
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Instances are Managed by OS Management
  rationale: Managing instances through OS Management in OCI enhances security by providing automated patching and updates, reducing vulnerabilities and downtime. It ensures consistent compliance with security policies and regulatory requirements by maintaining up-to-date system configurations, which is crucial for mitigating potential security threats and ensuring business continuity.
  description: This rule checks whether compute instances in OCI are managed by OS Management, which provides automated patching and updates. To verify, ensure that the instance is registered with OS Management and visible in the OS Management service console. Remediation involves enabling OS Management for instances, which can be done through the OCI console by navigating to the Compute instance details and selecting the option to enable OS Management.
  references:
  - https://docs.oracle.com/en-us/iaas/os-management/osm-getting-started.htm
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/launchinginstance.htm
  - https://docs.oracle.com/en-us/iaas/Content/Compliance/Concepts/complycontrols.htm
  - CIS OCI Foundations Benchmark v1.1.0
  - 'NIST SP 800-53 SI-2: Flaw Remediation'
  - 'PCI-DSS Requirement 6: Develop and maintain secure systems and applications'
- rule_id: oci.compute.instance.instance_metadata_service_imdsv2_enabled
  service: compute
  resource: instance
  requirement: Instance Metadata Service Imdsv2 Enabled
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Enable Instance Metadata Service v2 for Compute Instances
  rationale: Enabling Instance Metadata Service v2 (IMDSv2) enhances security by mitigating the risk of unauthorized metadata access, which can lead to sensitive data exposure and potential privilege escalation. It is crucial for maintaining robust instance security, protecting against common cloud threats, and meeting compliance requirements for data protection and access control.
  description: This rule checks if Oracle Cloud Infrastructure Compute instances have IMDSv2 enabled, which requires session-oriented requests for accessing instance metadata. To verify, ensure that the 'instance_metadata_service_version' parameter is set to 'V2'. Remediation involves configuring the instance metadata options to enforce IMDSv2, thus ensuring secure access to instance metadata and reducing the attack surface.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/gettingmetadata.htm
  - https://www.oracle.com/security/cis-benchmarks/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://cloudsecurityalliance.org/artifacts/cloud-controls-matrix-v3-0-1/
  - https://www.iso.org/standard/54534.html
- rule_id: oci.compute.instance.instance_no_public_ip
  service: compute
  resource: instance
  requirement: Instance No Public Ip
  scope: compute.instance.public_access
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Ensure Compute Instances Have No Public IPs
  rationale: Assigning public IP addresses to compute instances increases the risk of unauthorized access and exposure to the internet, which can lead to data breaches and compliance violations. By restricting public IP addresses, organizations can reduce the attack surface and adhere to compliance frameworks such as PCI-DSS and ISO 27001, which mandate strict access controls.
  description: This rule checks for Oracle Cloud Infrastructure compute instances that have been assigned public IP addresses. Instances should be configured to only use private IPs within a Virtual Cloud Network (VCN) to minimize exposure to the internet. To verify, check the instance's network configuration in the OCI Console and ensure the 'Public IP' setting is disabled. If a public IP is required, use an OCI Load Balancer or a Bastion service to manage access. Remediation involves reconfiguring the instance to remove the public IP and ensuring secure access through private networking or VPN connections.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingpublicIPs.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.0_benchmark.htm#1.0
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/legacy/sp/nistspecialpublication800-53r4.pdf
- rule_id: oci.compute.instance.instance_older_than_specific_days
  service: compute
  resource: instance
  requirement: Instance Older Than Specific Days
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Monitor and Update Instances Older Than Specified Duration
  rationale: Instances running on outdated configurations may be vulnerable to security threats due to unpatched vulnerabilities, lack of compliance with current security standards, and deprecated features. Regular updates and audits are crucial to maintain security posture, ensure compliance with regulations such as PCI-DSS and SOC2, and protect against potential data breaches.
  description: This rule checks for compute instances that have been running beyond a specified number of days without updates. Instances older than the defined threshold should be reviewed for outdated software and configurations. To remediate, schedule regular updates using OCI's instance management tools or consider replacing older instances with new ones using updated images. Verification can be done by reviewing the instance creation timestamps in the OCI console and cross-referencing with the latest security advisories.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/managinginstances.htm
  - https://www.cisecurity.org/benchmark/oracle/
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/security/cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.compute.instance.instance_port_cassandra_exposed_to_internet
  service: compute
  resource: instance
  requirement: Instance Port Cassandra Exposed To Internet
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Cassandra Port Exposed on Compute Instance
  rationale: Exposing Cassandra ports (default 9042) to the internet increases the risk of unauthorized access, data breaches, and denial of service attacks. This vulnerability can lead to significant business impacts, including data loss, reputational damage, and non-compliance with regulations such as PCI-DSS and GDPR, which require secure data handling and protection.
  description: This rule checks if the Cassandra service port is open to the internet on OCI compute instances, which should be restricted to trusted IPs. To verify, review the security list or network security group associated with the instance's subnet for ingress rules allowing traffic on port 9042 from 0.0.0.0/0. Remediation involves updating these rules to allow only specific IP addresses or CIDR blocks that require access, or employing Oracle Cloud's Web Application Firewall for added security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-security-arch.htm
- rule_id: oci.compute.instance.instance_port_cifs_exposed_to_internet
  service: compute
  resource: instance
  requirement: Instance Port Cifs Exposed To Internet
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Block CIFS Port Exposure on OCI Compute Instances
  rationale: Exposing the CIFS port (TCP 445) to the internet increases the risk of unauthorized access and exploitation by attackers, potentially leading to data breaches, ransomware, and compliance violations. Ensuring CIFS ports are not publicly accessible mitigates these risks and helps maintain data integrity and confidentiality, especially for organizations handling sensitive information.
  description: This rule checks if any OCI compute instances have the CIFS port (TCP 445) open to the internet. An open CIFS port can be exploited by attackers to gain unauthorized access to shared files, leading to potential data theft or network compromise. To remediate, restrict access to CIFS by configuring security lists or network security groups (NSGs) to allow traffic only from trusted IP addresses. Regularly audit and update security group rules to align with best practices and organizational policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cloud-security-best-practices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.compute.instance.instance_port_elasticsearch_kibana_exposed_to_internet
  service: compute
  resource: instance
  requirement: Instance Port Elasticsearch Kibana Exposed To Internet
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Elasticsearch and Kibana Ports Exposed to the Internet
  rationale: Exposing Elasticsearch and Kibana ports to the internet can lead to unauthorized data access, data leakage, or service disruption. Attackers can exploit these open ports to execute attacks like data theft, index deletion, or denial-of-service. Additionally, this exposure may violate compliance standards such as PCI-DSS and GDPR, which require stringent access controls for data protection.
  description: This rule checks for Oracle Cloud Infrastructure compute instances with Elasticsearch and Kibana ports (typically 9200 and 5601) open to the internet. To verify, review the security list or network security group associated with the instance and ensure that these ports are not open to public IP addresses. Remediation involves adjusting the security list to restrict access to trusted IP addresses only or using a bastion host for controlled access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.elastic.co/guide/en/elasticsearch/reference/current/security-settings.html
  - https://www.elastic.co/guide/en/kibana/current/secure-kibana.html
- rule_id: oci.compute.instance.instance_port_ftp_exposed_to_internet
  service: compute
  resource: instance
  requirement: Instance Port Ftp Exposed To Internet
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: FTP Port Exposed to Internet on OCI Compute Instance
  rationale: Exposing FTP ports to the internet significantly increases the risk of unauthorized access, data breaches, and exploitation by attackers. This vulnerability can lead to critical data loss or compromise, affecting business continuity and violating compliance standards such as PCI-DSS and ISO 27001, which mandate secure access controls for data protection.
  description: This rule checks for OCI compute instances with FTP ports (port 21) exposed to the internet. Such configurations can be verified by inspecting the security list rules and network security groups associated with the instance's subnet for any ingress rules allowing unrestricted IP addresses (0.0.0.0/0) on port 21. Remediation involves updating these security rules to restrict access to only trusted IP addresses or using secure alternatives like SFTP or FTPS to encrypt data in transit.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/References/cis_oci_benchmark_v1.2.0.htm
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/best_practices.htm
- rule_id: oci.compute.instance.instance_port_kafka_exposed_to_internet
  service: compute
  resource: instance
  requirement: Instance Port Kafka Exposed To Internet
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Kafka Port Exposure on OCI Instances to Internet
  rationale: Exposing Kafka ports to the internet increases the risk of unauthorized access and data breaches, potentially leading to loss of sensitive information and service disruptions. This configuration may violate compliance requirements such as PCI-DSS and ISO 27001, which mandate strict access controls to sensitive services. Unsecured Kafka instances can be exploited for data exfiltration or as entry points for further attacks.
  description: This rule checks if Kafka ports on OCI compute instances are publicly accessible. A Kafka service running on default ports (e.g., 9092) should not be directly exposed to the internet. To verify, review the instance's security list and network security group settings for rules allowing unrestricted ingress to these ports. Remediation involves restricting access to trusted IPs or using a VPN to secure communication, and implementing Oracle Cloud Infrastructure Network Security Groups (NSGs) to enforce stricter access controls.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securityrules.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/securearchitecture.htm
- rule_id: oci.compute.instance.instance_port_kerberos_exposed_to_internet
  service: compute
  resource: instance
  requirement: Instance Port Kerberos Exposed To Internet
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Kerberos Port Exposed to Internet on OCI Compute Instance
  rationale: Exposing the Kerberos port (88) to the internet can lead to unauthorized access to authentication services, risking credential theft and allowing potential attackers to exploit vulnerabilities in the Kerberos protocol. This exposure can compromise the integrity and confidentiality of sensitive data and violates compliance standards such as PCI-DSS and ISO 27001, which mandate secure configuration of network services.
  description: This rule checks for OCI compute instances with port 88 open to the internet, which exposes the Kerberos authentication service. To verify, inspect the security list rules or network security groups associated with the instance's subnet for ingress rules allowing unrestricted access to port 88. Remediation involves restricting access to trusted IP ranges, utilizing private subnets, and implementing additional security layers such as Web Application Firewalls (WAF) or VPNs to protect Kerberos services.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_compute
  - https://nvlpubs.nist.gov/nistpubs/legacy/sp/nistspecialpublication800-123.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
- rule_id: oci.compute.instance.instance_port_ldap_exposed_to_internet
  service: compute
  resource: instance
  requirement: Instance Port Ldap Exposed To Internet
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Prevent LDAP Port Exposure on OCI Instances
  rationale: Exposing LDAP ports to the internet can lead to unauthorized access and data breaches, as attackers may exploit this to gain sensitive information or escalate privileges. It poses significant business risks including data loss, compliance violations with standards such as PCI-DSS and SOC2, and potential financial and reputational damage.
  description: This rule checks if any compute instance has the LDAP port (typically port 389 or 636 for secure LDAP) open to the internet. It is crucial to restrict this access to trusted IP addresses or within a secure VPN. Remediation involves setting up proper security lists or network security groups to limit inbound traffic on these ports to known entities, ensuring LDAP services are only accessible from authorized networks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_oci_security_guidelines.htm
- rule_id: oci.compute.instance.instance_port_memcached_exposed_to_internet
  service: compute
  resource: instance
  requirement: Instance Port Memcached Exposed To Internet
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Memcached Port Exposure to Internet on OCI Instances
  rationale: Exposing Memcached ports to the internet poses significant security risks, including unauthorized data access, data exfiltration, and potential service disruption due to Distributed Denial of Service (DDoS) attacks. Organizations must mitigate these threats to protect sensitive data and maintain compliance with regulations like PCI-DSS and ISO 27001, which mandate strict access controls.
  description: This rule checks if the Memcached default port (11211) is open to the internet on OCI compute instances. If exposed, it can be exploited by attackers to gain unauthorized access or launch DDoS attacks. Verify security groups and network security lists to ensure the port is restricted to trusted IP addresses. Remediation involves configuring security rules to deny public access and applying patches or updates to reduce vulnerabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/securitygroups.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
  - https://www.pcisecuritystandards.org/document_library
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.compute.instance.instance_port_mongodb_exposed_to_internet
  service: compute
  resource: instance
  requirement: Instance Port Mongodb Exposed To Internet
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Restrict MongoDB Port Exposure on OCI Instances
  rationale: Exposing MongoDB ports to the internet can lead to unauthorized access and data breaches, as MongoDB instances may contain sensitive business information. Attackers can exploit open ports to execute data exfiltration, denial of service, or other malicious activities. Compliance with standards such as PCI-DSS and ISO 27001 requires strict control of access to data resources.
  description: This rule checks for OCI compute instances with MongoDB ports (default 27017) open to the internet. Instances with open MongoDB ports can be verified by inspecting the security list and network security group settings for inbound rules allowing traffic from 0.0.0.0/0. To remediate, restrict access by using security rules that only permit trusted IP addresses or use private network configurations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://oci-cis.oraclecloud.com/1.0.0/compute.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-123.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.mongodb.com/blog/post/6-tips-to-secure-your-mongodb-deployments
- rule_id: oci.compute.instance.instance_port_mysql_exposed_to_internet
  service: compute
  resource: instance
  requirement: Instance Port Mysql Exposed To Internet
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: MySQL Port on OCI Instance Exposed to Internet
  rationale: Exposing MySQL ports to the internet increases the risk of unauthorized access, data breaches, and potential database compromises. This exposure can lead to business disruption, loss of sensitive information, and failure to comply with regulatory requirements such as PCI-DSS and GDPR, which mandate the protection of customer data against unauthorized access.
  description: This rule checks if the MySQL port (default 3306) on OCI compute instances is exposed to the internet. Instances with this configuration allow unrestricted access, posing significant security risks. To verify, review the instance's security list or network security group for rules allowing inbound traffic to port 3306 from all IP addresses (0.0.0.0/0). Remediate by restricting access to trusted IPs only and employing OCI's network security groups or security lists to enforce strict ingress rules.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networksecuritygroups.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_security_best_practices.htm
  - https://www.oracle.com/security-alerts/cpuoct2023.html
- rule_id: oci.compute.instance.instance_port_oracle_exposed_to_internet
  service: compute
  resource: instance
  requirement: Instance Port Oracle Exposed To Internet
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Prevent Oracle DB Ports Exposure to Internet on Instances
  rationale: Exposing Oracle Database ports to the internet can lead to unauthorized access, data breaches, and potential compliance violations. Attackers may exploit open ports to gain access to sensitive information, resulting in significant financial and reputational damage. Ensuring port security is crucial for maintaining data confidentiality and integrity, especially in regulated industries.
  description: This rule checks for Oracle Database ports (e.g., 1521) that are open on compute instances and exposed to the public internet. To verify, review the security list and network security group configurations for ingress rules allowing unrestricted access to these ports. Remediation involves restricting access to known IP addresses, using private endpoints, or deploying a bastion host for secure access. Implementing these measures helps mitigate unauthorized access risks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-1-1-0-benchmark.htm
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security-cloud/cloud-security-best-practices/
- rule_id: oci.compute.instance.instance_port_postgresql_exposed_to_internet
  service: compute
  resource: instance
  requirement: Instance Port Postgresql Exposed To Internet
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: PostgreSQL Port Exposed to Internet on OCI Instances
  rationale: Exposing PostgreSQL port to the internet can lead to unauthorized access and potential data breaches. Attackers can exploit this exposure to execute SQL injection attacks or gain access to sensitive data. Ensuring database ports are not publicly accessible helps comply with security standards such as PCI-DSS and ISO 27001, reducing the risk of data theft and maintaining customer trust.
  description: This rule checks if any compute instance in OCI has the PostgreSQL default port (usually 5432) exposed to the internet, which can be verified by reviewing the security list rules associated with the instance's subnet. To remediate, modify the security list or network security group to restrict inbound access to the PostgreSQL port, allowing only trusted IP addresses or ranges. Utilize OCI's network security features such as Network Security Groups (NSGs) and Security Lists to enforce these restrictions and prevent unauthorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networksecuritygroups.htm
  - https://docs.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/pci_security/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
- rule_id: oci.compute.instance.instance_port_rdp_exposed_to_internet
  service: compute
  resource: instance
  requirement: Instance Port Rdp Exposed To Internet
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Ensure RDP Port on Compute Instances is Not Publicly Accessible
  rationale: Exposing Remote Desktop Protocol (RDP) ports to the public internet significantly increases the risk of unauthorized access and potential data breaches. Attackers can exploit open RDP ports to gain control over virtual machines, leading to potential data loss, service disruption, and non-compliance with security standards such as PCI-DSS and ISO 27001.
  description: This rule checks for compute instances with RDP (port 3389) exposed to the internet, by reviewing security list or network security group configurations. Instances with open RDP ports should be behind a bastion host or VPN. To remediate, update the security lists or network security groups to restrict access to known IP addresses, or utilize the OCI Bastion service for secure access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.0.0.htm
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Bastion/overview.htm
- rule_id: oci.compute.instance.instance_port_redis_exposed_to_internet
  service: compute
  resource: instance
  requirement: Instance Port Redis Exposed To Internet
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Redis Port Exposure Mitigation on OCI Instances
  rationale: Exposing Redis ports to the internet can lead to unauthorized access, data breaches, and potential exploitation of vulnerabilities. This exposure increases the attack surface, allowing attackers to exploit weak authentication mechanisms or unpatched Redis instances. Businesses must secure their Redis instances to comply with security standards and avoid potential data loss and compliance violations.
  description: 'This rule checks if Redis ports (default: 6379) on OCI compute instances are accessible from the internet. Instances should be configured with security lists or network security groups to restrict access to trusted IP addresses only. Verify the security configurations via the OCI Console and update security rules to block public access. Implement VCN flow logs and enable monitoring to detect unauthorized access attempts.'
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.0.0.pdf
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/document_library
  - https://redis.io/topics/security
- rule_id: oci.compute.instance.instance_port_sqlserver_exposed_to_internet
  service: compute
  resource: instance
  requirement: Instance Port Sqlserver Exposed To Internet
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: SQL Server Port on OCI Instance Open to Internet
  rationale: Exposing SQL Server ports to the internet can lead to unauthorized access, data breaches, and service disruptions due to vulnerabilities exploitation. This exposure poses significant risks such as data theft and compliance violations with standards like PCI-DSS and ISO 27001, which mandate safeguarding sensitive data.
  description: This rule checks for OCI Compute instances with SQL Server ports (default 1433) accessible from the internet. Instances should have network security rules that restrict access to known IPs only. Remediation includes modifying security lists or network security groups to limit public ingress, ensuring compliance and reducing attack surfaces.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingsecuritylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_platform/
  - https://www.pcisecuritystandards.org/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.compute.instance.instance_port_ssh_exposed_to_internet
  service: compute
  resource: instance
  requirement: Instance Port Ssh Exposed To Internet
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: SSH Port Exposed to Internet on Compute Instance
  rationale: Exposing SSH ports to the internet on OCI compute instances increases the risk of unauthorized access, brute force attacks, and potential data breaches. This vulnerability can lead to compromised systems, resulting in financial loss, reputational damage, and non-compliance with regulations such as PCI-DSS and ISO 27001, which mandate strict access controls.
  description: This rule checks for compute instances with SSH ports (typically port 22) open to the internet, which can be identified through their security list configurations. To mitigate this risk, restrict SSH access to specific IP addresses using OCI's security lists or network security groups. Ensure proper use of key-based authentication over SSH and regularly review security configurations to align with best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_platform
  - https://www.pcisecuritystandards.org
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en/cloud/paas/security-cloud/compute-access-management.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.compute.instance.instance_port_telnet_exposed_to_internet
  service: compute
  resource: instance
  requirement: Instance Port Telnet Exposed To Internet
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Telnet Port Exposure on OCI Compute Instances
  rationale: Exposing Telnet ports to the internet on compute instances poses significant security risks, including unauthorized access and data breaches. Telnet transmits data in plain text, making it vulnerable to interception and man-in-the-middle attacks. This exposure can lead to non-compliance with industry regulations such as PCI-DSS and HIPAA, which require secure transmission of sensitive information.
  description: This rule checks for compute instances with Telnet ports (port 23) exposed to the internet, which is a critical security misconfiguration. Telnet should be replaced with more secure protocols such as SSH. Users should verify security lists and network security group configurations to ensure Telnet is not exposed. Remediation involves closing the Telnet port on any public firewall and using SSH for secure remote access instead.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingsecuritylists.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_approach.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-123.pdf
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/standard/54534.html
- rule_id: oci.compute.instance.instance_profile_attached
  service: compute
  resource: instance
  requirement: Instance Profile Attached
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure OCI Compute Instances Have Instance Profiles Attached
  rationale: Attaching an instance profile to OCI compute instances is crucial for defining security configurations and resource access policies. Without a profile, instances may lack necessary permissions, potentially leading to unauthorized access or data breaches. Compliance with security standards often mandates strict access controls, making this a critical security measure.
  description: This rule checks whether OCI compute instances have an instance profile attached, which is essential for managing access permissions and security configurations. An instance profile associates instances with IAM roles, defining what actions the instance can perform. To verify, review instance configurations in the console and ensure profiles are correctly attached. Remediation involves creating or assigning an appropriate instance profile with necessary permissions to each instance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingdynamicgroups.htm
  - CIS OCI Foundations Benchmark - Section 3.5
  - 'NIST SP 800-53 AC-3: Access Enforcement'
  - 'PCI DSS Requirement 7: Restrict access to cardholder data by business need to know'
  - https://www.oracle.com/security/cloud-security/shared-responsibility.html
- rule_id: oci.compute.instance.instance_public_ip
  service: compute
  resource: instance
  requirement: Instance Public Ip
  scope: compute.instance.public_access
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Restrict Public IP for OCI Compute Instances
  rationale: Allowing OCI compute instances to have public IP addresses exposes them to the internet, increasing the risk of unauthorized access, data breaches, and potential exploitation. This can lead to severe business impact including data loss, service disruptions, and non-compliance with regulations such as PCI-DSS and ISO 27001, which mandate controlled access to sensitive resources.
  description: This rule checks for OCI compute instances with publicly accessible IP addresses. To verify, inspect the networking section of each instance in the OCI console for any assigned public IP. Remediation involves removing or disabling the public IP and ensuring instances are accessed through secure private connections, such as via an Oracle Cloud Infrastructure VPN or FastConnect. Consider implementing a bastion host for secure access to instances if necessary.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingpublicIPs.htm
  - https://www.oracle.com/security/cis-benchmark.html
  - https://www.pcisecuritystandards.org/document_library
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/security/cloud-security-best-practices.html
- rule_id: oci.compute.instance.instance_pv_in_transit_encryption_enabled
  service: compute
  resource: instance
  requirement: Instance Pv In Transit Encryption Enabled
  scope: compute.instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Instance Pv In Transit Encryption is Enabled
  rationale: Encrypting data in transit for instance physical volumes (Pv) is crucial to protect sensitive information from interception and unauthorized access during data transfer between compute instances and storage. Failure to enable this encryption can lead to exposure of confidential data, potentially resulting in data breaches and non-compliance with data protection regulations such as PCI-DSS and HIPAA.
  description: This rule checks whether the Instance Pv In Transit Encryption is enabled for your OCI compute instances. To verify, ensure that the 'In Transit Encryption' feature is configured and active for block storage volumes attached to instances. To remediate, enable this setting via the OCI Console or API by navigating to the Block Volumes section, selecting the volume, and enabling in-transit encryption. This ensures that all data transferred between compute instances and storage is encrypted, safeguarding it from unauthorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/managingvolumes.htm#in_transit_encryption
  - CIS Oracle Cloud Infrastructure Foundations Benchmark
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.compute.instance.instance_secure_boot_enabled
  service: compute
  resource: instance
  requirement: Instance Secure Boot Enabled
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Secure Boot is Enabled for OCI Compute Instances
  rationale: Enabling Secure Boot on OCI compute instances is crucial to prevent unauthorized operating systems and software from loading during the boot process. This helps mitigate the risk of rootkits and low-level malware that can compromise system integrity and confidentiality. Secure Boot is vital for compliance with standards such as NIST SP 800-53 and ISO 27001, which require robust boot integrity mechanisms.
  description: This rule checks whether Secure Boot is enabled on Oracle Cloud Infrastructure (OCI) compute instances, ensuring that only signed and verified bootloaders and kernel modules are executed. To verify, check the instance configuration settings under the boot options section in the OCI console. Remediation involves enabling Secure Boot during the instance creation process or by modifying the instance's boot volume attributes, ensuring that the system firmware settings are configured to support Secure Boot.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/secure-boot.htm
  - https://www.cisecurity.org/benchmark/oracle/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/artifacts/cloud-security-guidance-v4-0/
- rule_id: oci.compute.instance.instance_serial_ports_in_use
  service: compute
  resource: instance
  requirement: Instance Serial Ports In Use
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Monitor Usage of Instance Serial Ports
  rationale: Monitoring serial ports on compute instances is crucial as they can be exploited to gain unauthorized access or exfiltrate sensitive data. Keeping track of serial port usage helps in identifying potential security threats and ensuring compliance with regulations that mandate strict access controls.
  description: This rule checks if any serial ports are active on compute instances. Serial ports can be used for debugging and system management, but if left unchecked, they might expose the instance to security risks. To verify, review the instance's console history for unexpected access. Remediation involves disabling unnecessary serial port access and implementing strict logging and access controls.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/References/serial-console.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://owasp.org/www-project-top-ten/
- rule_id: oci.compute.instance.launch_template_no_public_ip
  service: compute
  resource: instance
  requirement: Launch Template No Public Ip
  scope: compute.instance.public_access
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Ensure OCI Compute Instances Do Not Use Public IPs in Launch Templates
  rationale: Exposing compute instances to the public internet can lead to increased attack surfaces, making them vulnerable to unauthorized access and potential data breaches. By avoiding the assignment of public IPs, organizations can prevent external threats and comply with data protection regulations such as PCI-DSS and ISO 27001, which mandate strict control over network access.
  description: This rule checks if any OCI compute instance launch templates are configured to assign public IP addresses. Instances with public IPs are accessible from the internet, posing security risks. To verify, review the launch template settings in the OCI Console or via the CLI/API. Remediation involves updating the launch template to use a private IP only, ensuring access is controlled via VPNs or bastion hosts.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/publicipaddresses.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1_0.htm#1.1
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.compute.instance.loadbalancer_logging_enabled
  service: compute
  resource: instance
  requirement: Loadbalancer Logging Enabled
  scope: compute.instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Load Balancer Logging is Enabled for Compute Instances
  rationale: Enabling logging for load balancers associated with compute instances is critical for monitoring traffic patterns, detecting anomalies, and investigating security incidents. Without logging, organizations may be blind to unauthorized access attempts or data exfiltration activities, increasing the risk of security breaches and non-compliance with regulatory frameworks such as PCI-DSS and SOC2.
  description: This rule verifies that logging is enabled for Oracle Cloud Infrastructure load balancers associated with compute instances. To ensure compliance, administrators should configure load balancers to capture and store access logs. This can be done by navigating to the Load Balancer details page in the OCI Console and enabling the Access Logging feature under the Logging section. Regularly review logs to identify and respond to security threats. If logging is not enabled, follow the remediation steps to activate it and ensure logs are retained as per your organization's policy.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Tasks/managinglogs.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/cloud/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.compute.instance.network_dns_logging_enabled
  service: compute
  resource: instance
  requirement: Network Dns Logging Enabled
  scope: compute.instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable DNS Query Logging for Compute Instances
  rationale: Enabling DNS query logging on compute instances provides visibility into network traffic patterns and helps identify potential security threats such as data exfiltration or command and control communications. It is also crucial for compliance with regulatory frameworks that require audit logging and monitoring of network activities.
  description: This rule checks if DNS query logging is enabled for Oracle Cloud Infrastructure compute instances. DNS logging can be configured via the Logging service by setting up a log group and enabling DNS log sources. To verify, ensure that your compute instances are associated with a VCN that has DNS query logs enabled. Remediation involves configuring the OCI Logging service to capture DNS queries, creating a log group, and associating it with your VCN's DNS configuration.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Tasks/enablinglogsthroughdns.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/security/cloud-compliance/
- rule_id: oci.compute.instance.networkacl_allow_ingress_any_port
  service: compute
  resource: instance
  requirement: Networkacl Allow Ingress Any Port
  scope: compute.instance.network_security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: medium
  title: Restrict Network ACLs for Ingress Traffic on Any Port
  rationale: Allowing ingress on any port can expose your compute instances to unauthorized access and potential attacks. This unrestricted access increases the risk of data breaches, non-compliance with regulatory standards, and potential exploitation by malicious actors. Properly configured network access controls are essential for protecting sensitive workloads and ensuring compliance with industry standards such as PCI-DSS and NIST.
  description: This rule checks for network ACL configurations that allow ingress traffic from any IP address on any port to compute instances. It is critical to restrict ingress traffic to only necessary ports and trusted IP addresses to minimize the attack surface. To remediate, review and update your network ACL settings to specify only required ports and IPs. Use OCI's VCN Security Lists or Network Security Groups (NSGs) for fine-grained control over your network traffic.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networksecuritygroups.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_v1_1_0/oci_cis_v1_1_0.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.compute.networkacl.allow_ingress_tcp_port_22
  service: compute
  resource: networkacl
  requirement: Allow Ingress Tcp Port 22
  scope: compute.networkacl.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Secure Management of SSH Access via Network ACLs
  rationale: Allowing ingress on TCP port 22 is necessary for SSH access to compute instances, which is essential for administrative operations. However, unrestricted access may expose instances to unauthorized access and potential vulnerabilities. Properly managing this rule mitigates risks of unauthorized intrusions, aligning with security best practices and compliance requirements like PCI-DSS and ISO 27001.
  description: This rule checks if Network ACLs allow ingress traffic on TCP port 22 to compute instances. It is important to ensure that access is only granted to trusted IP addresses or IP ranges. To verify, review the network ACL configuration in the OCI console or using the CLI to ensure it restricts access appropriately. Remediation involves updating the ACL to limit SSH access to known IPs, thereby minimizing exposure to potential threats.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networkacl.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_oci_security_guide.htm
- rule_id: oci.compute.instance.networkacl_allow_ingress_tcp_port_22
  service: compute
  resource: instance
  requirement: Networkacl Allow Ingress Tcp Port 22
  scope: compute.instance.network_security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: medium
  title: Restrict Ingress on TCP Port 22 to Trusted IPs
  rationale: Allowing unrestricted access to TCP port 22 (SSH) increases the risk of unauthorized access, brute force attacks, and potential data breaches. Limiting access to known, trusted IP addresses helps mitigate these risks and aligns with compliance requirements such as PCI-DSS, which mandates secure access controls.
  description: This rule checks if ingress traffic on TCP port 22 is restricted to specific IP addresses in Oracle Cloud Infrastructure. SSH access should be limited to trusted IPs through Network ACLs to prevent unauthorized access. Verify Network ACL rules in your OCI console to ensure only designated IP addresses are allowed. To remediate, update your Network ACL to specify trusted sources, reducing exposure to potential threats.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networkacl.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/securitypolicies.htm
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.compute.instance.networkacl_allow_ingress_tcp_port_3389
  service: compute
  resource: instance
  requirement: Networkacl Allow Ingress Tcp Port 3389
  scope: compute.instance.network_security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: medium
  title: Restrict Ingress on TCP Port 3389 for OCI Instances
  rationale: Allowing unrestricted ingress traffic on TCP port 3389 can expose OCI instances to unauthorized access and potential exploitation through vulnerabilities in the Remote Desktop Protocol (RDP). This increases the risk of data breaches and system compromise, which can have significant financial and reputational impacts. Regulatory frameworks such as PCI-DSS and ISO 27001 require stringent access controls to protect sensitive data.
  description: This rule checks for the presence of network access control list (ACL) entries that allow ingress traffic on TCP port 3389 to OCI compute instances. Ensuring that such access is restricted to trusted IP addresses or VPNs mitigates the risk of unauthorized access. To verify compliance, review the network ACL settings in the OCI console and ensure that ingress rules for port 3389 are limited to specific IP ranges. Remediation involves modifying the ACLs to restrict access and implementing a bastion host for secure RDP connections.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securityrules.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_guide.htm
  - https://www.oracle.com/cloud/networking/
- rule_id: oci.compute.instance.os_management_compliance
  service: compute
  resource: instance
  requirement: OS Management Compliance
  scope: compute.instance.compliance
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Compute Instances Comply with OS Management Standards
  rationale: Maintaining OS management compliance on compute instances is crucial for minimizing vulnerabilities and potential security breaches. Non-compliance can lead to outdated software, increasing the risk of exploits and cyberattacks. Ensuring compliance supports business continuity, enhances resilience against threats, and aligns with regulatory and organizational security policies.
  description: This rule verifies that all compute instances in Oracle Cloud Infrastructure are configured to comply with OS management standards. It checks for the installation and proper configuration of the OS Management Service, which automates the process of patching and updating the operating system. To ensure compliance, enable the OS Management Service on each instance and regularly schedule updates. Non-compliant instances should be remediated by integrating them into the OS Management Service and applying any pending updates.
  references:
  - https://docs.oracle.com/en-us/iaas/os-management/osms-compute-overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/cis_oci_v1.1.0.htm#cis_oci_v1.1.0
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.compute.instance.patch_compliance
  service: compute
  resource: instance
  requirement: Patch Compliance
  scope: compute.instance.compliance
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: medium
  title: Ensure Compute Instance Patch Compliance
  rationale: Unpatched compute instances can lead to vulnerabilities that may be exploited by attackers, resulting in data breaches, service interruptions, and non-compliance with regulatory standards. Regular patching is crucial to maintain the security posture and operational integrity of cloud environments.
  description: This rule checks if all compute instances are compliant with the latest security patches. Instances should be regularly updated to mitigate known vulnerabilities. To verify compliance, ensure that the OCI instance management policies are configured to automate patching processes, and review patch history through the OCI console. Remediation involves scheduling regular patch updates using OCI's instance management service to minimize security risks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/patching.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/securityoverview.htm
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
- rule_id: oci.compute.instance.project_os_login_enabled
  service: compute
  resource: instance
  requirement: Project OS Login Enabled
  scope: compute.instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable OS Login for Enhanced Security on Compute Instances
  rationale: Enabling Project OS Login reduces the risk of unauthorized access by integrating with identity management systems, allowing centralized control over user access. This minimizes the threat of compromised SSH keys and helps meet compliance requirements for access management, such as those outlined by NIST and PCI-DSS.
  description: This rule checks if OS Login is enabled on Oracle Cloud Infrastructure (OCI) compute instances, which allows users to manage SSH access through IAM roles rather than static SSH keys. To verify, ensure that OS Login is configured in the instance's metadata and IAM roles are assigned correctly. Remediation involves updating the instance metadata to enable OS Login and configuring IAM policies to manage access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/launchinginstance.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://cloudsecurityalliance.org/research/artifacts/cloud-control-matrix-v4-0/
- rule_id: oci.compute.instance.public_address_shodan
  service: compute
  resource: instance
  requirement: Public Address Shodan
  scope: compute.instance.public_access
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Detect and Mitigate Instances with Public IPs Listed on Shodan
  rationale: Publicly accessible instances listed on Shodan indicate exposure to potential unauthorized access, increasing the risk of data breaches and cyber attacks. This exposure can lead to compliance violations with standards such as PCI-DSS and HIPAA, which mandate strict controls over publicly accessible systems. Organizations must proactively manage their cloud footprint to avoid reputational damage and financial penalties associated with security incidents.
  description: This rule checks for compute instances with public IP addresses reported on Shodan, a search engine for internet-connected devices. Instances with public IPs should be regularly monitored to ensure they are not listed on Shodan, indicating potential exposure. To verify, use the OCI console to review instance network settings and restrict public IP assignments. Remediate by removing unnecessary public IPs or configuring security lists and network security groups to limit inbound access to trusted sources only.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networksecuritygroups.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.0.0_controls.htm
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
  - https://www.shodan.io
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.compute.instance_pool.securitygroup
  service: compute
  resource: instance_pool
  requirement: Securitygroup
  scope: compute.instance_pool.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Instance Pools Use Appropriate Security Groups
  rationale: Properly configured security groups protect compute resources by controlling inbound and outbound traffic, minimizing exposure to unauthorized access and potential attacks. This is crucial for maintaining data confidentiality and integrity, and for compliance with security frameworks like NIST and PCI-DSS, which mandate strict access controls.
  description: This rule checks whether instance pools in OCI are associated with security groups that enforce least privilege access principles. Verify that security groups attached to instance pools allow only necessary traffic based on your application requirements. Remediation involves reviewing and updating security group rules to restrict traffic and ensure they are applied consistently across your instance pools. Use Oracle Cloud's Identity and Access Management (IAM) policies to manage and audit these configurations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitygroups.htm
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/usinginstancepools.htm
  - CIS Oracle Cloud Infrastructure Foundations Benchmark
  - https://www.nist.gov/document-800-53
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://cloudsecurityalliance.org/
- rule_id: oci.compute.instance.securitygroup_allow_ingress_from_internet_to_22
  service: compute
  resource: instance
  requirement: Securitygroup Allow Ingress From Internet To 22
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Ingress to Port 22 from the Internet
  rationale: Allowing unrestricted ingress traffic to port 22, which is commonly used for SSH, exposes instances to potential unauthorized access attempts and brute force attacks from the internet. This can lead to unauthorized data access, service disruptions, and potential compliance violations with security standards such as PCI-DSS and ISO 27001 that mandate secure access controls.
  description: This rule checks for OCI Security Lists or Network Security Groups (NSGs) that allow ingress traffic on port 22 from any IP address. It is recommended to restrict SSH access to known IP addresses or use a bastion host to manage SSH access securely. Verification can be done by reviewing the security list or NSG configurations in the OCI console. Remediation involves updating the rules to limit access to trusted IP addresses or leveraging OCI Bastion service for secure access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cloud-security-best-practices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Bastion/Concepts/bastionoverview.htm
- rule_id: oci.compute.instance.securitygroup_default_restrict_traffic
  service: compute
  resource: instance
  requirement: Securitygroup Default Restrict Traffic
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Default Traffic in Compute Instance Security Groups
  rationale: Unrestricted network traffic to and from compute instances can expose sensitive data and systems to unauthorized access and cyber threats, such as data breaches or denial-of-service attacks. Implementing restrictive default rules in security groups helps mitigate these risks by ensuring only necessary and authorized traffic is allowed, thus aligning with compliance frameworks like PCI-DSS and ISO 27001.
  description: This rule checks if the default security group for OCI compute instances restricts both inbound and outbound traffic by default. Security groups should be configured to deny all traffic that is not explicitly allowed, adhering to the principle of least privilege. Administrators should review and update security group rules to allow only necessary traffic for specific application needs and regularly audit these settings to ensure ongoing compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitygroups.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm#secbestpractices
- rule_id: oci.compute.instance.securitygroup_allow_ingress_from_internet_to_all_ports
  service: compute
  resource: instance
  requirement: Securitygroup Allow Ingress From Internet To All Ports
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Ingress Traffic to Compute Instances
  rationale: Allowing unrestricted ingress traffic from the internet to all ports on a compute instance exposes the instance to potential security threats such as unauthorized access, data breaches, and denial-of-service attacks. Restricting ingress traffic is crucial for protecting sensitive data, maintaining the integrity of compute resources, and complying with regulatory standards such as PCI-DSS and ISO 27001.
  description: This rule checks for security group configurations that allow ingress traffic from the internet to all ports on Oracle Cloud Infrastructure compute instances. It is essential to limit ingress rules to only necessary ports and trusted IP addresses to minimize exposure. Remediation involves reviewing and updating security group rules to restrict ingress traffic, using Network Security Groups (NSGs) or Virtual Cloud Network (VCN) security lists, and ensuring logging and monitoring are enabled for any inbound traffic.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitygroups.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1_0_0_compute.htm
  - https://www.nist.gov/document-2744
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix
- rule_id: oci.compute.instance.securitygroup_allow_ingress_from_internet_to_any_port
  service: compute
  resource: instance
  requirement: Securitygroup Allow Ingress From Internet To Any Port
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Ingress from Internet to Any Port on Compute Instances
  rationale: Allowing unrestricted ingress access from the internet to any port on a compute instance can expose the instance to unauthorized access and potential attacks such as DDoS or data breaches. This increases the risk of compromising sensitive data and can lead to non-compliance with security standards like PCI-DSS or HIPAA, which require controlled access to systems handling cardholder or patient data.
  description: This rule checks for security group configurations that allow unrestricted ingress traffic from the internet to any port on compute instances. It is crucial to limit access by defining specific IP ranges, ports, and protocols to mitigate risks. To verify, review the security group settings in the OCI console and ensure that only necessary ports and IP ranges are allowed. Remediation involves adjusting the security list or network security group rules to restrict ingress access to trusted IP addresses and necessary ports.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_approach.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.oracle.com/security/cloud-security
- rule_id: oci.compute.instance.securitygroup_allow_ingress_from_internet_to_ports
  service: compute
  resource: instance
  requirement: Securitygroup Allow Ingress From Internet To Ports
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Public Ingress to Specific Ports on Compute Instances
  rationale: Allowing unrestricted ingress from the internet to compute instances can expose them to unauthorized access, leading to potential data breaches and system compromise. It is crucial to limit access based on necessity to minimize the attack surface and comply with regulatory requirements like PCI-DSS and NIST SP 800-53, which emphasize the importance of controlled access to sensitive systems.
  description: This rule checks if compute instances have security group rules allowing ingress from the internet on non-restricted ports. Ensure that only necessary ports for application functionality are open and that access is limited to specific IP addresses. To verify, review the security group configurations in the OCI console and adjust rules to adhere to the principle of least privilege. Remediation involves updating security group rules to restrict inbound traffic to specific, trusted IP addresses and required ports.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://cloudsecurityalliance.org/research/artifacts/security-guidelines-for-critical-areas-of-focus-in-cloud-computing-v4-0/
- rule_id: oci.compute.instance.securitygroup_allow_ingress_from_internet_to_3389
  service: compute
  resource: instance
  requirement: Securitygroup Allow Ingress From Internet To 3389
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict RDP Access to OCI Instances from the Internet
  rationale: Allowing unrestricted RDP access over port 3389 from the Internet can expose OCI instances to potential unauthorized access and brute force attacks. This poses a risk of data breaches and non-compliance with security standards like PCI-DSS and HIPAA. Limiting access to known IP addresses or using a VPN mitigates these risks and ensures secure, controlled access.
  description: This rule checks if any security group associated with an OCI compute instance allows ingress traffic from the Internet on port 3389. Instances with such configurations are vulnerable to unauthorized access attempts. To secure your instances, modify the security group rules to restrict RDP access to trusted IP ranges or leverage Oracle Cloud's Bastion service. Verify by reviewing the VCN security list rules and updating them accordingly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securityrules.htm
  - https://docs.oracle.com/en-us/iaas/Content/security/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Bastion/Concepts/bastionoverview.htm
- rule_id: oci.compute.instance.securitygroup_allow_ingress_from_internet_to_8888
  service: compute
  resource: instance
  requirement: Securitygroup Allow Ingress From Internet To 8888
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Ingress to Port 8888 on OCI Compute Instances
  rationale: Allowing unrestricted internet access to port 8888 on compute instances can expose them to potential exploitation, unauthorized access, and data breaches. Port 8888 is commonly used for web applications and services, which may contain vulnerabilities if not properly secured. Limiting access to trusted IPs minimizes the attack surface, ensuring compliance with security policies and protecting sensitive data.
  description: This rule checks whether security lists or Network Security Groups (NSGs) associated with OCI compute instances allow unrestricted ingress traffic on port 8888 from the internet. If found, it recommends restricting access to trusted IP addresses or internal networks only. Verification involves reviewing security lists and NSG rules for any ingress entries permitting '0.0.0.0/0' on port 8888. Remediation includes modifying these rules to specify trusted CIDR blocks, thus preventing unauthorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Reference/securityrules.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengnetworksecurity.htm
  - https://www.oracle.com/security/cloud-compliance/
- rule_id: oci.compute.instance.securitygroup_allow_ingress_from_internet_to_5601
  service: compute
  resource: instance
  requirement: Securitygroup Allow Ingress From Internet To 5601
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Ingress Traffic to Port 5601 on Compute Instances
  rationale: Allowing ingress traffic from the internet to port 5601 on compute instances can expose internal services, such as Kibana, to potential unauthorized access and exploitation. This can lead to data breaches, integrity loss, and compliance violations with regulations like GDPR and PCI-DSS, which mandate stringent access controls to sensitive data. Securing this access helps mitigate the risk of unauthorized data exposure and potential attacks.
  description: This rule checks if security groups associated with compute instances allow unrestricted ingress traffic from the internet to port 5601, typically used by Kibana. To enhance security, restrict access to this port by allowing only trusted IP addresses or internal networks. Verify configuration through the OCI Console or CLI and update security group rules to comply with best practices. Consider implementing network security groups (NSGs) for more granular control.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/secure-kibana.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://cloudsecurityalliance.org/artifacts/oci-security-best-practices/
  - https://www.iso.org/standard/54534.html
- rule_id: oci.compute.instance.securitygroup_allow_ingress_from_internet_to_21
  service: compute
  resource: instance
  requirement: Securitygroup Allow Ingress From Internet To 21
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Ingress to Port 21 from the Internet for Instances
  rationale: Allowing unrestricted ingress on port 21 (FTP) from the internet exposes instances to potential unauthorized access and data breaches. This can lead to sensitive data exfiltration, compliance violations, and increased attack surface for brute force or exploit-based attacks. Ensuring controlled access is vital for maintaining data integrity and meeting regulatory standards such as PCI-DSS and ISO 27001.
  description: This rule checks for security groups associated with compute instances that allow ingress traffic from the internet to port 21. It identifies configurations where FTP access is not restricted to trusted IP addresses, which can pose security risks. To remediate, use the OCI Console to modify the security list or network security group associated with the instance and restrict access to known IP addresses or disable unnecessary FTP services. Verify changes by reviewing the security rules in the OCI Console and ensure compliance through regular audits.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_iam.htm
- rule_id: oci.compute.instance.securitygroup_allow_ingress_from_internet_to_9092
  service: compute
  resource: instance
  requirement: Securitygroup Allow Ingress From Internet To 9092
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Ingress to Port 9092 on OCI Instances
  rationale: Allowing unrestricted ingress traffic on port 9092 from the internet can expose your instances to potential security threats such as unauthorized access or data breaches. Port 9092 is commonly used for Apache Kafka, and exposing it publicly could lead to exploitation by attackers. This configuration may also conflict with compliance requirements such as PCI-DSS, which mandates strict controls on data flow and access.
  description: This rule checks for security groups that allow ingress traffic from the internet to port 9092 on OCI compute instances. To verify, inspect the security rules in the OCI console and ensure they do not permit unrestricted access to port 9092. Remediation involves updating the security list or network security group to limit access to specific IP addresses or ranges that require it, thereby reducing exposure to potential threats.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securityrules.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://kafka.apache.org/documentation/#security
- rule_id: oci.compute.instance.securitygroup_allow_ingress_from_internet_to_11211
  service: compute
  resource: instance
  requirement: Securitygroup Allow Ingress From Internet To 11211
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Ingress Traffic to Memcached Port 11211
  rationale: Allowing unrestricted ingress traffic to port 11211 can expose Memcached services to potential DDoS attacks or unauthorized access, leading to data leakage or service disruptions. Restricting access to trusted IPs minimizes the risk of exploitation and supports compliance with data protection standards like PCI-DSS and ISO 27001.
  description: This rule checks for security groups that allow ingress traffic from the internet to port 11211, commonly used by Memcached. To mitigate risks, configure security lists or network security groups to limit access to this port from trusted IP addresses only. Verify security group configurations in the OCI console and update rules to restrict public ingress, ensuring only specific IPs or CIDR blocks have access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networksecuritygroups.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations_benchmark_v2.0.0
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/security/
- rule_id: oci.compute.instance.securitygroup_allow_ingress_from_internet_to_27018
  service: compute
  resource: instance
  requirement: Securitygroup Allow Ingress From Internet To 27018
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Ingress Traffic to Port 27018 from the Internet
  rationale: Allowing unrestricted ingress traffic to port 27018 can expose MongoDB instances to unauthorized access, potentially leading to data breaches or denial of service attacks. Such exposure can compromise sensitive business data, violate data protection regulations, and result in financial and reputational damage. Ensuring controlled access aligns with compliance requirements such as PCI-DSS and ISO 27001.
  description: This rule checks if security groups associated with compute instances allow ingress traffic on port 27018 from the internet. Port 27018 is commonly used for MongoDB, and unsecured access can lead to vulnerabilities. To verify, review security group rules in the Oracle Cloud Infrastructure console and ensure only trusted IPs or internal networks can access this port. Remediation involves updating security group settings to restrict ingress traffic to known and secure sources.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.mongodb.com/manual/administration/security-checklist/
  - https://www.oracle.com/security/
- rule_id: oci.compute.instance.securitygroup_allow_ingress_from_internet_to_3306
  service: compute
  resource: instance
  requirement: Securitygroup Allow Ingress From Internet To 3306
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict MySQL Port 3306 Ingress from Internet
  rationale: Allowing unrestricted internet access to port 3306 on OCI compute instances exposes MySQL databases to potential unauthorized access and attacks, such as SQL injection or brute force attacks. This could lead to data breaches, financial loss, and non-compliance with data protection regulations such as PCI-DSS and GDPR, which mandate stringent access controls.
  description: This rule checks if any security group associated with an OCI compute instance allows ingress traffic from the internet to port 3306. Port 3306 is commonly used by MySQL databases, and unrestricted access could lead to security vulnerabilities. To mitigate risk, ensure that security groups restrict access to trusted IP addresses or use a bastion host. Verification involves reviewing security group rules in the OCI Console and modifying them to enforce least privilege access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingsecuritygroups.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_platform
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/cloud-security-compliance/
  - https://www.oracle.com/security/cloud-security/best-practices/
- rule_id: oci.compute.instance.securitygroup_allow_ingress_from_internet_to_2483
  service: compute
  resource: instance
  requirement: Securitygroup Allow Ingress From Internet To 2483
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Ingress Traffic to Oracle Database Listener Port 2483
  rationale: Allowing unrestricted ingress from the internet to port 2483, the default Oracle Database Listener port, can expose the database to unauthorized access and potential attacks such as brute force or SQL injection. This can lead to data breaches, compromising sensitive business data, and violating compliance standards such as PCI-DSS and HIPAA.
  description: This rule checks for security group configurations that allow ingress traffic from the internet to port 2483 on compute instances. To mitigate risks, restrict access to known IP addresses or internal networks only. Verify security group rules in the OCI console and ensure they are configured to block public access on port 2483. If necessary, use a bastion host for secure administration access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitygroups.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/securely-deploying-oracle-database.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.compute.instance.securitygroup_allow_ingress_from_internet_to_5432
  service: compute
  resource: instance
  requirement: Securitygroup Allow Ingress From Internet To 5432
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Ingress to Port 5432 on OCI Compute Instances
  rationale: Allowing unrestricted ingress from the internet to port 5432, commonly used by PostgreSQL, can expose databases to unauthorized access and potential data breaches. This misconfiguration can lead to exploitation by attackers, resulting in data exfiltration or compromise. Adhering to security best practices and compliance requirements like PCI-DSS and ISO 27001 mandates minimizing exposure of sensitive ports to the internet.
  description: This rule checks for security groups associated with OCI compute instances that allow ingress traffic from the internet to port 5432. To mitigate risks, restrict access to this port by configuring security lists or network security groups to allow access only from trusted IP addresses or internal networks. Verify configurations through the OCI Console or CLI by reviewing security group rules and adjusting them to limit exposure. Implement network segmentation and database firewalls as additional layers of defense.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.compute.instance.securitygroup_allow_ingress_from_internet_to_6379
  service: compute
  resource: instance
  requirement: Securitygroup Allow Ingress From Internet To 6379
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Ingress to Port 6379 from Internet
  rationale: Allowing unrestricted access to port 6379, typically used by Redis, exposes instances to potential unauthorized access and data exfiltration. This can lead to significant business risks including data breaches, service disruptions, and non-compliance with data protection regulations such as PCI-DSS and HIPAA.
  description: This rule checks if any security group associated with a compute instance allows ingress traffic from the internet on port 6379. Ideally, access to this port should be restricted to specific IP addresses or internal networks only. To remediate, update the security group rules to deny public access by default and allow only trusted IP addresses. Verify by reviewing the ingress rules in the OCI Console or using the OCI CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.hipaajournal.com/hipaa-compliance-checklist/
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
- rule_id: oci.compute.instance.securitygroup_allow_ingress_from_internet_to_1434
  service: compute
  resource: instance
  requirement: Securitygroup Allow Ingress From Internet To 1434
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Ingress Traffic on Port 1434 to Trusted Sources
  rationale: Allowing ingress traffic from the internet to port 1434 on OCI compute instances can expose your database services to potential threats such as unauthorized access, data exfiltration, or Denial of Service (DoS) attacks. This rule helps to minimize the attack surface by ensuring that only trusted sources can communicate with your database, thereby protecting sensitive data and maintaining compliance with security best practices and regulatory requirements like PCI-DSS and ISO 27001.
  description: This rule checks for security group configurations that allow inbound traffic from any IP address to port 1434, typically used by Microsoft SQL Server. To verify, review the security group's ingress rules associated with your OCI compute instances. Remediation involves restricting access by modifying the security group's rules to allow connections only from trusted IP addresses or VPN connections. This ensures that only authorized users can access the database services on this port.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practice.htm
- rule_id: oci.compute.instance.securitygroup_allow_ingress_from_internet_to_23
  service: compute
  resource: instance
  requirement: Securitygroup Allow Ingress From Internet To 23
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Ingress to Port 23 from Untrusted Networks
  rationale: Allowing ingress traffic to port 23 (Telnet) from the internet poses significant security risks, including unauthorized access and potential data breaches. Telnet transmits data in plaintext, making it susceptible to interception and eavesdropping. Organizations must restrict access to comply with security best practices and regulatory requirements, such as PCI-DSS and NIST, which discourage the use of insecure protocols.
  description: This rule checks for security group configurations that allow ingress traffic from any source to port 23 on compute instances. It is crucial to avoid using Telnet over the internet due to its lack of encryption. Instead, secure alternatives like SSH should be used. To remediate, update the security group rule to deny traffic to port 23 from all public IPs, ensuring that only trusted internal networks can access this port, if absolutely necessary.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securityrules.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://csrc.nist.gov/publications/detail/sp/800-123/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.compute.instance.securitygroup_allow_wide_open_public_ipv4
  service: compute
  resource: instance
  requirement: Securitygroup Allow Wide Open Public Ipv4
  scope: compute.instance.public_access
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Restrict Wide Open Public IPv4 in Compute Security Groups
  rationale: Allowing wide open public IPv4 access to compute instances can expose them to unauthorized access, leading to potential data breaches and service disruptions. This exposure increases the risk of attacks such as brute force, DDoS, and exploitation of unpatched vulnerabilities. Compliance with frameworks like PCI-DSS and NIST requires minimizing public exposure to protect sensitive data.
  description: This check identifies compute security groups with overly permissive inbound rules allowing public IPv4 access. Specifically, it looks for rules that permit traffic from 0.0.0.0/0 without stringent port restrictions. To remediate, review and tighten these rules by restricting the source IPs or implementing specific port-based access controls. Verify configurations using the OCI console or CLI, and ensure security groups are aligned with the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securityrules.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/cloud/security/best-practices/
- rule_id: oci.compute.instance.securitygroup_common_ports_restricted
  service: compute
  resource: instance
  requirement: Securitygroup Common Ports Restricted
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Common Ports in OCI Security Groups
  rationale: Restricting common ports in security groups is crucial to minimize exposure to unauthorized access and potential attacks. Unrestricted ports can be exploited by attackers to gain access to instances, leading to data breaches and service disruptions. Compliance with industry standards often mandates limiting access to only necessary ports to reduce attack surfaces.
  description: This rule checks that security groups associated with OCI compute instances do not have common ports like 22 (SSH), 80 (HTTP), and 3389 (RDP) open to the public. Ensure these ports are restricted to specific IP addresses or closed if not needed. Verification can be done by reviewing the security group rules in the OCI console. Remediation involves adjusting security group rules to limit port access to trusted IPs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingsecuritylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://www.oracle.com/security/cloud-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practice.htm
- rule_id: oci.compute.instance.securitygroup_ssh_restricted
  service: compute
  resource: instance
  requirement: Securitygroup Ssh Restricted
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict SSH Access in Security Groups for OCI Instances
  rationale: Restricting SSH access to OCI instances minimizes the risk of unauthorized access, reducing potential attack vectors. Unrestricted SSH access can lead to brute force attacks and unauthorized data exposure, compromising both business operations and sensitive information. Compliance with frameworks like PCI-DSS and ISO 27001 often requires limiting network access to critical systems.
  description: This rule checks if SSH access (port 22) in security lists or Network Security Groups (NSGs) associated with OCI compute instances is restricted to specific IP addresses or ranges. Unrestricted SSH access should be avoided in production environments. To verify, review the security lists and NSG rules to ensure SSH access is limited to known IPs. Remediation involves updating security lists or NSG rules to restrict SSH access to trusted IP addresses only, enhancing security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingsecuritylists.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securityrules.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.compute.instance.stopped_instance
  service: compute
  resource: instance
  requirement: Stopped Instance
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Monitor and Manage Stopped Compute Instances
  rationale: Stopped instances in OCI can lead to unexpected billing and security risks if not properly managed. They may retain resources like IP addresses, which could incur costs and potentially expose IPs to unauthorized access. Furthermore, stopped instances might indicate inefficiencies in resource utilization, impacting business operations and financial forecasting.
  description: This rule checks for compute instances that are in a stopped state but still attached to resources such as block volumes or reserved public IPs. It is crucial to regularly audit stopped instances to ensure they are either started or properly terminated. To verify, access the Compute Instance page in the OCI console, inspect instance states, and release any unnecessary resources. Remediation involves detaching or terminating unneeded resources and releasing associated IP addresses to minimize costs and security exposures.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/managinginstances.htm
  - https://www.oracle.com/cloud/cloud-security/cis-oci-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.compute.instance.subnet_flow_logs_enabled
  service: compute
  resource: instance
  requirement: Subnet Flow Logs Enabled
  scope: compute.instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Subnet Flow Logs are Enabled for Compute Instances
  rationale: Enabling subnet flow logs is crucial for tracking network traffic and identifying anomalous activities, which can help prevent unauthorized access and data exfiltration. This practice supports incident response and forensic investigations by providing detailed insights into network traffic patterns. It also aligns with compliance requirements for data protection and monitoring under frameworks like NIST and PCI-DSS.
  description: This rule checks whether flow logs are enabled on the subnets associated with OCI Compute instances. Subnet flow logs capture information about traffic going to and from network interfaces in a subnet, which is essential for monitoring and troubleshooting. To verify, navigate to the OCI Console, access the Networking service, and check if flow logging is configured for the relevant subnet. Remediation involves enabling the logging feature in the subnet's configuration settings through the console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingflowlogs.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.compute.instance.transitgateway_auto_accept_vcn_attachments
  service: compute
  resource: instance
  requirement: Transitgateway Auto Accept Vcn Attachments
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Enforce Manual Approval for VCN Attachments on Transit Gateways
  rationale: Auto-accepting VCN attachments to Transit Gateways can expose your environment to unverified networks, increasing the risk of unauthorized access and data breaches. Manual approval ensures that each attachment is validated against security policies and compliance requirements, safeguarding sensitive data and maintaining network integrity. This control is crucial in environments that must adhere to strict regulatory standards such as PCI-DSS and ISO 27001.
  description: This rule checks if the OCI Transit Gateway is configured to automatically accept VCN attachments. Auto-acceptance can lead to potential security risks by allowing unverified networks to connect. To verify, review the Transit Gateway settings and ensure that 'Auto Accept VCN Attachments' is disabled. Remediation involves configuring the Transit Gateway to require manual approval for each VCN attachment, enhancing control over network connections.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/transitgateway.htm
  - https://www.oracle.com/security/cis-oci-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.compute.instance.volume_encrypted
  service: compute
  resource: instance
  requirement: Volume Encrypted
  scope: compute.instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Compute Instance Volumes are Encrypted at Rest
  rationale: Encrypting volumes at rest is vital to protect sensitive data from unauthorized access and potential data breaches. Unencrypted volumes pose a significant security risk in scenarios like data theft or loss, where attackers could easily gain access to confidential information. Compliance with standards such as PCI-DSS and ISO 27001 often mandates encryption to safeguard privacy and ensure data integrity.
  description: This rule checks if all volumes attached to OCI compute instances are encrypted using Oracle-managed keys. Verification involves examining the 'Encryption' setting of each volume to confirm it is marked as 'enabled.' To remediate, ensure that new volumes are created with encryption enabled by default, and existing unencrypted volumes are re-encrypted by creating new encrypted volumes and migrating data accordingly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/blockvolumebackups.htm#blockvolumes_encryption
  - https://www.oracle.com/security/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-111.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
- rule_id: oci.compute.instance.volume_encryption_enabled
  service: compute
  resource: instance
  requirement: Volume Encryption Enabled
  scope: compute.instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Volume Encryption is Enabled for Compute Instances
  rationale: Enabling volume encryption for compute instances is crucial for safeguarding sensitive data against unauthorized access, data breaches, and potential data theft. It is a key requirement for compliance with data protection regulations such as PCI-DSS and HIPAA, which mandate encryption of data at rest. Failure to encrypt data can result in severe financial penalties, reputational damage, and legal liabilities.
  description: This rule verifies that all block volumes attached to compute instances are encrypted using Oracle Cloud Infrastructure (OCI) Key Management. Encryption should be enabled by default when creating block volumes and can be verified in the OCI console under the 'Block Volume' settings. To remediate, ensure all existing and new volumes use customer-managed keys (CMKs) or Oracle-managed keys for encryption. This can be configured in the OCI console by navigating to the 'Block Volumes' section and checking the 'Encryption' details.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/References/overview.htm#Encryption
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_platform
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hipaajournal.com/hipaa-encryption-requirements/
  - https://www.oracle.com/cloud/security/
  - https://www.iso.org/standard/54534.html
- rule_id: oci.compute.instance.volume_in_use
  service: compute
  resource: instance
  requirement: Volume In Use
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Attached Volumes are Properly Utilized
  rationale: Ensuring that all volumes attached to instances are actively in use helps mitigate unnecessary costs and reduces security risks associated with unutilized resources. Unused volumes can become a target for unauthorized access or data breaches due to oversight in access controls. Additionally, maintaining efficient resource usage aligns with compliance requirements for cost management and data security standards.
  description: This rule checks whether any block storage volumes attached to an OCI compute instance are actively being utilized. Instances with volumes that are not in use may lead to unnecessary expenditure and potential data exposure. To verify, review the volume attachment status in the OCI Console under the compute instance details. Remediation involves detaching unused volumes or ensuring they are securely configured if retention is necessary.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_features.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
- rule_id: oci.compute.instance.volume_public_snapshot
  service: compute
  resource: instance
  requirement: Volume Public Snapshot
  scope: compute.instance.backup_recovery
  domain: resilience_and_disaster_recovery
  subcategory: backup_configuration
  severity: critical
  title: Ensure Compute Instance Volume Snapshots Are Not Public
  rationale: Public snapshots of volumes can expose sensitive data, leading to data breaches and unauthorized access. This can have serious business impacts, such as non-compliance with regulations like GDPR and PCI-DSS, and potential financial losses due to data theft. Limiting snapshot access reduces the risk of exposing critical business information to threat actors.
  description: This rule checks if any volume snapshots associated with compute instances are publicly accessible, which is not recommended. Snapshots should be restricted to specific users or groups to maintain data security. To verify, inspect the snapshot settings in the OCI console or via CLI to ensure the 'public' option is not enabled. Remediation involves modifying the snapshot settings to limit access to trusted entities only.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/managingvolumes.htm#snapshots
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/pci_security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.compute.instance.volume_snapshots_configured
  service: compute
  resource: instance
  requirement: Volume Snapshots Configured
  scope: compute.instance.backup_recovery
  domain: resilience_and_disaster_recovery
  subcategory: backup_configuration
  severity: low
  title: Ensure Volume Snapshots Configured for OCI Compute Instances
  rationale: Configuring volume snapshots for OCI compute instances is critical for ensuring data integrity and availability in case of accidental deletion, hardware failure, or security incidents. Regular snapshots enable quick recovery and continuity of operations, minimizing downtime and data loss, which is essential for meeting business continuity and compliance requirements.
  description: This rule checks that OCI compute instances have volume snapshots configured at regular intervals. Snapshots should be automated and stored in a secure, redundant manner to prevent data loss. Verification involves reviewing the instance backup policy settings in the OCI Console, ensuring that all critical volumes are included, and that snapshot schedules align with organizational recovery objectives. Remediation involves configuring or modifying backup policies to include regular volume snapshots for all necessary compute instances.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/schedulingvolumesnapshots.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.oracle.com/security-cloud-compliance
  - https://cloud.oracle.com/iaas/whitepapers/best-practices-for-security-and-resilience.pdf
- rule_id: oci.cloud_guard.target.recorder_all_regions_enabled
  service: cloud_guard
  resource: target
  requirement: Recorder All Regions Enabled
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Cloud Guard Recorder is Enabled Across All Regions
  rationale: Enabling the Cloud Guard recorder across all regions is critical to ensuring comprehensive security monitoring and threat detection across your entire OCI footprint. Failing to do so can result in blind spots where malicious activities could go unnoticed, increasing the risk of data breaches and non-compliance with regulatory standards such as NIST, PCI-DSS, and ISO 27001.
  description: This rule checks if the Cloud Guard recorder is active in every OCI region where your tenancy operates. To verify, ensure that the Cloud Guard service is configured to monitor all regions through the OCI Console by navigating to the Cloud Guard settings and confirming that the 'Enable Recorder' option is selected for each region. If any region is missing, enable it to ensure consistent security posture monitoring. This action ensures that potential threats are detected and responded to promptly across all geographic locations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/using/overview.htm
  - https://cloudsecurityalliance.org/star/registry/oracle/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://oracle.com/cloud/security/
- rule_id: oci.container_engine.cluster.engine_kubernetes_rotate_server_certificates
  service: container_engine
  resource: cluster
  requirement: Engine Kubernetes Rotate Server Certificates
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Rotate Kubernetes Cluster Server Certificates Regularly
  rationale: Regular rotation of server certificates is critical to maintaining the security of Kubernetes clusters by preventing unauthorized access through expired or compromised certificates. It ensures compliance with security best practices and reduces the risk of man-in-the-middle attacks, thereby protecting sensitive data and business processes hosted in the cloud. This practice also aligns with regulatory requirements for data protection and integrity.
  description: This rule checks whether the server certificates for Kubernetes clusters in OCI are rotated regularly. Properly rotating certificates involves configuring the cluster to periodically replace the existing certificates with new ones, thus mitigating the risks associated with certificate expiration or compromise. To verify, ensure that the Kubernetes Engine API is configured to rotate server certificates and review the rotation schedule. Remediation involves setting up automated certificate renewal processes using OCI's Container Engine for Kubernetes (OKE) features.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengrotatingcertificates.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.oracle.com/security/certifications/
  - https://kubernetes.io/docs/tasks/tls/certificate-rotation/
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v4/
- rule_id: oci.container_engine.node_pool.instances_managed_updates_enabled
  service: container_engine
  resource: node_pool
  requirement: Instances Managed Updates Enabled
  scope: container_engine.node_pool.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Enable Managed Updates for Node Pool Instances
  rationale: Enabling managed updates for node pool instances ensures that Kubernetes nodes receive timely security patches and updates, reducing vulnerabilities that could be exploited by attackers. This proactive approach minimizes downtime and enhances the overall security posture of the container environment, aligning with compliance requirements for secure infrastructure management.
  description: This rule checks if the managed updates feature is enabled for instances in a node pool within Oracle Cloud Infrastructure's Container Engine for Kubernetes. Managed updates automatically apply critical security patches, ensuring nodes are up-to-date without manual intervention. To verify, navigate to the OCI Console, select the Container Engine service, and inspect the node pool settings to confirm managed updates are enabled. Remediation involves enabling managed updates for the node pool, which can be configured via the OCI Console or using OCI CLI commands.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengmodifyinganodepool.htm
  - https://oracle.github.io/oci-cis-landing-zone-quickstart/#/environments/cis-oci-benchmarks
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-compliance/
- rule_id: oci.artifacts.container_repository.public_access_blocked
  service: artifacts
  resource: container_repository
  requirement: Public Access Blocked
  scope: artifacts.container_repository.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure OCI Container Repositories Block Public Access
  rationale: Blocking public access to container repositories in Oracle Cloud Infrastructure is crucial for preventing unauthorized access and potential data breaches. Publicly accessible repositories can expose sensitive application components, leading to malicious use or exploitation. Ensuring repositories are private aligns with compliance standards such as NIST SP 800-53 and ISO 27001, reducing risk and safeguarding intellectual property.
  description: This rule verifies that Oracle Cloud Infrastructure container repositories are not publicly accessible. It checks repository settings to ensure they require authentication for access, preventing unintended exposure of container images. To remediate, configure repository policies to restrict access to specific users or services within your tenancy. Utilize OCI Identity and Access Management (IAM) policies to enforce these restrictions and regularly review access configurations to maintain security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Registry/Tasks/registrycreatingrepo.htm#access
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/cloud-infrastructure/
  - https://www.pcisecuritystandards.org/
- rule_id: oci.artifacts.container_repository.uses_private_link
  service: artifacts
  resource: container_repository
  requirement: Uses Private Link
  scope: artifacts.container_repository.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Container Repositories Use Private Link
  rationale: Using Private Link for container repositories minimizes exposure to the public internet, reducing the risk of data breaches and unauthorized access. This approach enhances data privacy and meets compliance requirements by ensuring that data traffic remains within the Oracle Cloud network, aligning with best practices for network security and regulatory standards.
  description: This rule checks if the container repositories in Oracle Cloud Infrastructure are configured to use Private Link. Private Link allows secure, private access to OCI services over the internal Oracle network without exposing traffic to the public internet. To verify, ensure that the container repository is associated with a VCN and that appropriate private endpoints are configured. Remediation involves setting up a Private Link service in OCI and associating it with your container repository.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengusingprivatelink.htm
  - https://www.oracle.com/security-cloud/cloud-security-controls/
  - 'NIST SP 800-53 Rev. 5 - AC-4: Information Flow Enforcement'
  - 'PCI-DSS v3.2.1 - Requirement 1: Install and maintain a firewall configuration to protect cardholder data'
  - 'ISO/IEC 27001:2013 - A.13.1: Network security management'
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.compute.instance.security_list_ingress_ssh_access_restricted
  service: compute
  resource: instance
  requirement: Security List Ingress Ssh Access Restricted
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict SSH Access in Security Lists for Compute Instances
  rationale: Restricting SSH access to only trusted IP addresses or networks reduces the risk of unauthorized access to compute instances, which can lead to data breaches, service disruptions, and compliance violations. Ensuring proper access control aligns with security best practices and compliance requirements, protecting sensitive data and workloads.
  description: This rule checks that all compute instances have their SSH access (port 22) restricted in the associated security lists. It verifies that ingress rules do not allow open access to the internet (0.0.0.0/0) but instead permit access only from specific IP addresses. To remediate, modify the security list to restrict SSH access to known and trusted IP addresses or ranges, and regularly review these rules to ensure ongoing compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_benchmark.htm
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practice.htm
- rule_id: oci.compute.instance.subnet_vcn_flow_logging_enabled_and_properly_configured
  service: compute
  resource: instance
  requirement: Subnet Vcn Flow Logging Enabled And Properly Configured
  scope: compute.instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable and Configure VCN Flow Logs for Compute Instances
  rationale: Enabling VCN Flow Logs for subnets provides critical visibility into network traffic to and from compute instances, essential for detecting unusual activity, troubleshooting network issues, and meeting regulatory requirements. Without proper logging, organizations risk undetected data breaches, compliance violations, and operational inefficiencies.
  description: This check ensures that the VCN Flow Logs are enabled and correctly configured for subnets containing compute instances. It verifies the creation of a log group and log objects, correct IAM policies for log access, and that logs capture all necessary traffic data. To remediate, ensure all subnets have flow logs enabled in the OCI Console, define appropriate retention periods, and apply necessary IAM policies for access control.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/flowlogs.htm
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.cisecurity.org/benchmark/oracle_cloud/
- rule_id: oci.compute.instance.vcn_default_security_list_enabled
  service: compute
  resource: instance
  requirement: Vcn Default Security List Enabled
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Use of VCN Default Security List for Compute Instances
  rationale: Default security lists may contain overly permissive rules that expose compute instances to unnecessary risks. Unauthorized access could lead to data breaches, compliance violations, or service disruption. Ensuring that instances are not relying on default security lists helps maintain a robust security posture aligned with organizational policies and industry standards.
  description: This check verifies whether the default security list of a Virtual Cloud Network (VCN) is attached to any compute instances. Default security lists often have broad rules that may not meet the specific security requirements of your workloads. To enhance security, create custom security lists or Network Security Groups (NSGs) tailored to the instance's needs. To remediate, review current security list associations and update instance configurations to use custom lists that enforce least privilege access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingVCNs.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/document_library
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.database.autonomous_database.account_use_private_endpoints
  service: database
  resource: autonomous_database
  requirement: Account Use Private Endpoints
  scope: database.autonomous_database.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Use Private Endpoints for Autonomous Databases
  rationale: Using private endpoints for Autonomous Databases minimizes exposure to the public internet, significantly reducing the risk of unauthorized access and data breaches. This practice aligns with security best practices by ensuring sensitive data is only accessible within a secure, controlled environment, thereby supporting compliance with data protection regulations such as GDPR and HIPAA.
  description: This rule checks whether OCI Autonomous Databases are configured to use private endpoints. Private endpoints enable access to the database over a private IP address within a VCN, ensuring that traffic never traverses the public internet. To verify, ensure that the Autonomous Database is assigned a private endpoint by reviewing its network configuration in the OCI Console. Remediation involves configuring a private endpoint within the Autonomous Database settings to ensure secure, private connectivity.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-foundations-benchmark.htm
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingVCNs.htm
  - https://www.oracle.com/security/cloud-security/database-security/
- rule_id: oci.data_catalog.catalog.instance_encryption_enabled
  service: data_catalog
  resource: catalog
  requirement: Instance Encryption Enabled
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Data Catalog Encryption at Rest is Enabled
  rationale: Enabling encryption for Data Catalog instances protects sensitive metadata and associated data from unauthorized access and potential breaches. This is crucial to safeguard intellectual property, maintain customer trust, and comply with data protection regulations such as GDPR and CCPA. Failure to encrypt data at rest can lead to financial losses, reputational damage, and legal penalties.
  description: This rule checks whether encryption at rest is enabled for Oracle Cloud Infrastructure (OCI) Data Catalog instances. To verify, ensure that the Data Catalog instance configuration specifies the use of Oracle-managed keys for encryption. Remediation involves configuring the Data Catalog instance to use encryption by default via the OCI Console or CLI. Ensure that the necessary permissions are in place for Key Management Service (KMS) integration if using customer-managed keys.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Tasks/encryptingyourdatacatalog.htm
  - https://www.oracle.com/security/cis-benchmark/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.database.autonomous_database.aurora_backup_enabled
  service: database
  resource: autonomous_database
  requirement: Aurora Backup Enabled
  scope: database.autonomous_database.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: medium
  title: Enable Backups for Autonomous Database to Ensure Data Resilience
  rationale: Enabling backups for Autonomous Databases is crucial for data resilience and recovery in case of accidental deletion, corruption, or cyber-attacks. It helps organizations meet compliance requirements such as PCI-DSS and ISO 27001, which mandate regular data backups to mitigate data loss risks. Failure to enable backups can lead to significant business disruptions and financial losses due to data unavailability.
  description: This rule checks whether backups are enabled for Autonomous Databases in OCI. The setting ensures that the database can be restored to a previous state in case of a failure. To verify, navigate to the 'Autonomous Database' console, select the database, and check the 'Backup' configuration for scheduled backups. Remediation involves enabling automated backups through the console or CLI. Regularly review backup schedules and retention settings to align with organizational recovery objectives.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbconfiguringbackups.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.database.autonomous_database.auto_minor_version_upgrade
  service: database
  resource: autonomous_database
  requirement: Auto Minor Version Upgrade
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable Auto Minor Version Upgrade for Autonomous Databases
  rationale: Automatically applying minor version upgrades ensures that Autonomous Databases remain up-to-date with the latest security patches and feature enhancements, reducing vulnerability to known exploits and ensuring compliance with data protection regulations. Failing to do so can expose sensitive data to unauthorized access and compromise the integrity of business operations.
  description: This rule checks whether the 'Auto Minor Version Upgrade' feature is enabled for Autonomous Databases in OCI. This feature automatically applies minor version upgrades during the maintenance window, ensuring databases are protected with the latest security patches. To verify, navigate to the OCI Console, select the Autonomous Database, and check the 'Auto Minor Version Upgrade' setting. If disabled, enable it to ensure ongoing security compliance and operational integrity.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/autonomousmaintenance.htm
  - https://www.oracle.com/security/cloud-security/database-security.html
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/itl/applied-cybersecurity/nist-cybersecurity-framework
- rule_id: oci.database.autonomous_database.backup_enabled
  service: database
  resource: autonomous_database
  requirement: Backup Enabled
  scope: database.autonomous_database.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: medium
  title: Ensure Autonomous Database Backups Are Enabled
  rationale: Enabling backups for Autonomous Databases in OCI is crucial for data protection and business continuity. Without regular backups, organizations risk data loss due to accidental deletion, corruption, or ransomware attacks. This practice supports compliance with data protection regulations such as GDPR and ensures alignment with industry standards that emphasize data availability and integrity.
  description: This rule verifies that Autonomous Databases within OCI have automated backups enabled. Backups are essential for disaster recovery, allowing for data restoration to a specific point in time. To ensure compliance, navigate to the OCI Console, select the Autonomous Database, and confirm that the 'Automatic Backups' option is activated. If not configured, enable it by accessing the database's backup settings and selecting the appropriate retention period. This ensures data recoverability and minimizes downtime in case of data loss.
  references:
  - https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/backup-recovery.html
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/cloud/security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.autonomous_database.backup_retention_period
  service: database
  resource: autonomous_database
  requirement: Backup Retention Period
  scope: database.autonomous_database.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: medium
  title: Ensure Adequate Backup Retention for Autonomous Databases
  rationale: Proper backup retention is crucial for business continuity, data recovery, and compliance with industry regulations. Insufficient backup retention periods could lead to data loss in case of incidents or cyber attacks, impacting business operations and potentially violating data protection laws like GDPR or PCI-DSS.
  description: This rule checks if the backup retention period for Autonomous Databases is set according to best practices and compliance requirements. Ideally, backups should be retained for at least 7 to 30 days depending on business needs and regulatory obligations. To verify, navigate to the OCI Console, select your Autonomous Database, and review the backup settings under 'Backup and Recovery'. Adjust retention settings by modifying the policy to ensure adequate data recovery capabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/backingupADB.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security.html
- rule_id: oci.database.cluster.default_admin
  service: database
  resource: cluster
  requirement: Default Admin
  scope: database.cluster.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: critical
  title: Ensure Default Admin Account is Secured in DB Cluster
  rationale: The default admin account in an Oracle Cloud Infrastructure database cluster poses a significant security risk if not properly secured. Uncontrolled access can lead to unauthorized data exposure, modification, or deletion, impacting business operations and data integrity. Compliance with standards like PCI-DSS and NIST requires robust access controls to safeguard sensitive information.
  description: This rule checks that the default admin account in OCI database clusters is secured by enforcing strong authentication mechanisms and limiting access. Verify that MFA is enabled and unnecessary access permissions are removed. Remediate by configuring IAM policies to restrict admin access and ensure password complexity requirements are met. Consider rotating admin credentials regularly and monitoring login activities for suspicious behavior.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/managingDBsystem.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.database.autonomous_database.dynamodb_table_encryption_enabled
  service: database
  resource: autonomous_database
  requirement: Dynamodb Table Encryption Enabled
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Encryption for DynamoDB Tables in Autonomous Databases
  rationale: Enabling encryption for DynamoDB tables ensures that sensitive data is protected at rest, mitigating the risk of unauthorized data access and exposure. This is crucial for maintaining customer trust and adhering to regulatory requirements such as GDPR, HIPAA, and PCI-DSS, which mandate strong data protection measures. Failure to encrypt data at rest can lead to significant financial penalties and damage to reputation in the event of a data breach.
  description: This rule checks whether DynamoDB tables associated with Oracle Autonomous Databases have encryption enabled using Oracle-managed keys. It is important to configure the encryption settings correctly to ensure that data is protected at rest. To verify, check the encryption status of each DynamoDB table in the OCI Console under the Autonomous Database settings. If encryption is not enabled, enable it via the console or CLI by selecting Oracle-managed keys for the encryption option. This ensures that all data stored in the tables is encrypted, leveraging OCI's robust security infrastructure.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm#encryption
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-4/final
  - https://www.pcisecuritystandards.org/document_library
  - https://www.iso.org/standard/54534.html
- rule_id: oci.database.autonomous_database.instance_backup_enabled
  service: database
  resource: autonomous_database
  requirement: Instance Backup Enabled
  scope: database.autonomous_database.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: medium
  title: Ensure Autonomous Database Backup is Enabled
  rationale: Enabling backups for Oracle Autonomous Databases is critical to protect against data loss due to accidental deletion, corruption, or cyber-attacks. Without regular backups, recovery from such events could lead to significant downtime and data loss, affecting business continuity and potentially leading to financial and reputational damage. Additionally, many compliance frameworks require regular data backups to ensure data integrity and availability.
  description: This rule checks whether automatic backups are enabled for Oracle Autonomous Databases. Backups should be configured to run daily and stored in a separate, secure location to ensure data availability in case of an incident. Verification can be done via the OCI Console by navigating to the Autonomous Database details page and ensuring that the 'Automatic Backup' option is enabled. To remediate, enable automatic backups and ensure they are running as per the required frequency.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbusing.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.autonomous_database.instance_copy_tags_to_snapshots
  service: database
  resource: autonomous_database
  requirement: Instance Copy Tags To Snapshots
  scope: database.autonomous_database.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure Tags are Copied to Autonomous Database Snapshots
  rationale: Copying tags from Autonomous Databases to their snapshots helps maintain consistent metadata, aiding in resource management, cost tracking, and compliance with organizational policies. Failure to consistently apply tags could result in mismanaged resources, increased costs, and challenges in audit and compliance reporting.
  description: This rule checks if tags from Autonomous Database instances are copied to their snapshots. Proper tagging enables effective resource identification and management. To verify, ensure the 'Copy Tags to Snapshots' setting is enabled in the OCI console under Autonomous Database settings. Remediation involves enabling this setting to ensure that all metadata tags are consistently propagated to snapshots.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbsnapshots.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmark/
  - https://www.oracle.com/cloud/cloud-security/iso-27001/
  - https://www.oracle.com/cloud/cloud-security/compliance/
  - https://www.oracle.com/cloud/cloud-security/best-practices/
- rule_id: oci.database.autonomous_database.instance_deletion_protection
  service: database
  resource: autonomous_database
  requirement: Instance Deletion Protection
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable Deletion Protection for Autonomous Databases
  rationale: Enabling deletion protection for Oracle Autonomous Databases helps prevent accidental or malicious deletion, which can lead to significant data loss and operational disruption. This is crucial for maintaining business continuity and aligning with data protection regulations such as GDPR and HIPAA, which require safeguarding personal and sensitive data. It also minimizes the risk of non-compliance and potential legal ramifications.
  description: This rule checks if deletion protection is enabled for Oracle Autonomous Databases in your OCI tenancy. To verify, navigate to the Autonomous Database details page in the OCI Console and ensure that the deletion protection setting is active. If not enabled, you can activate it by selecting the 'Enable Deletion Protection' option. This setting is essential to protect your databases from unintended deletions, ensuring data integrity and availability.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/managingADBare.htm#deletion_protection
  - https://www.oracle.com/security/cloud-security/global-compliance/
  - 'NIST SP 800-53 Rev. 5: AC-4, SC-28'
  - CIS OCI Foundations Benchmark v1.1.0, section 5.4
  - https://cloud.oracle.com/en_US/data-security
- rule_id: oci.database.autonomous_database.instance_enhanced_monitoring_enabled
  service: database
  resource: autonomous_database
  requirement: Instance Enhanced Monitoring Enabled
  scope: database.autonomous_database.monitoring
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Enhanced Monitoring for Autonomous Databases
  rationale: Enhanced monitoring provides deeper insights into the performance and operational health of Autonomous Databases, facilitating proactive incident management and optimized resource usage. Without enhanced monitoring, organizations risk missing critical anomalies that could lead to downtime or data breaches, impacting business continuity and compliance with regulations like PCI-DSS and SOC2.
  description: This rule checks if Enhanced Monitoring is enabled for Autonomous Databases in OCI, which provides detailed metrics and logs for better visibility and auditing capabilities. To verify, navigate to the database instance settings and ensure that the 'Enhanced Monitoring' option is selected. Remediation involves accessing the OCI Console, selecting the database, and enabling Enhanced Monitoring under the 'Monitoring' section. This configuration enhances the ability to track database performance and security events, ensuring timely responses to potential threats.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbmonitoring.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/document/nistsp800-53r5pdf
  - https://docs.oracle.com/en/cloud/paas/monitoring-cloud/monitoring/index.html
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v3-0-1/
- rule_id: oci.database.autonomous_database.instance_integration_cloudwatch_logs
  service: database
  resource: autonomous_database
  requirement: Instance Integration Cloudwatch Logs
  scope: database.autonomous_database.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Cloudwatch Logs for Autonomous Database Instances
  rationale: Integrating Oracle Cloud Infrastructure (OCI) Autonomous Database with Cloudwatch logs is crucial for maintaining visibility into database activity. This integration aids in detecting unauthorized access and potential data breaches, supporting compliance with data protection regulations such as PCI-DSS, NIST, and ISO 27001. Additionally, it assists in proactive monitoring and troubleshooting, reducing the time to respond to incidents.
  description: This rule checks if OCI Autonomous Database instances have logging enabled to integrate with Cloudwatch Logs. This configuration ensures that all database activity logs are captured and stored for auditing and monitoring purposes. To verify, navigate to the Autonomous Database service in OCI Console, ensure the 'Enable Cloudwatch Logs' option is selected, and logs are being sent to a specified log group. Remediation involves configuring the database logging settings to ensure all relevant logs are captured and properly routed to Cloudwatch.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/autonomousmonitoring.htm
  - https://www.oracle.com/security/cis-oci-benchmark/
  - https://www.pcisecuritystandards.org/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.autonomous_database.instance_integration_monitoring_logs
  service: database
  resource: autonomous_database
  requirement: Instance Integration Monitoring Logs
  scope: database.autonomous_database.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Monitoring Logs for Autonomous Database Instances
  rationale: Monitoring logs for Autonomous Database instances are crucial for identifying anomalous activities, detecting potential security breaches, and ensuring compliance with regulatory requirements like PCI-DSS and HIPAA. Without proper logging, organizations risk undetected data breaches and could face significant financial and reputational damage.
  description: This rule checks whether Autonomous Database instances have Monitoring Logs enabled to capture integration and operational events. To verify, access the OCI console, navigate to the Autonomous Database instance settings, and ensure that the logging feature is active. Remediation involves enabling the logging option under the Monitoring section to ensure that all relevant database activities are recorded for auditing and security purposes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adbauditlogs.htm
  - https://www.oracle.com/security-cloud/cis-benchmarks/
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://www.oracle.com/security/cloud-security/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.database.autonomous_database.instance_logging_enabled
  service: database
  resource: autonomous_database
  requirement: Instance Logging Enabled
  scope: database.autonomous_database.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Logging for Autonomous Database Instances
  rationale: Enabling instance logging for Autonomous Databases in OCI is crucial for capturing detailed audit trails and operational data, which are essential for detecting unauthorized access and ensuring data integrity. Without logging, organizations face increased risks of undetected breaches and non-compliance with standards such as PCI-DSS and HIPAA, which mandate rigorous audit logging practices.
  description: This rule checks if logging is enabled for Autonomous Databases in Oracle Cloud Infrastructure. Specifically, it ensures that audit logs and operational logs are captured and retained. Administrators can verify logging settings via the OCI Console under the Autonomous Database's 'Logging' section. To remediate, ensure the 'Audit Logs' and 'Operational Logs' are enabled, providing visibility into database activities and supporting compliance with audit requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/autonomousdatabaseauditing.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/index.html
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en/cloud/paas/logging-analytics/logging-analytics-overview.html
- rule_id: oci.database.autonomous_database.instance_multi_az
  service: database
  resource: autonomous_database
  requirement: Instance Multi Az
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database is Configured for Multi-AZ
  rationale: Configuring Autonomous Databases for Multi-AZ increases fault tolerance and ensures data availability during regional outages. This configuration mitigates risks associated with single-point failures and enhances data protection strategies, crucial for compliance with regulations like GDPR and CCPA.
  description: This rule checks if Autonomous Databases are deployed across multiple Availability Domains or Fault Domains, enhancing disaster recovery capabilities. To verify, ensure the 'Availability Domain' setting in the database configuration includes multiple domains. Remediation involves configuring the Autonomous Database with Multi-AZ settings during deployment or modifying existing deployments via the OCI Console.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.oracle.com/security-cloud/cis-benchmarks/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf
  - https://www.oracle.com/a/ocom/docs/cloud/certifications/oci-security-architecture.pdf
- rule_id: oci.database.autonomous_database.instance_no_public_access
  service: database
  resource: autonomous_database
  requirement: Instance No Public Access
  scope: database.autonomous_database.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Public Access to Autonomous Databases
  rationale: Allowing public access to Autonomous Databases increases the risk of unauthorized data exposure and potential exploitation by threat actors. This could lead to data breaches, financial loss, and non-compliance with data protection regulations such as GDPR and HIPAA. Limiting access to specific IP addresses or using private endpoints helps mitigate these risks and ensures secure data management.
  description: This rule checks that Autonomous Databases do not have public endpoints enabled. Public access should be restricted by configuring network security groups (NSGs) or security lists to allow traffic only from trusted IP addresses. To remediate, ensure that the Autonomous Database is deployed in a private subnet and utilize Oracle Cloud Infrastructure's (OCI) Virtual Cloud Network (VCN) features to control inbound and outbound traffic effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm#access
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/iam.htm
- rule_id: oci.database.instance.no_public_access
  service: database
  resource: instance
  requirement: No Public Access
  scope: database.instance.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Prevent Public Access to OCI Database Instances
  rationale: Publicly accessible database instances can be targeted by malicious actors, leading to unauthorized data access and potential data breaches. Such exposure increases the risk of non-compliance with regulations like GDPR, PCI-DSS, and HIPAA, which mandate strict data protection measures. Limiting database access to private networks reduces attack surfaces and protects sensitive information from external threats.
  description: This rule checks for any database instances that have public endpoints accessible over the internet. To verify, inspect the database's network configuration for public IP addresses or open security lists allowing ingress from any IP. Remediation involves removing public IP addresses or adjusting security rules to restrict access to specific, trusted IP ranges. Utilize OCI's VCN and security list features to enforce private access and employ Bastion hosts for secure administrative operations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networksecurity.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security-alerts/
- rule_id: oci.database.autonomous_database.instance_performance_insights_enabled
  service: database
  resource: autonomous_database
  requirement: Instance Performance Insights Enabled
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable Performance Insights for Autonomous Databases
  rationale: Enabling Performance Insights on Autonomous Databases is crucial for monitoring and optimizing database performance, thus preventing potential data breaches through performance anomalies. It helps organizations meet compliance requirements related to data protection and privacy by providing visibility into database operations and ensuring data integrity.
  description: This rule checks if Performance Insights are enabled on OCI Autonomous Databases. Performance Insights provide valuable data analytics that help in identifying performance bottlenecks and ensuring optimal database operation. To verify, ensure that the 'Performance Insights' option is activated in the OCI Console under the Autonomous Database settings. Remediation involves navigating to the database settings and enabling this feature to enhance monitoring capabilities.
  references:
  - https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/performance-monitoring.html
  - https://www.oracle.com/security-best-practices/
  - CIS Oracle Cloud Infrastructure Foundation Benchmark
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.autonomous_database.instance_ssl_connections
  service: database
  resource: autonomous_database
  requirement: Instance SSL Connections
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure SSL Connections for Autonomous Databases
  rationale: Enforcing SSL connections to Oracle Autonomous Databases is critical to protecting data in transit from interception and unauthorized access. This is especially important for meeting compliance requirements such as PCI-DSS and HIPAA, which mandate encryption to safeguard sensitive data. Failure to implement SSL can lead to data breaches, financial losses, and reputational damage.
  description: This rule checks if Oracle Autonomous Databases are configured to enforce SSL connections, ensuring that all data transmitted between clients and the database is encrypted. Administrators should verify that SSL is enabled by reviewing the database's connection settings and ensure that SSL/TLS certificates are properly configured and managed. Remediation involves updating the database's network access rules and client configurations to require SSL for all connections.
  references:
  - https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/connect-adb.html#GUID-7A7BDFB1-8C9B-4B6D-9E8E-3D8A9E8E9B9A
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://www.nist.gov/publications/nist-special-publication-800-53-revision-4-security-and-privacy-controls-federal-information
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.database.autonomous_database.instance_storage_encrypted
  service: database
  resource: autonomous_database
  requirement: Instance Storage Encrypted
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Storage is Encrypted
  rationale: Encrypting the storage of Autonomous Databases protects sensitive data against unauthorized access and data breaches, reducing the risk of financial loss and reputational damage. It is essential for compliance with industry standards such as PCI-DSS and HIPAA, which mandate encryption of data at rest to safeguard customer information and maintain trust.
  description: This rule checks that all Autonomous Databases have encryption enabled for their instance storage by default using Oracle-managed keys. To verify, ensure that the 'storage_encrypted' attribute is set to 'true' in the database configuration. Remediation involves enabling encryption for any databases where this setting is not active, typically managed automatically by OCI but should be rechecked if altered.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm#ADB_Encryption
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/OCI_CIS_Benchmark_v1.1.0.pdf
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://www.oracle.com/security/cloud-security/encryption/
- rule_id: oci.database.autonomous_database.snapshots_public_access
  service: database
  resource: autonomous_database
  requirement: Snapshots Public Access
  scope: database.autonomous_database.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: critical
  title: Prevent Public Access to Autonomous Database Snapshots
  rationale: Allowing public access to autonomous database snapshots can lead to unauthorized data exposure, compromising sensitive information and violating compliance standards such as PCI-DSS and GDPR. This can result in financial loss, reputational damage, and significant penalties for non-compliance. Protecting database snapshots is crucial to maintaining data integrity and confidentiality.
  description: This rule checks if any snapshots of Oracle Autonomous Databases are accessible to the public. It verifies that snapshots are configured with restricted access permissions, ensuring that only authorized personnel can retrieve or manipulate them. Remediation involves reviewing snapshot access policies in the OCI Console and enforcing the principle of least privilege by assigning appropriate IAM policies to protect sensitive data.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.oracle.com/security/cloud-security/
  - PCI DSS Requirement 1.2.1 - Restrict inbound and outbound traffic to that which is necessary
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
- rule_id: oci.database.autonomous_database.storage_encrypted
  service: database
  resource: autonomous_database
  requirement: Storage Encrypted
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Storage is Encrypted
  rationale: Encrypting storage for Autonomous Databases protects sensitive data from unauthorized access and potential breaches, mitigating risks associated with data exposure. This is crucial for compliance with regulatory requirements such as PCI-DSS and GDPR, which mandate strong encryption protocols to safeguard data privacy. Failure to encrypt data at rest can lead to financial loss and reputational damage due to non-compliance and data theft.
  description: This rule checks that all Autonomous Databases in OCI have their storage encrypted using Oracle-managed keys by default. Encryption at rest ensures that data remains protected even if physical storage devices are compromised. To verify, access the OCI Console, navigate to the Autonomous Database details, and confirm that 'Encryption at Rest' is enabled. If not, create a new Autonomous Database with encryption settings or contact Oracle support for assistance with existing databases. Regular audits should be conducted to ensure compliance with encryption policies.
  references:
  - https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/security-overview.html#GUID-3FD7F5C8-8E61-4CDA-8D15-4E6D10F0EBD3
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/itl/applied-cybersecurity/nist-cybersecurity-framework
  - https://cloud.oracle.com/data-safe
  - https://www.oracle.com/security/cloud-security/encryption/
- rule_id: oci.bds.bds_instance.encrypted_with_cmks_disabled
  service: bds
  resource: bds_instance
  requirement: Encrypted With Cmks Disabled
  scope: bds.bds_instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure BDS Instances Use Customer-Managed Keys for Encryption
  rationale: Encrypting Big Data Service (BDS) instances with Customer-Managed Keys (CMKs) enhances data protection by allowing organizations to control the encryption keys. This reduces the risk of unauthorized access, data breaches, and aligns with regulatory requirements such as GDPR and CCPA for data privacy. Without CMKs, you rely solely on Oracle's encryption, limiting control and visibility over key management.
  description: This rule checks if BDS instances are not encrypted using CMKs, which are essential for maintaining control over cryptographic keys in OCI. Verify this by navigating to the BDS instance settings in the OCI Console and ensuring that CMKs are enabled under the encryption configuration. To remediate, configure your instance to use CMKs by selecting a key from the Oracle Cloud Vault service. This ensures that your data encryption strategy aligns with best practices for data protection and compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/BigData/Tasks/bds_using_bds.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
- rule_id: oci.data_integration.task.task_logging_enabled
  service: data_integration
  resource: task
  requirement: Task Logging Enabled
  scope: data_integration.task.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Task Logging for OCI Data Integration Tasks
  rationale: Enabling task logging in OCI Data Integration is crucial for maintaining visibility into task execution, which aids in troubleshooting, monitoring, and auditing activities. Without logging, there is a risk of undetected errors or malicious activities that could compromise data integrity and compliance with standards like PCI-DSS and SOC2.
  description: This rule checks whether logging is enabled for tasks within the OCI Data Integration service. Task logging captures detailed execution logs, which are essential for monitoring task performance and diagnosing issues. To verify, ensure that task logging is configured in the OCI console under the Data Integration service by navigating to the specific task and checking the logging settings. Remediation involves enabling logging by editing the task's settings and selecting the appropriate log group and log level.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/dataintegrationoverview.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-foundations-benchmark.html
  - https://www.oracle.com/security/cloud-security/compliance/iso-27001/
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
- rule_id: oci.database.autonomous_database.autonomous_database_access_control_restricted_to_vcn
  service: database
  resource: autonomous_database
  requirement: Autonomous Database Access Control Restricted To Vcn
  scope: database.autonomous_database.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict Autonomous DB Access to VCN
  rationale: Restricting access to your Autonomous Database to specific Virtual Cloud Networks (VCNs) minimizes exposure to unauthorized access and potential data breaches. This control is crucial for maintaining data confidentiality and integrity, reducing the attack surface, and ensuring compliance with industry regulations such as PCI-DSS and HIPAA. It also protects against external threats by ensuring that only traffic from trusted network sources can reach the database.
  description: This rule checks if the Autonomous Database's network access is limited to specified VCNs, which is essential for secure database configuration. To verify, ensure the ACL (Access Control List) settings specify VCN-specific IP addresses or CIDR blocks. Remediation involves configuring the database to restrict access to the defined VCN(s) via the OCI Console or API, enhancing security by allowing only trusted network paths.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/autonomousnetworkaccess.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmarks/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hipaajournal.com/hipaa-compliance-guide/
  - https://www.iso.org/standard/54534.html
- rule_id: oci.cloud_guard.target.additional_email_configured_with_a_security_contact
  service: cloud_guard
  resource: target
  requirement: Additional Email Configured With A Security Contact
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Security Contacts Have Additional Email Configuration
  rationale: Configuring an additional email with a security contact is crucial for timely communication of security incidents and alerts, reducing response time and mitigating potential risks. It ensures that critical alerts reach the right stakeholders, helping to prevent data breaches and maintain compliance with regulatory requirements. This practice supports robust incident management and aligns with governance frameworks.
  description: This rule checks if an additional email address is configured for security contacts within OCI Cloud Guard targets. Ensuring additional contact points allows for redundancy in alerting, minimizing the risk of missed notifications. To verify, navigate to the Cloud Guard interface, select the target, and check the configuration for additional email settings under the security contact section. Remediation involves adding a secondary email address to enhance alert distribution reliability.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Tasks/configuringtargets.htm
  - https://www.oracle.com/security/cloud-security/cloud-guard/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/
- rule_id: oci.cloud_guard.target.auto_provisioning_log_analytics_agent_vms_on
  service: cloud_guard
  resource: target
  requirement: Auto Provisioning Log Analytics Agent Vms On
  scope: cloud_guard.target.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Auto Provisioning for Log Analytics Agent on VM Targets
  rationale: Automatically provisioning the Log Analytics agent on VM targets ensures continuous monitoring and logging, which is critical for detecting anomalies and potential security breaches. This automation reduces manual oversight, minimizes the risk of human error, and aligns with compliance requirements for maintaining an audit trail. It also supports proactive threat detection by streamlining log data collection and analysis across your cloud environment.
  description: This rule checks if auto provisioning of the Log Analytics agent is enabled for VM targets within Oracle Cloud Infrastructure's Cloud Guard. When enabled, this feature automatically installs the Log Analytics agent on any new VM, ensuring that logging and monitoring are consistently applied. To verify, ensure that the 'Auto Provisioning' setting is turned on in the Cloud Guard target configuration for VMs. Remediation involves accessing the Cloud Guard console, navigating to the target configuration, and enabling auto provisioning under the logging settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/home.htm
  - https://docs.oracle.com/en-us/iaas/Content/logging-analytics/home.htm
  - CIS Oracle Cloud Infrastructure Foundations Benchmark
  - NIST SP 800-53 Rev. 5
  - PCI-DSS v3.2.1 Requirement 10
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.cloud_guard.target.auto_provisioning_vulnerabilty_assessments_machines_on
  service: cloud_guard
  resource: target
  requirement: Auto Provisioning Vulnerabilty Assessments Machines On
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Enable Auto-Provisioning for Vulnerability Assessment in Cloud Guard
  rationale: Auto-provisioning vulnerability assessment machines in Oracle Cloud Infrastructure (OCI) is crucial for maintaining an up-to-date security posture by automatically deploying resources that identify and mitigate vulnerabilities. This reduces the risk of data breaches and ensures compliance with industry standards, such as PCI-DSS and ISO 27001, by continuously monitoring and assessing the security configuration of cloud assets.
  description: This rule checks if the Auto Provisioning feature for Vulnerability Assessment machines is enabled in OCI Cloud Guard. Enabling this feature ensures the automatic deployment of vulnerability assessment tools across your OCI environment, providing continuous scanning and identification of potential vulnerabilities. To verify, navigate to the Cloud Guard console, select the target, and ensure that the setting for Auto Provisioning Vulnerability Assessments is turned on. Remediation involves enabling this setting if it is found to be off, which can be done via the Cloud Guard interface or through OCI CLI commands.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/using/overview.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - 'NIST SP 800-53: Security and Privacy Controls for Information Systems and Organizations'
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Tasks/enablingcloudguard.htm
  - https://docs.oracle.com/en-us/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/cloud-guard.html
- rule_id: oci.cloud_guard.target.container_images_resolved_vulnerabilities
  service: cloud_guard
  resource: target
  requirement: Container Images Resolved Vulnerabilities
  scope: cloud_guard.target.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Container Images Have No Resolved Vulnerabilities
  rationale: Addressing vulnerabilities in container images is crucial as unpatched containers can be exploited, leading to unauthorized access and potential data breaches. This not only threatens the integrity of applications but can also result in non-compliance with industry regulations such as PCI-DSS and SOC2, impacting organizational reputation and financial standing.
  description: This rule checks for resolved vulnerabilities in container images deployed within OCI. It identifies images with known vulnerabilities and ensures that they have been patched or updated to a version where the vulnerabilities are resolved. To verify, review the vulnerability reports in the OCI Cloud Guard dashboard and update any affected images. Remediation involves pulling the latest secure image versions and redeploying them to your environment.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/home.htm
  - https://www.oracle.com/security-cloud/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://docs.oracle.com/en-us/iaas/Content/Registry/Concepts/registryoverview.htm
  - https://blog.oracle.com/security/post/how-oracle-cloud-helps-meet-compliance-requirements
  - https://www.nist.gov/cyberframework
- rule_id: oci.cloud_guard.target.container_images_scan_enabled
  service: cloud_guard
  resource: target
  requirement: Container Images Scan Enabled
  scope: cloud_guard.target.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Container Image Scanning is Enabled in Cloud Guard Targets
  rationale: Enabling container image scanning is crucial for identifying vulnerabilities in containerized applications before they are deployed, reducing the risk of exploitation. Unscanned images can harbor known vulnerabilities that may lead to data breaches, service disruptions, or non-compliance with regulatory standards such as PCI-DSS or SOC2.
  description: This rule checks if container image scanning is enabled for Oracle Cloud Guard targets, ensuring that all container images are scanned for vulnerabilities and compliance issues. To verify, ensure that the 'Container Images Scan Enabled' setting is active within your Cloud Guard configuration. Remediation involves navigating to the Cloud Guard console, selecting the appropriate target, and enabling the container image scanning feature to automatically scan and report vulnerabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://csrc.nist.gov/publications/detail/sp/800-190/final
  - https://www.pcisecuritystandards.org/document_library
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.cloud_guard.target.ensure_defender_for_arm_is_on
  service: cloud_guard
  resource: target
  requirement: Ensure Defender For Arm Is On
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure OCI Defender for ARM is Enabled
  rationale: Enabling Defender for ARM in Oracle Cloud Infrastructure helps protect ARM environments from potential security threats and vulnerabilities. It provides real-time threat detection and automated response capabilities, which are crucial for maintaining the integrity and confidentiality of sensitive data. Failing to enable this feature could lead to undetected breaches, non-compliance with regulatory standards, and potential financial losses.
  description: This rule checks whether the Oracle Cloud Infrastructure Defender for ARM is enabled within a specified target. To verify, navigate to the Cloud Guard service and ensure that the 'Defender for ARM' option is activated for the relevant resource. Remediation involves accessing the Cloud Guard settings and turning on the Defender for ARM, which enhances security monitoring and threat detection capabilities for ARM environments.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/using/manage-cloud-guard.htm
  - https://www.oracle.com/security-cloud/cloud-guard/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.cloud_guard.target.ensure_defender_for_oracle_sql_databases_is_on
  service: cloud_guard
  resource: target
  requirement: Ensure Defender For Oracle Sql Databases Is On
  scope: cloud_guard.target.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable Defender for Oracle SQL Databases in Cloud Guard
  rationale: Enabling Defender for Oracle SQL Databases mitigates risks such as unauthorized access, data breaches, and non-compliance with data protection regulations. This feature provides enhanced security by detecting anomalies and potential threats, ensuring the integrity and confidentiality of critical database resources. Compliance with frameworks like PCI-DSS and HIPAA often requires robust database security measures.
  description: This rule verifies that the Defender for Oracle SQL Databases is activated within Oracle Cloud Guard to provide real-time threat protection for SQL databases. It checks the configuration of Cloud Guard targets to ensure the Defender is on, enabling automated monitoring and alerting of suspicious activities. To remediate, navigate to the Cloud Guard console, access the target configurations, and enable the Defender feature for all relevant SQL databases. This enhances security by leveraging Oracle's advanced threat intelligence and monitoring capabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/cloud-guard-overview.html
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/using/defender-for-database.htm
  - https://www.oracle.com/security-cloud/cloud-security-compliance/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/index.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- rule_id: oci.cloud_guard.target.ensure_iot_hub_defender_is_on
  service: cloud_guard
  resource: target
  requirement: Ensure Iot Hub Defender Is On
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Enable IoT Hub Defender in Cloud Guard Targets
  rationale: Enabling IoT Hub Defender is crucial for monitoring and safeguarding IoT devices within Oracle Cloud Infrastructure. It helps detect and respond to potential security threats, ensuring the integrity and confidentiality of sensitive IoT data. This practice supports compliance with security frameworks like ISO 27001 and helps mitigate risks associated with unauthorized access and data breaches in IoT environments.
  description: This rule checks whether IoT Hub Defender is enabled within your Cloud Guard targets. IoT Hub Defender provides continuous threat monitoring for IoT devices, using machine learning to identify anomalies and vulnerabilities. To verify, ensure that IoT Hub Defender is activated in the Cloud Guard console under the specified target. Remediation involves enabling IoT Hub Defender through the Oracle Cloud Infrastructure Console by navigating to the Cloud Guard service, selecting the target, and ensuring IoT Hub Defender is toggled on.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Concepts/cloud-guard-overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/cis_oci_v1_1.htm
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/home.htm
  - https://cloud.oracle.com/cloud-guard
- rule_id: oci.cloud_guard.target.ensure_mcas_is_enabled
  service: cloud_guard
  resource: target
  requirement: Ensure Mcas Is Enabled
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Enable MCAS for Comprehensive Threat Detection
  rationale: Enabling Microsoft Cloud App Security (MCAS) in Oracle Cloud Infrastructure (OCI) enhances your organization's ability to detect and respond to threats across your cloud applications. This configuration is vital for identifying unauthorized activities and potential security breaches, thus reducing the risk of data loss and ensuring compliance with industry standards such as ISO 27001 and GDPR.
  description: This rule verifies that MCAS is integrated and actively monitoring your OCI environment. To ensure proper configuration, navigate to the Cloud Guard console and confirm that MCAS is enabled for your selected targets. Remediation involves activating MCAS through the Cloud Guard settings if it's not already enabled. This integration facilitates real-time threat analysis and compliance monitoring, providing an additional layer of security.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/overview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.oracle.com/security/cloud-security/cloud-security-posture-management/
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/home.htm
  - https://learn.microsoft.com/en-us/cloud-app-security/
  - https://www.cisecurity.org/benchmark/oracle/
- rule_id: oci.cloud_guard.target.ensure_notify_alerts_severity_is_high
  service: cloud_guard
  resource: target
  requirement: Ensure Notify Alerts Severity Is High
  scope: cloud_guard.target.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure High Severity for Cloud Guard Notify Alerts
  rationale: Setting alert notifications to high severity ensures that critical security incidents are promptly addressed, reducing the risk of data breaches and compliance violations. This practice supports business continuity by prioritizing significant threats that could impact operations and regulatory standing, such as unauthorized access attempts or data exfiltration.
  description: This rule checks whether the severity level for Cloud Guard notify alerts is set to high, ensuring that only critical security events trigger notifications. To verify, navigate to the Cloud Guard service in the OCI Console, check the target configuration, and confirm that the alert severity is set to 'High'. If not configured, adjust the settings accordingly in the Cloud Guard target's alert policies. Regularly review these settings to ensure they align with the organization's risk management strategy.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/using/cloud_guard.htm
  - https://www.oracle.com/security/cloud-security/cloud-guard/
  - https://www.oracle.com/a/ocom/docs/oci-cis-1-3.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/cloud/cloud-security/
- rule_id: oci.cloud_guard.target.ensure_notify_emails_to_owners
  service: cloud_guard
  resource: target
  requirement: Ensure Notify Emails To Owners
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Cloud Guard Targets Notify Owners via Email
  rationale: Ensuring that Cloud Guard targets notify owners via email is crucial for timely awareness of security incidents. Without proper notification, security teams may miss critical alerts, leading to delayed response times and increased risk of data breaches or compliance violations. This setting helps maintain compliance with standards such as ISO 27001, which emphasize timely incident response.
  description: This rule checks that Cloud Guard targets have email notifications enabled for owners. It verifies that the email addresses associated with Cloud Guard targets are configured to receive alerts about security incidents. To remediate, ensure that each Cloud Guard target has valid email addresses specified for notification purposes. This can be done by accessing the Cloud Guard service in the OCI Console and updating the target configurations to include the necessary email contacts.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/using/notification.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/security/OCI-Security-Services.htm
- rule_id: oci.cloud_guard.target.ensure_system_updates_are_applied
  service: cloud_guard
  resource: target
  requirement: Ensure System Updates Are Applied
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure OCI Target Systems Have Latest Security Updates
  rationale: Applying system updates is critical to protect against vulnerabilities that can be exploited by attackers, leading to data breaches and service disruptions. Regular updates ensure compliance with security policies and standards such as ISO 27001 and PCI-DSS, safeguarding business operations and customer trust.
  description: This rule checks whether the target systems in Oracle Cloud Infrastructure have the latest security updates applied. It inspects the configuration settings of Cloud Guard targets to verify update compliance, focusing on patch management processes. To remediate, ensure that automatic updates are enabled or that a manual update process is regularly followed. Confirm update status via the OCI console or CLI by reviewing system patch levels.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Concepts/cloud-guard-overview.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.cloud_guard.target.ensure_wdatp_is_enabled
  service: cloud_guard
  resource: target
  requirement: Ensure Wdatp Is Enabled
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Enable Wdatp on Cloud Guard Targets for Enhanced Security
  rationale: Enabling Windows Defender ATP (Wdatp) on OCI Cloud Guard targets provides advanced threat protection against malware and cyber threats. It helps identify and mitigate potential security incidents, reducing the risk of data breaches and enhancing compliance with regulatory standards such as PCI-DSS and ISO 27001. This proactive approach safeguards sensitive data and maintains organizational trust and reputation.
  description: This rule checks whether Windows Defender ATP is enabled on Cloud Guard targets in OCI. To verify, ensure that the Wdatp integration is activated in the Cloud Guard settings for each target. If not enabled, navigate to the Cloud Guard console, select the appropriate target, and enable Wdatp integration. This action will help in continuously monitoring and responding to threats by leveraging Microsoftâ€™s threat intelligence.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Tasks/cloud-guard-targets.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/overview-defender-atp
- rule_id: oci.cloud_guard.target.vm_endpoint_protection_installed
  service: cloud_guard
  resource: target
  requirement: VM Endpoint Protection Installed
  scope: cloud_guard.target.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure VM Endpoint Protection is Installed for Cloud Guard Targets
  rationale: Endpoint protection is crucial for safeguarding VMs against malware, unauthorized access, and data breaches. Without it, VMs are vulnerable to threats that can compromise sensitive data and disrupt operations, leading to potential financial loss and damage to reputation. Compliance with standards like PCI-DSS and HIPAA often requires robust endpoint protection measures.
  description: This rule checks if endpoint protection software is installed on VMs associated with Cloud Guard targets. It verifies the presence of Oracle-approved security agents or third-party solutions that monitor and protect against threats. To remediate, ensure that each VM has the required endpoint protection installed and configured to report to a central management console. Regularly update protection software to mitigate emerging threats.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-security/cloud-guard/
  - https://www.oracle.com/cloud/security/compliance/
- rule_id: oci.devops.project.no_secrets_in_variables
  service: devops
  resource: project
  requirement: No Secrets In Variables
  scope: devops.project.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure No Secrets in DevOps Project Environment Variables
  rationale: Storing secrets such as passwords, API keys, or tokens in environment variables of DevOps projects poses a significant security risk. This can lead to unauthorized access, data breaches, and non-compliance with regulations like PCI-DSS and ISO 27001, impacting the organization's reputation and financial standing. Protecting sensitive data is crucial for maintaining trust and meeting compliance requirements.
  description: This rule checks DevOps project environment variables to ensure they do not contain secrets. Secrets should be managed using OCI Vault or other secure secret management tools rather than being hardcoded in project configurations. To verify, inspect environment variable definitions in your DevOps project settings and migrate any sensitive data to OCI Vault secrets. Update configurations to retrieve secrets securely from the vault during runtime.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DevOps/using/devops_project.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-122.pdf
  - https://www.iso.org/standard/54534.html
  - https://cloudsecurityalliance.org/research/artifacts/oci-security-best-practices
- rule_id: oci.devops.project.source_repo_url_no_sensitive_credentials
  service: devops
  resource: project
  requirement: Source Repo Url No Sensitive Credentials
  scope: devops.project.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Prevent Sensitive Credentials in Source Repo URLs
  rationale: Embedding sensitive credentials within source repository URLs can lead to unauthorized access if these URLs are exposed. This practice increases the risk of credential leakage, potentially resulting in unauthorized data access, service exploitation, and financial loss. It is crucial to adhere to security standards and compliance requirements such as PCI-DSS and NIST to safeguard sensitive information and maintain trust.
  description: This rule checks that source repository URLs configured within OCI DevOps projects do not contain sensitive credentials such as passwords or API keys. This is verified by scanning the repository URLs for patterns indicative of embedded credentials. To remediate, remove any credentials from the repository URLs and utilize secure credential management services provided by OCI, such as OCI Vault, to handle authentication securely.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DevOps/using/home.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://cloud.oracle.com/security-best-practices
- rule_id: oci.database.autonomous_database.endpoint_redis_in_transit_encryption_enabled
  service: database
  resource: autonomous_database
  requirement: Endpoint Redis In Transit Encryption Enabled
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Redis In-Transit Encryption for Autonomous Database
  rationale: Enabling in-transit encryption for Redis endpoints in Autonomous Databases is crucial to protect data integrity and confidentiality from interception during transmission. Without encryption, sensitive data such as financial records or personal information could be exposed to unauthorized access, potentially leading to data breaches, financial loss, and non-compliance with regulations like PCI-DSS and GDPR.
  description: This rule checks whether Redis endpoint encryption is enabled for in-transit data on Autonomous Databases. It verifies that the connection between clients and the database is secured using TLS (Transport Layer Security) to prevent data interception. To ensure security, configure the Autonomous Database to enforce TLS for all Redis endpoint communications. Verification can be done through the OCI Console by checking the encryption settings under the Autonomous Database configuration. Remediation involves enabling TLS for Redis endpoints if it is not already configured.
  references:
  - https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/security.htm#ADBSA-GUID-9F4D9E02-87BD-4F82-9F4A-3A6D7B4A8D36
  - https://csrc.nist.gov/publications/detail/sp/800-52/rev-2/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.database.autonomous_database.replication_task_source_logging_enabled
  service: database
  resource: autonomous_database
  requirement: Replication Task Source Logging Enabled
  scope: database.autonomous_database.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Logging for Autonomous Database Replication Tasks
  rationale: Enabling logging for replication tasks in autonomous databases is crucial for monitoring data integrity and detecting unusual activity. Without these logs, it becomes challenging to identify unauthorized access or replication errors that could lead to data breaches or compliance violations. Logs also provide essential forensic data for audits, supporting adherence to regulatory requirements such as GDPR and PCI-DSS.
  description: This rule checks if logging is enabled for replication tasks in Oracle Autonomous Databases. To verify, ensure that the 'Enable Logging' setting is activated in the replication task configuration. If logging is disabled, security teams should enable it to capture detailed logs of all replication activities. This can be done via the OCI Console under the Autonomous Database settings. Regularly review these logs to identify and respond to potential security incidents promptly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adbdashboard.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_security_cis.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/best-practices/
- rule_id: oci.database.autonomous_database.replication_task_target_logging_enabled
  service: database
  resource: autonomous_database
  requirement: Replication Task Target Logging Enabled
  scope: database.autonomous_database.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Autonomous DB Replication Task Logging is Enabled
  rationale: Enabling logging for replication tasks in Autonomous Databases is crucial for auditing and monitoring data integrity and replication activities. Without logging, unauthorized changes or failures in replication could go undetected, posing a risk to business continuity and data security. Compliance with standards like PCI-DSS and SOC2 often mandates robust logging mechanisms to ensure accountability and traceability of data operations.
  description: This rule checks if logging is enabled for replication tasks in Oracle Cloud Infrastructure (OCI) Autonomous Databases. Ensuring logging is active involves verifying that the database's replication settings are configured to capture all relevant logs such as replication start, stop, and error messages. To enable logging, navigate to the OCI Console, access the Autonomous Database, and update the replication settings to ensure logs are directed to the appropriate logging service. This helps in proactive monitoring and quick response to any anomalies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbmanaging.htm#logging
  - https://www.oracle.com/security/cis-benchmark/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-security-overview.htm
  - https://www.pcisecuritystandards.org/
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/sorhome.html
  - https://www.iso.org/standard/54534.html
- rule_id: oci.dns.record.dnssec_disabled
  service: dns
  resource: record
  requirement: Dnssec Disabled
  scope: dns.record.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: DNS Records Should Have DNSSEC Enabled
  rationale: DNS Security Extensions (DNSSEC) protect DNS data integrity and authenticity by preventing DNS spoofing attacks, which can lead to traffic interception or redirection to malicious sites. Disabling DNSSEC could expose your DNS records to tampering, undermining trust in your domain and potentially violating compliance standards like PCI-DSS that emphasize data integrity.
  description: This rule checks if DNSSEC is disabled for DNS records in Oracle Cloud Infrastructure (OCI). DNSSEC provides an additional layer of security by ensuring that responses to DNS queries are authentic. To verify, inspect DNS settings in the OCI Console and enable DNSSEC under the DNS zone configuration. Remediation involves navigating to the DNS zone settings in OCI, enabling DNSSEC, and ensuring all DNS records within the zone are signed with a valid DNSSEC key.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DNS/Tasks/dnssec.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v4/
  - https://www.iso.org/standard/73906.html
- rule_id: oci.dns.zone.key_sign_in_dnssec
  service: dns
  resource: zone
  requirement: Key Sign In Dnssec
  scope: dns.zone.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable DNSSEC Key Signing for DNS Zones
  rationale: Enabling DNSSEC (Domain Name System Security Extensions) key signing for DNS zones ensures data integrity and authenticity, protecting against DNS spoofing and cache poisoning attacks. This is critical for maintaining trustworthiness in domain name resolution, which is essential for ensuring uninterrupted business operations and meeting compliance requirements like NIST SP 800-53 and PCI-DSS.
  description: This rule checks if DNSSEC is enabled and configured for DNS zones in OCI, which involves the use of cryptographic keys to sign DNS data, ensuring its authenticity and integrity. To verify, access the DNS zone settings in the OCI Console and ensure that DNSSEC is enabled. Remediation involves generating a key pair and enabling DNSSEC on the specified DNS zone, following OCI's detailed DNSSEC configuration steps.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DNS/Tasks/dnssec.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.oracle.com/security/cloud-security/identity-security/
- rule_id: oci.dns.zone.rsasha1_in_use_to_zone_sign_dnssec
  service: dns
  resource: zone
  requirement: Rsasha1 In Use To Zone Sign Dnssec
  scope: dns.zone.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Prevent RSA-SHA1 Usage for DNSSEC Zone Signing
  rationale: Using RSA-SHA1 for signing DNSSEC zones can expose your domains to security vulnerabilities, including replay attacks and brute force attempts, due to the weak cryptographic strength of SHA-1. This poses a risk to data integrity and trust, potentially leading to domain spoofing and undermining customer confidence. Compliance with security standards like NIST and PCI-DSS requires the use of stronger cryptographic algorithms.
  description: This rule checks if the RSA-SHA1 algorithm is being used to sign DNSSEC zones within your OCI environment. RSA-SHA1 is considered weak and should be replaced with stronger algorithms such as RSA-SHA256 or ECDSA. To verify, review your DNSSEC zone signing settings and ensure SHA-1 is not in use. Remediate by updating the DNSSEC configurations to use accepted algorithms, improving security and compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DNS/Reference/dnssectutorial.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
- rule_id: oci.nosql.table.accelerator_cluster_encryption_enabled
  service: nosql
  resource: table
  requirement: Accelerator Cluster Encryption Enabled
  scope: nosql.table.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Accelerator Cluster Encryption for NoSQL Tables
  rationale: Enabling encryption for accelerator clusters in Oracle NoSQL Database tables protects sensitive data from unauthorized access, addressing potential data breaches. Failure to encrypt data can lead to compliance violations with regulations like PCI-DSS and HIPAA, resulting in financial penalties and reputational damage. Encryption at rest is a critical control to safeguard against data exfiltration and ensure data privacy.
  description: This rule checks if encryption is enabled for accelerator clusters in Oracle NoSQL Database tables, which is essential for protecting data at rest. Verify that encryption settings are configured in the OCI Console under NoSQL Database settings. If encryption is not enabled, update the table configuration to use Oracle-managed keys or customer-managed keys (CMKs) for enhanced security. Regular audits should be performed to ensure compliance with security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/nosql-database/doc/encryption-rest.html
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/index.html
  - https://www.nist.gov/
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.nosql.table.autoscaling_enabled
  service: nosql
  resource: table
  requirement: Autoscaling Enabled
  scope: nosql.table.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Enable Autoscaling for NoSQL Tables to Optimize Resource Utilization
  rationale: Enabling autoscaling for NoSQL tables ensures that resources are optimally utilized, providing cost efficiency and maintaining performance stability during variable workloads. Without autoscaling, there can be risks of resource exhaustion during peak demands or unnecessary costs during low usage periods. This configuration aligns with compliance requirements by ensuring resource management practices are efficient and responsive.
  description: This rule checks whether autoscaling is enabled for Oracle NoSQL Database Cloud Service tables. Autoscaling allows the service to automatically adjust compute resources according to the workload, preventing performance bottlenecks and cost overruns. To verify, ensure the 'Auto Scaling' option is enabled in the NoSQL Table settings in the OCI Console. Remediation involves navigating to the NoSQL Table in OCI Console and enabling the autoscaling feature under the table's capacity settings.
  references:
  - https://docs.oracle.com/en-us/iaas/nosql-database/autoscaling.html
  - https://www.oracle.com/security/cloud-compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/document_library
  - https://www.oracle.com/cloud/nosql.html#best_practices
- rule_id: oci.nosql.table.backup_enabled
  service: nosql
  resource: table
  requirement: Backup Enabled
  scope: nosql.table.backup_recovery
  domain: resilience_and_disaster_recovery
  subcategory: backup_configuration
  severity: medium
  title: Ensure NoSQL Table Backups Are Enabled
  rationale: Enabling backups for NoSQL tables in OCI is crucial for data resilience and disaster recovery. Without backups, data loss can occur due to accidental deletions, corruption, or system failures, leading to business continuity issues and potential non-compliance with regulatory standards requiring data protection.
  description: This rule verifies if backups are enabled for Oracle Cloud Infrastructure NoSQL tables. To ensure data integrity and availability, configure automatic backups via the OCI Console or API by navigating to the NoSQL service, selecting the table, and enabling the backup option. Remediation involves setting a regular backup schedule and verifying successful backup completion to safeguard against data loss.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/NoSQL/Reference/backuprestore.htm
  - https://docs.oracle.com/en-us/iaas/Content/NoSQL/Tasks/nosqlusingconsole.htm
  - https://www.cisecurity.org/benchmark/oracle
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.nosql.table.cluster_in_transit_encryption_enabled
  service: nosql
  resource: table
  requirement: Cluster In Transit Encryption Enabled
  scope: nosql.table.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure NoSQL Table Cluster In-Transit Encryption is Enabled
  rationale: Enabling in-transit encryption for NoSQL table clusters is crucial to protect data from interception and unauthorized access during transmission. This is especially important for maintaining data confidentiality and integrity, mitigating risks such as man-in-the-middle attacks. Compliance with regulations like GDPR and HIPAA often mandates encryption of data in transit, making this a critical element of data protection and privacy strategies.
  description: This rule checks whether in-transit encryption is enabled for Oracle NoSQL Database table clusters. In-transit encryption ensures that data being transferred between clients and servers is encrypted using industry-standard protocols such as TLS. To verify, inspect the NoSQL table configuration in the OCI console or through the CLI to ensure encryption settings are enabled. If not enabled, update the table settings to activate in-transit encryption, which can usually be configured during table creation or by modifying existing table settings.
  references:
  - https://docs.oracle.com/en-us/iaas/nosql-database/doc/security.html#security-encryption
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.nosql.table.pitr_enabled
  service: nosql
  resource: table
  requirement: Pitr Enabled
  scope: nosql.table.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Point-In-Time Recovery (PITR) is Enabled for NoSQL Tables
  rationale: Enabling Point-In-Time Recovery (PITR) for NoSQL tables is crucial in safeguarding data against accidental deletions, corruptions, or malicious activities. It provides the ability to recover data to a specific point in time, minimizing potential data loss and ensuring business continuity. This feature is particularly important for compliance with data integrity and availability requirements under frameworks like ISO 27001 and SOC2.
  description: This rule checks if Point-In-Time Recovery (PITR) is enabled on Oracle Cloud Infrastructure (OCI) NoSQL tables. PITR allows organizations to restore their NoSQL data to a specific timestamp within a retention window, protecting against data loss. To verify, navigate to the NoSQL service in the OCI Console, select a table, and check the PITR settings. Enable PITR by configuring the desired retention period. Regularly review and test recovery procedures to ensure effectiveness.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/NoSQL/using/pointintimerecovery.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_fundamentals.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/sorhome.html
  - https://cloud.oracle.com/nosql
- rule_id: oci.nosql.table.tables_kms_cmk_encryption_enabled
  service: nosql
  resource: table
  requirement: Tables KMS CMK Encryption Enabled
  scope: nosql.table.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure KMS CMK Encryption for NoSQL Tables
  rationale: Enabling KMS Customer-Managed Keys (CMK) for NoSQL tables ensures that data is encrypted at rest with keys that are controlled by the organization. This reduces the risk of data breaches and unauthorized access, addresses compliance with regulations such as PCI-DSS and HIPAA, and supports robust data protection strategies. Failure to use CMK encryption can lead to significant data privacy issues and non-compliance penalties.
  description: This rule checks whether Oracle NoSQL tables are configured to use KMS Customer-Managed Keys (CMK) for encryption at rest. To verify, ensure that the NoSQL table's encryption setting specifies a KMS key. If not configured, update the table's encryption settings in the OCI console to use a CMK from Oracle Cloud Vault. This strengthens data security by allowing organizations to rotate and manage encryption keys effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/NoSQL/Concepts/using_kms.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://csrc.nist.gov/publications/detail/sp/800-57/part-1/rev-5/final
  - https://www.oracle.com/cloud/security/
- rule_id: oci.nosql.table.tables_pitr_enabled
  service: nosql
  resource: table
  requirement: Tables Pitr Enabled
  scope: nosql.table.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Point-in-Time Recovery (PITR) is Enabled for NoSQL Tables
  rationale: Enabling Point-in-Time Recovery (PITR) for NoSQL tables is crucial for mitigating data loss risks, allowing recovery from accidental deletions or corruptions. This feature supports business continuity and ensures compliance with data protection standards by enabling restoration to a specific point in time. It is particularly important for meeting regulatory requirements like GDPR that mandate data integrity and availability.
  description: This rule checks if PITR is enabled for NoSQL tables in your OCI environment. To verify, access the NoSQL service in the OCI Console, navigate to the desired table, and confirm that PITR is activated. If not enabled, update the table settings to activate PITR to facilitate data recovery. This setting ensures that data can be restored to any point within the retention period, minimizing potential data loss and maintaining operational resilience.
  references:
  - https://docs.oracle.com/en-us/iaas/nosql-database/doc/using-pitr.html
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/cloud-security/
- rule_id: oci.block_storage.volume.snapshot_encryption
  service: block_storage
  resource: volume
  requirement: Snapshot Encryption
  scope: block_storage.volume.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Block Volume Snapshots are Encrypted
  rationale: Encrypting block volume snapshots mitigates the risk of unauthorized data access and data breaches, which can lead to significant financial loss and reputational damage. It is crucial for meeting compliance standards like PCI-DSS, HIPAA, and ISO 27001, which mandate data encryption to protect sensitive information. In unencrypted states, snapshots can be exploited by attackers to access confidential data.
  description: This rule verifies that all block volume snapshots in OCI are encrypted using Oracle-managed keys by default or customer-managed keys for enhanced control. To ensure compliance, check that the 'Encrypt this snapshot' option is enabled when creating snapshots. Remediate by re-creating unencrypted snapshots with encryption enabled. Utilize the OCI Console or CLI to manage and confirm encryption settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/References/blockvolumebackups.htm
  - https://docs.cisecurity.org/benchmark/oracle_cloud_computing_platform
  - https://www.pcisecuritystandards.org/
  - https://www.hipaajournal.com/hipaa-encryption-requirements/
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm
- rule_id: oci.block_storage.volume.volume_backup_configured
  service: block_storage
  resource: volume
  requirement: Volume Backup Configured
  scope: block_storage.volume.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: medium
  title: Ensure Block Storage Volume Backup is Configured
  rationale: Configuring backups for block storage volumes is crucial to protect against data loss due to accidental deletion, corruption, or system failures. Inadequate backup strategies can lead to significant business disruptions and financial losses. Additionally, maintaining regular backups is often a requirement to comply with various regulatory standards such as PCI-DSS and ISO 27001.
  description: This rule checks if a backup policy is configured for block storage volumes in OCI. Ensure that each volume has an automated backup schedule set, using OCI's native backup policies to create regular, incremental, and full backups. To remediate, navigate to the OCI console, select your block storage volume, and apply a backup policy that suits your data retention and recovery needs. Regularly review and test backup restoration procedures to ensure data integrity and accessibility.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/schedulingbackups.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloud.oracle.com/storage/block-volume/features
- rule_id: oci.compute.instance.instance_detailed_monitoring_enabled
  service: compute
  resource: instance
  requirement: Instance Detailed Monitoring Enabled
  scope: compute.instance.monitoring
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Detailed Monitoring for Compute Instances
  rationale: Enabling detailed monitoring for compute instances is crucial for gaining in-depth insights into system performance and identifying potential security threats or operational issues. It allows businesses to respond proactively to anomalies, reducing downtime and improving overall cloud infrastructure security posture. Additionally, detailed monitoring aids in meeting compliance requirements by providing granular logging necessary for audits and incident investigations.
  description: This check ensures that Oracle Cloud Infrastructure (OCI) compute instances have detailed monitoring enabled, allowing for the collection of higher-frequency metrics. Verify this by reviewing the instance settings in the OCI Console under Monitoring, ensuring that 'Detailed Monitoring' is activated. To remediate, navigate to the instance's Monitoring settings and enable 'Detailed Monitoring' to obtain more granular data, which is crucial for effective monitoring and incident response.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-security-best-practices.htm#monitoring
  - CIS Oracle Cloud Infrastructure Foundations Benchmark
  - 'NIST SP 800-53: SI-4 Information System Monitoring'
  - 'PCI-DSS Requirement 10: Track and monitor all access to network resources and cardholder data'
  - https://www.oracle.com/security/cloud-security/compliance/
- rule_id: oci.container_instances.container_instance.task_definitions_logging_enabled
  service: container_instances
  resource: container_instance
  requirement: Task Definitions Logging Enabled
  scope: container_instances.container_instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure OCI Container Task Definitions Logging is Enabled
  rationale: Enabling logging for OCI Container Instances is crucial for monitoring container activity, detecting anomalies, and ensuring accountability. Without logging, security incidents may go unnoticed, leading to potential data breaches and non-compliance with regulations such as PCI-DSS and SOC2 that mandate audit logging. Proper logging supports forensic investigations and enhances overall cloud security posture.
  description: This rule verifies that logging is enabled for OCI Container Instances' task definitions. Specifically, it checks whether audit logs are being captured and stored, facilitating real-time monitoring and historical analysis. To enable logging, configure your container instances to integrate with Oracle Cloud Logging Service, ensuring that all task activities are recorded. Remediation involves configuring log groups and enabling logging at the container instance level.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.oracle.com/cloud-native/container-engine-kubernetes/features/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
- rule_id: oci.file_storage.file_system.backup_enabled
  service: file_storage
  resource: file_system
  requirement: Backup Enabled
  scope: file_storage.file_system.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: medium
  title: Enable Backup for File Storage File Systems
  rationale: Ensuring that backups are enabled for OCI File Storage file systems is crucial for data availability and resilience against data loss due to accidental deletion, corruption, or ransomware attacks. Inadequate backup strategies can lead to significant business disruptions and potential financial losses. Furthermore, compliance with regulations such as GDPR and ISO 27001 often mandates robust data protection measures.
  description: This check verifies that backups are enabled for file systems within Oracle Cloud Infrastructure's File Storage service. To ensure data protection, configure automatic or scheduled backups by navigating to the File Storage section in the OCI Console and enabling the backup policy for each file system. Remediation involves setting up a backup policy via the 'Backup Policies' tab, where you can define the backup frequency and retention period.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Tasks/backingupfilesystem.htm
  - https://www.oracle.com/a/ocom/docs/cloud/oci-security-architecture.pdf
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.file_storage.file_system.encryption_enabled
  service: file_storage
  resource: file_system
  requirement: Encryption Enabled
  scope: file_storage.file_system.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure File Storage File System Encryption is Enabled
  rationale: Enabling encryption on file storage systems is crucial for protecting sensitive data from unauthorized access, especially in the event of a breach. Encryption helps meet compliance requirements such as PCI-DSS and HIPAA, reducing the risk of data exposure and potential financial and reputational damage. It safeguards data privacy and ensures that only authorized users have access to the decrypted information.
  description: This rule checks whether encryption is enabled for Oracle Cloud Infrastructure (OCI) File Storage file systems. To verify, ensure that the 'Encryption in Transit and at Rest' setting is configured in the OCI console. If encryption is not enabled, modify the file system settings to enable encryption using the OCI Console or CLI. Enabling this feature ensures that all data stored within the file system is encrypted, providing an additional layer of security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Concepts/filestorageoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/ocisecurityguidelines.htm#CIS
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/index.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.file_storage.file_system.have_backup_enabled
  service: file_storage
  resource: file_system
  requirement: Have Backup Enabled
  scope: file_storage.file_system.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: medium
  title: Ensure OCI File Storage File Systems Have Backups Enabled
  rationale: Enabling backups for OCI File Systems protects against data loss due to accidental deletion, corruption, or malicious attacks. Without backups, recovery from such incidents can be complex and costly, potentially resulting in significant business disruption and non-compliance with data protection regulations like GDPR and HIPAA.
  description: This rule checks if OCI File Storage File Systems have backup policies enabled, ensuring that critical data is regularly backed up and recoverable. Verification involves reviewing the file system settings in the OCI Console to confirm an automated backup policy is in place. Remediation requires configuring a backup policy through the OCI Console or CLI, specifying the frequency and retention period to align with business continuity and disaster recovery strategies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Tasks/creatingbackups.htm
  - https://www.oracle.com/security/cloud-compliance/cis-oci-benchmark.html
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hipaajournal.com/hipaa-compliance-checklist/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.virtual_network.vcn.attached
  service: virtual_network
  resource: vcn
  requirement: Attached
  scope: virtual_network.vcn.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure VCN is Attached to a Route Table or Internet Gateway
  rationale: Not attaching a Virtual Cloud Network (VCN) to a route table or Internet Gateway can lead to network isolation, preventing workloads from reaching necessary resources, such as the internet or other network services. This can result in operational inefficiencies and potential non-compliance with industry regulations requiring network accessibility and monitoring.
  description: This rule checks if a VCN is appropriately attached to at least one route table or Internet Gateway to allow traffic flow. To verify, ensure the VCN is associated with a route table and that necessary routes are defined for outbound traffic. Remediation involves configuring route rules within the route table or attaching an Internet Gateway to the VCN, enabling proper network traffic routing and access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingroutetables.htm
  - CIS Oracle Cloud Infrastructure Foundations Benchmark v1.0.0
  - 'NIST SP 800-53 Rev. 5: AC-17 - Remote Access'
  - 'PCI-DSS v3.2.1: Requirement 1.2.1'
- rule_id: oci.container_engine.cluster.cluster_kms_cmk_encryption_in_secrets_enabled
  service: container_engine
  resource: cluster
  requirement: Cluster KMS CMK Encryption In Secrets Enabled
  scope: container_engine.cluster.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure KMS CMK Encryption for Secrets in OCI Clusters
  rationale: Enabling KMS CMK encryption for secrets in OCI clusters is vital for protecting sensitive data stored within the container ecosystem. Without this encryption, secrets are vulnerable to unauthorized access, potentially leading to data breaches and non-compliance with data protection regulations like GDPR and CCPA. Proper encryption mitigates risks associated with data exposure and enhances trust in cloud security practices.
  description: This rule checks if Oracle Cloud Infrastructure Container Engine for Kubernetes clusters have Key Management Service (KMS) Customer Master Key (CMK) encryption enabled for secrets. This involves configuring your cluster to encrypt Kubernetes secrets using a specific KMS CMK, ensuring that sensitive information is securely stored. To verify, ensure that your cluster's secrets encryption configuration is set to use a KMS CMK. Remediation involves updating the cluster settings to specify a KMS CMK for secrets encryption through the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengusing.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-57/part-1/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloud.oracle.com/en_US/architecture-center/reference-architectures/cloud-security
- rule_id: oci.container_engine.cluster.cluster_public_access_blocked
  service: container_engine
  resource: cluster
  requirement: Cluster Public Access Blocked
  scope: container_engine.cluster.public_access
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: critical
  title: Block Public Access to OCI Kubernetes Clusters
  rationale: Blocking public access to Kubernetes clusters in OCI is critical to prevent unauthorized access and potential data breaches. Publicly accessible clusters can be exploited by attackers to execute malicious activities, leading to service disruptions and compliance violations with frameworks like NIST and PCI-DSS, which mandate stringent access controls.
  description: This rule verifies that Kubernetes clusters in OCI have public access disabled to enhance security. It checks for network configurations that expose the cluster's API server to the internet. To remediate, ensure that the cluster's endpoint is configured to be private and accessible only through secure and controlled networks, such as VPNs or Oracle Cloud's private network settings. Regularly audit access logs and network policies to maintain a secure environment.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengcreatingclusters.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://blogs.oracle.com/cloudsecurity/post/best-practices-for-securing-oracle-cloud-infrastructure-kubernetes-engine
- rule_id: oci.redis.cluster.backup_retention
  service: redis
  resource: cluster
  requirement: Backup Retention
  scope: redis.cluster.backup_recovery
  domain: resilience_and_disaster_recovery
  subcategory: backup_configuration
  severity: medium
  title: Ensure Redis Cluster Backup Retention Policy is Configured
  rationale: Properly configured backup retention for Redis clusters is crucial to ensure data availability and resilience in case of data loss or corruption. Without adequate backups, businesses face potential data loss, leading to operational disruptions and non-compliance with regulations like GDPR and HIPAA. This can result in financial penalties and damage to the organization's reputation.
  description: This rule checks if Redis clusters on OCI have a backup retention policy configured to retain backups for a sufficient duration. It's vital to set a retention period that aligns with business continuity requirements and compliance mandates. To verify, navigate to the OCI Console, select the Redis service, and review the backup settings for each cluster. Remediation involves configuring a backup retention policy that meets your organization's recovery objectives, which can be done through the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Redis/Concepts/redishome.htm
  - https://docs.oracle.com/en-us/iaas/Content/Redis/Tasks/redisbackup.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-34r1.pdf
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
- rule_id: oci.redis.cluster.cluster_in_transit_encryption_enabled
  service: redis
  resource: cluster
  requirement: Cluster In Transit Encryption Enabled
  scope: redis.cluster.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Redis Cluster In-Transit Encryption is Enabled
  rationale: Enabling in-transit encryption for Redis clusters is critical to protect sensitive data from interception during transmission. Without encryption, data can be exposed to unauthorized access, leading to potential data breaches and non-compliance with data protection regulations such as GDPR, HIPAA, and PCI-DSS. This measure reduces the risk of man-in-the-middle attacks and enhances the overall security posture of the cloud environment.
  description: This rule checks whether in-transit encryption is enabled for Redis clusters in Oracle Cloud Infrastructure. To verify, ensure that the TLS (Transport Layer Security) protocol is configured for Redis clusters to encrypt data as it travels between clients and servers. Remediation involves enabling TLS in the cluster configuration settings, which can be done through the OCI Console or CLI. This will safeguard data integrity and confidentiality during transmission.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Redis/Tasks/redisusingtls.htm
  - https://www.oracle.com/security/certifications/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.compute.instance.environment_monitoring_logging_enabled
  service: compute
  resource: instance
  requirement: Environment Monitoring Logging Enabled
  scope: compute.instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Environment Monitoring Logs Enabled for OCI Compute Instances
  rationale: Enabling environment monitoring logs for compute instances is crucial for tracking system health, performance issues, and unauthorized access attempts. This facilitates proactive incident response, aids in forensic investigations, and supports compliance with regulations such as NIST SP 800-53 and ISO 27001, which require detailed logging and monitoring.
  description: This rule verifies that environment monitoring logs are enabled for all OCI compute instances. It ensures that logs are collected and stored in the OCI Logging service, capturing detailed information about instance operations and performance. To verify, check the 'Logs' section under the compute instance settings in the OCI Console and ensure 'Monitoring' logs are active. Remediation involves navigating to the compute instance settings, enabling logging, and selecting the appropriate log group and compartment.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/monitoringinstance.htm
  - https://docs.cisecurity.org/benchmark/Oracle_Cloud_Infrastructure
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/cloud-infrastructure-compliance/
- rule_id: oci.load_balancer.load_balancer.logging_enabled
  service: load_balancer
  resource: load_balancer
  requirement: Logging Enabled
  scope: load_balancer.load_balancer.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Logging for Load Balancers
  rationale: Enabling logging on load balancers is crucial for maintaining visibility into traffic patterns and detecting anomalies, which can indicate potential security threats such as DDoS attacks or unauthorized access attempts. This practice supports compliance with regulatory frameworks that mandate logging and monitoring, such as PCI-DSS and ISO 27001, thereby reducing legal and financial risks.
  description: This rule checks whether logging is enabled for Oracle Cloud Infrastructure load balancers. Specifically, it verifies that the access and error logs are configured to capture all incoming and outgoing traffic details. To enable logging, navigate to the Load Balancer's configuration in the OCI Console, select the 'Logs' option, and ensure both access and error logs are activated. Regularly review these logs and set up alerts for any suspicious activity to enhance security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Tasks/managinglogs.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/security/best-practices/
- rule_id: oci.load_balancer.load_balancer.ssl_listeners
  service: load_balancer
  resource: load_balancer
  requirement: SSL Listeners
  scope: load_balancer.load_balancer.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure SSL is Enabled for OCI Load Balancer Listeners
  rationale: Enabling SSL on load balancer listeners is crucial to protect data in transit by encrypting communications between clients and backend services. Without SSL, sensitive data could be intercepted by unauthorized parties, leading to potential data breaches and non-compliance with regulations like PCI-DSS and HIPAA. Encrypting traffic enhances trust and safeguards data privacy, which is essential for maintaining business integrity and customer confidence.
  description: This rule checks if SSL is enabled for listeners on Oracle Cloud Infrastructure load balancers. SSL listeners ensure that data is encrypted using TLS protocols, thus securing data in transit. To verify, ensure that all load balancer listeners have SSL configurations with valid certificates issued by a trusted certificate authority. Remediation involves configuring SSL listeners using the OCI console or API, specifying certificate details and enabling TLS versions as per best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Tasks/ssl_certificates.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://csrc.nist.gov/publications/detail/sp/800-52/rev-2/final
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.load_balancer.load_balancer.deletion_protection
  service: load_balancer
  resource: load_balancer
  requirement: Deletion Protection
  scope: load_balancer.load_balancer.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Enable Deletion Protection for OCI Load Balancers
  rationale: Enabling deletion protection for load balancers in OCI prevents accidental or malicious removal of critical infrastructure components, thereby ensuring continuous availability and minimizing potential disruptions to business operations. This is crucial for maintaining service integrity and complying with regulations that require robust data protection and availability measures.
  description: This rule checks if deletion protection is enabled for load balancers in your OCI environment. To verify, access the OCI Console, navigate to the Load Balancer settings, and ensure the deletion protection option is active. If not enabled, modify the load balancer settings to activate deletion protection. This feature prevents inadvertent deletions, which could lead to service outages and data loss, thus maintaining high availability and operational resilience.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Tasks/managingloadbalancer.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_oci.htm#standards
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/publications/federal-information-processing-standards-publication-200
  - https://www.pcisecuritystandards.org/pci_security
- rule_id: oci.load_balancer.backend_set.group_health_check_enabled
  service: load_balancer
  resource: backend_set
  requirement: Group Health Check Enabled
  scope: load_balancer.backend_set.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Load Balancer Backend Set Group Health Check is Enabled
  rationale: Enabling health checks for backend sets in OCI load balancers ensures that traffic is only directed to healthy, responsive backend servers, reducing downtime and improving service reliability. This is crucial for maintaining business continuity and meeting service level agreements (SLAs). Furthermore, it mitigates risks associated with sending traffic to failed or underperforming nodes, which could lead to data loss or degraded application performance.
  description: This check verifies that group health checks are enabled for backend sets in the Oracle Cloud Infrastructure load balancer service. A health check is a probe that monitors the availability and responsiveness of each backend server. To enable health checks, configure the load balancer with HTTP, TCP, or HTTPS health checks targeting backend servers. If a server fails the health check, it is automatically removed from the pool until it recovers. Remediation involves ensuring all backend sets have active health checks configured through the OCI Console, CLI, or API.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Tasks/editinghealthcheck.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.load_balancer.load_balancer.insecure_ssl_ciphers
  service: load_balancer
  resource: load_balancer
  requirement: Insecure SSL Ciphers
  scope: load_balancer.load_balancer.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Secure SSL Ciphers for OCI Load Balancer
  rationale: Using insecure SSL ciphers can expose sensitive data to interception and decryption by malicious actors, posing significant risks to data confidentiality and integrity. This is critical for compliance with data protection regulations such as PCI-DSS and HIPAA, which mandate secure transmission channels. Maintaining secure ciphers protects against potential breaches and enhances trust with customers and stakeholders.
  description: This rule checks if the OCI Load Balancer is configured to use secure SSL ciphers, preventing the use of outdated or weak encryption algorithms. Verify configuration by inspecting the SSL policy associated with the load balancer and ensuring it uses Oracle recommended secure ciphers. To remediate, update the load balancer's SSL policy to a predefined secure policy or customize it to exclude insecure ciphers.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Tasks/managingloadbalancersecurity.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/pci_security/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-52r2.pdf
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.load_balancer.load_balancer.waf_acl_attached
  service: load_balancer
  resource: load_balancer
  requirement: Waf ACL Attached
  scope: load_balancer.load_balancer.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure WAF ACL is Attached to Load Balancer
  rationale: Attaching a Web Application Firewall (WAF) Access Control List (ACL) to an OCI Load Balancer is crucial for protecting web applications from common threats such as SQL injection, cross-site scripting, and DDoS attacks. Without a WAF ACL, your applications may be vulnerable to these attacks, which can lead to data breaches, service disruptions, and non-compliance with security standards like PCI-DSS and ISO 27001.
  description: This rule checks if a WAF ACL is attached to your OCI Load Balancer. A WAF ACL provides an additional layer of protection by filtering and monitoring HTTP traffic between the Internet and your load-balanced resources. To verify, navigate to the OCI Console, open the Load Balancer's details page, and ensure a WAF ACL is configured under the 'Web Application Firewall' section. For remediation, create or attach an existing WAF ACL to the Load Balancer to enhance security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/wafconfiguringacl.htm
  - https://www.pcisecuritystandards.org/pci_security/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://cloud.oracle.com/en_US/architecture/cloud-security-best-practices
- rule_id: oci.identity.user.global_admin_in_less_than_five_users
  service: identity
  resource: user
  requirement: Global Admin In Less Than Five Users
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Limit Global Admins to Enhance OCI User Security
  rationale: Having fewer than five global administrators minimizes the risk of unauthorized access and potential misuse of elevated privileges. Reducing the number of users with such extensive permissions decreases the attack surface, thus protecting sensitive data and critical infrastructure. It also aligns with compliance requirements and organizational security policies, ensuring robust identity and access management practices.
  description: This rule checks if there are fewer than five users assigned the global administrator role within OCI. Having a limited number of global admins is crucial for maintaining a secure environment, as these accounts have the ability to configure resources and manage sensitive data. To verify, review the list of users with global admin roles and ensure only necessary personnel have these permissions. Remediation involves delegating specific responsibilities to other roles or removing excess global admin privileges, adhering to the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/global-admin-best-practices/
- rule_id: oci.identity.user.policy_require_mfa_for_management_api
  service: identity
  resource: user
  requirement: Policy Require MFA For Management API
  scope: identity.user.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce MFA for Management API Access
  rationale: Requiring multi-factor authentication (MFA) for accessing the Management API significantly reduces the risk of unauthorized access to critical cloud resources. This measure protects against common threats such as credential theft and brute force attacks, thereby enhancing the overall security posture. Additionally, it helps organizations meet compliance requirements for data protection standards like PCI-DSS and ISO 27001, which mandate strong authentication controls.
  description: This rule checks whether policies are configured to enforce MFA for users accessing the OCI Management API. To verify compliance, ensure that all policies include conditions requiring MFA for API access. Remediation involves updating identity policies to include MFA requirements by using the OCI Console or CLI. This action ensures that API requests are authenticated with an additional layer of security, mitigating the risk of access by compromised credentials.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm#To-create-or-update-API-keys
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/identitypolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-63/rev-3/final
- rule_id: oci.identity.user.policy_user_consent_for_verified_apps
  service: identity
  resource: user
  requirement: Policy User Consent For Verified Apps
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Require User Consent for Verified App Access
  rationale: Requiring user consent for verified applications helps mitigate unauthorized access and potential data breaches. It ensures users are aware of the applications accessing their resources, aligning with zero trust principles and enhancing security posture. This practice supports compliance with data privacy regulations by providing users control over their data sharing preferences.
  description: This rule checks if users are prompted to provide consent before verified applications can access their data in OCI. To verify, ensure that user policies require explicit consent for application access. Remediation involves updating the IAM policies to enforce user consent, ensuring only verified applications with explicit approval can access user information. Regular audits and policy reviews are recommended to maintain compliance and security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security-cloud/identity-access-management/
  - NIST SP 800-63B
  - ISO 27001:2013
  - https://www.oracle.com/cloud/cloud-security.html
- rule_id: oci.identity.user.security_defaults_enabled
  service: identity
  resource: user
  requirement: Security Defaults Enabled
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Security Defaults are Enabled for OCI Users
  rationale: Enabling security defaults for users in OCI helps protect against unauthorized access and identity theft by enforcing baseline security measures such as multi-factor authentication (MFA). This is vital for protecting sensitive data and ensuring compliance with regulatory frameworks like PCI-DSS and ISO 27001, which require robust access controls to safeguard information assets.
  description: This rule checks if security defaults are enabled for user accounts in Oracle Cloud Infrastructure. Security defaults include settings such as enforced MFA, strong password policies, and session timeouts. To verify, review user settings in the OCI Identity Console and ensure that security defaults are activated. If not configured, enable these settings to reduce the risk of compromised accounts and unauthorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/access/usingidentity.htm#SecurityDefaults
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.iso.org/standard/54534.html
  - https://cloud.oracle.com/en_US/security
- rule_id: oci.identity.user.trusted_named_locations_configured
  service: identity
  resource: user
  requirement: Trusted Named Locations Configured
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Trusted Named Locations for User Authentication
  rationale: Configuring trusted named locations for user authentication reduces the risk of unauthorized access by allowing only connections from pre-approved IP ranges. This enhances security by mitigating threats such as man-in-the-middle attacks and unauthorized access attempts from malicious actors. Compliance with regulatory standards like PCI-DSS and ISO 27001 often requires strict access controls based on location.
  description: This rule checks whether trusted named locations are configured for OCI user authentications, ensuring that access is restricted to specified geographical locations or IP ranges. To verify, review the identity policies and network settings in the OCI Console to confirm that only trusted locations are permitted. Remediation involves defining trusted IP addresses in the network policies, updating the identity policies to incorporate these trusted locations, and regularly reviewing and updating these configurations to respond to changes in the organization's security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.oracle.com/security/cloud-security.html
- rule_id: oci.events.rule.iam_group_change_notification_configured
  service: events
  resource: rule
  requirement: IAM Group Change Notification Configured
  scope: events.rule.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Notifications for IAM Group Changes Are Configured
  rationale: Monitoring IAM group changes is critical because unauthorized modifications can lead to privilege escalation and data breaches. Timely notifications enable swift response to potential threats, aligning with compliance requirements such as NIST SP 800-53 and ISO 27001 for access control monitoring. This helps maintain the principle of least privilege and prevents unauthorized access.
  description: This rule checks if Oracle Cloud Infrastructure (OCI) events are configured to notify administrators about changes in IAM groups. Specifically, it verifies that an event rule exists to capture IAM group creation, deletion, or modifications, and sends alerts via notifications. To verify, ensure that an OCI Event Rule is set with an action to trigger the OCI Notifications service. To remediate, create an event rule targeting IAM group changes and configure a notification to an appropriate channel such as email or Slack.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://www.oracle.com/a/ocom/docs/cis-oracle-cloud-infrastructure-foundations-benchmark.pdf
  - NIST SP 800-53 AC-2(4) - Account Management
  - ISO 27001 A.9.1.2 - Access Control Management
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.events.rule.cloud_guard_problem_notification_configured
  service: events
  resource: rule
  requirement: Cloud Guard Problem Notification Configured
  scope: events.rule.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Cloud Guard Problem Notifications are Configured
  rationale: Configuring Cloud Guard problem notifications is crucial for timely detection and response to potential security incidents. Without proper notification mechanisms, security teams may miss critical alerts, leading to delayed mitigation actions and increased risk of data breaches or non-compliance with regulatory standards such as GDPR and ISO 27001.
  description: This rule checks whether Oracle Cloud Infrastructure (OCI) Cloud Guard problem notifications are configured using the Events service. It verifies that an event rule exists to trigger notifications when Cloud Guard detects a problem. To ensure compliance and security posture, configure an event rule to send alerts to a monitored channel such as email or a third-party service like Slack. Remediation involves creating or updating event rules in OCI to include Cloud Guard problem notifications.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/using-cloud-guard.html
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.events.rule.event_rule_idp_group_mapping_notification_configured
  service: events
  resource: rule
  requirement: Event Rule Idp Group Mapping Notification Configured
  scope: events.rule.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure IdP Group Mapping Notification is Configured in OCI Events
  rationale: Proper configuration of IdP group mapping notifications is crucial for monitoring changes in identity provider group mappings, which can impact access management and security posture. This ensures that any unauthorized changes are quickly detected, reducing the risk of privilege escalation and unauthorized access, while also supporting compliance with regulatory requirements like NIST and SOC2.
  description: This rule checks whether notifications are configured for changes in IdP group mappings within OCI Events. It ensures that an event rule is in place to trigger a notification when a group mapping is altered, thereby enabling timely incident response. To verify, ensure an event rule with the appropriate condition and action is set up in the OCI console. Remediation involves creating a notification rule that listens for 'UpdateGroupMapping' events and triggers alerts through an appropriate channel.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/identityprereqs.htm
  - https://www.nist.gov/cyberframework
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/soc2reportingframework.html
- rule_id: oci.events.rule.iam_user_change_notification_event_rule_configured
  service: events
  resource: rule
  requirement: IAM User Change Notification Event Rule Configured
  scope: events.rule.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure IAM User Change Events Trigger Notifications
  rationale: Configuring notifications for IAM user changes is crucial for maintaining a secure cloud environment, as it helps detect unauthorized changes, insider threats, and potential breaches. Monitoring these changes supports compliance with standards like PCI-DSS and ISO 27001, which require visibility into access management activities.
  description: This rule checks whether an OCI Events rule is configured to trigger notifications for any IAM user changes, such as creation, deletion, or modification. Proper configuration involves setting up an event that listens for IAM changes and routes alerts to the appropriate channels (e.g., email, Oracle Functions). To verify, ensure the event source is set to 'oracle.identitycloudservice' and the condition specifies user change activities. Remediation involves creating or updating an event rule that captures these changes and sends notifications to security teams in real-time.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/iamctl.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security.html
- rule_id: oci.events.rule.identity_provider_change_notification_configured
  service: events
  resource: rule
  requirement: Identity Provider Change Notification Configured
  scope: events.rule.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Identity Provider Change Notification Setup
  rationale: Configuring notifications for identity provider changes is crucial to detect unauthorized modifications, which could lead to compromised authentication processes. This is essential for maintaining the integrity of user access controls and compliance with regulations such as NIST SP 800-53 and PCI-DSS, which mandate monitoring of identity-related activities.
  description: This rule checks if an OCI Events rule is configured to notify administrators of changes to identity provider configurations. The rule should trigger events that alert security personnel when modifications occur, enabling prompt response to potential security incidents. To verify, ensure an event rule is set up with a condition matching 'IdentityProvider' changes and an action that sends notifications to a designated email or system. Remediate by creating or updating an event rule in the OCI Console under 'Event Rules' with appropriate conditions and actions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingIDPs.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://cloud.oracle.com/compliance
- rule_id: oci.events.rule.route_table_change_notification_configured
  service: events
  resource: rule
  requirement: Route Table Change Notification Configured
  scope: events.rule.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Configure Notifications for Route Table Changes
  rationale: Monitoring changes to route tables is crucial as unauthorized modifications can lead to traffic hijacking, data breaches, or service disruptions. By configuring notifications, organizations can swiftly detect and respond to such changes, ensuring compliance with regulatory frameworks such as PCI-DSS and SOC2, which mandate the monitoring and logging of network infrastructure changes.
  description: This rule checks if notifications are configured for route table changes in OCI. It ensures that an event rule triggers when a route table is modified, allowing administrators to receive alerts via email, Slack, or other supported channels. To verify, check the OCI Event Service to ensure a rule exists for 'UpdateRouteTable'. Remediation involves creating or updating an event rule to trigger notifications on route table changes, using the OCI console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingroutetables.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_securitybestpractices.htm
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.events.rule.rule_iam_policy_change_notification_enabled
  service: events
  resource: rule
  requirement: Rule IAM Policy Change Notification Enabled
  scope: events.rule.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enable IAM Policy Change Notification via Events
  rationale: Monitoring IAM policy changes is crucial for identifying unauthorized access modifications that could lead to privilege escalation or data breaches. Timely notifications help organizations maintain compliance with frameworks such as NIST and PCI-DSS by ensuring that any changes to access permissions are immediately reviewed and validated.
  description: This rule ensures that an OCI Event Rule is configured to send notifications whenever IAM policies are changed. It checks for the existence of an event rule set to trigger on 'UpdatePolicy' actions in the Oracle Cloud Infrastructure. To verify, review your Event Rules in the OCI console under the 'Events' service to ensure a rule is configured with the appropriate action. Remediation involves creating or updating an event rule to send alerts to a designated notification service, such as Oracle Cloud Notifications, when IAM policies are altered.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/iam-policy-change-detection.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.events.rule.rule_identity_signon_local_auth_notification_configured
  service: events
  resource: rule
  requirement: Rule Identity Signon Local Auth Notification Configured
  scope: events.rule.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Configure Local Auth Signon Notifications in OCI
  rationale: Failure to configure notifications for local authentication signons can lead to undetected unauthorized access attempts, posing significant security threats to sensitive business data. It helps in identifying potential breaches early, ensuring compliance with security frameworks like PCI-DSS and SOC2, and maintaining the integrity of identity management processes.
  description: This rule checks whether notifications are configured for local authentication signons in OCI. Proper configuration involves setting up event rules to trigger notifications when local signons occur, enabling real-time monitoring of access activities. To verify, ensure that an OCI event rule is created with conditions targeting local authentication signons and actions that send alerts to administrators. Remediation involves setting up such event rules using Oracle Cloud's Event service to monitor and alert on suspicious signon activities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm
  - CIS Oracle Cloud Infrastructure Foundations Benchmark
  - 'NIST SP 800-53: AC-2 Account Management'
  - 'PCI-DSS Requirement 10: Track and monitor all access'
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.events.rule.rule_network_gateway_change_notification_configured
  service: events
  resource: rule
  requirement: Rule Network Gateway Change Notification Configured
  scope: events.rule.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Network Gateway Change Notifications are Configured
  rationale: Configuring notifications for network gateway changes in OCI is vital to promptly detect unauthorized modifications, which may lead to potential security breaches or compliance violations. It helps maintain the integrity of your network infrastructure by ensuring that all changes are logged and reviewed, reducing the risk of unauthorized access or data exfiltration.
  description: This rule checks if an OCI Events rule is set up to send notifications when changes occur to network gateways. It verifies that the event rule is correctly configured to trigger alerts for resource changes, such as creation, update, or deletion of gateways. To remediate, create an OCI Events rule that listens for changes in the network gateway resources and configure it to send notifications via OCI Notifications, ensuring that responsible teams are alerted in real-time.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-1-1-0.htm
  - https://www.pcisecuritystandards.org
  - https://www.nist.gov
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/bestpractices.htm
- rule_id: oci.events.rule.rule_nsg_change_notification_configured
  service: events
  resource: rule
  requirement: Rule Nsg Change Notification Configured
  scope: events.rule.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Monitor NSG Changes via Event Rule Notifications
  rationale: Monitoring Network Security Group (NSG) changes is crucial for maintaining network security posture and ensuring unauthorized modifications do not go unnoticed, which could lead to exposure of sensitive resources. It supports regulatory compliance by providing an audit trail of changes, aligning with frameworks requiring change monitoring.
  description: This rule checks if an Oracle Cloud Infrastructure event rule is configured to notify administrators of changes to Network Security Groups. By setting up notifications, organizations can quickly respond to unauthorized or accidental changes. To verify, ensure an OCI event rule exists that triggers notifications upon NSG changes, and that it is integrated with OCI Notification Service to alert relevant personnel. Remediation involves creating or updating the event rule to include NSG change events and configuring a notification endpoint.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networksecuritygroups.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
- rule_id: oci.events.rule.rule_vcn_change_notification_configured
  service: events
  resource: rule
  requirement: Rule Vcn Change Notification Configured
  scope: events.rule.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure VCN Change Notifications Are Configured
  rationale: Monitoring changes to Virtual Cloud Networks (VCNs) is critical for detecting unauthorized modifications that could lead to network exposure or data breaches. Configuring notifications for VCN changes enhances visibility into your network architecture, aids in maintaining compliance with industry regulations like PCI-DSS which emphasizes network security, and helps promptly address potential security incidents.
  description: This rule checks for the configuration of event rules that trigger notifications upon any changes to Virtual Cloud Networks (VCNs) in OCI. It requires setting up an OCI Event rule that listens for changes in VCN configurations and sends alerts via Oracle Notification Service (ONS) or other supported channels. To verify, ensure that event rules are defined with appropriate conditions and action targets. Remediation involves creating or updating event rules in the OCI console to monitor VCN changes and configure notification channels effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.events.rule.security_list_change_notification_configured
  service: events
  resource: rule
  requirement: Security List Change Notification Configured
  scope: events.rule.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Monitor Security List Changes with OCI Events
  rationale: Monitoring changes to security lists is crucial for identifying unauthorized modifications that might expose critical resources to risks such as unauthorized access or data breaches. Timely alerts enable rapid response to potential threats, ensuring compliance with security standards and protecting organizational assets.
  description: This rule checks that an OCI Event rule is configured to send notifications for any changes to security lists. Such configurations typically involve using the OCI Events service to trigger a notification to a configured destination, such as an OCI Notifications topic, whenever a security list is modified. To verify, ensure an event rule exists with the event type 'com.oraclecloud.networking.securitylist.update' and a corresponding action to notify. Remediation includes setting up a rule with the appropriate event type and configuring a notification destination for alerts.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Events/Tasks/creatingevents.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam_trusted_advisor.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.file_storage.file_system.storage_encryption_enabled
  service: file_storage
  resource: file_system
  requirement: Storage Encryption Enabled
  scope: file_storage.file_system.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure File Storage Encryption at Rest is Enabled
  rationale: Enabling encryption at rest for file systems in OCI mitigates the risk of unauthorized access to sensitive data, protecting against potential data breaches. It is critical for maintaining data confidentiality and integrity, especially for organizations handling sensitive information subject to regulatory compliance such as PCI-DSS or HIPAA. Encryption at rest ensures that even if physical storage media are compromised, the data remains unreadable and secure.
  description: This rule checks if file systems in Oracle Cloud Infrastructure's File Storage service are configured with storage encryption enabled. Encryption is automatically provided using Oracle-managed keys by default. To verify, ensure that the file system has encryption settings enabled within the OCI Console under File Storage details. If not enabled, reconfigure the file system to enable encryption, aligning with best practices for data protection and compliance with industry standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Concepts/filestorageoverview.htm#Encryption
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://csrc.nist.gov/publications/detail/sp/800-111/final
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.file_storage.file_system.storage_file_system_cmk_encryption_enabled
  service: file_storage
  resource: file_system
  requirement: Storage File System CMK Encryption Enabled
  scope: file_storage.file_system.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable CMK Encryption for OCI File Storage
  rationale: Enabling Customer-Managed Key (CMK) encryption for OCI File Storage enhances data protection and mitigates risks of unauthorized data access by providing greater control over encryption keys. It helps meet compliance requirements such as GDPR, HIPAA, and PCI-DSS by ensuring that sensitive data is encrypted at rest with keys managed by the customer, reducing the risk of data breaches and ensuring data privacy.
  description: This rule checks if Customer-Managed Key (CMK) encryption is enabled for Oracle Cloud Infrastructure File Storage systems. CMK encryption uses keys from Oracle Cloud Infrastructure Vault, providing users with control over key rotation and lifecycle. To verify, ensure that file systems are configured to use CMKs for encryption in the OCI Console under File Storage settings. Remediation involves creating or using an existing CMK in the OCI Vault and applying it to the file system for encryption.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Tasks/encryptingfilesystems.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm#encryption
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.file_storage.file_system.storage_have_backup_enabled
  service: file_storage
  resource: file_system
  requirement: Storage Have Backup Enabled
  scope: file_storage.file_system.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: medium
  title: Ensure File System Backups are Enabled in OCI File Storage
  rationale: Enabling backups for file systems in OCI mitigates the risk of data loss due to accidental deletions, ransomware attacks, or system failures. It is crucial for business continuity and compliance with data protection regulations such as GDPR, HIPAA, and PCI-DSS, which mandate the safeguarding of critical data through reliable backup mechanisms.
  description: This rule checks whether automatic backups are enabled for OCI file systems. Regular backups ensure that data can be restored in case of corruption or loss. To verify, navigate to the OCI Console, select the File Storage service, and check the backup settings for each file system. To remediate, configure automatic daily backups by enabling the 'Automatic Backups' option under file system settings. Ensure that backup policies align with your organization's data retention and recovery objectives.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Tasks/usingbackups.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.functions.application.invoke_api_operations_audit_logging_enabled
  service: functions
  resource: application
  requirement: Invoke API Operations Audit Logging Enabled
  scope: functions.application.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Audit Logging for OCI Functions Application Invoke API
  rationale: Enabling audit logging for OCI Functions applications ensures that all invoke API operations are tracked and recorded, which is crucial for detecting unauthorized access and potential misuse. This logging provides accountability and traceability, which are essential for meeting regulatory compliance requirements such as GDPR and PCI-DSS, and helps in forensic investigations and operational troubleshooting.
  description: This rule checks if audit logging is enabled for invoke API operations on OCI Functions applications. Specifically, it verifies that logging is configured to capture invoke API calls to ensure visibility into application interactions and access patterns. To remediate, enable audit logging by navigating to the OCI Logging service and setting up log groups and log objects that capture function invocation details. Ensure that these logs are actively monitored and archived for compliance and security purposes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionslogging.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/logging_and_monitoring.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.oracle.com/security/cloud-security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v4/
- rule_id: oci.artifacts.container_repository.container_scanning_enabled
  service: artifacts
  resource: container_repository
  requirement: Container Scanning Enabled
  scope: artifacts.container_repository.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Container Scanning is Enabled for OCI Repositories
  rationale: Enabling container scanning in OCI container repositories is crucial for identifying vulnerabilities in container images, which can prevent potential exploits and security breaches. This practice reduces the risk of deploying compromised images into production environments, thus safeguarding sensitive data and maintaining compliance with security standards such as PCI-DSS and ISO 27001.
  description: This rule checks if container scanning is enabled for repositories in OCI to detect vulnerabilities in container images. To verify, navigate to the OCI Console, access the 'Artifacts' section, and ensure 'Container Scanning' is activated for your repositories. Remediation involves enabling the scanning feature, which can be done through the OCI Console or via the OCI CLI, to ensure continuous monitoring and security posture improvement.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Registry/Tasks/registrymanagingrepos.htm
  - https://docs.oracle.com/en-us/iaas/Content/Registry/Concepts/registryoverview.htm
  - CIS OCI Foundations Benchmark
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-190/final
- rule_id: oci.data_catalog.catalog.etl_jobs_logging_enabled
  service: data_catalog
  resource: catalog
  requirement: Etl Jobs Logging Enabled
  scope: data_catalog.catalog.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure ETL Jobs Logging is Enabled in Data Catalog
  rationale: Enabling logging for ETL jobs in OCI Data Catalog is crucial for tracking data transformations and transfers, which helps in identifying unauthorized access or anomalies. Without proper logging, it becomes challenging to trace incidents, potentially leading to data breaches and non-compliance with regulations such as GDPR and CCPA, which mandate thorough data management and traceability.
  description: This rule verifies that logging is enabled for ETL jobs within the OCI Data Catalog service. To ensure compliance, all ETL jobs should have logging configured to capture detailed activity logs. Administrators can verify this by checking the logging settings in the OCI Console under the Data Catalog service. Remediation involves enabling logging through the console or OCI CLI, ensuring logs are directed to the appropriate Logging service and retained for the necessary duration as per organizational policy.
  references:
  - https://docs.oracle.com/en-us/iaas/data-catalog/doc/using-data-catalog.html
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_cis/
  - https://www.oracle.com/security/cloud-security/audit/
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- rule_id: oci.cloud_guard.target.is_enabled
  service: cloud_guard
  resource: target
  requirement: Is Enabled
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Cloud Guard Target is Enabled for Security Monitoring
  rationale: Enabling Cloud Guard targets is crucial for comprehensive security monitoring within Oracle Cloud Infrastructure (OCI). Without active monitoring, potential threats and vulnerabilities might go undetected, leading to data breaches, compliance violations, and financial losses. Enabling this feature helps in maintaining visibility over your cloud resources, ensuring they adhere to security and compliance requirements like NIST and ISO 27001.
  description: This check verifies that Cloud Guard targets are enabled in your OCI environment. Cloud Guard is a critical security service that continuously monitors your OCI resources for malicious activities and vulnerabilities. To verify, navigate to the OCI Console, select 'Cloud Guard', and ensure that each target is marked as 'Enabled'. If any target is not enabled, update its configuration to activate monitoring. This proactive step ensures your cloud resources are under constant surveillance for security threats.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/using/cloud-guard-overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/home.htm
  - https://www.oracle.com/security/cloud-security/identity-security.html
- rule_id: oci.cloud_guard.target.high_severity_findings_blocked
  service: cloud_guard
  resource: target
  requirement: High Severity Findings Blocked
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure High Severity Findings Are Mitigated in OCI Cloud Guard
  rationale: High severity findings in OCI Cloud Guard indicate potential vulnerabilities or misconfigurations that could lead to data breaches, unauthorized access, or service disruptions. Addressing these findings promptly is essential to maintaining the integrity and security of cloud resources, ensuring compliance with industry regulations such as PCI-DSS and ISO 27001, and protecting against evolving threat landscapes.
  description: This check verifies whether high severity findings identified by OCI Cloud Guard are actively being addressed and mitigated. It requires configuring Cloud Guard targets to automatically respond to such findings by applying appropriate remediation measures. You can verify this by navigating to the Cloud Guard dashboard and ensuring that all high severity findings have corresponding remediation actions configured. To remediate, ensure that automatic responder rules or manual interventions are set up to handle high severity alerts effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/use-cases.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.identity.user.account_access_approval_enabled
  service: identity
  resource: user
  requirement: Account Access Approval Enabled
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure User Account Access Approval is Enabled
  rationale: Enabling account access approval minimizes the risk of unauthorized access to user accounts by requiring an additional layer of verification, which is crucial for protecting sensitive information and systems. This practice helps mitigate security threats like unauthorized data access and identity theft, thereby supporting compliance with regulations such as PCI-DSS and ISO 27001.
  description: This rule checks if account access approval is enabled for users within OCI Identity and Access Management (IAM). It requires that any request to access user accounts undergo a review and approval process before access is granted. To verify, navigate to the OCI Console, access the Identity section, and ensure that access policies enforce approval requirements for user account access. Remediation involves configuring IAM policies to mandate access approval workflows, enhancing security by ensuring all access requests are scrutinized.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://www.oracle.com/security-cloud/cis-benchmarks/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.identity.user.audit_logs_enabled
  service: identity
  resource: user
  requirement: Audit Logs Enabled
  scope: identity.user.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure User Audit Logs are Enabled in OCI Identity
  rationale: Enabling audit logs for users is crucial for tracking actions and changes within Oracle Cloud Infrastructure. This provides visibility into user activities, which helps in identifying unauthorized access attempts, policy violations, or configuration changes. It also supports compliance with regulations such as GDPR, PCI-DSS, and SOC 2, where maintaining detailed logs is a requirement for auditing purposes.
  description: This rule verifies if audit logs are enabled for user activities in OCI Identity. It checks the configuration to ensure that audit logging is active, capturing events related to user actions. To verify, navigate to the OCI Console, go to the 'Audit' service, and check if logs are being generated for user activities. Remediation involves enabling audit logs through the OCI Console or CLI, ensuring all relevant user activities are logged for security and compliance monitoring.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - CIS Oracle Cloud Infrastructure Foundations Benchmark
  - NIST SP 800-53 Revision 5
  - PCI-DSS Requirement 10
  - SOC 2 Trust Services Criteria
  - ISO/IEC 27001:2013
- rule_id: oci.identity.user.cloud_asset_inventory_enabled
  service: identity
  resource: user
  requirement: Cloud Asset Inventory Enabled
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Cloud Asset Inventory is Enabled for Users
  rationale: Enabling Cloud Asset Inventory for users is crucial for maintaining visibility into asset usage and permissions within OCI, reducing the risk of unauthorized access and potential data breaches. It supports compliance with regulatory requirements by ensuring that asset changes are monitored and recorded, providing audit trails necessary for demonstrating governance.
  description: This rule verifies that the Cloud Asset Inventory feature is enabled for all users in the OCI environment. It checks if asset tracking is configured correctly, allowing for real-time monitoring of resources associated with user identities. To remedy non-compliance, administrators should enable asset inventory under the Identity and Access Management service by navigating to the user settings and toggling the Cloud Asset Inventory option. This ensures that asset activities are logged and monitored effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.oracle.com/cloud/cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.identity.user.database_passwords_check_rotation
  service: identity
  resource: user
  requirement: Database Passwords Check Rotation
  scope: identity.user.key_rotation
  domain: secrets_and_key_management
  subcategory: key_management
  severity: medium
  title: Ensure Timely Rotation of User Database Passwords
  rationale: Regular rotation of database passwords mitigates the risk of unauthorized access due to compromised credentials. It reduces the attack surface by limiting the time window in which credentials are valid, thus enhancing the security posture of the organization and aligning with compliance requirements such as PCI-DSS and ISO 27001.
  description: This rule checks whether users' database passwords in OCI are rotated regularly, as per organizational and compliance standards. It involves verifying the password rotation policy settings within the OCI Identity and Access Management (IAM) service. To remediate, configure IAM policies to enforce password expiration and rotation at regular intervals, typically every 90 days. This can be achieved by using password policies in the OCI Console under the Identity Management settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm#Managing_Passwords
  - https://www.oracle.com/security/cloud-security/cloud-compliance/oci-cis-benchmark.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.identity.user.group_policy_oke_admin_required_permissions
  service: identity
  resource: user
  requirement: Group Policy Oke Admin Required Permissions
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure OKE Admin Group Policy Has Required Permissions
  rationale: Proper permissions for Oracle Kubernetes Engine (OKE) administrators are crucial to prevent unauthorized access and potential misuse of cluster resources. Misconfigured permissions can lead to security breaches, data exposure, and non-compliance with industry standards such as PCI-DSS and ISO 27001. Ensuring the correct OKE admin permissions helps maintain the integrity of the cloud environment and aligns with governance and compliance mandates.
  description: This rule checks if the group policy assigned to OKE administrators includes all necessary permissions to manage Kubernetes clusters effectively. Verify that the policy grants 'MANAGE' permissions for OKE-related resources, including clusters, node pools, and virtual networks. To remediate, update the group policy in the OCI Console to include required permissions, ensuring that OKE admins can perform all necessary actions without excessive privileges. Regular audits and updates to these policies help maintain security and compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingdynamicgroups.htm
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengpolicyconfig.htm
  - CIS OCI Benchmark v1.1.0 - Section 1.6
  - NIST SP 800-53 Rev. 5 AC-5
  - PCI-DSS v3.2.1 - Requirement 7
  - https://cloud.oracle.com/containers/kubernetes-engine
- rule_id: oci.identity.user.group_policy_verification
  service: identity
  resource: user
  requirement: Group Policy Verification
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Verify User Group Policies for Role Compliance
  rationale: Ensuring users are assigned to appropriate groups and their policies are verified reduces the risk of unauthorized access and data breaches. Misconfigured group policies can lead to privilege escalation and access to sensitive resources, impacting compliance with regulations like PCI-DSS and ISO 27001.
  description: This rule checks that users are correctly associated with groups that have well-defined policies aligning with their job roles. It involves auditing user-group associations and ensuring that group policies grant the least privilege required. Remediation includes reviewing user roles, ensuring proper group assignments, and updating policies to match organizational security requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/accesscontrol/managingpolicies.htm
  - https://docs.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- rule_id: oci.identity.user.group_service_level_admin_policy_enforced
  service: identity
  resource: user
  requirement: Group Service Level Admin Policy Enforced
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Enforce Group Service Level Admin Policy for Users
  rationale: Enforcing group service level admin policies mitigates the risk of unauthorized access and privilege escalation, ensuring that only designated users can access and manage critical resources. This is crucial for maintaining a secure cloud environment, protecting sensitive data, and meeting regulatory compliance requirements such as PCI-DSS and SOC2.
  description: This rule checks if users are correctly assigned to groups with the appropriate service level admin policies in Oracle Cloud Infrastructure. It verifies the application of least privilege by ensuring users do not have excessive permissions. To remediate, review user group assignments and ensure policies are applied in line with organizational security requirements. Use OCI Identity and Access Management (IAM) to manage and audit group policies effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managinggroups.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/sorhome.html
- rule_id: oci.identity.user.local_user_credentials_inactive_45_days_disabled
  service: identity
  resource: user
  requirement: Local User Credentials Inactive 45 Days Disabled
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Disable Inactive Local User Credentials After 45 Days
  rationale: Inactive user credentials pose a significant security risk as they may be exploited by unauthorized individuals to gain access to sensitive data and resources. Disabling credentials that have not been used for an extended period reduces the attack surface and aligns with best practices for identity and access management, helping to meet compliance requirements for frameworks like NIST and ISO 27001.
  description: This rule checks for local user credentials in Oracle Cloud Infrastructure that have been inactive for more than 45 days and ensures they are disabled. To verify compliance, audit user access logs and disable any credentials that have not been used within the specified period. Remediation involves regularly reviewing user activity and automating the disabling of inactive credentials using OCI's Identity and Access Management (IAM) policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/standard/54534.html
  - https://www.oracle.com/security/cloud-security.html
  - https://www.oracle.com/cis/oci-identity-security-guide.pdf
- rule_id: oci.identity.user.organization_essential_contacts_configured
  service: identity
  resource: user
  requirement: Organization Essential Contacts Configured
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Configure Organization Essential Contacts for Users
  rationale: Configuring essential contacts for users in OCI helps ensure timely communication in critical scenarios, such as security incidents or service disruptions. Lack of such configuration can lead to delayed response times, increased risk of data breaches, and non-compliance with regulatory requirements that mandate prompt incident reporting.
  description: This rule checks whether essential contact information is configured for users within an OCI organization. Essential contacts include email addresses and phone numbers that are necessary for incident management and alert notifications. To verify, navigate to the OCI Console, select Identity, then Users, and ensure that essential contact fields are populated. Remediation involves updating user profiles with complete contact information, following Oracle's guidelines for user management.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://www.oracle.com/security/cis-oracle-cloud-infrastructure-foundations-benchmark-1-0-0.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security-cloud.html
- rule_id: oci.identity.user.password_policy_prevent_reuse
  service: identity
  resource: user
  requirement: Password Policy Prevent Reuse
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Prevent Password Reuse in OCI User Accounts
  rationale: Implementing a password reuse policy is crucial to mitigate the risk of credential stuffing and brute-force attacks. By preventing users from reusing previous passwords, organizations can enhance their security posture, reduce the likelihood of unauthorized access, and meet regulatory requirements such as NIST SP 800-53 and PCI-DSS that mandate strong password policies.
  description: This rule checks if your OCI identity user accounts have a password policy that prevents the reuse of previous passwords. To verify, navigate to the Identity and Access Management service in the OCI Console, and ensure the password policy settings include restrictions on reusing a set number of previous passwords. If needed, configure the policy to enforce this restriction, typically found under the 'Password Policy' settings. This helps maintain strong authentication practices and protects against potential security breaches.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm#Password_Policies
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/securitybestpractices.htm
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.policy_admin_group_only_all_resources_management
  service: identity
  resource: user
  requirement: Policy Admin Group Only All Resources Management
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Policy Management to Admin Group in OCI
  rationale: Ensuring that only designated admin groups manage policies in OCI minimizes the risk of unauthorized access and potential data breaches. This restriction mitigates the threat of privilege escalation and policy misuse, which can lead to significant financial loss and compliance violations, particularly in regulated industries.
  description: This rule checks that only users within a designated admin group have permissions to manage OCI policies for all resources. Verify that policy management permissions are not granted to users outside the admin group by reviewing IAM policies. Remediation involves revoking unauthorized policy management permissions and consolidating such operations within a trusted admin group to maintain control over access management.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - CIS Oracle Cloud Infrastructure Foundations Benchmark v1.0.0 - 1.6 Ensure that no users have 'Manage All Resources' policy
  - NIST SP 800-53 Rev. 5 - AC-1 Access Control Policy and Procedures
  - 'PCI DSS v3.2.1 - Requirement 7: Restrict access to cardholder data by business need to know'
  - ISO/IEC 27001:2013 - A.9.1.2 Access to networks and network services
- rule_id: oci.identity.user.policy_storage_admin_delete_permission_restricted
  service: identity
  resource: user
  requirement: Policy Storage Admin Delete Permission Restricted
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Delete Permissions for Storage Admin Policies
  rationale: Allowing unrestricted delete permissions for Storage Admins can lead to accidental or malicious deletion of critical data, resulting in business disruptions, data loss, and potential non-compliance with data protection regulations. Limiting these permissions helps mitigate the risk of insider threats and unauthorized access.
  description: This rule checks for overly permissive policies that allow users with Storage Admin roles to delete resources without additional controls. It ensures that delete actions require explicit permissions, minimizing the risk of data loss. To verify, review policy statements in the OCI Console under Identity and Access Management. Remediation involves adjusting policies to restrict delete permissions, using the principle of least privilege and incorporating approval workflows where possible.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policyreference.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/iam-security-best-practices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.policy_users_groups_admin_group_modification_restricted
  service: identity
  resource: user
  requirement: Policy Users Groups Admin Group Modification Restricted
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Admin Group Policy Modifications
  rationale: Restricting modifications to admin group policies prevents unauthorized elevation of privileges, reducing the risk of insider threats and accidental exposure of sensitive data. It is crucial for maintaining the principle of least privilege and adhering to compliance mandates such as PCI-DSS and ISO 27001, which require strict access control measures.
  description: This rule checks for unauthorized attempts to modify policies related to user groups classified as admin within OCI. Ensuring that only designated security personnel can alter these policies safeguards against privilege escalation and data breaches. Verify by auditing policy modification logs in the OCI console and implement a least privilege model by restricting 'Policy Management' roles to a minimal set of trusted users. Remediation involves reviewing and revising IAM policies to enforce these restrictions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/policiescommon.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.identity.user.role_kms_enforce_separation_of_duties
  service: identity
  resource: user
  requirement: Role KMS Enforce Separation Of Duties
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enforce Separation of Duties for KMS Roles
  rationale: Separation of duties is crucial to minimize the risk of unauthorized access and potential data breaches. By ensuring that different individuals manage key management and operational activities, organizations can reduce the risk of insider threats and comply with regulatory requirements like ISO 27001 and PCI-DSS that mandate role separation as a security control.
  description: This rule checks if OCI users with access to Key Management Service (KMS) roles have been assigned in a manner that enforces separation of duties. Specifically, it verifies that roles related to key creation, management, and usage are distributed among different users to prevent any single user from having complete control over encryption keys. To remediate, review user roles in OCI Identity and Access Management and adjust policies to ensure that no single user holds conflicting roles related to KMS operations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/home.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.identity.user.role_sa_enforce_separation_of_duties
  service: identity
  resource: user
  requirement: Role Sa Enforce Separation Of Duties
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enforce Separation of Duties for OCI Identity User Roles
  rationale: Separation of duties is critical in reducing the risk of malicious activity and insider threats by ensuring no single individual has control over all critical aspects of any significant operation. This principle helps prevent potential security breaches and supports compliance with regulations like SOX and GDPR, which mandate the segregation of duties to protect sensitive information and maintain integrity.
  description: This rule checks that OCI identity user roles are configured to enforce the separation of duties, ensuring that administrative privileges are not concentrated within a single user account. To verify, review user roles and ensure no single user has overlapping permissions that could enable both the execution and approval of critical actions. Remediation involves adjusting IAM policies to segregate roles, such as separating administrative and auditor duties, and leveraging OCI's policy inheritance and compartment structures to enforce these separations effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmark/
  - https://www.nist.gov/publications/separation-duties-and-least-privilege
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/standard/54534.html
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
- rule_id: oci.identity.user.root_compartment_default_tags_configured
  service: identity
  resource: user
  requirement: Root Compartment Default Tags Configured
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure Default Tags Configured for Root Compartment Users
  rationale: Configuring default tags for users in the root compartment is crucial for maintaining consistent resource tagging across the organization, enabling accurate cost tracking, and enforcing security policies. Without these configurations, there is an increased risk of non-compliance with organizational policies, leading to potential unauthorized access and unmanaged resources.
  description: This rule checks whether default tags are configured for users in the root compartment of Oracle Cloud Infrastructure. Default tags help automate the tagging process, ensuring all resources created by users inherit organizationally required tags. To verify, navigate to the Identity and Access Management settings in the OCI console, and ensure that default tags are set for the root compartment. Remediation involves accessing the 'Tag Default' settings and assigning necessary tags to be applied by default.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingtags.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/taggingoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/document_library
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.sa_no_administrative_privileges
  service: identity
  resource: user
  requirement: Sa No Administrative Privileges
  scope: identity.user.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Administrative Privileges for Service Accounts
  rationale: Service accounts with administrative privileges pose a significant security risk as they can be exploited to gain unauthorized access to critical resources, leading to potential data breaches or service disruptions. Ensuring these accounts do not have administrative privileges minimizes attack surfaces and aligns with the principle of least privilege, which is crucial for compliance with standards like ISO 27001 and NIST.
  description: This rule checks whether service accounts (SAs) are assigned any administrative roles or policies that grant elevated permissions within OCI. Service accounts should only have the necessary permissions to perform their intended functions. To remediate, review the IAM policies and remove any broad permissions, especially those granting administrative access, by using the Oracle Cloud Console or OCI CLI. Regularly audit these accounts to ensure compliance with least privilege principles.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.oracle.com/cloud/cloud-security/best-practices/
- rule_id: oci.identity.user.service_roles_at_project_level
  service: identity
  resource: user
  requirement: Service Roles At Project Level
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Limit User Service Roles to Necessary Project Level Access
  rationale: Restricting service roles at the project level is crucial to minimize the risk of unauthorized access and potential data breaches. Excessive permissions can lead to privilege escalation, increasing the attack surface and potential compliance violations with frameworks like NIST and ISO 27001, which mandate least privilege principles. This practice also helps in aligning with business policies that enforce controlled access to sensitive project resources.
  description: This rule evaluates whether users have been granted only necessary service roles at the project level in OCI. It checks for over-provisioned roles that may not be required for a user's specified tasks. To verify compliance, review user permissions and ensure they align with project requirements. Remediation involves adjusting IAM policies to reflect the least privilege principle, ensuring users have only the access necessary for their roles. Use OCI's policy editor to modify and apply these changes effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/security/
- rule_id: oci.identity.user.tenancy_admin_users_api_keys_absent
  service: identity
  resource: user
  requirement: Tenancy Admin Users API Keys Absent
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure Tenancy Admin Users Have No API Keys
  rationale: Tenancy Admin Users with API keys pose a high security risk as they can perform unrestricted operations across the entire cloud environment. If compromised, these keys could be used to launch attacks, steal sensitive data, or disrupt services, leading to significant business impact and potential regulatory violations. Proper management of these keys is critical for maintaining control and security of the cloud infrastructure.
  description: This rule checks that Tenancy Admin Users in OCI do not possess API keys, which could be exploited if not adequately secured. To verify compliance, inspect each Tenancy Admin User's profile for the absence of API keys. Remediation involves removing any existing API keys from these users. For secure management, consider using Oracle's Identity and Access Management (IAM) features, such as multi-factor authentication (MFA) and compartmentalization, to limit access and actions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/access.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.user_api_key_rotation_within_90_days
  service: identity
  resource: user
  requirement: User API Key Rotation Within 90 Days
  scope: identity.user.key_rotation
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Mandatory User API Key Rotation Every 90 Days
  rationale: Regularly rotating user API keys mitigates the risk of unauthorized access due to key exposure or compromise. This practice is crucial in reducing the attack surface, especially given the increasing sophistication of cyber threats targeting cloud environments. It also aligns with compliance mandates such as PCI-DSS and ISO 27001 that require strict authentication controls.
  description: This rule checks whether user API keys in Oracle Cloud Infrastructure are rotated at least every 90 days. Regular rotation can be enforced by implementing automated scripts or using OCI policies to notify users of upcoming expirations. Verification involves reviewing API key creation and update timestamps via the OCI Console or CLI. To remediate, implement an automated key rotation schedule and educate users on securely managing their keys.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm#apikeys
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.identity.user.user_customer_secret_key_rotation_check_90_days
  service: identity
  resource: user
  requirement: User Customer Secret Key Rotation Check 90 Days
  scope: identity.user.key_rotation
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: User Customer Secret Key Rotation Every 90 Days
  rationale: Regular rotation of Customer Secret Keys is critical to minimize the risk of unauthorized access due to key compromise. Infrequently rotated keys can be exploited by attackers for extended periods, potentially leading to data breaches and non-compliance with security regulations such as PCI-DSS and ISO 27001. Regular rotation ensures adherence to security best practices and regulatory mandates, reducing the risk of exposure of sensitive data.
  description: This rule checks whether the Customer Secret Keys for OCI users are rotated at least every 90 days. It identifies keys that have not been rotated within this timeframe, which is crucial for maintaining the security of API interactions. To verify compliance, review the key creation and last rotation dates in the OCI Console under Identity > Users. Remediation involves generating new Customer Secret Keys and updating any applications or scripts to use the new keys, then disabling the old keys to prevent unauthorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/API/Concepts/apisigningkey.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-foundation-benchmark-v1-0-0.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.identity.user.user_email_verification
  service: identity
  resource: user
  requirement: User Email Verification
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure User Email Verification for Identity Security
  rationale: Unverified user emails in Oracle Cloud Infrastructure can lead to unauthorized access and phishing attacks, compromising sensitive data. Verifying user emails ensures that only legitimate users receive access credentials, reducing the risk of identity spoofing and enhancing compliance with security frameworks like NIST and ISO 27001.
  description: This rule checks if email verification is enforced for all users in OCI Identity and Access Management. To ensure proper authentication and prevent unauthorized access, configure the user settings to require email verification upon user creation. Remediation involves enabling the 'Require Email Verification' setting in the OCI Console under Identity settings, thereby ensuring that users can only activate their accounts through verified email addresses.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/identity-cis-landing.htm
  - https://www.nist.gov/publications/digital-identity-guidelines
  - https://www.iso.org/standard/54534.html
- rule_id: oci.identity.user.user_managed_key_unused
  service: identity
  resource: user
  requirement: User Managed Key Unused
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure User Managed Keys Are Actively Used
  rationale: Unused user-managed keys can pose a security risk as they may be overlooked during key rotation processes, potentially leading to unauthorized access if compromised. Regularly using and rotating keys is essential for maintaining control over encryption and ensuring compliance with data protection regulations such as PCI-DSS and ISO 27001.
  description: This rule checks if user-managed keys associated with OCI users are not being utilized. Inactive keys should be reviewed for necessary rotation or deletion. To verify, check the OCI Audit Logs for any activities involving the key within a specified period. Remediate by deleting unused keys or ensuring they are actively integrated into security processes, such as encrypting data-at-rest or securing communication channels.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingkeys.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/oci/
- rule_id: oci.identity.user.user_managed_keys
  service: identity
  resource: user
  requirement: User Managed Keys
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce User Managed Keys for Enhanced Authentication Security
  rationale: User managed keys provide an additional layer of security by ensuring that users are responsible for their own key management, which reduces the risk of unauthorized access due to compromised keys. This is crucial for maintaining the integrity and confidentiality of sensitive data, especially in environments subject to stringent compliance requirements such as PCI-DSS and HIPAA. Unauthorized access can lead to data breaches, regulatory fines, and loss of customer trust.
  description: This rule checks if users are utilizing their own managed keys instead of relying solely on Oracle-managed keys for authentication in OCI. Implementing user managed keys involves configuring users to generate and manage their own keys through OCI Identity and Access Management. Verification can be done by reviewing the key management settings in the OCI console. To remediate, instruct users to create and manage their own keys using the OCI Key Management service, ensuring they follow best practices such as regular key rotation and secure key storage.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
  - https://www.pcisecuritystandards.org/document_library
  - https://www.hipaajournal.com/understanding-hipaa-compliance-requirements/
  - https://cloud.oracle.com/en_US/architecture/cloud-security-best-practices
- rule_id: oci.identity.user.user_mfa_enabled
  service: identity
  resource: user
  requirement: User MFA Enabled
  scope: identity.user.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Multi-Factor Authentication is Enabled for All Users
  rationale: Enabling Multi-Factor Authentication (MFA) for users significantly reduces the risk of unauthorized access due to compromised credentials. This is crucial for protecting sensitive enterprise data and maintaining compliance with security standards such as NIST and PCI-DSS, which mandate strong authentication measures. The absence of MFA increases vulnerability to phishing attacks and account takeover scenarios.
  description: This rule verifies that all users in Oracle Cloud Infrastructure have Multi-Factor Authentication enabled. MFA requires users to provide a second form of verification, enhancing security beyond just a password. To check compliance, review the MFA settings for each user in the OCI Console under Identity > Users. If MFA is not enabled, configure it by adding an MFA factor such as a mobile authenticator app. This setup helps ensure that only authorized users can access critical resources.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm#EnableMFA
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://csrc.nist.gov/publications/detail/sp/800-63b/final
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/security/cloud-security.html#strong-authentication
- rule_id: oci.identity.user.user_single_active_api_key
  service: identity
  resource: user
  requirement: User Single Active API Key
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Users Have a Single Active API Key
  rationale: Limiting users to a single active API key reduces the attack surface for potential credential compromise. Multiple active keys increase the risk of unauthorized access and complicate key management. Ensuring a single active API key per user aligns with best practices for key lifecycle management and regulatory compliance, such as PCI-DSS, which mandates strict control over access credentials.
  description: This rule checks if each user in OCI Identity has only one active API key, mitigating risks associated with credential sprawl. Users with multiple active keys can inadvertently create security gaps. To verify compliance, inspect user profiles within the OCI Console for active API keys and disable any surplus keys. Remediation involves using the OCI Console or CLI to deactivate or delete superfluous keys, maintaining only a single active key per user while rotating keys regularly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm
  - https://docs.cisecurity.org/benchmarks.html
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/security-cloud/cloud-compliance/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.identity.user.auth_token_rotation
  service: identity
  resource: user
  requirement: Auth Token Rotation
  scope: identity.user.key_rotation
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Regular Rotation of OCI User Auth Tokens
  rationale: Regular rotation of auth tokens mitigates the risk of unauthorized access due to token compromise. It reduces exposure time for any leaked credentials, thereby safeguarding sensitive resources. Compliance with security standards like NIST and PCI-DSS often require periodic credential rotation to protect against threats such as brute force attacks and credential stuffing.
  description: This check ensures that auth tokens for OCI users are rotated regularly, adhering to best practices for credential management. To verify, review the last rotation date of user auth tokens in the OCI console and set a policy to rotate them every 90 days. Remediation involves setting automated reminders or using OCI's native tools to facilitate timely rotation, ensuring that all users follow this policy.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-63b.pdf
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.identity.user.aws_attached_policy_no_administrative_privileges
  service: identity
  resource: user
  requirement: Aws Attached Policy No Administrative Privileges
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure AWS Policies Attached to OCI Users Lack Admin Privileges
  rationale: Allowing administrative privileges through AWS-attached policies to OCI users can lead to unauthorized access and potential data breaches. This poses significant security risks, including privilege escalation and resource misuse, and can lead to non-compliance with regulatory standards such as PCI-DSS and ISO 27001.
  description: This rule checks for AWS policies attached to OCI users that grant administrative privileges. The goal is to ensure that no such policies provide broad access rights. To verify compliance, review the IAM policies attached to AWS users federated with OCI. Remediation involves auditing policy permissions and removing any excessive rights, ensuring least privilege access is enforced.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.console_mfa_enabled
  service: identity
  resource: user
  requirement: Console MFA Enabled
  scope: identity.user.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Multi-Factor Authentication is Enabled for Console Users
  rationale: Enabling Multi-Factor Authentication (MFA) for OCI console users significantly reduces the risk of unauthorized access by requiring an additional verification step beyond just a password. This is crucial for protecting sensitive data and maintaining the integrity of cloud resources. Failure to implement MFA can lead to increased exposure to phishing attacks and credential theft, potentially resulting in data breaches that can harm business operations and reputation. Moreover, MFA compliance is often required by regulatory frameworks such as NIST, PCI-DSS, and ISO 27001.
  description: This rule checks that all users accessing the OCI console have Multi-Factor Authentication enabled. Administrators should configure MFA by navigating to the OCI Console, selecting Identity, then Users, and enabling MFA for each user. Remediation involves guiding users to set up MFA using an authenticator app or hardware token. Verifying compliance entails checking that all users have completed the MFA setup process. This step is critical to enhance security posture and meet compliance obligations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm#EnableMFA
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf
  - https://www.pcisecuritystandards.org/documents/Multi-Factor-Authentication-Guidance-v1.pdf
  - https://www.iso.org/standard/54534.html
  - https://cloud.oracle.com/cloud-security
- rule_id: oci.identity.user.customer_attached_policy_no_administrative_privileges
  service: identity
  resource: user
  requirement: Customer Attached Policy No Administrative Privileges
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Users from Customer Policies with Admin Privileges
  rationale: Allowing customer-attached policies with administrative privileges to users increases the risk of unauthorized access and potential misuse of critical resources. This can lead to data breaches, regulatory non-compliance, and financial losses. Ensuring least privilege access aligns with security best practices and compliance requirements such as PCI-DSS and ISO 27001.
  description: This rule checks if any users have customer-attached policies that grant administrative privileges. It ensures that users do not have policies allowing them to perform sensitive administrative actions unless explicitly necessary. To verify, review policies attached to users for any statements that include 'manage' permissions over broad resources. Remediation involves modifying policies to adhere to least privilege principles by removing or narrowing administrative permissions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://docs.oracle.com/en/cloud/saas/learn/learning-cloud/security-best-practices.html
- rule_id: oci.identity.user.domain_password_policy_expiry_days_maximum
  service: identity
  resource: user
  requirement: Domain Password Policy Expiry Days Maximum
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Set Domain Password Expiry to Limit Credential Exposure
  rationale: Limiting the password expiry period reduces the window of opportunity for credential abuse. A shorter expiry period helps to mitigate risks such as password reuse, brute force attacks, and unauthorized access. It aligns with compliance standards like PCI-DSS and ISO 27001 that mandate regular password changes to enhance security posture.
  description: This rule checks if the domain password policy in OCI is configured to enforce a maximum expiry period, ensuring passwords are changed regularly. To verify, access the password policy settings in the OCI Console under Identity and Access Management and ensure the 'Maximum Password Age' is set to the recommended period. Remediation involves adjusting this setting to comply with organizational security policies and regulatory requirements, typically between 30 and 90 days.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation_benchmark
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.domain_password_policy_minimum_length_enforced
  service: identity
  resource: user
  requirement: Domain Password Policy Minimum Length Enforced
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enforce Minimum Password Length for Domain Users
  rationale: Ensuring a minimum password length mitigates the risk of unauthorized access by making brute-force attacks more difficult, thereby protecting sensitive information. Weak password policies can lead to account compromise, resulting in potential data breaches and non-compliance with regulatory frameworks such as PCI-DSS and ISO 27001. This policy is essential for maintaining robust security postures in cloud environments.
  description: This rule checks if a minimum password length is enforced for domain users in OCI, ensuring stronger authentication practices. Administrators should configure the domain password policy to specify a minimum password length that aligns with their security requirements, typically at least 12 characters. Verification involves reviewing the domain's password policy settings in the OCI Identity Console. To remediate, update the password policy to enforce the desired minimum length, enhancing account security against unauthorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-63b.pdf
- rule_id: oci.identity.user.dynamic_group_instance_principal
  service: identity
  resource: user
  requirement: Dynamic Group Instance Principal
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict User Access to Dynamic Group Instance Principals
  rationale: Dynamic groups allow instances to make API calls without storing credentials, reducing the risk of credential exposure. Unrestricted user access to manage these groups can lead to unauthorized resource control, increasing the likelihood of privilege escalation and data breaches. Ensuring proper controls helps comply with security standards like ISO 27001 and NIST SP 800-53.
  description: This rule checks if users are inappropriately assigned permissions to manage dynamic groups, which are intended for instance principals. Users should not have direct or indirect permissions to create, update, or delete dynamic groups unless absolutely necessary. Verify permissions through OCI IAM policies and adjust roles to restrict dynamic group management to only those roles that require it for operational purposes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingdynamicgroups.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.0_benchmark.htm
  - https://www.nist.gov/publications/security-and-privacy-controls-information-systems-and-organizations
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.identity.user.group_has_users
  service: identity
  resource: user
  requirement: Group Has Users
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Every OCI User Group Contains Active Users
  rationale: User groups in OCI should have active users to enhance security and maintain organized access control. Empty groups may lead to misconfigurations or unauthorized access if neglected. Ensuring groups have users aligns with best practices for account management and supports compliance with frameworks like NIST SP 800-53 and ISO 27001, which emphasize access control and management.
  description: This rule checks whether each user group in OCI Identity and Access Management has active users assigned. An empty user group might indicate misconfiguration or lack of effective access management. To verify, review the group memberships in the OCI Console under Identity > Groups. Remediation involves assigning appropriate users to groups or deleting unused groups to maintain a lean and secure access control structure.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managinggroups.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/security/identity-management/
- rule_id: oci.identity.user.inline_policy_no_administrative_privileges
  service: identity
  resource: user
  requirement: Inline Policy No Administrative Privileges
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure Inline Policies Do Not Grant Administrative Privileges
  rationale: Granting administrative privileges through inline policies to individual users can lead to significant security risks, including unauthorized access to critical resources and data breaches. This practice may violate compliance requirements such as PCI-DSS or HIPAA, which mandate strict access controls and accountability. Limiting administrative access reduces the attack surface and helps maintain a secure and compliant cloud environment.
  description: This rule checks whether any inline policies attached to a user grant administrative privileges within the Oracle Cloud Infrastructure. Administrators should use group-based policies to manage permissions, ensuring users are assigned the least privileges necessary. To remediate, review and adjust inline policies to remove excessive permissions and adopt a role-based access control model. Verification can be done by examining user policies via the OCI Console or CLI to ensure compliance with security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security-cloud/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
- rule_id: oci.identity.user.key
  service: identity
  resource: user
  requirement: Key
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Oracle Cloud User API Keys Are Regularly Rotated
  rationale: Regular rotation of API keys is crucial to prevent unauthorized access to Oracle Cloud resources. Compromised keys can lead to data breaches, resource misuse, and financial loss. Compliance with regulations such as PCI-DSS and ISO 27001 often requires stringent access controls, making key rotation an essential practice.
  description: This rule checks if users' API keys in OCI are rotated within a defined period. API keys older than the recommended timeframe increase the risk of exposure if leaked or compromised. Verify key age in the OCI Console under Identity and Access Management. Remediate by rotating keys regularly and implementing automated key rotation policies via OCI's IAM service.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/managingcredentials.htm
  - https://www.oracle.com/security-cloud-compliance/cis-benchmark-oci/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/standard/54534.html
  - https://cloudsecurityalliance.org/artifacts/cloud-controls-matrix-v4/
- rule_id: oci.identity.user.key_90_days
  service: identity
  resource: user
  requirement: Key 90 Days
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Rotate OCI User API Keys Every 90 Days
  rationale: Regular rotation of API keys reduces the risk of unauthorized access due to key compromise or misuse. Stale keys are a common target for attackers in credential stuffing and brute-force attacks. Ensuring keys are rotated every 90 days helps maintain the principle of least privilege and is often required by compliance frameworks such as PCI-DSS and ISO 27001.
  description: This rule checks if API keys associated with OCI users are older than 90 days. Keys that exceed this age should be rotated to minimize security risks. Administrators can verify key age in the OCI Console under the Identity section by navigating to 'Users' and selecting 'API Keys' for each user. To remediate, delete old keys and generate new ones, updating any systems or applications that use these credentials promptly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.identity.user.root_access_key_blocked
  service: identity
  resource: user
  requirement: Root Access Key Blocked
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure Root User Access Keys are Disabled
  rationale: Root user access keys present a significant security risk as they grant unrestricted access to all OCI resources. If compromised, attackers can exploit these keys to perform malicious activities, leading to data breaches, service disruptions, and financial loss. Disabling root access keys is critical for adhering to compliance standards such as NIST SP 800-53 and ISO 27001, which mandate strict controls over privileged access.
  description: This rule checks if the root user has active access keys and ensures they are disabled, as root accounts should not use access keys for any operations. To verify, navigate to the OCI Console's Identity section, select the root user's profile, and ensure no active keys are listed. Remediation involves deleting or disabling any existing access keys for the root user to prevent unauthorized access and potential security breaches.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/accessmanagement.htm#usingpolicies
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/identity-and-access-management/
- rule_id: oci.identity.user.password_policy_expires_passwords_within_90_less
  service: identity
  resource: user
  requirement: Password Policy Expires Passwords Within 90 Less
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enforce 90-Day Password Expiration Policy for Users
  rationale: Ensuring that user passwords expire within 90 days mitigates the risk of unauthorized access due to credential compromise. Regular password changes reduce the window of opportunity for attackers to exploit stolen credentials, thus enhancing the security posture of your OCI environment. This is vital for maintaining compliance with industry standards like PCI-DSS and ISO 27001, which mandate regular password updates.
  description: This rule checks that the password policy for OCI users is configured to expire passwords within 90 days or less. To verify, navigate to the Identity service in the OCI Console, and under 'Password Policy', ensure 'Password Expiration Period' is set to 90 days or fewer. If not configured correctly, update the policy to enforce a maximum 90-day expiration period. This practice minimizes exposure to potential threats by limiting the lifespan of passwords.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpasswords.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_platform
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.identity.user.password_policy_lowercase
  service: identity
  resource: user
  requirement: Password Policy Lowercase
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure User Passwords Include Lowercase Letters
  rationale: Requiring lowercase letters in user passwords enhances security by increasing password complexity, thereby reducing the likelihood of unauthorized access through brute force attacks. This policy helps protect sensitive information and aligns with compliance standards mandating strong password practices, thereby mitigating potential financial and reputational damage from security breaches.
  description: This rule checks that the password policy for OCI users mandates the inclusion of at least one lowercase letter in passwords. To verify, navigate to the OCI Console, access Identity, and review the Password Policy settings for the tenancy to ensure lowercase letters are required. Remediation involves updating the password policy to enforce this requirement, enhancing password strength and compliance with security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm#PasswordPolicy
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
- rule_id: oci.identity.user.password_policy_minimum_length_14
  service: identity
  resource: user
  requirement: Password Policy Minimum Length 14
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enforce Minimum Password Length of 14 for OCI Users
  rationale: A robust password policy, such as a minimum length of 14 characters, significantly reduces the risk of unauthorized access due to brute force attacks. Longer passwords are generally more complex and harder to crack, enhancing the security of sensitive data and resources. This practice is often a requirement for compliance with standards like NIST SP 800-63 and PCI-DSS, which mandate strong authentication controls.
  description: This rule checks whether the password policy for OCI users enforces a minimum length of 14 characters. To verify, navigate to the OCI Console, go to 'Identity & Security,' then 'Identity,' and select 'Password Policies.' Ensure the 'Minimum Password Length' is set to 14. Remediation involves updating the password policy to meet this requirement, which enhances account security by making passwords more resistant to attack.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpasswordpolicies.htm
  - https://csrc.nist.gov/publications/detail/sp/800-63/rev-3/final
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss_v4-0
  - https://www.iso.org/standard/54534.html
  - https://www.oracle.com/security-cloud/compliance/
- rule_id: oci.identity.user.password_policy_number
  service: identity
  resource: user
  requirement: Password Policy Number
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: 'Enforce Password Policy: Require Numeric Characters'
  rationale: Implementing a password policy that requires numeric characters is crucial for enhancing password complexity, reducing the risk of unauthorized access, and mitigating brute force attacks. This requirement is essential for complying with security standards and protecting sensitive data within your OCI environment from potential breaches.
  description: This rule checks if the password policy for OCI users mandates the inclusion of numeric characters in their passwords. To verify, ensure that the password policy for each user includes at least one numeric character. This can be configured in the OCI Identity Console under User Settings. Remediation involves updating the password policy to include numeric character requirements, thereby strengthening authentication mechanisms.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://www.oracle.com/security-cloud/identity-access-management/
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.nist.gov/itl/applied-cybersecurity/nist-special-publication-800-63
- rule_id: oci.identity.user.password_policy_reuse_24
  service: identity
  resource: user
  requirement: Password Policy Reuse 24
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enforce Password Reuse Limit of 24 for OCI Users
  rationale: Limiting password reuse is critical to prevent unauthorized access through compromised credentials, ensuring that users do not recycle old passwords that may have been exposed. This policy mitigates risks associated with password-based attacks, such as brute force and credential stuffing, thereby protecting sensitive business data and aligning with regulatory compliance requirements like PCI-DSS and ISO 27001.
  description: This rule checks whether the password policy for OCI Identity users is configured to prevent reuse of the last 24 passwords. This helps maintain strong authentication practices by forcing users to create unique passwords over time. To verify, navigate to the Oracle Cloud Console, access the Identity service, and review the password policy settings under the domain's security policies. Remediation involves setting the password reuse limit to 24 in the policy management section of the user's identity settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managinguserpasswords.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
  - https://cloud.oracle.com/en_US/architecture/security-best-practices
- rule_id: oci.identity.password.policy_reuse_24
  service: identity
  resource: password
  requirement: Policy Reuse 24
  scope: identity.password.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enforce Password Reuse Limit of 24 Cycles
  rationale: Restricting password reuse is crucial to prevent unauthorized access through compromised credentials. This policy reduces the risk of credential stuffing and password spraying attacks, ensuring that passwords are not easily predictable or reused, thus enhancing account security and adherence to best practices like those outlined in NIST SP 800-63B. Compliance with standards such as PCI-DSS requires strong password policies to protect sensitive data.
  description: This rule checks whether the password policy for OCI Identity service enforces a minimum of 24 password reuse cycles before a password can be reused. It ensures that once a password is changed, it cannot be reused until 24 other unique passwords have been utilized. Verification involves reviewing the password policy settings within the OCI Console under Identity settings. To remediate, configure the password policy to enforce a reuse limit of 24 cycles by navigating to the Identity settings and updating the password policy configuration.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpasswords.htm
  - https://www.oracle.com/security/cloud-security/
  - https://www.nist.gov/publications/nist-special-publication-800-63b-digital-identity-guidelines
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
  - https://cloudsecurityalliance.org/artifacts/cloud-controls-matrix-v4/
- rule_id: oci.identity.user.password_policy_symbol
  service: identity
  resource: user
  requirement: Password Policy Symbol
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enforce Password Policy with Special Symbols for OCI Users
  rationale: Implementing a password policy that requires special symbols enhances security by making passwords more resistant to brute force attacks, reducing the risk of unauthorized access. It is a critical component in protecting sensitive data and maintaining compliance with industry standards such as NIST and PCI-DSS, which mandate strong authentication measures.
  description: This rule checks if the password policy for OCI users mandates the inclusion of special symbols. A robust password policy helps mitigate risks associated with weak passwords. Administrators can configure this setting through the OCI Console under Identity > Policies. To remediate, ensure that the password policy requires at least one special character, strengthening user authentication measures.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpasswordpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.identity.user.password_policy_uppercase
  service: identity
  resource: user
  requirement: Password Policy Uppercase
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure User Passwords Include Uppercase Characters
  rationale: Enforcing the inclusion of uppercase characters in user passwords enhances password complexity, making them more resistant to brute-force and dictionary attacks. This requirement mitigates the risk of unauthorized access to sensitive resources, which is critical for maintaining data integrity and protecting against potential security breaches. Additionally, adhering to this policy helps meet compliance obligations with standards such as NIST SP 800-63 and strengthens overall identity management practices.
  description: This rule checks that user password policies in OCI require at least one uppercase letter. To verify, navigate to the OCI Console, access the Identity menu, and ensure that the password policy for users includes uppercase character requirements. Remediation involves updating the password policy to enforce this rule if it's not already in place. This can be configured through the IAM service settings in OCI, ensuring that all new and existing user passwords adhere to this policy.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpasswordpolicy.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.policy
  service: identity
  resource: user
  requirement: Policy
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure User Policies Follow Principle of Least Privilege
  rationale: Implementing the principle of least privilege in user policies mitigates security risks by limiting access to only necessary resources, reducing the attack surface. This approach minimizes potential abuse of permissions, preventing unauthorized access and data breaches. Adhering to this principle also supports compliance with regulatory requirements such as PCI-DSS and ISO 27001, enhancing overall security posture.
  description: This rule checks that user policies are configured to grant the minimum necessary permissions required for users to perform their job functions. Users should not have excessive privileges that exceed their operational needs. Verify that each policy aligns with the least privilege principle by reviewing policy statements and ensuring they are scoped to specific actions and resources. Remediation involves adjusting policy statements to restrict permissions and implementing a regular review process to ensure ongoing adherence.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloud.oracle.com/en_US/architecture/architect-security-best-practices
- rule_id: oci.identity.user.policy_allows_privilege_escalation
  service: identity
  resource: user
  requirement: Policy Allows Privilege Escalation
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Prevent Privilege Escalation via OCI Policies
  rationale: Privilege escalation can lead to unauthorized access to critical resources, resulting in data breaches and financial losses. It's vital to prevent overly permissive policies that enable users to gain higher access rights than intended, which could violate compliance standards like PCI-DSS and ISO 27001, and expose sensitive information.
  description: This rule checks for OCI IAM policies that inadvertently allow privilege escalation by granting excessive permissions to users. To verify, review user policies for permissions like 'manage all-resources' or 'manage tenancy.' Remediation involves revising policies to adhere to the principle of least privilege, ensuring users have only the necessary permissions. Use OCI's policy simulation tool to assess the impact of changes before implementation.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
- rule_id: oci.identity.user.policy_attached_only_to_group_or_roles
  service: identity
  resource: user
  requirement: Policy Attached Only To Group Or Roles
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Policies Attached Only to Groups or Roles
  rationale: Associating policies directly with users increases risk due to potential unmanaged access if users change roles or leave the organization. It complicates audits and compliance, as it becomes challenging to track and manage individual user access. Aligning policies with groups or roles supports principle of least privilege, facilitating compliance with regulations such as ISO 27001 and PCI-DSS.
  description: This rule checks that Oracle Cloud Infrastructure policies are only attached to groups or predefined roles, not directly to individual users. Direct user-policy associations bypass identity management best practices and can lead to excessive permissions. To verify compliance, review the OCI Console or use the OCI CLI to inspect policy attachments. Remediation involves reassigning policies from users to appropriate groups or roles, ensuring that access rights align with user responsibilities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managinggroups.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.identity.user.policy_compliance
  service: identity
  resource: user
  requirement: Policy Compliance
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure User Policy Compliance in OCI Identity Management
  rationale: Proper policy compliance for user identities is vital to prevent unauthorized access and data breaches in OCI environments. Non-compliance can lead to potential security risks such as privilege escalation and unauthorized data manipulation, impacting both business operations and regulatory compliance. Adhering to identity management policies helps mitigate these risks and ensures alignment with frameworks like ISO 27001 and PCI-DSS.
  description: This check verifies that all user identities in Oracle Cloud Infrastructure adhere to defined access policies. It involves reviewing user permissions and ensuring they are granted based on least privilege principles. To verify compliance, access logs and policy settings should be regularly audited against predefined security requirements. Remediation involves adjusting policy configurations to align with security best practices and conducting regular reviews to ensure continued compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - CIS OCI Benchmark - Identity Management
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.identity.user.policy_default_users_cannot_create_security_groups
  service: identity
  resource: user
  requirement: Policy Default Users Cannot Create Security Groups
  scope: identity.user.network_security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict Default Users from Creating Security Groups
  rationale: Allowing default users to create security groups can lead to misconfigured or overly permissive network settings, increasing the risk of unauthorized access and data breaches. This control prevents potential exploitation by attackers who may gain access to default user credentials. It also aligns with compliance frameworks that require strict access control measures.
  description: This rule checks whether default users have been granted the ability to create network security groups in Oracle Cloud Infrastructure. Default users typically have broader access and may lack the necessary expertise to configure security groups securely. To verify, review the user policies in the OCI Identity and Access Management service and ensure that only authorized personnel have permissions to create security groups. Remediation involves updating policies to remove such permissions from default users and assigning them to a dedicated security team.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - https://www.oracle.com/security/cloud-security/
  - https://cloudsecurityalliance.org/artifacts/cloud-controls-matrix-v4-0/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.identity.user.policy_ensure_default_user_cannot_create_apps
  service: identity
  resource: user
  requirement: Policy Ensure Default User Cannot Create Apps
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict Default User Capabilities for Application Creation
  rationale: Allowing default users to create applications can lead to unauthorized deployments, potential misuse, and resource sprawl, increasing the risk of security incidents. Restricting this ability helps maintain control over application environments, ensuring that only vetted users with appropriate permissions can deploy and manage applications, aligning with organizational security policies and compliance mandates.
  description: This check verifies that default users in Oracle Cloud Infrastructure (OCI) do not have policies allowing them to create applications. To ensure security best practices, configure IAM policies so that only roles with specific responsibility and accountability can manage application creation. Validate by reviewing IAM policies in the OCI Console, ensuring no wildcard permissions are granted to default users. Remediate by adjusting policy statements to limit application creation capabilities to authorized groups or individuals.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-security/compliance/nist-csf/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_securityguidelines.htm
- rule_id: oci.identity.user.policy_ensure_default_user_cannot_create_tenants
  service: identity
  resource: user
  requirement: Policy Ensure Default User Cannot Create Tenants
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict Default User from Tenant Creation
  rationale: Allowing default users to create tenants poses a significant security risk as it could lead to unauthorized access and management of cloud resources. This could result in potential data breaches, unauthorized financial charges, and compliance violations with regulations like GDPR, PCI-DSS, and others. Ensuring that only authorized personnel can create tenants mitigates these risks and maintains control over the cloud environment.
  description: This rule checks whether policies are in place to prevent the default user from having privileges to create new tenants in OCI. It inspects user policies to ensure that the 'create tenancy' permission is not granted to default users. To verify, review the policy statements associated with user roles and ensure that tenant creation permissions are appropriately restricted. Remediation involves removing or adjusting any policy statements that erroneously grant tenant creation permissions to default users.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/security/cloud-compliance/cis-benchmarks/
  - https://csrc.nist.gov/
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/security/cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
- rule_id: oci.identity.user.policy_guest_invite_only_for_admin_roles
  service: identity
  resource: user
  requirement: Policy Guest Invite Only For Admin Roles
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Guest Invites to Admin Roles Only
  rationale: Allowing non-admin users to invite guests can lead to unauthorized access, increasing the risk of data breaches and non-compliance with regulations like GDPR and PCI-DSS. Limiting guest invites to admin roles ensures that only trusted personnel can extend access, reducing the risk of insider threats and maintaining strict control over user management.
  description: This rule checks if the ability to invite guest users is restricted solely to administrative roles within OCI Identity and Access Management policies. To verify, review your IAM policies to ensure only admin groups have permissions such as 'Auth:Invite'. Remediation involves updating IAM policies to remove guest invite permissions from non-admin roles, thereby aligning with the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security-cloud/identity-management/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.policy_guest_users_access_restrictions
  service: identity
  resource: user
  requirement: Policy Guest Users Access Restrictions
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict Guest User Access via OCI Policies
  rationale: Restricting access for guest users is crucial to prevent unauthorized data exposure and minimize the risk of privilege escalation. By limiting the capabilities of guest users, organizations can mitigate insider threats and comply with compliance frameworks that mandate least privilege access. This is particularly important in cloud environments where misconfigurations can lead to significant data breaches and financial loss.
  description: This rule checks for the presence of stringent identity policies that limit guest user permissions within OCI. It verifies that guest users are only granted access necessary for their roles and do not have excessive permissions. Remediation involves reviewing current identity policies, identifying guest user roles, and ensuring policies enforce least privilege by using OCI policy statements such as 'Allow group GuestUsers to inspect in compartment'. Regular audits and adjustments of these policies are recommended as roles and responsibilities evolve.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - 'NIST SP 800-53 AC-6: Least Privilege'
  - 'PCI-DSS Requirement 7: Restrict access to cardholder data by business need to know'
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusercredentials.htm
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.identity.user.policy_minimum_length_14
  service: identity
  resource: user
  requirement: Policy Minimum Length 14
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure User Password Minimum Length of 14 Characters
  rationale: Requiring a minimum password length of 14 characters significantly enhances security by increasing the complexity and difficulty of brute-force attacks. Strong password policies help protect sensitive data and systems from unauthorized access and meet compliance requirements such as PCI-DSS and ISO 27001. Enforcing this policy reduces the risk of account compromise and potential data breaches, safeguarding organizational assets and user information.
  description: This rule checks that all user password policies within OCI have a minimum length of 14 characters. To verify compliance, navigate to the OCI Console, go to 'Identity & Security' > 'Policies', and review the password policy settings. Ensure the 'Minimum Password Length' is set to 14 or more. If the policy is not compliant, update it by editing the password policy settings to enforce a minimum length of 14 characters. This strengthens user authentication by making passwords harder to guess.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpasswords.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf
  - https://cloudsecurityalliance.org/research/oci/
- rule_id: oci.identity.user.policy_no_administrative_privileges
  service: identity
  resource: user
  requirement: Policy No Administrative Privileges
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Users from Holding Administrative Privileges
  rationale: Restricting users from administrative privileges is crucial to minimize the risk of unauthorized access to critical resources, which could lead to data breaches or service disruptions. It aligns with the principle of least privilege, reducing the attack surface by ensuring only necessary permissions are granted. This is vital for compliance with regulations like PCI-DSS and ISO 27001, which mandate strict access controls.
  description: This rule checks if any user has been assigned administrative privileges within OCI. Users should not hold administrative roles unless absolutely necessary, as this increases the risk of privilege escalation and potential exploitation. Verify by reviewing user policies in the OCI console and ensuring they do not include overly broad permissions such as 'manage all-resources'. Remediation involves modifying user policies to adhere to the principle of least privilege, granting only the permissions required for specific roles.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://cloud.oracle.com/security-best-practices
- rule_id: oci.identity.user.policy_no_full_access_to_cloudtrail
  service: identity
  resource: user
  requirement: Policy No Full Access To Cloudtrail
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict Full Access to OCI CloudTrail Logs
  rationale: Allowing full access to CloudTrail logs can expose sensitive information about cloud activities, potentially leading to misuse or exploitation by unauthorized users. This can result in data breaches, non-compliance with regulatory frameworks such as PCI-DSS, and a compromised security posture. Limiting access helps mitigate insider threats and ensures only authorized personnel can review and analyze audit logs.
  description: This rule checks for IAM policies granting full access to CloudTrail logs. Ensure that policies are scoped to least privilege, allowing only necessary actions like 'READ' or 'LIST'. Review and modify IAM policies to restrict access to audit logs, aligning with security best practices. Administrators should periodically audit these policies to prevent unauthorized access and maintain compliance with security standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/cloud/cloud-security.html#security-best-practices
- rule_id: oci.identity.user.policy_overly_permissive
  service: identity
  resource: user
  requirement: Policy Overly Permissive
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict Overly Permissive User Policies in OCI
  rationale: Overly permissive policies can lead to unauthorized access, increasing the risk of data breaches and non-compliance with regulations like NIST and PCI-DSS. By limiting permissions to what is necessary, organizations can protect sensitive information and maintain a robust security posture.
  description: This rule checks for overly permissive policies attached to users in OCI, ensuring that permissions follow the principle of least privilege. Review and adjust user policies to restrict access based on specific job functions and responsibilities. Remediation involves auditing current policies, removing unnecessary permissions, and implementing role-based access controls (RBAC) to minimize exposure.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/iam-best-practices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.identity.user.policy_restricts_user_consent_for_apps
  service: identity
  resource: user
  requirement: Policy Restricts User Consent For Apps
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict User Consent for Application Access in OCI
  rationale: Allowing users to consent to application access can lead to unauthorized data sharing, increasing the risk of data breaches and non-compliance with regulations like GDPR and CCPA. By restricting user consent, organizations can enforce stricter access controls, reducing the attack surface and ensuring that only vetted applications access sensitive data.
  description: This rule checks for policies that prevent users from granting application access on their own, ensuring that all app permissions are controlled by administrators. To verify, review the IAM policies in OCI, ensuring they do not allow 'Allow group <group-name> to manage apps'. Remediation involves adjusting these policies to require administrative approval for any app consent, enhancing security by centralizing access control.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/policiesdefault.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/cloud/security/compliance/
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.identity.user.policy_strong
  service: identity
  resource: user
  requirement: Policy Strong
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Strong Policies for OCI User Management
  rationale: Strong user policies are critical to protecting sensitive data and systems from unauthorized access, reducing the risk of data breaches and insider threats. Weak or insufficient policies can lead to compromised accounts, which may result in financial loss, reputational damage, and non-compliance with regulations such as GDPR, PCI-DSS, and HIPAA.
  description: This rule checks for the presence of strong policies governing user access in OCI, ensuring that users have the least privilege necessary to perform their duties. Strong policies should include requirements for multi-factor authentication (MFA), regular review of user permissions, and immediate revocation of access for former employees. To verify, administrators can use the OCI Console or CLI to review and update policy statements, ensuring they align with organizational security standards and best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmark/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security-cloud/cloud-security.html
- rule_id: oci.identity.user.role_least_privilege_required
  service: identity
  resource: user
  requirement: Role Least Privilege Required
  scope: identity.user.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce Least Privilege for OCI User Roles
  rationale: Applying the principle of least privilege minimizes the risk of unauthorized access and potential data breaches by ensuring users have only the permissions necessary to perform their jobs. This reduces the attack surface and helps maintain compliance with regulations like PCI-DSS and HIPAA, which mandate strict access controls to protect sensitive information.
  description: This rule checks whether OCI user roles are assigned the minimal set of permissions necessary for their tasks. Verify that user policies are reviewed regularly to ensure no excessive permissions are granted. Remediation involves auditing current permissions and adjusting policies to align with least privilege principles by using OCI's Identity and Access Management (IAM) features. Utilize the OCI Console or CLI to modify IAM policies to restrict user permissions appropriately.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
- rule_id: oci.identity.user.root_hardware_mfa_enabled
  service: identity
  resource: user
  requirement: Root Hardware MFA Enabled
  scope: identity.user.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure Root User Has Hardware MFA Enabled
  rationale: Enabling hardware MFA for the root user is critical to protect against unauthorized access, as the root user holds the highest level of permissions in the OCI environment. A compromise of the root user account could lead to catastrophic data breaches, service disruptions, or financial loss. Regulatory requirements such as NIST, PCI-DSS, and ISO 27001 emphasize strong authentication measures to safeguard sensitive data.
  description: This rule checks if the root user in OCI has hardware-based multi-factor authentication (MFA) enabled. Hardware MFA requires a physical token for authentication, significantly reducing the risk of account compromise compared to software-based methods. Administrators can verify this setting through the OCI Console under Identity > Users > Root User, checking the 'MFA Devices' section. To remediate, enroll a hardware MFA device via the OCI Console, following the steps outlined in the OCI documentation.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm#To_enable_MFA_for_a_user
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://cloud.oracle.com/cloud-security
- rule_id: oci.identity.user.root_mfa_enabled
  service: identity
  resource: user
  requirement: Root MFA Enabled
  scope: identity.user.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Enable MFA for OCI Root User to Enhance Security
  rationale: Enabling Multi-Factor Authentication (MFA) for the root user significantly reduces the risk of unauthorized access to your OCI resources, which could lead to data breaches, financial loss, and operational disruptions. Root accounts are highly privileged, and unauthorized access can result in severe security incidents. Compliance with standards such as NIST and PCI-DSS often requires MFA for critical accounts to mitigate credential theft risks.
  description: This rule checks whether MFA is enabled for the OCI root user account. The root user has unrestricted access to manage all resources, making it a primary target for attackers. To verify, navigate to the OCI Console, go to Identity, then Users, and ensure that 'Multi-Factor Authentication' is enabled for the root user. Remediation involves setting up an MFA device, such as a mobile authenticator application, to confirm the identity of the root user during login.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm#EnableMFA
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf
  - https://www.pcisecuritystandards.org/documents/Multi-Factor-Authentication-Guidance-v1.pdf
  - https://www.oracle.com/security-best-practices/multi-factor-authentication/
- rule_id: oci.identity.user.rotate_access_key_90_days
  service: identity
  resource: user
  requirement: Rotate Access Key 90 Days
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce 90-Day Rotation for OCI User Access Keys
  rationale: Regular rotation of access keys mitigates the risk of unauthorized access due to key exposure or misuse. Stale keys can be exploited by malicious actors, leading to potential data breaches and non-compliance with security frameworks such as PCI-DSS and ISO 27001. Ensuring frequent key rotation aligns with best practices for maintaining secure access management.
  description: This rule checks if OCI user access keys are rotated within a 90-day interval. It requires configuring policies to enforce automatic rotation or setting reminders for manual updates. To verify compliance, review the last rotation date of each access key in the IAM console. Remediate by updating the keys and adjusting policies to automate future rotations, thus enhancing the security posture by reducing the window of exposure.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/accesskeyrotation.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.support_role_created
  service: identity
  resource: user
  requirement: Support Role Created
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Monitor Creation of Support Role for User Accounts
  rationale: Creating a support role for user accounts can expose critical resources to unauthorized access if not properly managed. This can lead to data breaches, unauthorized data manipulation, and non-compliance with standards like ISO 27001 and SOC2. It is vital to monitor these configurations to mitigate insider threats and ensure that only necessary access is granted.
  description: This rule checks for the creation of support roles assigned to user accounts within OCI Identity and Access Management. It ensures that any user granted a support role is done so based on a legitimate need and follows the principle of least privilege. Verification involves reviewing audit logs for role creation activities and ensuring compliance with organizational policies. Remediation includes removing unnecessary support roles and implementing a request-and-review process for access changes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
- rule_id: oci.identity.user.user_accesskey_unused
  service: identity
  resource: user
  requirement: User Accesskey Unused
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Deactivate Unused OCI User Access Keys
  rationale: Unused access keys pose a significant security risk as they can be exploited by attackers to gain unauthorized access to critical resources. Maintaining active keys that are not in use increases the attack surface and violates security best practices and compliance requirements, such as PCI-DSS and ISO 27001, which mandate regular review and rotation of access credentials.
  description: This rule checks for Oracle Cloud Infrastructure (OCI) user accounts with access keys that have not been used for an extended period. It is vital to disable or delete these keys to reduce potential security risks. To verify, review the last used date of each access key in the OCI Console under Identity > Users. Remediation involves disabling or rotating unused keys, which can be done through the OCI Console or CLI. Implementing this practice ensures that only necessary credentials exist, aligned with the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/API/Concepts/apisigningkey.htm
  - https://www.oracle.com/security/cloud-security/capabilities/identity-and-access-management/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- rule_id: oci.identity.user.user_console_access_unused
  service: identity
  resource: user
  requirement: User Console Access Unused
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Identify & Remediate Unused OCI User Console Access
  rationale: Unused user console access can indicate dormant accounts, which pose a security risk as they might be exploited for unauthorized access. Such accounts can lead to potential data breaches, regulatory non-compliance, and unauthorized changes, impacting business continuity and data integrity.
  description: This rule checks for OCI user accounts with console access that have not been utilized within a specified timeframe. To verify, review the 'Last Console Login' attribute for each user in Oracle Identity and Access Management. Remediation involves disabling or removing unused access to minimize security risks and ensure compliance with least privilege principles.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/standard/73906.html
  - https://www.oracle.com/security/
- rule_id: oci.identity.user.user_has_mfa
  service: identity
  resource: user
  requirement: User Has MFA
  scope: identity.user.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce Multi-Factor Authentication for OCI Users
  rationale: Enabling Multi-Factor Authentication (MFA) significantly enhances the security of user accounts by requiring an additional verification step beyond just a password. This measure reduces the risk of unauthorized access, especially in the context of credential theft and phishing attacks. Compliance with industry standards like PCI-DSS and ISO 27001 often mandates the use of MFA to protect sensitive data and systems.
  description: This rule checks if MFA is enabled for all user accounts within Oracle Cloud Infrastructure (OCI). A lack of MFA can lead to unauthorized access and potential data breaches. Administrators should ensure that all users have MFA configured by navigating to the OCI Console, selecting 'Identity', and enabling MFA in the user's settings. Remediation involves guiding users to set up MFA through their account settings, using either an authenticator app or hardware token.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingmfa.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
- rule_id: oci.identity.user.user_in_group
  service: identity
  resource: user
  requirement: User In Group
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Users Are Assigned to Appropriate Groups
  rationale: Assigning users to appropriate groups is crucial for enforcing role-based access control (RBAC), minimizing the risk of unauthorized access, and ensuring compliance with security policies. Misconfigured access can lead to data breaches and non-compliance with regulatory requirements such as NIST and PCI-DSS.
  description: This rule checks whether users in Oracle Cloud Infrastructure (OCI) are assigned to appropriate groups, which define their access permissions. Verifying user group assignments ensures that users have the necessary permissions for their role, and prevents privilege escalation. To remediate, review and update user group memberships in the OCI console or using OCI CLI to adhere to the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managinggroups.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/compliance/
- rule_id: oci.identity.user.user_mfa_enabled_console_access
  service: identity
  resource: user
  requirement: User MFA Enabled Console Access
  scope: identity.user.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure MFA is Enabled for OCI Console User Access
  rationale: Enabling Multi-Factor Authentication (MFA) for OCI console access significantly reduces the risk of unauthorized access, even if passwords are compromised. This enhances security by adding an additional layer of verification, thereby protecting sensitive data and cloud resources. It also helps organizations meet compliance requirements related to access control in frameworks such as NIST SP 800-53, PCI-DSS, and ISO 27001.
  description: This rule checks whether users with console access in Oracle Cloud Infrastructure have Multi-Factor Authentication (MFA) enabled. MFA should be configured in the OCI Identity and Access Management (IAM) service, requiring users to provide a second form of verification. To verify, navigate to the OCI Console under 'Identity & Security' > 'Users' and check the MFA status for each user. To remediate, ensure that MFA is enabled by configuring an MFA device for each user through their 'User Details' page in the OCI Console.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/usingauth.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.identity.user.user_no_inline_policies
  service: identity
  resource: user
  requirement: User No Inline Policies
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Avoid Inline Policies for OCI Users
  rationale: Assigning inline policies to individual users can lead to inconsistent access controls and increase the risk of privilege misuse. By leveraging group-based policies, organizations can better manage user permissions, reduce administrative overhead, and ensure compliance with access management best practices.
  description: This rule checks for the presence of inline policies directly attached to OCI users. Inline policies can lead to fragmented access controls and inconsistent enforcement of security policies. It is recommended to use group-based policies for managing permissions, ensuring that users are granted roles through group memberships. To remediate, review user policies and migrate any inline policies to appropriate groups, then remove the inline policies from the users.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - CIS Oracle Cloud Infrastructure Foundations Benchmark v1.1.0, Section 1.1
  - NIST SP 800-53 AC-2
  - PCI-DSS Requirement 7.1
  - ISO/IEC 27001:2013 A.9.1.2
  - https://www.oracle.com/security-cloud/cspm/
- rule_id: oci.identity.user.user_unused_credentials
  service: identity
  resource: user
  requirement: User Unused Credentials
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Users Have No Unused Credentials
  rationale: Unused credentials pose a significant security risk as they can be exploited by unauthorized users to gain access to sensitive resources and data within the Oracle Cloud Infrastructure. Eliminating such credentials reduces the attack surface, mitigates potential breaches, and aids in compliance with security standards such as PCI-DSS and ISO 27001, which emphasize the importance of managing access controls and ensuring active credential usage.
  description: This rule checks for Oracle Cloud Infrastructure users with credentials (API keys, auth tokens, etc.) that have not been used within a specified timeframe. Identifying and removing or disabling these unused credentials helps prevent unauthorized access. Administrators should regularly audit user credentials, remove those that are not in use, and implement policies for regular credential review. To verify, review the 'Last Used' timestamp for each credential in the OCI console, and take appropriate action to disable or delete any that are inactive.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.identity.user.user_with_vm_access_has_mfa
  service: identity
  resource: user
  requirement: User With VM Access Has MFA
  scope: identity.user.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Users with VM Access Have Multi-Factor Authentication Enabled
  rationale: Users with access to virtual machines can manipulate critical infrastructure, potentially leading to unauthorized access or data breaches. Multi-factor authentication (MFA) serves as an additional security layer, reducing the risk of credential compromise and aligning with compliance requirements like PCI-DSS and ISO 27001. Enforcing MFA for these users mitigates the risk of unauthorized access and enhances overall security posture.
  description: This rule checks whether users with access to Oracle Cloud Infrastructure virtual machines have multi-factor authentication enabled. Specifically, it verifies the presence of MFA for any user with VM management privileges. To comply, administrators must enable MFA by configuring identity providers or using OCI's built-in MFA options. Remediation involves reviewing IAM policies and ensuring MFA enrollment for affected users through the OCI Console.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/access/managing-user-credentials.htm#MFA
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://www.nist.gov/itl/applied-cybersecurity/nist-cybersecurity-framework
- rule_id: oci.identity.user.users_cannot_create_groups
  service: identity
  resource: user
  requirement: Users Cannot Create Groups
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict Group Creation to Admins
  rationale: Allowing users to create groups can lead to unauthorized access, privilege escalation, and potential security breaches. By restricting this capability to administrators, organizations can maintain tighter control over group memberships and access permissions, reducing the risk of inadvertent or malicious changes that could compromise sensitive resources. This measure supports compliance with least privilege principles and regulatory standards such as NIST and ISO 27001.
  description: This rule verifies that users do not possess permissions to create groups within Oracle Cloud Infrastructure (OCI). It checks user policies to ensure that only designated administrators can manage group creation. To verify compliance, review OCI Identity policies and ensure users lack the 'CreateGroup' permission. Remediation involves adjusting policies to limit group creation capabilities to admin roles only, aligning with the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managinggroups.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/cloud-security-best-practices/
- rule_id: oci.data_integration.pipeline.instance_network_access_restriction_enforced
  service: data_integration
  resource: pipeline
  requirement: Instance Network Access Restriction Enforced
  scope: data_integration.pipeline.network_security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enforce Network Access Restrictions on OCI Data Integration Pipelines
  rationale: Unauthorized network access to data integration pipelines can lead to data exfiltration, service disruption, or unauthorized data manipulation, posing significant business and compliance risks. Enforcing network access restrictions ensures that only trusted and authenticated sources can interact with your OCI resources, aligning with security best practices and regulatory standards such as ISO 27001 and GDPR.
  description: This check ensures that network access restrictions are enforced on OCI Data Integration pipelines by verifying that security lists or network security groups (NSGs) are configured to limit access based on specific IP addresses or CIDR blocks. To verify, review the associated VCN security lists and NSGs to ensure they include rules that allow only authorized IPs. Remediation involves updating security lists or NSGs to reflect the necessary access restrictions, using the OCI Console or CLI tools.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataIntegration/Concepts/di_overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingNSGs.htm
  - https://www.oracle.com/security-cloud/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
- rule_id: oci.streaming.stream.cluster_in_transit_encryption_enabled
  service: streaming
  resource: stream
  requirement: Cluster In Transit Encryption Enabled
  scope: streaming.stream.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable In-Transit Encryption for OCI Streaming Clusters
  rationale: In-transit encryption is crucial for protecting data as it traverses the network. Without this, sensitive information in streams could be intercepted by unauthorized parties, leading to data breaches, loss of confidentiality, and potential non-compliance with regulations such as PCI-DSS and GDPR. Implementing this ensures data integrity and confidentiality, which are critical for maintaining customer trust and meeting legal obligations.
  description: This check verifies that in-transit encryption is enabled for OCI Streaming Service clusters. In-transit encryption ensures that data moving between clients and servers is encrypted using TLS. To verify, ensure the 'encryptionInTransitEnabled' attribute is set to true in the stream's configuration. Remediation involves updating the stream settings in the OCI Console or using the CLI to enable this feature, thereby enhancing security posture and protecting data from interception.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Tasks/streamingencryption.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/publications/nist-sp-800-57-recommendation-key-management-part-1
  - https://www.oracle.com/security/cloud-security/identity-and-access/
  - https://www.oracle.com/security/cloud-security/overview/
- rule_id: oci.streaming.stream.connector_in_transit_encryption_enabled
  service: streaming
  resource: stream
  requirement: Connector In Transit Encryption Enabled
  scope: streaming.stream.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Stream Connectors Use In-Transit Encryption
  rationale: In-transit encryption safeguards data as it moves between components, preventing interception and unauthorized access. Without it, sensitive information in streams can be exposed to eavesdropping and man-in-the-middle attacks, which can lead to data breaches, non-compliance with regulations like PCI-DSS, and damage to organizational reputation. Enforcing encryption aligns with best practices for data protection and privacy.
  description: This rule checks that encryption is enabled for data in transit for OCI Streaming service connectors. To verify, ensure that the `enableInTransitEncryption` setting is enabled in your stream configuration. Remediation involves updating the stream configuration to ensure that all connectors encrypt data in transit using protocols like TLS 1.2 or higher. This can typically be done via the OCI Console or API by modifying the stream's properties.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Concepts/streamingencryption.htm
  - https://www.oracle.com/security-cloud-compliance/cis-oci-benchmark/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.oracle.com/cloud/security/cloud-security-principles/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.key_management.vault.logging_enabled
  service: key_management
  resource: vault
  requirement: Logging Enabled
  scope: key_management.vault.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Logging for OCI Vault Operations
  rationale: Enabling logging for OCI Vault operations is crucial for tracking access and changes to sensitive encryption keys. Without logging, unauthorized access may go undetected, leading to potential data breaches or non-compliance with regulatory standards like PCI-DSS and HIPAA. Logging provides visibility into operations, helping identify potential security incidents and ensuring accountability.
  description: This rule checks if logging is enabled for Oracle Cloud Infrastructure (OCI) Vault operations to capture audit trails of key management activities. To verify, ensure that the logging service is enabled and properly configured to capture all relevant events in the vault. Remediation involves setting up and enabling logging via OCI Logging service, configuring the logs to be stored in a secure location, and ensuring they are retained per compliance requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingvaults.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/for-professionals/index.html
  - https://www.oracle.com/security-cloud/compliance/
- rule_id: oci.key_management.vault.private_endpoints
  service: key_management
  resource: vault
  requirement: Private Endpoints
  scope: key_management.vault.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure OCI Vault Uses Private Endpoints for Enhanced Security
  rationale: Utilizing private endpoints for OCI Vaults reduces the attack surface by limiting network exposure to the public internet, which minimizes the risk of unauthorized access and potential data breaches. This approach is crucial for maintaining confidentiality and integrity of cryptographic keys, especially for organizations handling sensitive data and needing to comply with regulations such as PCI-DSS and HIPAA.
  description: This rule checks if OCI Vaults are configured to use private endpoints, ensuring that the vaults are accessible only within a private network. To verify, ensure that the vault's endpoint is set to a private IP address within your Virtual Cloud Network (VCN). Remediation involves configuring the vault to use a private endpoint, which can be done through the OCI Console by selecting the appropriate VCN and subnet. This setup helps restrict access to trusted internal sources only.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/keymanagementusing.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-security-best-practices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.streaming.stream.stream_data_retention_period
  service: streaming
  resource: stream
  requirement: Stream Data Retention Period
  scope: streaming.stream.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Stream Data Retention Period Meets Compliance Requirements
  rationale: The data retention period for streaming services impacts the ability to comply with data protection regulations and mitigate risks such as data breaches and unauthorized data access. Inadequate retention settings may lead to data being kept longer than necessary, increasing the attack surface and storage costs. Aligning retention periods with business and regulatory requirements is crucial for maintaining data privacy and minimizing liability.
  description: This rule checks whether the data retention period for Oracle Cloud Infrastructure (OCI) Streaming services is configured according to organizational policies and regulatory requirements. It involves reviewing the 'Retention Period' setting of each stream to ensure it aligns with business needs and complies with relevant data protection laws. Remediation includes adjusting the retention duration in the OCI console under the 'Streaming' service section to meet specified policies, using OCI's configuration management tools.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Concepts/streamingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Compliance/Concepts/compliance.htm
  - 'NIST SP 800-53: AC-16 Security and Privacy Controls for Federal Information Systems and Organizations'
  - 'PCI-DSS Requirement 3.1: Keep cardholder data storage to a minimum'
  - ISO/IEC 27001:2013 - A.8.2.3 Information classification
  - https://oracle.com/cloud/security/
- rule_id: oci.key_management.key.cmk_rotation_enabled
  service: key_management
  resource: key
  requirement: CMK Rotation Enabled
  scope: key_management.key.key_rotation
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure CMK Rotation is Enabled for OCI Keys
  rationale: Regular rotation of Customer Master Keys (CMKs) is crucial to minimize the risk of key compromise and to ensure that any potential exposure of encryption keys can be mitigated. Enabling key rotation supports compliance with data protection regulations such as PCI-DSS and ISO 27001, which mandate secure key management practices. Failure to rotate keys can lead to prolonged exposure to data breaches and non-compliance with regulatory standards, increasing the risk of financial and reputational damage.
  description: This check verifies that key rotation is enabled for Customer Master Keys (CMKs) in Oracle Cloud Infrastructure's Key Management service. CMK rotation should be configured to automatically rotate the cryptographic material on a periodic basis, which can be set within the OCI Console under the Key Management section. To remediate, navigate to the Key Management console, select the CMK, and enable automatic rotation with a defined schedule. This ensures that encryption keys are regularly updated, reducing exposure to potential vulnerabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/using.htm#Using_Rotation
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.cisecurity.org/benchmark/oracle/
- rule_id: oci.key_management.key.key_cmk_rotation_annual_compliance
  service: key_management
  resource: key
  requirement: Key CMK Rotation Annual Compliance
  scope: key_management.key.key_rotation
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Annual CMK Rotation Compliance in OCI Key Management
  rationale: Regular rotation of Customer Master Keys (CMKs) is crucial to mitigate the risks of key compromise, which can lead to unauthorized data access and potential data breaches. Ensuring annual rotation aligns with best practices and regulatory standards such as PCI-DSS and ISO 27001, safeguarding sensitive data and maintaining trust with stakeholders.
  description: This rule checks that all Customer Master Keys (CMKs) in OCI Key Management are rotated annually. Regular key rotation reduces the window of opportunity for adversaries to exploit compromised keys. To verify compliance, review the key rotation settings in the OCI console under Key Management, ensuring the 'Last Rotation Date' is within the past 12 months. Remediate by scheduling a rotation for any non-compliant keys, which can be automated using OCIâ€™s Key Management Service (KMS) features.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingkeys.htm#rotatingakey
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/securityoverview.htm
- rule_id: oci.key_management.key.key_not_scheduled_for_deletion
  service: key_management
  resource: key
  requirement: Key Not Scheduled For Deletion
  scope: key_management.key.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Keys Are Not Scheduled for Deletion
  rationale: Keeping keys active and not scheduled for deletion is critical for maintaining data availability and ensuring continuity of encryption operations. Scheduling keys for deletion prematurely can lead to data access issues, potential data loss, and non-compliance with regulatory requirements such as GDPR and HIPAA, which mandate strict control over encryption keys and data protection.
  description: This rule checks if any keys in the OCI Key Management service are inadvertently scheduled for deletion, which can disrupt encryption services and data access. To verify, navigate to the OCI Console under the Key Management section, and review the status of each key. If a key is scheduled for deletion, cancel the deletion process to prevent service disruption. Ensure that key deletion schedules align with organizational data retention policies and compliance mandates.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingkeys.htm#cancellingkeydeletion
  - https://www.oracle.com/security/cloud/cloud-compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.container_engine.cluster.service_account
  service: container_engine
  resource: cluster
  requirement: Service Account
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Proper Configuration of Kubernetes Service Accounts
  rationale: Improper configuration of service accounts in OCI Kubernetes clusters can lead to unauthorized access and privilege escalation, potentially exposing sensitive data and disrupting operations. Ensuring proper access controls aligns with compliance requirements such as PCI-DSS and NIST, safeguarding business assets against malicious activities.
  description: This rule checks the configuration of Kubernetes service accounts within OCI Container Engine clusters to ensure they adhere to least privilege principles. Verify that service accounts are not overly permissive, have appropriate role bindings, and are regularly audited. Remediation involves reviewing and adjusting the permissions of service accounts to align with their intended use, utilizing OCI's IAM policies for precise access control.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://kubernetes.io/docs/concepts/security/overview/
- rule_id: oci.functions.function.function_reserved_concurrency
  service: functions
  resource: function
  requirement: Function Reserved Concurrency
  scope: functions.function.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Functions Have Reserved Concurrency Set
  rationale: Setting reserved concurrency for OCI functions ensures that critical functions have guaranteed resources, preventing them from being throttled during high-demand periods. This prevents potential service disruptions and supports compliance with service-level agreements (SLAs), ensuring business continuity and meeting governance requirements.
  description: This rule checks if OCI functions have reserved concurrency configured to prevent resource contention during peak loads. Without reserved concurrency, functions might be throttled, impacting availability. To verify, review the function configuration in the OCI console for the 'Reserved Concurrency' setting. To remediate, set an appropriate reserved concurrency value based on expected workload to ensure consistent performance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionsmanaging.htm
  - https://www.oracle.com/a/ocom/docs/cis-oracle-cloud-infrastructure-foundations-benchmark.pdf
  - https://www.nist.gov/itl/applied-cybersecurity/nist-cybersecurity-framework
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Concepts/functionsoverview.htm
- rule_id: oci.load_balancer.load_balancer.balancer_desync_mitigation_mode
  service: load_balancer
  resource: load_balancer
  requirement: Balancer Desync Mitigation Mode
  scope: load_balancer.load_balancer.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Enable Load Balancer Desync Mitigation Mode
  rationale: Desync mitigation mode is crucial for preventing HTTP request smuggling attacks, which can lead to unauthorized access or data exfiltration. By aligning with security best practices, businesses can maintain data integrity and protect customer information, reducing the risk of compliance breaches with regulations like PCI-DSS and GDPR.
  description: This rule checks if Desync Mitigation Mode is enabled on OCI Load Balancers. Enabling this mode helps in mitigating risks associated with HTTP desynchronization attacks by enforcing stricter HTTP header parsing. To verify, navigate to the Load Balancer settings in the OCI Console, check the 'Desync Mitigation Mode' status, and set it to 'Defensive' if not already configured. This setting can also be updated via the OCI CLI by modifying the load balancer configuration.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Tasks/managingloadbalancer.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-44/version-2/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/
  - https://owasp.org/www-community/attacks/HTTP_Request_Smuggling
- rule_id: oci.load_balancer.balancer.logging_enabled
  service: load_balancer
  resource: balancer
  requirement: Logging Enabled
  scope: load_balancer.balancer.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Load Balancer Logging is Enabled
  rationale: Enabling logging on load balancers is crucial for monitoring traffic patterns, diagnosing issues, and detecting potential security threats such as unauthorized access attempts. Logs provide essential audit trails that help in meeting compliance requirements for standards like PCI-DSS and ISO 27001. Without logging, organizations may face challenges in forensic investigations and risk undetected security breaches.
  description: This rule checks if logging is enabled for Oracle Cloud Infrastructure load balancers. Logging should be configured in the Load Balancer settings to capture access logs that record each request processed by the load balancer. To verify, navigate to the Load Balancer details page in the OCI Console, ensure 'Logging' is set to 'Enabled', and specify a log group and log object. Remediation involves enabling logging and configuring a log group in the OCI Logging service to store and manage logs effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Tasks/enablinglogging.htm
  - https://www.oracle.com/cloud/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.load_balancer.load_balancer.balancer_ssl_listeners
  service: load_balancer
  resource: load_balancer
  requirement: Balancer SSL Listeners
  scope: load_balancer.load_balancer.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure SSL/TLS is Enabled on Load Balancer Listeners
  rationale: Enabling SSL/TLS on load balancer listeners protects data in transit by encrypting it, preventing unauthorized access and data breaches. This is critical for maintaining customer trust and meeting compliance with data protection regulations like PCI-DSS and HIPAA, which require encryption for sensitive data. Failure to implement SSL/TLS can result in data theft, legal penalties, and reputational damage.
  description: This rule checks if SSL/TLS is enabled on your OCI Load Balancer listeners. To verify, access the OCI Console, navigate to the Load Balancer details, and check each listener's configuration for SSL/TLS settings. Ensure that SSL/TLS protocols are enabled and up-to-date to mitigate vulnerabilities. Remediation involves configuring your load balancer to only accept secure connections by setting up SSL certificates and disabling outdated protocols.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Reference/ssl_certificates.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-52r1.pdf
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.load_balancer.load_balancer.balancer_alb_https_redirect
  service: load_balancer
  resource: load_balancer
  requirement: Balancer Alb HTTPS Redirect
  scope: load_balancer.load_balancer.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: HTTPS Redirect on OCI Load Balancers
  rationale: Enforcing HTTPS redirection on load balancers ensures data is encrypted in transit, protecting sensitive information from interception and man-in-the-middle attacks. This practice mitigates the risk of data breaches and supports compliance with security standards like PCI-DSS and GDPR, which require secure transmission of data.
  description: This rule checks if a load balancer in OCI is configured to redirect HTTP requests to HTTPS, ensuring secure communication. To verify, review the load balancer listener settings to ensure HTTPS protocols are enforced and HTTP requests are configured to automatically redirect to HTTPS. Remediation involves adjusting the load balancer listener settings in the OCI Console to enable HTTPS redirection, ensuring all traffic is encrypted.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Tasks/usingloadbalancer.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.load_balancer.load_balancer.balancer_deletion_protection
  service: load_balancer
  resource: load_balancer
  requirement: Balancer Deletion Protection
  scope: load_balancer.load_balancer.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Load Balancer Deletion Protection Enabled
  rationale: Enabling deletion protection for load balancers prevents accidental or malicious removal, which can lead to service disruptions and potential data breaches. This is critical for maintaining high availability and ensuring continuity of service, thereby protecting business operations and customer trust. It aligns with compliance requirements for data integrity and resilience within cloud environments.
  description: This rule checks whether deletion protection is enabled on Oracle Cloud Infrastructure load balancers. Deletion protection is a configuration setting that prevents the accidental deletion of critical resources. To verify, access the OCI console, navigate to the load balancer settings, and ensure the deletion protection toggle is activated. If not enabled, modify the settings to activate this feature to safeguard your load balancers from unintended deletions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Reference/loadbalancerapi.htm#delete
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/cloud/cloud-infrastructure-best-practices/
- rule_id: oci.load_balancer.load_balancer.balancer_insecure_ssl_ciphers
  service: load_balancer
  resource: load_balancer
  requirement: Balancer Insecure SSL Ciphers
  scope: load_balancer.load_balancer.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Secure SSL Ciphers on Load Balancer
  rationale: Using insecure SSL ciphers on load balancers can expose sensitive data to interception and unauthorized access, compromising data protection and privacy. This can lead to data breaches and non-compliance with industry regulations such as PCI-DSS and HIPAA, potentially resulting in financial loss and reputational damage.
  description: This rule checks if the load balancer in Oracle Cloud Infrastructure is configured to use secure SSL ciphers. To verify, review the SSL configuration settings in the Load Balancer service to ensure only strong ciphers are enabled. Remediation involves updating the load balancer's SSL policy to use a predefined set of secure ciphers recommended by Oracle, such as 'oci-default' or a custom policy that excludes weak ciphers like RC4 or MD5.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Tasks/managingcertificates.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-1-1-mds-v1-0.pdf
  - https://www.pcisecuritystandards.org/pci_security/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-52r2.pdf
  - https://www.hipaajournal.com/hipaa-compliance-checklist/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.load_balancer.load_balancer.balancer_logging_enabled
  service: load_balancer
  resource: load_balancer
  requirement: Balancer Logging Enabled
  scope: load_balancer.load_balancer.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Load Balancer Logging for Enhanced Monitoring
  rationale: Enabling logging for OCI Load Balancers is crucial for tracking access patterns, diagnosing issues, and identifying potential security threats. Without logging, organizations may miss critical data needed for forensic analysis and compliance with regulations such as PCI-DSS and SOC2, which demand comprehensive monitoring of access and operations.
  description: This rule checks if logging is enabled for OCI Load Balancers. Logging provides detailed records of all requests processed by the load balancer, helping administrators to analyze traffic patterns and troubleshoot issues. To ensure logging is enabled, verify the load balancer's configuration in the OCI Console under the 'Logging' section and ensure that it is set to 'Enabled'. Remediation involves configuring the load balancer to send logs to an OCI Logging service, ensuring logs are retained and accessible for auditing purposes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Tasks/managinglogs.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://docs.oracle.com/en-us/iaas/Content/GSG/Compliance.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.load_balancer.load_balancer.balancer_waf_acl_attached
  service: load_balancer
  resource: load_balancer
  requirement: Balancer Waf ACL Attached
  scope: load_balancer.load_balancer.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Load Balancer Has WAF ACL Attached
  rationale: Attaching a Web Application Firewall (WAF) Access Control List (ACL) to your load balancer is essential for protecting web applications from common threats such as SQL injection, cross-site scripting (XSS), and distributed denial-of-service (DDoS) attacks. Without a WAF, applications are vulnerable to these attacks, potentially leading to data breaches, service disruption, and non-compliance with standards like PCI-DSS and GDPR.
  description: This rule checks if a WAF ACL is attached to the load balancer. A WAF ACL evaluates incoming requests and blocks or allows traffic based on defined rules, providing an additional security layer. To verify, navigate to the OCI Console, access the Load Balancer service, and ensure that a WAF ACL is associated with each load balancer. If not, create and attach a WAF ACL via the OCI WAF service. Regularly update WAF rules to mitigate emerging threats.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/workingwithwafs.htm
  - https://www.oracle.com/security-cloud-compliance/
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-security-best-practices.htm
- rule_id: oci.logging.log_group.bucket_permission_changes_enabled
  service: logging
  resource: log_group
  requirement: Bucket Permission Changes Enabled
  scope: logging.log_group.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Audit Logging for Bucket Permission Changes
  rationale: Monitoring bucket permission changes is crucial for detecting unauthorized access or misconfigurations that could lead to data breaches. By enabling logging for these changes, organizations can maintain accountability, meet compliance requirements, and promptly respond to potential security incidents. This is particularly important for adhering to regulatory standards like GDPR and CCPA, which emphasize data protection and privacy.
  description: This rule checks if bucket permission changes are being logged within OCI Log Groups. To ensure auditability, configure your Log Group to capture all 'ModifyBucket' operations, which include changes to bucket policies and access permissions. Verify the setup by reviewing the log configuration in the OCI console under Logging service and ensure that the relevant logs are being collected and monitored. Remediation involves setting up an appropriate Logging Analytics instance and ensuring all bucket-related activities are captured and analyzed.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-foundation-benchmark-v1-1-0.pdf
  - https://www.nist.gov/privacy-framework
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
  - https://www.oracle.com/security/cloud-security/identity-and-access-management/
- rule_id: oci.logging.log_group.firewall_rule_changes_enabled
  service: logging
  resource: log_group
  requirement: Firewall Rule Changes Enabled
  scope: logging.log_group.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Logging for Firewall Rule Changes in Log Groups
  rationale: Monitoring firewall rule changes is crucial for detecting unauthorized access attempts, preventing data breaches, and ensuring compliance with security policies. Untracked modifications to firewall rules can lead to potential exposure of sensitive data and increased vulnerability to cyber-attacks, impacting business continuity and reputation.
  description: This rule checks if log groups are configured to capture changes to firewall rules within Oracle Cloud Infrastructure. Ensure that logging for firewall rule modifications is enabled by setting up a log group to capture relevant events in the OCI Logging service. Regularly review audit logs to detect and respond to unauthorized changes promptly. Remediation involves configuring logging policies to include firewall rule changes and setting up alerts for suspicious activity.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_2.0.0.pdf
  - https://www.nist.gov/document-800-53
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/compliance/
- rule_id: oci.logging.log_group.instance_configuration_changes_enabled
  service: logging
  resource: log_group
  requirement: Instance Configuration Changes Enabled
  scope: logging.log_group.configuration_management
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Instance Configuration Change Logging
  rationale: Logging instance configuration changes is crucial for tracking unauthorized modifications that could lead to security vulnerabilities or non-compliance. It helps in identifying malicious activities or configuration errors, thus protecting sensitive data and ensuring system integrity. Compliance with standards like PCI-DSS and ISO 27001 often mandates logging of changes to maintain a secure environment.
  description: This check verifies that logging is enabled for instance configuration changes within OCI log groups. Ensure that log groups are configured to capture all changes to instance configurations, which can be done via the OCI Console or API by setting up logging policies. Remediation involves creating or updating log groups to include configuration change logs, and regularly reviewing these logs to detect anomalies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Tasks/enablinglogging.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.logging.log_group.log_analysis_enabled
  service: logging
  resource: log_group
  requirement: Log Analysis Enabled
  scope: logging.log_group.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Log Analysis for OCI Log Groups
  rationale: Enabling log analysis enhances visibility into cloud resources, enabling timely detection of security incidents and operational issues. It helps meet compliance requirements by maintaining comprehensive audit trails and supports threat hunting activities that protect sensitive data from unauthorized access.
  description: This rule checks if log analysis is enabled for OCI log groups, which allows for detailed examination of log data. It's crucial to configure the log group settings to enable log analysis within the OCI Logging service. This can be verified and configured through the OCI Console by ensuring that 'Log Analytics' is turned on for each log group. Remediation involves navigating to the log group and enabling this option to facilitate improved monitoring and auditing capabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Reference/logginglimits.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-92.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.logging.log_group.log_metric_filter_alarm_configured
  service: logging
  resource: log_group
  requirement: Log Metric Filter Alarm Configured
  scope: logging.log_group.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Log Metric Filter Alarms are Configured for Log Groups
  rationale: Configuring log metric filter alarms is crucial for proactively monitoring and responding to potential security incidents. Without these alarms, critical events may go unnoticed, increasing the risk of data breaches or non-compliance with regulatory requirements such as PCI-DSS and SOC 2. Alarms enable real-time alerts, allowing for timely investigations and mitigations.
  description: This rule checks if log metric filters and corresponding alarms are configured for OCI log groups. Proper configuration involves defining metrics based on log patterns and setting up alarms to trigger notifications or automated responses. Verification involves examining log group settings in the OCI console to ensure metrics and alarms are active. Remediation requires creating appropriate metric filters and alarms in the Logging and Monitoring services to ensure key events are tracked and alerts are generated.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.oracle.com/a/ocom/docs/cis-oracle-cloud-infrastructure-foundations-benchmark.pdf
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.logging.log_group.log_metric_filter_and_alert_for_enabled
  service: logging
  resource: log_group
  requirement: Log Metric Filter And Alert For Enabled
  scope: logging.log_group.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Log Metric Filters and Alerts for Log Group
  rationale: Implementing log metric filters and alerts for OCI log groups is crucial for early detection of potential security incidents and operational issues. It enables proactive monitoring and quick response to anomalies, ensuring compliance with regulatory requirements such as PCI-DSS and ISO 27001 by maintaining a secure and auditable environment.
  description: This rule checks if log metric filters and alerts are configured for OCI log groups. Metric filters allow you to define patterns in logs that can trigger alerts, ensuring you are notified of critical events. To verify, access the OCI Console, navigate to the Logging service, and ensure that metric filters and corresponding alerts are set up for each log group. Remediation involves creating metric filters for key log events and configuring alerts that notify relevant personnel or systems of these events.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Tasks/creatingalarmingonlogs.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.logging.log_group.network_changes_enabled
  service: logging
  resource: log_group
  requirement: Network Changes Enabled
  scope: logging.log_group.network_security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Logging for Network Security Changes
  rationale: Monitoring network changes is crucial for identifying unauthorized configuration alterations that may expose vulnerabilities, lead to data breaches, or violate compliance mandates. Effective logging provides visibility into network activities, allowing swift incident response and ensuring adherence to regulatory requirements such as PCI-DSS and ISO 27001.
  description: This rule checks whether logging is enabled for network security changes within log groups in Oracle Cloud Infrastructure. Specifically, it examines the configuration of log groups to ensure that any modifications to network security components, such as security lists and network security groups, are being captured and stored. To verify, navigate to the Logging service in OCI, ensure log groups are configured to capture security-related changes, and set up alerts for critical modifications. Remediation involves enabling audit logs for network components and reviewing log settings to ensure comprehensive coverage.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.oracle.com/cloud/security/compliance/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-security-best-practices.htm
- rule_id: oci.logging.log_group.network_route_changes_enabled
  service: logging
  resource: log_group
  requirement: Network Route Changes Enabled
  scope: logging.log_group.network_security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Logging for Network Route Table Changes
  rationale: Monitoring network route changes is crucial to ensure network integrity and security. Unauthorized or unmonitored changes can lead to potential exposure of sensitive data, unauthorized access, and disruptions in service availability. Enabling logging assists in detecting and responding to anomalies, fulfilling compliance requirements such as PCI-DSS and ISO 27001, and supporting incident response efforts.
  description: This rule checks if logging is enabled for changes to network route tables within an OCI log group. Enabling this logging helps in tracking modifications to network configurations, which are critical for network security posture management. To verify, ensure that a log group is set up to capture route change events from the network security domain. Remediation involves configuring the OCI Logging service to capture and store logs related to route changes, ensuring they are reviewed and monitored regularly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_2.0.htm
  - https://www.pcisecuritystandards.org/pci_security
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.logging.log_group.role_changes_enabled
  service: logging
  resource: log_group
  requirement: Role Changes Enabled
  scope: logging.log_group.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Log Group Role Change Auditing in OCI
  rationale: Monitoring role changes within log groups is crucial as it helps identify unauthorized access attempts and potential insider threats. It ensures that any modification to permissions is tracked, providing accountability and aiding compliance with regulations such as PCI-DSS and ISO 27001, which require detailed logging of security-relevant events.
  description: This rule verifies that auditing is enabled for role changes in Oracle Cloud Infrastructure (OCI) log groups. It checks if log groups are configured to capture changes in role assignments, ensuring that any alterations to access controls are logged. To remediate, enable logging for role changes by configuring an Audit Log with a filter set to include 'LogGroup' events. This ensures that all role change activities are recorded and can be reviewed for suspicious activity.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Reference/loggingoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.logging.log_group.sink_created
  service: logging
  resource: log_group
  requirement: Sink Created
  scope: logging.log_group.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Log Group Sink Creation is Monitored
  rationale: Monitoring the creation of log group sinks is critical to ensure that logs are being directed to the appropriate storage or analysis services, which helps prevent unauthorized access and data leakage. It also supports compliance with regulatory frameworks by ensuring logs are retained and monitored appropriately, reducing the risk of data breaches and improving incident response capabilities.
  description: This rule checks for the creation of sinks within OCI log groups, which are essential for exporting logs to external services such as Object Storage or third-party SIEM solutions. Verify that all log group sinks are configured with the correct policies and permissions to prevent unauthorized access. Remediation involves auditing sink configurations and ensuring they adhere to organizational security and compliance policies by using the OCI Console or CLI to adjust policies as needed.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.oracle.com/cloud/cloud-native/logging/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.monitoring.alarm.alert_create_update_nsg
  service: monitoring
  resource: alarm
  requirement: Alert Create Update Nsg
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Alarms Have Network Security Group Alerts
  rationale: Configuring alarms with Network Security Group (NSG) alerts in OCI is crucial for maintaining visibility into network security configurations and changes. It helps in early detection of unauthorized modifications, preventing potential breaches or compliance violations. Ensuring proper alert setup can mitigate risks related to unauthorized access and data exfiltration, supporting compliance with industry standards such as NIST and PCI-DSS.
  description: This rule checks that alarms within the OCI Monitoring service are configured to generate alerts for any changes made to Network Security Groups (NSGs). This involves verifying that alarms are in place that trigger notifications on creation or updates of NSGs, helping administrators respond promptly to configuration changes. To remediate, configure alarms in OCI Monitoring to track NSG changes and ensure alerting is active. Review and update existing alarm configurations to include NSG-related events for comprehensive security monitoring.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/cis_oci_v1.1.0.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practice.htm
- rule_id: oci.monitoring.alarm.alert_create_update_public_ip_address_rule
  service: monitoring
  resource: alarm
  requirement: Alert Create Update Public Ip Address Rule
  scope: monitoring.alarm.public_access
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: critical
  title: Alert on Public IP Address Changes in OCI Alarms
  rationale: Monitoring changes to public IP addresses on alarms is crucial for detecting unauthorized access and potential exposure of sensitive systems. Public IP changes can indicate misconfigurations or malicious activity, leading to data breaches or service disruptions. Ensuring these alerts comply with regulatory mandates like PCI-DSS and NIST, organizations can mitigate risks associated with unauthorized network exposure.
  description: This rule checks for any creation or update of public IP addresses in OCI alarms. It ensures that alerts are configured to detect when public IPs are added or modified, which could expose services to the internet. Verification involves reviewing alarm configurations in the OCI console to ensure appropriate notifications are in place. Remediation includes setting up notifications and alerts for any changes to public IP settings to maintain visibility and control over network exposure.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/security/cloud-security/best-practices/
- rule_id: oci.monitoring.alarm.alert_create_update_security_solution
  service: monitoring
  resource: alarm
  requirement: Alert Create Update Security Solution
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Alarm Configuration for Security Solution Updates
  rationale: Monitoring alarms for security solution updates is crucial in maintaining the integrity and security of cloud resources. Unauthorized or unexpected changes can indicate a security breach or misconfiguration, leading to potential data exposure and compliance issues. Regular alerts ensure timely detection and response to such changes, helping meet compliance requirements like PCI-DSS and ISO 27001.
  description: This rule checks if alarms are configured to alert on create and update events for security solutions within OCI Monitoring. Ensure that alarms are set up to notify security teams about any changes to security configurations, which can be verified in the OCI Console under the Monitoring service. Remediation involves creating or updating alarms to trigger notifications on specified conditions using the OCI Monitoring service, which can be configured through the console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/creating_alarms.htm
  - https://www.oracle.com/security/cloud-security/cis-oci/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
- rule_id: oci.monitoring.alarm.alert_create_update_sqlserver_fr
  service: monitoring
  resource: alarm
  requirement: Alert Create Update Sqlserver Fr
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Configure SQL Server Alarm for Timely Update Alerts
  rationale: Monitoring SQL Server updates is crucial for maintaining database integrity and security. Unattended updates can lead to vulnerabilities, data breaches, and non-compliance with regulatory standards such as PCI-DSS and SOC2. Alerts ensure timely application of critical patches, mitigating risks associated with outdated software.
  description: This rule checks for the presence of an OCI Monitoring alarm configured to alert on SQL Server update events. The alarm should be set to trigger when update actions are initiated or completed, ensuring administrators are promptly notified. To verify, ensure that the alarm is active and linked to your SQL Server resources. Remediate by creating or updating an alarm with the appropriate metrics and notifications via the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
- rule_id: oci.monitoring.alarm.alert_delete_nsg
  service: monitoring
  resource: alarm
  requirement: Alert Delete Nsg
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Monitor Alarm Deletions in Network Security Groups
  rationale: Regular monitoring of alarm deletions within Network Security Groups (NSGs) is crucial as it helps identify unauthorized changes that may expose cloud resources to potential threats. Alarm deletions could indicate malicious activities aiming to bypass security configurations, compromising the overall security posture. Ensuring that changes are logged and reviewed can aid in meeting compliance requirements for frameworks like ISO 27001 and NIST.
  description: This rule checks for the deletion of alarms associated with Network Security Groups within Oracle Cloud Infrastructure's monitoring service. To verify this, ensure that audit logging is enabled and actively monitoring alarm configurations. Remediation involves setting up notifications or automated responses to investigate and rectify unauthorized deletions, as well as ensuring that alarms are consistently reviewed and updated according to security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm#securitypolicies
  - https://www.oracle.com/security-alerts/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
- rule_id: oci.monitoring.alarm.alert_delete_public_ip_address_rule
  service: monitoring
  resource: alarm
  requirement: Alert Delete Public Ip Address Rule
  scope: monitoring.alarm.public_access
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: critical
  title: Alert on Deletion of Public IP Addresses
  rationale: Monitoring the deletion of public IP addresses is crucial as it can indicate unauthorized access attempts or configuration changes that might lead to service disruption. Public IP addresses are often targeted for attacks, and their unexpected deletion can lead to loss of connectivity and potential data breaches. Ensuring such actions are logged and alerted helps maintain compliance with frameworks such as NIST and ISO 27001, which mandate monitoring of network changes.
  description: This rule checks for the creation of alarms that are configured to alert on the deletion of public IP addresses in OCI. The configuration ensures that any unauthorized or accidental deletion of public IPs is promptly alerted to the security team. To verify, create or update an OCI alarm that triggers notifications when public IP deletions occur. Remediation involves setting up alarms in OCI Monitoring with proper notification channels to ensure timely responses to potential security incidents.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm
  - https://www.oracle.com/cloud/security/
- rule_id: oci.monitoring.alarm.alert_delete_security_solution
  service: monitoring
  resource: alarm
  requirement: Alert Delete Security Solution
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Monitor and Alert on Alarm Deletions
  rationale: Monitoring deletions of alarms in OCI is critical as it helps detect unauthorized or accidental changes that could disable key alerts, potentially leading to unmonitored security incidents. It ensures visibility and control over security configurations, reducing the risk of compliance violations and facilitating prompt incident response.
  description: This rule checks for events where alarms are deleted in the OCI Monitoring service. It verifies that alerts are configured to notify security teams upon such deletions. To remediate, ensure an alarm is set up within OCI to capture deletion events using the 'oci.monitoring.DeleteAlarm' action in the audit logs. Regularly review these logs and alerts to maintain an effective security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf?agreement=true&time=1594666709360
- rule_id: oci.monitoring.alarm.alert_delete_sqlserver_fr
  service: monitoring
  resource: alarm
  requirement: Alert Delete Sqlserver Fr
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Monitor and Alert on SQL Server Deletion Events
  rationale: Monitoring the deletion of SQL Server instances is crucial for maintaining data integrity and preventing unauthorized data loss. Unauthorized deletions can lead to business disruptions, data breaches, and non-compliance with regulations such as GDPR or HIPAA, especially if the SQL Server contains sensitive information.
  description: This rule checks the configuration of alarms in OCI Monitoring to ensure alerts are set up for SQL Server deletion events. Verify that alarms are configured to notify stakeholders of any deletion activity by checking the 'alarm' settings within the OCI console. Remediation involves setting up or modifying alarms to trigger notifications for SQL Server deletions, ensuring real-time awareness and response capabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_security_policies.htm
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
- rule_id: oci.monitoring.alarm.diagnostic_setting_with_appropriate_categories
  service: monitoring
  resource: alarm
  requirement: Diagnostic Setting With Appropriate Categories
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Alarms Have Diagnostic Settings with Relevant Categories
  rationale: Proper diagnostic settings for alarms can help in identifying anomalies and potential security incidents in real-time. Without appropriate diagnostic categories, critical events might be overlooked, leading to delayed responses and increased risk of breaches. This is essential for maintaining compliance with regulations that require continuous monitoring and audit trails.
  description: This rule checks whether alarms in the OCI monitoring service have diagnostic settings configured with appropriate logging categories. To verify, ensure that each alarm has a diagnostic setting that captures categories like 'Audit', 'Security', and 'Operational' logs. Remediation involves configuring the diagnostic settings to include these categories, enabling comprehensive logging and alerting based on security-relevant activities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.oracle.com/cloud/security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.monitoring.alarm.diagnostic_settings_configured
  service: monitoring
  resource: alarm
  requirement: Diagnostic Settings Configured
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Diagnostic Settings for OCI Alarms are Configured
  rationale: Configuring diagnostic settings for OCI alarms is crucial for maintaining visibility into alarm activities, which helps in identifying misconfigurations or malicious activities early. Without these settings, organizations may miss critical alerts, leading to delayed responses to security incidents and potential non-compliance with standards requiring audit logging, such as PCI-DSS and SOC2.
  description: This rule checks whether diagnostic settings are configured for alarms in OCI, ensuring that logs are generated and monitored for all alarm activities. To verify, check the OCI Monitoring service to ensure that logging is enabled for each alarm. If not configured, navigate to the 'Monitoring' section in the OCI Console, select the desired alarm, and enable logging under 'Diagnostic Settings'. This setup aids in proactive monitoring and compliance with security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/monitoringusingalarms.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.oracle.com/security/cloud-security/
  - https://cloudsecurityalliance.org/research/oci
- rule_id: oci.monitoring.alarm.policy_assignment
  service: monitoring
  resource: alarm
  requirement: Policy Assignment
  scope: monitoring.alarm.policy_management
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Alarms Have Appropriate Policy Assignments
  rationale: Policy assignments for alarms are crucial to restrict and manage who can modify or disable critical monitoring alerts. Without proper policy management, unauthorized changes could lead to missed alerts, resulting in undetected security incidents or operational failures. Compliance with frameworks like ISO 27001 and SOC2 often requires stringent monitoring to ensure prompt detection and response to incidents.
  description: This rule checks if alarms in OCI Monitoring are assigned appropriate policies that control access and modification rights. To verify, audit the IAM policies associated with alarms and ensure they follow the principle of least privilege. Remediation involves reviewing IAM policies to ensure that only authorized users and groups have the ability to manage, modify, or disable alarms, thus maintaining the integrity and availability of critical monitoring functions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/monitoringalarmpolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/ocisecuritybestpractices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v4/
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.monitoring.alarm.storage_with_activity_logs_cmk_encrypted
  service: monitoring
  resource: alarm
  requirement: Storage With Activity Logs CMK Encrypted
  scope: monitoring.alarm.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Alarms for Logs Use CMK Encryption in OCI
  rationale: Encrypting storage with customer-managed keys (CMK) ensures that sensitive log data is protected against unauthorized access. This mitigates the risk of data breaches and aligns with regulatory requirements for data encryption, such as GDPR and CCPA, which mandate the protection of personal data. Using CMK also provides control over encryption keys, allowing businesses to manage key rotation and lifecycle, enhancing data governance.
  description: This rule checks that all alarms associated with activity logs in Oracle Cloud Infrastructure are using storage encrypted with customer-managed keys (CMK). To verify, ensure that the storage for alarm logs is configured to use CMK rather than Oracle-managed keys (OMK). Remediation involves enabling CMK encryption on the relevant storage resources by selecting a customer-managed key from the Key Management service in OCI. This provides enhanced security and control over the encryption process.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - 'NIST SP 800-57 Part 1: Recommendation for Key Management'
  - 'PCI-DSS Requirement 3.5: Protect cryptographic keys'
  - https://cloudsecurityalliance.org/artifacts/oracle-cloud-infrastructure-security-best-practices/
- rule_id: oci.monitoring.alarm.storage_with_activity_logs_is_private
  service: monitoring
  resource: alarm
  requirement: Storage With Activity Logs Is Private
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Storage Buckets with Activity Logs Are Private
  rationale: Allowing public access to storage buckets containing activity logs can expose sensitive operational data, leading to potential security incidents and data breaches. This risk scenario undermines audit and compliance efforts, especially for organizations subject to regulatory requirements such as PCI-DSS, HIPAA, or SOC2, which mandate the protection of log data integrity and confidentiality.
  description: This rule checks whether storage buckets used for OCI Monitoring alarms' activity logs are set to private. Public access should be disabled to prevent unauthorized users from accessing sensitive monitoring data. Verify by navigating to the Oracle Cloud Infrastructure Console, selecting Object Storage, and confirming bucket settings are configured as private. Remediation involves updating the bucket's access policy to restrict public access and ensuring that only authorized IAM users can access the logs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/objectstoragemanagingbuckets.htm
  - https://cloudsecurityalliance.org/research/artifacts/cis-oci-benchmark-v1-1/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/privacy/laws-regulations/index.html
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/sorhome.html
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.monitoring.alarm.alarm_configured
  service: monitoring
  resource: alarm
  requirement: Alarm Configured
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure OCI Monitoring Alarm is Properly Configured
  rationale: Properly configured alarms are crucial for timely detection of anomalies and potential security threats in your OCI environment. They provide real-time insights and prompt notifications, allowing swift response to incidents, which mitigates risk and aids in maintaining system integrity. Furthermore, regulatory standards often require robust monitoring mechanisms to ensure compliance and protect sensitive data.
  description: This rule checks whether alarms are configured in Oracle Cloud Infrastructure's Monitoring service. An alarm should be set up to track critical metrics and thresholds that align with your security policies. To verify, ensure alarms are created with appropriate metrics and notification channels, such as email or OCI Notifications service. Remediation involves creating or updating alarms to monitor essential resources and configuring notifications for alerting relevant stakeholders.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/creating-alarms.htm
  - https://www.oracle.com/security/cis-oracle-cloud-infrastructure-foundations-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/cloud/cloud-security/posture-management/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm#monitoring
  - https://www.oracle.com/cloud/whitepapers/best-practices-for-architecting-cloud-environments/
- rule_id: oci.monitoring.alarm.changes_to_network_acls_alarm_configured
  service: monitoring
  resource: alarm
  requirement: Changes To Network Acls Alarm Configured
  scope: monitoring.alarm.network_security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Alarm for Changes to Network ACLs in OCI Configured
  rationale: Monitoring changes to Network ACLs is critical as unauthorized modifications can lead to exposure of sensitive data, unauthorized access, and potential data breaches. It helps in maintaining the security posture by ensuring that all changes are intentional and compliant with organizational security policies. This is vital for adhering to compliance requirements like PCI-DSS and ISO 27001, which mandate monitoring and logging of access control changes.
  description: This rule checks that an alarm is configured to detect changes to Network ACLs within Oracle Cloud Infrastructure. Specifically, it verifies the presence of an alarm that triggers on modifications to network access control lists, ensuring any changes are logged and alerted for review. To configure, create an OCI Monitoring Alarm targeting the log group associated with Network ACL changes, set appropriate thresholds, and configure notifications. Regularly review and update alarm settings to match evolving security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam_troubleshoot.htm#Troubleshooting_Changes
  - CIS OCI Benchmark
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.monitoring.alarm.changes_to_network_gateways_alarm_configured
  service: monitoring
  resource: alarm
  requirement: Changes To Network Gateways Alarm Configured
  scope: monitoring.alarm.network_security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Monitor Changes to Network Gateway Alarms
  rationale: Monitoring for changes to network gateways is critical to detect unauthorized modifications that could expose your cloud infrastructure to security risks such as data breaches or unauthorized access. By having alarms configured, you ensure prompt detection and response to potential threats, aligning with compliance requirements like NIST and ISO 27001, which emphasize continuous monitoring and incident response.
  description: This rule checks whether alarms are configured to detect changes to network gateways in OCI. Ensure that alarms are set up using the OCI Monitoring service to track modifications to Internet Gateways, NAT Gateways, and DRGs. Verification involves reviewing your alarm configurations in the OCI Console to ensure they cover gateway changes. Remediation includes setting up or updating alarms to trigger alerts on gateway changes, utilizing OCI's native monitoring and notification tools for effective incident management.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1_0_0.htm
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
- rule_id: oci.monitoring.alarm.changes_to_network_route_tables_alarm_configured
  service: monitoring
  resource: alarm
  requirement: Changes To Network Route Tables Alarm Configured
  scope: monitoring.alarm.network_security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Monitor Changes to Network Route Tables with Alarms
  rationale: Monitoring changes to network route tables is crucial as unauthorized alterations can lead to disruptions in network traffic, potential exposure to security threats, and non-compliance with regulatory standards. Alerts on such changes enable quick detection and response to potential misconfigurations or malicious activities, safeguarding the integrity and availability of network resources.
  description: This rule checks the configuration of alarms within OCI Monitoring to ensure alerts are set for any changes to network route tables. Proper configuration involves setting up alarms to trigger notifications when modifications occur, allowing for swift investigation and remediation. To verify, check the alarm settings in the OCI Console under Monitoring, ensuring the alarm condition targets the specific route table change events. Remediate by setting up detailed notifications using OCI Events and Notifications services to alert relevant teams.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/ocisecuritylisting.htm#oci-security-guide
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://docs.oracle.com/en-us/iaas/Content/audit/Concepts/auditoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.nist.gov/cyberframework
- rule_id: oci.monitoring.alarm.changes_to_vpcs_alarm_configured
  service: monitoring
  resource: alarm
  requirement: Changes To Vpcs Alarm Configured
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Monitor Changes to VPCs with Configured Alarms
  rationale: Monitoring changes to Virtual Private Clouds (VPCs) is crucial for maintaining network integrity and preventing unauthorized modifications that could lead to data breaches or service disruptions. Alarms configured for VPC changes help in promptly detecting and responding to potential security incidents, thereby supporting compliance with regulatory frameworks like PCI-DSS and ISO 27001 that mandate rigorous monitoring of network configurations.
  description: This rule checks whether alarms are configured to monitor changes to VPC configurations. It involves setting up OCI Monitoring Alarms that trigger notifications whenever alterations in VPCs, such as changes in route tables or security lists, are detected. Ensuring these alarms are active allows for real-time alerts, enabling swift investigation and mitigation of unauthorized changes. To verify, check the OCI Monitoring service for active alarms related to VPC modifications and review their configuration for appropriate thresholds and notification settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-foundations-benchmark/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/best-practices/
- rule_id: oci.monitoring.alarm.changes_to_vcns_alarm_configured
  service: monitoring
  resource: alarm
  requirement: Changes To Vcns Alarm Configured
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Monitor Changes to VCNs Alarm Configuration
  rationale: Monitoring changes to Virtual Cloud Networks (VCNs) alarm configurations is crucial for maintaining network security posture. Unauthorized or unintended modifications can lead to exposure of sensitive data, disruption of services, and non-compliance with regulatory standards. Ensuring that any changes are promptly detected and analyzed helps mitigate risks associated with network misconfigurations or malicious activities.
  description: This rule checks for configured alarms that monitor changes to VCN configurations in Oracle Cloud Infrastructure (OCI). It ensures that any alterations to VCNs, which could impact network security or operations, are tracked. Verify that alarms are set to notify appropriate personnel when changes occur. Remediation includes configuring alarms to cover all critical VCN components and ensuring alerts reach responsible parties for prompt action.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://www.oracle.com/security/cloud-security/best-practices/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-144.pdf
  - https://www.cisecurity.org/benchmark/oracle_cloud/
- rule_id: oci.monitoring.alarm.cpu_utilization_alarm_configured
  service: monitoring
  resource: alarm
  requirement: Cpu Utilization Alarm Configured
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure CPU Utilization Alarm is Configured in OCI
  rationale: Monitoring CPU utilization is crucial for maintaining system performance and availability. Without proper alarms, high CPU usage may go unnoticed, leading to degraded application performance or service outages. This could impact business operations and customer satisfaction. Additionally, consistent monitoring is a compliance requirement for frameworks like ISO 27001, which mandates effective incident detection processes.
  description: This rule checks if a CPU Utilization Alarm is configured for your resources in Oracle Cloud Infrastructure (OCI). To verify, ensure alarms are set to trigger when CPU usage exceeds a defined threshold, allowing timely response to potential issues. Remediation involves creating an alarm in the OCI Monitoring service with thresholds aligned to your operational requirements. Adjust thresholds based on typical workload patterns to avoid false positives.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.oracle.com/security/cloud-security/oci-security.html
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
- rule_id: oci.monitoring.alarm.group_changes
  service: monitoring
  resource: alarm
  requirement: Group Changes
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Monitor Changes to OCI Alarm Configurations
  rationale: Monitoring changes to alarm configurations in OCI is critical to ensure that alerts remain effective and relevant. Unauthorized or accidental modifications can lead to missed critical alerts, impacting operational continuity and increasing security risks. Ensuring alarm integrity aligns with compliance requirements such as ISO 27001 and helps in early threat detection and response.
  description: This rule checks for any modifications made to OCI alarm configurations, including changes in thresholds, notification endpoints, and enabled/disabled status. To verify, audit logs should be enabled and regularly reviewed for alarm change events. Remediation involves configuring IAM policies to restrict access to modify alarms and setting up notifications for any alarm configuration changes. Use the OCI Console or CLI to review and manage alarm settings and permissions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://oracle-cloud-security.com/cis-oci-benchmark
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_iam_troubleshoot.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/auditlogoverview.htm
- rule_id: oci.monitoring.alarm.group_kms_encryption_enabled
  service: monitoring
  resource: alarm
  requirement: Group KMS Encryption Enabled
  scope: monitoring.alarm.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure KMS Encryption Enabled for OCI Monitoring Alarms
  rationale: Enabling KMS encryption for monitoring alarms ensures that sensitive alert data is protected against unauthorized access and potential data breaches. This is crucial for maintaining the confidentiality and integrity of operational data, which can be targeted in sophisticated cyber threats. Compliance with data protection regulations, such as GDPR and PCI-DSS, often mandates encryption of data at rest, making this control essential for avoiding legal penalties and safeguarding customer trust.
  description: This rule verifies that Oracle Cloud Infrastructure (OCI) monitoring alarms utilize Key Management Service (KMS) encryption for data at rest. To ensure compliance, configure alarms to use encryption keys from OCI Vault, which provides robust key management capabilities. Verify the encryption settings in the OCI console under the alarm configuration section. If not enabled, modify the alarm settings to integrate with an OCI Vault key or create a new encryption key using OCI Key Management, then apply it to the alarm resource.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/monitoringalarms.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.oracle.com/security/cloud-security/key-management/
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
- rule_id: oci.monitoring.alarm.group_retention_policy_specific_days_enabled
  service: monitoring
  resource: alarm
  requirement: Group Retention Policy Specific Days Enabled
  scope: monitoring.alarm.policy_management
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Specific Days for OCI Alarm Retention Policy
  rationale: Configuring specific days for group retention policies in OCI alarms is crucial for maintaining a streamlined monitoring environment. It reduces the risk of data clutter and ensures that only relevant historical data is retained, which aids in efficient incident response and auditing. Moreover, it supports compliance with data retention mandates found in regulatory frameworks such as PCI-DSS and GDPR.
  description: This rule checks whether specific days are set for the retention policy of OCI monitoring alarms. To verify, ensure that the retention settings in the OCI console or via CLI/API specify particular days for which alarms should be kept, aligning with organizational audit and compliance requirements. Remediation involves navigating to the OCI Monitoring service, selecting the appropriate alarm, and configuring the retention policy to specify exact days for data retention, thereby optimizing storage and ensuring compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/cloud/cloud-security.html
  - https://www.oracle.com/security/cloud-security/compliance/
- rule_id: oci.monitoring.alarm.group_vault_encryption_enabled
  service: monitoring
  resource: alarm
  requirement: Group Vault Encryption Enabled
  scope: monitoring.alarm.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure OCI Monitoring Alarms Use Vault-Based Encryption
  rationale: Enabling vault-based encryption for monitoring alarms ensures that sensitive data and metadata related to alarms are protected against unauthorized access and potential data breaches. This is crucial for maintaining trust, meeting compliance requirements such as PCI-DSS, and safeguarding business operations by preventing data exposure and manipulation.
  description: This rule checks whether Oracle Cloud Infrastructure (OCI) monitoring alarms are configured to use encryption keys managed through Oracle Cloud Vault. To verify, confirm that each alarm's configuration includes encryption settings tied to a customer-managed key. Remediation involves configuring the alarm settings to use a key from the Oracle Cloud Vault, ensuring that the encryption is applied to alarm data at rest.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.oracle.com/security/cloud-security/vault/
  - CIS OCI Foundations Benchmark
  - https://www.nist.gov/itl/nist-special-publication-800-53
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
- rule_id: oci.monitoring.alarm.log_group_kms_encryption_enabled
  service: monitoring
  resource: alarm
  requirement: Log Group KMS Encryption Enabled
  scope: monitoring.alarm.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Log Group KMS Encryption is Enabled for Alarms
  rationale: Enabling KMS encryption for log groups in OCI ensures that sensitive alarm data is protected from unauthorized access, both at rest and in transit. This is crucial for maintaining data confidentiality and integrity, especially in environments subject to stringent regulatory requirements such as PCI-DSS and HIPAA. Failure to encrypt log data can lead to data breaches, compliance violations, and significant financial and reputational damage.
  description: This check verifies that log groups associated with OCI monitoring alarms have KMS-based encryption enabled. To ensure compliance, users must configure each log group with a Key Management Service (KMS) key. Verification can be done through the OCI Console by navigating to the Monitoring service, selecting the relevant log group, and checking the encryption settings. Remediation involves enabling KMS encryption for any unencrypted log groups by associating them with a customer-managed key (CMK) in the OCI Vault. This enhances data security and aligns with best practices for data protection at rest.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/security/Concepts/security_iam.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57p1r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.monitoring.alarm.log_group_retention_policy_specific_days_enabled
  service: monitoring
  resource: alarm
  requirement: Log Group Retention Policy Specific Days Enabled
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Log Group Retention Policy is Set for Specific Days
  rationale: Properly configured log retention policies in OCI are crucial for maintaining an effective audit trail and ensuring compliance with legal and regulatory requirements such as GDPR, PCI-DSS, and HIPAA. Without a specific retention policy, critical audit logs might be prematurely deleted, potentially leading to data loss or inadequate forensic capabilities in the event of a security incident.
  description: This rule checks if an Oracle Cloud Infrastructure log group associated with monitoring alarms has a specific retention policy set in days. It ensures that logs are retained for an appropriate duration, allowing for sufficient time to conduct audits and investigations. To verify, navigate to the OCI Console, access the Logging service, and check the retention policy settings for each log group. Remediate by setting a specific retention period that aligns with organizational policies and compliance requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_benchmark.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.monitoring.log.group_retention_policy_specific_days_enabled
  service: monitoring
  resource: log
  requirement: Group Retention Policy Specific Days Enabled
  scope: monitoring.log.policy_management
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Log Group Retention Policy is Configured to Specific Days
  rationale: Configuring log group retention policies to specific days ensures that logs are retained only for the necessary duration, reducing the risk of unauthorized access to sensitive information and aligning with data retention regulations. It also optimizes storage costs by preventing unnecessary accumulation of log data. This practice helps organizations meet compliance mandates such as GDPR and acts as a safeguard against potential data breaches.
  description: This rule verifies that Oracle Cloud Infrastructure (OCI) log groups have retention policies set to a specific number of days, ensuring logs are automatically deleted after this period. To check this, navigate to the 'Logging' section in the OCI console, select 'Log Groups', and review each group's retention settings. If a log group lacks a specific retention policy, configure it by editing the log group and setting the desired retention period. This ensures compliance with organizational data policies and cost management strategies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.oracle.com/security-cloud/compliance/
  - https://cloudsecurityalliance.org/star/registry/oracle-cloud-infrastructure/
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Tasks/managinglogs.htm
- rule_id: oci.monitoring.alarm.log_metric_filter_and_alarm_for_enabled
  service: monitoring
  resource: alarm
  requirement: Log Metric Filter And Alarm For Enabled
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Implement Log Metric Filter and Alarm for Key Events
  rationale: Monitoring and alerting on key log events enable proactive identification of security incidents and operational issues in real-time. This enhances an organization's ability to respond promptly to threats, minimizing potential damage and ensuring compliance with frameworks such as ISO 27001 and SOC2. Failing to monitor critical events can lead to undetected security breaches and non-compliance with regulatory requirements.
  description: This rule checks for the presence of alarms associated with log metric filters on critical OCI events, ensuring that significant occurrences within the environment are tracked and alerted. Configure log metric filters to capture vital security and operational events, and set up alarms to notify stakeholders when these events are triggered. Verify configurations in the OCI Console under Monitoring > Alarms, ensuring each alarm is set to notify relevant parties through appropriate channels such as email or PagerDuty. Remediation involves creating or modifying log filters and alarms for completeness and accuracy.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/monitoringalarms.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Tasks/loggingoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.monitoring.alarm.log_metric_filter_authentication_failures
  service: monitoring
  resource: alarm
  requirement: Log Metric Filter Authentication Failures
  scope: monitoring.alarm.authentication
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: high
  title: Monitor and Alert on Authentication Failures in OCI
  rationale: Monitoring authentication failures is crucial for identifying potential unauthorized access attempts and mitigating security risks such as account compromise and insider threats. By detecting and responding to authentication failures, organizations can prevent data breaches and ensure compliance with regulatory requirements like PCI-DSS and ISO 27001, which mandate strict access control and audit logging.
  description: This rule checks for the existence of an OCI Alarm configured to monitor and alert on authentication failures by using log metric filters. The alarm should be set to detect anomalies in authentication attempts by analyzing log data for failed logins. To verify, ensure an OCI alarm is configured to trigger notifications when the threshold for failed authentication attempts is reached. Remediation involves setting up appropriate log metric filters and alarms within the OCI monitoring service to alert security teams for immediate action.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/monitoringquerylanguage.htm
  - https://docs.oracle.com/en-us/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/monitoring/alarm/index.html
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm#security_controls
  - https://cloud.oracle.com/en_US/cloud-security/cloud-security-controls
- rule_id: oci.monitoring.alarm.log_metric_filter_disable_or_scheduled_cmk
  service: monitoring
  resource: alarm
  requirement: Log Metric Filter Disable Or Scheduled CMK
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Alarms Use Active or Scheduled CMK for Log Metrics
  rationale: Using active or scheduled Customer-Managed Keys (CMKs) for log metric filters in alarms is crucial for maintaining data confidentiality and integrity. Without proper encryption, sensitive log data might be exposed to unauthorized access, leading to potential data breaches and compliance violations. This practice aligns with regulatory requirements for data protection and encryption standards.
  description: This rule checks that all log metric filters associated with OCI alarms use either active or scheduled Customer-Managed Keys (CMKs) for encryption. It ensures that the CMKs are not disabled, which could compromise the security of log data. To verify, review the alarm configurations in the OCI Console, ensuring that the CMKs are set to 'Active' or have a scheduled activation. Remediation involves updating the CMK status to active or scheduling activation as needed.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/alarmsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
- rule_id: oci.monitoring.alarm.log_metric_filter_for_s3_bucket_policy_changes
  service: monitoring
  resource: alarm
  requirement: Log Metric Filter For S3 Bucket Policy Changes
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Monitor S3 Bucket Policy Changes via Log Metric Filter
  rationale: Monitoring S3 bucket policy changes is crucial for detecting unauthorized access alterations that could lead to data exposure or loss. By logging these changes, organizations can quickly identify and respond to potential security incidents, thereby mitigating the risk of data breaches and ensuring compliance with regulatory frameworks such as PCI-DSS and ISO 27001.
  description: This rule checks for the presence of a log metric filter that triggers an alarm when there are changes to S3 bucket policies. To verify compliance, ensure that your OCI monitoring setup includes an alarm configured with a log metric filter that captures and alerts on policy changes. Remediation involves creating or updating the OCI alarm to include this log metric filter, ensuring real-time monitoring and alerting of policy modifications.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.monitoring.alarm.log_metric_filter_policy_changes
  service: monitoring
  resource: alarm
  requirement: Log Metric Filter Policy Changes
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Monitor Metric Filter Policy Changes in OCI Alarms
  rationale: Monitoring changes to metric filter policies is crucial for maintaining the integrity and accuracy of alarm notifications. Unauthorized or unintended modifications can lead to missed alerts or false positives, impacting operational visibility and response times. This is particularly important for compliance with frameworks requiring robust audit logging, such as PCI-DSS and ISO 27001.
  description: This rule checks for the existence and configuration of logging for metric filter policy changes in OCI alarms. To verify, ensure that audit logs are enabled and that all modifications to alarm metric filters are being recorded. Remediation involves setting up an Oracle Cloud Infrastructure Audit service to capture and review any changes to alarm configurations. Regularly review these logs to detect unauthorized changes and maintain an effective monitoring posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/security/Reference/oci-security-services.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Tasks/loggingquickstart.htm
  - https://www.pcisecuritystandards.org/pci_security
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.monitoring.log.metric_filter_policy_changes
  service: monitoring
  resource: log
  requirement: Metric Filter Policy Changes
  scope: monitoring.log.policy_management
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Monitor and Alert on OCI Log Metric Filter Changes
  rationale: Monitoring changes to log metric filters is crucial as unauthorized modifications can lead to misconfigured alerts, impacting the detection of security incidents. This can result in delayed responses to threats, potential data breaches, and non-compliance with regulations such as GDPR or SOC2. Regular monitoring helps mitigate these risks by ensuring the integrity of logging policies.
  description: This rule checks for any modifications to metric filters in OCI Logging, ensuring that changes are intentional and authorized. It verifies that audit logs are generated whenever a metric filter is added, updated, or deleted. To remediate, ensure that only authorized personnel have permissions to modify log metric filters, and implement an alerting mechanism for any changes. Regularly review and audit the changes to maintain compliance and security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Tasks/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-1-1-0.pdf
  - https://www.oracle.com/security/cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Tasks/monitoringlogs.htm
  - https://www.nist.gov/document-2233
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.monitoring.alarm.log_metric_filter_root_usage
  service: monitoring
  resource: alarm
  requirement: Log Metric Filter Root Usage
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: critical
  title: Alarm for Root User Log Metric Filter Usage
  rationale: Monitoring the usage of root user accounts is critical because these accounts have unrestricted privileges and can make extensive changes to the cloud environment. Unauthorized or excessive use of root accounts can lead to security breaches, compliance violations, and significant business disruptions. Ensuring that root usage is logged and monitored helps detect potential misuse and supports adherence to regulatory requirements.
  description: This rule checks for the presence of an alarm configured to monitor log metrics related to root user activity. It ensures that any use of the root account is logged and alerts are set up to notify administrators of such events. To verify this setting, ensure that a metric filter is applied to logs capturing root activity and an associated alarm is active. Remediate by configuring a log metric filter on root user actions and establishing an alarm to trigger notifications when these logs are generated.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/ocisecuritybestpractices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.monitoring.alarm.log_metric_filter_security_group_changes
  service: monitoring
  resource: alarm
  requirement: Log Metric Filter Security Group Changes
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Monitor Security Group Changes via Log Metric Alarms
  rationale: Monitoring changes to security groups is critical for maintaining the security posture of your OCI infrastructure. Unauthorized or unintended modifications can expose your resources to potential threats and breaches. Keeping track of these changes helps ensure compliance with security policies and regulatory requirements, such as PCI-DSS and ISO 27001.
  description: This rule checks for an OCI Monitoring Alarm configured to track log metric filters that detect changes to security groups. It involves setting up a metric filter on audit logs to capture events related to security group modifications and configuring an alarm to alert on these changes. Regularly review and validate these alarms to ensure they are active and correctly configured to respond to unauthorized changes in a timely manner.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/monitoringusingalarms.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_approach.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.monitoring.alarm.log_metric_filter_sign_in_without_mfa
  service: monitoring
  resource: alarm
  requirement: Log Metric Filter Sign In Without MFA
  scope: monitoring.alarm.authentication
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: high
  title: Monitor Sign-In Events Without MFA Using OCI Alarms
  rationale: Monitoring sign-in attempts without Multi-Factor Authentication (MFA) is crucial for detecting potential unauthorized access. Failure to enforce MFA can lead to security breaches, resulting in data loss, financial damage, and non-compliance with standards like NIST SP 800-53 and PCI-DSS, which mandate strong authentication measures.
  description: This rule checks for OCI alarm configurations that monitor log metrics for sign-in events without MFA. Ensure that alarms are set up to trigger notifications when a sign-in occurs without MFA, enabling swift incident response. To verify, review the OCI Monitoring service to confirm that alarms are configured with log metric filters targeting 'sign-in without MFA' events. Remediation involves creating or updating alarms with the appropriate log metric filters and ensuring notifications are properly set up.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_authentication.htm
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/cloud/security/best-practices/
- rule_id: oci.monitoring.alarm.log_metric_filter_unauthorized_api_calls
  service: monitoring
  resource: alarm
  requirement: Log Metric Filter Unauthorized API Calls
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: high
  title: Monitor Unauthorized API Calls with Log Metric Alarms
  rationale: Detecting unauthorized API calls is critical for identifying potential security breaches and unauthorized access to cloud resources. Such monitoring helps in early detection of malicious activities, preventing data breaches, and meeting compliance requirements such as PCI-DSS and ISO 27001. Unauthorized access can lead to data exfiltration, service disruption, and financial loss.
  description: This rule verifies the configuration of alarms in OCI Monitoring to detect unauthorized API calls using log metric filters. Ensure that logs are ingested from the Audit service and filtered to identify anomalies indicative of unauthorized access. To verify, configure a log-based metric filter that captures 'Unauthorized' or 'Access Denied' events and set up an alarm to trigger notifications. Remediate by creating or updating log metric filters and alarms to actively monitor and alert on such unauthorized activities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.monitoring.alarm.log_metric_filter_oracle_organizations_changes
  service: monitoring
  resource: alarm
  requirement: Log Metric Filter Oracle Organizations Changes
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Monitor Oracle Organization Changes via Log Metric Alarms
  rationale: Tracking changes in Oracle Organizations is crucial for detecting unauthorized access or modifications, which can lead to data breaches or compliance violations. By setting alarms on specific logs, businesses can quickly respond to potentially malicious activity, thereby mitigating risk and ensuring adherence to regulatory standards like SOC2 and ISO 27001.
  description: This rule checks for the presence of alarms configured to monitor log metrics related to changes in Oracle Organizations. To verify, ensure log metric filters are applied to capture relevant changes and that alarms are set to trigger notifications when these metrics are logged. Remediation involves creating a log metric filter targeting Oracle Organization changes and setting up an alarm to monitor this filter in OCI Monitoring, ensuring timely alerts for any suspicious activity.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingorgs.htm
  - ISO 27001:2013 A.12.4 Logging and monitoring
  - SOC 2 - Security Principle
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
- rule_id: oci.monitoring.alarm.memory_utilization_alarm_configured
  service: monitoring
  resource: alarm
  requirement: Memory Utilization Alarm Configured
  scope: monitoring.alarm.security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Memory Utilization Alarm is Configured
  rationale: Configuring memory utilization alarms is crucial for proactive resource management and operational efficiency. Unmonitored memory spikes can lead to application downtime, increased latency, and potential financial losses. This practice helps in meeting regulatory requirements by ensuring that critical infrastructure components are continuously monitored, adhering to compliance standards such as NIST and ISO 27001.
  description: This rule checks if alarms are configured to monitor memory utilization on Oracle Cloud Infrastructure (OCI). It ensures that thresholds for memory usage are set to alert administrators before resources are exhausted, allowing for timely intervention. Verification involves checking the OCI Monitoring service for alarms with defined metrics on memory usage. Remediation includes setting up an alarm with appropriate memory utilization metrics and thresholds through the OCI Console or using the OCI CLI, ensuring the 'memory_utilization' metric is tracked.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/creating_alarms.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
- rule_id: oci.monitoring.alarm.network_acls_alarm_configured
  service: monitoring
  resource: alarm
  requirement: Network Acls Alarm Configured
  scope: monitoring.alarm.network_security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Network ACLs Alarm is Configured for OCI Monitoring
  rationale: Proper configuration of network ACLs alarms is crucial to detect and respond to unauthorized access attempts or misconfigurations that could lead to data breaches or service disruptions. Monitoring and alerting for network ACL changes can help maintain compliance with standards like PCI-DSS and ISO 27001 by ensuring that any unauthorized changes are promptly addressed, thus protecting the organization's sensitive data and maintaining trust.
  description: This rule checks if alarms are configured for changes to network ACLs within OCI. Monitoring changes to these ACLs helps detect unauthorized modifications that could expose services to security risks. To verify, ensure that alarms are set up in the Monitoring service to alert on any ACL changes. Remediation involves creating a new alarm in the OCI Monitoring console that triggers on events related to network ACL modifications. Regularly review and test the alarm configuration to ensure it is functioning as expected.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.monitoring.alarm.network_gateways_alarm_configured
  service: monitoring
  resource: alarm
  requirement: Network Gateways Alarm Configured
  scope: monitoring.alarm.network_security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Network Gateway Alarms Configured in OCI
  rationale: Configuring alarms for network gateways is crucial for timely detection of unauthorized access or configuration changes, which can lead to data breaches or service disruptions. It helps in maintaining compliance with regulations that require monitoring of network activities and facilitates incident response by alerting administrators to potential security threats.
  description: This check verifies if alarms are configured for network gateways in OCI to monitor critical metrics and events such as traffic anomalies, unauthorized access attempts, and configuration changes. To ensure alarms are properly configured, set up OCI Monitoring Alarms with appropriate thresholds and actions for your network gateways. Remediation involves creating or updating alarms in the OCI console under Monitoring with specific conditions tailored to your security policies and operational needs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.oracle.com/security/cis-benchmarks/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security-best-practices/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.monitoring.alarm.network_route_tables_alarm_configured
  service: monitoring
  resource: alarm
  requirement: Network Route Tables Alarm Configured
  scope: monitoring.alarm.network_security
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Configure Alarms for Network Route Table Changes
  rationale: Monitoring network route table changes is crucial for maintaining the integrity and security of your cloud environment. Unauthorized or unmonitored changes can lead to misconfigurations, potential data breaches, or disruption of services. Ensuring alarms are configured helps meet compliance requirements and provides early detection of suspicious activities.
  description: This rule checks that alarms are configured on Oracle Cloud Infrastructure to monitor changes in network route tables. Specifically, it verifies that alarms are set up to notify administrators when modifications occur, ensuring prompt response to potential security incidents. To verify, ensure that OCI alarms are configured in the Monitoring service with appropriate metrics and thresholds related to route table alterations. Remediation involves setting up alarms through the OCI console or CLI with metrics that track changes in network configurations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/creatingalarms.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/routing.htm
  - 'CIS OCI Benchmark: https://www.cisecurity.org/benchmark/oracle_cloud'
  - 'NIST SP 800-53: CM-6 Configuration Change Control'
  - 'PCI DSS Requirement 10: Track and monitor all access to network resources'
  - ISO 27001:2013 A.12.4 Logging and Monitoring
- rule_id: oci.monitoring.alarm.policy_changes
  service: monitoring
  resource: alarm
  requirement: Policy Changes
  scope: monitoring.alarm.policy_management
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Monitor Policy Changes in OCI Alarms
  rationale: Monitoring policy changes in OCI alarms is vital to ensure that unauthorized or unintentional modifications do not lead to security vulnerabilities or compliance violations. Alterations in alarm policies can impact the detection of critical events, resulting in delayed responses to incidents. Maintaining audit trails of policy changes helps in meeting regulatory compliance such as PCI-DSS and ISO 27001.
  description: This rule checks for any changes in the policies associated with OCI alarms, ensuring that all modifications are logged and reviewed. Verification involves enabling audit logging for alarms and regularly reviewing logs for policy change events. Remediation includes configuring Oracle Cloud Infrastructure Audit service to capture and alert on policy changes, ensuring all changes are authorized and documented.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/GSG/Tasks/loggingaudit.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.monitoring.alarm.storage_bucket_policy_changes
  service: monitoring
  resource: alarm
  requirement: Storage Bucket Policy Changes
  scope: monitoring.alarm.policy_management
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Monitor Changes to Storage Bucket Policies
  rationale: Changes to storage bucket policies can inadvertently expose sensitive data or disrupt business operations if not monitored. Unauthorized modifications can lead to data breaches, violate compliance requirements, and cause financial or reputational damage. Regular monitoring helps ensure that only authorized changes occur, maintaining data integrity and security.
  description: This rule checks for any modifications to storage bucket policies by setting up an alarm in Oracle Cloud Infrastructure (OCI) Monitoring. It verifies that alarms are configured to detect any changes in bucket policies and alert the relevant security teams. To implement this, configure an alarm to trigger based on logs from the audit service that records bucket policy changes. Ensure that these alarms are active and notifications are correctly routed to the responsible parties for timely investigation and response.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - CIS OCI Benchmark
  - https://www.pcisecuritystandards.org/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-compliance/
- rule_id: oci.streaming.stream.broker_logging_enabled
  service: streaming
  resource: stream
  requirement: Broker Logging Enabled
  scope: streaming.stream.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Broker Logging is Enabled for OCI Streaming
  rationale: Enabling broker logging for OCI Streaming is crucial for maintaining an audit trail of all activities related to stream processing. This logging helps detect unauthorized access and potential data breaches, ensuring compliance with regulatory frameworks such as GDPR and HIPAA. It aids in forensic analysis and supports operational troubleshooting by providing detailed logs of broker events.
  description: This rule checks whether logging is enabled for brokers within OCI Streaming services. Broker logging captures detailed events and activities, which can be configured in the OCI Console under the Logging section of the Stream service. To enable broker logging, navigate to the specific stream, select 'Logging', and ensure that 'Broker Logging' is set to 'Enabled'. Remedial action involves enabling this feature to capture all necessary audit logs for compliance and security monitoring.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Tasks/streaminglogging.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.mysql.db_system.flexible_server_audit_log_connection_activated
  service: mysql
  resource: db_system
  requirement: Flexible Server Audit Log Connection Activated
  scope: mysql.db_system.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure MySQL Flexible Server Audit Log Connection is Enabled
  rationale: Enabling audit log connection for MySQL flexible servers in OCI is crucial for monitoring database activities, which helps in identifying unauthorized access attempts and potential data breaches. It supports regulatory compliance requirements such as PCI-DSS and HIPAA by providing necessary logging and auditing capabilities. Proper audit logging also aids in forensic analysis and incident response, reducing the risk of prolonged exposure to security threats.
  description: This check verifies whether the audit log connection is activated for MySQL flexible servers in OCI. The audit log connection must be enabled to capture detailed logs of database connections, which are essential for tracking access and changes to the database. To enable this setting, navigate to the MySQL Database System configuration in the OCI Console, and ensure that the 'Audit Log Connection' option is enabled. Regularly review audit logs to detect any unusual activity and implement corrective actions as needed.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/MySQL/Concepts/auditing.htm
  - https://www.oracle.com/security-cloud-compliance/cis-benchmark.html
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/index.html
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.mysql.db_system.flexible_server_audit_log_enabled
  service: mysql
  resource: db_system
  requirement: Flexible Server Audit Log Enabled
  scope: mysql.db_system.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Audit Logging for OCI MySQL Flexible Server
  rationale: Enabling audit logs for OCI MySQL Flexible Server is crucial for monitoring database activities, detecting unauthorized access attempts, and ensuring data integrity. Without audit logs, organizations face increased risks of undetected security breaches and potential non-compliance with regulations such as PCI-DSS and HIPAA, which require detailed logging of data access and modifications.
  description: This rule checks whether audit logging is enabled for OCI MySQL Flexible Server instances. Audit logging captures detailed records of database operations, which are essential for forensic analysis and compliance auditing. To enable audit logging, configure the MySQL DB System to forward logs to an appropriate logging service in OCI, ensuring logs are retained and accessible for analysis. Verify configuration in the OCI Console and use the OCI CLI or API for automated checks.
  references:
  - https://docs.oracle.com/en-us/iaas/mysql-database/doc/mysql-database-auditing.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_oci_cis.htm
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://www.hhs.gov/hipaa/index.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- rule_id: oci.mysql.db_system.flexible_server_minimum_tls_version_12
  service: mysql
  resource: db_system
  requirement: Flexible Server Minimum TLS Version 12
  scope: mysql.db_system.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enforce TLS 1.2+ for MySQL Flexible Server
  rationale: Enforcing a minimum TLS version of 1.2 for MySQL Flexible Servers helps protect data in transit by using strong encryption protocols, reducing the risk of data breaches. It ensures compliance with regulatory standards such as PCI-DSS and HIPAA, which mandate secure data transmission practices. Older TLS versions are susceptible to vulnerabilities that can be exploited by attackers, potentially leading to unauthorized data access.
  description: This rule checks if the MySQL Flexible Server is configured to use a minimum TLS version of 1.2, ensuring data is encrypted during transmission. To verify, access the OCI Console, navigate to the MySQL service, and confirm the TLS settings under the security configuration tab. Remediation involves updating the DB system configuration to enforce TLS 1.2 or higher. This not only improves security posture but also aligns with compliance requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/mysql-database/doc/security.html#security-encryption
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hipaajournal.com/hipaa-encryption-requirements/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-52r1.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practice.htm
- rule_id: oci.mysql.db_system.flexible_server_ssl_connection_enabled
  service: mysql
  resource: db_system
  requirement: Flexible Server SSL Connection Enabled
  scope: mysql.db_system.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure SSL Connections for MySQL Flexible Server
  rationale: Enabling SSL connections for MySQL Flexible Server is crucial for securing data in transit by encrypting communication between the database and clients. Without SSL, sensitive data can be intercepted by attackers, risking data integrity and confidentiality. Compliance with data protection regulations such as PCI-DSS and HIPAA often mandates the use of encryption to safeguard sensitive information.
  description: This rule checks if SSL connections are enabled on MySQL Flexible Server instances within OCI. To verify, inspect the 'require_secure_transport' parameter in the MySQL configuration. Enabling SSL ensures that all data exchanged between the client and the server is encrypted, mitigating the risk of man-in-the-middle attacks. Remediation involves configuring the MySQL instance to enforce SSL for connections, which can be done through the OCI Console or CLI by setting the appropriate parameter values.
  references:
  - https://docs.oracle.com/en-us/iaas/mysql-database/doc/security-best-practices.html#GUID-4DA4A7C2-32F4-4B88-9E8E-6A5FDBD7D2CD
  - https://www.oracle.com/security-cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/index.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- rule_id: oci.database.db_system.cluster_copy_tags_to_snapshots
  service: database
  resource: db_system
  requirement: Cluster Copy Tags To Snapshots
  scope: database.db_system.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure Tags Are Copied to Database Snapshots for Better Resource Management
  rationale: Copying tags to database snapshots is crucial for maintaining consistent metadata management, which aids in resource tracking, cost allocation, and compliance reporting. Without this practice, organizations risk losing important metadata, leading to potential non-compliance with data governance policies and increased complexity in resource auditing.
  description: This rule verifies that tags from the OCI Database System are automatically copied to any created snapshots, ensuring metadata consistency across resources. To configure this, ensure that the 'Copy Tags to Snapshots' option is enabled within the Database System settings. This practice not only simplifies cost tracking and resource management but also supports regulatory compliance by maintaining traceability. To remediate, navigate to the OCI Console, access the Database System settings, and enable the tag copying feature.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/backingup.htm
  - https://docs.oracle.com/en-us/iaas/Content/Tagging/Concepts/taggingoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/news-events/news/2021/04/guide-enhancing-security-and-compliance-cloud-service-use
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.db_system.cluster_snapshot_encrypted
  service: database
  resource: db_system
  requirement: Cluster Snapshot Encrypted
  scope: database.db_system.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Database Cluster Snapshots Are Encrypted at Rest
  rationale: Encrypting database cluster snapshots protects sensitive data from unauthorized access, reducing the risk of data breaches and ensuring compliance with data protection regulations such as GDPR and CCPA. Unencrypted snapshots can be a prime target for cyber threats, potentially leading to severe business and legal consequences.
  description: This rule verifies that all Oracle Cloud Infrastructure (OCI) database cluster snapshots are encrypted at rest using OCI's default encryption mechanisms. This involves checking the encryption configuration of database systems to ensure that snapshots are automatically encrypted with Oracle-managed keys or customer-managed keys. To remediate, enable the encryption feature in the OCI console for the database system snapshots. Regular audits should be conducted to confirm compliance with this setting.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/backingupdatabases.htm
  - 'CIS OCI Benchmark Reference: https://www.cisecurity.org/benchmark/oracle_cloud'
  - 'NIST SP 800-53: System and Information Integrity (SI-12)'
  - 'PCI-DSS Requirement 3: Protect Stored Cardholder Data'
  - https://www.oracle.com/security/cloud-security/database-security/
- rule_id: oci.virtual_network.vcn.flow_log_captured_sent
  service: virtual_network
  resource: vcn
  requirement: Flow Log Captured Sent
  scope: virtual_network.vcn.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure VCN Flow Logs Are Captured and Sent
  rationale: Capturing flow logs is critical for monitoring network traffic and detecting anomalies or unauthorized access attempts. Without flow logs, an organization might miss potential security incidents, leading to data breaches or non-compliance with regulatory requirements like PCI-DSS or HIPAA that mandate logging of network activities.
  description: This rule checks if flow logs are enabled and sent for Virtual Cloud Networks (VCNs) in OCI. Flow logs should be configured to capture all traffic, providing detailed insights into the network's behavior. To verify, ensure that flow logs are enabled and properly configured in the OCI console under the 'Networking' section. Remediation involves setting up logging for each VCN by navigating to the VCN details page and enabling flow logs, ensuring they are directed to a designated logging service for analysis.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/flowlogs.htm
  - https://www.oracle.com/security/cis-benchmarks/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://www.oracle.com/cloud/networking/
- rule_id: oci.virtual_network.vcn.flow_log_more_than_90_days
  service: virtual_network
  resource: vcn
  requirement: Flow Log More Than 90 Days
  scope: virtual_network.vcn.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure VCN Flow Logs are Retained for More Than 90 Days
  rationale: Retaining flow logs for more than 90 days helps organizations meet compliance requirements such as PCI-DSS and ISO 27001, which mandate the retention of audit logs for a specific period. Prolonged retention of flow logs improves the ability to conduct thorough forensic investigations and understand historical network traffic patterns, reducing the risk of undetected anomalies and security incidents.
  description: This rule checks if Oracle Cloud Infrastructure (OCI) Virtual Cloud Network (VCN) flow logs are retained for more than 90 days. Flow logs capture information about the IP traffic going to and from network interfaces in your VCN. To verify compliance, ensure that flow logs are configured with a retention policy of more than 90 days in the OCI Logging service settings. Remediation involves adjusting the retention period in the OCI Console under the Logging service by setting a custom retention policy.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/flowlogs.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://docs.oracle.com/en-us/iaas/Content/Compliance/Reference/pci-dss.htm
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.oracle.com/cloud/cloud-security/
- rule_id: oci.virtual_network.vcn.http_internet_access_restricted
  service: virtual_network
  resource: vcn
  requirement: Http Internet Access Restricted
  scope: virtual_network.vcn.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict HTTP Internet Access to OCI VCN
  rationale: Restricting HTTP internet access to a Virtual Cloud Network (VCN) is crucial to prevent unauthorized exposure of resources, which can lead to data breaches and compliance violations. Unrestricted internet access increases the risk of cyber attacks such as data exfiltration and denial-of-service attacks. Compliance with security standards like PCI-DSS and SOC2 often requires controlled internet access to maintain data integrity and confidentiality.
  description: This rule checks if HTTP access from the internet to resources within a VCN is restricted by security lists or network security groups. To verify, ensure that ingress rules for port 80 are limited to specific IPs or CIDR blocks rather than open to all (0.0.0.0/0). Remediation involves modifying security list rules or network security groups to restrict HTTP access to authorized sources only, leveraging OCI's Security Lists or Network Security Groups for fine-grained control.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/architecture/
- rule_id: oci.virtual_network.vcn.group_ssh_ingress_from_any_restricted
  service: virtual_network
  resource: vcn
  requirement: Group Ssh Ingress From Any Restricted
  scope: virtual_network.vcn.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Restrict SSH Ingress from Any Source for VCN
  rationale: Allowing unrestricted SSH access to Virtual Cloud Network (VCN) resources exposes them to potential unauthorized access, increasing the risk of data breaches and cyberattacks. This can lead to business disruptions, financial losses, and non-compliance with industry regulations such as PCI-DSS and HIPAA, which mandate secure access controls.
  description: This rule checks for any security list in a VCN that allows SSH traffic (port 22) from any IP address (0.0.0.0/0). To secure your network, ensure SSH ingress rules are restricted to known IP addresses or specific CIDR blocks. Verify current configurations using the OCI Console or CLI, and update security lists to limit SSH access to trusted sources only.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations_benchmark/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hipaajournal.com/hipaa-security-rule/
- rule_id: oci.virtual_network.vcn.nsg_ingress_rdp_access_restricted
  service: virtual_network
  resource: vcn
  requirement: Nsg Ingress Rdp Access Restricted
  scope: virtual_network.vcn.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict RDP Access in NSG for OCI VCN
  rationale: Allowing unrestricted RDP access can lead to unauthorized access, exposing critical systems to potential threats such as brute force attacks. Limiting RDP access to specific IP addresses reduces the attack surface, aligning with least privilege principles and meeting compliance requirements for data protection and network security.
  description: This rule evaluates the Network Security Group (NSG) ingress rules associated with a Virtual Cloud Network (VCN) to ensure that RDP access (TCP port 3389) is restricted to approved IP addresses. To verify, review the ingress rules in the OCI Console under Networking > Network Security Groups, ensuring RDP is limited to known, trusted IPs. Remediation involves updating NSG rules to restrict RDP access to specific IP addresses, ideally through the use of CIDR blocks that reflect trusted networks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networksecuritygroups.htm
  - https://www.oracle.com/cloud/cis-oci-benchmark/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hipaajournal.com/hipaa-security-rule/
- rule_id: oci.virtual_network.vcn.public_ip_shodan
  service: virtual_network
  resource: vcn
  requirement: Public Ip Shodan
  scope: virtual_network.vcn.public_access
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: critical
  title: Detect and Mitigate Public IP Exposure to Shodan on OCI VCN
  rationale: Exposing VCN public IPs to Shodan poses significant security risks as it can reveal details about the network's infrastructure to potential attackers. This exposure could lead to targeted attacks, unauthorized access, or data breaches, compromising business operations and potentially violating compliance standards such as PCI-DSS or HIPAA. Ensuring these IPs are not indexed by Shodan is crucial for maintaining the confidentiality and integrity of the network.
  description: This rule checks if any public IPs associated with your OCI Virtual Cloud Network (VCN) are indexed by Shodan, an internet-connected device search engine. To verify, regularly monitor the Shodan database for any of your public IPs. Remediation involves implementing strict network access controls, using private IPs for sensitive resources, and configuring security lists and network security groups to minimize exposure. Consider using OCI's Network Firewall and Web Application Firewall (WAF) for enhanced protection.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.oracle.com/security-cloud/network-firewall/
  - https://www.shodan.io
- rule_id: oci.virtual_network.vcn.rdp_internet_access_restricted
  service: virtual_network
  resource: vcn
  requirement: Rdp Internet Access Restricted
  scope: virtual_network.vcn.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict Internet Access for RDP on OCI VCN
  rationale: Allowing unrestricted RDP access from the internet to resources within an OCI Virtual Cloud Network (VCN) increases the risk of unauthorized access and potential data breaches. Attackers often exploit open RDP ports to perform brute force attacks or to gain entry into the network, which can lead to data exfiltration, system compromise, and regulatory non-compliance. Restricting RDP access helps mitigate these risks by limiting exposure to only necessary and trusted IP addresses.
  description: This rule checks for the presence of security list or network security group rules that allow unrestricted RDP (port 3389) access from the internet. To verify, inspect your VCN's security lists and network security groups to ensure that any inbound rules for TCP port 3389 are restricted to specific IP addresses or CIDR blocks. Remediation involves updating these rules to restrict RDP access to known, trusted IPs or implementing a bastion host to mediate access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://docs.cisecurity.org/benchmarks/oci
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/ocisecuritybestpractices.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.virtual_network.vcn.ssh_internet_access_restricted
  service: virtual_network
  resource: vcn
  requirement: Ssh Internet Access Restricted
  scope: virtual_network.vcn.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict SSH Access to VCN from Internet
  rationale: Unrestricted SSH access to Virtual Cloud Networks (VCNs) from the internet poses significant security risks, such as unauthorized access and potential data breaches. Limiting SSH access minimizes the attack surface, aligning with compliance requirements like PCI-DSS and ISO 27001, and helps protect sensitive data and resources within the OCI environment.
  description: This rule checks for configurations allowing SSH access from the internet to VCNs. It requires security lists or network security groups (NSGs) to restrict ingress traffic on port 22 to known IP addresses or trusted networks only. To verify, review the security list or NSG rules attached to the VCN subnets, ensuring no rule permits 0.0.0.0/0 on port 22. Remediate by updating security rules to specify allowed IP addresses for SSH access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securityrules.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/ocisecuritybestpractices.htm#securitybestpractices
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/bestpracticesidentity.htm
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.virtual_network.vcn.udp_internet_access_restricted
  service: virtual_network
  resource: vcn
  requirement: Udp Internet Access Restricted
  scope: virtual_network.vcn.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict UDP Internet Access for OCI VCNs
  rationale: Unrestricted UDP access from the internet to a Virtual Cloud Network (VCN) can expose your resources to potential UDP-based attacks such as flooding and amplification attacks, which could lead to service disruption and data breaches. By restricting UDP access, you reduce the attack surface, ensuring compliance with industry standards and protecting sensitive data.
  description: This rule ensures that all Virtual Cloud Networks (VCNs) in your OCI environment have UDP access from the internet restricted. It checks for security lists and network security groups that allow unrestricted UDP traffic and provides guidance on how to update these configurations. To remediate, review your security policies and modify them to deny inbound UDP traffic from the internet unless explicitly required for specific use cases.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securityrules.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security-alerts/
  - https://cloud.oracle.com/en_US/architecture-center/cloud-security
- rule_id: oci.network_firewall.network_firewall.logging_enabled
  service: network_firewall
  resource: network_firewall
  requirement: Logging Enabled
  scope: network_firewall.network_firewall.logging
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Network Firewall Logging is Enabled
  rationale: Enabling logging for network firewalls is crucial for monitoring and auditing traffic patterns, which helps in identifying unauthorized access attempts, operational issues, and potential security incidents. It supports compliance with regulatory frameworks that require detailed logging and audit trails, such as PCI-DSS and ISO 27001, thereby reducing legal and financial risks associated with data breaches.
  description: This rule verifies that logging is enabled for Oracle Cloud Infrastructure (OCI) network firewalls. Logging should be configured to capture all traffic events to ensure comprehensive monitoring. To verify, check the logging configuration in the OCI console under the network firewall settings. Remediation involves enabling 'Logging' for each network firewall by navigating to the specific firewall resource, editing the logging settings, and ensuring that logs are directed to a designated OCI Logging service for centralized analysis.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networkfirewall.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/legacy/sp/nistspecialpublication800-53r4.pdf
- rule_id: oci.nosql.table.encryption_enabled
  service: nosql
  resource: table
  requirement: Encryption Enabled
  scope: nosql.table.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure NoSQL Table Encryption at Rest is Enabled
  rationale: Encryption of data at rest is critical to protect sensitive information from unauthorized access and potential data breaches. It mitigates the risk of data exposure in case of unauthorized access to storage media. Regulatory frameworks like PCI-DSS and HIPAA mandate encryption to ensure the confidentiality and integrity of sensitive data, thereby reducing compliance risks and enhancing customer trust.
  description: This check verifies that all Oracle Cloud Infrastructure NoSQL tables have encryption at rest enabled. Encryption should be configured using Oracle-managed keys or customer-managed keys within the OCI Vault service. To verify, log into the OCI console, navigate to the NoSQL service, and check the encryption settings for each table. Remediation involves configuring encryption policies within the NoSQL service settings and ensuring all tables adhere to these policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/NoSQL/using/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://csrc.nist.gov/publications/detail/sp/800-57/part-1/rev-5/final
  - https://cloudsecurityalliance.org/artifacts/oci-security-guide/
- rule_id: oci.object_storage.bucket.storage_account_level_public_access_blocks
  service: object_storage
  resource: bucket
  requirement: Storage Account Level Public Access Blocks
  scope: object_storage.bucket.public_access
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: critical
  title: Public Access Block for OCI Object Storage Buckets
  rationale: Enabling public access block at the storage account level is crucial to prevent unauthorized data access and exposure. Without these controls, sensitive data stored in Object Storage Buckets can be inadvertently exposed to the internet, leading to data breaches, non-compliance with data protection regulations such as GDPR and CCPA, and a potential loss of trust from customers and partners.
  description: This rule ensures that all Object Storage Buckets within a storage account have public access blocks enabled by default. This is achieved by verifying the configuration settings of each bucket to ensure that public read or write access is not permitted. Remediation involves configuring the bucket policies to disable public access, using the Oracle Cloud Infrastructure Console, CLI, or API to enforce these settings across the storage account. Additionally, regular audits should be performed to maintain compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingpublicaccess.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm#security_guide_topic-Overview
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security
- rule_id: oci.object_storage.storage.bucket_cross_region_replication
  service: object_storage
  resource: storage
  requirement: Bucket Cross Region Replication
  scope: object_storage.storage.replication
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Enable Cross-Region Replication for Object Storage Buckets
  rationale: Cross-region replication ensures data durability and accessibility by duplicating data across different geographic locations. This mitigates risks associated with regional outages, enhances disaster recovery capabilities, and addresses compliance requirements for data redundancy. It is crucial for maintaining business continuity and meeting standards such as ISO 27001 and SOC2.
  description: This rule checks if cross-region replication is configured for OCI Object Storage buckets. To verify, navigate to the Object Storage service in the OCI Console, select a bucket, and check the replication settings under 'Replication Policies'. To enable replication, configure a replication policy specifying the destination region and bucket. This ensures your data is consistently replicated and available across different regions to prevent data loss and meet compliance requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingrecovey.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/artifacts/oracle-cloud-infrastructure-security-best-practices/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-144.pdf
- rule_id: oci.object_storage.bucket.storage_bucket_default_encryption
  service: object_storage
  resource: bucket
  requirement: Storage Bucket Default Encryption
  scope: object_storage.bucket.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Default Encryption for OCI Object Storage Buckets
  rationale: Data stored in Object Storage without default encryption is vulnerable to unauthorized access and theft, posing significant security and privacy risks. Encrypting data at rest is critical to protecting sensitive information and meeting compliance requirements such as PCI-DSS, HIPAA, and GDPR. Default encryption also reduces the risk of data breaches and supports data confidentiality, integrity, and availability.
  description: This rule verifies that Object Storage buckets in OCI have default encryption enabled using either Oracle-managed keys or customer-managed keys. To check compliance, review the bucket settings in the OCI console or use the CLI to ensure the 'Default Encryption' property is set. To remediate, navigate to the Object Storage service, select the bucket, and enable encryption under the 'Default Encryption' settings, selecting the appropriate key management option.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingyourencryptionkeys.htm
  - https://www.oracle.com/cloud/security/cis-oci-benchmark/
  - https://www.pcisecuritystandards.org/document_library
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://cloud.oracle.com/security
- rule_id: oci.object_storage.storage.bucket_lifecycle_enabled
  service: object_storage
  resource: storage
  requirement: Bucket Lifecycle Enabled
  scope: object_storage.storage.lifecycle_management
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Enable Lifecycle Policies for OCI Object Storage Buckets
  rationale: Enabling lifecycle policies for OCI Object Storage buckets optimizes storage costs by automatically transitioning or deleting data based on defined rules. This mitigates the risk of retaining obsolete or sensitive data longer than necessary, which could lead to data exposure or increased storage expenses. Compliance with data retention requirements is enhanced by ensuring data is retained for the appropriate duration.
  description: This rule checks whether lifecycle policies are enabled for OCI Object Storage buckets. Lifecycle management allows automatic transitions of objects to lower-cost storage tiers or their deletion after a specific period. To verify, ensure that lifecycle policies are configured in the OCI Console under the Object Storage bucket settings. Remediation involves defining lifecycle rules that specify actions like transition or deletion of objects after a set period, according to your data management policy.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usinglifecyclepolicies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.0.0.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.object_storage.bucket.storage_bucket_object_versioning
  service: object_storage
  resource: bucket
  requirement: Storage Bucket Object Versioning
  scope: object_storage.bucket.versioning
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Enable Versioning for OCI Object Storage Buckets
  rationale: Enabling object versioning in OCI Object Storage is crucial for preventing data loss and facilitating recovery from accidental deletions or overwrites. It provides a robust mechanism for maintaining data integrity, which is essential for compliance with data protection regulations such as GDPR and HIPAA. By keeping previous versions of objects, organizations can recover from operational errors and ensure continuity in business operations.
  description: This rule checks whether object versioning is enabled on OCI Object Storage buckets. Versioning maintains a history of object versions, allowing recovery of deleted or overwritten data. To verify, navigate to the OCI Console, select 'Object Storage', choose the bucket, and check the 'Versioning' setting. To enable versioning, set the bucket's versioning status to 'Enabled'. This can be done via the OCI Console or CLI. Regularly review and manage object versions to optimize storage costs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#versioning
  - https://www.oracle.com/security-cloud-compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://cloud.oracle.com/iaas/whitepapers/best-practices-for-operational-resilience-in-oci.pdf
- rule_id: oci.object_storage.bucket.storage_bucket_policy_public_write_access
  service: object_storage
  resource: bucket
  requirement: Storage Bucket Policy Public Write Access
  scope: object_storage.bucket.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Prevent Public Write Access to Object Storage Buckets
  rationale: Allowing public write access to an object storage bucket can lead to unauthorized data uploads, data overwrites, and potential data loss or corruption. This poses a significant threat to data integrity and confidentiality, leading to compliance issues with standards such as PCI-DSS and ISO 27001, and exposing the organization to financial and reputational damage.
  description: 'This rule checks if any object storage bucket policies allow public write access, which can be verified by reviewing the bucket''s access policy in the OCI Console. To remediate, ensure that ''Allow'' statements in bucket policies do not grant ''write'' permissions to ''Principal: allUsers''. Adjust policies to restrict write access to authenticated and authorized users only. Regular audits and automated governance tools should be used to maintain appropriate access controls.'
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#bucketpolicies
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://cloud.oracle.com/governance
- rule_id: oci.object_storage.bucket.storage_bucket_public_access
  service: object_storage
  resource: bucket
  requirement: Storage Bucket Public Access
  scope: object_storage.bucket.public_access
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: critical
  title: Prevent Public Access to OCI Object Storage Buckets
  rationale: Allowing public access to Object Storage buckets can lead to unauthorized data exposure, data breaches, and non-compliance with regulations such as GDPR and PCI-DSS. Publicly accessible buckets may contain sensitive or proprietary information that could be exploited by malicious actors, leading to financial loss, reputational damage, and regulatory penalties.
  description: This rule checks if any Object Storage buckets are publicly accessible by evaluating bucket-level access policies and pre-authenticated requests. Public access should be disabled unless explicitly required. To verify, review the bucket's access policies and ensure they do not include overly permissive public settings. Remediation involves restricting access to authenticated users only and using OCI Identity and Access Management (IAM) policies to control access at a granular level.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingbuckets.htm#publicaccess
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-security/identity-and-access-management/
- rule_id: oci.object_storage.bucket.storage_bucket_public_access_restricted
  service: object_storage
  resource: bucket
  requirement: Storage Bucket Public Access Restricted
  scope: object_storage.bucket.public_access
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: critical
  title: Restrict Public Access to OCI Storage Buckets
  rationale: Allowing public access to storage buckets can lead to unauthorized data exposure, resulting in data breaches that could harm business reputation and incur financial penalties. Public buckets can be exploited by threat actors to distribute malicious content or exfiltrate sensitive information, violating compliance with standards such as PCI-DSS and ISO 27001.
  description: This rule checks if any OCI storage buckets have public access permissions enabled, which could expose sensitive data. It requires configuring bucket policies to restrict access only to authorized users and services. Verification involves reviewing bucket permissions and ensuring that all public access policies are removed. Remediation includes adjusting IAM policies and using pre-authenticated requests for controlled access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/document_library?category=pcidss
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.object_storage.bucket.storage_bucket_secure_transport_policy
  service: object_storage
  resource: bucket
  requirement: Storage Bucket Secure Transport Policy
  scope: object_storage.bucket.policy_management
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Enforce TLS for Secure Transport in OCI Object Storage Buckets
  rationale: Ensuring secure transport for object storage buckets is critical to protect sensitive data from interception or tampering during transit. Without secure transport, data breaches can occur, leading to financial loss, reputational damage, and non-compliance with regulations such as PCI-DSS and HIPAA.
  description: This rule checks for the enforcement of Transport Layer Security (TLS) on object storage buckets to ensure data is transmitted securely over the network. It verifies that the bucket's policies require TLS for all connections to prevent data from being accessed or manipulated by unauthorized parties. To remediate, configure bucket policies to enforce TLS by setting the 'SecureTransport' condition in the policy statements. Regularly audit these settings to maintain compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingbuckets.htm#security
  - https://www.oracle.com/security-cloud/cis-benchmarks/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-iec-27001-information-security.html
- rule_id: oci.object_storage.bucket.storage_bucket_server_access_logging_enabled
  service: object_storage
  resource: bucket
  requirement: Storage Bucket Server Access Logging Enabled
  scope: object_storage.bucket.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Server Access Logging for OCI Storage Buckets
  rationale: Enabling server access logging on OCI storage buckets is crucial for tracking access patterns and identifying unauthorized access attempts. This logging capability provides valuable audit trails necessary for forensic investigations, helps meet compliance requirements such as PCI-DSS and ISO 27001, and enhances the overall security posture by allowing organizations to monitor and respond to suspicious activities in real-time.
  description: This rule checks whether server access logging is enabled for Oracle Cloud Infrastructure (OCI) storage buckets. To verify, ensure that logging is activated in the OCI console under the bucket's logging settings. Remediation involves enabling the logging feature, specifying a target bucket where logs will be stored, and ensuring that the target bucket has the appropriate permissions. This setup allows for the collection and analysis of access logs, providing insights into bucket usage and access patterns.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#logging
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/success/security-best-practices.html
- rule_id: oci.object_storage.storage.bucket_server_access_logging_enabled
  service: object_storage
  resource: storage
  requirement: Bucket Server Access Logging Enabled
  scope: object_storage.storage.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Server Access Logging for OCI Object Storage Buckets
  rationale: Server access logging in OCI Object Storage provides visibility into operations performed on buckets, enabling threat detection and forensic analysis. This is crucial for identifying unauthorized access and ensuring compliance with data protection regulations such as GDPR and CCPA. Without logging, detecting anomalies or unauthorized changes becomes significantly more challenging, increasing the risk of data breaches.
  description: This rule checks if server access logging is enabled for OCI Object Storage buckets, which logs requests made to the storage resources. To verify, ensure that logging is configured for each bucket via the OCI Console or API. Remediation involves enabling logging by specifying a target log group and log object. This configuration helps maintain an audit trail of access to your storage resources, providing critical insights for security monitoring and incident response.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#logging
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.object_storage.bucket.storage_bucket_write_access_logging_enabled
  service: object_storage
  resource: bucket
  requirement: Storage Bucket Write Access Logging Enabled
  scope: object_storage.bucket.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Write Access Logging for OCI Storage Buckets
  rationale: Enabling write access logging for storage buckets is crucial for tracking unauthorized access and modifications to sensitive data. It helps in identifying potential security breaches, ensuring accountability, and meeting compliance requirements such as PCI-DSS and ISO 27001. Without logging, detecting and responding to unauthorized activities becomes challenging, increasing the risk of data loss and regulatory penalties.
  description: This check ensures that logging is enabled for all write operations performed on OCI storage buckets. To verify, check the bucket settings in the OCI Console under 'Logging' and ensure that write access logging is enabled for each bucket. If logging is disabled, enable it by navigating to the bucket's 'Logging' section and configuring a log group to capture write access events. Regularly review and analyze logs to detect suspicious activities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.oracle.com/security/cis-oracle-cloud-infrastructure-foundations-benchmark/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usinglogging.htm
- rule_id: oci.object_storage.bucket.storage_bucket_default_kms_encryption
  service: object_storage
  resource: bucket
  requirement: Storage Bucket Default KMS Encryption
  scope: object_storage.bucket.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Buckets Use Default KMS Encryption
  rationale: Using default KMS encryption for object storage buckets protects sensitive data at rest against unauthorized access and potential data breaches. It helps comply with data protection regulations such as GDPR and CCPA, and supports security best practices by ensuring encryption keys are managed securely. This reduces the risk of data exposure if storage media are accessed without authorization.
  description: This rule verifies that object storage buckets in OCI are configured to use Oracle Cloud's Key Management Service (KMS) for encryption by default. Buckets should not rely on the default encryption provided by the object storage service but instead use customer-managed keys for enhanced security. To remediate, configure the bucket's encryption settings to use a KMS key by navigating to the OCI Console, selecting the bucket, and setting the default encryption to a KMS key. This ensures all objects stored in the bucket are encrypted using a key you control.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#encryption
  - https://www.oracle.com/security-cloud/cis-oci-benchmark.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57r1.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/compliance/
- rule_id: oci.object_storage.bucket.storage_bucket_encryption_enabled
  service: object_storage
  resource: bucket
  requirement: Storage Bucket Encryption Enabled
  scope: object_storage.bucket.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Object Storage Buckets Have Encryption Enabled
  rationale: Encrypting data at rest in Object Storage buckets is crucial to prevent unauthorized access and data breaches, particularly when dealing with sensitive information. This is important for compliance with data protection regulations such as GDPR, HIPAA, and PCI-DSS, which mandate data encryption to protect privacy and confidentiality. Without encryption, stored data is vulnerable to unauthorized access and exploitation, posing significant business and reputational risks.
  description: This rule checks whether encryption is enabled on Oracle Cloud Infrastructure Object Storage buckets. To ensure data privacy and security, all storage buckets should have encryption enabled using either Oracle-managed keys or customer-managed keys. Verification can be done via the OCI Console under the 'Object Storage' section by checking the 'Encryption' settings for each bucket. To remediate, enable encryption on all buckets by setting the default encryption policy in the OCI Console or via the OCI CLI, ensuring that the encryption status is 'Enabled'.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingencryption.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.object_storage.bucket.storage_bucket_level_public_access_blocks
  service: object_storage
  resource: bucket
  requirement: Storage Bucket Level Public Access Blocks
  scope: object_storage.bucket.public_access
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: critical
  title: Ensure No Public Access to OCI Object Storage Buckets
  rationale: Publicly accessible buckets can expose sensitive data, leading to data breaches and non-compliance with regulations such as GDPR and CCPA. Unauthorized access can result in data leakage, financial loss, and damage to reputation. Organizations must ensure buckets are private to mitigate risks of unauthorized data exposure and meet regulatory mandates.
  description: This rule checks if any Object Storage buckets have public access enabled. Public access can be controlled by setting bucket policies that define who can access the data. To remediate, review bucket policies in the OCI console, ensuring they do not include overly permissive public access settings. Consider using IAM policies to restrict data access to specific users or groups within your organization.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#publicaccess
  - https://www.oracle.com/cloud/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://cloud.oracle.com/storage/object-storage/features
- rule_id: oci.object_storage.bucket.storage_bucket_public_read_prohibited
  service: object_storage
  resource: bucket
  requirement: Storage Bucket Public Read Prohibited
  scope: object_storage.bucket.public_access
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: critical
  title: Prevent Public Read Access on OCI Storage Buckets
  rationale: Public read access to storage buckets in OCI can expose sensitive data to unauthorized entities, leading to data breaches and non-compliance with regulations such as GDPR and PCI-DSS. It poses a significant risk as attackers could exploit this access to gain insights into confidential data, impacting business reputation and financials.
  description: This rule checks if any storage buckets have public read access enabled, which is a critical misconfiguration. Verify the 'Access Type' settings on each bucket to ensure it is not set to 'Public'. Remediate by setting the bucket's access policy to 'Private' or configuring precise IAM policies that restrict access to authorized users only. Utilize Oracle Cloud Infrastructure's Identity and Access Management service to enforce strict access controls.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
  - https://www.oracle.com/security-cloud/compliance/
- rule_id: oci.object_storage.bucket.storage_bucket_public_write_prohibited
  service: object_storage
  resource: bucket
  requirement: Storage Bucket Public Write Prohibited
  scope: object_storage.bucket.public_access
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: critical
  title: Prevent Public Write Access to OCI Storage Buckets
  rationale: Allowing public write access to OCI storage buckets poses critical security risks such as unauthorized data alteration, injection of malicious content, and potential data breaches. This exposure can lead to significant business impacts including financial loss, reputational damage, and non-compliance with regulations like PCI-DSS and GDPR, which mandate strict data access controls.
  description: This rule checks if any OCI storage bucket is configured to allow public write access. Buckets should be set to restrict write permissions to authenticated and authorized users only. Administrators can verify this by reviewing the bucket's access policies and removing any policies that grant write permissions to 'anyone' or 'public'. Remediation involves updating bucket policies to ensure that only trusted identities have write access, typically by configuring Identity and Access Management (IAM) policies appropriately.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#access
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_intro.htm
  - https://cloud.oracle.com/en_US/architecture/design-patterns/security-best-practices
- rule_id: oci.object_storage.bucket.storage_s3_bucket_encryption_enabled
  service: object_storage
  resource: bucket
  requirement: Storage S3 Bucket Encryption Enabled
  scope: object_storage.bucket.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure S3-Compatible Bucket Encryption is Enabled
  rationale: Enabling encryption for OCI Object Storage buckets protects sensitive data at rest from unauthorized access and potential breaches. It helps meet compliance requirements for data protection regulations such as GDPR, PCI-DSS, and HIPAA, by ensuring data privacy and integrity. Unencrypted buckets pose significant risks as they can be targets for data leaks and unauthorized data exposure.
  description: This rule checks if S3-compatible Object Storage buckets in OCI have encryption enabled, ensuring data is encrypted at rest using server-side encryption. Verify bucket settings in the OCI console or using CLI commands to confirm encryption is active. To remediate, configure server-side encryption with OCI-managed keys or customer-managed keys (KMS) during bucket creation or update the settings for existing buckets.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/s3compatibleapi.htm
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.object_storage.bucket.storage_website_https_only
  service: object_storage
  resource: bucket
  requirement: Storage Website HTTPS Only
  scope: object_storage.bucket.security
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Enforce HTTPS for Object Storage Websites
  rationale: Enforcing HTTPS for object storage websites ensures data in transit is encrypted, protecting against man-in-the-middle attacks and data breaches. This is crucial for maintaining the confidentiality and integrity of sensitive information and adhering to security standards and regulations such as PCI-DSS and SOC 2 that mandate secure data transmission.
  description: This rule verifies that object storage buckets configured as websites are accessible only via HTTPS, preventing insecure HTTP connections. Administrators should configure the 'Enable HTTPS' setting for the bucket's website configuration within OCI. To remediate, ensure the bucket's static website settings have HTTPS enabled, which can be verified in the OCI Console by navigating to the Object Storage settings and reviewing the website endpoints.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingobjectstorage.htm#EnableWebsite
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/document-6006
  - https://www.iso.org/iso-iec-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.object_storage.bucket.bucket_encryption_cmk_enabled
  service: object_storage
  resource: bucket
  requirement: Bucket Encryption CMK Enabled
  scope: object_storage.bucket.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Object Storage Buckets Use Customer-Managed Keys
  rationale: Using Customer-Managed Keys (CMKs) for bucket encryption enhances data security by giving organizations full control over cryptographic keys, reducing the risk of unauthorized data access. This practice is crucial for meeting compliance requirements such as PCI-DSS and HIPAA, which mandate robust data protection measures. It also mitigates threats such as data breaches and unauthorized disclosures by ensuring that encryption keys are rotated, managed, and audited according to organizational policies.
  description: This rule verifies that Object Storage buckets in Oracle Cloud Infrastructure are encrypted using Customer-Managed Keys (CMKs) rather than Oracle-managed keys. To check compliance, ensure that the bucket's encryption setting is configured to use a specified CMK from the Key Management service. Remediation involves accessing the OCI console, navigating to the Object Storage service, selecting the appropriate bucket, and configuring its encryption settings to use a CMK. This provides enhanced control over key lifecycle management and complies with security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/keyoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/ocsfg.htm#ocsfg_cis_1_8
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/index.html
  - https://cloudsecurityalliance.org/artifacts/key-management-for-multi-cloud-environments/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.container_engine.cluster.audit_service_log_access
  service: container_engine
  resource: cluster
  requirement: Audit Service Log Access
  scope: container_engine.cluster.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Audit Logs for Cluster Access in OCI Container Engine
  rationale: Monitoring access to cluster resources in OCI's Container Engine is crucial for identifying unauthorized activities and maintaining accountability. Audit logs provide detailed records of all access events, helping in the detection of potential security breaches and aiding in forensic investigations. Compliance with regulations such as NIST and PCI-DSS requires proper logging and monitoring of access to critical infrastructure.
  description: This rule checks whether audit logging is enabled for clusters in OCI's Container Engine. It verifies that logs are being captured and stored in the OCI Audit service, ensuring all access and modification events are recorded. To enable audit logging, configure the OCI Audit service to capture logs for Container Engine activities and ensure that log retention policies meet your organization's compliance requirements. Regularly review and analyze these logs to identify any anomalies or unauthorized access attempts.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.container_engine.cluster.kubelet_configuration
  service: container_engine
  resource: cluster
  requirement: Kubelet Configuration
  scope: container_engine.cluster.configuration_management
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Secure Kubelet Configuration in OCI Clusters
  rationale: Proper Kubelet configuration is vital to prevent unauthorized access and execution within OCI Kubernetes clusters. Misconfigurations can lead to security vulnerabilities, such as privilege escalation and data exfiltration, compromising the entire container ecosystem. Ensuring secure Kubelet settings aligns with compliance requirements and protects against common attack vectors.
  description: This rule checks for secure Kubelet configurations within OCI Container Engine clusters, focusing on parameters such as authentication, authorization, and network security settings. Ensure that Kubelet is configured with appropriate security flags, such as --anonymous-auth=false, --enable-secure-kubelet, and others as per OCI guidelines. Regularly review and update Kubelet settings to comply with security policies and OCI best practices. Remediation involves accessing the OCI Console, navigating to your Kubernetes cluster, and adjusting the Kubelet configuration settings to the recommended security standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-190.pdf
  - https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.container_engine.cluster.kubelet_streaming_connection_idle_timeout
  service: container_engine
  resource: cluster
  requirement: Kubelet Streaming Connection Idle Timeout
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Configure Kubelet Streaming Connection Idle Timeout
  rationale: Setting a Kubelet streaming connection idle timeout helps prevent potential denial-of-service attacks by limiting the duration of inactive sessions. This is crucial to maintaining resource availability and security within Kubernetes clusters, as prolonged idle connections can exhaust system resources and expose clusters to vulnerability exploitation. Compliance with security best practices, such as those outlined by CIS and other frameworks, can mitigate risks associated with unmanaged idle connections.
  description: This rule checks if a kubelet's streaming connection idle timeout is configured correctly within OCI Container Engine for Kubernetes clusters. The default setting should be reviewed and adjusted to a lower value to minimize the risk of resource exhaustion. Administrators can verify this configuration by inspecting the kubelet's configuration file or using the OCI Console to ensure the timeout value aligns with security policies. If misconfigured, update the kubelet configuration to enforce an appropriate timeout limit, followed by a cluster restart to apply changes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-190.pdf
  - https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/
  - https://www.oracle.com/cloud/cloud-security.html
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengconfiguringclusters.htm
- rule_id: oci.container_engine.cluster.namespace_network_policy_configured
  service: container_engine
  resource: cluster
  requirement: Namespace Network Policy Configured
  scope: container_engine.cluster.network_security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: medium
  title: Ensure Namespace Network Policies are Configured in OKE Clusters
  rationale: Configuring namespace network policies in Oracle Kubernetes Engine (OKE) is crucial for controlling traffic flow between pods, enhancing the security posture of the cluster. Without these policies, pods are vulnerable to unauthorized access, which can lead to data breaches, unauthorized data access, and potential compliance violations with standards such as PCI-DSS and HIPAA.
  description: This rule checks if namespace network policies are configured in your OKE clusters. Network policies allow you to define rules for pod communication within a namespace, ensuring that only authorized traffic is allowed. To verify, review the network policies applied to each namespace within your clusters. Remediation involves creating and applying appropriate network policies that define ingress and egress rules, using kubectl or the OCI Console to enforce these settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengnetworkpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.pcisecuritystandards.org/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
  - https://kubernetes.io/docs/concepts/services-networking/network-policies/
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.container_engine.cluster.node_pool_private_enabled
  service: container_engine
  resource: cluster
  requirement: Node Pool Private Enabled
  scope: container_engine.cluster.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Node Pools in OCI Clusters Use Private Networking
  rationale: Enabling private networking for node pools in Oracle Cloud Infrastructure (OCI) clusters helps reduce exposure to external threats by preventing public internet access. This is crucial for protecting sensitive workloads and data from unauthorized access and potential breaches. It also supports compliance with regulatory frameworks that mandate secure, controlled network environments.
  description: This rule checks if node pools within OCI Kubernetes clusters are configured to use private networking, which ensures that nodes are not assigned public IP addresses. Verify this setting by ensuring the 'isPrivate' attribute is set to true in the node pool configuration. To remediate, update the node pool to enable private networking through the OCI Console or CLI, ensuring all network traffic is routed through a Virtual Cloud Network (VCN).
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengcreatingclusterusingoke.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/cloud/cloud-security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.container_engine.cluster.pod_service_account_token_mount_disabled
  service: container_engine
  resource: cluster
  requirement: Pod Service Account Token Mount Disabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Disable Pod Service Account Token Mount in OCI Clusters
  rationale: Disabling the automatic mounting of service account tokens in Kubernetes pods within OCI reduces the risk of unauthorized access if a pod is compromised. Service tokens can be exploited if exposed, leading to privilege escalation or lateral movement within the cluster. Aligning with this practice enhances security posture by minimizing attack vectors, supporting compliance with security frameworks like NIST and ISO 27001.
  description: This rule checks if the Kubernetes pods in an OCI Container Engine cluster have the 'automountServiceAccountToken' field set to 'false'. This setting prevents the mounting of service account tokens into pods, reducing the risk of token misuse. To verify, examine pod specifications for the 'automountServiceAccountToken' attribute. Remediation involves updating pod configurations to explicitly disable token mounts where not needed, and ensuring developers are aware of this policy.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengsettingupclusteraccess.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://csrc.nist.gov/publications/detail/sp/800-190/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/
- rule_id: oci.container_engine.cluster.private_endpoint_enabled_public_access_disabled
  service: container_engine
  resource: cluster
  requirement: Private Endpoint Enabled Public Access Disabled
  scope: container_engine.cluster.public_access
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: critical
  title: Ensure Private Endpoint Enabled, Public Access Disabled for Clusters
  rationale: Enabling private endpoints while disabling public access for OCI Container Engine clusters reduces the attack surface by preventing unauthorized external access. This configuration minimizes the risk of data breaches and unauthorized control, especially in production environments where sensitive data is processed. It is crucial for meeting regulatory requirements such as PCI-DSS and GDPR, which mandate secure access controls for protecting personal and financial data.
  description: This rule checks whether OCI Container Engine clusters have private endpoints enabled and public access disabled. Clusters should be configured to use a private endpoint, ensuring all network traffic is routed through secure private networks, and public access should be disabled to prevent exposure to the internet. To verify, inspect the cluster's configuration in the OCI Console under the Networking section. Remediation involves reconfiguring the cluster to enable a private endpoint and disable any public endpoint settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengsettingupclusterprivate.htm
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengnetworksecurity.htm
  - CIS Oracle Cloud Infrastructure Foundations Benchmark v1.0.0
  - https://www.pcisecuritystandards.org/
- rule_id: oci.analytics.analytics_instance.service_domains_access_control_enabled
  service: analytics
  resource: analytics_instance
  requirement: Service Domains Access Control Enabled
  scope: analytics.analytics_instance.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enable Service Domains Access Control for Analytics Instances
  rationale: Enabling service domains access control for OCI Analytics ensures that access to analytics instances is restricted to trusted networks. This reduces the risk of unauthorized access and data breaches, thereby protecting sensitive business data. It also supports compliance with regulatory requirements such as PCI-DSS and SOC2 that mandate stringent access controls.
  description: This rule checks if service domains access control is enabled for OCI Analytics instances. By configuring service domains, administrators can restrict access to specific IP ranges, ensuring only authorized networks can connect. To verify, navigate to the Analytics instance settings in the OCI Console and ensure that the 'Service Domains' configuration is enabled with the correct CIDR blocks. Remediation involves updating the settings to include your organization's trusted network ranges.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Tasks/analyticscreating.htm#access
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/sorhome.html
  - https://www.iso.org/standard/54534.html
- rule_id: oci.analytics.analytics_instance.service_domains_encryption_enabled
  service: analytics
  resource: analytics_instance
  requirement: Service Domains Encryption Enabled
  scope: analytics.analytics_instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Encryption Enabled for OCI Analytics Service Domains
  rationale: Enabling encryption for service domains in OCI Analytics mitigates the risk of unauthorized data access and ensures compliance with data protection regulations such as GDPR and CCPA. Unencrypted data can be vulnerable to data breaches, potentially leading to financial loss, reputational damage, and legal penalties.
  description: This rule checks if encryption is enabled for service domains in Oracle Cloud Infrastructure's Analytics service instances. When configuring an analytics instance, ensure that encryption is enabled for data at rest using Oracle-managed keys or customer-managed keys. To verify, navigate to the OCI Console under Analytics, select the instance, and confirm encryption settings under the 'Configuration' section. If not enabled, update the settings to activate encryption to protect sensitive data.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Tasks/analyticsconfiguring.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations_guide/
  - https://www.nist.gov/privacy-framework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/cloud/security/
- rule_id: oci.analytics.analytics_instance.service_domains_node_to_encryption_enabled
  service: analytics
  resource: analytics_instance
  requirement: Service Domains Node To Encryption Enabled
  scope: analytics.analytics_instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Encryption for Analytics Domain Nodes is Enabled
  rationale: Enabling encryption at rest for analytics domain nodes is crucial to protect sensitive data from unauthorized access and potential breaches. It mitigates the risk of data exposure in the event of storage compromise and aligns with regulatory requirements for data protection, such as PCI-DSS and GDPR, ensuring business continuity and customer trust.
  description: This check verifies that encryption is enabled for domain nodes within Oracle Cloud Infrastructure Analytics instances. Encryption ensures that all data stored within the analytics service is protected using strong encryption algorithms. To verify this setting, navigate to the Oracle Cloud Console, access the Analytics service settings, and confirm that encryption is enabled. If not enabled, modify the settings to activate encryption at rest using the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticssecurity.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/cloud-infrastructure/data-encryption/
- rule_id: oci.analytics.analytics_instance.service_domains_audit_logging_enabled
  service: analytics
  resource: analytics_instance
  requirement: Service Domains Audit Logging Enabled
  scope: analytics.analytics_instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Audit Logging is Enabled for Analytics Service Domains
  rationale: Enabling audit logging for OCI Analytics service domains is crucial for tracking access and changes to resources, providing a trail that can be used to identify unauthorized activities and potential security breaches. This practice supports compliance with regulatory requirements such as GDPR and CCPA by ensuring transparency and accountability in data handling processes.
  description: This rule verifies that audit logging is enabled for OCI Analytics service domains. Audit logs capture key events and changes, which can be reviewed for suspicious activities and compliance audits. To enable audit logging, navigate to the OCI Analytics instance settings, ensure that logging is configured for the relevant service domains, and regularly review logs through the Oracle Cloud Logging Service. Remediation involves setting up policies and rules to automatically enable and monitor audit logs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticslogging.htm
  - https://www.oracle.com/security/cloud-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloud.oracle.com/compliance
- rule_id: oci.analytics.analytics_instance.service_domains_cloudwatch_logging_enabled
  service: analytics
  resource: analytics_instance
  requirement: Service Domains Cloudwatch Logging Enabled
  scope: analytics.analytics_instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Cloudwatch Logging for OCI Analytics Service Domains
  rationale: Enabling Cloudwatch logging for OCI Analytics service domains is crucial for monitoring, detecting, and responding to anomalous activities. It provides visibility into access patterns and operational metrics, helping to identify potential security threats or compliance breaches. Regulatory frameworks like PCI-DSS and SOC2 emphasize the importance of logging and monitoring for maintaining data integrity and accountability.
  description: This rule checks if logging is enabled for service domains within OCI Analytics instances. Specifically, it verifies if logs are being sent to Oracle Cloud's logging service for analysis and alerting. To enable this, ensure that Cloudwatch logging is configured for all analytics instances by navigating to the Analytics Dashboard and selecting 'Configure Logging'. Remediation involves setting up the appropriate IAM policies to allow logging and ensuring all relevant domains are included.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticslogging.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/security/
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
- rule_id: oci.analytics.analytics_instance.service_domains_monitoring_logging_enabled
  service: analytics
  resource: analytics_instance
  requirement: Service Domains Monitoring Logging Enabled
  scope: analytics.analytics_instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Logging for OCI Analytics Service Domains
  rationale: Enabling logging for service domains within OCI Analytics enhances visibility into operations and potential security incidents. Without monitoring and logging, organizations risk undetected malicious activities, non-compliance with regulatory requirements like PCI-DSS or ISO 27001, and a lack of forensic evidence in the event of a breach.
  description: This rule verifies that logging is enabled for service domains in OCI Analytics instances, ensuring comprehensive tracking of access and configuration changes. To comply, configure the logging service to capture and store logs for each domain used by the analytics instance. This can be verified through the Oracle Cloud Infrastructure Console by navigating to the relevant analytics instance settings and ensuring logging is activated under the service domains section. Remediation involves enabling logging where it is found to be disabled.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Tasks/analyticslogging.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.identity.compartment.account_part_of_organizations
  service: identity
  resource: compartment
  requirement: Account Part Of Organizations
  scope: identity.compartment.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Compartment Membership in OCI Organizations
  rationale: Having compartments as part of an organization in OCI ensures centralized management and governance, which is critical for maintaining security across multiple accounts. This prevents account isolation vulnerabilities, reduces risk of inconsistent security policies, and ensures adherence to compliance regulations by leveraging Oracle Cloud's hierarchical structure.
  description: This rule checks if the OCI compartment is part of a defined organization, which is essential for enforcing consistent identity and access management policies across all compartments. To verify, ensure that the compartment's parent is a root compartment within an organization. Remediation involves configuring the compartment to be part of an organization, facilitating unified security controls and compliance adherence.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingorganisations.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/identitypolicy.htm
- rule_id: oci.compute.instance.management_managed_compliant_patching
  service: compute
  resource: instance
  requirement: Management Managed Compliant Patching
  scope: compute.instance.patch_management
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: medium
  title: Ensure Instances Follow Management Managed Patching Compliance
  rationale: Unpatched instances can be vulnerable to exploits and attacks, increasing the risk of data breaches and service disruptions. Ensuring instances are managed with compliant patching protects against known vulnerabilities and aligns with regulatory requirements such as PCI-DSS and ISO 27001, thereby safeguarding business operations and maintaining customer trust.
  description: This rule verifies that Oracle Cloud Infrastructure compute instances are configured for management-managed patching compliance. It checks if instances are part of a patch management solution that automates the patching process to ensure they are up-to-date with security patches. To verify compliance, review the instance management settings to confirm they are enrolled in a patch management plan. Remediation involves enrolling non-compliant instances in an OCI-managed patching service to automate updates and maintain security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/patchinginstances.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.compute.management.managed_compliant_patching
  service: compute
  resource: management
  requirement: Managed Compliant Patching
  scope: compute.management.patch_management
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: medium
  title: Ensure Managed Instances are Compliantly Patched
  rationale: Regularly applying patches ensures that known vulnerabilities in software and operating systems on managed instances are mitigated, reducing the risk of exploitation. Failure to maintain compliant patching can lead to security breaches, data loss, and non-compliance with industry regulations like PCI-DSS and ISO 27001, which can have severe financial and reputational impacts.
  description: This rule checks whether OCI Compute instances under management are configured for compliant patching. It ensures that automated patch management is enabled, including the application of critical and security patches within a specific timeframe. To verify, check for active patch management schedules in the OCI console. Remediation involves configuring the OCI OS Management service to automate patching with a defined schedule, ensuring critical updates are applied promptly.
  references:
  - https://docs.oracle.com/en-us/iaas/os-management/osms/osms_patching.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.mysql.db_system.flexible_server_enforce_ssl_enabled
  service: mysql
  resource: db_system
  requirement: Flexible Server Enforce SSL Enabled
  scope: mysql.db_system.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure SSL is Enabled for Flexible MySQL DB Systems
  rationale: Enforcing SSL for MySQL DB Systems in OCI ensures that data in transit is encrypted, protecting against interception and man-in-the-middle attacks. This is crucial for maintaining data integrity and confidentiality, especially for sensitive or regulated data, and helps in meeting compliance requirements such as PCI-DSS and HIPAA.
  description: This rule checks if SSL is enforced for MySQL DB Systems configured in Flexible Server mode on OCI. By default, data packets are transmitted in plaintext, which makes them vulnerable to eavesdropping. Enabling SSL encrypts these packets, securing data transmission. To verify, ensure the 'require_secure_transport' parameter is set to 'ON' in the MySQL configuration. Remediation involves accessing the OCI console, navigating to the MySQL DB System, and setting the SSL enforcement configuration.
  references:
  - https://docs.oracle.com/en-us/iaas/mysql-database/doc/security-overview.html#GUID-93D9F70E-4D3D-4D47-92F3-9E6C8EFD7B8F
  - CIS OCI Foundations Benchmark v1.0.0 - Section 3.3
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-52r1.pdf
  - https://www.oracle.com/security-alerts/
- rule_id: oci.mysql.db_system.flexible_server_log_checkpoints_on
  service: mysql
  resource: db_system
  requirement: Flexible Server Log Checkpoints On
  scope: mysql.db_system.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure MySQL Flexible Server Log Checkpoints are Enabled
  rationale: Enabling log checkpoints on MySQL Flexible Server is critical for maintaining consistent database state and ensuring recovery capability in case of failures or crashes. This setting can prevent data loss and support compliance with data integrity standards, such as PCI-DSS and ISO 27001, by providing reliable audit trails and system logs.
  description: This rule checks if the log checkpoints feature is enabled on MySQL Flexible Servers within your OCI environment. Log checkpoints help in maintaining the transactional integrity and provide a mechanism for database recovery. To verify this setting, access the MySQL DB System configuration and ensure that 'log_checkpoints' parameter is set to 'ON'. To remediate, update the server configuration settings through the OCI Console or CLI to enable log checkpoints, thereby enhancing data protection and audit capabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/mysql-database/doc/logging-metrics.html
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_OCIcompliance.htm
  - https://cloud.oracle.com/mysql/features
- rule_id: oci.mysql.db_system.flexible_server_log_connections_on
  service: mysql
  resource: db_system
  requirement: Flexible Server Log Connections On
  scope: mysql.db_system.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Logging for MySQL Flexible Server Connections
  rationale: Logging connections to MySQL Flexible Servers is crucial for detecting unauthorized access attempts, analyzing usage patterns, and ensuring compliance with security and regulatory standards. Without comprehensive logging, businesses may face increased risks of data breaches and non-compliance with frameworks like PCI-DSS and SOC2.
  description: This rule verifies that connection logging is enabled for MySQL Flexible Servers in OCI. Connection logging provides a detailed account of access patterns and potential security events. Administrators should ensure that the logging is configured to capture all connection attempts and store logs in a secure, centralized location. Remediation involves accessing the OCI Console, navigating to MySQL DB Systems, and enabling the 'Log Connections' option in the database settings.
  references:
  - https://docs.oracle.com/en-us/iaas/mysql-database/doc/mysql-database.html#logging
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.mysql.db_system.flexible_server_log_disconnections_on
  service: mysql
  resource: db_system
  requirement: Flexible Server Log Disconnections On
  scope: mysql.db_system.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure MySQL Flexible Server Logs Disconnections
  rationale: Logging disconnections in MySQL Flexible Servers is crucial for auditing and monitoring purposes. It helps detect unusual patterns that might indicate potential security threats like unauthorized access attempts or network issues. Proper logging supports compliance with regulatory frameworks requiring detailed access and activity records.
  description: This rule checks whether disconnection events are logged in MySQL Flexible Servers. Ensure that the 'log_disconnections' parameter is set to 'ON' in your MySQL database configuration. This setting should be verified through the OCI Console under the MySQL DB System settings or by checking the database configuration file. Remediation involves enabling this setting to enhance audit logging capabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/mysql-database/doc/logging.html
  - https://docs.oracle.com/en-us/iaas/Content/Compliance/Reference/cis-oci-benchmark.htm
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/security-cloud/compliance/
  - https://docs.oracle.com/en-us/iaas/cloud-security.html
- rule_id: oci.mysql.db_system.flexible_server_log_retention_days_greater_3
  service: mysql
  resource: db_system
  requirement: Flexible Server Log Retention Days Greater 3
  scope: mysql.db_system.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure MySQL Flexible Server Log Retention Exceeds 3 Days
  rationale: Retaining database logs for more than 3 days is crucial for tracking unauthorized access attempts, detecting anomalies, and supporting forensic investigations. This practice helps in complying with regulatory requirements such as PCI-DSS and ISO 27001, which mandate adequate log retention to ensure accountability and traceability in data management.
  description: This rule checks if the log retention period for MySQL Flexible Server instances in OCI is greater than 3 days. By default, short retention periods can hinder effective monitoring and auditing. To verify, access the OCI console, navigate to the MySQL DB System, and ensure the 'Log Retention Days' setting is configured beyond the minimum threshold. Adjust this setting in the console to enhance audit capabilities and meet compliance needs.
  references:
  - https://docs.oracle.com/en-us/iaas/mysql-database/doc/mysql-dbsystem.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.database.db_system.multi_az_enabled
  service: database
  resource: db_system
  requirement: Multi Az Enabled
  scope: database.db_system.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable Multi-AZ for DB Systems to Enhance Availability
  rationale: Enabling Multi-AZ configurations for OCI DB Systems enhances data availability and resilience against regional failures, thereby minimizing potential business disruptions. A lack of Multi-AZ could lead to significant downtime and data loss in case of a regional outage, impacting service continuity and customer trust. Compliance with standards such as PCI-DSS and ISO 27001 often requires robust data protection and disaster recovery strategies.
  description: This check verifies if Multi-AZ is enabled for Oracle Cloud Infrastructure DB Systems, ensuring data redundancy across multiple availability domains. To verify, check the DB System configuration in the OCI console or via CLI/API for a Multi-AZ setup. Remediation involves configuring your DB System to span multiple availability domains, which can be done during the DB System creation or by modifying existing configurations. This setting aids in achieving high availability and disaster recovery objectives.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/overview.htm
  - CIS OCI Foundations Benchmark v1.1.0 - 3.3 Ensure that DB Systems are Multi-AZ
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/managingdbsystems.htm
- rule_id: oci.database.cluster.backup_enabled
  service: database
  resource: cluster
  requirement: Backup Enabled
  scope: database.cluster.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: medium
  title: Ensure Database Cluster Backups Are Enabled
  rationale: Enabling backups for database clusters is crucial for safeguarding data against loss due to system failures, cyber attacks, or accidental deletions. Regular backups support business continuity, helping meet compliance requirements such as GDPR and HIPAA, and mitigate risks associated with data breaches and operational downtime.
  description: This rule checks if backups are enabled for Oracle Cloud Infrastructure (OCI) database clusters. To verify, ensure that the automatic backup feature is configured through the OCI Console under the database cluster settings. Enabling automatic backups involves setting a backup schedule and defining retention policies. For remediation, configure these settings to automate daily backups and ensure that retention complies with organizational policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/backingup.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hipaajournal.com/hipaa-compliance/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.cluster.cluster_audit_logging
  service: database
  resource: cluster
  requirement: Cluster Audit Logging
  scope: database.cluster.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Audit Logging for OCI Database Clusters
  rationale: Audit logging for database clusters is crucial for tracking access and modifications, which aids in identifying unauthorized activities and safeguarding sensitive data. This is vital for compliance with regulations such as PCI-DSS and GDPR, which mandate detailed logging of database interactions to ensure accountability and traceability of actions.
  description: This rule checks whether audit logging is enabled for Oracle Cloud Infrastructure database clusters. Audit logs should be configured to capture all access and modifications to database resources, and stored securely for analysis and compliance purposes. To enable audit logging, ensure that the database cluster has logging configured via the OCI Console or API, and verify that logs are being routed to an Oracle Cloud Logging service. Remediation involves enabling audit logs in the database settings and confirming log retention and access policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/databaseoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_2.0.0.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security-cloud-compliance/capabilities/audit/
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
- rule_id: oci.database.cluster.cluster_automated_snapshot
  service: database
  resource: cluster
  requirement: Cluster Automated Snapshot
  scope: database.cluster.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure Automated Snapshots for Database Clusters
  rationale: Automated snapshots are critical for ensuring data resiliency and disaster recovery in Oracle Cloud Infrastructure. They help protect against data loss due to accidental deletion, corruption, or ransomware attacks. Enabling automated snapshots aligns with regulatory compliance requirements such as PCI-DSS and ISO 27001, which mandate regular data backup procedures.
  description: This rule verifies that automated snapshot functionality is enabled for Oracle Cloud Infrastructure database clusters. Automated snapshots ensure that consistent backups are taken at regular intervals, minimizing data loss risks. To verify, check the backup policy settings in the OCI Console under Database Management and ensure the 'Automated Backups Enabled' option is active. If not enabled, configure automated snapshots by navigating to the database cluster settings and enabling the backup policy to include regular snapshots.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/security/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/backingup.htm
- rule_id: oci.database.cluster.cluster_in_transit_encryption_enabled
  service: database
  resource: cluster
  requirement: Cluster In Transit Encryption Enabled
  scope: database.cluster.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Cluster In Transit Encryption Must Be Enabled
  rationale: Enabling in-transit encryption for database clusters is crucial to protect sensitive data from interception during transmission. Unencrypted data in transit can be vulnerable to man-in-the-middle attacks, leading to unauthorized access and data breaches. Enforcing this setting helps comply with regulatory standards such as PCI-DSS and HIPAA, which require robust data protection measures.
  description: This rule checks if encryption for data in transit is enabled for Oracle Cloud Infrastructure database clusters. To verify, ensure that the cluster's network communication settings are configured to use TLS encryption. Remediation involves updating the cluster settings to enforce encryption for all data in transit, which can be achieved through the OCI Console or API by modifying the network ACLs and enabling the required TLS protocols.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/databasesecurity.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-52r1.pdf
- rule_id: oci.database.cluster.cluster_public_access
  service: database
  resource: cluster
  requirement: Cluster Public Access
  scope: database.cluster.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Prevent Public Access to Database Clusters
  rationale: Allowing public access to database clusters can expose sensitive data to unauthorized users, leading to potential data breaches and non-compliance with regulatory standards such as PCI-DSS and HIPAA. Ensuring that database clusters are not publicly accessible mitigates the risk of unauthorized access and data exfiltration, protecting both business assets and customer information.
  description: This rule checks whether Oracle Cloud Infrastructure (OCI) database clusters are configured to allow public access. Publicly accessible clusters can be vulnerable to attacks if not properly secured. To verify, inspect the network configuration to ensure the cluster is not associated with a public subnet or lacks an internet gateway. Remediation involves reconfiguring the database network settings to use private subnets and implementing stringent access controls using OCI's Network Security Groups (NSGs) and Security Lists.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/document_library
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.dns.zone.public_hosted_zones_monitoring_logging_enabled
  service: dns
  resource: zone
  requirement: Public Hosted Zones Monitoring Logging Enabled
  scope: dns.zone.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: critical
  title: Enable Logging for Public DNS Zones
  rationale: Enabling logging for public DNS zones is crucial as it helps detect and respond to unauthorized changes, potential misconfigurations, and malicious activities. Without logging, there's a risk of undetected DNS spoofing or hijacking, which can lead to data breaches, service disruption, and non-compliance with regulatory frameworks that require audit trails.
  description: This rule checks whether DNS query logging is enabled for public DNS zones in OCI. Logging should be configured to capture all DNS queries and responses, providing visibility into DNS activities and aiding in forensic analysis. To remediate, use the OCI Console or API to enable logging on all public DNS zones and ensure logs are stored securely in OCI Logging. Regularly review logs for suspicious activities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DNS/Reference/dnslogging.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
- rule_id: oci.object_storage.bucket.bucket_metrics_enabled
  service: object_storage
  resource: bucket
  requirement: Bucket Metrics Enabled
  scope: object_storage.bucket.security
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure Object Storage Bucket Metrics Are Enabled
  rationale: Enabling bucket metrics in OCI provides critical insights into storage usage and access patterns, which helps in optimizing performance and cost management. Without metrics, organizations lack visibility into potential misuse or inefficiencies, increasing the risk of unauthorized access and data breaches. Enabling this feature supports compliance with data governance and regulatory requirements by maintaining detailed access logs.
  description: This rule checks if metrics are enabled for Object Storage buckets in OCI. Bucket metrics provide detailed information about the number of read and write operations, latency, and data retrievals, which are crucial for monitoring and auditing purposes. To verify, log into the OCI Console, navigate to the Object Storage service, and ensure the 'Enable Metrics' option is checked for each bucket. Remediation involves editing the bucket settings to enable metrics, which can be automated using the OCI CLI or SDKs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#metrics
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
- rule_id: oci.object_storage.bucket.bucket_replication_enabled
  service: object_storage
  resource: bucket
  requirement: Bucket Replication Enabled
  scope: object_storage.bucket.replication
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Enable Replication for OCI Object Storage Buckets
  rationale: Enabling bucket replication in OCI Object Storage ensures data redundancy and availability across regions, which is crucial for disaster recovery and business continuity. It helps mitigate the risk of data loss due to regional outages or disruptions and supports compliance with data protection regulations that require data backup and resilience.
  description: This rule checks whether replication is enabled for OCI Object Storage buckets, ensuring data is duplicated across specified regions. Users can verify replication settings in the OCI Console under the Object Storage service by navigating to the bucket's settings and confirming replication is configured. To enable replication, configure a replication policy specifying the destination region and bucket. This step is essential for maintaining high data availability and resilience.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingbuckets.htm#Replication
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.data_science.notebook_session.notebook_instance_encryption_enabled
  service: data_science
  resource: notebook_session
  requirement: Notebook Instance Encryption Enabled
  scope: data_science.notebook_session.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Encryption Enabled for OCI Notebook Sessions
  rationale: Encrypting data at rest in OCI Notebook Sessions is crucial for protecting sensitive information from unauthorized access and potential data breaches. Failure to enable encryption can lead to exposure of intellectual property and violate compliance with regulations such as GDPR and HIPAA, which may result in severe financial penalties and reputational damage.
  description: This rule checks if encryption is enabled for OCI Notebook Sessions, ensuring that all data stored within is encrypted using Oracle Cloud's encryption mechanisms. To verify, review the encryption settings in the OCI Console under the Data Science service and ensure that the notebook sessions are configured to use encryption keys managed by Oracle or customer-managed keys in the Key Management service. Remediation involves updating notebook configurations to enable encryption for all existing and new notebook sessions.
  references:
  - https://docs.oracle.com/en-us/iaas/data-science/using/notebook-sessions.htm#encryption
  - https://www.oracle.com/security/cloud-compliance/
  - https://cloudsecurityalliance.org/research-oci/
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.data_science.project.notebook_instance_without_direct_internet_access_configured
  service: data_science
  resource: project
  requirement: Notebook Instance Without Direct Internet Access Configured
  scope: data_science.project.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict Internet Access to Data Science Notebook Instances
  rationale: Direct internet access to Data Science Notebook Instances can increase the attack surface by exposing sensitive data and computational environments to external threats. This can lead to unauthorized access, data breaches, and compliance violations with standards such as NIST and ISO 27001. Restricting internet access mitigates risks associated with data exfiltration and unauthorized data exposure.
  description: This check verifies if notebook instances within an OCI Data Science project are configured to restrict direct internet access. To ensure secure configurations, these instances should be connected to a Virtual Cloud Network (VCN) with appropriate security lists or network security group rules that block outbound internet traffic. Remediation involves updating the VCN configuration to implement these restrictions and validating the setup through the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Reference/secure-data-science.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networkoverview.htm
  - 'NIST SP 800-53: AC-4 Information Flow Enforcement'
  - ISO 27001:2013 A.13.1 Network Security Management
  - https://cloudsecurityalliance.org/education/cloud-security-guides/
- rule_id: oci.identity.compartment.resource_no_root_compartment
  service: identity
  resource: compartment
  requirement: Resource No Root Compartment
  scope: identity.compartment.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Prevent Root Compartment Direct Resource Creation
  rationale: Using the root compartment for resource creation poses a significant security risk as it can lead to unauthorized access and potential data breaches. Root compartments should be reserved for administrative tasks to minimize the attack surface and ensure strict access control. This practice aligns with regulatory requirements for access management and helps mitigate insider threats.
  description: This rule checks if resources are being created directly within the root compartment, which is strongly discouraged. Instead, resources should be organized within sub-compartments to leverage OCI's robust policy framework for access control. To verify compliance, review resource placement and configure policies to enforce sub-compartment usage. Remediation involves migrating resources to appropriate sub-compartments and updating IAM policies to restrict direct root compartment access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcompartments.htm
  - https://www.oracle.com/security-cloud/cis-benchmark/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
- rule_id: oci.vault.secret.automatic_rotation_enabled
  service: vault
  resource: secret
  requirement: Automatic Rotation Enabled
  scope: vault.secret.key_rotation
  domain: secrets_and_key_management
  subcategory: key_management
  severity: medium
  title: Enable Automatic Rotation for OCI Vault Secrets
  rationale: Automatic rotation of secrets minimizes the risk of secret compromise by regularly updating credentials, thereby reducing exposure time if a secret is leaked or compromised. This practice aligns with security best practices and regulatory requirements, ensuring that sensitive data remains protected and access is controlled. Automatic rotation also reduces the operational burden on security teams by automating credential management.
  description: This rule checks whether automatic rotation is enabled for secrets stored in OCI Vault. Ensuring automatic rotation is enabled helps maintain the integrity of secrets by periodically updating them without manual intervention. To verify, navigate to the OCI Vault service, select the secret, and check the settings for automatic rotation. If not enabled, set up a rotation policy that determines the frequency and method of rotation. This can be configured through the OCI Console or CLI, ensuring that secrets are rotated securely and consistently.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/usingsecrets.htm#rotatingsecrets
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.oracle.com/security/cloud-security/key-management/
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keymanagementoverview.htm
- rule_id: oci.cloud_guard.target.enabled
  service: cloud_guard
  resource: target
  requirement: Enabled
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Cloud Guard Target is Enabled for Continuous Monitoring
  rationale: Enabling Cloud Guard targets is crucial for maintaining continuous security monitoring and threat detection across OCI resources. Without active monitoring, organizations risk undetected security incidents, leading to potential data breaches and non-compliance with regulatory standards such as GDPR and ISO 27001. Enabling Cloud Guard enhances security posture by providing visibility into potential misconfigurations and security threats.
  description: This rule verifies that Cloud Guard targets are enabled, ensuring continuous security posture management across OCI environments. To verify, access the OCI console, navigate to Cloud Guard, and ensure that your security targets are set to 'Enabled'. If they are not, select each target and enable it to start monitoring. This action ensures that Cloud Guard is actively assessing resources for vulnerabilities and provides actionable insights to remediate potential risks.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/using-cloud-guard.html
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/pdfs/oci-cis-1-0-0.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.cloud_guard.target.advanced_protection_in_internet_facing_load_balancers
  service: cloud_guard
  resource: target
  requirement: Advanced Protection In Internet Facing Load Balancers
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Enable Advanced Protection for Internet-Facing Load Balancers
  rationale: Internet-facing load balancers are vulnerable entry points that can be targeted by attackers. Without advanced protection mechanisms, they may expose sensitive data or allow unauthorized access, potentially leading to data breaches and service disruptions. Implementing advanced security measures helps mitigate these risks and ensures compliance with industry standards.
  description: This rule verifies that all internet-facing load balancers in OCI have advanced protection enabled, such as Web Application Firewall (WAF) and SSL/TLS encryption. To verify, ensure that the load balancer's configuration includes WAF policies and adheres to security best practices for TLS settings. Remediation involves enabling WAF and configuring SSL/TLS with strong cipher suites and certificates to protect data in transit.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/LoadBalancing/Concepts/loadbalancingoverview.htm
  - CIS Oracle Cloud Infrastructure Foundations Benchmark
  - https://www.nist.gov/publications/nist-special-publication-800-190-application-container-security-guide
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.ons.topic.topics_kms_encryption_enabled
  service: ons
  resource: topic
  requirement: Topics KMS Encryption Enabled
  scope: ons.topic.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure ONS Topics Are Encrypted with KMS
  rationale: Encrypting Oracle Notification Service (ONS) topics with Key Management Service (KMS) protects sensitive data from unauthorized access and potential data breaches, which can lead to significant financial and reputational damage. It also helps organizations comply with regulatory requirements such as GDPR, HIPAA, and PCI-DSS, which mandate strong encryption practices for data protection.
  description: This rule checks if Oracle Notification Service (ONS) topics are configured to use Oracle Cloud Infrastructure's Key Management Service (KMS) for encryption. By default, topics may not be encrypted, exposing data to risks. Ensure that each ONS topic has KMS encryption enabled by specifying a valid KMS key during topic creation or by updating existing topics. Verification can be done via the OCI Console or CLI by inspecting the 'kmsKey' attribute of the topic. To remediate, configure a KMS key in the ONS topic settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Notification/Concepts/notificationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Notification/Tasks/managingtopicsandsubscriptions.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_2.0.0.pdf
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
- rule_id: oci.database.autonomous_database.auditing_retention_90_days
  service: database
  resource: autonomous_database
  requirement: Auditing Retention 90 Days
  scope: database.autonomous_database.audit_logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Autonomous Database Auditing Retains Logs for 90 Days
  rationale: Retention of audit logs for at least 90 days is crucial for incident investigation, forensic analysis, and compliance with regulatory frameworks such as PCI-DSS and HIPAA. Without adequate log retention, organizations risk undetected data breaches, non-compliance fines, and damage to reputation due to insufficient auditing capabilities.
  description: This rule verifies that Oracle Cloud Infrastructure Autonomous Databases have audit log retention configured for a minimum of 90 days. Administrators should ensure that audit policies are enabled and configured correctly to keep logs for the specified period. Remediation involves adjusting the database settings to extend log retention, ensuring compliance with industry standards and enabling effective monitoring and analysis of database activities.
  references:
  - https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/security-guide.html#GUID-3D2F5E4A-E3A7-4F6D-8E50-8B9B5B8E9A39
  - https://www.oracle.com/security-cloud/cis-benchmarks/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/compliance/iso-27001/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-92.pdf
- rule_id: oci.database.autonomous_database.microsoft_defender_enabled
  service: database
  resource: autonomous_database
  requirement: Microsoft Defender Enabled
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable Microsoft Defender on Autonomous Databases
  rationale: Enabling Microsoft Defender on OCI Autonomous Databases enhances threat detection and response capabilities, protecting sensitive data from unauthorized access and potential breaches. This configuration helps meet regulatory compliance requirements, such as GDPR and CCPA, by ensuring robust data protection mechanisms are in place. It also mitigates risks associated with data loss and cyber threats, safeguarding business operations and reputation.
  description: This rule checks if Microsoft Defender is enabled on OCI Autonomous Databases, ensuring that advanced threat protection features are active. To verify, access the OCI Console, navigate to the Autonomous Database details page, and confirm that Microsoft Defender is activated under the Security settings. If not enabled, configure the setting to activate Microsoft Defender, providing enhanced security and compliance with industry standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/enablingmicrosoftdefender.htm
  - https://www.oracle.com/security/cis-benchmarks/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/
  - https://www.oracle.com/cloud/oci-compliance/
  - https://www.oracle.com/security/identity-access/
- rule_id: oci.database.autonomous_database.recommended_minimal_tls_version
  service: database
  resource: autonomous_database
  requirement: Recommended Minimal TLS Version
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Minimal TLS Version for Autonomous Databases
  rationale: Using an outdated TLS version can lead to vulnerabilities such as man-in-the-middle attacks, which can compromise sensitive data. Adhering to the recommended TLS version helps protect data confidentiality and integrity, aligns with industry standards, and meets regulatory requirements such as PCI-DSS and HIPAA.
  description: This rule checks the TLS version configured for Autonomous Databases to ensure it meets the recommended minimum version for secure communications. It verifies that the TLS version is set to at least TLS 1.2, which provides enhanced security features. To remediate, update the database's TLS settings via the OCI Console or API to the recommended version. Regularly review and update TLS configurations to mitigate evolving threats.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/autonomousdatabase.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation_benchmark
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-52/rev-2/final
  - https://www.oracle.com/security/cloud-security/tls-best-practices/
- rule_id: oci.database.autonomous_database.tde_encrypted_with_cmk
  service: database
  resource: autonomous_database
  requirement: Tde Encrypted With CMK
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Uses TDE with Customer-Managed Key
  rationale: Encrypting data at rest with Transparent Data Encryption (TDE) using a Customer-Managed Key (CMK) enhances control over encryption keys, reducing the risk of unauthorized data access. This is critical for meeting regulatory compliance requirements such as PCI-DSS and HIPAA and mitigating the risk of data breaches where internal actors or cloud provider access could be a threat.
  description: This check verifies that Oracle Autonomous Databases are configured to use TDE with a Customer-Managed Key (CMK) rather than the default Oracle-managed keys. To ensure your database is compliant, configure TDE to use a key from Oracle Cloud Infrastructure's Vault service. This involves setting up a Key Management vault, creating a master encryption key, and associating it with your Autonomous Database. Regularly rotate and securely manage these keys to maintain data protection.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbmanaging.htm#CMK
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://csrc.nist.gov/publications/detail/sp/800-57/part-1/rev-5/final
  - https://www.oracle.com/security/cloud-security/key-management/
- rule_id: oci.database.autonomous_database.tde_encryption_enabled
  service: database
  resource: autonomous_database
  requirement: Tde Encryption Enabled
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure TDE Encryption is Enabled for Autonomous Databases
  rationale: Transparent Data Encryption (TDE) is crucial for protecting sensitive data stored in Autonomous Databases by encrypting data at rest. Lack of encryption can lead to unauthorized data access, resulting in potential data breaches and non-compliance with regulations such as PCI-DSS and HIPAA. Enabling TDE helps mitigate risks associated with data exposure and ensures alignment with industry standards for data protection and privacy.
  description: This rule checks whether Transparent Data Encryption (TDE) is enabled for Oracle Autonomous Databases. TDE automatically encrypts data before it is written to storage and decrypts it when read from storage. To verify, check the database service console or use OCI CLI commands to confirm TDE status. If TDE is not enabled, configure it through the OCI console by navigating to the Autonomous Database details page and enabling encryption. This ensures data is protected at rest, safeguarding against unauthorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm#adb-tde
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-111.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/sites/default/files/ocr/privacy/hipaa/administrative/securityrule/securityrulepdf.pdf
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.database.autonomous_database.unrestricted_inbound_access
  service: database
  resource: autonomous_database
  requirement: Unrestricted Inbound Access
  scope: database.autonomous_database.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Inbound Access to Autonomous Databases
  rationale: Unrestricted inbound access to Autonomous Databases can lead to unauthorized data exposure, increasing the risk of data breaches and non-compliance with regulations such as GDPR and PCI-DSS. Cyber attackers could exploit open permissions to perform malicious activities, compromising business integrity and causing significant financial and reputational damage.
  description: This rule checks for Autonomous Databases configured with unrestricted inbound access, which can be verified by examining the database's network settings and access control lists. To mitigate risk, implement network security groups (NSGs) or virtual cloud network (VCN) security rules to restrict inbound traffic to only trusted IP addresses and services. Regularly audit and adjust security lists to ensure minimal exposure while maintaining necessary access for authorized users.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_guide.htm
  - CIS OCI Benchmark
  - https://www.pcisecuritystandards.org
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.compute.instance.managed_compliant_patching
  service: compute
  resource: instance
  requirement: Managed Compliant Patching
  scope: compute.instance.patch_management
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: medium
  title: Ensure OCI Compute Instances Have Managed Compliant Patching
  rationale: Unpatched compute instances can be vulnerable to exploits and malware, leading to data breaches and service disruptions. Managed compliant patching helps maintain system integrity, minimizes downtime, and ensures adherence to regulatory standards such as PCI-DSS and HIPAA, protecting both business operations and sensitive data.
  description: This rule checks if Oracle Cloud Infrastructure compute instances are enrolled in a managed patching policy that ensures timely updates. Instances should be configured using Oracle OS Management, which automates the patching process according to a defined schedule. Verify compliance by reviewing the OS Management service settings and ensuring instances are associated with a patch management profile. Remediation involves enabling OS Management and applying an appropriate patching schedule to non-compliant instances.
  references:
  - https://docs.oracle.com/en-us/iaas/os-management/osms/os-management-service.html
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_platform
  - https://www.pcisecuritystandards.org
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://www.oracle.com/security/cloud-compliance/
- rule_id: oci.data_integration.workspace.statemachine_logging_enabled
  service: data_integration
  resource: workspace
  requirement: Statemachine Logging Enabled
  scope: data_integration.workspace.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Statemachine Logging in Data Integration Workspaces
  rationale: Enabling statemachine logging in Oracle Cloud Infrastructure's Data Integration workspaces is crucial for tracking and auditing the sequence of events and operations performed. This ensures accountability and traceability, which are essential for identifying security incidents, understanding system behavior, and meeting compliance mandates such as PCI-DSS and SOC2. Without logging, it becomes challenging to investigate incidents or prove adherence to regulatory requirements.
  description: This rule checks whether statemachine logging is enabled within OCI Data Integration workspaces. Proper configuration involves enabling logging for state machines to capture all relevant events and transitions, facilitating detailed audits. To verify, inspect the logging settings of each workspace and ensure the integration with OCI Logging service is active. Remediation involves accessing the OCI console, navigating to Data Integration, selecting the workspace, and enabling logging under the statemachine configuration settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Data-Integration/Concepts/getting-started.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/sorhome.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.object_storage.bucket.blob_public_access_level_is_disabled
  service: object_storage
  resource: bucket
  requirement: Blob Public Access Level Is Disabled
  scope: object_storage.bucket.public_access
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: critical
  title: Ensure Object Storage Buckets Have Blob Public Access Disabled
  rationale: Publicly accessible object storage buckets can expose sensitive data to unauthorized users, leading to data breaches and non-compliance with regulations like GDPR and HIPAA. Disabling blob public access mitigates risks of accidental data exposure and aligns with best practices for data privacy and security.
  description: This rule checks if the blob public access level is disabled for OCI Object Storage buckets, preventing unauthorized access to stored data. Verify the bucket's public access setting via the OCI Console or CLI. To remediate, set the 'Public Access' option to 'No public access' in the bucket's settings, ensuring all data is restricted to authenticated users only.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#public-access
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.object_storage.bucket.ensure_encryption_with_cmks
  service: object_storage
  resource: bucket
  requirement: Ensure Encryption With Cmks
  scope: object_storage.bucket.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable CMK Encryption for OCI Object Storage Buckets
  rationale: Encrypting data with Customer-Managed Keys (CMKs) ensures that organizations maintain control over encryption keys, reducing risks associated with unauthorized data access or breaches. This is crucial for protecting sensitive data and meeting compliance requirements such as GDPR and PCI-DSS, which mandate robust data protection measures. Using CMKs also enables better auditability and key rotation practices, enhancing overall data security posture.
  description: This rule ensures that OCI Object Storage buckets are encrypted using Customer-Managed Keys (CMKs) rather than Oracle-managed keys. To verify compliance, check that each bucket's encryption settings specify a CMK from the OCI Vault service. Remediation involves creating a CMK in OCI Vault, then updating bucket settings to use this key for encryption. This enhances data security by giving you full control over the encryption keys used for your data.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#encryption
  - https://www.oracle.com/security-cloud/compliance/cis-oci-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security-cloud/data-encryption/
- rule_id: oci.object_storage.bucket.ensure_minimum_tls_version_12
  service: object_storage
  resource: bucket
  requirement: Ensure Minimum TLS Version 12
  scope: object_storage.bucket.security
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Enforce TLS 1.2+ for Object Storage Buckets
  rationale: Ensuring a minimum TLS version of 1.2 for Object Storage buckets is crucial as it mitigates the risk of data interception and unauthorized access through older, less secure protocols. This is vital for maintaining data confidentiality and integrity, adhering to regulatory standards like PCI-DSS and HIPAA, and preventing potential data breaches or financial losses.
  description: This rule checks Object Storage bucket configurations to verify that TLS 1.2 or higher is enforced for all communications. Administrators must configure the bucket settings to disable older TLS versions, ensuring that only secure, modern encryption protocols are used. Verification involves reviewing the bucket's settings in the OCI Console under the 'Security' tab and updating the 'Minimum TLS Version' to 1.2 or above. Remediation involves navigating to the OCI Console, selecting the desired bucket, and adjusting the security settings accordingly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#security
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-52r1.pdf
- rule_id: oci.object_storage.bucket.ensure_soft_delete_is_enabled
  service: object_storage
  resource: bucket
  requirement: Ensure Soft Delete Is Enabled
  scope: object_storage.bucket.security
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure Object Storage Bucket Soft Delete is Enabled
  rationale: Enabling Soft Delete on Object Storage buckets mitigates the risk of accidental or malicious data deletion by retaining deleted objects for a specified period. This feature aids in data recovery and supports compliance with data retention policies, reducing potential business disruptions and data loss incidents.
  description: This rule checks if the Soft Delete feature is enabled for Object Storage buckets in OCI. Soft Delete allows deleted objects to be retained for a configured duration before permanent deletion, facilitating recovery. To verify, navigate to the OCI console, select the Object Storage bucket, and check the 'Soft Delete' settings. To remediate, enable Soft Delete and set an appropriate retention period based on your organization's data protection policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingsoftdelete.htm
  - https://www.oracle.com/security-cloud-compliance/cis-oci/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/document_library
  - https://www.iso.org/standard/54534.html
  - https://www.oracle.com/cloud/security/
- rule_id: oci.object_storage.bucket.infrastructure_encryption_is_enabled
  service: object_storage
  resource: bucket
  requirement: Infrastructure Encryption Is Enabled
  scope: object_storage.bucket.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable Infrastructure Encryption for Object Storage Buckets
  rationale: Enabling infrastructure encryption for object storage buckets is critical to protect sensitive data at rest from unauthorized access and potential breaches. This enhances data security and helps meet regulatory compliance requirements such as PCI-DSS and HIPAA by ensuring that all stored data is encrypted using Oracle-managed keys, reducing the risk of data exposure.
  description: This rule checks if infrastructure encryption is enabled for Oracle Cloud Infrastructure (OCI) Object Storage buckets. Infrastructure encryption uses Oracle-managed keys to automatically encrypt data at rest, providing an additional layer of security. To verify, ensure that the 'Encrypt using Oracle-managed keys' option is enabled for each bucket. Remediation involves updating bucket settings in the OCI Console to enable this encryption option.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#enable_encryption
  - https://www.oracle.com/security/cloud-security/cis-oci/
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/index.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm#encryption
- rule_id: oci.object_storage.bucket.secure_transfer_required_is_enabled
  service: object_storage
  resource: bucket
  requirement: Secure Transfer Required Is Enabled
  scope: object_storage.bucket.security
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure Secure Transfer for OCI Object Storage Buckets
  rationale: Enabling secure transfer for object storage buckets is crucial to protect sensitive data from being intercepted during transit. This reduces the risk of data breaches and unauthorized access, aligning with regulatory compliance requirements such as GDPR and PCI-DSS. It is essential to maintain the confidentiality and integrity of data, especially when transferring over public networks.
  description: This rule checks if the 'Secure Transfer Required' setting is enabled for OCI Object Storage buckets, ensuring all data transfers use HTTPS. This configuration prevents unencrypted data transfer, mitigating risks associated with eavesdropping and man-in-the-middle attacks. To verify, navigate to the OCI Console, select the Object Storage bucket, and ensure the 'Secure Transfer Required' option is activated. Remediation involves enabling this setting for all buckets lacking it.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#managingbuckets
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
- rule_id: oci.object_storage.bucket.storage_accounts
  service: object_storage
  resource: bucket
  requirement: Storage Accounts
  scope: object_storage.bucket.security
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure Object Storage Buckets Use Dedicated Storage Accounts
  rationale: Using separate storage accounts for different buckets enhances data segregation, limits the scope of potential breaches, and aligns with best practices for data management. This approach reduces the risk of unauthorized access and data leakage by isolating sensitive data, which is crucial for maintaining compliance with regulations like GDPR and CCPA.
  description: This rule checks if object storage buckets are associated with dedicated storage accounts rather than shared accounts. Verify by reviewing the bucket configuration in the OCI console and ensuring each bucket is tied to a specific compartment or account. To remediate, create separate storage accounts for each bucket and migrate data as necessary, adjusting IAM policies to maintain least privilege access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/creatingbuckets.htm
  - https://www.oracle.com/cloud/cloud-native/cis-benchmark/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.object_storage.bucket.server_in_transit_encryption_enabled
  service: object_storage
  resource: bucket
  requirement: Server In Transit Encryption Enabled
  scope: object_storage.bucket.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure In-Transit Encryption for OCI Object Storage Buckets
  rationale: Enabling server-side encryption in transit for Object Storage buckets is critical to protect data as it travels across networks. This measure mitigates the risk of data interception and unauthorized access, which can lead to data breaches or non-compliance with regulations such as PCI-DSS and GDPR. Ensuring encryption in transit helps maintain data confidentiality and integrity, safeguarding sensitive business information and customer data.
  description: This rule checks if server-side encryption in transit is enabled for Object Storage buckets in Oracle Cloud Infrastructure (OCI). Specifically, it verifies that TLS protocols are enforced to secure data transactions. To verify, ensure that your bucket settings enforce HTTPS connections, using OCI Console or CLI. Remediation involves configuring the bucket to disallow unencrypted connections, thus enforcing encryption for data in transit. This configuration prevents potential data leaks and unauthorized data access during network transmission.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingpreauthenticatedrequests.htm
  - https://www.oracle.com/security/cloud-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.key_management.vault.cmk_rotation_enabled
  service: key_management
  resource: vault
  requirement: CMK Rotation Enabled
  scope: key_management.vault.key_rotation
  domain: secrets_and_key_management
  subcategory: key_management
  severity: medium
  title: Ensure CMK Automatic Rotation is Enabled in OCI Vault
  rationale: Automatic rotation of Customer Master Keys (CMKs) is critical for maintaining the integrity and confidentiality of encrypted data. Regularly rotating keys minimizes the risk of exposure from compromised keys and aligns with best practices for cryptographic hygiene. It also helps meet compliance requirements for standards like PCI-DSS and ISO 27001, which mandate periodic key changes to reduce potential attack vectors.
  description: This rule checks if automatic rotation is enabled for CMKs within an OCI Vault. CMK rotation ensures that keys are periodically changed without manual intervention, thereby improving security posture. To verify, navigate to the OCI Console, go to 'Vaults', select the specific vault, and check the 'Key Rotation' settings for each key. If not enabled, configure the key to rotate automatically by setting an appropriate rotation period. This ensures that keys are kept fresh and limits the window of exposure for any potential key compromise.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/using.htm#rotating
  - https://docs.oracle.com/en-us/iaas/Content/Compliance/Concepts/compliancestandards.htm#payment_card_industry_data_security_standard
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://www.iso.org/standard/54534.html
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.key_management.vault.key_expiration_set
  service: key_management
  resource: vault
  requirement: Key Expiration Set
  scope: key_management.vault.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure Key Expiration is Set in OCI Vault
  rationale: Setting key expiration in OCI Vault mitigates risks associated with compromised or stale encryption keys, reducing the risk of unauthorized data access. It aligns with best security practices by ensuring keys are rotated regularly, which is crucial for maintaining data confidentiality and integrity. Regulatory frameworks such as PCI-DSS and ISO 27001 emphasize key management, making expiration policies a compliance requirement.
  description: This rule checks if an expiration date is set for keys within an OCI Vault. Ensuring keys have an expiration date helps enforce automatic key rotation and reduces the risk of using outdated or potentially compromised keys. To verify and remediate, navigate to the OCI Console, access the Key Management service, and ensure each key within your vaults has an expiration policy set. This can be configured during key creation or by editing existing keys.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingkeys.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r4.pdf
- rule_id: oci.key_management.vault.key_lifecycle_policy
  service: key_management
  resource: vault
  requirement: Key Lifecycle Policy
  scope: key_management.vault.lifecycle_management
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure Proper Key Lifecycle Policy in OCI Vaults
  rationale: Implementing a key lifecycle policy in Oracle Cloud Infrastructure Vaults is crucial for maintaining the security and integrity of cryptographic keys. Without a defined lifecycle, keys may be used beyond their intended duration, increasing the risk of unauthorized access and data breaches. Additionally, regulatory frameworks such as PCI-DSS and HIPAA mandate strict key management practices to safeguard sensitive information.
  description: This rule checks whether a key lifecycle policy is set for keys managed within OCI Vaults. The policy should include key rotation, expiration, and deletion guidelines to ensure keys do not remain active beyond their intended lifespan. To verify, review the key management settings in the OCI Console under the Vault service and configure lifecycle policies as necessary. Remediation involves setting automated key rotation and specifying expiration dates to comply with security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingkeys.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-foundations-benchmark.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.key_management.vault.key_rotation_enabled
  service: key_management
  resource: vault
  requirement: Key Rotation Enabled
  scope: key_management.vault.key_rotation
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Enable Key Rotation for OCI Vault Keys
  rationale: Regular key rotation enhances security by limiting the exposure of encryption keys, mitigating the risk of unauthorized access or data breaches. It addresses compliance requirements from standards like PCI-DSS and ISO 27001, which mandate key management practices to protect sensitive data. Failing to rotate keys can result in prolonged exposure to compromised keys, increasing the risk of data theft and regulatory penalties.
  description: This rule checks if automatic key rotation is enabled for keys stored in OCI Vault. Automatic key rotation ensures that keys are replaced at regular intervals, reducing the risk of cryptographic compromise. To verify, navigate to the OCI Console, access the Key Management service, select the vault, and confirm that key rotation is set to 'Enabled' for each key. To enable, configure the rotation policy under the vault's key management settings. Regular rotation schedules, such as every 90 days, are recommended.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingkeys.htm#rotation
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloud.oracle.com/en_US/cloud-security/key-management
- rule_id: oci.virtual_network.vcn.flow_logs_enabled
  service: virtual_network
  resource: vcn
  requirement: Flow Logs Enabled
  scope: virtual_network.vcn.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Flow Logs for Virtual Cloud Network (VCN)
  rationale: Enabling flow logs for VCN is crucial for monitoring network traffic, detecting anomalies, and investigating security incidents. Without flow logs, unauthorized access or data exfiltration may go unnoticed. This capability supports compliance with standards that require detailed audit trails, such as PCI-DSS and ISO 27001, by providing visibility into network activities.
  description: This rule checks if flow logs are enabled for Virtual Cloud Networks (VCNs) on Oracle Cloud Infrastructure. Flow logs capture detailed information about the network traffic traversing a VCN, including accepted and rejected requests, which can be used for security analysis and compliance auditing. To enable flow logs, navigate to the VCN settings in the OCI Console, and activate the flow log feature under the 'Logging' section. Regularly review and analyze these logs to detect and respond to suspicious activities promptly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/flowlogs.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_platform
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-92.pdf
- rule_id: oci.virtual_network.vcn.network_acl_unused
  service: virtual_network
  resource: vcn
  requirement: Network ACL Unused
  scope: virtual_network.vcn.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Identify and Remove Unused Network ACLs in OCI
  rationale: Unused Network ACLs in a Virtual Cloud Network (VCN) can introduce unnecessary complexity and potential security risks. They may lead to configuration errors, increased attack surface, and non-compliance with security standards if not properly managed. Ensuring that only active and necessary ACLs are in place helps to maintain a secure and efficient cloud environment.
  description: This rule checks for Network ACLs within an OCI VCN that are not associated with any subnet. Unused ACLs can be a result of network restructuring or incomplete configuration. To verify, inspect each ACL and its associated resources in the OCI console. Remediation involves reviewing the purpose of the ACL and either deleting it if it's unnecessary or associating it with the appropriate subnet if required.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networkACLs.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_platform
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.virtual_network.vcn.security_list_rdp_port_3389_ingress_restricted
  service: virtual_network
  resource: vcn
  requirement: Security List Rdp Port 3389 Ingress Restricted
  scope: virtual_network.vcn.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Restrict Ingress on RDP Port 3389 in OCI Security Lists
  rationale: Opening RDP port 3389 to the internet can expose systems to unauthorized access and brute force attacks, risking data breaches and operational disruption. Restricting this port is critical for safeguarding sensitive information, maintaining operational integrity, and complying with regulations such as PCI-DSS and ISO 27001 that mandate strict access controls.
  description: This rule checks if the Security List within an OCI VCN has unrestricted ingress rules on RDP port 3389. To verify, review the ingress rules in the security lists and ensure that RDP access is limited to specific, trusted IP addresses. Remediation involves updating the security list to restrict port 3389 access to known IP addresses or implementing a bastion host for secure access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/cloud/security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.virtual_network.vcn.subnet_no_public_ip_by_default
  service: virtual_network
  resource: vcn
  requirement: Subnet No Public Ip By Default
  scope: virtual_network.vcn.public_access
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: critical
  title: Ensure Subnets Do Not Assign Public IP by Default
  rationale: Allowing subnets to assign public IPs by default can expose resources to the internet unintentionally, increasing the risk of unauthorized access, data breaches, and compliance violations. Ensuring subnets do not have public IPs by default reduces the attack surface and aligns with best practices for network isolation and regulatory compliance such as PCI-DSS and NIST standards.
  description: This rule checks that subnets within a Virtual Cloud Network (VCN) in OCI are configured to not assign public IP addresses by default. To verify, inspect the subnet settings in the OCI console and ensure the 'Assign Public IP Address' option is disabled. Remediation involves modifying the subnet configuration to disable automatic public IP assignment, ensuring that only explicitly configured instances receive public IPs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingVCNs.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v4/
- rule_id: oci.virtual_network.vcn.subnet_separate_private_public
  service: virtual_network
  resource: vcn
  requirement: Subnet Separate Private Public
  scope: virtual_network.vcn.public_access
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: critical
  title: Ensure Separate Subnets for Private and Public OCI Resources
  rationale: Segregating private and public resources into separate subnets is essential to minimize the attack surface and control data flow within the Virtual Cloud Network (VCN). This practice reduces the risk of unauthorized access to private resources, mitigates lateral movement during a security breach, and aligns with security compliance frameworks that require network isolation.
  description: This rule checks if virtual network subnets are properly segmented into distinct private and public subnets within an Oracle Cloud Infrastructure (OCI) Virtual Cloud Network (VCN). A private subnet should not have any internet gateway association, while a public subnet should. To verify, check the subnet's route table and security list configurations. Remediation involves adjusting subnet configurations to ensure that private resources are isolated from direct internet exposure, usually through NAT gateway or service gateway for necessary external communications.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingVCNs.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1_1.htm#1.1
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networksecurity.htm
- rule_id: oci.compute.volume_attachment.ensure_attached_disks_encrypted_with_cmk
  service: compute
  resource: volume_attachment
  requirement: Ensure Attached Disks Encrypted With CMK
  scope: compute.volume_attachment.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Attached Disks Use Customer-Managed Keys for Encryption
  rationale: Encrypting attached disks with Customer-Managed Keys (CMKs) enhances data security by giving organizations control over encryption keys, reducing the risk of unauthorized access and meeting compliance requirements for data protection. This practice mitigates threats such as data breaches and unauthorized data access by ensuring that only authorized personnel can manage key lifecycle operations.
  description: This rule verifies that all attached disks in OCI compute instances are encrypted using Customer-Managed Keys (CMKs) instead of Oracle-managed keys. To achieve this, ensure that each block volume is configured to use a CMK from OCI Vault. Users should verify encryption settings through the OCI Console or API and switch to a CMK by updating the volume's settings if necessary. Remediation involves selecting an existing CMK or creating a new one in OCI Vault, then attaching it to the disk for encryption.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/encryptingvolume.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-security/key-management/
- rule_id: oci.compute.volume_attachment.ensure_unattached_disks_encrypted_with_cmk
  service: compute
  resource: volume_attachment
  requirement: Ensure Unattached Disks Encrypted With CMK
  scope: compute.volume_attachment.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Unattached Disks Use CMK Encryption in OCI
  rationale: Encrypting unattached disks with a Customer-Managed Key (CMK) enhances data protection by allowing organizations to maintain control over encryption keys, reducing the risk of unauthorized access. This practice is critical for meeting compliance requirements such as PCI-DSS and HIPAA, and protecting sensitive data from potential breaches, especially when disks are not in active use and may be overlooked.
  description: This rule checks that all unattached block volumes in Oracle Cloud Infrastructure are encrypted using a Customer-Managed Key (CMK). Users should verify that the encryption status of unattached disks is set to use a CMK rather than the default Oracle-managed keys. Remediation involves updating the encryption settings of unattached volumes to utilize a CMK, which can be done via the OCI Console or CLI, ensuring data is protected under your control.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/managingvolumes.htm#encrypting
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://www.pcisecuritystandards.org
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.waf.web_app_firewall.global_webacl_logging_enabled
  service: waf
  resource: web_app_firewall
  requirement: Global Webacl Logging Enabled
  scope: waf.web_app_firewall.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Global WebACL Logging is Enabled for OCI WAF
  rationale: Enabling logging on OCI Web Application Firewall (WAF) facilitates incident response, forensic investigations, and compliance with regulatory requirements such as GDPR and PCI-DSS by providing visibility into web traffic and potential threats. Without logging, organizations may lack critical insights into security events, increasing the risk of undetected attacks and non-compliance with data protection laws.
  description: This rule checks that logging is enabled for all Global Web Application Firewall (WebACL) configurations in OCI. Enabling WebACL logging ensures that all traffic and rule evaluations are recorded, allowing for detailed analysis of web traffic patterns and potential security incidents. To verify, navigate to the OCI WAF console, select the WebACL, and ensure logging is turned on. If not enabled, configure a logging policy to capture logs in an OCI Object Storage bucket for centralized access and review.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/waflogging.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.waf.web_app_firewall.webacl_logging_enabled
  service: waf
  resource: web_app_firewall
  requirement: Webacl Logging Enabled
  scope: waf.web_app_firewall.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure WAF WebACL Logging is Enabled
  rationale: Enabling logging for Web Application Firewall (WAF) WebACLs is crucial for capturing access patterns, detecting malicious activities, and maintaining an audit trail for forensic analysis. Without logging, organizations may face challenges in identifying and mitigating threats, leading to potential data breaches and non-compliance with regulatory requirements such as PCI-DSS and GDPR.
  description: This rule checks whether logging is enabled for Oracle Cloud Infrastructure's Web Application Firewall (WAF) WebACLs. It ensures that security events are captured and stored for review. To verify, navigate to the OCI Console, access the WAF service, and check the logging configuration for each WebACL. If logging is not enabled, configure it by selecting a target log group to store the logs. This facilitates ongoing security monitoring and aligns with best practices for logging and monitoring.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/waflogging.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/securitylogging.htm
  - https://cloud.oracle.com/security
- rule_id: oci.waf.web_app_firewall.webacl_rule_logging_enabled
  service: waf
  resource: web_app_firewall
  requirement: Webacl Rule Logging Enabled
  scope: waf.web_app_firewall.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Logging for Web Application Firewall Rules
  rationale: Enabling logging for Web Application Firewall (WAF) rules is crucial for monitoring and analyzing incoming web traffic, which helps in identifying malicious activities and ensuring the security of web applications. It aids in forensic investigations and can be essential for meeting regulatory compliance requirements such as PCI-DSS and GDPR by providing detailed access and modification records.
  description: This check verifies if logging is enabled for WAF rules within an OCI Web Application Firewall. Proper configuration involves setting up the logging feature in the OCI console to capture and store detailed access logs of traffic processed by WAF rules. To remediate, navigate to the OCI Web Application Firewall settings and ensure the logging option is activated, specifying the correct log group and compartment for log storage. Regularly review the logs to detect and respond to security incidents promptly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/WAF/Tasks/enablinglogging.htm
  - https://docs.cisecurity.org/benchmarks.html
  - https://www.pcisecuritystandards.org/document_library
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://www.oracle.com/security/cloud-compliance/
- rule_id: oci.cloud_guard.target.enabled_without_findings
  service: cloud_guard
  resource: target
  requirement: Enabled Without Findings
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Cloud Guard Targets Have Active Findings
  rationale: Having Cloud Guard targets enabled without active findings may indicate misconfiguration or lack of coverage in your security monitoring setup, leading to undetected threats and vulnerabilities. This could result in compliance violations with frameworks like NIST or ISO 27001, and expose the organization to potential security breaches or data loss.
  description: This rule verifies if Cloud Guard targets are enabled but have no active findings. Such a state can suggest that the security monitoring configuration is inadequate, or that logging and alerting mechanisms are improperly set. To remediate, ensure that the target is correctly configured to monitor all relevant resources and that logging is enabled. Regularly review and update policies and rules to reflect the current threat landscape.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/home.htm
  - https://registry.terraform.io/providers/oracle/oci/latest/docs/resources/cloud_guard_target
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Concepts/cloudguardoverview.htm
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.maintain_current_contact_details
  service: identity
  resource: user
  requirement: Maintain Current Contact Details
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Users Maintain Updated Contact Information
  rationale: Accurate user contact details are crucial for incident response and account recovery processes, as they enable timely communication and verification. Outdated information can lead to unauthorized access and delays in addressing security incidents, increasing the risk of data breaches and non-compliance with regulatory requirements such as GDPR and HIPAA.
  description: This rule checks if users have up-to-date contact details in their OCI identity profiles. Users must regularly update their email addresses and phone numbers to ensure they receive critical notifications and alerts. Administrators should enforce policies that prompt users to verify their contact information periodically. Remediation involves instructing users to log into the OCI Console and update their profile details under 'User Settings'.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.identity.user.maintain_different_contact_details_to_security_operations
  service: identity
  resource: user
  requirement: Maintain Different Contact Details To Security Operations
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Unique User Contact Details for Security Operations
  rationale: Maintaining distinct contact details for users and security operations minimizes the risk of unauthorized access and ensures clear communication channels. It reduces the potential for social engineering attacks targeting users and enhances incident response effectiveness by delineating operational and security communication. This practice is crucial for compliance with data protection regulations that mandate clear separation of duties.
  description: This rule checks if users have distinct contact details separate from those used for security operations to prevent overlap. Verify by inspecting user profiles in the OCI Console to ensure contact information such as email and phone numbers differ from those listed in security operations contacts. Remediation involves updating user contact information in the OCI Identity Console, ensuring it does not overlap with security operations contacts, thus maintaining clear and separate communication channels.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-iec-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.identity.user.security_contact_information_is_registered
  service: identity
  resource: user
  requirement: Security Contact Information Is Registered
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure User Security Contact Information is Registered
  rationale: Registering security contact information for OCI users is crucial for timely communication during security incidents, reducing the response time and minimizing potential damage. It helps maintain compliance with regulations such as PCI-DSS and ISO 27001, which require prompt incident reporting. Without this information, organizations risk not being able to address security breaches efficiently, potentially leading to data loss and reputational damage.
  description: This rule verifies that each OCI user account has registered security contact information, such as an email address or phone number, within the identity settings. To check compliance, navigate to the OCI console, select 'Identity', then 'Users', and ensure each user has contact information listed under their profile. Remediation involves updating user profiles to include valid and monitored contact details, ensuring they are reachable in case of security alerts or incidents.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - CIS OCI Benchmark
  - https://www.pcisecuritystandards.org
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.oracle.com/cloud/security/
- rule_id: oci.ai_language.project.service_public_access_blocked
  service: ai_language
  resource: project
  requirement: Service Public Access Blocked
  scope: ai_language.project.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Block Public Access to AI Language Projects
  rationale: Blocking public access to AI Language projects in OCI is crucial to prevent unauthorized access, data leakage, and potential misuse of sensitive data. Public exposure of AI projects can lead to compliance violations, including breaches of data protection laws such as GDPR and CCPA. Ensuring projects are not publicly accessible safeguards intellectual property and maintains customer trust.
  description: This rule checks that AI Language projects are configured to block public access by ensuring that no public endpoints are exposed. Administrators should verify project settings in the OCI Console to ensure public access is disabled. Remediation involves configuring network security groups and policy settings to restrict access to authorized users only, employing OCI Identity and Access Management (IAM) for precise access control.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/AI/Language/home.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.container_engine.cluster.network_policy_enabled
  service: container_engine
  resource: cluster
  requirement: Network Policy Enabled
  scope: container_engine.cluster.network_security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: medium
  title: Enable Network Policies for OCI Kubernetes Clusters
  rationale: Enabling network policies in OCI Kubernetes clusters helps isolate and secure workloads by controlling the traffic flow between pods. This reduces the risk of lateral movement by attackers within the cluster, ensuring compliance with security standards such as PCI-DSS and SOC2. It is crucial for protecting sensitive data and maintaining business continuity in case of a breach.
  description: This rule checks if network policies are enabled for OCI Kubernetes clusters, a critical component in securing the communication within the cluster. Network policies allow you to define rules that control traffic to and from pods. To verify, ensure that your cluster's network policy feature is enabled and configured correctly. Remediation involves accessing the OCI Console, navigating to the Container Engine for Kubernetes, and enabling network policies under the cluster settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengsettingupcluster.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://cloud.google.com/kubernetes-engine/docs/how-to/network-policy
  - https://www.iso.org/standard/54534.html
- rule_id: oci.apigateway.gateway.gateway_authorization_enabled
  service: apigateway
  resource: gateway
  requirement: Gateway Authorization Enabled
  scope: apigateway.gateway.authorization
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure API Gateway Authorization is Enabled
  rationale: Enabling authorization on API Gateways is crucial to prevent unauthorized access to APIs, which could lead to data breaches or misuse of cloud resources. Without proper authorization, attackers may exploit public APIs to exfiltrate sensitive data or perform malicious actions, leading to potential regulatory non-compliance and reputational damage.
  description: This rule checks that authorization is enabled for API Gateways in OCI. Proper configuration requires setting up authentication mechanisms such as OAuth tokens or API keys to control access to APIs. Verification can be done through the OCI Console by reviewing the 'Authentication' settings under each API Gateway. To remediate, ensure that API Gateways are configured with appropriate authorization policies that align with the organizational access control policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusing.htm#apigatewayusing
  - CIS Oracle Cloud Infrastructure Foundations Benchmark
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud.html
- rule_id: oci.apigateway.gateway.gateway_client_certificate_enabled
  service: apigateway
  resource: gateway
  requirement: Gateway Client Certificate Enabled
  scope: apigateway.gateway.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable Client Certificate on API Gateway
  rationale: Enabling client certificates for API Gateway ensures that only authenticated clients can access APIs, reducing the risk of unauthorized access and data breaches. This is crucial for maintaining confidentiality and integrity of sensitive data, meeting compliance requirements such as PCI-DSS and HIPAA, and mitigating threats like man-in-the-middle attacks.
  description: This rule checks if client certificate validation is enabled for API Gateway endpoints, which adds an additional layer of security by requiring clients to present a valid certificate before accessing the API. To enable this feature, configure the gateway to require a client certificate in the API Gateway settings. Verification can be done via the OCI Console under the 'Gateways' section by ensuring the 'Client Certificate Enabled' option is turned on. Remediation involves updating gateway configurations to enforce client certificate checks.
  references:
  - https://docs.oracle.com/en-us/iaas/api-gateway/using/api-gateway-managing.html#enabling-client-certificates
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/cloud/whitepapers/best-practices-for-securing-oci.pdf
  - https://www.nist.gov/publications/nist-special-publication-800-53-revision-5
- rule_id: oci.apigateway.gateway.gateway_restapi_client_certificate_enabled
  service: apigateway
  resource: gateway
  requirement: Gateway Restapi Client Certificate Enabled
  scope: apigateway.gateway.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: API Gateway Client Certificate Requirement for REST APIs
  rationale: Enabling client certificates for API Gateway enhances the security by ensuring only authenticated clients can access the APIs, reducing the risk of unauthorized data access and potential data breaches. This practice aligns with data protection regulations like GDPR and PCI-DSS, helping to mitigate the risk of non-compliance and potential financial penalties.
  description: This rule verifies that client certificates are enabled for Oracle Cloud Infrastructure API Gateway REST APIs, ensuring mutual TLS authentication. To comply, configure the API Gateway to require client certificates by using the OCI Console or API, and upload trusted CA certificates. This enhances security by verifying the client's identity before granting access. Regularly review and update the certificates and trust store to maintain security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Tasks/apigatewayusingclientcertificates.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.apigateway.gateway.restapi_cache_encrypted
  service: apigateway
  resource: gateway
  requirement: Restapi Cache Encrypted
  scope: apigateway.gateway.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure REST API Cache is Encrypted in API Gateway
  rationale: Encrypting the REST API cache protects sensitive data from unauthorized access and potential data breaches. It mitigates the risk of data exposure in case of a compromised system and ensures compliance with data protection regulations like PCI-DSS and HIPAA, which require encryption of sensitive data at rest.
  description: This check verifies that the cache used by the REST API in the API Gateway is encrypted. Encryption at rest should be enabled by configuring the API Gateway to use Oracle's Key Management service, which allows you to manage encryption keys effectively. To remediate, navigate to the API Gateway configuration in the OCI Console, enable the cache encryption option, and select a key managed by the Oracle Key Management service.
  references:
  - https://docs.oracle.com/en-us/iaas/api-gateway/api-gateway-overview.html#GUID-7E6B0F7E-8E6A-4A9A-A8F4-72E5F4F3D3D5
  - https://www.oracle.com/security/cloud-security/key-management/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss_v3-2-1#pci_dss_v3-2-1
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.hhs.gov/sites/default/files/ocr/privacy/hipaa/administrative/securityrule/securityrulepdf.pdf
- rule_id: oci.apigateway.gateway.restapi_public
  service: apigateway
  resource: gateway
  requirement: Restapi Public
  scope: apigateway.gateway.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure REST API Gateways are Not Publicly Accessible
  rationale: Publicly accessible REST APIs on OCI API Gateway can be exploited by unauthorized users, leading to data breaches, service disruption, and non-compliance with standards like PCI-DSS and GDPR. Restricting access reduces attack surface and enforces proper access control, thus protecting sensitive data and maintaining trust.
  description: This check ensures that OCI API Gateway REST APIs are not publicly accessible. It reviews the gateway configuration to verify that access is limited to specific IP addresses or VCNs. To remediate, configure access control policies and use VCNs to restrict access to trusted networks. Verify by reviewing the gateway's access policies and ensuring the integration with OCI Identity and Access Management (IAM) for secure authentication and authorization.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/APIGateway/Concepts/apigatewayoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/identityaccessmanagement.htm
  - https://www.oracle.com/security/cloud-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.api_restrictions_configured
  service: identity
  resource: user
  requirement: API Restrictions Configured
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure API Restrictions are Configured for OCI Users
  rationale: Configuring API restrictions for users in Oracle Cloud Infrastructure is essential to limit access to only necessary APIs, reducing the attack surface and mitigating unauthorized actions that could lead to data breaches or service disruptions. This practice helps align with compliance requirements by ensuring that only approved, secure connections are used, thus protecting sensitive data and maintaining the integrity of cloud operations.
  description: This check verifies that API restrictions are configured for users in the Oracle Cloud Infrastructure. API restrictions should be implemented to allow only specific API operations and endpoints that a user requires to perform their job functions. This can be verified by reviewing the user's policy statements and ensuring they include conditions that limit API actions and IP address ranges. To remediate, define and apply policies with explicit allow lists for API actions and restrict network access using appropriate CIDR blocks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/Projects/risk-management
  - https://www.pcisecuritystandards.org/pci_security
- rule_id: oci.identity.api_key.key_rotated_in_90_days
  service: identity
  resource: api_key
  requirement: Key Rotated In 90 Days
  scope: identity.api_key.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure API Key Rotation Within 90 Days
  rationale: Regular rotation of API keys reduces the risk of unauthorized access by minimizing the window of opportunity for compromised keys to be exploited. This practice aligns with security best practices and compliance requirements, such as PCI-DSS and NIST, by ensuring that stale or potentially compromised credentials do not persist in the environment.
  description: This check verifies that API keys in Oracle Cloud Infrastructure are rotated at least every 90 days. Regular rotation is crucial to mitigate the risk of unauthorized access should a key become compromised. To verify, audit API key creation and last rotation dates in the OCI Console under Identity and Access Management. If a key is older than 90 days, it should be rotated immediately. Use the OCI CLI or Console to update and manage API keys efficiently.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/apisigningkey.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-63b.pdf
  - https://www.oracle.com/cloud/security/
  - https://cloudsecurityalliance.org/artifacts/cloud-controls-matrix-v4/
- rule_id: oci.functions.application.function_access_keys_configured
  service: functions
  resource: application
  requirement: Function Access Keys Configured
  scope: functions.application.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Function Access Keys Are Securely Configured
  rationale: Improper configuration of function access keys in OCI can lead to unauthorized access to critical serverless applications, exposing sensitive data and potentially leading to security breaches. By ensuring that access keys are securely configured, organizations can mitigate the risk of credential theft, meet compliance requirements like PCI-DSS and ISO 27001, and protect their business assets from malicious actors.
  description: This rule checks whether all access keys associated with Oracle Cloud Infrastructure functions are configured with strong security settings. It verifies that keys are regularly rotated, have appropriate permissions, and are stored securely. Remediation involves reviewing and updating access keys to meet these security standards, including implementing key rotation policies and using OCI's Vault service for secure storage. Administrators should audit key usage and permissions to ensure they align with the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionsaccesscontrol.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/cloud/security/vault/
  - https://www.oracle.com/security/cloud-compliance/
- rule_id: oci.compute.instance.fleet_default_internet_access_disabled
  service: compute
  resource: instance
  requirement: Fleet Default Internet Access Disabled
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Disable Default Internet Access for Compute Instance Fleets
  rationale: Disabling default internet access for compute instance fleets reduces exposure to external threats, mitigating the risk of unauthorized access and data breaches. This control aligns with the principle of least privilege, ensuring that only necessary instances have internet connectivity, thereby supporting compliance with security frameworks like NIST and ISO 27001.
  description: This rule checks if the default internet access is disabled for compute instance fleets. By default, instances should not have direct internet access to prevent potential attack vectors. Verify this setting by reviewing the instance configuration in the OCI Console or using the OCI CLI. Remediation involves configuring a private subnet without internet gateway access or applying specific security lists and route tables that block outbound traffic.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-iec-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.audit.configuration.cloudwatch_logs_enabled
  service: audit
  resource: configuration
  requirement: Cloudwatch Logs Enabled
  scope: audit.configuration.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure OCI Audit Logs are Integrated with Cloudwatch
  rationale: Enabling Cloudwatch Logs for OCI audit logs is crucial for centralized log management, facilitating the detection of unauthorized activities and compliance with regulations such as PCI-DSS and ISO 27001. This integration helps in early detection of potential security incidents by providing real-time monitoring and alerts, thus reducing the risk of data breaches and ensuring accountability.
  description: This rule checks whether OCI audit logs are properly configured to be sent to Cloudwatch Logs. This involves verifying the setup of log groups and associated log streams in Cloudwatch to receive and store audit logs generated by OCI. To remediate, configure the audit service to export logs to Cloudwatch by setting up proper IAM roles and policies that allow OCI to publish logs. This ensures that all API calls and changes in the OCI environment are logged and monitored for unauthorized activities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - 'CIS OCI Benchmark: Section on Audit Logging'
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/standard/54534.html
  - 'NIST SP 800-92: Guide to Computer Security Log Management'
  - https://blogs.oracle.com/cloudsecurity/post/logging-best-practices-in-oci
- rule_id: oci.audit.configuration.multi_region_enabled_logging_management_events
  service: audit
  resource: configuration
  requirement: Multi Region Enabled Logging Management Events
  scope: audit.configuration.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Multi-Region Logging for Audit Management Events
  rationale: Enabling multi-region logging for audit management events enhances the visibility and traceability of actions across regions, crucial for detecting unauthorized access and ensuring data integrity. This configuration helps mitigate risks associated with data breaches and supports compliance with regulatory standards such as GDPR and ISO 27001, which require comprehensive logging and monitoring of security-related events.
  description: This rule checks whether audit logging is enabled for management events across multiple regions in OCI. To verify, ensure that all regions have audit logs enabled for management events by navigating to the 'Audit' section in the OCI console and confirming the logging configuration for each region. Remediation involves configuring the audit service to log management events in each region, ensuring that logs are captured and retained according to your organization's regulatory and operational requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://www.oracle.com/security/cloud-security/identity-management/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/cloud/cloud-security/
- rule_id: oci.database.autonomous_database.dw_cluster_audit_logging
  service: database
  resource: autonomous_database
  requirement: Dw Cluster Audit Logging
  scope: database.autonomous_database.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Audit Logging for Autonomous DW Clusters
  rationale: Audit logging in Autonomous Data Warehouse (ADW) clusters is crucial for monitoring database activities, detecting unauthorized access, and ensuring compliance with standards such as PCI-DSS and GDPR. Without audit logs, it is challenging to trace data breaches or suspicious activities, posing a significant risk to sensitive data integrity and confidentiality.
  description: This rule checks if audit logging is enabled for Oracle Autonomous Data Warehouse clusters. Audit logs must be configured to capture database activity, including user logins and data modifications. To verify, ensure that the 'Unified Auditing' feature is activated in the ADW cluster settings. Remediation involves enabling audit policies for critical actions and exporting logs to OCI Logging for centralized monitoring and alerts.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/security/cloud-security/whitepapers/best-practices/
- rule_id: oci.database.db_system.dw_cluster_automated_snapshot
  service: database
  resource: db_system
  requirement: Dw Cluster Automated Snapshot
  scope: database.db_system.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Enable Automated Snapshots for DW Clusters
  rationale: Automated snapshots for DW clusters enhance data protection by ensuring regular backups, reducing the risk of data loss due to unforeseen incidents. This practice supports business continuity, minimizes downtime, and meets compliance requirements for data integrity and availability, especially in regulated environments.
  description: This rule checks if automated snapshots are enabled for Oracle Cloud Infrastructure DW clusters. To verify, ensure that the DB system configuration includes scheduled backups. Remediate by navigating to the DW cluster settings in the OCI Console and enabling automated backups under the backup management section. This ensures that snapshots are regularly created and retained according to the defined policy.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/backingupOSrman.htm
  - 'CIS OCI Benchmark: Section 4.1 - Ensure Automated Backups are Enabled'
  - 'NIST SP 800-53: CP-9 - Contingency Planning'
  - 'PCI-DSS v3.2.1: Requirement 9.5 - Physical Security'
  - 'HIPAA Security Rule: 164.308(a)(7)(ii)(B) - Data Backup and Storage'
  - ISO/IEC 27001:2013 - A.12.3.1 - Information backup
- rule_id: oci.database.db_system.dw_cluster_automatic_upgrades
  service: database
  resource: db_system
  requirement: Dw Cluster Automatic Upgrades
  scope: database.db_system.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Warehouse Cluster Automatic Upgrades Enabled
  rationale: Enabling automatic upgrades for Data Warehouse Clusters in OCI ensures that the latest security patches and performance enhancements are applied without manual intervention. This reduces the risk of exploitation of known vulnerabilities, helps maintain the integrity of sensitive data, and supports compliance with regulatory standards such as PCI-DSS and HIPAA, which require timely application of security updates.
  description: This rule checks if the Automatic Upgrades feature is enabled for Data Warehouse Clusters in Oracle Cloud Infrastructure's db_system. To verify, navigate to the Database service console, select the specific db_system, and review the upgrade settings in the configuration section. If disabled, enable automatic upgrades by setting the 'Auto Upgrade' option to 'Enabled'. This ensures continuous protection against vulnerabilities and leverages the latest improvements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/upgrading.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- rule_id: oci.database.db_system.dw_cluster_encrypted
  service: database
  resource: db_system
  requirement: Dw Cluster Encrypted
  scope: database.db_system.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Warehouse Clusters are Encrypted at Rest
  rationale: Encrypting data warehouse clusters at rest is crucial for protecting sensitive information from unauthorized access and potential data breaches. This practice mitigates the risk of data exposure in scenarios such as physical theft of storage devices, unauthorized access to underlying infrastructure, and compliance with legal and regulatory standards like GDPR and CCPA. Failing to encrypt can result in legal penalties, financial loss, and damage to organizational reputation.
  description: This rule checks whether the Data Warehouse (DW) clusters within Oracle Cloud Infrastructure's database systems are configured to use encryption at rest. Encryption at rest protects data using encryption keys, ensuring that stored data is unreadable without proper authorization. To verify, ensure that the 'DbSystemOptions' parameter is set to 'ENCRYPTED'. Remediation involves enabling encryption by configuring the database system with the appropriate encryption settings during its creation or modifying existing systems to include encryption using OCI's management console or API.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/overview.htm#security
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/cloud/security/compliance/
  - https://www.oracle.com/security/cloud-security/cybersecurity/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security-overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_controls.htm
- rule_id: oci.database.db_system.dw_cluster_maintenance_settings
  service: database
  resource: db_system
  requirement: Dw Cluster Maintenance Settings
  scope: database.db_system.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Database System Dw Cluster Maintenance Encryption Settings
  rationale: Proper maintenance settings for Dw Clusters in OCI Database Systems ensure that data remains encrypted at rest during maintenance operations. This reduces the risk of unauthorized data exposure and ensures compliance with regulatory frameworks that mandate data protection, such as PCI-DSS and HIPAA. Misconfigurations can lead to potential data breaches and financial penalties.
  description: This rule checks that the Dw Cluster Maintenance Settings for OCI Database Systems are configured to use encryption at rest. Verify that all database systems have encryption enabled during maintenance to protect sensitive data. Remediation involves enabling encryption settings within the OCI Console under the Database System's maintenance settings, ensuring that encryption keys are properly managed and rotated regularly.
  references:
  - https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/security-guide.html
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/managingDBSystem.htm
  - https://www.oracle.com/security-cloud/
- rule_id: oci.database.autonomous_database.dw_cluster_public_access
  service: database
  resource: autonomous_database
  requirement: Dw Cluster Public Access
  scope: database.autonomous_database.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Public Access to Autonomous Data Warehouse Clusters
  rationale: Public access to Autonomous Data Warehouse (ADW) clusters can expose sensitive data to unauthorized users, increasing the risk of data breaches. This access may violate compliance requirements such as PCI-DSS and HIPAA, which mandate restricted access to sensitive data. Limiting access to private networks minimizes the attack surface and helps ensure that only authorized personnel have access to critical data resources.
  description: This rule checks if any Autonomous Data Warehouse clusters are accessible over the public internet, which could lead to unauthorized data exposure. Ensure that ADW clusters are configured with private endpoints or are otherwise restricted using network security groups or security lists. To verify, review the network configuration of the ADW instances in the OCI console and ensure no public IP addresses are assigned. Remediation involves configuring the ADW with a Virtual Cloud Network (VCN) and appropriate private subnet settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adwhow.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/index.html
  - https://www.oracle.com/security/cloud-security/cloud-security-best-practices.html
- rule_id: oci.compute.instance.group_capacity_rebalance_enabled
  service: compute
  resource: instance
  requirement: Group Capacity Rebalance Enabled
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Enable Group Capacity Rebalance for Compute Instances
  rationale: Enabling group capacity rebalance for compute instances in OCI ensures more predictable and stable application performance by redistributing workloads during planned maintenance or unexpected server failures. This reduces the risk of resource contention and service disruptions, which is critical for maintaining business continuity and meeting service level agreements. Additionally, it can aid in compliance with uptime and availability standards specified in various regulatory frameworks.
  description: This rule checks whether the 'Group Capacity Rebalance' feature is enabled for compute instances in Oracle Cloud Infrastructure. This setting helps in automatically redistributing instances across available resources to maintain the desired capacity and performance levels. To verify, navigate to the Compute Instance settings and ensure the 'Group Capacity Rebalance' option is active. If not enabled, consider adjusting the instance configuration settings to activate this feature, which can be done via the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/rebalancingcapacity.htm
  - https://www.oracle.com/cloud/security/cis-oci-benchmark/
  - https://www.nist.gov/document-2561
  - https://www.pcisecuritystandards.org/document_library
  - https://www.oracle.com/security/cloud-security/best-practices/
- rule_id: oci.compute.instance_pool.group_multiple_az
  service: compute
  resource: instance_pool
  requirement: Group Multiple Az
  scope: compute.instance_pool.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Instance Pools Span Multiple Availability Domains
  rationale: Distributing instance pools across multiple availability domains enhances fault tolerance and minimizes downtime risks due to outages in a single domain. This practice supports business continuity and resilience, reducing the potential financial and reputational impacts of service disruptions. It also aligns with compliance requirements for high availability and disaster recovery as outlined in various frameworks.
  description: This rule checks if instance pools within your OCI environment are configured to utilize multiple availability domains. To verify, ensure that your instance pool configuration specifies more than one availability domain. Remediation involves updating the instance pool to distribute instances across at least two availability domains, leveraging OCI's regional resources for improved reliability and workload resilience.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/creatinginstancepools.htm
  - https://docs.oracle.com/en-us/iaas/Content/DocumentLibrary/Reference/CIS_OCI_Benchmark_v1.1.0.pdf
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.functions.application.function_inside_vcn
  service: functions
  resource: application
  requirement: Function Inside Vcn
  scope: functions.application.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Functions Run Within a VCN for Enhanced Security
  rationale: Running functions within a Virtual Cloud Network (VCN) in OCI enhances security by isolating the function from public internet access, reducing exposure to external threats. This setup helps protect sensitive data processed by the function and supports compliance with data protection regulations such as GDPR and HIPAA by controlling ingress and egress traffic.
  description: This rule checks if Oracle Cloud Infrastructure (OCI) functions are deployed within a Virtual Cloud Network (VCN). Functions should be configured to operate within a VCN to leverage network security controls, such as security lists and network security groups (NSGs), to regulate traffic. To verify, review the function's network configuration in the OCI console and ensure it is associated with a VCN. Remediation involves updating the function's configuration to attach it to the appropriate VCN, thereby enforcing network-level protection.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionscreating.htm
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.functions.application.function_invoke_api_operations_audit_logging_enabled
  service: functions
  resource: application
  requirement: Function Invoke API Operations Audit Logging Enabled
  scope: functions.application.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Audit Logging for OCI Functions API Invocations
  rationale: Enabling audit logging for Function Invoke API operations in Oracle Cloud Infrastructure (OCI) is crucial for tracking access and changes to your functions. This practice helps identify unauthorized access, supports forensic analysis, and complies with regulatory requirements such as PCI-DSS and SOC2, thereby protecting sensitive data and maintaining system integrity.
  description: This rule checks if audit logging is enabled for OCI Functions API invocations. Audit logs should record all access and activity related to function invocations to ensure accountability and traceability. Verify that logging is configured in the OCI Logging service for the functions application. Remediate by navigating to the OCI Logging service, creating a new log group, and setting up the appropriate logging policies to capture API activity. Ensure logs are retained according to your compliance needs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionslogging.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.pcisecuritystandards.org/
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/sorhome.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://cloudsecurityalliance.org/research/projects/cloud-controls-matrix/
- rule_id: oci.functions.application.function_url_cors_policy
  service: functions
  resource: application
  requirement: Function Url CORS Policy
  scope: functions.application.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Secure CORS for Function URLs in OCI Functions
  rationale: Cross-Origin Resource Sharing (CORS) policies are crucial for controlling which domains can interact with your functions, preventing unauthorized cross-origin requests that can lead to data leakage or unauthorized actions. A misconfigured CORS policy might expose your application to security risks such as Cross-Site Scripting (XSS) or Cross-Site Request Forgery (CSRF), which can compromise sensitive data and lead to compliance violations with standards like PCI-DSS and GDPR.
  description: This rule checks if CORS policies are correctly configured for function URLs in Oracle Cloud Infrastructure Functions. Ensure that only trusted domains are allowed, and methods like POST, GET, and DELETE are specified as needed. To verify, review the CORS settings in the OCI Console under the Functions' configuration for the application. Remediation involves updating the CORS policy to restrict access to known, trusted domains and limiting HTTP methods to those necessary for functionality.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionsconfiguringcors.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
  - https://cloudsecurityalliance.org/research/artifacts/oracle-cloud-security
- rule_id: oci.functions.application.function_vcn_multi_az
  service: functions
  resource: application
  requirement: Function Vcn Multi Az
  scope: functions.application.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Functions Are Deployed Across Multiple Availability Domains
  rationale: Deploying functions across multiple availability domains (ADs) in Oracle Cloud Infrastructure enhances availability and fault tolerance. This setup mitigates the risk of downtime due to AD-specific outages, ensuring business continuity and maintaining trust with stakeholders. It aligns with compliance requirements that mandate high availability and resilience, such as those in the ISO 27001 standard.
  description: This rule checks if OCI Functions are configured to use Virtual Cloud Networks (VCNs) that span multiple availability domains. To verify, inspect the function's application configuration in the OCI Console or via the CLI/API for multi-AD setup. Remediation involves adjusting the VCN setup to include subnets across different ADs, which can be done by updating networking settings and redeploying the function accordingly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Concepts/functionsoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionsmanaging.htm
  - https://www.oracle.com/cloud/security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.autonomous_database.plans_exist
  service: database
  resource: autonomous_database
  requirement: Plans Exist
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Encryption Plans Exist
  rationale: Having encryption plans in place for Autonomous Databases is crucial for protecting sensitive data at rest against unauthorized access and potential data breaches. This is especially important for compliance with regulations such as PCI-DSS and GDPR, which mandate stringent data protection measures. Without proper encryption strategies, organizations face risks of significant financial penalties and reputational damage.
  description: This rule checks whether encryption plans are defined and implemented for Autonomous Databases in Oracle Cloud Infrastructure. It verifies that data encryption at rest is enabled and configured according to best practices, ensuring that all sensitive data is encrypted using Oracle-managed keys or customer-managed keys. Administrators should regularly review and update encryption settings to align with evolving security requirements. Remediation involves enabling encryption for databases where it is not already applied and ensuring that encryption keys are securely managed.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security-cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.database.autonomous_database.reportplans_exist
  service: database
  resource: autonomous_database
  requirement: Reportplans Exist
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Report Plans Are Configured
  rationale: Enforcing report plans for Autonomous Databases in OCI is crucial for maintaining data protection and privacy. Without these plans, organizations risk non-compliance with data protection regulations like GDPR and CCPA, and may face potential data breaches due to unmonitored access and usage.
  description: This rule checks for the existence of report plans in Oracle Autonomous Databases. These plans are used to schedule and generate reports on database activities, helping to identify and mitigate unauthorized access and data leaks. To verify compliance, navigate to the OCI Console, locate the Autonomous Database instance, and ensure that report plans are configured and active. Remediate by creating report plans via the 'Reports' section in the Autonomous Database settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm#Access_and_Security
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.database.autonomous_database.vaults_encrypted
  service: database
  resource: autonomous_database
  requirement: Vaults Encrypted
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Databases Use Vault Encryption
  rationale: Encrypting Autonomous Databases with Oracle Vaults protects sensitive data from unauthorized access and potential breaches, aligning with data protection regulations such as GDPR and CCPA. Failure to encrypt data at rest can expose the organization to data theft, financial loss, and reputational damage. Utilizing Oracle Vaults enhances security by managing encryption keys separately from the data, reducing the risk of key compromise.
  description: This rule verifies that Autonomous Databases in OCI are encrypted using Oracle Cloud Infrastructure Vault service. To comply, ensure that the database is configured to use customer-managed keys stored in an OCI Vault. Check the 'Encryption' settings under 'Autonomous Database Details' in the OCI Console or use the OCI CLI to verify encryption status. If the database is not encrypted with Vault, enable this feature by associating the database with a Key in OCI Vault, enhancing encryption key management and security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adbencryption.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm#Using_Customer-Managed_Keys_with_OCI_Resources
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.autonomous_database.vaults_exist
  service: database
  resource: autonomous_database
  requirement: Vaults Exist
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Vaults Exist for Autonomous Database Encryption
  rationale: Using Oracle Cloud Infrastructure (OCI) Vaults for managing encryption keys in Autonomous Databases ensures that sensitive data is protected against unauthorized access. Without proper key management, there is a risk of data breaches which could lead to financial loss, reputational damage, and non-compliance with data protection regulations such as GDPR and CCPA.
  description: This rule checks that an OCI Vault is associated with your Autonomous Database for managing encryption keys. Autonomous Databases should leverage OCI Vault to store and control encryption keys separately from the data, enhancing security by enabling centralized key management and lifecycle control. To verify, ensure that the Autonomous Database is configured to use a customer-managed key from an OCI Vault. If not, create a new vault in the OCI console and associate it with the database, ensuring data encryption keys are under your control.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/autonomousdatabasemanagement.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/oci-best-practices/
- rule_id: oci.ai_language.project.model_invocation_logs_encryption_enabled
  service: ai_language
  resource: project
  requirement: Model Invocation Logs Encryption Enabled
  scope: ai_language.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable Encryption for AI Language Model Invocation Logs
  rationale: Encrypting model invocation logs in Oracle Cloud Infrastructure (OCI) is crucial to protect sensitive data from unauthorized access and potential breaches. Unencrypted logs can expose sensitive information, leading to data leakage, non-compliance with data protection regulations such as GDPR or CCPA, and reputational harm. Encryption strengthens data confidentiality and integrity, reducing the risk of exploitation in case of unauthorized access.
  description: This rule checks that encryption is enabled for AI Language model invocation logs within OCI projects. To ensure logs are encrypted at rest, verify that the OCI AI Language service is configured to use Oracle-managed or customer-managed keys for encryption. If encryption is not enabled, configure your AI Language project settings to activate encryption for log data. This can be done through the OCI Console by navigating to the AI Language service, selecting your project, and ensuring the encryption settings are applied.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/AI/Language/home.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.oracle.com/security/cloud-security/encryption/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.bds.bds_instance.data_cluster_master_nodes_no_public_ip
  service: bds
  resource: bds_instance
  requirement: Data Cluster Master Nodes No Public Ip
  scope: bds.bds_instance.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Public IP for BDS Data Cluster Master Nodes
  rationale: Exposing BDS Data Cluster Master Nodes to the public internet increases the risk of unauthorized access, data breaches, and potential exploitation by malicious actors. Public IPs can be targeted for attacks such as DDoS or unauthorized data exfiltration. Ensuring these nodes are not accessible publicly aligns with best practices for data security and compliance with regulations such as PCI-DSS and ISO 27001, which mandate restricted access to sensitive data environments.
  description: This rule checks that Oracle Big Data Service (BDS) Data Cluster Master Nodes are configured without public IP addresses. To verify compliance, ensure that the master nodes are only accessible through private IPs within a secure VCN (Virtual Cloud Network) and that no public IPs are assigned. Remediation involves reconfiguring the BDS instance to remove any public IPs from master nodes and ensuring access is routed through a bastion host or VPN. This reduces the attack surface and enhances the overall security posture of the deployment.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/bigdata/home.htm
  - https://www.oracle.com/security/cis-benchmarks.html
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.analytics.analytics_instance.dataset_public_access
  service: analytics
  resource: analytics_instance
  requirement: Dataset Public Access
  scope: analytics.analytics_instance.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure Analytics Instance Datasets Are Not Publicly Accessible
  rationale: Public access to datasets in OCI Analytics can expose sensitive business data and insights to unauthorized users, leading to data breaches and compliance violations. This exposure can have serious repercussions including financial loss, reputational damage, and non-compliance with regulatory frameworks such as GDPR and CCPA. Ensuring datasets are not publicly accessible reduces the risk of unauthorized data exposure and helps maintain the integrity of business operations.
  description: This rule checks if any datasets within an OCI Analytics instance are configured for public access, which can be misused by unauthorized parties. Verify that all datasets have restricted access to authorized users only, by reviewing and adjusting the dataset permissions in the OCI Console. To remediate, navigate to the analytics instance, review datasets' access settings, and ensure that public access is disabled. Consider using IAM policies to enforce restricted access based on the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticssecurity.htm
  - https://www.oracle.com/security/cloud-security/identity-and-access-management/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/cloud/security/compliance/
- rule_id: oci.certificates.certificate.certificate_expiration
  service: certificates
  resource: certificate
  requirement: Certificate Expiration
  scope: certificates.certificate.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Monitor and Manage OCI Certificate Expirations
  rationale: Timely renewal of certificates is critical to maintaining the confidentiality and integrity of data. Expired certificates can lead to service disruptions, security breaches, and non-compliance with regulatory standards such as PCI-DSS and HIPAA. Ensuring certificates are valid prevents unauthorized data access and protects customer trust.
  description: This rule checks for certificates approaching their expiration date within Oracle Cloud Infrastructure. Administrators should regularly review certificate validity and renew them before expiration to prevent service interruptions. Configuring alerts within OCI for upcoming expirations and automating renewals through OCI's API or CLI can enhance security posture. To verify, use the OCI Console to navigate to the Certificates service and check the expiration status of each certificate.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Certificates/Concepts/certificates.htm
  - https://docs.cisecurity.org/benchmarks/downloads/show-single/?file=oracle_cloud_foundation.benchmark.v1.0.0.pdf
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.identity.user.guard_centrally_managed
  service: identity
  resource: user
  requirement: Guard Centrally Managed
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Centralized Management of OCI User Accounts
  rationale: Centralized user management in OCI reduces security risks by providing consistent access control, minimizing the potential for unauthorized access, and ensuring compliance with regulatory frameworks that require tight control over user credentials. In decentralized environments, the risk of security breaches increases due to inconsistent policy application and difficulties in tracking user activities.
  description: This rule checks that user accounts in OCI are managed centrally by leveraging the Oracle Identity Cloud Service (IDCS) or other centralized identity providers. Centralized management ensures that all user authentication and authorization policies are uniformly applied, reducing the risk of misconfigurations. To verify, ensure that all user accounts are synchronized with your central identity provider. Remediation involves integrating OCI with IDCS or another SAML-compliant identity provider to manage user identities centrally.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.identity.user.guard_eks_audit_log_enabled
  service: identity
  resource: user
  requirement: Guard Eks Audit Log Enabled
  scope: identity.user.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure EKS Audit Logging is Enabled for Users
  rationale: Enabling audit logging for EKS activities is crucial for tracking user actions, detecting unauthorized activities, and supporting forensic investigations. It helps mitigate risks associated with unauthorized access and data breaches, ensuring compliance with regulatory frameworks such as PCI-DSS and GDPR, which mandate robust logging and monitoring of user activities.
  description: This rule verifies that audit logging is enabled for all users interacting with Oracle Kubernetes Engine (OKE) within OCI. To comply, ensure that the logging service is configured to capture and store audit logs for user activities, particularly those involving critical operations on Kubernetes clusters. Remediation involves enabling audit logs in the OCI Console under the 'Logging' service for the relevant OKE clusters and ensuring logs are retained according to compliance requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-1-1-0-benchmark.pdf
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud-native/container-engine-kubernetes/
- rule_id: oci.edge_services.distribution.distributions_field_level_encryption_enabled
  service: edge_services
  resource: distribution
  requirement: Distributions Field Level Encryption Enabled
  scope: edge_services.distribution.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable Field Level Encryption for Edge Distributions
  rationale: Field level encryption for edge distributions protects sensitive data from unauthorized access and data breaches during transit and at rest. This is crucial for maintaining customer trust, safeguarding intellectual property, and complying with data protection regulations such as GDPR and CCPA. Without encryption, sensitive data could be intercepted or exposed, leading to financial loss and reputational damage.
  description: This rule checks if field level encryption is enabled for Oracle Cloud Infrastructure edge distributions, ensuring that sensitive data is encrypted at rest and during transit. To verify, check the distribution settings in the OCI Console under Edge Services and ensure that field level encryption is configured and active. To remediate, navigate to the Edge Services section, select the distribution, and enable field level encryption by providing the necessary encryption keys and settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/EdgeServices/Tasks/distributionencryption.htm
  - https://www.oracle.com/security/cloud-security/cloud-security-controls/
  - NIST SP 800-53 Rev. 5
  - PCI-DSS v3.2.1 Requirement 3
  - ISO/IEC 27001:2013
  - https://cloudsecurityalliance.org/research/guidance/
- rule_id: oci.edge_services.distribution.distributions_multiple_origin_failover_configured
  service: edge_services
  resource: distribution
  requirement: Distributions Multiple Origin Failover Configured
  scope: edge_services.distribution.security
  domain: resilience_and_disaster_recovery
  subcategory: backup_configuration
  severity: low
  title: Configure Multiple Origin Failover for Distributions
  rationale: Configuring multiple origin failover for OCI edge distribution services enhances resilience by ensuring uninterrupted access to content even if the primary origin fails. This reduces downtime, maintains user experience, and mitigates potential revenue loss, aligning with business continuity and disaster recovery plans. It is particularly crucial for organizations under regulatory frameworks that mandate high availability and disaster recovery, such as PCI-DSS and ISO 27001.
  description: This rule checks if OCI edge services distributions are configured with multiple origin failover to ensure service availability during primary origin outages. Verify by accessing the OCI console, navigating to Edge Services, and reviewing the distribution's origin settings for failover configuration. To remediate, configure additional origins and enable failover by following the OCI documentation guidelines, ensuring that health checks are set up to detect origin failures promptly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/EdgeServices/Tasks/edgedistributionoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/EdgeServices/Tasks/configuringedgedistribution.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-34r1.pdf
- rule_id: oci.edge_services.distribution.distributions_origin_traffic_encrypted
  service: edge_services
  resource: distribution
  requirement: Distributions Origin Traffic Encrypted
  scope: edge_services.distribution.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Origin Traffic for Distributions is Encrypted
  rationale: Encrypting origin traffic for distributions helps prevent unauthorized access and data breaches during data transit. This is crucial for maintaining the confidentiality and integrity of sensitive information, complying with data protection regulations such as GDPR and CCPA, and mitigating risks associated with interception attacks.
  description: This rule checks whether the traffic from Oracle Cloud Infrastructure (OCI) edge distribution services to the origin is encrypted using HTTPS. To verify, ensure that SSL/TLS protocols are configured for all origin connections. Remediation involves updating the distribution settings to enforce HTTPS by selecting 'HTTPS Only' for the origin protocol policy, thus ensuring all data in transit is encrypted.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/EdgeServices/Tasks/creatingadistribution.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/cloud-infrastructure-compliance/
- rule_id: oci.mysql.db_system.instance_public_access
  service: mysql
  resource: db_system
  requirement: Instance Public Access
  scope: mysql.db_system.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Public Access to MySQL DB System Instances
  rationale: Allowing public access to MySQL DB System instances exposes sensitive data to unauthorized parties, increasing the risk of data breaches and regulatory non-compliance. Unauthorized access can lead to data manipulation, service disruption, and financial loss, especially for applications handling critical business operations. Regulatory frameworks like PCI-DSS and GDPR require stringent access controls to protect personal and financial data.
  description: This rule checks for MySQL DB System instances that are configured with public network access. Instances should be restricted to private networks or specific IP addresses to minimize exposure. To verify, review the network settings in the OCI Console, ensuring that public IP addresses are not assigned to MySQL instances. Remediation involves modifying the network configuration to use private subnets and configuring security lists or network security groups to allow access only from trusted sources.
  references:
  - https://docs.oracle.com/en-us/iaas/mysql-database/doc/network-access.html
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/security/cloud-security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.mysql.db_system.instance_public_ip
  service: mysql
  resource: db_system
  requirement: Instance Public Ip
  scope: mysql.db_system.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Public IP Exposure for MySQL DB Systems
  rationale: Exposing a MySQL DB System to the public internet without proper controls can result in unauthorized access, data breaches, and exploitation by attackers. It poses significant business risks including loss of sensitive data, compliance violations with standards like PCI-DSS and GDPR, and potential financial penalties. Critical systems should be accessed only through secure, private connections to mitigate these risks.
  description: This rule checks if MySQL DB Systems on OCI have a public IP address assigned, which can lead to potential security vulnerabilities if not managed correctly. Best practices suggest using private IPs and implementing network security groups to restrict access. Verification involves reviewing the OCI Console for public IP assignments on DB Systems and using VCN security lists or network security groups to enforce access controls. To remediate, ensure the MySQL DB System is within a private subnet and access is controlled via bastion hosts or OCI VPN/DRG services.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/mysql-database/doc/security-best-practices.html
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.oracle.com/security/cloud-security/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-123.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.mysql.db_system.instance_ssl_connections
  service: mysql
  resource: db_system
  requirement: Instance SSL Connections
  scope: mysql.db_system.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure MySQL DB System SSL Connections are Enabled
  rationale: Enabling SSL connections for MySQL DB Systems in OCI protects data in transit by encrypting the communication between clients and the database. This reduces the risk of data interception by unauthorized entities, fulfilling compliance requirements for data protection and privacy regulations such as PCI-DSS and ISO 27001. Failure to encrypt data in transit can lead to data breaches and significant financial and reputational damage.
  description: This rule verifies that SSL connections are enforced for MySQL DB Systems on Oracle Cloud Infrastructure. To ensure compliance, enable SSL by configuring the MySQL DB System to require SSL for all connections. Verification can be done by checking the 'require_secure_transport' parameter in the MySQL configuration. Remediation involves updating the MySQL configuration to enforce SSL connections and restarting the service to apply changes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/databasesecurity.htm#SSLConnections
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.0_benchmark.htm
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://dev.mysql.com/doc/refman/8.0/en/encrypted-connections.html
- rule_id: oci.audit.configuration.logs_object_storage_bucket_access_logging_enabled
  service: audit
  resource: configuration
  requirement: Logs Object Storage Bucket Access Logging Enabled
  scope: audit.configuration.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Object Storage Bucket Access Logging
  rationale: Enabling access logging for Object Storage buckets is crucial for tracking access patterns and identifying unauthorized access attempts, thereby mitigating data breaches. It aids in forensic investigations and ensures compliance with regulations like PCI-DSS and GDPR, which require comprehensive audit trails for data access.
  description: This rule checks whether access logging is enabled for Object Storage buckets in OCI, ensuring that crucial access events are recorded. To verify, navigate to the OCI Console, select your Object Storage bucket, and ensure logging is configured in the 'Logging' section. Remediation involves enabling bucket logging and setting a target log group to capture and store access logs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#logging
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.audit.configuration.logs_object_storage_bucket_is_public_access_blocked
  service: audit
  resource: configuration
  requirement: Logs Object Storage Bucket Is Public Access Blocked
  scope: audit.configuration.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: critical
  title: Ensure Object Storage Bucket Logs Have Public Access Blocked
  rationale: Allowing public access to logs stored in Object Storage buckets can lead to unauthorized data exposure, potentially revealing sensitive information such as system configurations, user activities, and security events. This can be exploited by malicious actors to compromise system integrity, violate privacy laws, and result in regulatory non-compliance with standards such as PCI-DSS and GDPR.
  description: This rule checks that Object Storage buckets designated for storing audit logs are configured to block public access. To verify, ensure that the bucket's 'Public Access' setting is disabled. Remediation involves using the OCI Console or CLI to review bucket policies and ensure that public access is restricted, implementing Oracle's best practices for data security by setting appropriate IAM policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#publicaccess
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-compliance/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- rule_id: oci.audit.configuration.object_storage_dataevents_read_enabled
  service: audit
  resource: configuration
  requirement: Object Storage Dataevents Read Enabled
  scope: audit.configuration.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable Audit of Object Storage Data Read Events
  rationale: Monitoring read access to Object Storage is crucial for detecting unauthorized access and ensuring data confidentiality. Without auditing, organizations may be unaware of potential data breaches, leading to non-compliance with regulations such as GDPR and CCPA. This rule helps mitigate risks by ensuring visibility into data access patterns, which is essential for protecting sensitive information and maintaining customer trust.
  description: This rule checks if auditing for read events on Object Storage data is enabled in OCI. To verify, ensure that the Oracle Cloud Infrastructure Audit service is configured to log all read operations on Object Storage. Remediation involves enabling audit logging for data read events within the Audit service settings. This provides a comprehensive log of who accessed which data, thereby supporting incident response and forensic investigations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_2.0.htm#2.4
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/standard/54534.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://cloud.oracle.com/data-regions
- rule_id: oci.audit.configuration.object_storage_dataevents_write_enabled
  service: audit
  resource: configuration
  requirement: Object Storage Dataevents Write Enabled
  scope: audit.configuration.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Object Storage Write Data Events Are Auditable
  rationale: Monitoring write actions in Object Storage is crucial for detecting unauthorized data modifications and ensuring data integrity. This is important for meeting compliance requirements such as GDPR and CCPA, which mandate thorough auditing of access and modification to sensitive data. Failure to monitor write events can lead to undetected data breaches, resulting in financial loss and reputational damage.
  description: This rule verifies that auditing is enabled for write data events in OCI Object Storage. It checks that the audit configuration captures all write actions, such as uploads and modifications, to ensure complete visibility over data changes. Administrators should enable data event auditing via the OCI Console under the Audit service, ensuring logs are retained as per organizational policy. Remediation involves configuring the audit service to include 'WRITE' actions for Object Storage within the audit policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Audit/Concepts/auditoverview.htm
  - https://www.oracle.com/cloud-security/cis-oci-benchmark/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.audit.configuration.vault_encryption_enabled
  service: audit
  resource: configuration
  requirement: Vault Encryption Enabled
  scope: audit.configuration.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Vault Encryption is Enabled for Data Protection
  rationale: Enabling Vault Encryption is crucial for protecting sensitive data stored within Oracle Cloud Infrastructure. Without encryption, sensitive data is vulnerable to unauthorized access and potential data breaches, posing significant business risks and regulatory compliance issues, such as fines under GDPR or CCPA. Organizations must ensure encryption to safeguard customer trust and meet industry standards for data protection.
  description: This rule checks whether Vault Encryption is enabled for resources in OCI, ensuring that data at rest is encrypted using Oracle-managed keys. To verify, access the OCI Console, navigate to the 'Vault' service, and ensure that all necessary keys are enabled for encryption. Remediation involves configuring Vault to manage and enforce encryption keys for all sensitive data, utilizing OCI's Key Management Service (KMS) to automate and manage encryption processes effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.monitoring.alarm.log_group_vault_encryption_enabled
  service: monitoring
  resource: alarm
  requirement: Log Group Vault Encryption Enabled
  scope: monitoring.alarm.encryption
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: high
  title: Ensure Log Group Vault Encryption for Monitoring Alarms
  rationale: Encrypting log data at rest is crucial to protect sensitive information from unauthorized access and breaches. It reduces the risk of data exposure in case of a security incident and ensures compliance with industry regulations such as GDPR and PCI-DSS, which mandate the protection of data integrity and confidentiality.
  description: This check verifies that all log groups associated with OCI Monitoring Alarms are encrypted using Oracle Cloud Vault. Log group encryption at rest should be configured to use a customer-managed encryption key (CMEK) from the Oracle Cloud Vault service. To verify, ensure that the 'encryption' property of the log group is set to 'vault'. Remediation involves navigating to the OCI Console, selecting the relevant log group under the Monitoring service, and enabling Vault encryption with a specified CMEK.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam_servicepolicy.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.monitoring.alarm.log_metric_filter_for_object_storage_changes
  service: monitoring
  resource: alarm
  requirement: Log Metric Filter For Object Storage Changes
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Monitor Object Storage Changes Using Log Metric Filters
  rationale: Monitoring changes in Object Storage is crucial to detect unauthorized access or modifications, which can lead to data breaches or loss of critical data. Implementing log metric filters for these changes helps in early threat detection and compliance with data protection regulations such as PCI-DSS and ISO 27001, thereby reducing the risk of potential financial and reputational damage.
  description: This rule ensures that alarms are configured to monitor Object Storage changes by utilizing log metric filters in OCI. It involves setting up an alarm that triggers upon detecting specific log entries related to Object Storage operations such as PUT, POST, DELETE, and GET. To verify, ensure the alarm is active and correctly linked to the appropriate log group and log source. Remediation involves creating or updating alarms to include these filters, ensuring they are set to notify relevant stakeholders through defined communication channels.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/creating_alarms.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.0.0.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
- rule_id: oci.artifacts.container_repository.packages_external_public_publishing_disabled
  service: artifacts
  resource: container_repository
  requirement: Packages External Public Publishing Disabled
  scope: artifacts.container_repository.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Disable External Public Publishing for Container Repositories
  rationale: Allowing external public publishing of container images can lead to unauthorized access and distribution of sensitive software packages, increasing the risk of data breaches and intellectual property theft. Disabling this feature helps mitigate the exposure of potentially vulnerable or proprietary code to external parties, aligning with compliance requirements such as PCI-DSS and NIST standards.
  description: This rule checks if OCI container repositories have external public publishing disabled, ensuring that only authorized users within your organization can access and publish container images. To verify, inspect the container repository settings in the OCI console and ensure that public access is set to 'private.' Remediation involves modifying the repository's public access settings to disable external publishing, reducing the attack surface and complying with security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Registry/Tasks/registrycreatingarepository.htm
  - https://cloudsecurityalliance.org/artifacts/cloud-controls-matrix-v4-0-1/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-171.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.devops.project.project_artifact_encryption
  service: devops
  resource: project
  requirement: Project Artifact Encryption
  scope: devops.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure DevOps Project Artifacts Are Encrypted at Rest
  rationale: Encrypting project artifacts protects sensitive data from unauthorized access, mitigating risks of data breaches and ensuring compliance with data protection regulations such as GDPR and PCI-DSS. Lack of encryption can lead to exposure of intellectual property and sensitive business information, posing significant financial and reputational risks.
  description: This rule checks that all project artifacts within OCI DevOps are encrypted at rest using Oracle-managed keys. Ensure that encryption settings are enabled for all artifacts stored in OCI Object Storage linked to DevOps projects. To verify, navigate to the OCI Console, check the encryption settings under Object Storage for DevOps artifacts, and enable Oracle-managed keys if not already configured. Remediation involves configuring encryption policies and ensuring all existing and new artifacts are stored with encryption enabled.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DevOps/using/devops.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security/cloud-security/encryption/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-111.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.devops.project.project_envvar_awscred
  service: devops
  resource: project
  requirement: Project Envvar Awscred
  scope: devops.project.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure AWS Credentials Are Not Exposed in Project Environment Variables
  rationale: Exposing AWS credentials in environment variables can lead to unauthorized access to AWS resources, resulting in potential data breaches and financial losses. This risk is heightened if the credentials are accidentally shared or logged, making them accessible to unauthorized users. Compliance with security best practices and regulations such as PCI-DSS and ISO 27001 mandates the protection of sensitive credentials to maintain data integrity and confidentiality.
  description: This rule checks for the presence of AWS credentials within environment variables of OCI DevOps projects. Storing credentials in environment variables poses a security risk as they can be inadvertently exposed or logged. To verify compliance, ensure AWS credentials are stored securely using OCI Vault or other dedicated secrets management solutions. Remediation involves auditing environment variables for sensitive data and relocating it to a secure storage solution, ensuring no credentials are exposed.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DevOps/using/devops.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
- rule_id: oci.devops.project.project_object_storage_logs_encrypted
  service: devops
  resource: project
  requirement: Project Object Storage Logs Encrypted
  scope: devops.project.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure DevOps Project Logs Are Encrypted at Rest in OCI
  rationale: Encrypting project logs in Object Storage protects sensitive data from unauthorized access and data breaches, which can lead to compliance violations and reputational damage. Encryption at rest ensures that even if the storage medium is compromised, the data remains secure, addressing requirements for data protection under frameworks like PCI-DSS and HIPAA.
  description: This rule checks if logs associated with DevOps projects in Oracle Cloud Infrastructure are encrypted at rest within Object Storage. Logs should be stored in buckets with encryption enabled using Oracle-managed keys or customer-managed keys for enhanced security. To verify, ensure that the Object Storage bucket settings have encryption enabled. Remediation involves modifying bucket settings to enable encryption or creating new buckets with encryption configured.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm#encryption
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcompartments.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/for-professionals/index.html
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.devops.project.project_older_90_days
  service: devops
  resource: project
  requirement: Project Older 90 Days
  scope: devops.project.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Review OCI DevOps Projects Older Than 90 Days
  rationale: Projects in Oracle Cloud Infrastructure's DevOps service that are older than 90 days may no longer be active, leading to potential misconfiguration, unused resources, and unnecessary access permissions. Regular review and decommissioning of outdated projects mitigate risks such as unauthorized access and data breaches. Compliance with governance policies requires tracking and managing cloud resources effectively.
  description: This rule checks for DevOps projects in OCI that have not been updated or accessed in the past 90 days. Projects that are inactive for this duration may indicate abandonment or obsolescence. To verify, inspect the project's activity logs and update or decommission as necessary to maintain security hygiene. Use OCI's tagging and lifecycle management features to automate compliance and governance tasks for old projects.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/devops/using/home.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/cloud/cloud-security.html
- rule_id: oci.devops.project.project_source_repo_url
  service: devops
  resource: project
  requirement: Project Source Repo Url
  scope: devops.project.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure DevOps Project Source Repo URLs Are Securely Configured
  rationale: Proper configuration of source repository URLs in OCI DevOps projects is critical to reducing the risk of unauthorized access or data leaks. Incorrectly configured URLs can expose sensitive code and infrastructure information, leading to potential exploitation by malicious actors. Adhering to security best practices and compliance standards helps protect intellectual property and maintain organizational trust.
  description: This rule verifies that the source repository URLs configured in OCI DevOps projects are set to secure and authorized locations, preventing unintended exposure. It checks for the presence of secure protocols (e.g., HTTPS) and ensures that access controls are properly applied. To remediate any issues, review and update repository URLs to use secure endpoints and validate access policies to align with organizational security requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/devops/using/home.htm
  - https://www.oracle.com/security-alerts/
  - https://cloudsecurityalliance.org/research/artifacts/cis-oracle-cloud-infrastructure-foundation-benchmark
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/
- rule_id: oci.devops.project.project_user_controlled_buildspec
  service: devops
  resource: project
  requirement: Project User Controlled Buildspec
  scope: devops.project.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Secure Buildspec Configurations in OCI DevOps Projects
  rationale: Allowing user-controlled build specifications in OCI DevOps projects can introduce security risks such as unauthorized code execution and data exposure. Properly managing these configurations helps mitigate risks associated with software supply chain attacks, ensuring the integrity and security of the build process. This is crucial for maintaining compliance with security standards and protecting sensitive information from unauthorized access.
  description: This rule checks that OCI DevOps projects do not permit overly permissive or insecure user-controlled build specifications. It ensures buildspec files are reviewed and approved by authorized personnel, and that appropriate access controls are enforced. Remediation involves configuring IAM policies to restrict who can modify buildspec files and implementing version control and change tracking. Verification can be done by auditing project configurations and reviewing IAM policies regularly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/devops/using/home.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/identitypolicies.htm
  - https://www.oracle.com/security-cloud/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
- rule_id: oci.devops.repository.report_group_export_encrypted
  service: devops
  resource: repository
  requirement: Report Group Export Encrypted
  scope: devops.repository.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Repository Exports are Encrypted
  rationale: Encrypting repository exports protects sensitive code and data from unauthorized access and potential breaches. This is crucial for maintaining data integrity and confidentiality, reducing the risk of intellectual property theft, and ensuring compliance with data protection regulations such as GDPR and HIPAA.
  description: This rule checks that all report group exports from OCI DevOps repositories are encrypted at rest. It ensures that any exported data is stored securely using OCI's encryption mechanisms. To verify, review the encryption settings in the DevOps repository configuration. Remediation involves enabling encryption for exports by configuring the repository settings to use Oracle-managed keys or customer-managed keys (CMKs) for encryption.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DevOps/Concepts/devops_encryption.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
  - https://www.iso.org/standard/54534.html
  - https://cloudsecurityalliance.org/artifacts/cloud-controls-matrix-v4/
- rule_id: oci.compute.instance.ebs_volume_encrypted
  service: compute
  resource: instance
  requirement: Ebs Volume Encrypted
  scope: compute.instance.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Block Volume Encryption for OCI Compute Instances
  rationale: Encrypting block volumes protects sensitive data from unauthorized access and helps mitigate data breaches, especially in cases of physical theft or unauthorized snapshots. It aligns with compliance requirements such as PCI-DSS and HIPAA, ensuring that data at rest is secured by default, reducing the risk of data exposure.
  description: This rule checks that all block volumes attached to OCI Compute Instances are encrypted using Oracle-managed keys or customer-managed keys through Oracle Cloud Infrastructure Vault. Users should verify the encryption status via the OCI Console or CLI. To remediate non-compliant instances, enable encryption on existing volumes by creating new volumes with encryption enabled and migrating data, or ensure all new volumes are created with encryption settings applied.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/encryptingvolumes.htm
  - 'CIS OCI Benchmark: Ensure block volumes are encrypted (if available)'
  - 'NIST SP 800-111: Guide to Storage Encryption Technologies for End User Devices'
  - 'PCI-DSS Requirement 3: Protect stored cardholder data'
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - 'ISO 27001:2013 A.10.1: Cryptographic controls'
- rule_id: oci.compute.instance.ebs_volume_protected_by_backup_plan
  service: compute
  resource: instance
  requirement: Ebs Volume Protected By Backup Plan
  scope: compute.instance.backup_recovery
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: medium
  title: Ensure EBS Volumes are Secured by an OCI Backup Plan
  rationale: Unprotected EBS volumes pose a risk of data loss in the event of accidental deletion, corruption, or disaster recovery scenarios. Implementing a backup plan ensures data redundancy and aligns with compliance requirements such as PCI-DSS and ISO 27001, reducing potential financial and reputational damage.
  description: This rule checks whether Elastic Block Store (EBS) volumes attached to compute instances are protected by an OCI backup plan. To verify, ensure that each EBS volume has an associated backup policy configured via the OCI Console or CLI. Remediation involves creating and applying a scheduled backup plan that meets your recovery point objectives (RPOs) and recovery time objectives (RTOs), ensuring regular and automated backups.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/schedulingvolumebackups.htm
  - https://docs.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/document_library
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/cspm/
- rule_id: oci.compute.instance.elastic_ip_shodan
  service: compute
  resource: instance
  requirement: Elastic Ip Shodan
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure OCI Instances' Elastic IPs Aren't Indexed by Shodan
  rationale: Exposing Elastic IPs to Shodan can lead to increased risk of reconnaissance by malicious actors, potentially leading to targeted attacks on your cloud infrastructure. By preventing indexing, organizations can reduce visibility to unauthorized entities, thereby minimizing the risk of unauthorized access and data breaches, which is crucial for maintaining confidentiality and integrity of sensitive workloads.
  description: This rule checks if Elastic IPs assigned to OCI compute instances are indexed by Shodan, a search engine for internet-connected devices. Instances with public IPs should be evaluated to ensure they aren't unnecessarily exposed or indexed. To remediate, configure security lists and network security groups to restrict inbound traffic, and use private IPs for resources that do not require public access. Regularly audit and monitor IP usage and network traffic to ensure compliance with security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networkoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/iseccis.htm#cis
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.shodan.io/
- rule_id: oci.compute.instance.instance_account_imdsv2_enabled
  service: compute
  resource: instance
  requirement: Instance Account Imdsv2 Enabled
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Enable Instance Metadata Service Version 2 on OCI Instances
  rationale: Enabling Instance Metadata Service Version 2 (IMDSv2) is crucial for protecting against unauthorized access to instance metadata, which could lead to exposure of sensitive configuration details and credentials. IMDSv2 enhances security by requiring session tokens for metadata requests, mitigating various attack vectors like SSRF (Server-Side Request Forgery). Ensuring IMDSv2 is enabled aligns with security best practices and can help in meeting compliance with standards such as NIST and ISO 27001.
  description: This rule checks if the Instance Metadata Service Version 2 is enabled on Oracle Cloud Infrastructure (OCI) compute instances. IMDSv2 requires all requests to use session-based tokens, which strengthens the security posture by preventing unauthorized metadata access. To verify, ensure that the instance configuration is set to require IMDSv2. Remediation involves updating the instance's metadata options to enforce the use of IMDSv2, which can be done through the OCI console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/References/instance-metadata.htm
  - CIS OCI Benchmark - Ensure Instance Metadata Service Version 2 is enabled
  - 'NIST SP 800-53: AC-6 Least Privilege'
  - https://cloudsecurityalliance.org/research/working-groups/cloud-controls-matrix
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.compute.instance.instance_default_service_account_in_use_access
  service: compute
  resource: instance
  requirement: Instance Default Service Account In Use Access
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Use of Default Service Account on Compute Instances
  rationale: Using the default service account for compute instances can lead to over-privileged access, increasing the risk of unauthorized actions if the account is compromised. Restricting its use helps adhere to the principle of least privilege, reducing potential attack surfaces and aiding compliance with security frameworks like NIST and ISO 27001.
  description: This rule checks if the default service account is being used on compute instances. The default account often has broad permissions that may not align with the specific needs of an instance. To verify, inspect instance configurations and IAM policies associated with service accounts, ensuring they are appropriately scoped. Remediation involves creating and using custom service accounts with tailored permissions that match the instance's requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm#Service_Accounts
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/instance_security.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.compute.instance.instance_internet_facing_with_profile
  service: compute
  resource: instance
  requirement: Instance Internet Facing With Profile
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Internet-Facing Instances Have Appropriate Security Profiles
  rationale: Exposing compute instances to the internet without appropriate security measures increases the risk of unauthorized access, data breaches, and compliance violations. This is critical for maintaining the integrity, confidentiality, and availability of sensitive data and systems. Compliance with frameworks such as PCI-DSS or HIPAA requires robust controls around internet-exposed resources.
  description: This rule checks for compute instances that are exposed to the internet without an associated security profile that enforces strict security group rules and network security configurations. Instances should have minimal open ports and should only allow traffic from trusted IP addresses. Remediation involves attaching a well-defined security list or network security group that aligns with best practices, limiting access to essential services, and continuously monitoring for unauthorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networksecuritygroups.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://community.oracle.com/docs/DOC-1049683
  - 'NIST SP 800-53: Access Control (AC-3)'
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.compute.instance.instance_monitoring_enabled
  service: compute
  resource: instance
  requirement: Instance Monitoring Enabled
  scope: compute.instance.monitoring
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Compute Instance Monitoring is Enabled
  rationale: Enabling instance monitoring is critical for proactively identifying performance issues and potential security threats. It provides visibility into resource utilization and operational anomalies, helping to mitigate risks such as unauthorized access and data breaches. Compliance with frameworks such as NIST and ISO 27001 often requires robust monitoring to ensure data integrity and availability.
  description: This rule checks if Oracle Cloud Infrastructure (OCI) Compute instances have monitoring enabled. Monitoring should be activated to collect metrics for CPU, memory, and disk usage, which are crucial for detecting irregular activities and ensuring system health. Verify by navigating to the OCI Console under Compute Instances and ensuring the Monitoring option is toggled on. Remediation involves enabling monitoring in the instance settings or via the OCI CLI or SDK.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/standard/54534.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm
  - https://cloud.oracle.com/iaas/whitepapers/best-practices-for-securing-oci.pdf
- rule_id: oci.compute.instance.instance_paravirtual_type
  service: compute
  resource: instance
  requirement: Instance Paravirtual Type
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Instances Use Paravirtualized Boot Mode
  rationale: Using paravirtualized boot mode for instances enhances performance by enabling the operating system to interact more efficiently with the hypervisor. This optimization reduces overhead, improves I/O throughput, and minimizes the attack surface associated with hardware emulation. Adopting paravirtualization aligns with compliance requirements for performance and security in virtualized environments.
  description: This rule checks if OCI compute instances are using the paravirtualized boot mode instead of emulated or direct boot modes. Paravirtualization allows better integration with the hypervisor, leading to improved system performance and security. To verify, examine instance settings in the OCI console and ensure boot mode is set to 'Paravirtualized'. If not configured, change the instance boot mode to 'Paravirtualized' via the OCI console or CLI. It's important to note that not all operating systems support this mode, so verify compatibility before making changes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/launchinginstance.htm#paravirtual
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-125a.pdf
  - https://www.oracle.com/cloud/security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/cloud/compute/
- rule_id: oci.compute.instance.instance_secrets_user_data
  service: compute
  resource: instance
  requirement: Instance Secrets User Data
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: high
  title: Prevent Sensitive Data Exposure in Instance User Data
  rationale: Storing secrets in instance user data can lead to exposure of sensitive information if improperly configured, as it is accessible to anyone with permission to view the instance configuration. This can lead to unauthorized access and potential data breaches, violating compliance requirements like PCI-DSS, NIST, and ISO 27001, and causing significant business and reputational damage.
  description: This rule checks if sensitive secrets such as passwords, API keys, or tokens are stored in the user data of OCI compute instances. It is crucial to avoid placing sensitive information in user data, as it can be accessed by anyone with access to the instance metadata. Instead, use OCI Vault or other secure methods for secret management. Remediation involves auditing existing configurations, removing sensitive data from user data, and implementing secure secret storage solutions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/storingmetadataaboutaninstance.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.0.0.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingsecrets.htm
  - https://cloudsecurityalliance.org/artifacts/cloud-controls-matrix-v4/
- rule_id: oci.compute.instance.instance_shielded_vm_enabled
  service: compute
  resource: instance
  requirement: Instance Shielded VM Enabled
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Enable Shielded VM on OCI Compute Instances
  rationale: Enabling Shielded VM provides integrity verification and protection against firmware and bootloader attacks, ensuring the integrity of the compute instances. This is crucial for maintaining the confidentiality and integrity of sensitive workloads, and helps meet compliance requirements for data protection and security standards.
  description: This rule checks if Shielded VM is enabled for Oracle Cloud Infrastructure Compute instances. Shielded VMs use Trusted Platform Module (TPM) and Secure Boot features to protect against unauthorized firmware and bootloader changes. To verify, ensure that the Shielded Instance setting is enabled in the instance configuration. Remediation involves modifying instance configurations to enable Shielded VM, thereby enhancing security against rootkit and bootloader attacks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/References/shielded-instances.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.compute.instance.instance_ssh_key_authentication
  service: compute
  resource: instance
  requirement: Instance Ssh Key Authentication
  scope: compute.instance.authentication
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: high
  title: Enforce SSH Key Authentication for Compute Instances
  rationale: SSH key authentication is critical for securing access to compute instances by eliminating the use of weak or compromised passwords, which are a common attack vector. Ensuring SSH key authentication mitigates unauthorized access risks, complies with industry standards like PCI-DSS, and protects sensitive business data from unauthorized access.
  description: This rule checks if SSH key authentication is enforced for all compute instances, ensuring that password-based logins are disabled. To verify, ensure that each instance has an associated SSH key pair and that the instance's operating system configuration disallows password authentication. Remediation involves generating a new SSH key pair, updating the instance's metadata with the public key, and configuring the operating system to disable password-based logins in the SSHD configuration file.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/managingkeypairs.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://www.pcisecuritystandards.org/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.oracle.com/security/cloud-security/capabilities/
- rule_id: oci.compute.instance.instance_uses_single_eni
  service: compute
  resource: instance
  requirement: Instance Uses Single Eni
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Compute Instances Use a Single Network Interface
  rationale: Limiting compute instances to a single network interface card (NIC) minimizes attack surfaces and simplifies network management. This configuration reduces the complexity of network traffic monitoring and management, lowering the risk of unauthorized access or data leakage. It aligns with security best practices by maintaining a streamlined and controlled network architecture.
  description: This rule checks if Oracle Cloud Infrastructure (OCI) compute instances are configured to use only one network interface. Instances with multiple NICs can introduce additional security vulnerabilities and management overhead. To verify compliance, review the instance configuration in the OCI Console under 'Compute' and ensure only one NIC is attached. Remediation involves detaching any additional NICs from the instance. This can be done through the OCI Console or CLI, ensuring a single network interface is maintained for security and operational efficiency.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingVnics.htm
  - https://www.oracle.com/security/cis-oracle-cloud-infrastructure-benchmark/
  - https://doi.org/10.6028/NIST.SP.800-53r5
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/compute/
- rule_id: oci.compute.instance.launch_template_imdsv2_required
  service: compute
  resource: instance
  requirement: Launch Template Imdsv2 Required
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Enforce IMDSv2 for Instance Metadata Access
  rationale: Using IMDSv2 enhances the security posture of compute instances by requiring session-based authentication for metadata access, mitigating risks of unauthorized access and potential data exfiltration. This aligns with modern security practices and helps meet compliance requirements for protecting sensitive data from threats such as SSRF (Server-Side Request Forgery) attacks.
  description: This rule checks whether Oracle Cloud Infrastructure compute instances are launched using templates that enforce the use of Instance Metadata Service Version 2 (IMDSv2). IMDSv2 provides more robust security than its predecessor by requiring session tokens, thus preventing unauthorized metadata access. To verify, ensure that the launch template specifies IMDSv2 as a requirement. Remediation involves updating existing instance templates to mandate IMDSv2 or creating a new launch template with this configuration.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/References/instance-metadata-service.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://www.oracle.com/security/cloud-compliance/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-123.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/cloud-native/
- rule_id: oci.compute.instance.launch_template_no_secrets
  service: compute
  resource: instance
  requirement: Launch Template No Secrets
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: high
  title: Ensure No Secrets in OCI Compute Instance Launch Templates
  rationale: Embedding secrets such as passwords, SSH keys, or API tokens in launch templates poses significant security risks, including unauthorized access and potential data breaches. This practice can violate compliance standards like PCI-DSS and ISO 27001, leading to legal liabilities and financial penalties. Securing launch templates is vital to protect sensitive information and maintain the integrity of cloud resources.
  description: This rule checks for the presence of sensitive data in OCI Compute Instance launch templates. It ensures that no secrets, such as passwords or API tokens, are embedded directly within the template configurations. To verify, review template metadata and user data scripts for any hardcoded sensitive information. Remediation involves using OCI Vault to store sensitive data securely and reference these secrets at runtime using environment variables or OCI's Key Management service.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Concepts/launchtemplates.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-foundations-benchmark-v1/
  - https://www.pcisecuritystandards.org/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keymanagementoverview.htm
- rule_id: oci.compute.instance.network_default_in_use
  service: compute
  resource: instance
  requirement: Network Default In Use
  scope: compute.instance.network_security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: medium
  title: Ensure No Use of Default Network in Compute Instances
  rationale: Using default networks in OCI compute instances can expose them to unnecessary risk as they may not be configured with optimal security settings. This can lead to unauthorized access, data breaches, and non-compliance with security standards. Proper network segmentation and custom network configurations enhance security posture and ensure compliance with regulatory requirements.
  description: This check verifies if the default network is used in any compute instances. Instances using the default network are more vulnerable to attacks due to less restrictive security settings. To verify, review the network settings of all compute instances and ensure they are using custom VCNs with properly configured security lists or network security groups. Remediation involves reconfiguring instances to use a non-default VCN tailored to specific security needs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.nist.gov/publications/security-and-privacy-controls-information-systems-and-organizations
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/capabilities/
- rule_id: oci.compute.instance.network_not_legacy
  service: compute
  resource: instance
  requirement: Network Not Legacy
  scope: compute.instance.network_security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: medium
  title: Ensure Instances Use Latest Network Configurations
  rationale: Outdated network configurations in compute instances can expose your infrastructure to vulnerabilities and attacks, leading to potential data breaches and operational disruptions. Adhering to the latest network standards ensures compliance with security regulations such as PCI-DSS and enhances the resilience of your cloud environment against evolving threats.
  description: This rule checks if compute instances are using the latest network configurations by verifying the absence of legacy network settings such as deprecated network protocols or insecure subnet associations. To verify, check the instance's VCN and subnets for adherence to current security best practices. Remediation involves updating network settings to align with OCI's recommended configurations, using tools like the OCI Console or CLI for implementation.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/cloud/security-compliance/
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.compute.instance.networkacl_unrestricted_ingress
  service: compute
  resource: instance
  requirement: Networkacl Unrestricted Ingress
  scope: compute.instance.network_security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Restrict Unrestricted Ingress in Network ACLs for OCI Instances
  rationale: Unrestricted ingress in network ACLs for OCI instances significantly increases the risk of unauthorized access, data breaches, and exploitation by malicious actors. This configuration may lead to exposure of sensitive data and critical infrastructure components to the public internet, violating compliance requirements such as PCI-DSS and ISO 27001, and impacting the organization's reputation and operational integrity.
  description: This rule checks for network ACL configurations that allow unrestricted ingress traffic to Oracle Cloud Infrastructure compute instances. It identifies ACL rules that permit all inbound traffic from any source, which is a critical security vulnerability. To remediate, review and modify ACL rules to specify only trusted IP ranges and necessary ports for ingress traffic. Ensure the principle of least privilege is applied to limit exposure and enhance security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingnetworkacls.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/standard/54534.html
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.compute.instance.networkacl_unused
  service: compute
  resource: instance
  requirement: Networkacl Unused
  scope: compute.instance.network_security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: medium
  title: Unused Network ACLs on Compute Instances
  rationale: Unused network ACLs on compute instances can lead to unnecessary complexity and potential misconfigurations, increasing the attack surface. This can result in unauthorized access or data breaches, which may violate compliance requirements such as NIST SP 800-53, PCI-DSS, and ISO 27001. Maintaining a minimal and well-configured network access list is crucial for effective cloud security management.
  description: This rule checks for compute instances with associated network ACLs that are not actively being used. Network ACLs should only be configured and applied where necessary to enforce access controls and protect sensitive data. To verify, review the network ACLs associated with each compute instance and ensure they are required and properly configured. If an ACL is unused, consider removing or consolidating it to reduce complexity and potential misconfigurations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networkacl.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/standard/54534.html
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v4/
- rule_id: oci.compute.instance.securitygroup_default_restricted
  service: compute
  resource: instance
  requirement: Securitygroup Default Restricted
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict Default Security Group for Compute Instances
  rationale: Restricting the default security group minimizes the attack surface of compute instances by preventing unintended exposure to public networks. This reduces the risk of unauthorized access and potential data breaches, thereby aligning with compliance requirements such as PCI-DSS and ISO 27001 which mandate controlled access to networked systems.
  description: This rule checks that Oracle Cloud Infrastructure (OCI) compute instances do not use the default security group, which typically allows broad access. Instead, instances should be associated with customized security groups that enforce the principle of least privilege. To verify, review the instance's security group assignments and ensure they are not set to default. Remediation involves creating a custom security group with restrictive ingress and egress rules tailored to the application's needs and reassigning the instance to this group.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitygroups.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
- rule_id: oci.compute.instance.securitygroup_from_launch_wizard
  service: compute
  resource: instance
  requirement: Securitygroup From Launch Wizard
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Instances Use Proper Security Groups from Launch Wizard
  rationale: Assigning security groups during instance launch ensures that the instance is protected by appropriate network access controls from the start. This minimizes the risk of unauthorized access and potential data breaches, which can lead to compliance violations and financial losses. Properly configured security groups are crucial for adhering to industry standards and maintaining a secure cloud environment.
  description: This rule checks if compute instances launched using the OCI Launch Wizard are assigned to specific security groups that enforce the intended security policies. Verify that each instance has the correct security group configuration to control inbound and outbound traffic. Remediation involves reviewing the security group settings in the OCI console and adjusting the rules to meet your organization's security requirements. Ensure that security groups are configured to allow only necessary traffic.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingsecuritygroups.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org
  - https://www.oracle.com/security/cloud-security/best-practices/
- rule_id: oci.compute.instance.securitygroup_not_used
  service: compute
  resource: instance
  requirement: Securitygroup Not Used
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Compute Instances Use Security Groups
  rationale: Not using security groups for compute instances can expose them to unintended network access, increasing the risk of unauthorized access and potential data breaches. By utilizing security groups, organizations can enforce granular security policies that align with their compliance requirements such as GDPR or PCI-DSS, thereby minimizing the attack surface and enhancing overall security posture.
  description: This rule checks whether Oracle Cloud Infrastructure (OCI) compute instances are associated with a network security group. A security group acts as a virtual firewall that controls inbound and outbound traffic to instances. To verify, review the instance configurations in the OCI console and ensure security groups are attached. Remediation involves creating or selecting an appropriate security group with defined ingress and egress rules and associating it with the instance, which can be done via the OCI console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitygroups.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingsecuritygroups.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.compute.instance.securitygroup_rdp_restricted
  service: compute
  resource: instance
  requirement: Securitygroup Rdp Restricted
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Restrict RDP Access in Security Groups
  rationale: Unrestricted RDP access to instances can lead to unauthorized access and potential data breaches, increasing the risk of cyber attacks like brute force and malware infections. By restricting RDP access, organizations can reduce the attack surface and comply with regulatory mandates such as PCI-DSS and ISO 27001, which require secure management of network access.
  description: This rule checks if RDP access (port 3389) is restricted within security groups associated with OCI compute instances. It's recommended to limit access to specific IP addresses or CIDR blocks rather than allowing open access from the internet. To verify, review the security group rules and ensure that RDP access is limited to trusted sources. Remediation involves updating security group rules to specify allowed IP ranges and removing '0.0.0.0/0' if present.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securityrules.htm
  - https://www.oracle.com/cloud/security/compliance/cis-oci-benchmark/
  - https://www.pcisecuritystandards.org
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.compute.instance.securitygroup_with_many_ingress_egress_rules
  service: compute
  resource: instance
  requirement: Securitygroup With Many Ingress Egress Rules
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Limit Ingress and Egress Rules in Security Groups
  rationale: Overly permissive security groups with many ingress and egress rules can expose compute instances to unnecessary risk by allowing unwanted traffic. This can lead to potential data breaches, unauthorized access, and compliance violations with frameworks such as PCI-DSS and HIPAA. Minimizing and auditing these rules helps ensure that only legitimate traffic is permitted, reducing the attack surface.
  description: This check verifies that security groups associated with OCI compute instances do not have an excessive number of ingress and egress rules. Instances should be configured with the principle of least privilege, allowing only necessary traffic. To verify, review the security group configurations in the OCI console and ensure that all rules are essential. Remediation involves removing or consolidating redundant or overly permissive rules to tighten access control.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingsecuritylists.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hipaajournal.com/hipaa-compliance-checklist/
  - https://cloudsecurityalliance.org/research/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.compute.instance.transitgateway_auto_accept_vpc_attachments
  service: compute
  resource: instance
  requirement: Transitgateway Auto Accept VPC Attachments
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Transit Gateway Auto-Accept for VPC Attachments is Disabled
  rationale: Allowing automatic acceptance of VPC attachments via Transit Gateway can lead to unauthorized network access and potential data breaches. It increases the risk of unintended connections that could expose sensitive workloads to external threats. Organizations must manually review and approve VPC attachments to maintain control over network configurations, align with compliance requirements, and mitigate the risk of unauthorized access.
  description: This rule checks whether the Transit Gateway is configured to automatically accept VPC attachments in an OCI environment. Auto-acceptance is discouraged as it bypasses necessary security checks and approvals. To verify, navigate to the Transit Gateway settings in the OCI Console and confirm that the auto-accept feature is disabled. Remediation involves setting the 'auto-accept' parameter to 'false' in the configuration settings to ensure all VPC attachments require manual approval.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/transitgateway.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.container_engine.cluster.instances_task_definition_logging_enabled
  service: container_engine
  resource: cluster
  requirement: Instances Task Definition Logging Enabled
  scope: container_engine.cluster.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Logging for OCI Container Engine Task Definitions
  rationale: Enabling logging for task definitions in OCI Container Engine clusters is crucial for tracking operations, debugging issues, and understanding application behavior. Without logging, organizations face increased risk of undetected errors or malicious activity, potentially leading to service disruptions or data breaches. It also supports compliance with standards like PCI-DSS and ISO 27001 that require detailed audit trails.
  description: This rule checks whether logging is enabled for task definitions in OCI Container Engine clusters. To ensure logging is configured, verify that the task definitions are set to output logs to OCI Logging service. Remediation involves updating the task definition configurations to include logging settings, ensuring logs are correctly routed and retained. This process involves accessing the OCI Console or using CLI commands to modify task definitions, ensuring logs are captured for operational and security audits.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam_service.htm
  - https://www.oracle.com/security/cloud-security/cyber-security/
- rule_id: oci.container_engine.cluster.registry_image_scan_on_push_enabled
  service: container_engine
  resource: cluster
  requirement: Registry Image Scan On Push Enabled
  scope: container_engine.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enable Registry Image Scan on Push for OCI Clusters
  rationale: Enabling image scan on push helps identify vulnerabilities at the earliest stage of the deployment pipeline, reducing the risk of deploying compromised images to production. This proactive measure mitigates potential security threats, protects sensitive data, and ensures compliance with industry standards by maintaining a secure container environment.
  description: This rule checks if OCI Container Engine clusters have the 'Registry Image Scan On Push' feature enabled. When activated, images pushed to the Oracle Cloud Infrastructure Registry are automatically scanned for vulnerabilities, providing immediate feedback to developers. To enable this feature, navigate to the OCI Console, access the Container Registry settings, and activate 'Scan on Push'. Regularly review and address any identified vulnerabilities to maintain a secure cluster environment.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Registry/Tasks/registryconfiguringiam.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org
  - https://www.nist.gov/cyberframework
  - https://cloud.oracle.com/cloud-infrastructure
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_oci.htm
- rule_id: oci.container_engine.cluster.registry_repository_encryption_enabled
  service: container_engine
  resource: cluster
  requirement: Registry Repository Encryption Enabled
  scope: container_engine.cluster.encryption
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: high
  title: Ensure Registry Repository Encryption for OKE Clusters
  rationale: Enabling encryption for container registry repositories is crucial to protect sensitive data at rest, prevent unauthorized access, and mitigate data breaches. This measure aligns with regulatory requirements such as GDPR and CCPA, ensuring that sensitive data is safeguarded against potential threats. Unencrypted data in container registries can be exploited by attackers to gain insights into application architecture and vulnerabilities, posing a substantial risk to business operations.
  description: This rule checks that encryption is enabled for all Oracle Kubernetes Engine (OKE) cluster registry repositories. To verify, navigate to the OCI Console, access the Container Registry settings, and ensure the encryption state is active. Remediation involves configuring the repository to use Oracle-managed or customer-managed encryption keys, enhancing data protection. Encryption should be consistently applied to safeguard all container images stored within the OCI Container Registry.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Registry/Tasks/registryencryption.htm
  - https://www.oracle.com/security/cloud-security/cloud-security-compliance/
  - https://www.cisecurity.org/benchmark/oracle/
  - 'NIST SP 800-57 Part 1: Recommendation for Key Management'
  - 'PCI-DSS Requirement 3: Protect Stored Cardholder Data'
  - https://www.oracle.com/security/cloud-security/container-security/
- rule_id: oci.database.autonomous_database.account_firewall_use_selected_networks
  service: database
  resource: autonomous_database
  requirement: Account Firewall Use Selected Networks
  scope: database.autonomous_database.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: medium
  title: Ensure Autonomous DB Uses Account Firewall with Specific Networks
  rationale: Restricting network access to Autonomous Databases using account firewalls helps mitigate unauthorized access risks, protecting sensitive data from potential breaches. This control is crucial for compliance with data protection regulations and for maintaining the integrity and confidentiality of business-critical information.
  description: This rule verifies that an Autonomous Database in OCI is configured to use account firewalls, allowing access only from specified network sources. To check this, ensure that the database's network access control list is limited to known, trusted IP addresses or VCNs. Remediation involves updating the database settings to enforce these restrictions, which can be done through the OCI Console or API by configuring the allowed IP address sources.
  references:
  - https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/network-access-control.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm#network
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_catalog.catalog.science_notebook_instance_encryption_enabled
  service: data_catalog
  resource: catalog
  requirement: Science Notebook Instance Encryption Enabled
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Encryption for Science Notebook Instances in Data Catalog
  rationale: Enabling encryption for Science Notebook instances is crucial to protect sensitive data from unauthorized access and potential breaches. It mitigates risks associated with data exposure, particularly in environments handling confidential or regulated information. Compliance with data protection laws such as GDPR, HIPAA, or industry standards like PCI-DSS often mandates encryption of data at rest.
  description: This rule checks whether encryption is enabled for Science Notebook instances within the OCI Data Catalog service. Encryption at rest protects data by converting it into an unreadable format using a cipher. To verify, ensure that the encryption settings are configured in the OCI console under the Data Catalog service by enabling encryption for the necessary resources. Remediation involves navigating to the Data Catalog service, accessing the specific catalog, and enabling the encryption feature to secure the data at rest.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/overview.htm
  - https://www.oracle.com/security/cloud-security/casb.html
  - 'NIST SP 800-53 Rev. 5: SC-28 Protection of Information at Rest'
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.iso.org/iso-iec-27001-information-security.html
- rule_id: oci.database.autonomous_database.cluster_copy_tags_to_snapshots
  service: database
  resource: autonomous_database
  requirement: Cluster Copy Tags To Snapshots
  scope: database.autonomous_database.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure Autonomous DB Snapshots Inherit Tags from Clusters
  rationale: Consistently applying tags from autonomous database clusters to their snapshots helps maintain an organized and efficient resource management strategy, which is critical for tracking costs, managing resources, and ensuring compliance with company policies. Without this, organizations face increased risk of mismanagement, resource sprawl, and potential oversights in security or compliance audits.
  description: This rule checks that tags assigned to autonomous database clusters are automatically copied to their snapshots. Proper tagging facilitates resource identification and cost allocation, and assists in policy enforcement related to data management and access controls. To verify, check the 'Autonomous Database' settings in the OCI console for the 'Copy Tags to Snapshots' option. If not enabled, navigate to the 'Autonomous Database Details' page in the OCI console and enable the 'Copy Tags to Snapshots' feature to ensure tag consistency.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-foundations-benchmark.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.oracle.com/security/cloud-security/best-practices/
- rule_id: oci.database.autonomous_database.cluster_integration_cloudwatch_logs
  service: database
  resource: autonomous_database
  requirement: Cluster Integration Cloudwatch Logs
  scope: database.autonomous_database.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Enable Cloudwatch Logs for Autonomous Database Clusters
  rationale: Enabling Cloudwatch Logs for Autonomous Database Clusters is crucial for maintaining visibility into database operations, detecting anomalous activities, and ensuring audit trails are available for compliance. Without centralized logging, organizations risk missing critical security incidents and failing to meet regulatory requirements such as PCI-DSS and SOC2.
  description: This rule checks if Autonomous Databases are integrated with Cloudwatch Logs to facilitate centralized logging. To verify, ensure that logging is enabled in the OCI Console under the Autonomous Database settings. Remediation involves configuring Cloudwatch Logs in the database logging settings, allowing for continuous monitoring and alerting. This ensures that audit trails are maintained and accessible for forensic analysis and compliance reporting.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci-cis-1-2-0/sec-oci-cis-1-2-0-autonomous-database.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://cloud.oracle.com/en_US/architecture/cloud-security-best-practices
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
- rule_id: oci.database.autonomous_database.cluster_multi_az
  service: database
  resource: autonomous_database
  requirement: Cluster Multi Az
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous DB Cluster is Configured for Multi-AZ Deployment
  rationale: Deploying Autonomous Databases across multiple availability domains (Multi-AZ) enhances data resilience and availability, reducing risks of data loss and downtime during regional failures or maintenance. This configuration supports business continuity and meets compliance requirements for redundancy and disaster recovery, crucial for industries such as finance and healthcare.
  description: This rule checks if Autonomous Databases are deployed using the Multi-AZ configuration, which involves setting up clusters across different availability domains within a region. This setup ensures that databases remain operational even if one availability domain goes down. To verify, inspect the database settings in the OCI Console or use the OCI CLI to check the 'availabilityDomain' parameter. Remediation involves modifying the database configuration to enable Multi-AZ deployment, which can be done by creating or updating the database cluster with the appropriate settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/privacy-framework
  - https://www.pcisecuritystandards.org/document_library
  - https://www.oracle.com/security-best-practices/
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbcreating.htm
- rule_id: oci.database.autonomous_database.cluster_storage_encrypted
  service: database
  resource: autonomous_database
  requirement: Cluster Storage Encrypted
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Cluster Storage is Encrypted
  rationale: Encrypting the cluster storage of Autonomous Databases mitigates the risk of unauthorized data access in scenarios such as data breaches or insider threats. This practice is crucial for maintaining data confidentiality and integrity, aligning with compliance standards like PCI-DSS, HIPAA, and ISO 27001, which mandate encryption of sensitive data at rest. Failure to encrypt storage may lead to significant financial, reputational, and legal repercussions.
  description: This rule verifies that the storage associated with Autonomous Databases is encrypted using Oracle-managed keys. To check this, ensure that the database's encryption status is set to 'ENCRYPTED' in the OCI Console under the Autonomous Database details. If not, enable storage encryption by configuring the database with the latest security settings provided by OCI. Regularly audit the encryption configuration to ensure compliance with organizational policies and regulatory requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/
  - https://www.hipaajournal.com/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57p1r4.pdf
- rule_id: oci.database.autonomous_database.instance_backup_encrypted
  service: database
  resource: autonomous_database
  requirement: Instance Backup Encrypted
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Backups Are Encrypted
  rationale: Encrypting backups of Oracle Cloud Infrastructure Autonomous Databases is crucial to protect sensitive data from unauthorized access and potential breaches, especially in scenarios where backups are exfiltrated or improperly accessed. This is vital for meeting regulatory requirements such as PCI-DSS and HIPAA, which mandate data protection measures. Ensuring encryption helps mitigate risks associated with data theft, financial loss, and reputational damage.
  description: This rule checks that all backups of Autonomous Databases in OCI are encrypted using Oracle's Transparent Data Encryption (TDE) by default, which ensures that data remains secure both at rest and during transit. To verify, examine the backup configurations within the OCI Console and ensure encryption settings are enabled. Remediation involves enabling TDE for any unencrypted backups via the OCI Console or API, ensuring compliance with security policies and standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adbsecure.htm#ADBsecurity
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.database.autonomous_database.instance_iam_authentication_enabled
  service: database
  resource: autonomous_database
  requirement: Instance IAM Authentication Enabled
  scope: database.autonomous_database.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enable IAM Authentication for Autonomous Databases
  rationale: Enabling IAM authentication for Autonomous Databases in OCI enhances security by leveraging Oracle Cloud's centralized identity management. This reduces the risk of unauthorized access through unified credential management, auditing, and policy enforcement. Regulatory frameworks such as PCI-DSS and HIPAA require stringent access controls, making this an essential configuration to meet compliance and mitigate data breach risks.
  description: This rule checks if IAM Authentication is enabled on Autonomous Databases, allowing users to authenticate using Oracle Cloud Infrastructure Identity and Access Management. Verification involves ensuring the 'IAM Authentication' setting is active in the database's configuration. To remediate, navigate to the Autonomous Database details page in the OCI Console, select 'Access Control', and enable 'IAM Authentication'. This ensures that access management is centralized and aligned with organizational security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbusingiam.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/identityandaccessmanagement.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security-cloud.html
- rule_id: oci.database.autonomous_database.instance_inside_vpc
  service: database
  resource: autonomous_database
  requirement: Instance Inside VPC
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Autonomous DB Must Be Within a Virtual Cloud Network
  rationale: Ensuring Autonomous Databases reside within a Virtual Cloud Network (VCN) is crucial for isolating sensitive data from potential threats. It mitigates risks such as unauthorized access and data exfiltration by employing network segmentation. This practice aligns with regulatory requirements for data protection, including PCI DSS and HIPAA, which mandate stringent access controls and network security.
  description: This rule verifies that Autonomous Databases are deployed within a VCN, ensuring they benefit from network-level security controls such as security lists and network security groups. To check compliance, review the database's network setup in the OCI console and ensure it is associated with a VCN. Remediation involves reconfiguring the database to reside within a VCN, which can be done by creating a new database instance with the appropriate VCN settings or by modifying the existing setup to include VCN properties.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.database.autonomous_database.instance_transport_encrypted
  service: database
  resource: autonomous_database
  requirement: Instance Transport Encrypted
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Transport Layer Encryption
  rationale: Transport Layer Encryption safeguards data in transit, mitigating risks from interception or unauthorized access during transfer. This is crucial for maintaining data confidentiality and integrity, especially in multi-tenant cloud environments. Compliance with regulations such as PCI-DSS and HIPAA often mandate encryption for sensitive data to prevent data breaches and associated penalties.
  description: This rule verifies that the transport layer for Oracle Autonomous Databases is encrypted, ensuring data in transit protection. Check whether the database service uses Oracle's native Transparent Data Encryption (TDE) for all transport layers. If not configured, enable TDE in the database settings through the OCI Console, ensuring that all communication channels are encrypted by default. Regularly audit configurations to maintain compliance and security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbencryptingdata.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/
  - https://www.hipaajournal.com/hipaa-encryption-requirements/
- rule_id: oci.database.autonomous_database.multi_az_enabled
  service: database
  resource: autonomous_database
  requirement: Multi Az Enabled
  scope: database.autonomous_database.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable Multi-AZ for Autonomous Databases
  rationale: Enabling multi-AZ deployments for OCI Autonomous Databases ensures high availability and fault tolerance, protecting against data loss and downtime in the event of a regional failure. This configuration is critical for maintaining business continuity and meeting compliance requirements for data protection and privacy, particularly for organizations subject to regulations such as PCI-DSS and SOC2.
  description: This rule checks if your OCI Autonomous Databases have Multi-AZ enabled, which distributes database replicas across multiple availability domains. To verify, navigate to the Oracle Cloud Console, select your Autonomous Database instance, and ensure that the 'Availability Domain' setting is configured to use multiple AZs. Remediation involves modifying existing databases to support Multi-AZ configurations or creating new databases with this setting enabled. This provides increased resilience against regional outages.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm#Availability
  - https://www.oracle.com/security-cloud/cis-oracle-cloud-infrastructure-foundation-benchmark.html
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/sorhome.html
  - https://docs.oracle.com/en/cloud/paas/data-safe/security-compliance/features.html
- rule_id: oci.database.autonomous_database.snapshots_encrypted
  service: database
  resource: autonomous_database
  requirement: Snapshots Encrypted
  scope: database.autonomous_database.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Autonomous Database Snapshots are Encrypted
  rationale: Encrypting snapshots of Autonomous Databases in OCI is critical to protect sensitive data from unauthorized access and potential breaches. Unencrypted snapshots pose a risk if they are improperly accessed or if storage media is compromised. This measure helps in meeting regulatory requirements such as PCI-DSS and GDPR, which mandate encryption of stored data.
  description: This rule checks that all snapshots of Autonomous Databases are encrypted using Oracle's Transparent Data Encryption (TDE). To verify compliance, review the encryption settings in the OCI console under the database's backup configuration. If snapshots are not encrypted, enable encryption by configuring TDE for new and existing snapshots. Regular audits should be conducted to ensure encryption settings are maintained.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/References/databasesecurity.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/database-security/
- rule_id: oci.cloud_guard.target.ensure_defender_for_app_services_is_on
  service: cloud_guard
  resource: target
  requirement: Ensure Defender For App Services Is On
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Enable Defender for App Services on Cloud Guard Target
  rationale: Enabling Defender for App Services in Oracle Cloud Guard enhances security by actively monitoring and defending application services against threats. This proactive security measure reduces the risk of data breaches and unauthorized access, protecting sensitive business and customer data. It also helps organizations meet compliance requirements by ensuring that security monitoring and defense mechanisms are in place.
  description: This rule checks whether the Defender for App Services feature is enabled on Cloud Guard targets. To verify, access the Cloud Guard console and ensure that the 'Defender for App Services' option is activated for the specified target. If not enabled, follow Oracle's guidance to activate this feature, which involves navigating to the Cloud Guard configuration settings and toggling the Defender option to 'On' to ensure continuous monitoring and protection of application services.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/using/overview.htm
  - https://www.oracle.com/security/cloud-security/cloud-guard/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/security/
- rule_id: oci.cloud_guard.target.ensure_defender_for_containers_is_on
  service: cloud_guard
  resource: target
  requirement: Ensure Defender For Containers Is On
  scope: cloud_guard.target.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enable Defender for Containers in OCI Cloud Guard
  rationale: Enabling Defender for Containers within OCI Cloud Guard is crucial for detecting and mitigating security threats in Kubernetes and container environments. This enhances visibility into container workloads, identifying vulnerabilities and anomalous activities that could lead to data breaches or service disruptions. Compliance with regulations such as PCI-DSS and ISO 27001 often requires robust container security measures.
  description: This rule verifies that OCI Cloud Guard's Defender for Containers is activated to monitor and protect containerized applications within Oracle Cloud Infrastructure. To ensure compliance, access the Cloud Guard dashboard and enable the Defender for Containers feature under the security settings of each target. This setup helps in identifying misconfigurations, vulnerabilities, and unauthorized access attempts in container environments. Remediation involves configuring Cloud Guard to continuously monitor and providing alerts for any deviations from expected behavior.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Concepts/cloud_guard.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://www.iso.org/standard/54534.html
  - https://docs.oracle.com/en/cloud/paas/container-cloud/cscli/container-security.html
  - https://www.oracle.com/cloud-native/containers/
- rule_id: oci.cloud_guard.target.ensure_defender_for_cosmosdb_is_on
  service: cloud_guard
  resource: target
  requirement: Ensure Defender For Cosmosdb Is On
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Enable Cloud Guard Defender for CosmosDB Resources
  rationale: Enabling Defender for CosmosDB ensures continuous monitoring and protection against potential threats and vulnerabilities specific to CosmosDB resources. This is crucial for preventing unauthorized access and data breaches, which can result in significant financial losses and reputational damage. Moreover, it helps in meeting compliance requirements for data protection and security governance.
  description: This rule verifies that the Cloud Guard service in Oracle Cloud Infrastructure is configured with the Defender feature enabled for CosmosDB resources. To ensure this setting is active, users should navigate to the Cloud Guard dashboard and check the security posture of CosmosDB targets. If Defender is not enabled, it can be activated through the Cloud Guard settings. This proactive measure enhances the security of CosmosDB instances by identifying and mitigating risks in real time.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/home.htm
  - https://www.oracle.com/security/cloud-security/cloud-guard/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.cloud_guard.target.ensure_defender_for_databases_is_on
  service: cloud_guard
  resource: target
  requirement: Ensure Defender For Databases Is On
  scope: cloud_guard.target.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable OCI Defender for Databases for Enhanced Data Protection
  rationale: Enabling Defender for Databases in OCI is crucial for safeguarding sensitive data against unauthorized access and potential breaches. This service provides comprehensive security monitoring and vulnerability management, helping to detect and mitigate risks that could lead to data loss or compliance failures. Ensuring its activation is essential for maintaining compliance with data protection regulations and enhancing the overall security posture.
  description: This rule verifies that the Defender for Databases is activated within Oracle Cloud Infrastructure. It checks the configuration settings to ensure that the necessary security features, such as activity monitoring and vulnerability assessment, are enabled for databases. To remediate, navigate to the Cloud Guard settings in the OCI console and ensure the Defender for Databases is turned on, providing continuous monitoring and protection. This setup helps in the early detection of potential threats and ensures encryption at rest is properly managed.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Concepts/cloud-guard-overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/databasesecurity.htm
  - CIS OCI Benchmark v1.0.0 - Section 3.9
  - NIST SP 800-53 Rev. 5 - Security and Privacy Controls for Information Systems and Organizations
  - ISO/IEC 27001:2013 - Information security management systems
  - https://www.oracle.com/security/cloud-security/database-security.html
- rule_id: oci.cloud_guard.target.ensure_defender_for_dns_is_on
  service: cloud_guard
  resource: target
  requirement: Ensure Defender For Dns Is On
  scope: cloud_guard.target.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure OCI Defender for DNS is Enabled
  rationale: Activating Defender for DNS is crucial as it helps detect and prevent Domain Name System (DNS) attacks, such as DNS hijacking or spoofing, which can lead to unauthorized data access and service disruptions. By ensuring this feature is enabled, organizations can mitigate risks associated with DNS-related threats, aiding in compliance with security standards and protecting sensitive data.
  description: This rule verifies that the Defender for DNS feature is enabled within Oracle Cloud Infrastructure's Cloud Guard. Ensuring this setting is active adds a layer of protection against DNS-related threats by monitoring and alerting on suspicious activities. To verify, navigate to the Cloud Guard dashboard and confirm that Defender for DNS is turned on for all relevant targets. If not enabled, activate it by adjusting the settings within the Cloud Guard configuration. This proactive measure strengthens the security posture and enhances threat detection capabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/defender-for-dns.html
  - https://www.oracle.com/security/cloud-security/oci-cloud-guard/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.cloud_guard.target.ensure_defender_for_keyvault_is_on
  service: cloud_guard
  resource: target
  requirement: Ensure Defender For Keyvault Is On
  scope: cloud_guard.target.security
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure OCI Key Vault Protection with Defender Enabled
  rationale: Enabling Defender for Key Vault in OCI is critical to protect sensitive cryptographic keys and secrets from unauthorized access and potential compromise. It mitigates risks such as data breaches and ensures compliance with regulations like GDPR and PCI-DSS, which mandate stringent security controls for key management. Failure to enable this protection can lead to unauthorized data access, resulting in financial loss and reputational damage.
  description: This rule verifies that Oracle Cloud Infrastructure (OCI) Key Vault has the Defender feature enabled, which provides advanced threat protection and monitoring for key management services. To check, access the Cloud Guard dashboard, navigate to Key Vault settings, and ensure the Defender option is active. Remediation involves enabling Defender by going to the Key Vault's security configuration settings in OCI, selecting the necessary vault, and activating the Defender feature. This action ensures continuous monitoring and threat detection for your key management resources.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keymanagement.htm
  - https://www.oracle.com/security/cloud-security/cloud-guard/
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Tasks/cloud-guard-best-practices.htm
  - CIS OCI Foundations Benchmark
  - 'NIST SP 800-57 Part 1: Recommendation for Key Management'
  - 'PCI-DSS Requirement 3: Protect Stored Cardholder Data'
- rule_id: oci.cloud_guard.target.ensure_defender_for_os_relational_databases_is_on
  service: cloud_guard
  resource: target
  requirement: Ensure Defender For OS Relational Databases Is On
  scope: cloud_guard.target.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable Defender for OS Relational Databases
  rationale: Enabling Defender for OS on relational databases ensures that sensitive data is protected against unauthorized access and potential breaches. This enhances the security posture by providing real-time monitoring and threat detection, reducing the risk of data exfiltration and ensuring compliance with data protection regulations such as GDPR and CCPA.
  description: This rule checks whether the Defender for OS feature is enabled for relational databases within Oracle Cloud Infrastructure. The Defender provides advanced threat detection and automatic application of security patches, significantly mitigating vulnerabilities. To verify, access the Cloud Guard dashboard, review the target configurations for relational databases, and ensure the Defender for OS is active. Remediation involves enabling the Defender through the Cloud Guard settings to maintain continuous security monitoring and threat intelligence.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/defenderforos.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security-cloud-compliance/
  - https://www.oracle.com/cloud/cloud-guard/
  - https://www.oci.com/security-best-practices/
- rule_id: oci.cloud_guard.target.ensure_defender_for_server_is_on
  service: cloud_guard
  resource: target
  requirement: Ensure Defender For Server Is On
  scope: cloud_guard.target.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Oracle Cloud Guard Defender for Server is Enabled
  rationale: Enabling Oracle Cloud Guard Defender for Server protects your compute instances from potential threats by providing advanced threat detection and automated response capabilities. This is crucial for maintaining the integrity and confidentiality of sensitive workloads, reducing the risk of data breaches and ensuring compliance with security standards such as NIST and PCI-DSS. Proactively securing servers helps prevent unauthorized access and data exfiltration, which can result in significant financial and reputational damage.
  description: This rule checks if the Oracle Cloud Guard Defender for Server is enabled on all compute instances within the specified target. To verify, access the Cloud Guard console, navigate to the 'Targets' section, and ensure 'Defender for Server' is activated for each instance. If not enabled, activate it via the console to leverage automated threat detection and response features. This ensures continuous monitoring and protection of server resources against vulnerabilities and attacks.
  references:
  - https://docs.oracle.com/en-us/iaas/cloud-guard/doc/cloud-guard-overview.html
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Tasks/addingtarget.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.oracle.com/cloud/security/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
- rule_id: oci.cloud_guard.target.ensure_defender_for_sql_servers_is_on
  service: cloud_guard
  resource: target
  requirement: Ensure Defender For Sql Servers Is On
  scope: cloud_guard.target.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Oracle Defender for SQL Servers is Enabled
  rationale: Enabling Oracle Defender for SQL Servers is crucial for monitoring security threats and vulnerabilities specific to SQL workloads on OCI. Without it, organizations may face increased risks of unauthorized data access, SQL injection attacks, and data breaches. This control supports adherence to compliance standards such as PCI-DSS and ISO 27001 by ensuring comprehensive security measures are in place.
  description: This rule checks if Oracle Defender for SQL Servers is activated on all SQL server instances within the specified Cloud Guard target. It ensures that security features like threat detection, vulnerability assessment, and advanced data protection are enabled. To verify, navigate to the Cloud Guard dashboard, select the target, and ensure the Defender for SQL Servers feature is turned on. Remediation involves accessing the Cloud Guard settings and activating Defender for SQL Servers for any non-compliant instances.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/CloudGuard/Concepts/cloud_guard.htm
  - https://www.oracle.com/security/cloud-security/cloud-guard/
  - https://www.oracle.com/security/cloud-security/best-practices/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.cloud_guard.target.ensure_defender_for_storage_is_on
  service: cloud_guard
  resource: target
  requirement: Ensure Defender For Storage Is On
  scope: cloud_guard.target.security
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure OCI Defender for Storage is Enabled
  rationale: Enabling Defender for Storage in OCI helps protect against data breaches and unauthorized access by continuously monitoring storage buckets for security threats. Without this, organizations risk exposing sensitive data, which can lead to financial losses, reputational damage, and non-compliance with regulatory standards like PCI-DSS and ISO 27001.
  description: This rule checks if the OCI Defender for Storage is active on all storage targets within your Cloud Guard configurations. It ensures that anomaly detection and threat analysis features are operational, safeguarding stored data. Verification involves accessing the Cloud Guard settings and confirming that the 'Defender for Storage' option is enabled. Remediation steps include navigating to the Cloud Guard dashboard, selecting the appropriate target, and activating the Defender capability.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/cloud-guard-overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/cloud-guard-best-practices.htm
- rule_id: oci.virtual_network.vcn.connection_redundancy
  service: virtual_network
  resource: vcn
  requirement: Connection Redundancy
  scope: virtual_network.vcn.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure VCN Connection Redundancy for High Availability
  rationale: Redundant connections in a Virtual Cloud Network (VCN) prevent single points of failure, enhancing availability and reliability of network services. Without redundancy, a failure in a single connection can lead to significant downtime, affecting business operations and potential loss of revenue. Ensuring connection redundancy aligns with compliance mandates for business continuity and disaster recovery.
  description: This rule checks for the presence of redundant connections within an Oracle Cloud Infrastructure VCN to ensure high availability. To verify, ensure that each VCN has multiple gateways, such as Internet Gateway and NAT Gateway, set up for redundancy. Remediation involves configuring additional gateways and using multiple FastConnect circuits or VPN connections to maintain connectivity even if one path fails.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Troubleshoot/redunconn.htm
  - CIS OCI Foundations Benchmark
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.virtual_network.vnic.virtual_interface_redundancy
  service: virtual_network
  resource: vnic
  requirement: Virtual Interface Redundancy
  scope: virtual_network.vnic.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Redundancy for Virtual Network Interface Cards (VNICs)
  rationale: Redundancy in Virtual Network Interface Cards (VNICs) is critical for maintaining network availability and resilience. A lack of redundancy increases the risk of network disruptions due to hardware failures or maintenance activities, potentially causing downtime and impacting business operations. Ensuring VNIC redundancy aligns with best practices for high availability and is often a requirement in compliance frameworks that stress network reliability.
  description: This rule checks for the presence of redundant configurations in Virtual Network Interface Cards (VNICs) within Oracle Cloud Infrastructure. Ensure that VNICs are configured with multiple redundant paths or interfaces to prevent single points of failure. Verify redundancy by checking configurations in the OCI Console or via OCI CLI. To remediate, configure additional VNICs with necessary routing and failover settings, referring to Oracle's documentation for detailed steps.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingVNICs.htm
  - https://www.oracle.com/cloud-compliance/cis-oci-benchmark.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-iec-27001-information-security.html
- rule_id: oci.identity.user.directory_log_forwarding_enabled
  service: identity
  resource: user
  requirement: Directory Log Forwarding Enabled
  scope: identity.user.logging
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Directory Log Forwarding is Enabled for Users
  rationale: Enabling directory log forwarding for users ensures that all authentication and access activities are recorded, providing crucial data for security audits and incident response. Without log forwarding, suspicious activities might go unnoticed, increasing the risk of unauthorized access and non-compliance with regulatory requirements such as PCI-DSS and SOC2.
  description: This rule checks if directory log forwarding is enabled for user accounts in Oracle Cloud Infrastructure. Log forwarding ensures that all identity-related activities are captured and sent to a centralized logging service, such as Oracle Cloud Logging, for monitoring and analysis. To verify, review the user identity settings and ensure that log forwarding is configured to your logging service. Remediation involves configuring the identity service to forward logs by accessing the OCI console, navigating to Identity > Federation, and ensuring that log forwarding is enabled for the respective user directory.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/configuringdirectorylogforwarding.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/sorhome.html
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
- rule_id: oci.identity.user.supported_mfa_radius_enabled
  service: identity
  resource: user
  requirement: Supported MFA Radius Enabled
  scope: identity.user.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce RADIUS MFA for OCI User Authentication
  rationale: Enabling RADIUS-based Multi-Factor Authentication (MFA) is crucial for safeguarding user accounts against unauthorized access, especially in scenarios where passwords are compromised. This enhances security by requiring an additional verification step, aligning with compliance mandates such as PCI-DSS and ISO 27001, which mandate strong authentication mechanisms to protect sensitive data and systems.
  description: This rule checks whether RADIUS-based MFA is enabled for users in OCI, ensuring that an additional layer of security is in place. RADIUS is a robust protocol for centralized authentication, and its integration with OCI helps enforce strict access controls. To verify, inspect the user authentication settings in the OCI Console under Identity > Users, ensuring RADIUS is configured. Remediation involves configuring RADIUS MFA through the IAM settings and ensuring all users are enrolled and using it for authentication.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingmfa.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/best-practices/
- rule_id: oci.database.db_system.instance_multi_az_enabled
  service: database
  resource: db_system
  requirement: Instance Multi Az Enabled
  scope: database.db_system.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable Multi-AZ for OCI DB Systems for Enhanced Resilience
  rationale: Enabling Multi-AZ for database systems in OCI provides fault tolerance and high availability by distributing instances across multiple availability domains. This setup mitigates the risk of data loss and downtime due to a failure in a single availability domain, which is crucial for maintaining business continuity and meeting compliance requirements for data protection and privacy. Ensuring data is available and resilient aligns with compliance standards such as ISO 27001 and SOC2.
  description: This rule checks whether OCI DB Systems have Multi-AZ enabled, which involves configuring the database instances across multiple availability domains. To verify, inspect the DB System settings in the Oracle Cloud Infrastructure Console and ensure that the 'Availability Domain' option is set to use multiple domains. Remediation involves modifying existing DB Systems or deploying new instances with Multi-AZ configurations to enhance data availability and protection.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/dbac.htm
  - ISO 27001:2013 - A.11.1.4 Location and environmental security
  - SOC 2 Trust Services Criteria - Availability
  - https://www.oracle.com/security/cloud-security.html
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
- rule_id: oci.nosql.table.cluster_monitoring_log_export
  service: nosql
  resource: table
  requirement: Cluster Monitoring Log Export
  scope: nosql.table.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure NoSQL Table Cluster Monitoring Log Export is Enabled
  rationale: Enabling log export for NoSQL table clusters is vital for effective monitoring and auditing. It helps detect unauthorized access, configuration changes, and operational anomalies, which could indicate potential security breaches or compliance violations. This is crucial for maintaining data integrity and meeting regulatory requirements such as GDPR and CCPA.
  description: This rule checks if monitoring logs for NoSQL table clusters are being exported to a designated logging service. To verify, ensure that the NoSQL tables are configured to export cluster activity logs to Oracle Cloud Infrastructure Logging. Remediation involves setting up a log group and ensuring the NoSQL service is configured to export relevant logs to it, facilitating better audit trails and incident response mechanisms.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/NoSQL/Concepts/nosqlmonitoring.htm
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://www.oracle.com/security/cloud-compliance/
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v4/
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://www.nist.gov/cyberframework
- rule_id: oci.nosql.table.cluster_multi_az_enabled
  service: nosql
  resource: table
  requirement: Cluster Multi Az Enabled
  scope: nosql.table.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enable Multi-AZ for NoSQL Table Clusters
  rationale: Enabling Multi-AZ for NoSQL table clusters ensures high availability and fault tolerance, reducing the risk of data loss and service disruption in case of a regional failure. This configuration is crucial for maintaining business continuity and meeting compliance requirements for data redundancy and disaster recovery strategies.
  description: This rule checks whether Multi-AZ is enabled for Oracle NoSQL table clusters, which involves distributing the database instances across multiple availability zones. To verify, inspect the NoSQL table configuration in the OCI console or via CLI for multi-AZ settings. Remediation involves updating the NoSQL table configuration to enable multi-AZ deployment, ensuring data is replicated across multiple zones to enhance resilience.
  references:
  - https://docs.oracle.com/en-us/iaas/nosql-database/doc/using-nosql.html#multi_az
  - https://docs.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.oracle.com/security/cloud-security/capabilities/
- rule_id: oci.nosql.table.cluster_storage_encrypted
  service: nosql
  resource: table
  requirement: Cluster Storage Encrypted
  scope: nosql.table.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure NoSQL Table Cluster Storage Encryption
  rationale: Encryption of NoSQL table cluster storage is vital to protect sensitive data from unauthorized access and potential data breaches. Without encryption, data stored at rest could be exposed to malicious actors, increasing the risk of financial loss and reputational damage. Additionally, many regulatory standards such as PCI-DSS and HIPAA mandate encryption to safeguard personal and financial information.
  description: This rule checks if Oracle NoSQL Database tables have encryption enabled for cluster storage. Encryption at rest can be verified through the Oracle Cloud Infrastructure console under the NoSQL database service settings. If encryption is not enabled, administrators should configure encryption using customer-managed keys (CMK) or Oracle-managed keys to comply with best practices and regulatory standards. Remediation involves accessing the NoSQL table settings and enabling the encryption option for data at rest.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/NoSQL/Concepts/nosqloverview.htm
  - https://www.oracle.com/cloud-security/standards/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.nosql.table.accelerator_cluster_in_transit_encryption_enabled
  service: nosql
  resource: table
  requirement: Accelerator Cluster In Transit Encryption Enabled
  scope: nosql.table.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Accelerator Cluster In-Transit Encryption for NoSQL Tables
  rationale: Enabling in-transit encryption for NoSQL tables is crucial to protect data from interception and unauthorized access during transmission. This is particularly important for sensitive data to prevent data breaches and ensure compliance with regulations like PCI-DSS and HIPAA, which mandate the protection of data in transit. Failure to encrypt data in transit can lead to significant financial and reputational damage.
  description: This rule checks whether in-transit encryption is enabled for Oracle NoSQL Database tables using accelerator clusters. To verify, ensure that the 'In-Transit Encryption' setting is activated for the table configurations in the OCI console. Remediation involves navigating to the NoSQL table settings in the OCI dashboard and enabling in-transit encryption to secure data communications between clients and the database.
  references:
  - https://docs.oracle.com/en-us/iaas/nosql-database/doc/using-oracle-nosql-database.html#GUID-9B3E3A3E-5A3B-4C5D-8F1E-3B9C3B9E7D3F
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/index.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-52r1.pdf
- rule_id: oci.nosql.table.accelerator_cluster_multi_az
  service: nosql
  resource: table
  requirement: Accelerator Cluster Multi Az
  scope: nosql.table.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enable Multi-AZ for Accelerator Cluster in NoSQL Tables
  rationale: Deploying NoSQL tables with Accelerator Clusters across multiple availability zones (AZs) increases data redundancy and resilience against AZ-specific failures. This configuration minimizes the risk of data loss and downtime, which can adversely impact business operations and customer trust. Additionally, it aligns with regulatory expectations for high availability and disaster recovery.
  description: This rule checks if NoSQL tables with Accelerator Clusters are configured to span multiple availability zones, ensuring high availability and fault tolerance. To verify and remediate, review the NoSQL table settings in the Oracle Cloud Console and ensure the 'Availability Domain' setting for the Accelerator Cluster includes multiple AZs. This setup enhances fault tolerance by distributing data and compute resources across distinct zones.
  references:
  - https://docs.oracle.com/en-us/iaas/nosql-database/doc/index.html
  - https://docs.oracle.com/en-us/iaas/Content/BestPractices/NoSQLandBigData.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.nosql.table.table_protected_by_backup_plan
  service: nosql
  resource: table
  requirement: Table Protected By Backup Plan
  scope: nosql.table.backup_recovery
  domain: resilience_and_disaster_recovery
  subcategory: backup_configuration
  severity: medium
  title: Ensure NoSQL Tables are Covered by Backup Plans
  rationale: Ensuring that Oracle NoSQL tables are protected by a backup plan is crucial for maintaining data integrity and availability. Without a backup strategy, data loss due to accidental deletion, corruption, or cyber threats can lead to significant business disruptions and potential regulatory violations, especially in sectors subject to compliance mandates such as PCI-DSS or HIPAA.
  description: This rule verifies that Oracle NoSQL tables have an associated backup plan configured. A robust backup strategy helps in restoring data to a point in time before an incident, minimizing downtime and data loss. To comply, configure automated backups via OCI's NoSQL service that meets your Recovery Point Objectives (RPO) and Recovery Time Objectives (RTO). Regularly review the backup configuration to ensure it aligns with any changes to data usage or compliance requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/NoSQL/using/backup.htm
  - https://www.oracle.com/security-cloud/compliance/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://www.hipaajournal.com/oracle-cloud-hipaa-compliance-guide/
- rule_id: oci.nosql.table.tables_vault_cmk_encryption_enabled
  service: nosql
  resource: table
  requirement: Tables Vault CMK Encryption Enabled
  scope: nosql.table.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable Vault CMK Encryption for NoSQL Tables
  rationale: Enabling encryption with Customer Managed Keys (CMK) enhances data protection by allowing precise control over key management and access. This mitigates the risk of unauthorized data access and complies with data protection regulations such as GDPR and CCPA. It also protects sensitive data from potential breaches and internal misuse, aligning with industry best practices for data integrity and confidentiality.
  description: This rule checks if Oracle NoSQL tables have encryption enabled using Vault Customer Managed Keys (CMK). To verify, ensure that the table's encryption settings are configured to use a CMK from OCI Vault. This involves selecting a CMK during table creation or updating existing tables to apply a CMK via the OCI Console or CLI. Remediation involves configuring or updating the table's encryption settings to integrate with OCI Vault, ensuring that the CMK is active and accessible.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/NoSQL/using/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://learn.microsoft.com/en-us/security/benchmark/oci
- rule_id: oci.artifacts.container_repository.repositories_public_access_blocked
  service: artifacts
  resource: container_repository
  requirement: Repositories Public Access Blocked
  scope: artifacts.container_repository.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Public Access to OCI Container Repositories
  rationale: Restricting public access to OCI Container Repositories is crucial for protecting sensitive container images from unauthorized access, preventing potential data breaches and intellectual property theft. Publicly accessible repositories can be exploited by malicious actors to distribute unauthorized or malicious software, posing a significant threat to the security and integrity of cloud environments. Ensuring repositories are private aligns with compliance requirements such as NIST and ISO 27001, which emphasize the importance of access control and data protection.
  description: This security rule checks if OCI Container Repositories have public access disabled. To verify, ensure that repositories are set to 'private' within the OCI Console under the Artifacts service. Remediation involves navigating to the Artifacts service, selecting the Container Repositories, and configuring the access settings to 'private', thus restricting unauthorized access. Regular audits are recommended to maintain repository security and compliance with industry standards.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/artifacts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/artifacts/managingcontainerimages.htm#ChangeVisibility
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.nist.gov/itl/nist-cybersecurity-framework
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/artifacts-container-security
- rule_id: oci.container_instances.container_instance.task_definitions_logging_block_mode
  service: container_instances
  resource: container_instance
  requirement: Task Definitions Logging Block Mode
  scope: container_instances.container_instance.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure Container Instances Task Definitions Logging Block Mode
  rationale: Enabling logging block mode for task definitions in OCI Container Instances is crucial for capturing comprehensive log data that can be used for forensic analysis in case of security incidents. This helps in identifying unauthorized access or anomaly detection, thus reducing the risk of data breaches. Moreover, it fulfills compliance requirements for standards such as PCI-DSS and ISO 27001, which mandate robust logging practices.
  description: This rule checks whether the task definitions for container instances have logging block mode enabled, ensuring that logs are captured securely and cannot be bypassed. To verify, review the logging configuration in the OCI console under Container Instances settings and ensure that logging block mode is active. If not enabled, navigate to the container instance configuration and update the logging settings to activate block mode, thereby ensuring all log data is captured without omissions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Container/Concepts/containerinstances.htm
  - https://www.oracle.com/security/cspm/
  - https://www.cisecurity.org/cis-benchmarks/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.file_storage.file_system.multi_az_enabled
  service: file_storage
  resource: file_system
  requirement: Multi Az Enabled
  scope: file_storage.file_system.security
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Enable Multi-AZ for OCI File Storage Systems
  rationale: Enabling Multi-AZ (Availability Zone) for file storage systems in OCI enhances data resilience and availability, reducing the risk of data loss due to a regional failure. This setup is essential for maintaining business continuity and meeting compliance requirements for high availability and disaster recovery. It also mitigates the risk of service disruptions, which could lead to significant financial and reputational losses.
  description: This rule checks if OCI file storage systems have Multi-AZ enabled, ensuring data replication across multiple availability zones. To verify, navigate to the file storage service in the OCI console and confirm that the file system is configured for Multi-AZ. Remediation involves updating your file storage configuration to enable Multi-AZ, which can be done by creating a new file system with the Multi-AZ option or modifying existing configurations where applicable. Ensuring Multi-AZ is enabled helps maintain data availability and integrity across different geographical zones.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Tasks/creatingfilesystems.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security/compliance/
- rule_id: oci.file_storage.file_system.public_access_blocked
  service: file_storage
  resource: file_system
  requirement: Public Access Blocked
  scope: file_storage.file_system.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure OCI File System Public Access is Blocked
  rationale: Blocking public access to OCI file systems is crucial to prevent unauthorized data exposure and potential breaches. Publicly accessible file systems can be exploited by malicious actors, leading to data theft or regulatory non-compliance. Ensuring restricted access aligns with compliance standards such as PCI-DSS and ISO 27001, protecting sensitive information and maintaining business integrity.
  description: This rule checks that OCI file systems are not publicly accessible by verifying the file system's access control settings. To ensure public access is blocked, configure Network Security Groups (NSGs) and Virtual Cloud Networks (VCNs) to restrict access only to trusted IPs and users. Remediation involves reviewing access policies, ensuring that no public IPs or wide CIDR ranges are allowed, and auditing these configurations regularly. Utilize the OCI Console or CLI for verification and adjustments.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Tasks/managingfilesystems.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-foundations-benchmark/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm
  - https://www.oracle.com/cloud/security/
- rule_id: oci.container_engine.cluster.cluster_vault_cmk_encryption_in_secrets_enabled
  service: container_engine
  resource: cluster
  requirement: Cluster Vault CMK Encryption In Secrets Enabled
  scope: container_engine.cluster.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable Vault CMK Encryption for OCI Cluster Secrets
  rationale: Ensuring that secrets within Oracle Cloud Infrastructure (OCI) Container Engine clusters are encrypted with a Customer Managed Key (CMK) from the Vault service is critical. This enhances data protection by allowing customers to control key lifecycle and access, reducing risks of unauthorized data access. It helps meet regulatory compliance and protect sensitive information from breach scenarios.
  description: This rule checks if OCI Container Engine clusters have their secrets encrypted using a Customer Managed Key (CMK) from the Vault service. To verify, ensure that the cluster configuration specifies a Vault-enabled CMK for secret encryption. Remediation involves configuring the cluster to use a CMK from the OCI Vault service, ensuring that all secrets stored in the cluster are encrypted at rest. This can be done through the OCI Console or CLI by selecting the appropriate Vault and CMK during cluster setup or update.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengusingvault.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
- rule_id: oci.container_engine.cluster.control_plane_logging_all_types_enabled
  service: container_engine
  resource: cluster
  requirement: Control Plane Logging All Types Enabled
  scope: container_engine.cluster.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Ensure All Control Plane Logging Types Are Enabled for Clusters
  rationale: Enabling all types of control plane logging in OCI's Container Engine for Kubernetes (OKE) is critical for maintaining visibility into cluster operations. This ensures that any unauthorized access or anomalies are quickly detected, reducing the risk of data breaches and system compromises. Compliance mandates, such as those from NIST and PCI-DSS, require detailed logging for auditability, making this practice not only a security best practice but also a regulatory necessity.
  description: This rule verifies that all control plane logging types are enabled for OKE clusters, ensuring comprehensive monitoring of cluster activities. To check this, navigate to the Logging section of the OCI Console and confirm that all log types (API, Audit, etc.) are activated for the control plane. Remediation involves enabling these logs in the OCI Console under the cluster's logging settings, ensuring that critical events are captured and can be audited.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/conteng_bestpractices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.oracle.com/security/cloud-compliance/
- rule_id: oci.redis.cluster.redis_cluster_automatic_failover_enabled
  service: redis
  resource: cluster
  requirement: Redis Cluster Automatic Failover Enabled
  scope: redis.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Redis Cluster Automatic Failover is Enabled
  rationale: Enabling automatic failover in Redis clusters is crucial for maintaining high availability and minimizing downtime, which can lead to business continuity risks and potential data unavailability. Automatic failover helps ensure that if a master node fails, a replica can take over, reducing the impact on applications reliant on the Redis service. This setting supports compliance with business continuity and disaster recovery standards.
  description: This rule checks whether automatic failover is enabled for Redis clusters in Oracle Cloud Infrastructure. Automatic failover configuration is vital for ensuring that the cluster can handle node failures without manual intervention, thus maintaining service availability. To verify, access the Redis cluster settings in the OCI console and ensure that automatic failover is activated. If not enabled, navigate to the Redis service management console and update the cluster configuration to enable automatic failover.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/redisclusters.htm#AutomaticFailover
  - https://www.oracle.com/security-cloud/cis-benchmark.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-34r1.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://cloudsecurityalliance.org/artifacts/cloud-controls-matrix-v3-0-1/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.redis.cluster.redis_cluster_in_transit_encryption_enabled
  service: redis
  resource: cluster
  requirement: Redis Cluster In Transit Encryption Enabled
  scope: redis.cluster.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure In-Transit Encryption for Redis Clusters
  rationale: Enabling in-transit encryption protects data from being intercepted during transfer between client applications and Redis clusters. This is crucial for maintaining data confidentiality and integrity, especially for sensitive information. It mitigates risks associated with man-in-the-middle attacks and eavesdropping, aligning with compliance requirements such as PCI-DSS and HIPAA.
  description: This rule checks that in-transit encryption is enabled for all Redis clusters in OCI. In-transit encryption uses TLS to secure data being transferred, preventing unauthorized access and tampering. To verify, ensure that the 'tls_enabled' configuration parameter is set to true in your Redis cluster settings. Remediation involves updating the cluster configuration and restarting the service to apply changes.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Redis/Tasks/usingredis.htm#encryption
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/
  - https://www.hipaajournal.com/hipaa-compliance-guide/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.redis.cluster.redis_cluster_multi_az_enabled
  service: redis
  resource: cluster
  requirement: Redis Cluster Multi Az Enabled
  scope: redis.cluster.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Enable Multi-AZ for Redis Clusters
  rationale: Enabling Multi-AZ for Redis clusters ensures high availability and resilience against data center failures, reducing the risk of data loss and downtime. This is crucial for maintaining uninterrupted service and meeting business continuity requirements, which can have significant financial implications and affect customer trust. It also aligns with compliance mandates for data redundancy and disaster recovery.
  description: This rule checks if the Redis clusters are configured with Multi-AZ deployment in Oracle Cloud Infrastructure. Multi-AZ setups distribute cluster nodes across multiple availability zones, preventing a single point of failure. To verify, review the cluster configuration settings in the OCI Console and ensure Multi-AZ is enabled. Remediation involves modifying the cluster settings to enable Multi-AZ, which can typically be done via the OCI Console or API.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Redis/Concepts/redishighavailability.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://docs.oracle.com/en-us/iaas/Content/CloudSecurity/Concepts/security_redis.htm
- rule_id: oci.redis.cluster.redis_cluster_rest_encryption_enabled
  service: redis
  resource: cluster
  requirement: Redis Cluster Rest Encryption Enabled
  scope: redis.cluster.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Redis Cluster Encryption at Rest is Enabled
  rationale: Enabling encryption at rest for Redis clusters in OCI protects sensitive data from unauthorized access and potential breaches. This is crucial for maintaining data confidentiality, especially for enterprises handling financial, healthcare, or personal information. Failure to encrypt data at rest can lead to non-compliance with regulations such as PCI-DSS, HIPAA, and GDPR, resulting in legal and financial repercussions.
  description: This rule checks if encryption at rest is enabled for Redis clusters in Oracle Cloud Infrastructure. The encryption should be configured using OCI's built-in encryption capabilities, ensuring that all data stored within the Redis cluster is protected. To verify, navigate to the Redis cluster settings in the OCI Console and confirm that encryption at rest is enabled. If not, update the configuration to enable encryption, leveraging Oracle-managed keys or customer-managed keys in the Vault service for enhanced security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Redis/Concepts/redisencryption.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.load_balancer.load_balancer.internet_facing
  service: load_balancer
  resource: load_balancer
  requirement: Internet Facing
  scope: load_balancer.load_balancer.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Identify and Monitor Internet-Facing Load Balancers
  rationale: Internet-facing load balancers can expose applications to potential external threats, increasing the risk of unauthorized access or data breaches. Monitoring and securing these configurations are crucial to protect sensitive data and maintain compliance with regulatory standards such as PCI-DSS and ISO 27001.
  description: This rule checks for load balancers configured with a public IP address, making them accessible from the internet. Ensure that only necessary services are exposed and that security measures like WAF and proper access controls are in place. Regularly review and update security settings to match current threat landscapes and organizational policies. Remediation involves re-evaluating the necessity of internet exposure and implementing network security groups (NSGs) and security lists to restrict access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Concepts/balanceoverview.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_fundamentals.htm
  - https://www.oracle.com/cloud-security/
- rule_id: oci.load_balancer.load_balancer.is_in_multiple_az
  service: load_balancer
  resource: load_balancer
  requirement: Is In Multiple Az
  scope: load_balancer.load_balancer.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure Load Balancers Are Deployed Across Multiple Availability Domains
  rationale: Distributing load balancers across multiple Availability Domains (ADs) enhances fault tolerance and ensures high availability for applications. This configuration minimizes the risk of downtime due to AD-specific failures, thereby improving the resilience of critical business operations and reducing potential financial and reputational damage.
  description: This rule checks if your Oracle Cloud Infrastructure (OCI) load balancers are configured to span multiple Availability Domains. A load balancer should be set up in at least two ADs to provide redundancy. To verify, use the OCI Console or CLI to inspect the 'Availability Domains' setting under the load balancer's configuration. Remediation involves updating the load balancer settings to include additional ADs, ensuring they are evenly distributed.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Balance/Tasks/managingloadbalancer.htm
  - https://www.oracle.com/cloud/cloud-infrastructure-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.cisecurity.org/benchmark/oracle
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.bds.bds_instance.cluster_account_public_block_enabled
  service: bds
  resource: bds_instance
  requirement: Cluster Account Public Block Enabled
  scope: bds.bds_instance.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure BDS Cluster Public Account Access is Disabled
  rationale: Public access to BDS clusters can expose sensitive data and critical applications to unauthorized users, increasing the risk of data breaches and compliance violations. Enforcing a public access block reduces the attack surface and helps meet regulatory requirements such as PCI-DSS and HIPAA, which mandate controlling access to critical resources.
  description: This rule verifies that the 'Cluster Account Public Block' setting is enabled for Oracle Cloud Infrastructure Big Data Service (BDS) instances. By enabling this setting, the cluster's account access is restricted from the public internet, minimizing potential exposure to unauthorized access. To verify, check the BDS instance configuration in the OCI Console and ensure the 'Public Access' option is set to 'Disabled'. Remediation involves updating the BDS instance settings to disable public access, ensuring all interactions occur through secure, private channels.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/bigdata/home.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/bestpractices.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.bds.bds_instance.cluster_publicly_accesible
  service: bds
  resource: bds_instance
  requirement: Cluster Publicly Accesible
  scope: bds.bds_instance.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure BDS Cluster is Not Publicly Accessible
  rationale: Exposing Big Data Service clusters to the public internet increases the risk of unauthorized access, data breaches, and potential exploitation. This can lead to significant business disruptions, financial loss, and non-compliance with data protection regulations such as GDPR and CCPA. Restricting public access helps maintain data confidentiality and integrity by ensuring that only authorized users within the secure network can interact with the cluster.
  description: This rule checks if the Big Data Service (BDS) cluster is publicly accessible, which means it can be reached over the internet without restrictions. To verify, inspect the network configurations and ensure the cluster is not assigned a public IP address. To remediate, configure the BDS instance to use a private subnet within a Virtual Cloud Network (VCN) and apply security lists or network security groups to restrict inbound traffic. Ensure access is only granted through secure means such as VPN or FastConnect.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/bigdata-data-discovery/home.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm
  - https://www.oracle.com/security/cloud-compliance/iso-27001/
  - https://www.oracle.com/security/cloud-compliance/nist-csf/
- rule_id: oci.identity.policy.conditional_access_policy_require_mfa_for_management_api
  service: identity
  resource: policy
  requirement: Conditional Access Policy Require MFA For Management API
  scope: identity.policy.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce MFA for Management API Access
  rationale: Requiring MFA for accessing the Management API significantly reduces the risk of unauthorized access to critical infrastructure resources, which can lead to data breaches, service disruptions, and financial loss. It is essential for compliance with regulations such as PCI-DSS and ISO 27001 that mandate strong authentication measures to protect sensitive operations.
  description: This rule checks for the presence of a conditional access policy that mandates multi-factor authentication (MFA) for users accessing the OCI Management API. To verify this, ensure that policies are configured to require MFA for all management operations, especially for users with elevated privileges. Remediation involves updating the identity policies to include conditions that enforce MFA for any API access, which can be done using the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org
  - https://csrc.nist.gov/publications/detail/sp/800-63b/final
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.oracle.com/cloud/security/
- rule_id: oci.identity.policy.conditional_access_policy_require_mfa_for_management_app
  service: identity
  resource: policy
  requirement: Conditional Access Policy Require MFA For Management App
  scope: identity.policy.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce MFA for Management Console Access
  rationale: Requiring Multi-Factor Authentication (MFA) for accessing the OCI Management Console significantly reduces the risk of unauthorized access, especially in scenarios where credentials have been compromised. This control helps mitigate threats such as account takeovers and insider threats, and is crucial for meeting compliance requirements like PCI-DSS and NIST SP 800-53, which mandate strong authentication mechanisms.
  description: This rule checks for the existence of a policy enforcing MFA for users accessing the OCI Management Console. To verify, ensure that your identity policies include conditions that require MFA for all users accessing management applications. Remediation involves updating or creating identity policies with conditional statements that enforce MFA. This can be achieved using the OCI Console or the Command Line Interface (CLI) by specifying the 'require-mfa' condition within policy statements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://www.oracle.com/security-cloud/identity-and-access-management/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.oracle.com/cloud/security/
- rule_id: oci.identity.user.non_privileged_user_has_mfa
  service: identity
  resource: user
  requirement: Non Privileged User Has MFA
  scope: identity.user.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure MFA for Non-Privileged Users in OCI
  rationale: Multi-Factor Authentication (MFA) significantly reduces the risk of unauthorized access by requiring additional verification steps beyond just a password. This is vital for non-privileged users who may not have extensive access rights but could still be targeted by attackers to gain a foothold in the system. Enforcing MFA aligns with compliance standards and minimizes the risk of data breaches and unauthorized access to sensitive resources.
  description: This rule checks if MFA is enabled for non-privileged users in Oracle Cloud Infrastructure. Non-privileged users should have MFA configured to enhance their authentication security. To verify, administrators can check the MFA settings in the OCI Console under Identity > Users. Remediation involves enabling MFA for users by navigating to their account settings and setting up a secondary authentication method, such as an authenticator app or SMS verification.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm#EnableMFA
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/cloud/security/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.non_privileged_user_has_mfa_entra
  service: identity
  resource: user
  requirement: Non Privileged User Has MFA Entra
  scope: identity.user.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Enforce MFA for Non-Privileged OCI Users
  rationale: Enforcing multi-factor authentication (MFA) for non-privileged users in OCI is crucial to mitigate unauthorized access risks. It enhances security by requiring an additional verification factor beyond the username and password, reducing the risk of account compromises due to credential theft. This is particularly important in compliance with regulations like PCI-DSS and ISO 27001, which mandate strong authentication measures.
  description: This rule checks if non-privileged users in OCI have MFA enabled, ensuring added security for user accounts. To verify, navigate to the OCI Console, select Identity & Security, then Users, and check the MFA status for each non-privileged user. To remediate, enable MFA for users lacking it by following the MFA setup guide in the OCI documentation. This involves configuring a second factor, such as a mobile authenticator app, to enhance user account protection.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/securityoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/securityfaqs.htm
- rule_id: oci.identity.policy.policy_guest_invite_only_for_admin_roles
  service: identity
  resource: policy
  requirement: Policy Guest Invite Only For Admin Roles
  scope: identity.policy.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Guest Invite Policy to Admin Roles Only
  rationale: Restricting the ability to invite guests to admin roles minimizes the risk of unauthorized access and potential data breaches. Admins possess the necessary knowledge to evaluate security risks associated with guest access, ensuring compliance with regulatory requirements like PCI-DSS and ISO 27001. This control helps prevent privilege escalation and unauthorized resource access, thereby protecting sensitive data and maintaining system integrity.
  description: This rule checks that only users with admin roles can create policies allowing guest invitations in Oracle Cloud Infrastructure. To verify, review policies within the OCI Console under Identity, ensuring that any policy granting guest invite permissions is assigned exclusively to admin roles. Remediation involves updating policy statements to restrict guest invitation capabilities to admins, preventing non-admin roles from creating or modifying such policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - https://www.oracle.com/security-cloud-compliance/cis-oracle-cloud-infrastructure-foundations-benchmark.htm
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.identity.user.policy_user_consent_for_verified_apps_enabled
  service: identity
  resource: user
  requirement: Policy User Consent For Verified Apps Enabled
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enable User Consent for Verified Apps in OCI
  rationale: Enabling user consent for verified applications helps prevent unauthorized access and data breaches by ensuring that users are aware of and approve the applications accessing their data. This practice enhances security by protecting sensitive information and aligns with compliance requirements such as GDPR and CCPA, which emphasize user consent and data protection.
  description: This rule checks whether Oracle Cloud Infrastructure (OCI) is configured to require user consent for verified applications accessing user data. To verify, navigate to the OCI Console, go to 'Identity and Access Management', and ensure that the 'Policy User Consent' setting is enabled for all users. Remediation involves enabling this setting to ensure that users explicitly consent to data access by third-party applications, thereby safeguarding sensitive data.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/userconsent.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.nist.gov/privacy-framework
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.identity.user.privileged_user_has_mfa
  service: identity
  resource: user
  requirement: Privileged User Has MFA
  scope: identity.user.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Require MFA for Privileged Users in OCI
  rationale: Multi-factor authentication (MFA) is crucial for protecting privileged user accounts from unauthorized access, which could lead to data breaches or unauthorized infrastructure modifications. Privileged accounts have elevated permissions and are often targeted by attackers, making them a high-risk asset. Enforcing MFA helps to comply with security standards such as NIST SP 800-63B and PCI-DSS, which mandate strong authentication mechanisms for critical accounts.
  description: This rule checks if all privileged users in Oracle Cloud Infrastructure have MFA enabled. Privileged users are identified by their roles or access levels that grant them significant control over resources and data. To verify, review user settings in the OCI Console under Identity and Access Management, ensuring that MFA status is active for these users. Remediation involves enabling MFA in the user settings and educating users on the importance of MFA for added security.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm#EnableMFA
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-63b/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security.html
  - https://www.oracle.com/cloud/cloud-infrastructure-compliance.html
- rule_id: oci.identity.user.users_cannot_create_microsoft_365_groups
  service: identity
  resource: user
  requirement: Users Cannot Create Microsoft 365 Groups
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict User Ability to Create Microsoft 365 Groups
  rationale: Restricting users from creating Microsoft 365 Groups helps prevent unauthorized access and data leakage by ensuring only designated administrators manage group creation. This reduces the risk of proliferation of unmanaged groups that could lead to unauthorized sharing of sensitive information, aiding in compliance with data protection regulations such as GDPR and CCPA.
  description: This rule checks if users in Oracle Cloud Infrastructure are prevented from creating Microsoft 365 Groups, which can be managed through appropriate IAM policies. To verify compliance, review the IAM policies attached to user groups and ensure they do not include permissions that allow group creation. Remediation involves updating the IAM policy to explicitly deny the 'CreateGroup' action for Microsoft 365, ensuring that only approved roles have this capability.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/compliance/
- rule_id: oci.events.rule.global_endpoint_event_replication_enabled
  service: events
  resource: rule
  requirement: Global Endpoint Event Replication Enabled
  scope: events.rule.replication
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Enable Global Endpoint Event Replication for OCI Events
  rationale: Enabling global endpoint event replication mitigates the risk of data loss and ensures that event data is consistently available across multiple regions, supporting business continuity and disaster recovery strategies. It enhances security by ensuring that event logs are not isolated to a single location, which could be a single point of failure. This is crucial for compliance with regulations requiring data redundancy and availability.
  description: This rule checks whether global endpoint event replication is enabled for OCI Events, which ensures that events are replicated across multiple regions. To verify, navigate to the OCI Console, access the Events service, and confirm replication settings under 'Event Rules'. Remediation involves enabling replication by configuring rule settings to allow event data to be replicated globally. This ensures continuous availability and reliability of event data, critical for audit trails and forensic analysis.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Events/Concepts/eventsoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://www.oracle.com/cloud/cloud-infrastructure/
- rule_id: oci.streaming.stream.stream_encrypted_at_rest
  service: streaming
  resource: stream
  requirement: Stream Encrypted At Rest
  scope: streaming.stream.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure OCI Streams are Encrypted at Rest
  rationale: Encrypting streams at rest is crucial to protect sensitive data from unauthorized access and potential breaches. Unencrypted data can be accessed by attackers if the storage is compromised, leading to data leaks and potential violation of data protection regulations like GDPR and CCPA. Encryption at rest helps ensure compliance with industry standards and enhances the security posture of the organization.
  description: This check verifies that all Oracle Cloud Infrastructure (OCI) streaming resources have encryption enabled at rest. Stream data should be encrypted using Oracle-managed keys to prevent unauthorized access. To enable encryption, ensure that the 'Encrypt Data at Rest' feature is activated in the OCI Streaming service settings. Regularly audit your streaming configurations to confirm compliance and adjust settings through the OCI Console as necessary.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Tasks/streamingencryption.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.file_storage.file_system.file_system_copy_tags_to_backups_enabled
  service: file_storage
  resource: file_system
  requirement: File System Copy Tags To Backups Enabled
  scope: file_storage.file_system.backup_recovery
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: medium
  title: Enable Tag Copying to Backups for File Systems
  rationale: Enabling the copying of tags from file systems to backups ensures that metadata used for organization, cost tracking, and compliance is consistently applied across data assets. This reduces the risk of mismanagement or non-compliance with data governance policies, and facilitates easier recovery and auditing processes. Failure to maintain consistent tagging can lead to increased operational overhead and potential violations of data management regulations.
  description: This rule checks if the 'Copy Tags To Backups' feature is enabled for Oracle Cloud Infrastructure (OCI) File Storage file systems. When enabled, tags applied to the file system are automatically copied to backups, ensuring metadata consistency. To verify and enable this setting, navigate to the OCI Console, access the File Storage service, select the file system, and ensure the 'Copy Tags To Backups' option is activated. Enabling this feature simplifies compliance with tagging policies and enhances data management practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Tasks/usingtags.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oracle-cloud-infrastructure-cis-1-0-0.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.file_storage.file_system.file_system_copy_tags_to_volumes_enabled
  service: file_storage
  resource: file_system
  requirement: File System Copy Tags To Volumes Enabled
  scope: file_storage.file_system.security
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Enable Copy of Tags from File System to Volumes
  rationale: Enabling the automatic propagation of tags from file systems to volumes enhances resource management, cost tracking, and access control. It reduces the risk of misconfigured resources by ensuring consistent metadata application, thereby supporting compliance with data governance policies and improving security monitoring capabilities.
  description: This rule checks if the 'Copy Tags to Volumes' feature is enabled for OCI File Systems, ensuring that all associated volumes inherit the same tags as the parent file system. This configuration is crucial for maintaining consistent metadata across resources, aiding in organized resource management and cost analysis. To enable this feature, navigate to the OCI Console, select File Storage, choose the specific File System, and ensure the 'Copy Tags to Volumes' option is activated. Regularly review and update tags to align with organizational policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Tasks/managingfilesystems.htm
  - https://www.oracle.com/security/cloud-security/cspm.html
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.file_storage.file_system.windows_file_system_multi_az_enabled
  service: file_storage
  resource: file_system
  requirement: Windows File System Multi Az Enabled
  scope: file_storage.file_system.security
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure Multi-AZ Enabled for Windows File Systems
  rationale: Enabling Multi-AZ for Windows File Systems in OCI enhances availability and resilience against regional failures, minimizing potential data loss and downtime. This setup is crucial for business continuity, particularly for enterprises with critical workloads and stringent uptime requirements. It also supports compliance with regulatory standards that mandate high availability for data storage.
  description: This rule checks if Windows File Systems in OCI's File Storage service are configured with Multi-AZ (Availability Domain) support. To verify, ensure that the file system is deployed across multiple availability domains. Remediation involves configuring the file system to span multiple AZs through the OCI console or API, to enhance fault tolerance by distributing resources. This setup is recommended to mitigate risks associated with single-point failures in a specific region.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/File/Tasks/creatingfilesystems.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security/cloud-security.html
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.functions.application.function_restrict_public_access
  service: functions
  resource: application
  requirement: Function Restrict Public Access
  scope: functions.application.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Public Access to OCI Functions
  rationale: Allowing public access to OCI Functions can expose sensitive business logic and data to unauthorized users, leading to potential data breaches or misuse. Restricting access is crucial to mitigate the risk of unauthorized execution, which can lead to compliance violations with standards such as PCI-DSS, GDPR, and NIST. Implementing least privilege access helps in maintaining a secure and controlled environment.
  description: This rule checks that OCI Functions are not publicly accessible via the internet unless explicitly required. Public access should be restricted by configuring appropriate IAM policies and network security groups (NSGs) to allow access only from specific IP addresses or VCNs. To verify, review the network configuration of your functions and ensure only trusted entities have access. Remediation includes updating the policies and NSGs to enforce restricted access, and regularly reviewing access logs for any unauthorized attempts.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Concepts/functionsoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/cloud/cloud-security.html#network
- rule_id: oci.functions.application.function_url_authentication
  service: functions
  resource: application
  requirement: Function Url Authentication
  scope: functions.application.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Function URL Authentication is Enabled
  rationale: Enabling authentication for function URLs in OCI is crucial to prevent unauthorized access and potential data breaches. Unauthorized access can lead to exposure of sensitive data, service disruptions, and increased risk of compliance violations with frameworks such as PCI-DSS and HIPAA. By securing function URLs, organizations protect their business operations and maintain customer trust.
  description: This rule checks if authentication is enabled for Oracle Cloud Infrastructure function URLs. Function URLs without authentication allow public access, posing significant security risks. To verify compliance, review the function's settings in the OCI console to ensure that authentication is enabled. If authentication is not enabled, configure the function's settings to require valid authentication tokens before allowing access, following Oracle's best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Functions/Tasks/functionsaccesscontrol.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam_service.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.object_storage.bucket.vaults_policy_public_access
  service: object_storage
  resource: bucket
  requirement: Vaults Policy Public Access
  scope: object_storage.bucket.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Prevent Public Access to Object Storage Buckets with Vaults Policy
  rationale: Allowing public access to Object Storage buckets that are protected by vaults policy can lead to unauthorized data exposure, impacting confidentiality and compliance. This can result in sensitive data breaches, regulatory fines, and loss of customer trust, especially if sensitive or proprietary information is exposed. Organizations must ensure strict access controls to meet compliance with frameworks like PCI-DSS and ISO 27001.
  description: This rule checks if any Object Storage buckets configured with vaults policy are publicly accessible, which violates secure access controls. Ensure that buckets with vaults policy are set to private by reviewing each bucket's access policies in the OCI console. Remediate by updating the bucket's access settings to limit access to only authorized users or services, using IAM policies to enforce access restrictions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm
  - https://www.oracle.com/security/cybersecurity/cloud-security/
  - https://cloudsecurityalliance.org/research/artifacts/cloud-controls-matrix-v4/
  - https://www.cisecurity.org/benchmark/oracle_cloud
- rule_id: oci.data_catalog.catalog.data_catalogs_connection_passwodatabase_encryption_enabled
  service: data_catalog
  resource: catalog
  requirement: Data Catalogs Connection Passwodatabase Encryption Enabled
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Data Catalog Connections Use Encrypted Passwords
  rationale: Ensuring that passwords used for data catalog connections are encrypted is critical for protecting sensitive information from unauthorized access and potential data breaches. Unencrypted passwords can be intercepted, leading to compromised data integrity and privacy violations, which can result in severe financial and reputational damage, as well as non-compliance with regulations like PCI-DSS and HIPAA.
  description: This rule checks whether password encryption is enabled for connections within Oracle Cloud Infrastructure's Data Catalog service. It requires that all passwords used to connect to data catalogs are encrypted to safeguard data at rest. To verify compliance, review the Data Catalog connection settings in the OCI console and ensure the 'Password Encryption' option is enabled. If not, update the connection settings to enable encryption. This ensures that sensitive credentials are protected against unauthorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/data-catalog/doc/security-best-practices.html
  - https://www.oracle.com/security/cloud-compliance/cis-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hipaajournal.com/hipaa-encryption-requirements/
- rule_id: oci.data_catalog.catalog.data_catalogs_metadata_encryption_enabled
  service: data_catalog
  resource: catalog
  requirement: Data Catalogs Metadata Encryption Enabled
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Data Catalog Metadata Encryption is Enabled
  rationale: Encrypting metadata within OCI Data Catalogs is crucial to protect sensitive information from unauthorized access, data breaches, and compliance violations. Failure to encrypt metadata can lead to exposure of critical business data, resulting in financial loss and reputational damage. It also helps in meeting regulatory requirements such as GDPR, HIPAA, and PCI-DSS, which mandate encryption of sensitive data.
  description: This rule checks if encryption is enabled for metadata in OCI Data Catalogs. Encryption at rest should be configured using OCI's built-in mechanisms to ensure that all catalog metadata is automatically encrypted. Users can verify this by accessing the Data Catalog settings within the OCI console and ensuring that encryption is enabled for all catalog instances. If not enabled, enable encryption through the OCI CLI or console to protect metadata from unauthorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/data-catalog/doc/using-data-catalog.html#GUID-5E3CBAF7-27B4-4E2F-8B8D-5E8C4E3A7D36
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_iam.htm
- rule_id: oci.data_catalog.catalog.data_catalogs_public_access_blocked
  service: data_catalog
  resource: catalog
  requirement: Data Catalogs Public Access Blocked
  scope: data_catalog.catalog.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: critical
  title: Block Public Access to OCI Data Catalogs
  rationale: Allowing public access to OCI Data Catalogs can lead to unauthorized data exposure and potential data breaches. This poses significant security risks, especially for sensitive enterprise data, and could result in non-compliance with regulatory standards such as GDPR and CCPA. Ensuring that data catalogs are not publicly accessible mitigates these risks and helps maintain data integrity and confidentiality.
  description: This rule checks that OCI Data Catalogs do not have public access enabled, which can be verified through the OCI Console by reviewing the Data Catalog's access policies. To remediate, configure IAM policies to restrict access to specific users or groups within the organization. Utilize Oracle Identity and Access Management to define roles and permissions that align with the principle of least privilege, ensuring that only authorized personnel have the necessary access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://www.oracle.com/cloud/cloud-infrastructure/data-catalog/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.data_catalog.catalog.development_endpoints_job_bookmark_encryption_enabled
  service: data_catalog
  resource: catalog
  requirement: Development Endpoints Job Bookmark Encryption Enabled
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable Encryption for Development Endpoints Job Bookmarks
  rationale: Enabling encryption for development endpoints job bookmarks in the Oracle Cloud Infrastructure Data Catalog is crucial to prevent unauthorized access and ensure data integrity. Unencrypted bookmarks could expose sensitive metadata, leading to potential data breaches or unauthorized data manipulation. Compliance with data protection standards such as PCI-DSS and GDPR necessitates the encryption of sensitive data to mitigate risks associated with data exposure.
  description: This rule verifies that encryption is enabled for development endpoints job bookmarks within OCI Data Catalog. Encryption ensures that the metadata and configurations stored as bookmarks are protected at rest. To verify, navigate to the Data Catalog settings in the OCI Console, ensure that the 'Encryption at Rest' feature is enabled for job bookmarks, and configure the necessary encryption keys via the Key Management Service (KMS). If not enabled, configure the encryption settings to use OCI's KMS for secure key management.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_oci_security_policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.data_catalog.catalog.development_endpoints_monitoring_logs_encryption_enabled
  service: data_catalog
  resource: catalog
  requirement: Development Endpoints Monitoring Logs Encryption Enabled
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Encryption for Development Endpoints Monitoring Logs
  rationale: Encrypting development endpoints monitoring logs is crucial to protect sensitive information from unauthorized access and ensure data integrity. Without encryption, logs may expose critical operational details and sensitive data, increasing the risk of data breaches. This measure is essential for compliance with data protection regulations such as GDPR and CCPA, which mandate the protection of personal data.
  description: This rule checks if encryption is enabled for monitoring logs of development endpoints in OCI's Data Catalog service. To verify, ensure that logs are stored in an encrypted format using the Oracle-managed keys or customer-managed keys (CMK) in OCI Vault. Remediation involves configuring the Data Catalog service to enable encryption for logs through the OCI Console or CLI, ensuring that all logs are encrypted at rest to prevent unauthorized access.
  references:
  - https://docs.oracle.com/en-us/iaas/data-catalog/doc/using-catalog.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.oracle.com/security/cloud-data-encryption/
  - https://cloudsecurityalliance.org/research/cloud-controls-matrix/
- rule_id: oci.data_catalog.catalog.development_endpoints_object_storage_encryption_enabled
  service: data_catalog
  resource: catalog
  requirement: Development Endpoints Object Storage Encryption Enabled
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Object Storage Encryption for Data Catalog Development Endpoints
  rationale: Enabling encryption for Object Storage in development endpoints of Oracle Cloud Infrastructure's Data Catalog is critical to protect sensitive data from unauthorized access. This measure mitigates risks associated with data breaches and ensures compliance with regulatory standards such as GDPR and CCPA, which mandate robust data protection practices.
  description: This rule verifies that encryption is enabled for Object Storage used by development endpoints within OCI Data Catalog. Encryption at rest ensures that data stored in Object Storage is safeguarded using strong encryption algorithms. To verify this setting, administrators should check that all Object Storage buckets associated with Data Catalog development environments have encryption enabled. Remediation involves configuring encryption settings via the OCI Console or API to enforce encryption on all relevant storage resources.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm#encryption
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security
- rule_id: oci.data_catalog.catalog.etl_jobs_amazon_object_storage_encryption_enabled
  service: data_catalog
  resource: catalog
  requirement: Etl Jobs Amazon Object Storage Encryption Enabled
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Amazon Object Storage ETL Jobs Encryption in Data Catalog
  rationale: Encrypting ETL jobs data at rest within Amazon Object Storage is crucial to protect sensitive information from unauthorized access and data breaches. This practice mitigates risks associated with data exposure and is often a compliance requirement under regulations such as GDPR and CCPA, ensuring the confidentiality and integrity of data processed in OCI environments.
  description: This rule verifies that ETL jobs interacting with Amazon Object Storage from OCI's Data Catalog have encryption enabled for data at rest. To check compliance, ensure that all data flows into Amazon Object Storage are configured with server-side encryption, using AWS KMS or S3-managed keys. Remediation involves configuring ETL processes to enforce encryption settings, thereby safeguarding data against unauthorized access. Verify settings through the AWS management console or CLI, ensuring encryption parameters are correctly set.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.aws.amazon.com/AmazonS3/latest/userguide/serv-side-encryption.html
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_services
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.data_catalog.catalog.etl_jobs_job_bookmark_encryption_enabled
  service: data_catalog
  resource: catalog
  requirement: Etl Jobs Job Bookmark Encryption Enabled
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure ETL Job Bookmark Encryption is Enabled for Data Catalog
  rationale: Enabling encryption for ETL job bookmarks in OCI Data Catalog ensures that sensitive metadata and job states are protected from unauthorized access or disclosure. Without encryption, there is a risk of data breaches that can lead to significant financial losses, reputational damage, and non-compliance with data protection regulations such as GDPR and CCPA.
  description: This rule verifies that encryption is enabled for ETL job bookmarks in the OCI Data Catalog. To ensure compliance, check that the 'encryptionAtRest' attribute is set to 'true' for all ETL jobs within the catalog. If encryption is not enabled, configure the Data Catalog to use Oracle-managed keys or customer-managed keys in OCI Vault to encrypt job bookmarks. This can be done via the OCI Console or CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataCatalog/Concepts/datacatalogoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.data_catalog.catalog.etl_jobs_monitoring_logs_encryption_enabled
  service: data_catalog
  resource: catalog
  requirement: Etl Jobs Monitoring Logs Encryption Enabled
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure ETL Jobs Monitoring Logs Are Encrypted
  rationale: Encryption of ETL jobs monitoring logs is critical to protect sensitive data from unauthorized access and potential breaches. Unencrypted logs can expose confidential information, leading to data leaks or compliance violations with regulations such as GDPR, HIPAA, and PCI-DSS. Ensuring logs are encrypted at rest mitigates the risk of data exploitation in the event of unauthorized physical or system access.
  description: This rule checks whether ETL jobs monitoring logs within the Data Catalog service are encrypted at rest. Logs should be stored using Oracle-managed keys or customer-managed keys through the OCI Key Management service. To verify, navigate to the Data Catalog settings and ensure the encryption settings for logs are enabled. Remediation involves configuring the Data Catalog to use encryption keys, ensuring all logging data is securely encrypted.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/data-catalog/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.oracle.com/security/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57p2.pdf
- rule_id: oci.data_catalog.catalog.ml_transform_encrypted_at_rest
  service: data_catalog
  resource: catalog
  requirement: Ml Transform Encrypted At Rest
  scope: data_catalog.catalog.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure ML Transform Data is Encrypted at Rest in Data Catalog
  rationale: Encrypting ML transform data at rest is crucial for protecting sensitive information from unauthorized access and data breaches. This is particularly important in industries subject to regulatory frameworks such as PCI-DSS and HIPAA, where data protection is mandatory. Failing to encrypt could result in data leaks, financial penalties, and damage to reputation.
  description: This rule checks that all ML transform data within the Oracle Cloud Infrastructure Data Catalog is encrypted at rest. It requires setting up encryption keys using OCI Key Management to ensure data is secured. Verification involves confirming that encryption is enabled for the data catalog and that the keys used are managed appropriately. Remediation includes configuring the encryption settings through the OCI Console or API and ensuring keys are rotated and stored securely.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/data-catalog/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_guide.htm#Security_Considerations_for_Data_Catalog
  - 'CIS OCI Foundations Benchmark: Section 3.4 - Ensure encryption at rest is enabled'
  - 'NIST SP 800-57: Recommendation for Key Management'
  - 'PCI-DSS Requirement 3.4: Protect stored cardholder data'
  - 'HIPAA Security Rule: Technical Safeguards'
- rule_id: oci.identity.user.custom_role_has_permissions_to_administer_resource_locks
  service: identity
  resource: user
  requirement: Custom Role Has Permissions To Administer Resource Locks
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Custom Role Administering Resource Locks Poses Security Risk
  rationale: Allowing custom roles to administer resource locks can lead to unauthorized modifications, potentially resulting in resource misuse, downtime, or data breaches. This poses a significant security risk by enabling privilege escalation and impacts compliance with frameworks like PCI-DSS and ISO 27001, which require strict access controls. Proper management ensures that only authorized personnel can alter critical configurations, maintaining the integrity and availability of cloud resources.
  description: This rule checks if custom roles have permissions to manage resource locks, which can affect critical resources' state and availability. Administrators should verify that only essential roles possess these privileges by reviewing IAM policies associated with custom roles. Remediation involves updating policies to restrict resource lock administration to trusted roles only, using Oracle Cloud Infrastructure's IAM service to fine-tune access controls effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingresourcelocks.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.identity.user.service_roles_at_project_level_blocked
  service: identity
  resource: user
  requirement: Service Roles At Project Level Blocked
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Block User Service Roles at Project Level
  rationale: Assigning service roles to users at the project level can increase the risk of privilege escalation and unauthorized access to sensitive resources. This practice may inadvertently grant users excessive permissions, leading to potential data breaches or compliance violations. Blocking such configurations helps maintain the principle of least privilege, ensuring users have only necessary access.
  description: This rule verifies that users in OCI are not assigned service roles at the project level, which can lead to broader access than intended. It checks user-role assignments and flags any instances where service roles are applied directly at the project level. To remediate, ensure that service roles are assigned at a more granular level, such as specific compartments or resources, and use dynamic groups and policies for managing permissions. Regular audits and adjustments of user roles are recommended.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingdynamicgroups.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing
  - https://cloudsecurityalliance.org/artifacts/cloud-controls-matrix-v4/
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.pcisecuritystandards.org/
- rule_id: oci.identity.user.sa_no_user_managed_keys
  service: identity
  resource: user
  requirement: Sa No User Managed Keys
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Prohibit User-Managed Encryption Keys
  rationale: Allowing users to manage their own encryption keys can lead to potential security risks such as improper key management, data exposure, and unauthorized access. It is crucial for organizations to control encryption keys centrally to ensure compliance with security policies, reduce the risk of data breaches, and meet regulatory requirements such as PCI-DSS and GDPR.
  description: This rule checks that users are not managing their own encryption keys within OCI. It ensures that all encryption keys are managed by the central security team using OCI Key Management service. To verify, audit user permissions and key management policies. If a user-managed key is detected, reconfigure to use OCI Key Management for secure key storage and access management. Regularly review and update key management policies to align with best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/home.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_platform/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://cloudsecurityalliance.org/research/artifacts/oci-security-practices/
  - https://www.oracle.com/cloud/security/
- rule_id: oci.identity.user.sa_user_managed_key_rotate_90_days
  service: identity
  resource: user
  requirement: Sa User Managed Key Rotate 90 Days
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure User-Managed Keys Rotate Every 90 Days
  rationale: Regular rotation of user-managed keys mitigates the risk of key compromise by limiting the exposure time of compromised keys. This practice aligns with security best practices and regulatory requirements, reducing the risk of unauthorized access to sensitive data. It supports compliance with frameworks like ISO 27001 and PCI-DSS, which emphasize the importance of key management in securing cloud environments.
  description: This check verifies that user-managed keys in Oracle Cloud Infrastructure are rotated every 90 days. Keys that are not rotated within this timeframe may pose a security risk by increasing the likelihood of prolonged unauthorized access if compromised. To remediate, configure your key management policy to enforce automatic rotation or manually rotate keys every 90 days. Monitor key usage and ensure that unused or inactive keys are retired promptly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/keymanagementusing.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
  - https://www.iso.org/isoiec-27001-information-security.html
- rule_id: oci.identity.user.avoid_root_usage
  service: identity
  resource: user
  requirement: Avoid Root Usage
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Minimize Use of OCI Root User for Enhanced Security
  rationale: Using the root user account in Oracle Cloud Infrastructure (OCI) poses significant security risks due to its broad permissions. Compromise of the root user can lead to full account takeover, resulting in potential data breaches, service disruptions, and financial losses. Many regulatory frameworks such as PCI-DSS and ISO 27001 require strict access controls and minimal use of privileged accounts to mitigate such risks.
  description: This rule checks for any non-essential activity performed by the root user in OCI. It is recommended to create individual user accounts with appropriate permissions and use Oracle Identity and Access Management (IAM) policies to grant necessary privileges. Regularly audit root user activities and ensure the root credentials are stored securely. Implement multi-factor authentication (MFA) to add an additional layer of security to the root user account.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/accesscontrol.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_iam.htm
  - CIS OCI Benchmark v1.0.0 - Section 1.1
  - NIST SP 800-53 Rev. 5 - AC-2
  - PCI-DSS Requirement 7
  - https://www.oracle.com/security/cloud-security/best-practices/
- rule_id: oci.identity.user.customer_unattached_policy_no_administrative_privileges
  service: identity
  resource: user
  requirement: Customer Unattached Policy No Administrative Privileges
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Restrict Admin Privileges on Unattached User Policies
  rationale: Unattached user policies with administrative privileges pose a significant security risk, as they can be exploited to gain unauthorized access or make unauthorized changes, potentially leading to data breaches or service disruptions. Ensuring that such policies do not exist helps maintain least privilege and adherence to security frameworks like NIST and PCI-DSS, which require strict control over administrative access.
  description: This rule checks for unattached user policies that grant administrative privileges within OCI. Unattached policies should not have admin rights to prevent unauthorized access. To verify, review the list of unattached policies in the OCI console and ensure none grant admin privileges. If found, immediately delete or adjust the policy to ensure it follows the principle of least privilege. Regular audits and policy reviews are recommended to maintain a secure environment.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-security/cloud-security-controls.html
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.admin_policy_blocked
  service: identity
  resource: user
  requirement: Admin Policy Blocked
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: 'Critical: Admin Policy Blocked for User Accounts'
  rationale: Blocking admin policies for user accounts is crucial to prevent unauthorized access and potential privilege escalation, which could lead to data breaches and non-compliance with regulatory standards such as PCI-DSS and ISO 27001. This control mitigates risks associated with insider threats and unauthorized administrative actions, ensuring the integrity and confidentiality of sensitive data.
  description: This rule checks if user accounts have admin policies that are improperly blocked, which might prevent legitimate administrative tasks while potentially allowing unauthorized access. Ensure that admin policies are correctly configured to allow necessary administrative actions while blocking unauthorized access. Verify through the OCI Console under Identity and Access Management (IAM) policies, ensuring that only necessary admin actions are permitted, and adjust policies as needed to align with security best practices.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.identity.user.guest_accounts_with_permissions_blocked
  service: identity
  resource: user
  requirement: Guest Accounts With Permissions Blocked
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Restrict Guest User Access in OCI Identity
  rationale: Unrestricted guest accounts with permissions pose a significant security threat as they can be exploited by malicious actors to gain unauthorized access to sensitive resources. This can lead to data breaches, compliance violations, and financial losses. Ensuring guest accounts have no permissions reduces the attack surface and helps maintain a secure cloud environment.
  description: This rule checks if guest accounts within OCI Identity are assigned any permissions. Guest accounts should be restricted from having any permissions to prevent unauthorized access. Verify by reviewing user policies and ensuring no IAM policies are attached to guest accounts. Remediation involves removing any existing permissions from these accounts and regularly auditing user roles and permissions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.identity.user.oracle_attached_policy_no_administrative_privileges
  service: identity
  resource: user
  requirement: Oracle Attached Policy No Administrative Privileges
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure Users Lack Direct Administrative Policies
  rationale: Assigning administrative privileges directly to users can lead to unauthorized access and accidental misuse of resources. This increases the risk of data breaches and non-compliance with regulatory requirements such as PCI-DSS and ISO 27001, which mandate the principle of least privilege. By restricting administrative access, organizations reduce the attack surface and enhance their security posture.
  description: This rule checks if any user in OCI has been assigned an Oracle-managed policy that grants administrative privileges. Direct administrative access should be avoided to minimize security risks. Instead, users should be assigned roles with specific permissions needed for their tasks, and administrative control should be managed through groups. To remediate, audit user policies and reassign privileges through groups with controlled policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policygetstarted.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_infrastructure
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam_best_practices.htm
- rule_id: oci.identity.user.password_policy_compliance
  service: identity
  resource: user
  requirement: Password Policy Compliance
  scope: identity.user.policy_management
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure User Password Policy Compliance in OCI
  rationale: Weak password policies can lead to unauthorized access, data breaches, and significant financial and reputational damage to the organization. Enforcing strong password requirements is crucial in mitigating risks of brute force attacks and ensuring compliance with security standards such as NIST SP 800-63 and PCI-DSS. This is particularly important as compromised accounts can serve as entry points for broader network intrusions.
  description: This rule checks whether the password policies for OCI users comply with the organization's security standards. It verifies configurations such as minimum password length, complexity, expiration period, and reuse prohibition. To remediate violations, administrators should configure password policies via the Oracle Cloud Console by navigating to Identity > Domains > Password Policies, ensuring settings align with best practices and compliance requirements. Regular audits and user training on secure password practices are recommended.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm#Password
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf
  - https://www.pcisecuritystandards.org/
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.identity.user.securityaudit_role_created
  service: identity
  resource: user
  requirement: Securityaudit Role Created
  scope: identity.user.audit_logging
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Monitor Creation of Security Audit Role for Users
  rationale: Creating a SecurityAudit role for a user grants access to sensitive audit data, which could be exploited if not properly controlled. Unauthorized access to audit logs can lead to undetected malicious activities, jeopardizing compliance with regulations like PCI-DSS and NIST. Ensuring only authorized users are assigned this role mitigates risks of data breaches and ensures accountability.
  description: This rule checks if the SecurityAudit role is created for a user, ensuring that only authorized personnel have access to audit logs. To verify, review the list of users assigned the SecurityAudit role and ensure it aligns with your organization's access control policy. If unauthorized users have this role, remove it immediately, and conduct a review of recent access to audit logs. Regularly audit role assignments to maintain a secure and compliant environment.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingusers.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
  - https://www.oracle.com/security/cloud-security/cloud-security-compliance/
- rule_id: oci.identity.user.user_group_membership
  service: identity
  resource: user
  requirement: User Group Membership
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Users Have Appropriate Group Memberships
  rationale: Assigning users to appropriate groups in OCI is crucial for enforcing least privilege principles and minimizing the risk of unauthorized access. Misconfigured or excessive group memberships can lead to privilege escalation, data breaches, and non-compliance with regulations like GDPR and HIPAA, which mandate strict access controls.
  description: This rule checks for user accounts in OCI to ensure they are correctly assigned to groups that match their roles and responsibilities. Users should not belong to groups that grant them unnecessary permissions, which could lead to potential security breaches. Review user-group memberships periodically and adjust them to align with current access requirements. Use OCI Identity and Access Management (IAM) policies to manage these memberships effectively.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managinggroups.htm
  - https://www.oracle.com/security/cloud-security/cis-oracle-cloud-infrastructure-foundation-benchmark-v1/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://cloud.oracle.com/iaas
- rule_id: oci.identity.user.user_hardware_mfa_enabled
  service: identity
  resource: user
  requirement: User Hardware MFA Enabled
  scope: identity.user.authentication
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Users Have Hardware MFA Enabled
  rationale: Enabling hardware multi-factor authentication (MFA) for users in Oracle Cloud Infrastructure significantly reduces the risk of unauthorized access by adding a physical authentication factor. This is crucial for protecting sensitive data and maintaining the integrity of critical operations, especially in scenarios where credentials might be compromised. Compliance with security standards such as NIST SP 800-63B and PCI-DSS mandates MFA implementation to safeguard user identities and access management processes.
  description: This rule checks whether users in OCI have hardware MFA enabled, such as using a YubiKey or other FIDO-compliant devices. To verify, ensure that each user account in the identity domain has an associated hardware MFA device configured. Remediation involves enrolling users in an MFA program and distributing approved hardware devices for authentication. Administrators should regularly audit MFA settings to confirm compliance and address any gaps in user authentication configurations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingfactors.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/standard/54534.html
  - https://www.yubico.com/products/yubikey-hardware/
- rule_id: oci.streaming.stream.cluster_encryption_uses_cmk
  service: streaming
  resource: stream
  requirement: Cluster Encryption Uses CMK
  scope: streaming.stream.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Streaming Cluster Encryption Uses Customer-Managed Keys
  rationale: Using Customer-Managed Keys (CMK) for stream encryption enhances control over data security by allowing businesses to manage their encryption keys. This reduces the risk of unauthorized access and supports compliance with regulatory requirements like GDPR and CCPA, which demand stringent data protection measures. It mitigates threats such as data breaches and insider threats by ensuring that decryption keys are not mismanaged.
  description: This rule checks if Oracle Cloud Infrastructure (OCI) Streaming services are configured to use Customer-Managed Keys (CMK) for encryption at rest. Streams should be configured with a Vault key instead of the default service-managed encryption keys to provide enhanced security and control. Verify the encryption settings in the OCI Console under the streaming service configuration. To remediate, navigate to the 'Encryption' section of the stream settings and select a CMK from OCI Vault. Ensure the key is properly managed and rotated regularly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Concepts/streamingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Tasks/streamingencryption.htm
  - 'CIS OCI Foundations Benchmark: https://www.cisecurity.org/benchmark/oracle_cloud'
  - 'NIST SP 800-57: https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final'
  - 'ISO 27001: https://www.iso.org/iso-27001-information-security.html'
- rule_id: oci.key_management.key.key_public_access_blocked
  service: key_management
  resource: key
  requirement: Key Public Access Blocked
  scope: key_management.key.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure OCI Key Management Keys Are Not Publicly Accessible
  rationale: Public access to cryptographic keys poses a severe security risk, potentially allowing unauthorized decryption of sensitive data. Ensuring that keys are not publicly accessible helps mitigate threats like data breaches and unauthorized access, aligning with compliance requirements such as PCI-DSS and ISO 27001, which mandate stringent access controls for cryptographic materials.
  description: This rule checks that all keys in OCI Key Management are configured to prevent public access. Keys should be managed through OCI's Identity and Access Management (IAM) policies, restricting access to authorized users and services only. To verify, review IAM policies and ensure no public access permissions are granted to key compartments. Remediation involves using the OCI Console or CLI to update IAM policies, removing any public access rules, and confirming that keys are accessible only to necessary users and services.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keymanagementoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_benchmark.htm#oci-cis-1.3
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://cloudsecurityalliance.org/artifacts/securing-cloud-key-management-systems/
- rule_id: oci.key_management.key.key_rotation_enabled
  service: key_management
  resource: key
  requirement: Key Rotation Enabled
  scope: key_management.key.key_rotation
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure Key Rotation is Enabled for OCI Key Management
  rationale: Enabling key rotation reduces the risk of key compromise by limiting the time a cryptographic key is active. This is critical for maintaining data confidentiality and integrity, especially in environments that handle sensitive information. Regular key rotation is a best practice for mitigating insider threats and reducing the impact of potential data breaches, and is often required by compliance standards such as PCI-DSS and ISO 27001.
  description: This check verifies that automatic key rotation is enabled for keys managed within OCI Key Management. Key rotation should be configured to occur at regular intervals, ideally every 90 days, to ensure cryptographic security. Users can enable key rotation through the OCI Console by navigating to the key's settings and selecting the 'Automatic Key Rotation' option. Remediation involves setting a key rotation schedule that aligns with your organization's security policy and compliance requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/usingkeys.htm#usingkeys_rotate
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
- rule_id: oci.monitoring.alarm.alert_create_policy_assignment
  service: monitoring
  resource: alarm
  requirement: Alert Create Policy Assignment
  scope: monitoring.alarm.policy_management
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Alarms Have Associated Policy Assignments
  rationale: Properly configured alarms with policy assignments are critical for proactive cloud environment management. Without these assignments, alerts may not trigger necessary automated responses or notifications, leading to delayed awareness of operational issues or security incidents. This can result in non-compliance with industry standards and increased risk of undetected breaches.
  description: This rule checks if alarms within OCI have appropriate policy assignments for handling alert creation. It ensures that each alarm is configured to trigger predefined actions, such as notifications or auto-remediation steps, upon specific events. To verify, review the alarm configurations in the OCI Console and ensure policy assignments are in place. Remediation involves configuring the necessary policies for each alarm to align with organizational security and operational requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Tasks/managingalarms.htm
  - https://www.oracle.com/cloud/cloud-security/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.monitoring.alarm.alert_delete_policy_assignment
  service: monitoring
  resource: alarm
  requirement: Alert Delete Policy Assignment
  scope: monitoring.alarm.policy_management
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Alert on Deletion of Policy Assignments in OCI Alarms
  rationale: Monitoring changes to policy assignments is critical as unauthorized deletions can lead to a lack of alerts which, in turn, might cause crucial operational issues to go unnoticed. This can impact business continuity, risk management, and compliance with frameworks that require audit trails for security events.
  description: This rule checks for the deletion of policy assignments related to OCI alarms. Ensuring that alerts are in place to notify about such deletions helps maintain visibility over policy changes and supports the integrity of your alerting infrastructure. To verify and remediate, enable audit logs for OCI alarm configurations and set up notifications for any changes to policy assignments. Regularly review audit logs to ensure all modifications are authorized.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_iam_policy_reference.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_oci
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
- rule_id: oci.monitoring.alarm.storage_account_with_activity_logs_cmk_encrypted
  service: monitoring
  resource: alarm
  requirement: Storage Account With Activity Logs CMK Encrypted
  scope: monitoring.alarm.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Storage Activity Logs are Encrypted with CMK
  rationale: Encrypting storage account activity logs with a Customer Master Key (CMK) in Oracle Cloud Infrastructure (OCI) protects sensitive log data from unauthorized access and potential breaches. This practice mitigates risks associated with data exfiltration and insider threats, while also aligning with compliance requirements such as PCI-DSS and ISO 27001 that mandate strong encryption controls.
  description: This rule checks that all storage account activity logs in OCI are encrypted using a Customer Master Key (CMK). To verify this, ensure that the log group settings in the monitoring service are configured to use a CMK for encryption. Remediation involves creating a CMK in OCI Key Management and updating the log group settings to use this key. This enhances the security of log data by leveraging advanced encryption techniques.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingkeys.htm
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org/document_library
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
- rule_id: oci.monitoring.alarm.storage_account_with_activity_logs_is_private
  service: monitoring
  resource: alarm
  requirement: Storage Account With Activity Logs Is Private
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Activity Logs in OCI Storage Accounts are Private
  rationale: Keeping activity logs in storage accounts private is crucial for maintaining data confidentiality and integrity. Exposing these logs could lead to unauthorized access, data breaches, and potential compliance violations with standards such as PCI-DSS and HIPAA. Securing log data helps protect against insider threats and external attacks, ensuring sensitive information within logs is not exploited.
  description: This rule verifies that storage accounts containing activity logs are configured as private to prevent unauthorized access. It checks the access policies of storage accounts used for storing OCI Monitoring alarms' activity logs. To ensure compliance, configure these storage accounts to restrict public access and use proper IAM policies to manage access permissions. Remediation involves updating the storage account settings to disable public access and regularly auditing IAM policies for least privilege access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.oracle.com/security-cloud-compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- rule_id: oci.monitoring.alarm.log_group_no_secrets_in_logs
  service: monitoring
  resource: alarm
  requirement: Log Group No Secrets In Logs
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: high
  title: Prevent Secrets Exposure in Monitoring Logs
  rationale: Exposing secrets such as API keys, passwords, or sensitive data in logs can lead to unauthorized access and data breaches. This poses significant business risks, including financial loss, reputational damage, and non-compliance with regulations such as PCI-DSS and ISO 27001, which mandate secure handling of sensitive information.
  description: This rule checks that logs generated by OCI Monitoring Alarms do not contain any secrets or sensitive data. It involves reviewing logging configurations to ensure that sensitive information is not inadvertently logged. Remediation involves configuring logging policies and using Oracle's data masking features to prevent sensitive data from appearing in logs. Regular audits and log reviews should also be conducted to detect and remediate any exposure.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://cloud.oracle.com/security-compliance
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/securelogging.htm
- rule_id: oci.monitoring.alarm.log_group_public_access_blocked
  service: monitoring
  resource: alarm
  requirement: Log Group Public Access Blocked
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: critical
  title: Ensure Log Group Public Access is Blocked for Alarms
  rationale: Enabling public access to log groups poses a critical security risk by potentially exposing sensitive monitoring data to unauthorized entities, leading to data breaches and compliance violations. Restricting access helps protect against unauthorized data exposure, supports data confidentiality, and aligns with regulatory compliance requirements like GDPR and SOC2.
  description: This rule checks that log groups associated with monitoring alarms do not have public access enabled. Ensuring public access is blocked involves configuring IAM policies to restrict access to specific users or groups. To verify compliance, review the effective policies on each log group and ensure no public access permissions are granted. Remediation involves updating IAM policies to enforce least privilege principles and ensuring only authorized users have access.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Monitoring/Concepts/monitoringoverview.htm
  - https://oracle-cloud-infrastructure-cis-benchmark.s3.amazonaws.com/v1.1/Oracle_Cloud_Infrastructure_CIS_Benchmark_v1.1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://cloud.oracle.com/compliance
- rule_id: oci.monitoring.alarm.log_group_retention
  service: monitoring
  resource: alarm
  requirement: Log Group Retention
  scope: monitoring.alarm.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: low
  title: Ensure Proper Retention for OCI Monitoring Logs
  rationale: Proper log retention is crucial for forensic analysis, regulatory compliance, and operational troubleshooting. Inadequate log retention can hinder incident investigations and violate data retention policies, leading to potential fines and a damaged reputation. Ensuring logs are retained appropriately mitigates risks of data loss and non-compliance with standards such as PCI-DSS and ISO 27001.
  description: This rule checks if the OCI Monitoring service's alarms are configured to use log groups with appropriate retention settings. Verify that log groups associated with monitoring alarms have a retention period that meets organizational and regulatory requirements. To remediate, configure log group retention settings in the OCI console under Monitoring > Alarms, ensuring they match your compliance and operational needs.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://cloud.oracle.com/en_US/architecture/cis-oci-foundations-benchmark.pdf
  - https://www.pcisecuritystandards.org
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
- rule_id: oci.streaming.stream.broker_active_deployment_mode
  service: streaming
  resource: stream
  requirement: Broker Active Deployment Mode
  scope: streaming.stream.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Broker Active Deployment Mode in OCI Streaming
  rationale: Active deployment mode in OCI Streaming is crucial for maintaining service availability and data integrity. Misconfigured deployment modes can lead to data loss or service interruptions, impacting business operations and customer trust. Compliance with security frameworks like NIST and ISO 27001 often requires robust data streaming configurations to ensure data protection and continuity.
  description: This check verifies that the OCI Streaming service is configured in Broker Active Deployment Mode, ensuring the brokers are actively managing data flow and redundancy. To verify, inspect the deployment mode setting in the OCI Console under the Streaming service. Remediation involves accessing the stream configuration and enabling active deployment mode, which enhances fault tolerance and data reliability. Consult OCI documentation for step-by-step guidance on modifying stream settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Concepts/streamingoverview.htm
  - CIS Oracle Cloud Infrastructure Foundations Benchmark
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.streaming.stream.broker_cluster_deployment_mode
  service: streaming
  resource: stream
  requirement: Broker Cluster Deployment Mode
  scope: streaming.stream.security
  domain: container_and_kubernetes_security
  subcategory: security_monitoring
  severity: low
  title: Ensure Broker Cluster Deployment Mode is Correctly Configured
  rationale: Incorrect configuration of the Broker Cluster Deployment Mode in OCI Streaming can lead to suboptimal performance and potential security vulnerabilities. Ensuring the deployment mode is correctly set helps in maintaining the integrity and availability of the streaming service, which is critical for real-time data processing applications. Non-compliance may also lead to regulatory issues under frameworks like PCI-DSS and SOC2.
  description: This rule checks if the Broker Cluster Deployment Mode for OCI Streaming is set to the most secure and efficient configuration. It involves verifying that the cluster is deployed in a way that supports high availability and fault tolerance. To remediate, ensure the deployment mode aligns with the recommended settings in the OCI documentation, which can be verified through the OCI Console or API. Incorrect settings should be adjusted to prevent performance degradation and minimize security risks.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Concepts/streamingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Streaming/Tasks/streamingmanaging.htm#streamingmanaging
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.nist.gov/document-800-53
- rule_id: oci.database.autonomous_database.cluster_integration_monitoring_logs
  service: database
  resource: autonomous_database
  requirement: Cluster Integration Monitoring Logs
  scope: database.autonomous_database.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Cluster Integration Monitoring Logs for Autonomous DB
  rationale: Enabling Cluster Integration Monitoring Logs for Autonomous Databases in OCI is essential to track database interactions and integrations, which helps in identifying potential security threats and unauthorized access attempts. It also supports compliance with regulatory standards by maintaining a detailed audit trail of database activities, which is critical for incident response and forensic investigations.
  description: This rule checks if Cluster Integration Monitoring Logs are enabled for Autonomous Databases in OCI. To verify, navigate to the Logging section of the OCI Console and ensure that log groups are configured to capture integration-related events. Remediation involves setting up logging policies and enabling log retention to maintain historical data for security audits, leveraging OCI Logging service capabilities to analyze and alert on suspicious activities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/loggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.1.0.pdf
  - https://www.nist.gov/document-800-53
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/adboverview.htm
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.database.db_system.cluster_multi_az
  service: database
  resource: db_system
  requirement: Cluster Multi Az
  scope: database.db_system.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure DB System Clustering Across Multiple Availability Domains
  rationale: Deploying database systems across multiple availability domains enhances data resilience and availability. This configuration mitigates the risk of data loss or downtime in the event of a failure in a single availability domain. It is crucial for meeting stringent data protection and availability requirements stipulated by compliance frameworks like PCI-DSS and ISO 27001.
  description: This rule checks that database systems are configured to run across multiple availability domains, ensuring high availability and disaster recovery. Verify the DB System configuration in the OCI Console under the 'Availability' section, ensuring the 'Multi-AZ Deployment' option is enabled. To remediate, provision or modify your DB System to span across multiple Availability Domains, leveraging Oracle Data Guard for real-time synchronization and failover capabilities.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/dbhighavailability.htm
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-security/compliance/
- rule_id: oci.database.db_system.cluster_storage_encrypted
  service: database
  resource: db_system
  requirement: Cluster Storage Encrypted
  scope: database.db_system.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Encryption of Cluster Storage in OCI DB Systems
  rationale: Encrypting cluster storage protects sensitive data at rest from unauthorized access and potential breaches. This is crucial for maintaining data confidentiality and integrity, especially for databases that store personal, financial, or proprietary information. Compliance with regulatory standards such as PCI-DSS, HIPAA, and GDPR often mandates strong encryption practices to safeguard data privacy.
  description: This rule checks that all cluster storage associated with Oracle Cloud Infrastructure (OCI) database systems is encrypted using Oracle-managed keys. Verify encryption settings in the OCI Console under the database system's configuration. If encryption is not enabled, update the settings to ensure all data at rest is encrypted. This involves enabling the 'Encryption at Rest' feature which can be configured during the setup of the DB System or by modifying existing settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/managingDBsystem.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloud.oracle.com/iaas/whitepapers/best-practices-for-securing-oci-database.pdf
- rule_id: oci.virtual_network.vcn.bastion_host_configured
  service: virtual_network
  resource: vcn
  requirement: Bastion Host Configured
  scope: virtual_network.vcn.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Bastion Host Configured in OCI VCN
  rationale: A bastion host serves as a secure entry point to your OCI network, mitigating risks associated with unauthorized access. By configuring a bastion host, you limit direct exposure of resources to the internet, reducing potential attack vectors and aligning with security best practices and compliance requirements such as PCI-DSS and ISO 27001.
  description: This check verifies that a bastion host is configured within your OCI Virtual Cloud Network (VCN). A bastion host acts as a jump server, allowing secure remote access to your resources without exposing them directly to the internet. To verify, ensure a Compute instance is set up as a bastion host with appropriate security list rules and SSH access. Remediation involves configuring a bastion host and updating security lists or network security groups to restrict access only to this host.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/bastionhost.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_control_baseline.htm#network_security
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
- rule_id: oci.virtual_network.vcn.watcher_enabled
  service: virtual_network
  resource: vcn
  requirement: Watcher Enabled
  scope: virtual_network.vcn.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure VCN Watcher is Enabled for Network Traffic Monitoring
  rationale: Enabling the Watcher feature on Oracle Cloud Infrastructure Virtual Cloud Networks (VCNs) is crucial for monitoring network traffic and detecting unauthorized access attempts. This helps in identifying and mitigating potential security breaches, ensuring compliance with security frameworks like NIST and PCI DSS which mandate continuous monitoring of network activities.
  description: This rule checks if the Watcher feature is enabled on OCI VCNs to monitor and log network traffic. To verify, navigate to the OCI Console, access the Virtual Cloud Network settings, and confirm that Watcher is active. Enabling Watcher provides visibility into network flows and aids in the early detection of suspicious activities. Remediation involves configuring Watcher through the OCI Console and ensuring it is integrated with your logging and alerting systems.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_iam.htm
- rule_id: oci.network_firewall.network_firewall.in_all_vcn
  service: network_firewall
  resource: network_firewall
  requirement: In All Vcn
  scope: network_firewall.network_firewall.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Deploy Network Firewall in All Virtual Cloud Networks
  rationale: Deploying network firewalls across all Virtual Cloud Networks (VCNs) is crucial for ensuring that traffic is monitored and controlled, mitigating risks such as unauthorized access and data breaches. This practice supports compliance with regulatory standards like PCI-DSS and ISO 27001, which require robust network security controls to protect sensitive data and maintain business trust.
  description: This check ensures that a network firewall is deployed in every VCN within your OCI environment. A network firewall provides essential security features such as traffic inspection, logging, and policy enforcement. To verify, navigate to the OCI Console, check each VCN for an associated network firewall, and configure policies to align with your organization's security requirements. Remediation involves creating and attaching a network firewall to any VCN lacking one, and configuring rules to enforce proper access control.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networkfirewalls.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-41r1.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.network_firewall.network_firewall.multi_az
  service: network_firewall
  resource: network_firewall
  requirement: Multi Az
  scope: network_firewall.network_firewall.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Network Firewalls Span Multiple Availability Domains
  rationale: Deploying network firewalls across multiple availability domains (ADs) enhances fault tolerance and ensures continuity of protection against network threats even during an AD outage. This setup is crucial for maintaining service availability and protecting sensitive data, aligning with business continuity plans and compliance requirements such as PCI-DSS and ISO 27001.
  description: This rule checks if network firewalls are deployed in multiple availability domains to ensure redundancy and high availability. Verify that your OCI network firewall configurations are set to operate across at least two ADs within a region. Remediation involves creating or modifying the network firewall setup to include instances in multiple ADs, thereby reducing risk of single-point failures and ensuring consistent security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networkfirewall.htm
  - https://docs.oracle.com/en-us/iaas/Content/BestPractices/Reference/bestpractices-networksecurity.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- rule_id: oci.nosql.table.global_tables_enabled
  service: nosql
  resource: table
  requirement: Global Tables Enabled
  scope: nosql.table.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Enable Global Tables for Enhanced NoSQL Data Availability
  rationale: Enabling global tables in Oracle Cloud Infrastructure (OCI) NoSQL ensures that your data is replicated across multiple regions, enhancing data availability and fault tolerance. This configuration is crucial for businesses that require high availability and disaster recovery capabilities to meet stringent service level agreements (SLAs) and regulatory requirements such as GDPR or ISO 27001. Without global tables, data might become inaccessible during regional outages, impacting operations and customer trust.
  description: This rule checks whether global tables are enabled for OCI NoSQL tables, ensuring data is replicated across geographically distributed regions. To verify, navigate to the OCI NoSQL console and confirm that global tables are configured and enabled for each table. Remediation involves configuring global tables by selecting target regions and ensuring consistent data replication settings. This step will involve setting up region groups and enabling cross-region replication as per the OCI documentation.
  references:
  - https://docs.oracle.com/en-us/iaas/nosql-database/doc/global-tables.html
  - https://www.oracle.com/security/cloud-security/cis-benchmark/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://cloud.oracle.com/iaas/nosql
  - https://www.oracle.com/cloud/cloud-infrastructure/
- rule_id: oci.ons.topic.topic_subscription_configured
  service: ons
  resource: topic
  requirement: Topic Subscription Configured
  scope: ons.topic.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Ensure ONS Topic Subscription is Configured
  rationale: Configuring subscriptions for Oracle Notification Service (ONS) topics is critical for ensuring that important notifications are delivered to the right endpoints, enabling timely responses to security alerts and operational events. Without proper subscriptions, critical notifications might be missed, leading to delayed incident response and non-compliance with regulatory requirements such as PCI-DSS and SOC2.
  description: This rule checks if ONS topics have at least one subscription configured, ensuring that notifications are routed to designated endpoints like email, SMS, or HTTPS endpoints. To verify this, inspect the ONS topic settings in the OCI console to confirm the presence of active subscriptions. To remediate, navigate to the ONS Console, select the appropriate topic, and add the necessary subscription configurations. Ensure that the endpoints are valid and monitored regularly.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Notification/Concepts/notificationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Notification/Tasks/managingtopicsandsubscriptions.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/soc4so.html
  - https://www.iso.org/standard/54534.html
  - https://www.nist.gov/document-1503-0
- rule_id: oci.object_storage.bucket.storage_bucket_cross_region_replication
  service: object_storage
  resource: bucket
  requirement: Storage Bucket Cross Region Replication
  scope: object_storage.bucket.replication
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Enable Cross Region Replication for Object Storage Buckets
  rationale: Cross-region replication of storage buckets in OCI enhances data availability and durability by automatically replicating objects across multiple geographic locations. This minimizes the risk of data loss due to regional outages, improves disaster recovery capabilities, and can aid in meeting compliance requirements for data redundancy and geographic distribution.
  description: This rule checks if cross-region replication is enabled for Object Storage buckets. By ensuring replication is configured, you facilitate data resilience and business continuity. To verify, navigate to the OCI Console, access the Object Storage service, and inspect the replication settings of each bucket. To enable, configure bucket replication policies specifying the destination region and bucket. Ensure the destination bucket exists and is accessible.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/replicatingobjects.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/cloud/security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.object_storage.bucket.storage_bucket_kms_encryption
  service: object_storage
  resource: bucket
  requirement: Storage Bucket KMS Encryption
  scope: object_storage.bucket.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Object Storage Buckets Use KMS Encryption
  rationale: Encrypting data at rest in Object Storage buckets using KMS protects sensitive information from unauthorized access and data breaches. This is critical for maintaining confidentiality and integrity of data, especially for organizations handling sensitive data subject to regulatory compliance such as GDPR, HIPAA, or PCI-DSS. Failure to encrypt data can lead to severe financial penalties, reputational damage, and loss of customer trust.
  description: This rule checks that all Object Storage buckets in Oracle Cloud Infrastructure are configured to use Key Management Service (KMS) for encryption. By default, OCI Object Storage encrypts data at rest using a system-generated key, but using KMS allows for enhanced control and management of encryption keys. To verify, ensure that buckets are configured with a KMS key in the OCI console under the 'Encryption' settings. Remediate by assigning an appropriate KMS key to buckets lacking this configuration, ensuring keys are rotated regularly and managed securely.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingkms.htm
  - https://www.oracle.com/security/cloud-security/compliance/cis-benchmarks/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57p1r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/key-management/
- rule_id: oci.object_storage.bucket.storage_bucket_lifecycle_enabled
  service: object_storage
  resource: bucket
  requirement: Storage Bucket Lifecycle Enabled
  scope: object_storage.bucket.lifecycle_management
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure OCI Bucket Lifecycle Management is Enabled
  rationale: Enabling lifecycle management for OCI buckets helps mitigate risks such as data sprawl and unauthorized access by automatically managing the lifecycle of objects. This reduces storage costs and enhances compliance with data retention policies, ensuring sensitive data is retained or deleted according to business and regulatory requirements.
  description: This rule verifies that lifecycle management is enabled for OCI object storage buckets, which automates object transitions between different storage classes or deletes them after a specified period. To verify, check the bucket's settings in the OCI Console for lifecycle policies. Remediation involves configuring lifecycle policies to transition or delete objects based on age or other criteria, thereby optimizing storage costs and maintaining compliance.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Storage/Tasks/managinglifecyclepolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.hhs.gov/hipaa/index.html
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.object_storage.bucket.storage_bucket_logging_enabled
  service: object_storage
  resource: bucket
  requirement: Storage Bucket Logging Enabled
  scope: object_storage.bucket.logging
  domain: logging_monitoring_and_alerting
  subcategory: audit_logging
  severity: medium
  title: Enable Logging for OCI Object Storage Buckets
  rationale: Enabling logging for Object Storage buckets provides visibility into access and usage patterns, which is crucial for identifying unauthorized access attempts and maintaining data integrity. Without logging, organizations may face challenges in detecting data breaches or fulfilling compliance obligations such as GDPR, which mandate comprehensive audit trails.
  description: This rule checks whether logging is enabled for Object Storage buckets in OCI, ensuring that all access requests and actions on the bucket are recorded. To verify, navigate to the OCI Console, select the bucket, and check the 'Logging' settings under 'Configuration'. Remediation involves enabling logging by creating a log group and setting the appropriate log configuration for the bucket. This process helps in maintaining an audit trail and facilitates incident response.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm
  - https://www.oracle.com/cloud/cloud-compliance/
  - https://docs.oracle.com/en-us/iaas/Content/security/secure-cloud-compliance.htm
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-92.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.object_storage.bucket.storage_bucket_replication_enabled
  service: object_storage
  resource: bucket
  requirement: Storage Bucket Replication Enabled
  scope: object_storage.bucket.replication
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Enable Replication for OCI Object Storage Buckets
  rationale: Enabling replication for Object Storage buckets in OCI ensures that data is resilient against regional failures, accidental deletions, or corruption, thereby maintaining data availability and integrity. This is crucial for business continuity, as it preserves critical data in the event of unforeseen disasters or systemic outages, and supports compliance with data protection regulations requiring data redundancy.
  description: This rule checks if Object Storage buckets in OCI have replication configured, which automatically copies data to a designated bucket in another region. To verify, access the OCI Console, navigate to Object Storage, and ensure that replication policies are in place for each bucket. Remediation involves setting up a replication policy via the OCI Console or CLI, specifying the target region and bucket, to ensure data is continuously synchronized and protected across locations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingreplication.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/cloud-infrastructure-best-practices/
  - https://www.oracle.com/cloud-compliance/
- rule_id: oci.object_storage.bucket.storage_bucket_versioning_enabled
  service: object_storage
  resource: bucket
  requirement: Storage Bucket Versioning Enabled
  scope: object_storage.bucket.versioning
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Enable Versioning for OCI Object Storage Buckets
  rationale: Enabling versioning for Object Storage buckets is crucial to protect against accidental or malicious data loss by retaining previous versions of objects. This feature provides a safeguard against unintended deletions or overwrites, ensuring data integrity and availability. Regulatory requirements like GDPR and HIPAA may necessitate data retention and versioning as part of data protection strategies.
  description: This check ensures that versioning is enabled on OCI Object Storage buckets, which allows for the preservation, retrieval, and restoration of every version of every object stored in the bucket. To verify, navigate to the OCI Console, select a bucket, and check the 'Versioning' setting is enabled. If versioning is not enabled, configure it under the 'Bucket Details' section by selecting 'Enable Versioning'. This configuration helps in maintaining data resilience and supports compliance with data retention policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/objectversioning.htm
  - https://www.oracle.com/cloud/cloud-infrastructure/compliance/
  - 'NIST SP 800-53 Rev. 5 CP-9: Contingency Planning'
  - CIS OCI Foundations Benchmark v1.1.0, section 3.1
  - https://www.oracle.com/security/cloud-security/
  - ISO/IEC 27001:2013 A.12.3.1 Backup
- rule_id: oci.analytics.analytics_instance.service_domains_fault_tolerant_data_nodes
  service: analytics
  resource: analytics_instance
  requirement: Service Domains Fault Tolerant Data Nodes
  scope: analytics.analytics_instance.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Fault Tolerant Data Nodes in OCI Analytics Service Domains
  rationale: Fault tolerance in data nodes for OCI Analytics ensures continuity and resilience of data services, minimizing the risk of data loss or service disruption during hardware failures. This is crucial for maintaining business operations and protecting sensitive data, aligning with compliance standards like ISO 27001 and PCI-DSS that mandate robust data protection and availability measures.
  description: This rule checks if the data nodes in OCI Analytics Service Domains are configured for fault tolerance, which involves distributing data across multiple nodes to ensure redundancy. Verify that the analytics instance settings enable fault tolerance by using the OCI Console or CLI to inspect the configuration of each data node. To remediate, configure your analytics instance to replicate data across multiple domains, leveraging OCI's built-in fault tolerance features to enhance data resiliency.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticsfaulttolerance.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.analytics.analytics_instance.service_domains_fault_tolerant_master_nodes
  service: analytics
  resource: analytics_instance
  requirement: Service Domains Fault Tolerant Master Nodes
  scope: analytics.analytics_instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Fault Tolerance for Analytics Service Domains
  rationale: Fault-tolerant master nodes in Oracle Cloud Infrastructure's Analytics service ensure the high availability and reliability of analytics workloads. Without fault tolerance, there is a risk of service disruption during hardware failures, which could lead to business downtime, data processing delays, and potential financial losses. Maintaining fault tolerance is also crucial for meeting industry compliance standards that mandate business continuity and disaster recovery capabilities.
  description: This rule checks if the Analytics service instances are configured with fault-tolerant master nodes. A fault-tolerant setup ensures that the failure of one node does not affect the overall availability of the analytics service. Verify the configuration by accessing the OCI Console, navigating to the Analytics service, and ensuring that the 'High Availability' option is enabled. To remediate, adjust the instance configuration to include multiple master nodes, thereby ensuring redundancy and resilience against potential node failures.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticsoverview.htm
  - https://www.oracle.com/cloud/analytics-cloud/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/document/nist-sp-800-53r5pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.iso.org/standard/54534.html
- rule_id: oci.analytics.analytics_instance.service_domains_internal_user_database_enabled
  service: analytics
  resource: analytics_instance
  requirement: Service Domains Internal User Database Enabled
  scope: analytics.analytics_instance.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Enable Service Domains Internal User Database in Analytics Instances
  rationale: Enabling the Service Domains Internal User Database in OCI Analytics Instances enhances security by ensuring that only authenticated and authorized users can access sensitive analytics data. This reduces the risk of unauthorized data access, which could lead to data breaches and compromise business intelligence. Compliance with regulations such as GDPR and ISO 27001 mandates strict control over data access, making this configuration essential for businesses handling sensitive information.
  description: This rule checks if the Service Domains Internal User Database is enabled for OCI Analytics Instances, which is crucial for managing user identities and access control within the analytics environment. To verify this setting, navigate to the OCI Analytics console, access the security settings of your analytics instance, and ensure the internal user database option is enabled. If it is not enabled, modify the instance settings to activate it. This configuration helps enforce identity and access management policies, ensuring that only legitimate users have access to analytics services.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Concepts/analyticssecurity.htm
  - https://cloudsecurityalliance.org/artifacts/oracle-cloud-cis-benchmark/
  - https://www.nist.gov/itl/applied-cybersecurity/nist-cybersecurity-framework
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Reference/analytics_api.htm
- rule_id: oci.analytics.analytics_instance.service_domains_public_access_blocked
  service: analytics
  resource: analytics_instance
  requirement: Service Domains Public Access Blocked
  scope: analytics.analytics_instance.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Block Public Access to OCI Analytics Service Domains
  rationale: Unrestricted public access to OCI Analytics service domains can lead to unauthorized data exposure and potential breaches. This risk is exacerbated by the sensitivity of the analytics data, which might include proprietary business insights. Blocking public access is crucial for maintaining data integrity, meeting regulatory standards such as PCI-DSS and HIPAA, and preventing unauthorized access.
  description: This rule checks if the OCI Analytics instances are configured to prevent public access to their service domains. It ensures that only trusted networks and users can interact with the analytics services by verifying that the 'Allow Public Access' setting is disabled. To remediate, administrators should configure the networking policies to restrict access to private IP addresses and use IAM policies to control user access. Verification can be done via the OCI Console by reviewing the analytics instance settings under the 'Access Management' section.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Analytics/Tasks/analyticsaccesscontrol.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/
  - https://www.hhs.gov/hipaa/for-professionals/index.html
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
- rule_id: oci.identity.tag_namespace.tags_policies_enabled_and_attached
  service: identity
  resource: tag_namespace
  requirement: Tags Policies Enabled And Attached
  scope: identity.tag_namespace.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Tag Policies are Enabled and Attached in OCI
  rationale: Tag policies in OCI are crucial for maintaining a structured and governed resource management strategy. Without proper tag policies, organizations face risks like inefficient resource tracking, increased operational costs, and non-compliance with regulatory standards that require resource accountability and auditability.
  description: This rule checks whether tag namespaces in OCI have appropriate tag policies enabled and attached, ensuring that all resources are tagged according to organizational policy. To verify, review the tag namespace settings in the OCI Console under Identity & Security. Remediation involves enabling and attaching tag policies to namespaces, ensuring consistent application of organizational tagging standards across all resources.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Tagging/Concepts/taggingoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Tagging/Tasks/managingtagsandc.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.compute.instance.managed_instance_compliant
  service: compute
  resource: instance
  requirement: Managed Instance Compliant
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Compute Instances Are Managed and Compliant
  rationale: Unmanaged compute instances can lead to security vulnerabilities, increased operational risk, and potential non-compliance with regulatory requirements. Managed instances help ensure that security patches and updates are applied in a timely manner, reducing the attack surface and maintaining system integrity. Ensuring compliance with management policies also supports adherence to industry standards such as PCI-DSS, NIST, and ISO 27001.
  description: This rule checks whether compute instances in your OCI environment are managed through Oracle Cloud Agent to ensure compliance with security and operational policies. Technical settings involve verifying that the Oracle Cloud Agent is installed and enabled on instances, which facilitates automated updates and patch management. To remediate, ensure that the Oracle Cloud Agent is correctly configured and actively monitoring the instance. This can be verified through the OCI Console under the Compute Instance details page, where the agent status is displayed.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/manageinstances.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_guide.htm#managed_instances
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.identity.user.ensure_asc_enforcement_enabled
  service: identity
  resource: user
  requirement: Ensure Asc Enforcement Enabled
  scope: identity.user.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Ensure Ascending Control (ASC) Policies are Enforced for Users
  rationale: Enforcing Ascending Control (ASC) policies for OCI users helps mitigate unauthorized access by ensuring that users adhere to predefined security protocols. This reduces the risk of security breaches and data exfiltration, aligning with compliance requirements such as PCI-DSS and ISO 27001, which mandate strict access controls and monitoring.
  description: This rule checks if Ascending Control (ASC) enforcement is enabled for all users within your OCI identity domain. ASC policies enforce strict authentication and authorization protocols, ensuring users are validated against established security criteria. To verify, navigate to the OCI console, access the Identity and Access Management settings, and ensure ASC policies are applied to user accounts. If not enabled, configure ASC policies to include strong authentication methods and regular access reviews.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/policies.htm
  - https://www.oracle.com/security/cloud-security/cis-oci-benchmark/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://www.oracle.com/cloud/security/best-practices/
- rule_id: oci.mysql.db_system.flexible_server_allow_access_services_disabled
  service: mysql
  resource: db_system
  requirement: Flexible Server Allow Access Services Disabled
  scope: mysql.db_system.security
  domain: identity_and_access_management
  subcategory: authentication
  severity: medium
  title: Disable Unnecessary Access Services on MySQL Flexible Servers
  rationale: Allowing access services on MySQL Flexible Servers can expose sensitive data to unauthorized entities, increasing the risk of data breaches and non-compliance with regulations like PCI-DSS and GDPR. Disabling unnecessary services reduces the attack surface, mitigates potential vulnerabilities, and ensures that database access is restricted to intended applications or users, enhancing overall security posture.
  description: This rule verifies that access services on MySQL Flexible Servers are disabled unless explicitly required for operational purposes. To comply, ensure that only essential services are enabled by auditing current service configurations through OCI Console or using CLI commands. Remediation involves disabling non-essential services and validating configurations against security policies. Regular reviews and updates to service settings are recommended to maintain compliance and security.
  references:
  - https://docs.oracle.com/en-us/iaas/mysql-database/doc/security-mysql.html
  - https://www.oracle.com/security-alerts/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
- rule_id: oci.virtual_network.vnic.ip_attached
  service: virtual_network
  resource: vnic
  requirement: Ip Attached
  scope: virtual_network.vnic.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure VNICs Have Associated IP Addresses
  rationale: Having IP addresses properly attached to VNICs is crucial for maintaining network connectivity and enabling secure communication between resources. Unattached IPs can lead to resource misconfigurations, potential service downtime, and increased vulnerability to unauthorized access. Properly configured network interfaces are vital for compliance with security frameworks such as NIST and PCI-DSS, ensuring data integrity and confidentiality.
  description: This rule verifies that every VNIC in your OCI environment has an IP address attached, ensuring that network interfaces are configured correctly to allow secure communication. To verify, check the VNIC settings in the OCI Console or via the CLI to ensure an IP address is present. Remediation involves attaching an appropriate IP address to any VNICs missing this configuration, using the OCI Console or CLI commands.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingvnics.htm
  - https://www.oracle.com/security/cloud-compliance/cis-benchmarks.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.database.cluster.cluster_encrypted_at_rest
  service: database
  resource: cluster
  requirement: Cluster Encrypted At Rest
  scope: database.cluster.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure OCI Database Clusters are Encrypted at Rest
  rationale: Encrypting database clusters at rest safeguards sensitive data from unauthorized access, reducing the risk of data breaches. This is crucial for maintaining customer trust and meeting regulatory compliance requirements such as GDPR and PCI-DSS, which mandate data protection measures. Failure to encrypt data can lead to significant financial penalties and reputational damage.
  description: This rule checks if Oracle Cloud Infrastructure (OCI) database clusters are configured to encrypt data at rest using OCI's built-in encryption capabilities. Encryption should be enabled by default on all database clusters to protect data stored on disk. Administrators can verify encryption settings through the OCI Console or CLI by inspecting the database cluster's configuration. To remediate, ensure that the 'Encryption at Rest' option is enabled during the creation of a database cluster or update the existing configuration to include encryption.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/databaseoverview.htm
  - https://www.oracle.com/security/cis-benchmark/
  - https://www.nist.gov/cyberframework
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.oracle.com/cloud/security/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.database.cluster.cluster_enhanced_vcn_routing
  service: database
  resource: cluster
  requirement: Cluster Enhanced Vcn Routing
  scope: database.cluster.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Cluster Enhanced VCN Routing is Enabled
  rationale: Enabling enhanced VCN routing for database clusters ensures secure and efficient network traffic management, reducing the risk of data interception or exposure. It supports compliance with data protection regulations by enforcing network security policies and minimizing attack surfaces. This configuration helps prevent unauthorized access and potential data breaches, thereby protecting sensitive information and maintaining business integrity.
  description: This rule checks if enhanced VCN routing is enabled for Oracle Cloud Infrastructure database clusters. Enhanced VCN routing allows for more granular control over network traffic, ensuring that data is securely routed through designated network paths. To verify, review the cluster's network settings in the OCI Console and ensure that enhanced VCN routing is configured. Remediate by updating the cluster's network configurations to enable this feature, which can be done via the OCI Console or the OCI CLI.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.oracle.com/security/cis-benchmark.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hipaajournal.com/hipaa-security-rule/
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.database.cluster.cluster_multi_az_enabled
  service: database
  resource: cluster
  requirement: Cluster Multi Az Enabled
  scope: database.cluster.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Enable Multi-AZ for OCI Database Clusters
  rationale: Enabling Multi-AZ for database clusters enhances data availability and resilience by distributing resources across different availability domains. This minimizes the risk of data loss and downtime caused by localized failures or disasters, thus protecting critical business operations and ensuring compliance with data protection regulations such as GDPR and PCI-DSS.
  description: This rule checks if the database clusters are configured to use Multi-AZ deployments in Oracle Cloud Infrastructure. To verify, ensure that the database cluster's configuration spans multiple availability domains. Remediation involves adjusting database configurations to enable Multi-AZ, which can be done through the OCI Console or CLI by selecting the appropriate option during cluster setup or modification.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Database/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/using-clusters.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.pcisecuritystandards.org/pci_security/standards_overview
- rule_id: oci.data_science.model_deployment.endpoint_config_prod_variant_instances
  service: data_science
  resource: model_deployment
  requirement: Endpoint Config Prod Variant Instances
  scope: data_science.model_deployment.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Model Deployment Endpoint Config Uses Encrypted Instances
  rationale: Encrypting data at rest for model deployments in OCI Data Science is crucial for protecting sensitive information from unauthorized access and potential breaches. This measure mitigates risks such as data leaks, unauthorized data manipulation, and ensures compliance with data protection regulations like GDPR and CCPA. Failure to implement encryption can result in financial penalties, loss of customer trust, and damage to an organization's reputation.
  description: This rule checks whether the instances specified in the production variant of a model deployment's endpoint configuration are using encryption at rest. To verify, ensure that OCI Block Volumes attached to these instances are configured with encryption enabled. Remediation involves updating the block volumes or selecting instances that have encryption enabled by default. Utilize OCI's console or CLI to configure the necessary encryption settings.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Tasks/encryptingvolumes.htm
  - https://www.oracle.com/security/cloud-security/cspm/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.oracle.com/cloud/sensitive-data-protection/
- rule_id: oci.data_science.model.models_vcn_settings_configured
  service: data_science
  resource: model
  requirement: Models Vcn Settings Configured
  scope: data_science.model.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Data Science Models Use Configured VCN Settings
  rationale: Configuring Virtual Cloud Network (VCN) settings for data science models is crucial to protect sensitive data during model training and deployment. Misconfigured or unprotected network settings can expose models to unauthorized access, leading to data breaches or loss of intellectual property. Compliance with data protection regulations such as GDPR and CCPA may require secure network configurations to safeguard personal and sensitive data.
  description: This rule checks if data science models in Oracle Cloud Infrastructure have correctly configured VCN settings, ensuring secure communication paths. Technical details include verifying the model's associated VCN settings to ensure they are not left in a default or open state. Remediation involves specifying a secure VCN and subnet, employing network security groups, and ensuring all traffic is properly monitored and logged. Regularly review and update these configurations to adapt to evolving security requirements.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/oci-best-practices/
- rule_id: oci.data_science.notebook_session.notebook_instance_vcn_settings_configured
  service: data_science
  resource: notebook_session
  requirement: Notebook Instance Vcn Settings Configured
  scope: data_science.notebook_session.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Notebook Instance VCN Settings are Configured
  rationale: Properly configured VCN settings for notebook instances are critical to protect sensitive data from unauthorized network access and potential data breaches. Misconfigured VCN settings can expose data science resources to public internet access, increasing the risk of exploitation by malicious actors. Ensuring these settings aligns with compliance requirements such as NIST and ISO 27001, thereby mitigating data protection and privacy risks.
  description: This rule checks whether Oracle Cloud Infrastructure Data Science notebook sessions have their Virtual Cloud Network (VCN) settings correctly configured, ensuring that they are not exposed to unauthorized networks. It requires setting up appropriate security lists and network security groups to control traffic access. To verify, access the OCI Console, navigate to Data Science Notebook Sessions, and review the network settings. Remediate by assigning the notebook instance to a private VCN with strict ingress and egress rules.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/data_science_security.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.nist.gov/cyberframework
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
- rule_id: oci.data_science.job.training_jobs_intercontainer_encryption_enabled
  service: data_science
  resource: job
  requirement: Training Jobs Intercontainer Encryption Enabled
  scope: data_science.job.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable Intercontainer Encryption for Data Science Training Jobs
  rationale: Intercontainer encryption ensures that data exchanged between containers during training jobs is protected from unauthorized access, mitigating risks of data breaches and ensuring compliance with data protection regulations such as GDPR and CCPA. This is critical for maintaining the confidentiality and integrity of sensitive training datasets, which could include proprietary information or personal data.
  description: This rule checks if encryption is enabled for data exchanged between containers in OCI Data Science training jobs. To verify compliance, ensure that intercontainer communication within training jobs is configured to use encryption. Remediation involves enabling encryption settings in the OCI console for your data science job configurations, which helps protect data in transit and aligns with best practices for secure machine learning operations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Concepts/datascienceoverview.htm
  - https://www.oracle.com/security/cloud-security/cloud-compliance/
  - https://www.oracle.com/security/cloud-security/
  - 'NIST SP 800-53: SC-13 Cryptographic Protection'
  - ISO/IEC 27001:2013 A.10.1.1 Policy on the Use of Cryptographic Controls
- rule_id: oci.data_science.job.training_jobs_vcn_settings_configured
  service: data_science
  resource: job
  requirement: Training Jobs Vcn Settings Configured
  scope: data_science.job.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Configure VCN Settings for Data Science Training Jobs
  rationale: Proper configuration of VCN settings for OCI Data Science Training Jobs is crucial to secure the data flow and prevent unauthorized access. It ensures data protection by controlling network traffic, which mitigates risks such as data breaches and unauthorized data exfiltration. Adhering to regulatory requirements like PCI-DSS and HIPAA is essential to maintain compliance and avoid potential legal and financial penalties.
  description: This rule checks that OCI Data Science Training Jobs have appropriate VCN settings configured to ensure secure communication within the Oracle Cloud Infrastructure. It involves verifying that the training jobs are associated with a correctly configured Virtual Cloud Network (VCN) and subnet, and that security lists or network security groups (NSGs) are applied. To remediate, ensure that the Data Science Training Jobs are deployed in a VCN with restricted access through security lists or NSGs, allowing only necessary traffic and employing encryption for data in transit.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Reference/datasciencepolicies.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundation
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.hipaajournal.com/hipaa-compliance-requirements/
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-44ver2.pdf
- rule_id: oci.data_science.job.training_jobs_volume_and_output_encryption_enabled
  service: data_science
  resource: job
  requirement: Training Jobs Volume And Output Encryption Enabled
  scope: data_science.job.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Data Science Job Encryption for Training Volumes and Outputs
  rationale: Encrypting the volumes and outputs of training jobs in OCI Data Science protects sensitive data from unauthorized access and potential breaches. This is crucial for maintaining data confidentiality and integrity, particularly when dealing with proprietary algorithms or personally identifiable information (PII). Adhering to encryption standards helps organizations meet compliance requirements such as GDPR, HIPAA, and ISO 27001, mitigating the risk of financial penalties and reputational damage.
  description: This rule checks whether encryption is enabled for the volumes and outputs of Data Science training jobs in OCI. Specifically, it verifies that encryption at rest is configured using Oracle-managed keys or customer-managed keys (CMKs) to secure job data. To enable encryption, users should ensure that the default encryption settings in the OCI Data Science service are configured correctly, and that any custom encryption requirements are fulfilled by specifying CMKs. Remediation involves enabling encryption through the OCI Console or CLI and verifying the encryption status in the job specifications.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/DataScience/Tasks/datascienceworkingenvironments.htm#encryption
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm#encryption
  - 'NIST SP 800-57: Guidelines for Key Management'
  - ISO 27001:2013 - A.10.1 Cryptographic Controls
  - 'GDPR Article 32: Security of processing'
  - 'HIPAA Security Rule: Technical Safeguards'
- rule_id: oci.resource_manager.stack.portfolio_shared_within_organization_only
  service: resource_manager
  resource: stack
  requirement: Portfolio Shared Within Organization Only
  scope: resource_manager.stack.security
  domain: compliance_and_governance
  subcategory: security_monitoring
  severity: low
  title: Restrict Stack Portfolio Sharing to Organization
  rationale: Restricting stack portfolio sharing within an organization mitigates the risk of unauthorized access and potential data breaches. It helps maintain control over who can view and modify infrastructure configurations, reducing the likelihood of misconfigurations and ensuring compliance with internal policies and regulatory mandates such as NIST and ISO 27001.
  description: This rule checks if stack portfolios in Oracle Cloud Infrastructure's Resource Manager are shared exclusively within the organization. It verifies that access permissions are not granted to external entities, minimizing exposure to unauthorized users. To verify, inspect the stack's access policies and ensure they are limited to organizational groups. Remediation involves reviewing and adjusting IAM policies to restrict sharing to internal users only.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/ResourceManager/Tasks/managingstacksandjobs.htm
  - https://www.oracle.com/cloud/security/compliance/
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.ons.topic.topics_public_access_blocked
  service: ons
  resource: topic
  requirement: Topics Public Access Blocked
  scope: ons.topic.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Ensure ONS Topics Public Access is Blocked
  rationale: Allowing public access to Oracle Notification Service (ONS) topics can expose sensitive messaging data to unauthorized users, leading to potential data breaches and non-compliance with data protection regulations like GDPR and HIPAA. Blocking public access mitigates the risk of unauthorized data access and ensures that only authenticated and authorized users can interact with ONS topics, preserving the confidentiality and integrity of the communication channels.
  description: This rule checks that ONS topics are configured without public access to prevent unauthorized users from subscribing to or publishing messages. Public access can be verified and controlled through the OCI Console by checking the Access Control List (ACL) settings for each ONS topic. Remediation involves reviewing topic permissions and ensuring that only specific, trusted IAM groups or compartments have access, effectively blocking any public or anonymous access. It is recommended to regularly audit these settings to ensure compliance with organizational security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Notification/Concepts/notificationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Notification/Tasks/managingtopicsandsubscriptions.htm
  - https://www.oracle.com/cloud/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- rule_id: oci.ons.topic.topics_vault_encryption_enabled
  service: ons
  resource: topic
  requirement: Topics Vault Encryption Enabled
  scope: ons.topic.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable Vault Encryption for ONS Topics
  rationale: Enabling vault encryption for Oracle Notification Service (ONS) topics ensures that sensitive data in transit and at rest is protected from unauthorized access. Without encryption, data breaches can lead to significant financial loss, reputational damage, and non-compliance with regulations such as GDPR, PCI-DSS, and HIPAA, which require robust data protection measures.
  description: This rule checks if Oracle Notification Service (ONS) topics have encryption enabled using Oracle Vault. Ensuring that topics are encrypted protects the confidentiality and integrity of data transmitted across services. To verify, navigate to the OCI Console, go to ONS settings, and check if encryption is enabled with an appropriate vault key. Remediation involves configuring the ONS topic to use a Customer-Managed Key (CMK) stored in Oracle Vault.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Notification/Concepts/notificationoverview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security.htm#Security
  - https://cloudsecurityalliance.org/artifacts/cloud-controls-matrix-v3-0-1/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- rule_id: oci.queue.queue.queues_public_access_blocked
  service: queue
  resource: queue
  requirement: Queues Public Access Blocked
  scope: queue.queue.public_access
  domain: identity_and_access_management
  subcategory: authentication
  severity: critical
  title: Block Public Access to OCI Queues
  rationale: Allowing public access to OCI queues can lead to unauthorized data exposure and potential misuse of queue resources, impacting business operations and violating data protection regulations. It poses a critical security risk, allowing malicious actors to inject or retrieve messages, leading to data breaches and operational disruptions. Ensuring queues are not publicly accessible aligns with compliance mandates like PCI-DSS and ISO 27001, safeguarding sensitive information.
  description: This rule verifies that OCI queues are configured to block public access, ensuring only authorized users within the OCI tenancy can interact with the queue. To verify, check the queue's Access Policy in the OCI Console to ensure no policies grant public access. Remediation involves adjusting IAM policies to restrict access to authenticated principals only. Implement network security groups or security lists to further control access at the network level, enhancing security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Queues/Concepts/queuesoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.oracle.com/security/cloud-security/
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingpolicies.htm
- rule_id: oci.queue.queue.queues_server_side_encryption_enabled
  service: queue
  resource: queue
  requirement: Queues Server Side Encryption Enabled
  scope: queue.queue.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Enable Server-Side Encryption for OCI Queues
  rationale: Enabling server-side encryption for OCI queues ensures data protection and confidentiality by encrypting messages stored in the queue. This mitigates the risk of unauthorized data access, which can lead to data breaches and compliance violations. It is crucial for meeting regulatory requirements such as GDPR, HIPAA, and PCI-DSS, which mandate robust data protection measures.
  description: This rule checks whether server-side encryption is enabled for Oracle Cloud Infrastructure queues. Server-side encryption provides an additional layer of security by encrypting messages using Oracle-managed keys before storing them. To verify compliance, ensure that the 'Encryption' setting for each queue is configured to 'Enabled'. Remediation involves updating the queue settings to activate server-side encryption, thereby securing the data at rest.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Queue/Tasks/encryptingqueues.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
  - https://www.oracle.com/security/cloud-security/
- rule_id: oci.compute.instance.document_secrets
  service: compute
  resource: instance
  requirement: Document Secrets
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: high
  title: Ensure Compute Instances Do Not Store Unencrypted Secrets
  rationale: Storing unencrypted secrets on compute instances poses a significant security risk as unauthorized access to these instances could lead to data breaches, financial loss, and regulatory non-compliance. Inadequate protection of sensitive information may violate privacy laws and industry standards such as PCI-DSS, HIPAA, and ISO 27001, resulting in penalties and damage to the organization's reputation.
  description: This rule checks for the presence of unencrypted secrets on OCI compute instances. It verifies whether sensitive information such as API keys, passwords, and tokens are stored securely using Oracle Cloud's Key Management Service (KMS). To remediate, ensure secrets are encrypted using OCI Vault and access them via secure methods like environment variables or configuration management tools. Regular audits should be conducted to ensure compliance with security policies.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/document_library
  - https://www.hhs.gov/hipaa/for-professionals/security/index.html
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloud.oracle.com/cloud-security
- rule_id: oci.compute.instance.documents_set_as_public
  service: compute
  resource: instance
  requirement: Documents Set As Public
  scope: compute.instance.public_access
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: critical
  title: Restrict Public Access to Compute Instance Documents
  rationale: Allowing compute instance documents to be publicly accessible can lead to unauthorized data exposure, increasing the risk of data breaches and compliance violations. Publicly accessible documents can be exploited by attackers to gather sensitive information, which could result in financial loss and reputational damage. Ensuring that documents are not publicly accessible aligns with compliance standards such as PCI-DSS and ISO 27001, which mandate strict access controls.
  description: This rule checks if any documents associated with compute instances are set to public access, which is a critical security risk. To verify, review the document settings in the OCI console under the specific compute instance's configuration. Remediation involves setting the document access to private and implementing proper identity and access management (IAM) policies to restrict access to authorized users only. Utilize Resource Manager and IAM policies to enforce least privilege access to these documents.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Identity/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Concepts/computeoverview.htm
  - CIS Oracle Cloud Infrastructure Foundation Benchmark v1.1.0
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.iso.org/iso-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.object_storage.bucket.ensure_oracle_services_are_trusted_to_enabled
  service: object_storage
  resource: bucket
  requirement: Ensure Oracle Services Are Trusted To Enabled
  scope: object_storage.bucket.security
  domain: storage_and_database_security
  subcategory: storage_encryption
  severity: low
  title: Ensure Oracle Services Trust is Enabled for Buckets
  rationale: Enabling Oracle Services to be trusted on Object Storage buckets is crucial for ensuring secure interactions between Oracle services and your storage resources. This setting helps mitigate risks of unauthorized access and data breaches by allowing only trusted Oracle services to interact with your data, thus aligning with data protection regulations like GDPR and ensuring compliance with industry standards.
  description: This rule checks whether the setting 'Allow trusted Oracle services to manage objects' is enabled for Object Storage buckets. This configuration allows Oracle services such as Data Transfer Service and autonomous databases to access the bucket securely. To verify, navigate to the OCI Console, access the Object Storage service, and check the bucket's settings under 'Permissions'. If not enabled, modify the bucket's settings to turn on this feature, ensuring secure service interactions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingbuckets.htm#trustedservices
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://csrc.nist.gov/publications/detail/sp/800-144/final
  - https://www.pcisecuritystandards.org/pci_security/maintaining_payment_security
  - https://cloud.oracle.com/storage/object-storage/features
- rule_id: oci.object_storage.bucket.ensure_private_endpoints_in_storage_accounts
  service: object_storage
  resource: bucket
  requirement: Ensure Private Endpoints In Storage Accounts
  scope: object_storage.bucket.private_networking
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Private Endpoints for OCI Object Storage Buckets
  rationale: Implementing private endpoints for Object Storage buckets minimizes the exposure of data to potential threats by restricting access to the Oracle Cloud Infrastructure network. This enhances data confidentiality and integrity by preventing unauthorized public access and reduces the attack surface, crucial for meeting compliance with data protection regulations such as GDPR and CCPA.
  description: This rule checks whether OCI Object Storage buckets are configured with private endpoints to ensure network traffic remains within the secure OCI network. Verify buckets are set up with Virtual Cloud Network (VCN) configurations allowing only internal access. To remediate, create and configure a private endpoint in the associated VCN and update bucket policies to restrict access to this endpoint only.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingprivateendpoints.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1_2_0.htm
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security-best-practices/
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
- rule_id: oci.object_storage.bucket.fileshare_encryption_enabled
  service: object_storage
  resource: bucket
  requirement: Fileshare Encryption Enabled
  scope: object_storage.bucket.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Object Storage Buckets Have Fileshare Encryption Enabled
  rationale: Enabling encryption for object storage buckets is crucial to protect sensitive data from unauthorized access and potential breaches. Without encryption, data at rest is vulnerable to threats such as data theft and unauthorized manipulation, which can lead to significant financial losses and damage to reputation. Compliance with regulations like GDPR, PCI-DSS, and others often mandates encryption of data to ensure privacy and security.
  description: This rule verifies that encryption is enabled for object storage buckets, ensuring that all data at rest is secured using Oracle-managed keys or customer-managed keys. To check the encryption status, navigate to the OCI Console, select the Object Storage service, and review the bucket settings for encryption options. If encryption is not enabled, configure it by selecting the appropriate encryption key management option. This can be set during bucket creation or updated for existing buckets.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/usingyourencryptionkeys.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57Pt1r4.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_overview.htm
- rule_id: oci.key_management.vault.cmk_are_used
  service: key_management
  resource: vault
  requirement: CMK Are Used
  scope: key_management.vault.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure CMKs Are Actively Used in Key Management Vaults
  rationale: Ensuring that Customer Master Keys (CMKs) are actively used within OCI Vaults is crucial for maintaining robust encryption practices and safeguarding sensitive data. Unused CMKs may lead to unnecessary exposure to risks if not managed properly, and they may also incur additional costs. Regulatory requirements often mandate the use of active encryption keys to ensure data privacy and protection, aligning with frameworks such as PCI-DSS and HIPAA.
  description: This rule checks for the presence of Customer Master Keys (CMKs) that are actively used within Oracle Cloud Infrastructure (OCI) Key Management vaults. It verifies whether CMKs are associated with any encryption processes. To remediate issues identified by this rule, ensure that CMKs are actively linked to encryption tasks or retire unused keys to minimize security risks and resource costs. This involves reviewing key usage logs and settings in the OCI Console under the Key Management section.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.key_management.vault.cmk_not_deleted_unintentionally
  service: key_management
  resource: vault
  requirement: CMK Not Deleted Unintentionally
  scope: key_management.vault.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Prevent Unintentional Deletion of Vault Keys
  rationale: Unintentional deletion of Customer Master Keys (CMKs) in OCI can lead to data inaccessibility and business disruption, as encrypted data becomes unrecoverable. This risk is heightened in environments handling sensitive or regulated data, potentially leading to non-compliance with standards like PCI-DSS or HIPAA and resulting in financial penalties or reputational damage.
  description: This rule checks if there are mechanisms in place to prevent accidental deletion of CMKs within OCI Key Management vaults. It is essential to implement a key deletion protection policy, such as enabling 'key deletion protection' during key creation. To verify, ensure that deletion protection is active on all critical keys. If deletion protection is not enabled, reconfigure the key settings in the OCI console to include this safeguard.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingkeys.htm
  - https://www.oracle.com/security/cloud-security/cspm/
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_compliance.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
- rule_id: oci.key_management.vault.cmk_not_multi_region
  service: key_management
  resource: vault
  requirement: CMK Not Multi Region
  scope: key_management.vault.security
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: medium
  title: Ensure Customer Managed Keys (CMKs) Are Multi-Region for Resilience
  rationale: Using multi-region keys enhances data resiliency and availability by allowing cryptographic operations across multiple geographical locations. This mitigates risks of data unavailability due to regional failures and supports business continuity plans. Furthermore, regulatory frameworks often require robust disaster recovery strategies, which multi-region key management supports.
  description: This rule checks if Customer Managed Keys (CMKs) in Oracle Cloud Infrastructure Key Management are configured to be multi-region. A multi-region CMK allows operations in multiple OCI regions, ensuring key availability even if a regional outage occurs. To verify, inspect the key management settings in the OCI Console for the 'Multi-Region' attribute. To remediate, create a multi-region replica of an existing single-region CMK using the OCI Key Management service and update dependencies to use the multi-region CMK.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingkeys.htm
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm#Multi-Region_Keys
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
  - https://cloud.oracle.com/architecture/patterns/best-practices-for-encrypting-and-protecting-data-at-rest
- rule_id: oci.key_management.vault.key_public_access_blocked
  service: key_management
  resource: vault
  requirement: Key Public Access Blocked
  scope: key_management.vault.public_access
  domain: secrets_and_key_management
  subcategory: key_management
  severity: critical
  title: Ensure Vault Key Public Access is Disabled
  rationale: Allowing public access to encryption keys stored in OCI Vaults poses significant security risks, including unauthorized data decryption and potential data breaches. This configuration can violate compliance requirements such as PCI-DSS and GDPR, which mandate strict access controls to sensitive data encryption keys. Ensuring keys are not publicly accessible protects against data exposure and maintains regulatory compliance.
  description: This rule checks if any encryption keys in OCI Vaults are configured with public access, which can occur if keys are improperly shared or misconfigured. To verify, review the access policies and security lists associated with the vault and ensure no public IP addresses or broad access permissions are allowed. Remediation involves updating access policies to restrict access to authorized users and IP addresses only, leveraging OCI's Identity and Access Management (IAM) service for granular control.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Concepts/keyoverview.htm
  - https://www.oracle.com/security/cloud-security/compliance/
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/security_iam.htm
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
- rule_id: oci.key_management.vault.secret_rotation_enabled
  service: key_management
  resource: vault
  requirement: Secret Rotation Enabled
  scope: key_management.vault.key_rotation
  domain: secrets_and_key_management
  subcategory: key_management
  severity: high
  title: Ensure Vault Secret Rotation is Enabled
  rationale: Enabling secret rotation in OCI vaults is crucial for maintaining the integrity and confidentiality of sensitive data. Regularly rotating secrets mitigates the risk of unauthorized access that could result from compromised secrets, supporting compliance with various regulatory standards such as PCI-DSS and ISO 27001. It also reduces the window of opportunity for attackers to exploit credential leaks.
  description: This rule checks whether secret rotation is enabled for vaults within Oracle Cloud Infrastructure's Key Management service. Enabling automatic rotation of secrets ensures that credentials are periodically updated, minimizing exposure to potential breaches. To verify, navigate to the OCI Console, select the appropriate vault, and ensure secret rotation policies are configured. Remediation involves setting up a rotation schedule that complies with your organization's security policy.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/KeyManagement/Tasks/managingsecrets.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_foundations
  - https://www.pcisecuritystandards.org
  - https://www.iso.org/iso-27001-information-security.html
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.virtual_network.vcn.default_security_group_closed
  service: virtual_network
  resource: vcn
  requirement: Default Security Group Closed
  scope: virtual_network.vcn.network_security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Default Security Group is Configured for Least Privilege
  rationale: Default Security Groups, if not properly configured, can expose your Virtual Cloud Network (VCN) to unnecessary risks, such as unauthorized access and potential data breaches. By closing or restricting the default security group, you mitigate the risk of inadvertently opening up your network to untrusted sources, thereby ensuring compliance with security best practices and regulatory requirements such as NIST and ISO 27001.
  description: This rule checks that the default security group associated with Oracle Cloud Infrastructure (OCI) Virtual Cloud Network (VCN) does not allow unrestricted access. It verifies that no open ingress or egress rules are unintentionally configured. To remediate, review the default security group rules in your VCN and apply the principle of least privilege by restricting access to known IPs and specific ports. Ensure that any open rules are necessary and documented as part of your security policy.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingsecuritygroups.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/isoiec-27001-information-security.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.virtual_network.vcn.different_regions
  service: virtual_network
  resource: vcn
  requirement: Different Regions
  scope: virtual_network.vcn.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure VCNs Are Deployed Across Multiple OCI Regions
  rationale: Deploying Virtual Cloud Networks (VCNs) across different OCI regions enhances fault tolerance and disaster recovery capabilities. It mitigates risks of region-specific outages impacting business operations and supports compliance with data residency requirements. This approach ensures continuity and reliability in accessing cloud resources, aligning with best practices for high availability and business continuity planning.
  description: This rule checks for the deployment of VCNs across multiple OCI regions. To verify, ensure that VCNs are configured in at least two different OCI regions by using the OCI Console or CLI. Remediation involves creating additional VCNs in different regions and configuring them to meet your network design. This includes setting up appropriate routing, security lists, and peering connections if necessary. Leveraging multiple regions can reduce latency for global users and protect against regional service disruptions.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingVCNs.htm
  - https://www.oracle.com/cloud/cloud-regions/
  - NIST SP 800-34 Rev. 1
  - ISO/IEC 27001:2013
  - https://www.oracle.com/security/cloud-security/regions.html
- rule_id: oci.virtual_network.vcn.endpoint_connections_trust_boundaries
  service: virtual_network
  resource: vcn
  requirement: Endpoint Connections Trust Boundaries
  scope: virtual_network.vcn.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure VCN Endpoint Connections Honor Trust Boundaries
  rationale: Establishing clear trust boundaries for endpoint connections within a Virtual Cloud Network (VCN) is crucial for minimizing unauthorized access and data breaches. By segregating network traffic and enforcing strict access controls, businesses can protect sensitive data, comply with regulatory requirements, and mitigate risks associated with lateral movement by malicious actors.
  description: This rule checks that endpoint connections within an OCI VCN are configured to respect trust boundaries. Specifically, it verifies the use of appropriate security lists and network security groups (NSGs) to control inbound and outbound traffic to and from the endpoints. To ensure compliance, review and update the security lists and NSGs to match the defined trust boundaries. Remediation involves configuring security rules to restrict traffic based on source IP, destination IP, and port numbers, ensuring only authorized traffic is permitted.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/securitylists.htm
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/networksecuritygroups.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/pci_security/
  - https://www.nist.gov/itl/applied-cybersecurity/nist-cybersecurity-framework
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.virtual_network.vcn.endpoint_multi_az_enabled
  service: virtual_network
  resource: vcn
  requirement: Endpoint Multi Az Enabled
  scope: virtual_network.vcn.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Enable Multi-AZ for VCN Endpoints
  rationale: Enabling Multi-AZ (Availability Zone) for VCN endpoints in OCI enhances network reliability and resilience by ensuring that network services can withstand individual AZ failures. This configuration minimizes downtime and data loss, crucial for maintaining business continuity and meeting service level agreements. It also aligns with compliance requirements such as NIST and ISO 27001, which emphasize robust system availability and disaster recovery strategies.
  description: This rule checks whether the endpoints within a Virtual Cloud Network (VCN) are configured to operate across multiple Availability Zones. Ensuring Multi-AZ support involves enabling cross-AZ replication and load balancing for critical network services. To verify, review the VCN configuration in the OCI Console and ensure that Multi-AZ options are enabled where applicable. Remediate by adjusting the VCN settings to distribute endpoints across multiple AZs, leveraging OCI's built-in high availability features.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.oracle.com/security/cloud-compliance/
  - NIST SP 800-53
  - ISO/IEC 27001
  - https://cloudsecurityalliance.org/
  - https://www.oracletutorial.com/
- rule_id: oci.virtual_network.vcn.endpoint_services_allowed_principals_trust_boundaries
  service: virtual_network
  resource: vcn
  requirement: Endpoint Services Allowed Principals Trust Boundaries
  scope: virtual_network.vcn.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Restrict VCN Endpoint Service Principals to Trusted Boundaries
  rationale: Allowing unrestricted principals to access VCN endpoint services can lead to unauthorized access, data leakage, and potential misuse of services. Restricting access to known, trusted principals helps maintain secure boundaries and reduces the attack surface, ensuring data integrity and compliance with industry regulations such as PCI-DSS and HIPAA.
  description: This rule checks if the principals allowed to access VCN endpoint services are within predefined trust boundaries. It verifies the configuration of IAM policies to ensure that only authorized users or groups have access. Administrators should review and update IAM policies to restrict access to trusted entities only. Remediation involves evaluating the current list of principals and modifying policies to exclude unauthorized entities while adhering to the principle of least privilege.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingVCNs.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://www.pcisecuritystandards.org/
  - https://www.hipaajournal.com/what-is-hipaa-compliance/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.iso.org/iso-27001-information-security.html
- rule_id: oci.virtual_network.vcn.peering_routing_tables_with_least_privilege_required
  service: virtual_network
  resource: vcn
  requirement: Peering Routing Tables With Least Privilege Required
  scope: virtual_network.vcn.least_privilege
  domain: identity_and_access_management
  subcategory: authentication
  severity: high
  title: Ensure Least Privilege for VCN Peering Routing Tables
  rationale: Implementing least privilege for VCN peering routing tables minimizes the risk of unauthorized access or data exfiltration between peered networks. It reduces the attack surface by ensuring only necessary routes are allowed, which is crucial for maintaining network integrity and complying with regulations such as PCI-DSS and ISO 27001.
  description: This rule checks whether routing tables involved in VCN peering are configured with the least privilege necessary to maintain network operations. Ensure that only required routes are defined to prevent unintentional exposure of network paths. Verify configurations through the OCI Console or CLI by reviewing the 'Route Tables' section, and update policies to limit routes to specific CIDR blocks essential for business needs. Remediation involves defining precise routes and regularly auditing routing table entries.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/usingroutetables.htm
  - https://www.oracle.com/security/cloud-security/cis-benchmarks/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.iso.org/iso-27001-information-security.html
  - https://cloudsecurityalliance.org/research/guidance/
- rule_id: oci.virtual_network.vcn.subnet_different_az
  service: virtual_network
  resource: vcn
  requirement: Subnet Different Az
  scope: virtual_network.vcn.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure Subnets Span Different Availability Domains
  rationale: Distributing subnets across different availability domains reduces the risk of a single point of failure in the event of a domain-specific outage. This enhances network resilience and business continuity, ensuring that applications remain available and performant even during unexpected domain failures. It also aligns with compliance standards that mandate high availability and disaster recovery strategies.
  description: This rule verifies that Virtual Cloud Network (VCN) subnets are configured to span multiple availability domains within Oracle Cloud Infrastructure. By distributing subnets across domains, organizations can mitigate risks associated with domain-specific outages. To comply, review subnet configurations in the OCI Console under the VCN settings and ensure subnets are not localized to a single domain. Remediation involves modifying subnet settings to ensure at least one subnet is placed in a separate availability domain.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingVCNs.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.nist.gov/publications/nist-special-publication-800-53r5-security-and-privacy-controls-information
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
- rule_id: oci.virtual_network.vcn.vpn_connection_tunnels_up
  service: virtual_network
  resource: vcn
  requirement: Vpn Connection Tunnels Up
  scope: virtual_network.vcn.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Ensure VPN Connection Tunnels Remain Active
  rationale: Maintaining active VPN connection tunnels is critical for ensuring secure and continuous connectivity between on-premises networks and Oracle Cloud Infrastructure. If tunnels go down, it can lead to data transfer interruptions, potential security breaches, and loss of access to critical services, impacting business operations and exposing sensitive data to vulnerabilities. Compliance with regulations such as PCI-DSS and HIPAA may require maintaining secure and reliable network connections.
  description: This rule checks whether the VPN connection tunnels associated with your Virtual Cloud Network (VCN) are active and operational. If tunnels are found to be down, it indicates a break in the secure network path, which must be promptly addressed. Verify the tunnel status in the OCI console under Networking > VPN Connections, and troubleshoot using Oracle documentation to ensure tunnels are up and running. Regularly monitor the tunnel health and apply necessary patches or updates to the VPN appliances or configurations.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingIPsec.htm
  - 'CIS OCI Benchmark: Ensure that all VPN connections have at least one active tunnel'
  - 'NIST SP 800-53: AC-17 Remote Access'
  - 'PCI-DSS Requirement 1.3: Prohibit direct public access between the Internet and any system component in the cardholder data environment.'
  - https://www.oracle.com/security/cloud-security/
  - 'ISO/IEC 27001: A.13.1 Network security management'
- rule_id: oci.compute.volume_attachment.ensure_using_managed_disks
  service: compute
  resource: volume_attachment
  requirement: Ensure Using Managed Disks
  scope: compute.volume_attachment.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure All Compute Instances Use Managed Disks
  rationale: Using unmanaged disks poses a risk of data inconsistency and lacks automated backup features, which can lead to data loss and increased downtime in case of failure. Managed disks offer enhanced reliability, automatic scaling, and integrated backup solutions, ensuring business continuity and compliance with data protection regulations.
  description: This rule checks whether all compute instances in OCI are using managed disks for their volume attachments. Managed disks provide built-in redundancy, automated snapshots, and streamlined performance management, which are crucial for maintaining data integrity and operational efficiency. To verify, review the volume attachment configurations in the OCI console or use the OCI CLI to ensure that all volumes are managed. Remediation involves migrating existing unmanaged disks to managed disks using the OCI interface or API.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/overview.htm
  - https://www.oracle.com/cloud/cloud-infrastructure/compliance/
  - CIS OCI Foundations Benchmark v1.1.0 - Section 3.6
  - https://www.nist.gov/document/nist-special-publication-800-53-revision-5
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://www.oracle.com/security-best-practices/
- rule_id: oci.compute.instance.trusted_launch_enabled
  service: compute
  resource: instance
  requirement: Trusted Launch Enabled
  scope: compute.instance.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Trusted Launch is Enabled for Compute Instances
  rationale: Enabling Trusted Launch on OCI compute instances helps protect against boot and runtime threats by ensuring that instances start in a known-good state. This feature mitigates risks associated with unauthorized code execution and kernel vulnerabilities, which can lead to data breaches or unauthorized access. Compliance with frameworks such as NIST SP 800-53 and ISO 27001 may require such controls to ensure integrity and confidentiality of critical workloads.
  description: This rule checks if Trusted Launch is enabled for compute instances in OCI, which uses a combination of secure boot, measured boot, and attestation mechanisms to verify the integrity of the boot environment. To verify, ensure that your instance configurations include the 'Trusted Launch' feature. If not enabled, modify the instance settings to activate this feature through the OCI Console or CLI. This enhances security by preventing malicious code from altering the boot process.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Compute/Tasks/enablingtrustedlaunch.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud_computing_platform/
  - https://www.nist.gov/publications/security-and-privacy-controls-information-systems-and-organizations
  - https://www.iso.org/standard/54534.html
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.virtual_network.vcn.endpoint_for_compute_enabled
  service: virtual_network
  resource: vcn
  requirement: Endpoint For Compute Enabled
  scope: virtual_network.vcn.security
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: low
  title: Enable VCN Endpoint for Compute Instances
  rationale: Enabling endpoints for compute instances within a VCN is crucial for isolating internal traffic and reducing exposure to external threats. This configuration helps prevent unauthorized access and potential data breaches by ensuring that compute instances only communicate via secure and controlled channels. Compliance with industry standards such as PCI-DSS and SOC2 often require such secure configurations to protect sensitive data.
  description: This rule checks whether the VCN has the necessary endpoints enabled to facilitate secure communication for compute instances. To verify, ensure that service gateways or private endpoints are configured within the VCN to handle traffic internally. Remediation involves setting up these gateways or endpoints and updating route tables and security lists accordingly to ensure that all compute instance traffic is properly routed through these secure channels.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Concepts/overview.htm
  - https://www.oracle.com/security/cloud-compliance/cis-benchmarks/
  - https://www.pcisecuritystandards.org/
  - https://www.nist.gov/cyberframework
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingSGs.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Concepts/security_best_practices.htm
- rule_id: oci.cloud_guard.target.workload_no_high_or_medium_risks
  service: cloud_guard
  resource: target
  requirement: Workload No High Or Medium Risks
  scope: cloud_guard.target.security
  domain: compute_and_workload_security
  subcategory: instance_configuration
  severity: low
  title: Ensure Workloads Have No High or Medium Risks
  rationale: Managing high and medium risks in workloads is crucial to protect sensitive data and maintain business continuity. Unmitigated risks can lead to unauthorized access, data breaches, and non-compliance with industry regulations, potentially resulting in financial loss and reputational damage. This rule helps organizations proactively manage and mitigate risks to align with compliance mandates such as PCI-DSS and ISO 27001.
  description: This rule evaluates the risk profile of OCI workloads to ensure no high or medium security risks are present. It checks configurations against Oracle's security best practices and identifies any deviations that could lead to vulnerabilities. Remediation involves reviewing the identified risks in the Cloud Guard dashboard, addressing misconfigurations, and implementing recommended controls to reduce risk levels. Regularly update instance configurations and apply security patches to maintain a low-risk security posture.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/cloud-guard/home.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud/
  - https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4-0.pdf
  - https://www.iso.org/iso-iec-27001-information-security.html
  - https://www.oracle.com/security-cloud-computing/
- rule_id: oci.compute.instance.vcn_2private_1public_subnets_nat
  service: compute
  resource: instance
  requirement: Vcn 2private 1public Subnets Nat
  scope: compute.instance.public_access
  domain: network_security_and_connectivity
  subcategory: network_access_control
  severity: critical
  title: Ensure Instances Use Proper Subnet Configuration with NAT
  rationale: Misconfigured subnet setups can expose critical infrastructure to public networks, increasing the risk of unauthorized access, data breaches, and compliance violations. By enforcing a network design where only designated subnets are public and others are private, organizations can limit exposure to threats and adhere to regulatory requirements such as PCI-DSS and ISO 27001.
  description: This rule checks that Oracle Cloud Infrastructure (OCI) compute instances are deployed within a Virtual Cloud Network (VCN) featuring two private subnets and one public subnet, utilizing Network Address Translation (NAT) for secure internet connectivity. Ensure compute instances that do not need direct internet exposure are placed in private subnets while public-facing services remain in the public subnet. To verify, inspect subnet configurations in the OCI Console under the Networking section. Remediation involves adjusting subnet settings and employing NAT Gateways for outbound traffic from private subnets.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingVCNs.htm
  - https://docs.oracle.com/en-us/iaas/Content/Security/Reference/oci_cis_1.0_benchmark.htm
  - https://www.pcisecuritystandards.org/
  - https://www.iso.org/iso-27001-information-security.html
  - https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-123.pdf
  - https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingnatgateway.htm
- rule_id: oci.compute.volume_attachment.volume_encryption_enabled
  service: compute
  resource: volume_attachment
  requirement: Volume Encryption Enabled
  scope: compute.volume_attachment.encryption
  domain: data_protection_and_privacy
  subcategory: encryption_at_rest
  severity: high
  title: Ensure Volume Encryption for Compute Attachments
  rationale: Enabling encryption for attached volumes in OCI protects sensitive data at rest from unauthorized access and potential breaches, thereby mitigating risk scenarios such as data leaks and ensuring compliance with regulatory standards like PCI-DSS and HIPAA. Failure to encrypt sensitive data can lead to severe business impacts, including financial penalties and reputational damage.
  description: This rule checks whether encryption is enabled for volumes attached to compute instances in OCI. By default, OCI provides the option to encrypt block volumes using Oracle-managed keys. To verify, review the encryption settings in the OCI Console under 'Block Volumes' and ensure that 'Encryption' is set to 'Enabled'. Remediation involves using the OCI Console or CLI to create or modify volumes with encryption enabled, utilizing Oracle-managed or customer-managed keys through OCI Vault.
  references:
  - https://docs.oracle.com/en-us/iaas/Content/Block/Concepts/overview.htm
  - https://www.cisecurity.org/benchmark/oracle_cloud
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v4.pdf
  - https://www.oracle.com/security/cloud-security/oci-best-practices.html
  - https://www.oracle.com/security/cloud-security/cloud-infrastructure-compliance.html
