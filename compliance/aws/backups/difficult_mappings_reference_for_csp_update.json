{
  "metadata": {
    "purpose": "Reference file for updating other CSP data with corrected AWS function names",
    "total_mappings": 9,
    "date_created": "2025-11-23",
    "notes": "These 9 functions had difficult mappings and required improved function name updates"
  },
  "mappings": [
    {
      "sequence": 1,
      "original_function": "aws_vpc_different_regions",
      "aws_checks_earlier": "aws_vpc_different_regions",
      "aws_checks_new": "aws_vpc_different_regions",
      "improved_function_earlier": "aws.ec2.different.regions",
      "improved_function_new": "aws.ec2.vpc.multi_region_deployment_configured",
      "matched_rule_id": "aws.ec2.vpc.automated_isolation_supported_configured",
      "confidence": "medium",
      "compliance_details": [
        {
          "compliance_id": "iso27001_2022_multi_cloud_A.8.20_0076",
          "framework": "ISO27001",
          "requirement_id": "A.8.20",
          "requirement_name": "Network Security",
          "technology": "MULTI_CLOUD"
        },
        {
          "compliance_id": "iso27001_2022_multi_cloud_A.8.21_0077",
          "framework": "ISO27001",
          "requirement_id": "A.8.21",
          "requirement_name": "Security of Network Services",
          "technology": "MULTI_CLOUD"
        },
        {
          "compliance_id": "iso27001_2022_multi_cloud_A.8.22_0078",
          "framework": "ISO27001",
          "requirement_id": "A.8.22",
          "requirement_name": "Segregation of Networks",
          "technology": "MULTI_CLOUD"
        }
      ],
      "notes": "VPC multi-region deployment maps to automated isolation (HA/DR pattern)",
      "action_required": "Update other CSP data sources to use 'improved_function_new' instead of 'aws_checks_earlier'"
    },
    {
      "sequence": 2,
      "original_function": "aws_ec2_elastic_ip_shodan",
      "aws_checks_earlier": "aws_ec2_elastic_ip_shodan",
      "aws_checks_new": "aws_ec2_elastic_ip_shodan",
      "improved_function_earlier": "aws.ec2.elastic.ip_shodan",
      "improved_function_new": "aws.ec2.eip.shodan_exposure_detected",
      "matched_rule_id": "aws.ec2.eip.shodan_exposure_detected",
      "confidence": "high",
      "compliance_details": [
        {
          "compliance_id": "iso27001_2022_multi_cloud_A.8.20_0076",
          "framework": "ISO27001",
          "requirement_id": "A.8.20",
          "requirement_name": "Network Security",
          "technology": "MULTI_CLOUD"
        },
        {
          "compliance_id": "iso27001_2022_multi_cloud_A.8.21_0077",
          "framework": "ISO27001",
          "requirement_id": "A.8.21",
          "requirement_name": "Security of Network Services",
          "technology": "MULTI_CLOUD"
        },
        {
          "compliance_id": "iso27001_2022_multi_cloud_A.8.22_0078",
          "framework": "ISO27001",
          "requirement_id": "A.8.22",
          "requirement_name": "Segregation of Networks",
          "technology": "MULTI_CLOUD"
        }
      ],
      "notes": "Elastic IP Shodan exposure - fixed resource name from 'elastic' to 'eip'",
      "action_required": "Update other CSP data sources to use 'improved_function_new' instead of 'aws_checks_earlier'"
    },
    {
      "sequence": 3,
      "original_function": "aws_vpc_endpoint_connections_trust_boundaries",
      "aws_checks_earlier": "aws_vpc_endpoint_connections_trust_boundaries",
      "aws_checks_new": "aws_vpc_endpoint_connections_trust_boundaries",
      "improved_function_earlier": "aws.ec2.vpcendpoint.connection_trust_boundaries_validated",
      "improved_function_new": "aws.ec2.vpcendpoint.policy_least_privilege",
      "matched_rule_id": "aws.ec2.vpcendpoint.policy_least_privilege",
      "confidence": "high",
      "compliance_details": [
        {
          "compliance_id": "iso27001_2022_multi_cloud_A.8.20_0076",
          "framework": "ISO27001",
          "requirement_id": "A.8.20",
          "requirement_name": "Network Security",
          "technology": "MULTI_CLOUD"
        },
        {
          "compliance_id": "iso27001_2022_multi_cloud_A.8.21_0077",
          "framework": "ISO27001",
          "requirement_id": "A.8.21",
          "requirement_name": "Security of Network Services",
          "technology": "MULTI_CLOUD"
        },
        {
          "compliance_id": "iso27001_2022_multi_cloud_A.8.22_0078",
          "framework": "ISO27001",
          "requirement_id": "A.8.22",
          "requirement_name": "Segregation of Networks",
          "technology": "MULTI_CLOUD"
        }
      ],
      "notes": "VPC endpoint connection trust boundaries = policy least privilege principle",
      "action_required": "Update other CSP data sources to use 'improved_function_new' instead of 'aws_checks_earlier'"
    },
    {
      "sequence": 4,
      "original_function": "aws_vpc_endpoint_services_allowed_principals_trust_boundaries",
      "aws_checks_earlier": "aws_vpc_endpoint_services_allowed_principals_trust_boundaries",
      "aws_checks_new": "aws_vpc_endpoint_services_allowed_principals_trust_boundaries",
      "improved_function_earlier": "aws.ec2.vpcendpointservice.allowed_principals_trust_boundaries_validated",
      "improved_function_new": "aws.ec2.vpcendpoint.policy_least_privilege",
      "matched_rule_id": "aws.ec2.vpcendpoint.policy_least_privilege",
      "confidence": "high",
      "compliance_details": [
        {
          "compliance_id": "iso27001_2022_multi_cloud_A.8.20_0076",
          "framework": "ISO27001",
          "requirement_id": "A.8.20",
          "requirement_name": "Network Security",
          "technology": "MULTI_CLOUD"
        },
        {
          "compliance_id": "iso27001_2022_multi_cloud_A.8.21_0077",
          "framework": "ISO27001",
          "requirement_id": "A.8.21",
          "requirement_name": "Security of Network Services",
          "technology": "MULTI_CLOUD"
        },
        {
          "compliance_id": "iso27001_2022_multi_cloud_A.8.22_0078",
          "framework": "ISO27001",
          "requirement_id": "A.8.22",
          "requirement_name": "Segregation of Networks",
          "technology": "MULTI_CLOUD"
        }
      ],
      "notes": "VPC endpoint service allowed principals trust boundaries = policy least privilege",
      "action_required": "Update other CSP data sources to use 'improved_function_new' instead of 'aws_checks_earlier'"
    },
    {
      "sequence": 5,
      "original_function": "aws_vpc_keyspaces_network_security_check",
      "aws_checks_earlier": "aws_vpc_keyspaces_network_security_check",
      "aws_checks_new": "aws_vpc_keyspaces_network_security_check",
      "improved_function_earlier": "aws.ec2.keyspaces.network_security_check",
      "improved_function_new": "aws.keyspaces.keyspace.vpc_endpoint_enabled",
      "matched_rule_id": "aws.keyspaces.resource.keyspace_security_configuration_configured",
      "confidence": "medium",
      "compliance_details": [
        {
          "compliance_id": "iso27001_2022_multi_cloud_A.8.20_0076",
          "framework": "ISO27001",
          "requirement_id": "A.8.20",
          "requirement_name": "Network Security",
          "technology": "MULTI_CLOUD"
        }
      ],
      "notes": "Keyspaces VPC network security - fixed service from 'ec2' to 'keyspaces'",
      "action_required": "Update other CSP data sources to use 'improved_function_new' instead of 'aws_checks_earlier'"
    },
    {
      "sequence": 6,
      "original_function": "aws_iam_no_guest_accounts_with_permissions",
      "aws_checks_earlier": "aws_iam_no_guest_accounts_with_permissions",
      "aws_checks_new": "aws_iam_no_guest_accounts_with_permissions",
      "improved_function_earlier": "aws.iam.user.no_permissions_for_guest_accounts",
      "improved_function_new": "aws.iam.user.guest_accounts_have_no_permissions",
      "matched_rule_id": "aws.iam.no_guest_accounts_with_permissions.no_guest_accounts_with_permissions_configured",
      "confidence": "high",
      "compliance_details": [
        {
          "compliance_id": "rbi_bank_multi_cloud_9.3_0027",
          "framework": "RBI_BANK",
          "requirement_id": "9.3",
          "requirement_name": "Guest Account Management",
          "technology": "MULTI_CLOUD"
        }
      ],
      "notes": "IAM guest accounts should have no permissions - exact match found in suggested rules",
      "action_required": "Update other CSP data sources to use 'improved_function_new' instead of 'aws_checks_earlier'"
    },
    {
      "sequence": 7,
      "original_function": "aws_kms_cmk_not_multi_region",
      "aws_checks_earlier": "aws_kms_cmk_not_multi_region",
      "aws_checks_new": "aws_kms_cmk_not_multi_region",
      "improved_function_earlier": "aws.kms.key.single_region_configured",
      "improved_function_new": "aws.kms.key.multi_region_disabled",
      "matched_rule_id": "aws.kms.key.multi_region_disabled",
      "confidence": "high",
      "compliance_details": [
        {
          "compliance_id": "iso27001_2022_multi_cloud_A.8.20_0076",
          "framework": "ISO27001",
          "requirement_id": "A.8.20",
          "requirement_name": "Network Security",
          "technology": "MULTI_CLOUD"
        }
      ],
      "notes": "KMS key multi-region disabled (single-region keys for compliance/data residency)",
      "action_required": "Update other CSP data sources to use 'improved_function_new' instead of 'aws_checks_earlier'"
    },
    {
      "sequence": 8,
      "original_function": "aws_networkfirewall_in_all_vpc",
      "aws_checks_earlier": "aws_networkfirewall_in_all_vpc",
      "aws_checks_new": "aws_networkfirewall_in_all_vpc",
      "improved_function_earlier": "aws.network-firewall.firewall.deployed_in_all_vpcs",
      "improved_function_new": "aws.network-firewall.firewall.deployed_in_all_vpcs",
      "matched_rule_id": "aws.ec2.vpc.flow_logging_enabled",
      "confidence": "high",
      "compliance_details": [
        {
          "compliance_id": "iso27001_2022_multi_cloud_A.8.20_0076",
          "framework": "ISO27001",
          "requirement_id": "A.8.20",
          "requirement_name": "Network Security",
          "technology": "MULTI_CLOUD"
        },
        {
          "compliance_id": "iso27001_2022_multi_cloud_A.8.21_0077",
          "framework": "ISO27001",
          "requirement_id": "A.8.21",
          "requirement_name": "Security of Network Services",
          "technology": "MULTI_CLOUD"
        },
        {
          "compliance_id": "iso27001_2022_multi_cloud_A.8.22_0078",
          "framework": "ISO27001",
          "requirement_id": "A.8.22",
          "requirement_name": "Segregation of Networks",
          "technology": "MULTI_CLOUD"
        }
      ],
      "notes": "Network firewall organizational policy - mapped to VPC flow logging (+ 15 related security controls)",
      "action_required": "Update other CSP data sources to use 'improved_function_new' instead of 'aws_checks_earlier'"
    },
    {
      "sequence": 9,
      "original_function": "aws_No checks defined",
      "aws_checks_earlier": "aws_No checks defined",
      "aws_checks_new": "aws_No checks defined",
      "improved_function_earlier": "aws.general.account.no_checks_defined",
      "improved_function_new": "aws.s3.bucket.public_access_block_enabled",
      "matched_rule_id": "aws.s3.bucket.block_public_access_enabled",
      "confidence": "high",
      "compliance_details": [
        {
          "compliance_id": "nist_800_171_r2_multi_cloud_3_13_4_3.13.4_Prevent_unauthorized_and_unintended_0010",
          "framework": "NIST_800-171",
          "requirement_id": "",
          "requirement_name": "3_13_4: 3.13.4 Prevent unauthorized and unintended information transfer via shared system resources",
          "technology": "MULTI_CLOUD"
        }
      ],
      "notes": "Fixed invalid CSV entry to S3 bucket public access block",
      "action_required": "Update other CSP data sources to use 'improved_function_new' instead of 'aws_checks_earlier'"
    }
  ]
}