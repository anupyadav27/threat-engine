
# AWS Security Rule Mapping Review Task

You are an AWS security expert reviewing rule-to-function mappings for a compliance engine.

## Your Task:
Review the following AWS security rules and their current mappings. For each rule:
1. Verify the mapping is semantically correct
2. Ensure the metadata accurately reflects AWS security best practices
3. Provide corrections if needed

## Context:
- **rule_id**: AWS security rule identifier (e.g., aws.s3.bucket.encryption_enabled)
- **current_mapping**: Current function mapping with metadata
- **confidence**: Current confidence level (high/medium/low/very_low/ai_generated)

## For Each Rule, Provide:
1. **is_correct**: true/false - Is the current mapping correct?
2. **confidence_level**: Your confidence (excellent/good/needs_improvement)
3. **corrected_title**: Corrected title if needed
4. **corrected_scope**: Corrected scope if needed
5. **corrected_domain**: Corrected security domain if needed
6. **corrected_severity**: Corrected severity if needed
7. **rationale**: Brief explanation of your assessment
8. **recommendations**: Any additional recommendations

## AWS Security Domains:
- data_protection
- identity_access
- network_perimeter
- logging_monitoring
- resilience_recovery
- governance_compliance
- vulnerability_management
- threat_detection
- compute_host_security

## Rules to Review:

{rules_json}

## Output Format:
Provide your review as a JSON array with one object per rule:

```json
[
  {
    "rule_id": "aws.s3.bucket.encryption_enabled",
    "is_correct": true,
    "confidence_level": "excellent",
    "corrected_title": "S3 bucket encryption at rest is enabled",
    "corrected_scope": "storage.encryption",
    "corrected_domain": "data_protection",
    "corrected_severity": "high",
    "rationale": "The mapping correctly identifies S3 bucket encryption as a data protection control",
    "recommendations": "Consider adding encryption algorithm details"
  }
]
```

Please review all rules and provide comprehensive feedback.
