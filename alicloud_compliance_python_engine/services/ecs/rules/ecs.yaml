version: '1.0'
provider: alicloud
service: ecs
discovery:
- discovery_id: alicloud.ecs.ami
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeAmis
    params: {}
    save_as: ami_response
  emit:
    items_for: '{ ami_response.Amis.Ami }'
    as: r
    item:
      id: '{{ r.AmiId }}'
      name: '{{ r.AmiId }}'
      resource_type: ami
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.backup
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeBackups
    params: {}
    save_as: backup_response
  emit:
    items_for: '{ backup_response.Backups.Backup }'
    as: r
    item:
      id: '{{ r.BackupId }}'
      name: '{{ r.BackupId }}'
      resource_type: backup
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.client
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeClients
    params: {}
    save_as: client_response
  emit:
    items_for: '{ client_response.Clients.Client }'
    as: r
    item:
      id: '{{ r.ClientId }}'
      name: '{{ r.ClientId }}'
      resource_type: client
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.compute_service
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeComputeServices
    params: {}
    save_as: compute_service_response
  emit:
    items_for: '{ compute_service_response.ComputeServices.ComputeService }'
    as: r
    item:
      id: '{{ r.ComputeServiceId }}'
      name: '{{ r.ComputeServiceId }}'
      resource_type: compute_service
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.custom_image
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeCustomImages
    params: {}
    save_as: custom_image_response
  emit:
    items_for: '{ custom_image_response.CustomImages.CustomImage }'
    as: r
    item:
      id: '{{ r.CustomImageId }}'
      name: '{{ r.CustomImageId }}'
      resource_type: custom_image
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.disk
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeDisks
    params: {}
    save_as: disk_response
  emit:
    items_for: '{ disk_response.Disks.Disk }'
    as: r
    item:
      id: '{{ r.DiskId }}'
      name: '{{ r.DiskId }}'
      resource_type: disk
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.disk_default_encryption_at_rest_enabled
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeDiskDefaultEncryptionAtRestEnableds
    params: {}
    save_as: disk_default_encryption_at_rest_enabled_response
  emit:
    items_for: '{ disk_default_encryption_at_rest_enabled_response.DiskDefaultEncryptionAtRestEnableds.DiskDefaultEncryptionAtRestEnabled
      }'
    as: r
    item:
      id: '{{ r.DiskDefaultEncryptionAtRestEnabledId }}'
      name: '{{ r.DiskDefaultEncryptionAtRestEnabledId }}'
      resource_type: disk_default_encryption_at_rest_enabled
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.disk_public_snapshot_access_blocked
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeDiskPublicSnapshotAccessBlockeds
    params: {}
    save_as: disk_public_snapshot_access_blocked_response
  emit:
    items_for: '{ disk_public_snapshot_access_blocked_response.DiskPublicSnapshotAccessBlockeds.DiskPublicSnapshotAccessBlocked
      }'
    as: r
    item:
      id: '{{ r.DiskPublicSnapshotAccessBlockedId }}'
      name: '{{ r.DiskPublicSnapshotAccessBlockedId }}'
      resource_type: disk_public_snapshot_access_blocked
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.disk_volume
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeDiskVolumes
    params: {}
    save_as: disk_volume_response
  emit:
    items_for: '{ disk_volume_response.DiskVolumes.DiskVolume }'
    as: r
    item:
      id: '{{ r.DiskVolumeId }}'
      name: '{{ r.DiskVolumeId }}'
      resource_type: disk_volume
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.disk_volume_encryption_at_rest_enabled
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeDiskVolumeEncryptionAtRestEnableds
    params: {}
    save_as: disk_volume_encryption_at_rest_enabled_response
  emit:
    items_for: '{ disk_volume_encryption_at_rest_enabled_response.DiskVolumeEncryptionAtRestEnableds.DiskVolumeEncryptionAtRestEnabled
      }'
    as: r
    item:
      id: '{{ r.DiskVolumeEncryptionAtRestEnabledId }}'
      name: '{{ r.DiskVolumeEncryptionAtRestEnabledId }}'
      resource_type: disk_volume_encryption_at_rest_enabled
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.e_hpc
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeEHpcs
    params: {}
    save_as: e_hpc_response
  emit:
    items_for: '{ e_hpc_response.EHpcs.EHpc }'
    as: r
    item:
      id: '{{ r.EHpcId }}'
      name: '{{ r.EHpcId }}'
      resource_type: e_hpc
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.e_hpc_ai
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeEHpcAis
    params: {}
    save_as: e_hpc_ai_response
  emit:
    items_for: '{ e_hpc_ai_response.EHpcAis.EHpcAi }'
    as: r
    item:
      id: '{{ r.EHpcAiId }}'
      name: '{{ r.EHpcAiId }}'
      resource_type: e_hpc_ai
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.ebs
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeEbss
    params: {}
    save_as: ebs_response
  emit:
    items_for: '{ ebs_response.Ebss.Ebs }'
    as: r
    item:
      id: '{{ r.EbsId }}'
      name: '{{ r.EbsId }}'
      resource_type: ebs
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.eip_exposure_to_shodan
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeEipExposureToShodans
    params: {}
    save_as: eip_exposure_to_shodan_response
  emit:
    items_for: '{ eip_exposure_to_shodan_response.EipExposureToShodans.EipExposureToShodan }'
    as: r
    item:
      id: '{{ r.EipExposureToShodanId }}'
      name: '{{ r.EipExposureToShodanId }}'
      resource_type: eip_exposure_to_shodan
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.eip_unassigned_cleanup_required
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeEipUnassignedCleanupRequireds
    params: {}
    save_as: eip_unassigned_cleanup_required_response
  emit:
    items_for: '{ eip_unassigned_cleanup_required_response.EipUnassignedCleanupRequireds.EipUnassignedCleanupRequired }'
    as: r
    item:
      id: '{{ r.EipUnassignedCleanupRequiredId }}'
      name: '{{ r.EipUnassignedCleanupRequiredId }}'
      resource_type: eip_unassigned_cleanup_required
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.elastic
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeElastics
    params: {}
    save_as: elastic_response
  emit:
    items_for: '{ elastic_response.Elastics.Elastic }'
    as: r
    item:
      id: '{{ r.ElasticId }}'
      name: '{{ r.ElasticId }}'
      resource_type: elastic
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.ensure
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeEnsures
    params: {}
    save_as: ensure_response
  emit:
    items_for: '{ ensure_response.Ensures.Ensure }'
    as: r
    item:
      id: '{{ r.EnsureId }}'
      name: '{{ r.EnsureId }}'
      resource_type: ensure
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.firewall
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeFirewalls
    params: {}
    save_as: firewall_response
  emit:
    items_for: '{ firewall_response.Firewalls.Firewall }'
    as: r
    item:
      id: '{{ r.FirewallId }}'
      name: '{{ r.FirewallId }}'
      resource_type: firewall
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.image
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeImages
    params: {}
    save_as: image_response
  emit:
    items_for: '{ image_response.Images.Image }'
    as: r
    item:
      id: '{{ r.ImageId }}'
      name: '{{ r.ImageId }}'
      resource_type: image
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.image_public_access_blocked
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeImagePublicAccessBlockeds
    params: {}
    save_as: image_public_access_blocked_response
  emit:
    items_for: '{ image_public_access_blocked_response.ImagePublicAccessBlockeds.ImagePublicAccessBlocked }'
    as: r
    item:
      id: '{{ r.ImagePublicAccessBlockedId }}'
      name: '{{ r.ImagePublicAccessBlockedId }}'
      resource_type: image_public_access_blocked
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.instance
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeInstances
    params: {}
    save_as: instance_response
  emit:
    items_for: '{ instance_response.Instances.Instance }'
    as: r
    item:
      id: '{{ r.InstanceId }}'
      name: '{{ r.InstanceId }}'
      resource_type: instance
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.instance_managed_by_ssm_agent_installed
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeInstanceManagedBySsmAgentInstalleds
    params: {}
    save_as: instance_managed_by_ssm_agent_installed_response
  emit:
    items_for: '{ instance_managed_by_ssm_agent_installed_response.InstanceManagedBySsmAgentInstalleds.InstanceManagedBySsmAgentInstalled
      }'
    as: r
    item:
      id: '{{ r.InstanceManagedBySsmAgentInstalledId }}'
      name: '{{ r.InstanceManagedBySsmAgentInstalledId }}'
      resource_type: instance_managed_by_ssm_agent_installed
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.key_pair
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeKeyPairs
    params: {}
    save_as: key_pair_response
  emit:
    items_for: '{ key_pair_response.KeyPairs.KeyPair }'
    as: r
    item:
      id: '{{ r.KeyPairId }}'
      name: '{{ r.KeyPairId }}'
      resource_type: key_pair
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.launch
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeLaunchs
    params: {}
    save_as: launch_response
  emit:
    items_for: '{ launch_response.Launchs.Launch }'
    as: r
    item:
      id: '{{ r.LaunchId }}'
      name: '{{ r.LaunchId }}'
      resource_type: launch
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.launch_template
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeLaunchTemplates
    params: {}
    save_as: launch_template_response
  emit:
    items_for: '{ launch_template_response.LaunchTemplates.LaunchTemplate }'
    as: r
    item:
      id: '{{ r.LaunchTemplateId }}'
      name: '{{ r.LaunchTemplateId }}'
      resource_type: launch_template
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.load_balancer
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeLoadBalancers
    params: {}
    save_as: load_balancer_response
  emit:
    items_for: '{ load_balancer_response.LoadBalancers.LoadBalancer }'
    as: r
    item:
      id: '{{ r.LoadBalancerId }}'
      name: '{{ r.LoadBalancerId }}'
      resource_type: load_balancer
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.loadbalancer
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeLoadbalancers
    params: {}
    save_as: loadbalancer_response
  emit:
    items_for: '{ loadbalancer_response.Loadbalancers.Loadbalancer }'
    as: r
    item:
      id: '{{ r.LoadbalancerId }}'
      name: '{{ r.LoadbalancerId }}'
      resource_type: loadbalancer
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.management
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeManagements
    params: {}
    save_as: management_response
  emit:
    items_for: '{ management_response.Managements.Management }'
    as: r
    item:
      id: '{{ r.ManagementId }}'
      name: '{{ r.ManagementId }}'
      resource_type: management
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.management_compliance_standards_met
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeManagementComplianceStandardsMets
    params: {}
    save_as: management_compliance_standards_met_response
  emit:
    items_for: '{ management_compliance_standards_met_response.ManagementComplianceStandardsMets.ManagementComplianceStandardsMet
      }'
    as: r
    item:
      id: '{{ r.ManagementComplianceStandardsMetId }}'
      name: '{{ r.ManagementComplianceStandardsMetId }}'
      resource_type: management_compliance_standards_met
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.network_custom_vpc_required
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeNetworkCustomVpcRequireds
    params: {}
    save_as: network_custom_vpc_required_response
  emit:
    items_for: '{ network_custom_vpc_required_response.NetworkCustomVpcRequireds.NetworkCustomVpcRequired }'
    as: r
    item:
      id: '{{ r.NetworkCustomVpcRequiredId }}'
      name: '{{ r.NetworkCustomVpcRequiredId }}'
      resource_type: network_custom_vpc_required
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.network_modern_architecture_required
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeNetworkModernArchitectureRequireds
    params: {}
    save_as: network_modern_architecture_required_response
  emit:
    items_for: '{ network_modern_architecture_required_response.NetworkModernArchitectureRequireds.NetworkModernArchitectureRequired
      }'
    as: r
    item:
      id: '{{ r.NetworkModernArchitectureRequiredId }}'
      name: '{{ r.NetworkModernArchitectureRequiredId }}'
      resource_type: network_modern_architecture_required
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.networkacl
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeNetworkacls
    params: {}
    save_as: networkacl_response
  emit:
    items_for: '{ networkacl_response.Networkacls.Networkacl }'
    as: r
    item:
      id: '{{ r.NetworkaclId }}'
      name: '{{ r.NetworkaclId }}'
      resource_type: networkacl
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.patch
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribePatchs
    params: {}
    save_as: patch_response
  emit:
    items_for: '{ patch_response.Patchs.Patch }'
    as: r
    item:
      id: '{{ r.PatchId }}'
      name: '{{ r.PatchId }}'
      resource_type: patch
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.patch_management_compliance_standards_met
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribePatchManagementComplianceStandardsMets
    params: {}
    save_as: patch_management_compliance_standards_met_response
  emit:
    items_for: '{ patch_management_compliance_standards_met_response.PatchManagementComplianceStandardsMets.PatchManagementComplianceStandardsMet
      }'
    as: r
    item:
      id: '{{ r.PatchManagementComplianceStandardsMetId }}'
      name: '{{ r.PatchManagementComplianceStandardsMetId }}'
      resource_type: patch_management_compliance_standards_met
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.project
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeProjects
    params: {}
    save_as: project_response
  emit:
    items_for: '{ project_response.Projects.Project }'
    as: r
    item:
      id: '{{ r.ProjectId }}'
      name: '{{ r.ProjectId }}'
      resource_type: project
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.public
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribePublics
    params: {}
    save_as: public_response
  emit:
    items_for: '{ public_response.Publics.Public }'
    as: r
    item:
      id: '{{ r.PublicId }}'
      name: '{{ r.PublicId }}'
      resource_type: public
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.public_address_shodan_detected
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribePublicAddressShodanDetecteds
    params: {}
    save_as: public_address_shodan_detected_response
  emit:
    items_for: '{ public_address_shodan_detected_response.PublicAddressShodanDetecteds.PublicAddressShodanDetected }'
    as: r
    item:
      id: '{{ r.PublicAddressShodanDetectedId }}'
      name: '{{ r.PublicAddressShodanDetectedId }}'
      resource_type: public_address_shodan_detected
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.ram_role
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeRamRoles
    params: {}
    save_as: ram_role_response
  emit:
    items_for: '{ ram_role_response.RamRoles.RamRole }'
    as: r
    item:
      id: '{{ r.RamRoleId }}'
      name: '{{ r.RamRoleId }}'
      resource_type: ram_role
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.security_group
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeSecurityGroups
    params: {}
    save_as: security_group_response
  emit:
    items_for: '{ security_group_response.SecurityGroups.SecurityGroup }'
    as: r
    item:
      id: '{{ r.SecurityGroupId }}'
      name: '{{ r.SecurityGroupId }}'
      resource_type: security_group
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.securitygroup_default_deny_all_traffic
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeSecuritygroupDefaultDenyAllTraffics
    params: {}
    save_as: securitygroup_default_deny_all_traffic_response
  emit:
    items_for: '{ securitygroup_default_deny_all_traffic_response.SecuritygroupDefaultDenyAllTraffics.SecuritygroupDefaultDenyAllTraffic
      }'
    as: r
    item:
      id: '{{ r.SecuritygroupDefaultDenyAllTrafficId }}'
      name: '{{ r.SecuritygroupDefaultDenyAllTrafficId }}'
      resource_type: securitygroup_default_deny_all_traffic
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.securitygroup_ingress_tcp_3389_from_internet_blocked
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeSecuritygroupIngressTcp3389FromInternetBlockeds
    params: {}
    save_as: securitygroup_ingress_tcp_3389_from_internet_blocked_response
  emit:
    items_for: '{ securitygroup_ingress_tcp_3389_from_internet_blocked_response.SecuritygroupIngressTcp3389FromInternetBlockeds.SecuritygroupIngressTcp3389FromInternetBlocked
      }'
    as: r
    item:
      id: '{{ r.SecuritygroupIngressTcp3389FromInternetBlockedId }}'
      name: '{{ r.SecuritygroupIngressTcp3389FromInternetBlockedId }}'
      resource_type: securitygroup_ingress_tcp_3389_from_internet_blocked
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.securitygroup_ingress_tcp_port_22_internet_access_blocked
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeSecuritygroupIngressTcpPort22InternetAccessBlockeds
    params: {}
    save_as: securitygroup_ingress_tcp_port_22_internet_access_blocked_response
  emit:
    items_for: '{ securitygroup_ingress_tcp_port_22_internet_access_blocked_response.SecuritygroupIngressTcpPort22InternetAccessBlockeds.SecuritygroupIngressTcpPort22InternetAccessBlocked
      }'
    as: r
    item:
      id: '{{ r.SecuritygroupIngressTcpPort22InternetAccessBlockedId }}'
      name: '{{ r.SecuritygroupIngressTcpPort22InternetAccessBlockedId }}'
      resource_type: securitygroup_ingress_tcp_port_22_internet_access_blocked
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.snapshot
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeSnapshots
    params: {}
    save_as: snapshot_response
  emit:
    items_for: '{ snapshot_response.Snapshots.Snapshot }'
    as: r
    item:
      id: '{{ r.SnapshotId }}'
      name: '{{ r.SnapshotId }}'
      resource_type: snapshot
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.stopped
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeStoppeds
    params: {}
    save_as: stopped_response
  emit:
    items_for: '{ stopped_response.Stoppeds.Stopped }'
    as: r
    item:
      id: '{{ r.StoppedId }}'
      name: '{{ r.StoppedId }}'
      resource_type: stopped
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.subnet
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeSubnets
    params: {}
    save_as: subnet_response
  emit:
    items_for: '{ subnet_response.Subnets.Subnet }'
    as: r
    item:
      id: '{{ r.SubnetId }}'
      name: '{{ r.SubnetId }}'
      resource_type: subnet
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.task
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeTasks
    params: {}
    save_as: task_response
  emit:
    items_for: '{ task_response.Tasks.Task }'
    as: r
    item:
      id: '{{ r.TaskId }}'
      name: '{{ r.TaskId }}'
      resource_type: task
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.task_definitions
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeTaskDefinitionss
    params: {}
    save_as: task_definitions_response
  emit:
    items_for: '{ task_definitions_response.TaskDefinitionss.TaskDefinitions }'
    as: r
    item:
      id: '{{ r.TaskDefinitionsId }}'
      name: '{{ r.TaskDefinitionsId }}'
      resource_type: task_definitions
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.training_job
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeTrainingJobs
    params: {}
    save_as: training_job_response
  emit:
    items_for: '{ training_job_response.TrainingJobs.TrainingJob }'
    as: r
    item:
      id: '{{ r.TrainingJobId }}'
      name: '{{ r.TrainingJobId }}'
      resource_type: training_job
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.training_job_inter_container
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeTrainingJobInterContainers
    params: {}
    save_as: training_job_inter_container_response
  emit:
    items_for: '{ training_job_inter_container_response.TrainingJobInterContainers.TrainingJobInterContainer }'
    as: r
    item:
      id: '{{ r.TrainingJobInterContainerId }}'
      name: '{{ r.TrainingJobInterContainerId }}'
      resource_type: training_job_inter_container
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.transitgateway
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeTransitgateways
    params: {}
    save_as: transitgateway_response
  emit:
    items_for: '{ transitgateway_response.Transitgateways.Transitgateway }'
    as: r
    item:
      id: '{{ r.TransitgatewayId }}'
      name: '{{ r.TransitgatewayId }}'
      resource_type: transitgateway
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.trusted
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeTrusteds
    params: {}
    save_as: trusted_response
  emit:
    items_for: '{ trusted_response.Trusteds.Trusted }'
    as: r
    item:
      id: '{{ r.TrustedId }}'
      name: '{{ r.TrustedId }}'
      resource_type: trusted
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.unattached
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeUnattacheds
    params: {}
    save_as: unattached_response
  emit:
    items_for: '{ unattached_response.Unattacheds.Unattached }'
    as: r
    item:
      id: '{{ r.UnattachedId }}'
      name: '{{ r.UnattachedId }}'
      resource_type: unattached
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.unattached_disks
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeUnattachedDiskss
    params: {}
    save_as: unattached_disks_response
  emit:
    items_for: '{ unattached_disks_response.UnattachedDiskss.UnattachedDisks }'
    as: r
    item:
      id: '{{ r.UnattachedDisksId }}'
      name: '{{ r.UnattachedDisksId }}'
      resource_type: unattached_disks
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.volume
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeVolumes
    params: {}
    save_as: volume_response
  emit:
    items_for: '{ volume_response.Volumes.Volume }'
    as: r
    item:
      id: '{{ r.VolumeId }}'
      name: '{{ r.VolumeId }}'
      resource_type: volume
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.volume_attached_to_instance
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeVolumeAttachedToInstances
    params: {}
    save_as: volume_attached_to_instance_response
  emit:
    items_for: '{ volume_attached_to_instance_response.VolumeAttachedToInstances.VolumeAttachedToInstance }'
    as: r
    item:
      id: '{{ r.VolumeAttachedToInstanceId }}'
      name: '{{ r.VolumeAttachedToInstanceId }}'
      resource_type: volume_attached_to_instance
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.vpn_gateway_endpoint
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeVpnGatewayEndpoints
    params: {}
    save_as: vpn_gateway_endpoint_response
  emit:
    items_for: '{ vpn_gateway_endpoint_response.VpnGatewayEndpoints.VpnGatewayEndpoint }'
    as: r
    item:
      id: '{{ r.VpnGatewayEndpointId }}'
      name: '{{ r.VpnGatewayEndpointId }}'
      resource_type: vpn_gateway_endpoint
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.vulnerability
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeVulnerabilitys
    params: {}
    save_as: vulnerability_response
  emit:
    items_for: '{ vulnerability_response.Vulnerabilitys.Vulnerability }'
    as: r
    item:
      id: '{{ r.VulnerabilityId }}'
      name: '{{ r.VulnerabilityId }}'
      resource_type: vulnerability
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.ecs.vulnerability_scan_scheduled
  calls:
  - product: Ecs
    version: '2014-05-26'
    action: DescribeVulnerabilityScanScheduleds
    params: {}
    save_as: vulnerability_scan_scheduled_response
  emit:
    items_for: '{ vulnerability_scan_scheduled_response.VulnerabilityScanScheduleds.VulnerabilityScanScheduled }'
    as: r
    item:
      id: '{{ r.VulnerabilityScanScheduledId }}'
      name: '{{ r.VulnerabilityScanScheduledId }}'
      resource_type: vulnerability_scan_scheduled
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
checks:
- rule_id: alicloud.ecs.ami.public
  title: Elastic Compute Service AMI should not be publicly accessible
  severity: high
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AC-17_0013
  for_each: alicloud.ecs.ami
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.backup.automated_enabled
  title: Ensure Elastic Compute Service instances have automated backup enabled
  severity: low
  assertion_id: cisa_ce_v1_multi_cloud_Booting_Up-1_0009
  for_each: alicloud.ecs.backup
  params: {}
  conditions:
    var: item.backup_enabled
    op: equals
    value: true
- rule_id: alicloud.ecs.client.vpn_endpoint_connection_logging_enabled
  title: Ensure Elastic Compute Service Client VPN Endpoint Connection Logging is Enabled
  severity: medium
  assertion_id: iso27001_2022_multi_cloud_A.8.15_0070
  for_each: alicloud.ecs.client
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.ecs.compute_service.vm_data_volumes_encrypted_cmek
  title: Ensure Elastic Compute Service VM data volumes are encrypted with Customer-Managed Encryption Keys
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.compute_service
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.kms_key_id
      op: exists
- rule_id: alicloud.ecs.compute_service.vm_imds_hardened
  title: Ensure Elastic Compute Service instances have hardened Instance Metadata Service configuration
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.compute_service
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.compute_service.vm_no_public_ip_assigned
  title: Elastic Compute Service instances should not have public IP addresses assigned
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.compute_service
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.ecs.compute_service.vm_root_volume_encrypted_cmek
  title: Ensure Elastic Compute Service VM root volumes are encrypted with Customer Managed Encryption Keys
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.compute_service
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.kms_key_id
      op: exists
- rule_id: alicloud.ecs.compute_service.vm_secure_boot_enabled
  title: Ensure Elastic Compute Service instances have Secure Boot enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.compute_service
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.compute_service.vm_security_group_inbound_restricted
  title: Elastic Compute Service Security Groups Should Restrict Inbound Traffic Access
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.compute_service
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.compute_service.vm_serial_console_access_restricted
  title: Ensure Alibaba Cloud Elastic Compute Service Virtual Machine Serial Console Access is Restricted
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.compute_service
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.compute_service.vm_ssh_key_based_auth_required
  title: Elastic Compute Service instances must use SSH key-based authentication instead of password authentication
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.compute_service
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.compute_service.vm_ssh_password_auth_disabled
  title: Ensure Elastic Compute Service instances have SSH password authentication disabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.compute_service
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.custom_image.image_approved_image_allowlist_enforced
  title: Elastic Compute Service Custom Images Must Use Approved Image Allowlist
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.custom_image
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.custom_image.image_encrypted_cmek
  title: Ensure Elastic Compute Service custom images are encrypted with Customer Managed Encryption Keys
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.custom_image
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.kms_key_id
      op: exists
- rule_id: alicloud.ecs.custom_image.image_image_signed_and_verified
  title: Ensure Elastic Compute Service custom images are digitally signed and verified
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.custom_image
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.custom_image.image_not_publicly_shared
  title: Elastic Compute Service Custom Images Should Not Be Publicly Shared
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.custom_image
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.ecs.custom_image.image_vuln_scanned_no_critical
  title: Elastic Compute Service Custom Images Must Be Scanned for Vulnerabilities with No Critical Issues
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.custom_image
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.disk.cmk_cmek_configured
  title: Elastic Compute Service disk should be encrypted with Customer Master Key (CMK)
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.disk
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.kms_key_id
      op: exists
- rule_id: alicloud.ecs.disk.encryption_at_rest_enabled
  title: Elastic Compute Service disk encryption at rest should be enabled
  severity: high
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_CM-6_0046
  for_each: alicloud.ecs.disk
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.ecs.disk.public_snapshot_access_blocked
  title: Ensure Elastic Compute Service disk snapshots are not publicly accessible
  severity: high
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AC-17_0013
  for_each: alicloud.ecs.disk
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.backup_enabled
      op: equals
      value: true
- rule_id: alicloud.ecs.disk.snapshot_public_access_block_enforced
  title: Elastic Compute Service Disk Snapshot Public Access Block Must Be Enforced
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.disk
  params: {}
  conditions:
    var: item.backup_enabled
    op: equals
    value: true
- rule_id: alicloud.ecs.disk.snapshots_encrypted
  title: Ensure Elastic Compute Service disk snapshots are encrypted
  severity: low
  assertion_id: cisa_ce_v1_multi_cloud_Your_Data-2_0018
  for_each: alicloud.ecs.disk
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.ecs.disk.volume_cmk_cmek_configured
  title: Elastic Compute Service disk volumes should be encrypted with Customer Master Key (CMK)
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.disk
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.kms_key_id
      op: exists
- rule_id: alicloud.ecs.disk.volume_encryption_at_rest_enabled
  title: Alibaba Cloud Elastic Compute Service disk volumes should have encryption at rest enabled
  severity: high
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_CM-6_0046
  for_each: alicloud.ecs.disk
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.ecs.disk.volume_snapshots_configured
  title: Ensure Elastic Compute Service disk volume snapshots are properly configured
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.disk
  params: {}
  conditions:
    var: item.backup_enabled
    op: equals
    value: true
- rule_id: alicloud.ecs.disk.volume_snapshots_encrypted
  title: Ensure Elastic Compute Service disk volume snapshots are encrypted
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.disk
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.ecs.disk_default_encryption_at_rest_enabled.configured
  title: Ensure Elastic Compute Service disk default encryption at rest is configured
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.disk_default_encryption_at_rest_enabled
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.ecs.disk_public_snapshot_access_blocked.configured
  title: Elastic Compute Service disk snapshots should block public access
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.disk_public_snapshot_access_blocked
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.ecs.disk_volume.backup_plan_enforced
  title: Elastic Compute Service Disk Volume Backup Plan Enforcement
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.disk_volume
  params: {}
  conditions:
    var: item.backup_enabled
    op: equals
    value: true
- rule_id: alicloud.ecs.disk_volume.encryption_at_rest_enabled
  title: Elastic Compute Service disk volumes should have encryption at rest enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.disk_volume
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.ecs.disk_volume_encryption_at_rest_enabled.configured
  title: Ensure Alibaba Cloud Elastic Compute Service disk volume encryption at rest is configured
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.disk_volume_encryption_at_rest_enabled
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.ecs.e_hpc.training_job_vpc_configured
  title: Ensure Elastic High Performance Computing Training Jobs are Configured with VPC
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.e_hpc
  params: {}
  conditions:
    var: item.vpc_id
    op: exists
- rule_id: alicloud.ecs.e_hpc.training_pipeline_private_networking_enforced
  title: Ensure Elastic High Performance Computing Training Pipeline Uses Private Network Configuration
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.e_hpc
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.e_hpc.training_pipeline_secrets_from_vault_only
  title: Ensure Elastic High Performance Computing Training Pipeline Secrets Are Retrieved From Vault Only
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.e_hpc
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.e_hpc_ai.network_isolation_enabled
  title: Elastic High Performance Computing AI Instances Should Have Network Isolation Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.e_hpc_ai
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.ebs.default_encryption
  title: Ensure Elastic Block Storage Default Encryption is Enabled for Elastic Compute Service Instances
  severity: high
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_SC-13_0136
  for_each: alicloud.ecs.ebs
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.ecs.ebs.public_snapshot
  title: Elastic Compute Service Elastic Block Storage snapshots should not be publicly accessible
  severity: high
  assertion_id: hipaa_multi_cloud_164_308_a_1_ii_b_0002
  for_each: alicloud.ecs.ebs
  params: {}
  conditions:
    var: item.backup_enabled
    op: equals
    value: true
- rule_id: alicloud.ecs.ebs.public_snapshot_alicloud_rds_instance_no_public_access_alicloud_ack_endpoints_not_publicly_accessible_alicloud_oss_account_level_public_access_blocks_alicloud_awslambda_function_not_publicly_accessible_alicloud_emr_cluster_master_nodes_no_public_ip_alicloud_ecs_instance_public_ip_alicloud_cms_log_metric_filter_root_usage_alicloud_rds_snapshots_public_access_alicloud_elasticsearch_service_domains_not_publicly_accessible_alicloud_analyticdb_cluster_public_access_alicloud_oss_bucket_policy_public_write_access_alicloud_oss_bucket_public_write_acl_alicloud_dts_instance_no_public_access_alicloud_pai_notebook_instance_without_direct_internet_access_configured
  title: Ensure Multiple AliCloud Services Are Not Publicly Accessible to Prevent Unauthorized Access
  severity: high
  assertion_id: pci_dss_v4_multi_cloud_1.2.1_0003
  for_each: alicloud.ecs.ebs
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.backup_enabled
      op: equals
      value: true
- rule_id: alicloud.ecs.ebs.public_snapshot_alicloud_rds_instance_no_public_access_alicloud_ack_endpoints_not_publicly_accessible_alicloud_vpc_endpoint_for_ec2_enabled_alicloud_oss_account_level_public_access_blocks_alicloud_awslambda_function_not_publicly_accessible_alicloud_emr_cluster_master_nodes_no_public_ip_alicloud_ecs_instance_public_ip_alicloud_rds_snapshots_public_access_alicloud_elasticsearch_service_domains_not_publicly_accessible_alicloud_analyticdb_cluster_public_access_alicloud_awslambda_function_inside_vpc_alicloud_dts_instance_no_public_access_alicloud_pai_notebook_instance_without_direct_internet_access_configured_alicloud_oss_bucket_policy_public_write_access_alicloud_ecs_securitygroup_allow_ingress_from_internet_to_tcp_port_22_alicloud_oss_bucket_public_write_acl_alicloud_ecs_securitygroup_allow_ingress_from_internet_to_all_ports_alicloud_ecs_networkacl_allow_ingress_tcp_port_22_alicloud_ecs_networkacl_allow_ingress_tcp_port_3389_alicloud_ecs_securitygroup_default_restrict_traffic
  title: Ensure Multiple AliCloud Services Are Not Publicly Accessible to Prevent Unauthorized Access
  severity: high
  assertion_id: pci_dss_v4_multi_cloud_1.2.1_0003
  for_each: alicloud.ecs.ebs
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.backup_enabled
      op: equals
      value: true
- rule_id: alicloud.ecs.ebs.public_snapshot_alicloud_rds_instance_no_public_access_alicloud_ack_endpoints_not_publicly_accessible_alicloud_vpc_endpoint_for_ec2_enabled_alicloud_oss_account_level_public_access_blocks_alicloud_awslambda_function_not_publicly_accessible_alicloud_emr_cluster_master_nodes_no_public_ip_alicloud_ecs_instance_public_ip_alicloud_rds_snapshots_public_access_alicloud_elasticsearch_service_domains_not_publicly_accessible_alicloud_analyticdb_cluster_public_access_alicloud_awslambda_function_inside_vpc_alicloud_ecs_securitygroup_allow_ingress_from_internet_to_tcp_port_22_alicloud_dts_instance_no_public_access_alicloud_pai_notebook_instance_without_direct_internet_access_configured
  title: Ensure Elastic Block Storage snapshots and multiple AliCloud services are not publicly accessible
  severity: high
  assertion_id: pci_dss_v4_multi_cloud_1.2.1_0003
  for_each: alicloud.ecs.ebs
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.backup_enabled
      op: equals
      value: true
- rule_id: alicloud.ecs.ebs.public_snapshot_alicloud_rds_instance_no_public_access_alicloud_awslambda_function_not_publicly_accessible_alicloud_rds_snapshots_public_access_alicloud_elasticsearch_service_domains_not_publicly_accessible_alicloud_analyticdb_cluster_public_access_alicloud_oss_bucket_policy_public_write_access_alicloud_awslambda_function_inside_vpc_alicloud_ecs_securitygroup_allow_ingress_from_internet_to_tcp_port_22_alicloud_oss_bucket_public_write_acl_alicloud_dts_instance_no_public_access_alicloud_pai_notebook_instance_without_direct_internet_access_configured
  title: Ensure Elastic Block Storage snapshots and multiple AliCloud services are not publicly accessible
  severity: high
  assertion_id: pci_dss_v4_multi_cloud_1.2.1_0003
  for_each: alicloud.ecs.ebs
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.backup_enabled
      op: equals
      value: true
- rule_id: alicloud.ecs.ebs.public_snapshot_alicloud_rds_instance_no_public_access_alicloud_ecs_securitygroup_default_restrict_traffic_alicloud_ecs_securitygroup_allow_ingress_from_internet_to_all_ports_alicloud_ecs_networkacl_allow_ingress_tcp_port_22_alicloud_awslambda_function_not_publicly_accessible_alicloud_rds_snapshots_public_access_alicloud_elasticsearch_service_domains_not_publicly_accessible_alicloud_analyticdb_cluster_public_access_alicloud_oss_bucket_policy_public_write_access_alicloud_awslambda_function_inside_vpc_alicloud_ecs_securitygroup_allow_ingress_from_internet_to_tcp_port_22_alicloud_oss_bucket_public_write_acl_alicloud_dts_instance_no_public_access_alicloud_pai_notebook_instance_without_direct_internet_access_configured_alicloud_ecs_networkacl_allow_ingress_tcp_port_3389
  title: Ensure Elastic Block Storage snapshots and multiple AliCloud services are not publicly accessible
  severity: high
  assertion_id: pci_dss_v4_multi_cloud_1.2.1_0003
  for_each: alicloud.ecs.ebs
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.backup_enabled
      op: equals
      value: true
- rule_id: alicloud.ecs.ebs.snapshot_account_block_public_access
  title: Elastic Compute Service Elastic Block Storage snapshots should have account-level public access blocking enabled
  severity: high
  assertion_id: hipaa_multi_cloud_164_308_a_1_ii_b_0002
  for_each: alicloud.ecs.ebs
  params: {}
  conditions:
    var: item.backup_enabled
    op: equals
    value: true
- rule_id: alicloud.ecs.ebs.snapshots_encrypted
  title: Ensure Elastic Compute Service Elastic Block Storage snapshots are encrypted
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.24_0080
  for_each: alicloud.ecs.ebs
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.ecs.ebs.volume_encryption
  title: Ensure Elastic Compute Service EBS volumes have encryption enabled
  severity: high
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_SC-13_0136
  for_each: alicloud.ecs.ebs
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.ecs.ebs.volume_encryption_enabled
  title: Alibaba Cloud Elastic Compute Service EBS Volume Encryption Should Be Enabled
  severity: high
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_SC-28_0144
  for_each: alicloud.ecs.ebs
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.ecs.ebs.volume_protected_by_backup_plan
  title: Ensure Elastic Block Storage Volumes Are Protected By Backup Plan
  severity: medium
  assertion_id: iso27001_2022_multi_cloud_A.8.14_0069
  for_each: alicloud.ecs.ebs
  params: {}
  conditions:
    var: item.backup_enabled
    op: equals
    value: true
- rule_id: alicloud.ecs.ebs.volume_snapshots_exists
  title: Elastic Compute Service Elastic Block Storage Volume Snapshots Should Exist
  severity: low
  assertion_id: soc2_multi_cloud_cc_7_5_0019
  for_each: alicloud.ecs.ebs
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.eip_exposure_to_shodan.configured
  title: Elastic Compute Service Elastic IP Address exposure to Shodan scanning should be configured
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.eip_exposure_to_shodan
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.eip_unassigned_cleanup_required.configured
  title: Elastic Compute Service Unassigned Elastic IP Address Cleanup Configuration Required
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.eip_unassigned_cleanup_required
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.elastic.ip_shodan
  title: Elastic Compute Service Elastic IP addresses should not be exposed in Shodan search engine
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.elastic
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.elastic.ip_unassigned
  title: Ensure Elastic Compute Service Elastic IP addresses are not unassigned
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.elastic
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.ensure.attached_disks_encrypted_with_cmk
  title: Ensure Elastic Compute Service Attached Disks Are Encrypted With Customer Master Keys
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.ensure
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.kms_key_id
      op: exists
- rule_id: alicloud.ecs.ensure.unattached_disks_encrypted_with_cmk
  title: Ensure Unattached Elastic Compute Service Disks Are Encrypted With Customer Master Keys
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.ensure
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.kms_key_id
      op: exists
- rule_id: alicloud.ecs.ensure.using_managed_disks
  title: Ensure Elastic Compute Service instances are using managed disks instead of unmanaged disks
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.ensure
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.ecs.firewall.rdp_access_internet_blocked
  title: Elastic Compute Service Security Groups Should Block RDP Access from Internet
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.firewall
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:3389
- rule_id: alicloud.ecs.firewall.ssh_access_internet_blocked
  title: Elastic Compute Service Security Groups Should Block SSH Access from Internet
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.firewall
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:22
- rule_id: alicloud.ecs.image.vulnerability_scan_passed
  title: Ensure Elastic Compute Service images have passed vulnerability scanning
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.image
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.image_public_access_blocked.configured
  title: Ensure Elastic Compute Service custom images are not publicly accessible
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.image_public_access_blocked
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.ecs.instance.age_check_older_than_90_days
  title: Elastic Compute Service instances should not exceed 90 days age limit for security compliance
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_CM-2_0042
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.cassandra_port_internet_blocked
  title: Elastic Compute Service instances should block Cassandra port access from internet
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.ecs.instance.cifs_port_internet_blocked
  title: Elastic Compute Service instances should block CIFS port 445 from internet access
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.ecs.instance.confidential_computing_enforced
  title: Ensure Elastic Compute Service instances have confidential computing enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.configured
  title: Elastic Compute Service instances must be properly configured with security settings
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.critical_cve_remediated
  title: Ensure Elastic Compute Service instances have critical CVE vulnerabilities remediated
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.csek_encryption_at_rest_enabled
  title: Elastic Compute Service instances should have Customer-Supplied Encryption Key (CSEK) encryption at rest enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.kms_key_id
      op: exists
- rule_id: alicloud.ecs.instance.default_service_account_in_use_with_full_api_access
  title: Elastic Compute Service Instance Using Default Service Account With Full API Access
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.instance.detailed_monitoring_active
  title: Ensure Elastic Compute Service instances have detailed monitoring enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.ecs.instance.detailed_monitoring_mandatory
  title: Elastic Compute Service instances must have detailed monitoring enabled
  severity: medium
  assertion_id: rbi_nbfc_multi_cloud_3.2_0018
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.ecs.instance.elasticsearch_kibana_port_internet_blocked
  title: Elastic Compute Service instances should block Elasticsearch Kibana port access from internet
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.permissions
      op: not_contains
      value: '*'
- rule_id: alicloud.ecs.instance.env_no_plaintext_secrets
  title: Elastic Compute Service instances should not contain plaintext secrets in environment variables
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.ftp_port_internet_blocked
  title: Elastic Compute Service instances should block FTP port access from the internet
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:21
- rule_id: alicloud.ecs.instance.iam_profile_attached
  title: Elastic Compute Service instances should have IAM instance profiles attached
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_CM-6_0046
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.instance.imdsv2_mandatory
  title: Elastic Compute Service instances must enforce IMDSv2 for metadata access
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.14_0069
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.instance_profile_least_privilege
  title: Elastic Compute Service instances should use instance profiles with least privilege permissions
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.instance.internet_facing_instance_profile_least_privilege
  title: Ensure Elastic Compute Service Internet-Facing Instances Use RAM Roles with Least Privilege Permissions
  severity: high
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.instance.ip_forwarding_disabled_for_security
  title: Ensure Elastic Compute Service instances have IP forwarding disabled for security
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.kafka_port_internet_blocked
  title: Elastic Compute Service instances should block Kafka port access from internet
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.ecs.instance.kerberos_port_internet_blocked
  title: Elastic Compute Service instances should block Kerberos port access from internet
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.ecs.instance.ldap_port_internet_blocked
  title: Elastic Compute Service instances should block LDAP port access from internet
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.ecs.instance.least_privilege_service_account
  title: Elastic Compute Service instances should use least privilege service accounts
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.instance.managed
  title: Ensure Elastic Compute Service instances are managed by Operations Orchestration Service
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_CM-2_0042
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.managed_by_ssm
  title: Ensure Elastic Compute Service instances are managed by Systems Manager
  severity: low
  assertion_id: hipaa_multi_cloud_164_308_a_5_ii_b_0012
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.management_enabled
  title: Elastic Compute Service Instance Management Should Be Enabled
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.14_0069
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.ecs.instance.memcached_port_internet_blocked
  title: Elastic Compute Service instances should block Memcached port access from internet
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.ecs.instance.mongodb_port_internet_blocked
  title: Elastic Compute Service instances should block MongoDB port access from internet
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:27017
- rule_id: alicloud.ecs.instance.mysql_port_internet_blocked
  title: Elastic Compute Service instances should block MySQL port access from internet
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:3306
- rule_id: alicloud.ecs.instance.network_type_verified
  title: Elastic Compute Service Instance Network Type Should Be Verified and Properly Configured
  severity: medium
  assertion_id: iso27001_2022_multi_cloud_A.8.14_0069
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.no_privileged_containers
  title: Elastic Compute Service instances should not run privileged containers
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.instance.no_public_ip_assigned
  title: Elastic Compute Service instances should not have public IP addresses assigned
  severity: high
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AC-17_0013
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.ecs.instance.oracle_port_internet_blocked
  title: Elastic Compute Service Instance Oracle Database Port Should Be Blocked from Internet Access
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.ecs.instance.os_version_supported
  title: Elastic Compute Service instances should run supported operating system versions
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.paravirtual_type_deprecated
  title: Elastic Compute Service instances should not use deprecated paravirtual virtualization type
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.password_auth_disabled
  title: Elastic Compute Service instances should have password authentication disabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.port_ftp_exposed_to_internet
  title: Elastic Compute Service instance should not expose FTP port to internet
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.port_rdp_exposed_to_internet
  title: Elastic Compute Service instances should not have RDP port 3389 exposed to the internet
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.port_ssh_exposed_to_internet
  title: Elastic Compute Service instances should not expose SSH port 22 to the internet
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    all:
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:22
- rule_id: alicloud.ecs.instance.postgresql_port_internet_blocked
  title: Ensure Elastic Compute Service instances block PostgreSQL port access from internet
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:5432
- rule_id: alicloud.ecs.instance.project_wide_ssh_keys_block_enforced
  title: Ensure Elastic Compute Service instances have project-wide SSH keys blocked
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.security_group_rules
    op: not_contains
    value: 0.0.0.0/0:22
- rule_id: alicloud.ecs.instance.public_ip_detected
  title: Elastic Compute Service Instance Has Public IP Address Assigned
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.public_ip_address
    op: exists
- rule_id: alicloud.ecs.instance.public_ip_disabled
  title: Ensure Elastic Compute Service instances do not have public IP addresses assigned
  severity: high
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AC-17_0013
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.public_ip_disabled_unless_explicitly_approved
  title: Elastic Compute Service instances should not have public IP addresses unless explicitly approved
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.rdp_port_internet_blocked
  title: Elastic Compute Service instances should block RDP port 3389 from internet access
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:3389
- rule_id: alicloud.ecs.instance.rds_sqlserver_port_internet_blocked
  title: Elastic Compute Service instances should block RDS SQL Server port access from internet
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.ecs.instance.redis_port_internet_blocked
  title: Elastic Compute Service instances should block Redis port access from internet
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:6379
- rule_id: alicloud.ecs.instance.secrets_user_data
  title: Elastic Compute Service instances should not contain secrets in user data
  severity: high
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.security_center_agent_installed_and_active
  title: Ensure Elastic Compute Service instances have Security Center Agent installed and active
  severity: low
  assertion_id: cis_alicloud_alicloud_4.6_0168
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.security_hardening_applied
  title: Ensure Elastic Compute Service instances have security hardening configurations applied
  severity: low
  assertion_id: nist_800_53_rev5_multi_cloud_SI-16_1433
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.security_patches_applied
  title: Elastic Compute Service instances should have security patches applied
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.serial_ports_disabled_for_security
  title: Ensure Alibaba Cloud Elastic Compute Service instances have serial console access disabled for security
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.shielded_vm_security_features_enabled
  title: Ensure Elastic Compute Service instances have Shielded VM security features enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.single_eni_usage_verified
  title: Elastic Compute Service instances should use single ENI configuration for network security verification
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.ssh_key_authentication_mandatory
  title: Elastic Compute Service instances must use SSH key authentication instead of password authentication
  severity: high
  assertion_id: rbi_bank_multi_cloud_9.1_0026
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.ssh_port_internet_blocked
  title: Elastic Compute Service instances should block SSH port access from the internet
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:22
- rule_id: alicloud.ecs.instance.telnet_port_public_access_blocked
  title: Ensure Elastic Compute Service instances block public access to Telnet port 23
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:23
- rule_id: alicloud.ecs.instance.unattached_disks_encryption_at_rest_with_customer_managed_keys_enabled
  title: Ensure Elastic Compute Service unattached disks have encryption at rest enabled with customer managed keys
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.kms_key_id
      op: exists
- rule_id: alicloud.ecs.instance.user_data_secrets_exposure_prevented
  title: Elastic Compute Service Instance User Data Should Not Contain Exposed Secrets
  severity: high
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.uses_single_eni
  title: Elastic Compute Service Instance Should Use Single Elastic Network Interface
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.instance.volumes_encrypted
  title: Ensure Elastic Compute Service Instance Volumes Are Encrypted
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.instance
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.ecs.instance_managed_by_ssm_agent_installed.configured
  title: Elastic Compute Service instances should have Systems Manager Agent installed and configured
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.instance_managed_by_ssm_agent_installed
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.key_pair.inactive_keys_disabled_after_90_days
  title: Elastic Compute Service Key Pairs Should Be Disabled After 90 Days of Inactivity
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.key_pair
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.launch.template_imdsv2_required
  title: Elastic Compute Service Launch Templates Must Require Instance Metadata Service Version 2 (IMDSv2)
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.launch
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.launch.template_no_public_ip
  title: Elastic Compute Service Launch Template Should Not Assign Public IP Addresses
  severity: high
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AC-17_0013
  for_each: alicloud.ecs.launch
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.ecs.launch.template_no_secrets
  title: Elastic Compute Service launch templates must not contain hardcoded secrets or credentials
  severity: high
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.launch
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.launch_template.imdsv2_enforcement
  title: Elastic Compute Service launch templates should enforce IMDSv2 for instance metadata access
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.launch_template
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.launch_template.instance_profile_least_privilege
  title: Elastic Compute Service Launch Templates Should Use Instance Profiles with Least Privilege Permissions
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.launch_template
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.launch_template.public_ip_assignment_disabled
  title: Elastic Compute Service Launch Template Should Have Public IP Assignment Disabled
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.launch_template
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.launch_template.root_volume_encrypted_by_default
  title: Elastic Compute Service Launch Template Root Volume Should Be Encrypted By Default
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.launch_template
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.ecs.launch_template.secrets_management_enforced
  title: Elastic Compute Service Launch Template Should Enforce Secrets Management
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.launch_template
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.ecs.launch_template.security_groups_restrictive
  title: Elastic Compute Service Launch Template Security Groups Should Follow Restrictive Access Principles
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.launch_template
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.load_balancer.logging_enabled
  title: Ensure Elastic Compute Service Load Balancer has access logging enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.load_balancer
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.ecs.loadbalancer.traffic_logging_enabled
  title: Elastic Compute Service Load Balancer Traffic Logging Should Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.loadbalancer
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.ecs.management.compliance
  title: Elastic Compute Service instances must comply with security management requirements
  severity: low
  assertion_id: cisa_ce_v1_multi_cloud_Your_Systems-1_0006
  for_each: alicloud.ecs.management
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.management_compliance_standards_met.configured
  title: Ensure Elastic Compute Service instances meet management compliance standards configuration
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.management_compliance_standards_met
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.network_custom_vpc_required.configured
  title: Elastic Compute Service instances must use custom VPC instead of classic network
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.network_custom_vpc_required
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.network_modern_architecture_required.configured
  title: Elastic Compute Service instances must use modern VPC network architecture instead of classic network
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.network_modern_architecture_required
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.networkacl.allow_ingress_tcp_port_22
  title: Elastic Compute Service Network ACL Should Restrict Ingress TCP Port 22 Access
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.networkacl
  params: {}
  conditions:
    all:
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:22
- rule_id: alicloud.ecs.networkacl.allow_ingress_tcp_port_22, alicloud_ecs_securitygroup_allow_ingress_from_internet_to_all_ports,
    alicloud_ecs_networkacl_allow_ingress_tcp_port_3389, alicloud_pai_notebook_instance_without_direct_internet_access_configured
  title: Elastic Compute Service Network ACL and Security Group Ingress Controls for Critical Ports
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.networkacl
  params: {}
  conditions:
    all:
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:22
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:3389
- rule_id: alicloud.ecs.networkacl.allow_ingress_tcp_port_3389
  title: Elastic Compute Service Network ACL Should Restrict Ingress TCP Port 3389 Access
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.networkacl
  params: {}
  conditions:
    all:
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:3389
- rule_id: alicloud.ecs.networkacl.default_in_use
  title: Ensure Elastic Compute Service Network ACL is not using default configuration
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.networkacl
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.networkacl.dns_query_logging_enabled
  title: Ensure Elastic Compute Service Network ACL DNS Query Logging is Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.networkacl
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.ecs.networkacl.ingress_any_port_blocked
  title: Alibaba Cloud Elastic Compute Service Network ACL Should Block Ingress Traffic on All Ports
  severity: medium
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_CM-2_0042
  for_each: alicloud.ecs.networkacl
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.networkacl.ingress_least_privilege_enforced
  title: Elastic Compute Service Network ACL Ingress Rules Should Follow Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.networkacl
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.networkacl.not_legacy
  title: Ensure Elastic Compute Service Network ACLs are not using legacy configurations
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.networkacl
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.networkacl.rdp_port_3389_ingress_restricted
  title: Elastic Compute Service Network ACL Should Restrict RDP Port 3389 Ingress Access
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.networkacl
  params: {}
  conditions:
    all:
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:3389
- rule_id: alicloud.ecs.networkacl.ssh_port_22_ingress_restricted
  title: Elastic Compute Service Network ACL SSH Port 22 Ingress Access Should Be Restricted
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.networkacl
  params: {}
  conditions:
    all:
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:22
- rule_id: alicloud.ecs.networkacl.unrestricted_ingress
  title: Elastic Compute Service Network ACL Should Not Allow Unrestricted Ingress Traffic
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.networkacl
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.networkacl.unused
  title: Ensure unused Elastic Compute Service Network ACLs are removed
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.networkacl
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.networkacl.unused_resources_identified
  title: Elastic Compute Service Network ACL Unused Resources Should Be Identified and Removed
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.networkacl
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.patch.compliance
  title: Elastic Compute Service instances must maintain patch compliance for security updates
  severity: low
  assertion_id: cisa_ce_v1_multi_cloud_Your_Systems-1_0006
  for_each: alicloud.ecs.patch
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.patch_management_compliance_standards_met.configured
  title: Elastic Compute Service instances must meet patch management compliance standards
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.patch_management_compliance_standards_met
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.project.os_login_mfa_enabled
  title: Ensure Elastic Compute Service OS Login Multi-Factor Authentication is Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.project
  params: {}
  conditions:
    var: item.mfa_enabled
    op: equals
    value: true
- rule_id: alicloud.ecs.public.address_shodan
  title: Elastic Compute Service instances with public IP addresses should not be exposed on Shodan search engine
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.public
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.public_address_shodan_detected.configured
  title: Ensure Elastic Compute Service instances with public IP addresses detected by Shodan are properly configured
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.public_address_shodan_detected
  params: {}
  conditions:
    var: item.public_ip_address
    op: exists
- rule_id: alicloud.ecs.ram_role.instance_profile_no_instance_profile_with_admin_star
  title: Elastic Compute Service Instance Profiles Should Not Have Administrative Wildcard Permissions
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.ram_role
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.ram_role.instance_profile_role_policies_least_privilege
  title: Elastic Compute Service Instance Profile RAM Role Policies Should Follow Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.ram_role
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.security_group.all_ports_public_ingress_blocked
  title: Elastic Compute Service Security Groups Should Block All Ports from Public Internet Access
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.permissions
      op: not_contains
      value: '*'
- rule_id: alicloud.ecs.security_group.allow_ingress_from_internet_to_all_ports
  title: Elastic Compute Service Security Group Should Not Allow Ingress From Internet To All Ports
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.security_group.allow_ingress_from_internet_to_all_ports, alicloud_api_gateway_restapi_waf_acl_attached,
    alicloud_alb_waf_acl_attached
  title: Ensure Elastic Compute Service Security Groups Do Not Allow Unrestricted Internet Access and Web Application Firewall
    ACLs Are Properly Configured
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.security_group.allow_ingress_from_internet_to_any_port
  title: Elastic Compute Service Security Group Should Not Allow Ingress From Internet To Any Port
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.security_group.allow_ingress_from_internet_to_high_risk_tcp_ports
  title: Elastic Compute Service Security Groups Should Not Allow Ingress From Internet To High Risk TCP Ports
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.security_group.allow_ingress_from_internet_to_tcp_port_22
  title: Elastic Compute Service Security Group Should Not Allow Ingress From Internet To TCP Port 22
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:22
- rule_id: alicloud.ecs.security_group.allow_ingress_from_internet_to_tcp_port_3389
  title: Elastic Compute Service Security Group Should Not Allow Ingress From Internet To TCP Port 3389
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:3389
- rule_id: alicloud.ecs.security_group.allow_ingress_from_internet_to_tcp_port_cassandra_7199_9160_8888
  title: Elastic Compute Service Security Group Should Not Allow Ingress From Internet To Cassandra TCP Ports 7199, 9160,
    8888
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.security_group.allow_ingress_from_internet_to_tcp_port_elasticsearch_kibana_9200_9300_5601
  title: Elastic Compute Service Security Group Should Not Allow Ingress From Internet To Elasticsearch and Kibana Ports 9200,
    9300, and 5601
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.security_group.allow_ingress_from_internet_to_tcp_port_ftp_20_21
  title: Elastic Compute Service Security Group Should Not Allow Ingress From Internet To TCP Ports 20-21 (FTP)
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:21
- rule_id: alicloud.ecs.security_group.allow_ingress_from_internet_to_tcp_port_kafka_9092
  title: Elastic Compute Service Security Group Should Not Allow Ingress From Internet To TCP Port 9092 (Kafka)
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.security_group.allow_ingress_from_internet_to_tcp_port_memcached_11211
  title: Elastic Compute Service Security Group Should Not Allow Ingress From Internet To TCP Port 11211 (Memcached)
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.security_group.allow_ingress_from_internet_to_tcp_port_mongodb_27017_27018
  title: Elastic Compute Service Security Group Should Not Allow Ingress From Internet To MongoDB TCP Ports 27017-27018
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:27017
- rule_id: alicloud.ecs.security_group.allow_ingress_from_internet_to_tcp_port_mysql_3306
  title: Elastic Compute Service Security Group Should Not Allow Ingress From Internet To MySQL Port 3306
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:3306
- rule_id: alicloud.ecs.security_group.allow_ingress_from_internet_to_tcp_port_oracle_1521_2483
  title: Elastic Compute Service Security Group Should Not Allow Ingress From Internet To Oracle Database TCP Ports 1521 and
    2483
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.security_group.allow_ingress_from_internet_to_tcp_port_postgres_5432
  title: Elastic Compute Service Security Group Should Not Allow Ingress From Internet To TCP Port PostgreSQL 5432
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:5432
- rule_id: alicloud.ecs.security_group.allow_ingress_from_internet_to_tcp_port_redis_6379
  title: Elastic Compute Service Security Group Should Not Allow Ingress From Internet To TCP Port Redis 6379
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:6379
- rule_id: alicloud.ecs.security_group.allow_ingress_from_internet_to_tcp_port_sql_server_1433_1434
  title: Elastic Compute Service Security Group Should Not Allow Ingress From Internet To SQL Server Ports 1433-1434
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.security_group.allow_ingress_from_internet_to_tcp_port_telnet_23
  title: Elastic Compute Service Security Group Should Not Allow Ingress From Internet To TCP Port 23 (Telnet)
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:23
- rule_id: alicloud.ecs.security_group.any_port_public_ingress_blocked
  title: Elastic Compute Service Security Groups Should Block Public Ingress Traffic on All Ports
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.permissions
      op: not_contains
      value: '*'
- rule_id: alicloud.ecs.security_group.cassandra_ports_public_ingress_blocked
  title: Elastic Compute Service Security Groups Should Block Public Ingress Access to Cassandra Ports
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.permissions
      op: not_contains
      value: '*'
- rule_id: alicloud.ecs.security_group.common_ports_access_restricted
  title: Elastic Compute Service Security Groups Should Restrict Access to Common High-Risk Ports
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:22
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:3389
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:21
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:23
- rule_id: alicloud.ecs.security_group.default_deny_all
  title: Elastic Compute Service security groups should implement default deny all policy
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.security_group.default_restricted
  title: Alibaba Cloud Elastic Compute Service default security group should have restricted access rules
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.security_group.elasticsearch_kibana_ports_public_ingress_blocked
  title: Elastic Compute Service Security Groups Should Block Public Ingress to Elasticsearch Kibana Ports
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.permissions
      op: not_contains
      value: '*'
- rule_id: alicloud.ecs.security_group.excessive_ingress_egress_rules_reviewed
  title: Elastic Compute Service Security Groups Should Have Excessive Ingress and Egress Rules Reviewed
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.security_group.fine_grained_rules_enforced
  title: Elastic Compute Service Security Groups Should Enforce Fine-Grained Access Rules
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.security_group.from_launch_wizard
  title: Elastic Compute Service security groups should not be created from Launch Wizard with default configurations
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.security_group.ftp_ports_public_ingress_blocked
  title: Elastic Compute Service Security Groups Should Block Public Ingress Access to FTP Ports
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:21
- rule_id: alicloud.ecs.security_group.high_risk_ports_public_ingress_blocked
  title: Elastic Compute Service Security Groups Should Block High Risk Ports from Public Internet Access
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:22
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:3389
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:21
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:23
- rule_id: alicloud.ecs.security_group.inbound_3389_restricted_to_trusted_ips
  title: Elastic Compute Service Security Groups Should Restrict Inbound RDP Access on Port 3389 to Trusted IP Addresses
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:3389
- rule_id: alicloud.ecs.security_group.ingress_port_22_restricted_to_trusted_ips
  title: Elastic Compute Service Security Group SSH Access Should Be Restricted to Trusted IP Addresses
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:22
- rule_id: alicloud.ecs.security_group.kafka_port_public_ingress_blocked
  title: Elastic Compute Service Security Groups Should Block Public Ingress Access to Kafka Ports
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.permissions
      op: not_contains
      value: '*'
- rule_id: alicloud.ecs.security_group.launch_wizard_security_group_audit
  title: Elastic Compute Service Launch Wizard Security Groups Should Be Reviewed and Replaced
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.security_group.memcached_port_public_ingress_blocked
  title: Elastic Compute Service Security Groups Should Block Public Ingress Access to Memcached Port 11211
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.permissions
      op: not_contains
      value: '*'
- rule_id: alicloud.ecs.security_group.mongodb_ports_public_ingress_blocked
  title: Ensure Elastic Compute Service Security Groups Block Public Ingress Access to MongoDB Ports
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:27017
- rule_id: alicloud.ecs.security_group.mysql_port_public_ingress_blocked
  title: Elastic Compute Service Security Groups Should Block Public Ingress Access to MySQL Port 3306
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:3306
- rule_id: alicloud.ecs.security_group.not_used
  title: Ensure unused Elastic Compute Service security groups are removed
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.security_group.oracle_ports_public_ingress_blocked
  title: Elastic Compute Service Security Groups Should Block Public Ingress Access to Oracle Database Ports
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.permissions
      op: not_contains
      value: '*'
- rule_id: alicloud.ecs.security_group.postgres_port_public_ingress_blocked
  title: Elastic Compute Service Security Groups Should Block Public Ingress Access to PostgreSQL Port 5432
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:5432
- rule_id: alicloud.ecs.security_group.rdp_access_restricted_to_vpn
  title: Ensure Elastic Compute Service Security Groups Restrict RDP Access to VPN Networks Only
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:3389
- rule_id: alicloud.ecs.security_group.redis_port_public_ingress_blocked
  title: Elastic Compute Service Security Groups Should Block Public Ingress Access to Redis Port 6379
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:6379
- rule_id: alicloud.ecs.security_group.sql_server_ports_public_ingress_blocked
  title: Ensure Elastic Compute Service Security Groups Block Public Ingress Access to SQL Server Ports
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.permissions
      op: not_contains
      value: '*'
- rule_id: alicloud.ecs.security_group.ssh_access_restricted_to_whitelist
  title: Elastic Compute Service Security Groups Should Restrict SSH Access to Approved IP Addresses
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:22
- rule_id: alicloud.ecs.security_group.ssh_rdp_access_restricted_to_trusted_ips
  title: Elastic Compute Service Security Groups Should Restrict SSH and RDP Access to Trusted IP Addresses
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:22
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:3389
- rule_id: alicloud.ecs.security_group.telnet_port_public_ingress_blocked
  title: Elastic Compute Service Security Groups Should Block Public Ingress Access on Telnet Port 23
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:23
- rule_id: alicloud.ecs.security_group.unused_security_groups_identified
  title: Identify Unused Elastic Compute Service Security Groups
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.security_group.wide_open_public_ipv4_detected
  title: Elastic Compute Service Security Group Has Wide Open Public IPv4 Access
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.security_group
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: exists
    - var: item.permissions
      op: not_contains
      value: '*'
- rule_id: alicloud.ecs.securitygroup_default_deny_all_traffic.configured
  title: Elastic Compute Service Security Groups Should Have Default Deny Rules for All Traffic
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.securitygroup_default_deny_all_traffic
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.ecs.securitygroup_ingress_tcp_3389_from_internet_blocked.configured
  title: Elastic Compute Service Security Group Should Block TCP Port 3389 (RDP) Ingress from Internet
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.securitygroup_ingress_tcp_3389_from_internet_blocked
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:3389
- rule_id: alicloud.ecs.securitygroup_ingress_tcp_port_22_internet_access_blocked.configured
  title: Elastic Compute Service Security Group Should Block SSH Port 22 Access from Internet
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.securitygroup_ingress_tcp_port_22_internet_access_blocked
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.permissions
      op: not_contains
      value: '*'
    - var: item.security_group_rules
      op: not_contains
      value: 0.0.0.0/0:22
- rule_id: alicloud.ecs.snapshot.encryption_at_rest_enabled
  title: Elastic Compute Service snapshots should have encryption at rest enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.snapshot
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.backup_enabled
      op: equals
      value: true
- rule_id: alicloud.ecs.snapshot.snapshot_cross_region_copy_encrypted
  title: Ensure Elastic Compute Service snapshot cross-region copy is encrypted
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.snapshot
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.ecs.snapshot.snapshot_encrypted
  title: Ensure Elastic Compute Service snapshots are encrypted
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.snapshot
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.ecs.snapshot.snapshot_not_public
  title: Elastic Compute Service Snapshots Should Not Be Publicly Accessible
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.snapshot
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.backup_enabled
      op: equals
      value: true
- rule_id: alicloud.ecs.stopped.instance
  title: Elastic Compute Service instances should not remain in stopped state for extended periods
  severity: low
  assertion_id: cisa_ce_v1_multi_cloud_Your_Systems-1_0006
  for_each: alicloud.ecs.stopped
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.ecs.subnet.flow_logging_enabled_for_traffic_analysis
  title: Elastic Compute Service VPC Subnet Flow Logging Should Be Enabled For Network Traffic Analysis
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.subnet
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.ecs.task.definitions_logging_block_mode
  title: Elastic Compute Service Task Definitions Should Enable Logging Block Mode
  severity: medium
  assertion_id: iso27001_2022_multi_cloud_A.8.15_0070
  for_each: alicloud.ecs.task
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.task.definitions_logging_enabled
  title: Elastic Compute Service Task Definitions Should Have Logging Enabled
  severity: medium
  assertion_id: iso27001_2022_multi_cloud_A.8.15_0070
  for_each: alicloud.ecs.task
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.ecs.task_definitions.logging_block_mode_enabled
  title: Elastic Compute Service Task Definitions Should Have Logging Block Mode Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.task_definitions
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.ecs.task_definitions.logging_enabled_90_day_retention
  title: Elastic Compute Service task definitions should have logging enabled with 90-day retention period
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.task_definitions
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.ecs.training_job.network_isolation_enabled
  title: Elastic Compute Service Training Job Network Isolation Should Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.training_job
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.training_job_inter_container.encryption_enabled
  title: Elastic Compute Service training job inter-container communication encryption should be enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.training_job_inter_container
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.ecs.transitgateway.auto_accept_vpc_attachments
  title: Alibaba Cloud Express Connect Transit Gateway should disable auto-accept VPC attachments
  severity: medium
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.ecs.transitgateway
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.transitgateway.vpc_attachment_auto_accept_disabled
  title: Alibaba Cloud Elastic Compute Service Transit Gateway VPC Attachment Auto Accept Should Be Disabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.transitgateway
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.trusted.launch_secure_boot_enabled
  title: Alibaba Cloud Elastic Compute Service instances should have Trusted Launch Secure Boot enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.trusted
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.unattached.disks_encryption_at_rest_check
  title: Ensure Alibaba Cloud Elastic Compute Service Unattached Disks Have Encryption at Rest Enabled
  severity: high
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_CM-6_0046
  for_each: alicloud.ecs.unattached
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.ecs.unattached_disks.encryption_at_rest_enabled
  title: Ensure Elastic Compute Service unattached disks have encryption at rest enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.ecs.unattached_disks
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.ecs.volume.in_use
  title: Ensure Elastic Compute Service volumes are actively in use
  severity: low
  assertion_id: cisa_ce_v1_multi_cloud_Your_Systems-1_0006
  for_each: alicloud.ecs.volume
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.volume_attached_to_instance.configured
  title: Ensure Elastic Compute Service volumes are properly attached to instances
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.volume_attached_to_instance
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.vpn_gateway_endpoint.connection_logging_enabled_90_day_retention
  title: Elastic Compute Service VPN Gateway Endpoint Connection Logging Must Be Enabled with 90-Day Retention
  severity: medium
  assertion_id: ''
  for_each: alicloud.ecs.vpn_gateway_endpoint
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.ecs.vulnerability.automated_scanning_scheduled_weekly
  title: Ensure Elastic Compute Service instances have automated vulnerability scanning scheduled weekly
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.vulnerability
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.vulnerability.scan_enabled
  title: Ensure Elastic Compute Service vulnerability scanning is enabled
  severity: low
  assertion_id: nist_800_53_rev5_multi_cloud_SI-16_1433
  for_each: alicloud.ecs.vulnerability
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.ecs.vulnerability_scan_scheduled.configured
  title: Ensure Elastic Compute Service vulnerability scanning is scheduled and configured
  severity: low
  assertion_id: ''
  for_each: alicloud.ecs.vulnerability_scan_scheduled
  params: {}
  conditions:
    var: item.id
    op: exists
