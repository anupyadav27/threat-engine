version: '1.0'
provider: alicloud
service: dataworks
discovery:
- discovery_id: alicloud.dataworks.ai
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeAis
    params: {}
    save_as: ai_response
  emit:
    items_for: '{ ai_response.Ais.Ai }'
    as: r
    item:
      id: '{{ r.AiId }}'
      name: '{{ r.AiId }}'
      resource_type: ai
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.ai_services
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeAiServicess
    params: {}
    save_as: ai_services_response
  emit:
    items_for: '{ ai_services_response.AiServicess.AiServices }'
    as: r
    item:
      id: '{{ r.AiServicesId }}'
      name: '{{ r.AiServicesId }}'
      resource_type: ai_services
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.connection
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeConnections
    params: {}
    save_as: connection_response
  emit:
    items_for: '{ connection_response.Connections.Connection }'
    as: r
    item:
      id: '{{ r.ConnectionId }}'
      name: '{{ r.ConnectionId }}'
      resource_type: connection
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.connections
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeConnectionss
    params: {}
    save_as: connections_response
  emit:
    items_for: '{ connections_response.Connectionss.Connections }'
    as: r
    item:
      id: '{{ r.ConnectionsId }}'
      name: '{{ r.ConnectionsId }}'
      resource_type: connections
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.data
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDatas
    params: {}
    save_as: data_response
  emit:
    items_for: '{ data_response.Datas.Data }'
    as: r
    item:
      id: '{{ r.DataId }}'
      name: '{{ r.DataId }}'
      resource_type: data
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.data_classification
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDataClassifications
    params: {}
    save_as: data_classification_response
  emit:
    items_for: '{ data_classification_response.DataClassifications.DataClassification }'
    as: r
    item:
      id: '{{ r.DataClassificationId }}'
      name: '{{ r.DataClassificationId }}'
      resource_type: data_classification
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.data_integration
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDataIntegrations
    params: {}
    save_as: data_integration_response
  emit:
    items_for: '{ data_integration_response.DataIntegrations.DataIntegration }'
    as: r
    item:
      id: '{{ r.DataIntegrationId }}'
      name: '{{ r.DataIntegrationId }}'
      resource_type: data_integration
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.data_quality
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDataQualitys
    params: {}
    save_as: data_quality_response
  emit:
    items_for: '{ data_quality_response.DataQualitys.DataQuality }'
    as: r
    item:
      id: '{{ r.DataQualityId }}'
      name: '{{ r.DataQualityId }}'
      resource_type: data_quality
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.database
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDatabases
    params: {}
    save_as: database_response
  emit:
    items_for: '{ database_response.Databases.Database }'
    as: r
    item:
      id: '{{ r.DatabaseId }}'
      name: '{{ r.DatabaseId }}'
      resource_type: database
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.datamap
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDatamaps
    params: {}
    save_as: datamap_response
  emit:
    items_for: '{ datamap_response.Datamaps.Datamap }'
    as: r
    item:
      id: '{{ r.DatamapId }}'
      name: '{{ r.DatamapId }}'
      resource_type: datamap
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.datamap_catalog
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDatamapCatalogs
    params: {}
    save_as: datamap_catalog_response
  emit:
    items_for: '{ datamap_catalog_response.DatamapCatalogs.DatamapCatalog }'
    as: r
    item:
      id: '{{ r.DatamapCatalogId }}'
      name: '{{ r.DatamapCatalogId }}'
      resource_type: datamap_catalog
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.datamap_data
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDatamapDatas
    params: {}
    save_as: datamap_data_response
  emit:
    items_for: '{ datamap_data_response.DatamapDatas.DatamapData }'
    as: r
    item:
      id: '{{ r.DatamapDataId }}'
      name: '{{ r.DatamapDataId }}'
      resource_type: datamap_data
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.development
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDevelopments
    params: {}
    save_as: development_response
  emit:
    items_for: '{ development_response.Developments.Development }'
    as: r
    item:
      id: '{{ r.DevelopmentId }}'
      name: '{{ r.DevelopmentId }}'
      resource_type: development
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.development_environment
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDevelopmentEnvironments
    params: {}
    save_as: development_environment_response
  emit:
    items_for: '{ development_environment_response.DevelopmentEnvironments.DevelopmentEnvironment }'
    as: r
    item:
      id: '{{ r.DevelopmentEnvironmentId }}'
      name: '{{ r.DevelopmentEnvironmentId }}'
      resource_type: development_environment
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.dqc
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDqcs
    params: {}
    save_as: dqc_response
  emit:
    items_for: '{ dqc_response.Dqcs.Dqc }'
    as: r
    item:
      id: '{{ r.DqcId }}'
      name: '{{ r.DqcId }}'
      resource_type: dqc
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.dqc_data
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDqcDatas
    params: {}
    save_as: dqc_data_response
  emit:
    items_for: '{ dqc_data_response.DqcDatas.DqcData }'
    as: r
    item:
      id: '{{ r.DqcDataId }}'
      name: '{{ r.DqcDataId }}'
      resource_type: dqc_data
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.dqc_expression
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDqcExpressions
    params: {}
    save_as: dqc_expression_response
  emit:
    items_for: '{ dqc_expression_response.DqcExpressions.DqcExpression }'
    as: r
    item:
      id: '{{ r.DqcExpressionId }}'
      name: '{{ r.DqcExpressionId }}'
      resource_type: dqc_expression
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.dqc_recommendation
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDqcRecommendations
    params: {}
    save_as: dqc_recommendation_response
  emit:
    items_for: '{ dqc_recommendation_response.DqcRecommendations.DqcRecommendation }'
    as: r
    item:
      id: '{{ r.DqcRecommendationId }}'
      name: '{{ r.DqcRecommendationId }}'
      resource_type: dqc_recommendation
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.dqc_rule
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDqcRules
    params: {}
    save_as: dqc_rule_response
  emit:
    items_for: '{ dqc_rule_response.DqcRules.DqcRule }'
    as: r
    item:
      id: '{{ r.DqcRuleId }}'
      name: '{{ r.DqcRuleId }}'
      resource_type: dqc_rule
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.dqc_ruleset
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDqcRulesets
    params: {}
    save_as: dqc_ruleset_response
  emit:
    items_for: '{ dqc_ruleset_response.DqcRulesets.DqcRuleset }'
    as: r
    item:
      id: '{{ r.DqcRulesetId }}'
      name: '{{ r.DqcRulesetId }}'
      resource_type: dqc_ruleset
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.dqc_run
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDqcRuns
    params: {}
    save_as: dqc_run_response
  emit:
    items_for: '{ dqc_run_response.DqcRuns.DqcRun }'
    as: r
    item:
      id: '{{ r.DqcRunId }}'
      name: '{{ r.DqcRunId }}'
      resource_type: dqc_run
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.etl
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeEtls
    params: {}
    save_as: etl_response
  emit:
    items_for: '{ etl_response.Etls.Etl }'
    as: r
    item:
      id: '{{ r.EtlId }}'
      name: '{{ r.EtlId }}'
      resource_type: etl
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.governance_data
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeGovernanceDatas
    params: {}
    save_as: governance_data_response
  emit:
    items_for: '{ governance_data_response.GovernanceDatas.GovernanceData }'
    as: r
    item:
      id: '{{ r.GovernanceDataId }}'
      name: '{{ r.GovernanceDataId }}'
      resource_type: governance_data
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.incident
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeIncidents
    params: {}
    save_as: incident_response
  emit:
    items_for: '{ incident_response.Incidents.Incident }'
    as: r
    item:
      id: '{{ r.IncidentId }}'
      name: '{{ r.IncidentId }}'
      resource_type: incident
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.job
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeJobs
    params: {}
    save_as: job_response
  emit:
    items_for: '{ job_response.Jobs.Job }'
    as: r
    item:
      id: '{{ r.JobId }}'
      name: '{{ r.JobId }}'
      resource_type: job
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.lake
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLakes
    params: {}
    save_as: lake_response
  emit:
    items_for: '{ lake_response.Lakes.Lake }'
    as: r
    item:
      id: '{{ r.LakeId }}'
      name: '{{ r.LakeId }}'
      resource_type: lake
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.lineage
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLineages
    params: {}
    save_as: lineage_response
  emit:
    items_for: '{ lineage_response.Lineages.Lineage }'
    as: r
    item:
      id: '{{ r.LineageId }}'
      name: '{{ r.LineageId }}'
      resource_type: lineage
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.lineage_data
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLineageDatas
    params: {}
    save_as: lineage_data_response
  emit:
    items_for: '{ lineage_data_response.LineageDatas.LineageData }'
    as: r
    item:
      id: '{{ r.LineageDataId }}'
      name: '{{ r.LineageDataId }}'
      resource_type: lineage_data
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.maxcompute_project
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeMaxcomputeProjects
    params: {}
    save_as: maxcompute_project_response
  emit:
    items_for: '{ maxcompute_project_response.MaxcomputeProjects.MaxcomputeProject }'
    as: r
    item:
      id: '{{ r.MaxcomputeProjectId }}'
      name: '{{ r.MaxcomputeProjectId }}'
      resource_type: maxcompute_project
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.metadata
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeMetadatas
    params: {}
    save_as: metadata_response
  emit:
    items_for: '{ metadata_response.Metadatas.Metadata }'
    as: r
    item:
      id: '{{ r.MetadataId }}'
      name: '{{ r.MetadataId }}'
      resource_type: metadata
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.metadata_registry
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeMetadataRegistrys
    params: {}
    save_as: metadata_registry_response
  emit:
    items_for: '{ metadata_registry_response.MetadataRegistrys.MetadataRegistry }'
    as: r
    item:
      id: '{{ r.MetadataRegistryId }}'
      name: '{{ r.MetadataRegistryId }}'
      resource_type: metadata_registry
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.ml
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeMls
    params: {}
    save_as: ml_response
  emit:
    items_for: '{ ml_response.Mls.Ml }'
    as: r
    item:
      id: '{{ r.MlId }}'
      name: '{{ r.MlId }}'
      resource_type: ml
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.param_attribute
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeParamAttributes
    params: {}
    save_as: param_attribute_response
  emit:
    items_for: '{ param_attribute_response.ParamAttributes.ParamAttribute }'
    as: r
    item:
      id: '{{ r.ParamAttributeId }}'
      name: '{{ r.ParamAttributeId }}'
      resource_type: param_attribute
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.parameter
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeParameters
    params: {}
    save_as: parameter_response
  emit:
    items_for: '{ parameter_response.Parameters.Parameter }'
    as: r
    item:
      id: '{{ r.ParameterId }}'
      name: '{{ r.ParameterId }}'
      resource_type: parameter
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.parameter_object
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeParameterObjects
    params: {}
    save_as: parameter_object_response
  emit:
    items_for: '{ parameter_object_response.ParameterObjects.ParameterObject }'
    as: r
    item:
      id: '{{ r.ParameterObjectId }}'
      name: '{{ r.ParameterObjectId }}'
      resource_type: parameter_object
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.pipeline_workflow
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribePipelineWorkflows
    params: {}
    save_as: pipeline_workflow_response
  emit:
    items_for: '{ pipeline_workflow_response.PipelineWorkflows.PipelineWorkflow }'
    as: r
    item:
      id: '{{ r.PipelineWorkflowId }}'
      name: '{{ r.PipelineWorkflowId }}'
      resource_type: pipeline_workflow
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.resource
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeResources
    params: {}
    save_as: resource_response
  emit:
    items_for: '{ resource_response.Resources.Resource }'
    as: r
    item:
      id: '{{ r.ResourceId }}'
      name: '{{ r.ResourceId }}'
      resource_type: resource
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.schedule_trigger
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeScheduleTriggers
    params: {}
    save_as: schedule_trigger_response
  emit:
    items_for: '{ schedule_trigger_response.ScheduleTriggers.ScheduleTrigger }'
    as: r
    item:
      id: '{{ r.ScheduleTriggerId }}'
      name: '{{ r.ScheduleTriggerId }}'
      resource_type: schedule_trigger
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.schema
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeSchemas
    params: {}
    save_as: schema_response
  emit:
    items_for: '{ schema_response.Schemas.Schema }'
    as: r
    item:
      id: '{{ r.SchemaId }}'
      name: '{{ r.SchemaId }}'
      resource_type: schema
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.stream
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeStreams
    params: {}
    save_as: stream_response
  emit:
    items_for: '{ stream_response.Streams.Stream }'
    as: r
    item:
      id: '{{ r.StreamId }}'
      name: '{{ r.StreamId }}'
      resource_type: stream
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.tasks_jobs
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeTasksJobss
    params: {}
    save_as: tasks_jobs_response
  emit:
    items_for: '{ tasks_jobs_response.TasksJobss.TasksJobs }'
    as: r
    item:
      id: '{{ r.TasksJobsId }}'
      name: '{{ r.TasksJobsId }}'
      resource_type: tasks_jobs
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.tickets_workflows
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeTicketsWorkflowss
    params: {}
    save_as: tickets_workflows_response
  emit:
    items_for: '{ tickets_workflows_response.TicketsWorkflowss.TicketsWorkflows }'
    as: r
    item:
      id: '{{ r.TicketsWorkflowsId }}'
      name: '{{ r.TicketsWorkflowsId }}'
      resource_type: tickets_workflows
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.trigger
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeTriggers
    params: {}
    save_as: trigger_response
  emit:
    items_for: '{ trigger_response.Triggers.Trigger }'
    as: r
    item:
      id: '{{ r.TriggerId }}'
      name: '{{ r.TriggerId }}'
      resource_type: trigger
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.workflow
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeWorkflows
    params: {}
    save_as: workflow_response
  emit:
    items_for: '{ workflow_response.Workflows.Workflow }'
    as: r
    item:
      id: '{{ r.WorkflowId }}'
      name: '{{ r.WorkflowId }}'
      resource_type: workflow
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.workflow_definition
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeWorkflowDefinitions
    params: {}
    save_as: workflow_definition_response
  emit:
    items_for: '{ workflow_definition_response.WorkflowDefinitions.WorkflowDefinition }'
    as: r
    item:
      id: '{{ r.WorkflowDefinitionId }}'
      name: '{{ r.WorkflowDefinitionId }}'
      resource_type: workflow_definition
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.dataworks.workflow_dsc_labels
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeWorkflowDscLabelss
    params: {}
    save_as: workflow_dsc_labels_response
  emit:
    items_for: '{ workflow_dsc_labels_response.WorkflowDscLabelss.WorkflowDscLabels }'
    as: r
    item:
      id: '{{ r.WorkflowDscLabelsId }}'
      name: '{{ r.WorkflowDscLabelsId }}'
      resource_type: workflow_dsc_labels
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
checks:
- rule_id: alicloud.dataworks.ai.data_pipeline_access_controls_least_privilege
  title: Ensure DataWorks AI Data Pipeline Access Controls Follow Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.ai
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.ai.data_pipeline_private_networking_enforced
  title: Alibaba Cloud DataWorks Data Pipeline Private Networking Enforced
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.ai
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.ai_services.monitoring_enabled
  title: Ensure AliCloud DataWorks AI Services Have Monitoring Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.ai_services
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.dataworks.ai_services.role_least_privileged
  title: Ensure DataWorks AI Services roles follow least privilege principle
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.ai_services
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.connection.credentials_in_secrets_manager
  title: Ensure DataWorks connections store credentials in Secrets Manager
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.connection
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.connection.private_networking_enforced
  title: Ensure DataWorks connections enforce private networking
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.connection
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.connection.role_least_privilege
  title: DataWorks Connection Should Follow Role Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.connection
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.connection.tls_required
  title: DataWorks Connection Must Require TLS Encryption
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.connection
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.ssl_enabled
      op: equals
      value: true
- rule_id: alicloud.dataworks.connections.connection_credentials_in_secrets_manager
  title: Ensure AliCloud DataWorks Connection Credentials Are Stored in Secrets Manager
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.connections
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.connections.connection_private_networking_enforced
  title: Ensure DataWorks Connections Use Private Networking
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.connections
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.connections.connection_role_least_privilege
  title: Ensure DataWorks Connections Follow Role-Based Least Privilege Access Control
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.connections
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.connections.connection_tls_required
  title: Ensure AliCloud DataWorks Data Source Connections Require TLS Encryption
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.connections
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.ssl_enabled
      op: equals
      value: true
- rule_id: alicloud.dataworks.data.catalogs_connection_passwords_encryption_enabled
  title: Ensure AliCloud DataWorks Data Catalogs Connection Passwords Are Encrypted
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.data
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.logging_enabled
      op: equals
      value: true
- rule_id: alicloud.dataworks.data.catalogs_metadata_encryption_enabled
  title: Ensure AliCloud DataWorks Data Catalogs Have Metadata Encryption Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.data
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.logging_enabled
      op: equals
      value: true
- rule_id: alicloud.dataworks.data.catalogs_not_publicly_accessible
  title: Ensure AliCloud DataWorks Data Catalogs Are Not Publicly Accessible
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.data
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.dataworks.data_classification.classifier_rbac_least_privilege
  title: Ensure DataWorks Data Classification Classifier RBAC Follows Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.data_classification
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.data_classification.classifier_source_trusted
  title: Ensure AliCloud DataWorks Data Classification Classifier Sources Are From Trusted Origins
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.data_classification
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.data_integration.crawler_logs_enabled
  title: Ensure AliCloud DataWorks Data Integration Crawler Logs Are Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.data_integration
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.dataworks.data_integration.crawler_network_private_only
  title: Ensure DataWorks Data Integration Crawlers Use Private Network Access Only
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.data_integration
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.data_integration.crawler_role_least_privilege
  title: Ensure DataWorks Data Integration Crawler Roles Follow Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.data_integration
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.data_integration.crawler_scope_restricted_to_allowlist
  title: Ensure AliCloud DataWorks Data Integration Crawler Scope is Restricted to Allowlist
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.data_integration
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.data_quality.logs_enabled
  title: Ensure AliCloud DataWorks Data Quality Monitoring Has Logs Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.data_quality
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.dataworks.data_quality.output_location_private_and_encrypted
  title: Ensure AliCloud DataWorks Data Quality Output Locations Are Private and Encrypted
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.data_quality
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.data_quality.role_least_privilege
  title: Ensure DataWorks Data Quality roles follow least privilege principle
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.data_quality
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.database.cross_account_sharing_restricted
  title: Alibaba Cloud DataWorks Database Cross-Account Sharing Should Be Restricted
  severity: low
  assertion_id: ''
  for_each: alicloud.dataworks.database
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.database.encrypted
  title: Ensure DataWorks database connections are encrypted
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.database
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.database.pii_detection_enabled
  title: Ensure DataWorks Database Has PII Detection Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.database
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.database.policy_least_privilege
  title: Ensure DataWorks Database Access Policies Follow Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.database
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.datamap.catalog_audit_logging_enabled
  title: Ensure AliCloud DataWorks DataMap Catalog Audit Logging is Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.datamap
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.dataworks.datamap.catalog_cross_account_sharing_restricted
  title: AliCloud DataWorks DataMap Catalog Cross Account Sharing Should Be Restricted
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.datamap
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.datamap.catalog_metadata_encryption_enabled
  title: AliCloud DataWorks DataMap Catalog Metadata Encryption Should Be Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.datamap
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.datamap.catalog_rbac_least_privilege
  title: DataWorks DataMap Catalog RBAC Least Privilege Access Control
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.datamap
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.datamap.catalog_store_encrypted
  title: Ensure AliCloud DataWorks DataMap Catalog Store is Encrypted
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.datamap
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.datamap_catalog.catalog_audit_logging_enabled
  title: AliCloud DataWorks Data Map Catalog Audit Logging Should Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.datamap_catalog
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.dataworks.datamap_catalog.catalog_cross_account_sharing_restricted
  title: Ensure DataWorks DataMap Catalog Cross-Account Sharing is Restricted
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.datamap_catalog
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.datamap_catalog.catalog_metadata_encryption_enabled
  title: Ensure AliCloud DataWorks DataMap Catalog Metadata Encryption is Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.datamap_catalog
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.logging_enabled
      op: equals
      value: true
- rule_id: alicloud.dataworks.datamap_catalog.catalog_rbac_least_privilege
  title: DataWorks DataMap Catalog RBAC Least Privilege Access Control
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.datamap_catalog
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.datamap_data.catalog_change_audit_logging_enabled
  title: Alibaba Cloud DataWorks Data Catalog Change Audit Logging Should Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.datamap_data
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.dataworks.datamap_data.catalog_cross_account_sharing_review_required
  title: AliCloud DataWorks Data Catalog Cross-Account Sharing Requires Review and Approval
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.datamap_data
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.datamap_data.catalog_update_rbac_least_privilege
  title: Ensure DataWorks DataMap Data Catalog Update Operations Follow RBAC Least Privilege Principles
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.datamap_data
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.development.endpoints_cloudmonitor_logs_encryption_enabled
  title: Ensure DataWorks Development Environment Endpoints Have CloudMonitor Logs Encryption Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.development
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.logging_enabled
      op: equals
      value: true
- rule_id: alicloud.dataworks.development.endpoints_job_bookmark_encryption_enabled
  title: Ensure AliCloud DataWorks Development Endpoints Have Job Bookmark Encryption Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.development
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.development.endpoints_oss_encryption_enabled
  title: Ensure DataWorks Development Environment Endpoints Have OSS Encryption Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.development
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.development_environment.dev_endpoint_encrypted
  title: Ensure AliCloud DataWorks Development Environment Endpoints Are Encrypted
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.development_environment
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.development_environment.dev_endpoint_no_public_access
  title: AliCloud DataWorks Development Environment Endpoint Should Not Allow Public Access
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.development_environment
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.dataworks.development_environment.dev_endpoint_role_least_privilege
  title: DataWorks Development Environment Endpoint Role Should Follow Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.development_environment
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.dqc.data_quality_logs_enabled
  title: Ensure AliCloud DataWorks Data Quality Center has data quality logs enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.dqc
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.dataworks.dqc.data_quality_output_location_private_and_encrypted
  title: Ensure DataWorks Data Quality Center Output Location is Private and Encrypted
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.dqc
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.dqc.data_quality_role_least_privilege
  title: Ensure DataWorks Data Quality Center Roles Follow Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.dqc
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.dqc_data.quality_jobs_role_least_privilege
  title: Ensure AliCloud DataWorks Data Quality Center Jobs Use Least Privilege Role Permissions
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.dqc_data
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.dqc_data.quality_logs_enabled
  title: AliCloud DataWorks Data Quality Center Quality Logs Should Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.dqc_data
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.dataworks.dqc_data.quality_outputs_encrypted_and_private
  title: Ensure AliCloud DataWorks Data Quality Center outputs are encrypted and configured with private access
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.dqc_data
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.dqc_expression.rule_parameters_no_plaintext_secrets
  title: AliCloud DataWorks Data Quality Center Expression Rule Parameters Should Not Contain Plaintext Secrets
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.dqc_expression
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.dqc_expression.rule_source_trusted
  title: Ensure AliCloud DataWorks Data Quality Center Expression Rules Use Trusted Sources
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.dqc_expression
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.dqc_recommendation.recommendation_access_rbac_least_privilege
  title: Ensure DataWorks Data Quality Center Recommendation Access Follows RBAC Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.dqc_recommendation
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.dqc_recommendation.recommendation_outputs_encrypted_and_private
  title: Ensure AliCloud DataWorks Data Quality Center recommendation outputs are encrypted and configured as private
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.dqc_recommendation
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.dqc_recommendation.recommendation_run_metadata_logging_enabled
  title: Ensure AliCloud DataWorks Data Quality Center Recommendation Run Metadata Logging is Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.dqc_recommendation
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.dataworks.dqc_rule.rule_rbac_least_privilege
  title: DataWorks Data Quality Center Rule RBAC Least Privilege Access Control
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.dqc_rule
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.dqc_rule.rule_source_trusted
  title: Ensure AliCloud DataWorks Data Quality Center Rules Use Trusted Sources
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.dqc_rule
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.dqc_ruleset.ruleset_encrypted_at_rest
  title: Ensure AliCloud DataWorks Data Quality Center Rulesets Are Encrypted At Rest
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.dqc_ruleset
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.dqc_ruleset.ruleset_rbac_least_privilege
  title: DataWorks Data Quality Center Ruleset RBAC Least Privilege Access Control
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.dqc_ruleset
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.dqc_run.recommendation_run_execution_role_least_privilege
  title: Ensure DataWorks Data Quality Center Recommendation Run Execution Roles Follow Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.dqc_run
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.dqc_run.recommendation_run_logs_enabled
  title: Ensure AliCloud DataWorks Data Quality Center recommendation run logs are enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.dqc_run
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.dataworks.dqc_run.recommendation_run_output_encrypted_private
  title: Ensure AliCloud DataWorks Data Quality Center recommendation run outputs are encrypted and stored privately
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.dqc_run
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.etl.jobs_amazon_oss_encryption_enabled
  title: Ensure DataWorks ETL Jobs Have Amazon OSS Encryption Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.etl
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.etl.jobs_cloudmonitor_logs_encryption_enabled
  title: Ensure DataWorks ETL Jobs CloudMonitor Logs Encryption is Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.etl
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.logging_enabled
      op: equals
      value: true
- rule_id: alicloud.dataworks.etl.jobs_job_bookmark_encryption_enabled
  title: Ensure AliCloud DataWorks ETL Jobs Have Job Bookmark Encryption Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.etl
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.etl.jobs_logging_enabled
  title: Ensure AliCloud DataWorks ETL Jobs Have Logging Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.etl
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.dataworks.governance_data.policy_admin_change_audit_logging_enabled
  title: Ensure AliCloud DataWorks Data Governance Policy Administrator Change Audit Logging is Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.governance_data
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.dataworks.governance_data.policy_admin_mfa_required
  title: DataWorks Data Governance Policy Administrator Multi-Factor Authentication Required
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.governance_data
  params: {}
  conditions:
    var: item.mfa_enabled
    op: equals
    value: true
- rule_id: alicloud.dataworks.governance_data.policy_admin_rbac_least_privilege
  title: Ensure DataWorks Governance Data Policy Admin RBAC Follows Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.governance_data
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.incident.workflow_approval_steps_required_for_destructive_actions
  title: AliCloud DataWorks Workflow Approval Steps Required For Destructive Actions
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.incident
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.incident.workflow_integrations_least_privilege
  title: Ensure AliCloud DataWorks workflow integrations follow least privilege access principles
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.incident
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.incident.workflow_kms_encryption_enabled
  title: Ensure AliCloud DataWorks Workflow KMS Encryption is Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.incident
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.kms_key_id
      op: exists
- rule_id: alicloud.dataworks.job.data_lineage_tracking_enabled
  title: Ensure AliCloud DataWorks Jobs Have Data Lineage Tracking Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.job
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.dataworks.job.logs_and_metrics_enabled
  title: Ensure AliCloud DataWorks jobs have logging and metrics monitoring enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.dataworks.job
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.dataworks.job.network_private_only
  title: Ensure DataWorks jobs are configured to use private network access only
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.job
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.job.role_least_privilege
  title: DataWorks Job Should Follow Role Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.job
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.job.script_location_private_and_encrypted
  title: Ensure DataWorks Job Scripts Are Stored in Private and Encrypted Locations
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.job
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.lake.analytics_workgroup_encryption
  title: Ensure AliCloud DataWorks Lake Analytics Workgroup Encryption is Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.lake
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.lineage.access_rbac_least_privilege
  title: DataWorks Data Lineage Access Should Follow RBAC Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.lineage
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.lineage.export_destination_encrypted
  title: DataWorks Data Lineage Export Destination Must Be Encrypted
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.lineage
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.lineage_data.lineage_access_rbac_least_privilege
  title: DataWorks Lineage Data Access Should Follow RBAC Least Privilege Principles
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.lineage_data
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.lineage_data.lineage_export_destination_encrypted
  title: Ensure AliCloud DataWorks Lineage Export Destinations Are Encrypted
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.lineage_data
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.maxcompute_project.database_cross_account_sharing_restricted
  title: Ensure DataWorks MaxCompute Project Database Cross Account Sharing is Restricted
  severity: low
  assertion_id: ''
  for_each: alicloud.dataworks.maxcompute_project
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.maxcompute_project.database_encrypted
  title: Ensure AliCloud DataWorks MaxCompute Project Database Encryption is Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.maxcompute_project
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.maxcompute_project.database_policy_least_privilege
  title: Ensure AliCloud DataWorks MaxCompute Project Database Policies Follow Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.maxcompute_project
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.metadata.registry_cross_account_sharing_restricted
  title: AliCloud DataWorks Metadata Registry Cross-Account Sharing Should Be Restricted
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.metadata
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.metadata.registry_metadata_encryption_enabled
  title: Ensure AliCloud DataWorks Registry Metadata Encryption is Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.metadata
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.metadata.registry_rbac_least_privilege
  title: DataWorks Metadata Registry Should Implement RBAC Least Privilege Access Controls
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.metadata
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.metadata_registry.registry_cross_account_sharing_restricted
  title: AliCloud DataWorks Metadata Registry Cross-Account Sharing Should Be Restricted
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.metadata_registry
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.metadata_registry.registry_metadata_encryption_enabled
  title: Ensure AliCloud DataWorks Metadata Registry Has Encryption Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.metadata_registry
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.metadata_registry.registry_rbac_least_privilege
  title: Ensure DataWorks Metadata Registry implements RBAC least privilege access controls
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.metadata_registry
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.ml.transform_encrypted_at_rest
  title: Ensure DataWorks Machine Learning Transform Data is Encrypted at Rest
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.ml
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.param_attribute.parameter_metadata_sensitive_keys_require_secret_type
  title: AliCloud DataWorks Parameter Metadata Sensitive Keys Must Use Secret Type
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.param_attribute
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.param_attribute.parameter_metadata_values_not_plaintext_secret
  title: Ensure AliCloud DataWorks Parameter Metadata Values Do Not Contain Plaintext Secrets
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.param_attribute
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.parameter.attributes_no_plaintext_secrets
  title: DataWorks Parameter Attributes Should Not Contain Plaintext Secrets
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.parameter
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.parameter.value_from_secrets_manager_when_sensitive
  title: DataWorks Parameter Values Should Use Secrets Manager for Sensitive Data
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.parameter
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.parameter_object.parameter_binding_secret_refs_resolved_at_runtime
  title: Ensure AliCloud DataWorks Parameter Object Secret References Are Resolved at Runtime
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.parameter_object
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.parameter_object.parameter_binding_sensitive_params_not_logged
  title: AliCloud DataWorks Parameter Object Should Not Log Sensitive Parameter Binding Values
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.parameter_object
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.pipeline_workflow.pipeline_artifacts_private_and_encrypted
  title: Ensure AliCloud DataWorks Pipeline Workflow Artifacts Are Private and Encrypted
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.pipeline_workflow
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.pipeline_workflow.pipeline_execution_roles_least_privilege
  title: Ensure DataWorks Pipeline Workflow Execution Roles Follow Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.pipeline_workflow
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.pipeline_workflow.pipeline_kms_encryption_enabled
  title: Ensure DataWorks Pipeline Workflows Have KMS Encryption Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.pipeline_workflow
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.pipeline_workflow.pipeline_logs_and_metrics_enabled
  title: Ensure AliCloud DataWorks Pipeline Workflow Has Logs and Metrics Enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.dataworks.pipeline_workflow
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.dataworks.pipeline_workflow.pipeline_private_networking_enforced
  title: Ensure DataWorks Pipeline Workflows Use Private Network Connectivity
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.pipeline_workflow
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.resource.object_environment_no_plaintext_secrets
  title: AliCloud DataWorks Resource Object Environment Should Not Contain Plaintext Secrets
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.resource
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.resource.object_execution_role_least_privilege
  title: Ensure AliCloud DataWorks Object Execution Roles Follow Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.resource
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.resource.object_logging_enabled
  title: Ensure AliCloud DataWorks Resource Object Logging is Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.resource
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.dataworks.resource.object_network_private_only
  title: Ensure DataWorks Resource Objects Are Configured for Private Network Access Only
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.resource
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.schedule_trigger.trigger_event_sources_restricted
  title: AliCloud DataWorks Schedule Trigger Event Sources Should Be Restricted
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.schedule_trigger
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.schedule_trigger.trigger_logs_enabled
  title: AliCloud DataWorks Schedule Trigger Logs Should Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.schedule_trigger
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.dataworks.schedule_trigger.trigger_targets_least_privilege
  title: AliCloud DataWorks Schedule Trigger Should Follow Least Privilege Access Principles
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.schedule_trigger
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.schema.encrypted
  title: Ensure AliCloud DataWorks schema encryption is enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.schema
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.schema.rbac_least_privilege
  title: DataWorks Schema Should Implement RBAC Least Privilege Access Controls
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.schema
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.stream.data_retention_period
  title: AliCloud DataWorks Stream Data Retention Period Configuration
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.stream
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.stream.encrypted_at_rest
  title: Ensure DataWorks Real-time Compute streams have encryption at rest enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.stream
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.tasks_jobs.job_logs_and_metrics_enabled
  title: Ensure AliCloud DataWorks Job Logs and Metrics Are Enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.dataworks.tasks_jobs
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.dataworks.tasks_jobs.job_network_private_only
  title: Ensure AliCloud DataWorks Jobs Use Private Network Access Only
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.tasks_jobs
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.tasks_jobs.job_role_least_privilege
  title: Ensure AliCloud DataWorks Job Roles Follow Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.tasks_jobs
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.tasks_jobs.job_script_location_private_and_encrypted
  title: Ensure AliCloud DataWorks Job Scripts Are Stored in Private and Encrypted Locations
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.tasks_jobs
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.tickets_workflows.rights_execution_roles_least_privilege
  title: Ensure DataWorks Ticket Workflow Execution Roles Follow Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.tickets_workflows
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.tickets_workflows.rights_workflow_storage_encrypted
  title: Ensure AliCloud DataWorks Rights Workflow Storage is Encrypted
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.tickets_workflows
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.trigger.event_sources_restricted
  title: AliCloud DataWorks Trigger Event Sources Should Be Restricted
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.trigger
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.trigger.logs_enabled
  title: DataWorks Trigger Logging Should Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.trigger
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.dataworks.trigger.targets_least_privilege
  title: DataWorks Trigger Targets Should Follow Least Privilege Access Principles
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.trigger
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.workflow.cross_account_trusts_restricted
  title: AliCloud DataWorks Workflow Cross Account Trusts Should Be Restricted
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.workflow
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.workflow.execution_role_least_privilege
  title: DataWorks Workflow Execution Role Should Follow Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.workflow
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.workflow.kms_encryption_enabled
  title: Ensure DataWorks workflows have KMS encryption enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.workflow
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.workflow_definition.definition_storage_encrypted
  title: Ensure AliCloud DataWorks workflow definition storage is encrypted
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.workflow_definition
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.dataworks.workflow_definition.definition_storage_private
  title: Ensure AliCloud DataWorks workflow definitions are stored in private repositories
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.workflow_definition
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.dataworks.workflow_dsc_labels.consent_access_rbac_least_privilege
  title: DataWorks workflow DSC labels should implement consent access RBAC with least privilege principles
  severity: high
  assertion_id: ''
  for_each: alicloud.dataworks.workflow_dsc_labels
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.dataworks.workflow_dsc_labels.consent_store_encrypted
  title: Ensure DataWorks Workflow DSC Labels Consent Store is Encrypted
  severity: medium
  assertion_id: ''
  for_each: alicloud.dataworks.workflow_dsc_labels
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
