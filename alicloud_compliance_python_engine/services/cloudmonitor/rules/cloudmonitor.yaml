version: '1.0'
provider: alicloud
service: cloudmonitor
discovery:
- discovery_id: alicloud.cloudmonitor.actiontrail_config_changes_log_metric_filter_and_alarm_enabled
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeActiontrailConfigChangesLogMetricFilterAndAlarmEnableds
    params: {}
    save_as: actiontrail_config_changes_log_metric_filter_and_alarm_enabled_response
  emit:
    items_for: '{ actiontrail_config_changes_log_metric_filter_and_alarm_enabled_response.ActiontrailConfigChangesLogMetricFilterAndAlarmEnableds.ActiontrailConfigChangesLogMetricFilterAndAlarmEnabled
      }'
    as: r
    item:
      id: '{{ r.ActiontrailConfigChangesLogMetricFilterAndAlarmEnabledId }}'
      name: '{{ r.ActiontrailConfigChangesLogMetricFilterAndAlarmEnabledId }}'
      resource_type: actiontrail_config_changes_log_metric_filter_and_alarm_enabled
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.alarm
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeAlarms
    params: {}
    save_as: alarm_response
  emit:
    items_for: '{ alarm_response.Alarms.Alarm }'
    as: r
    item:
      id: '{{ r.AlarmId }}'
      name: '{{ r.AlarmId }}'
      resource_type: alarm
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.alert
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeAlerts
    params: {}
    save_as: alert_response
  emit:
    items_for: '{ alert_response.Alerts.Alert }'
    as: r
    item:
      id: '{{ r.AlertId }}'
      name: '{{ r.AlertId }}'
      resource_type: alert
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.alerts
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeAlertss
    params: {}
    save_as: alerts_response
  emit:
    items_for: '{ alerts_response.Alertss.Alerts }'
    as: r
    item:
      id: '{{ r.AlertsId }}'
      name: '{{ r.AlertsId }}'
      resource_type: alerts
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.config_changes_log_metric_filter_and_alarm_enabled
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeConfigChangesLogMetricFilterAndAlarmEnableds
    params: {}
    save_as: config_changes_log_metric_filter_and_alarm_enabled_response
  emit:
    items_for: '{ config_changes_log_metric_filter_and_alarm_enabled_response.ConfigChangesLogMetricFilterAndAlarmEnableds.ConfigChangesLogMetricFilterAndAlarmEnabled
      }'
    as: r
    item:
      id: '{{ r.ConfigChangesLogMetricFilterAndAlarmEnabledId }}'
      name: '{{ r.ConfigChangesLogMetricFilterAndAlarmEnabledId }}'
      resource_type: config_changes_log_metric_filter_and_alarm_enabled
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.diagnostic_settings
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDiagnosticSettingss
    params: {}
    save_as: diagnostic_settings_response
  emit:
    items_for: '{ diagnostic_settings_response.DiagnosticSettingss.DiagnosticSettings }'
    as: r
    item:
      id: '{{ r.DiagnosticSettingsId }}'
      name: '{{ r.DiagnosticSettingsId }}'
      resource_type: diagnostic_settings
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.diagnostic_settings_presence_verified
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDiagnosticSettingsPresenceVerifieds
    params: {}
    save_as: diagnostic_settings_presence_verified_response
  emit:
    items_for: '{ diagnostic_settings_presence_verified_response.DiagnosticSettingsPresenceVerifieds.DiagnosticSettingsPresenceVerified
      }'
    as: r
    item:
      id: '{{ r.DiagnosticSettingsPresenceVerifiedId }}'
      name: '{{ r.DiagnosticSettingsPresenceVerifiedId }}'
      resource_type: diagnostic_settings_presence_verified
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.log
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogs
    params: {}
    save_as: log_response
  emit:
    items_for: '{ log_response.Logs.Log }'
    as: r
    item:
      id: '{{ r.LogId }}'
      name: '{{ r.LogId }}'
      resource_type: log
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.log_group
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogGroups
    params: {}
    save_as: log_group_response
  emit:
    items_for: '{ log_group_response.LogGroups.LogGroup }'
    as: r
    item:
      id: '{{ r.LogGroupId }}'
      name: '{{ r.LogGroupId }}'
      resource_type: log_group
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.log_group_kms_cmk_encryption_at_rest_enabled
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogGroupKmsCmkEncryptionAtRestEnableds
    params: {}
    save_as: log_group_kms_cmk_encryption_at_rest_enabled_response
  emit:
    items_for: '{ log_group_kms_cmk_encryption_at_rest_enabled_response.LogGroupKmsCmkEncryptionAtRestEnableds.LogGroupKmsCmkEncryptionAtRestEnabled
      }'
    as: r
    item:
      id: '{{ r.LogGroupKmsCmkEncryptionAtRestEnabledId }}'
      name: '{{ r.LogGroupKmsCmkEncryptionAtRestEnabledId }}'
      resource_type: log_group_kms_cmk_encryption_at_rest_enabled
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.log_group_retention_policy_90_days_enabled
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogGroupRetentionPolicy90DaysEnableds
    params: {}
    save_as: log_group_retention_policy_90_days_enabled_response
  emit:
    items_for: '{ log_group_retention_policy_90_days_enabled_response.LogGroupRetentionPolicy90DaysEnableds.LogGroupRetentionPolicy90DaysEnabled
      }'
    as: r
    item:
      id: '{{ r.LogGroupRetentionPolicy90DaysEnabledId }}'
      name: '{{ r.LogGroupRetentionPolicy90DaysEnabledId }}'
      resource_type: log_group_retention_policy_90_days_enabled
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.log_metric_filter
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogMetricFilters
    params: {}
    save_as: log_metric_filter_response
  emit:
    items_for: '{ log_metric_filter_response.LogMetricFilters.LogMetricFilter }'
    as: r
    item:
      id: '{{ r.LogMetricFilterId }}'
      name: '{{ r.LogMetricFilterId }}'
      resource_type: log_metric_filter
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.log_metric_filter_and_alarm_for_actiontrail_config_changes_enabled
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogMetricFilterAndAlarmForActiontrailConfigChangesEnableds
    params: {}
    save_as: log_metric_filter_and_alarm_for_actiontrail_config_changes_enabled_response
  emit:
    items_for: '{ log_metric_filter_and_alarm_for_actiontrail_config_changes_enabled_response.LogMetricFilterAndAlarmForActiontrailConfigChangesEnableds.LogMetricFilterAndAlarmForActiontrailConfigChangesEnabled
      }'
    as: r
    item:
      id: '{{ r.LogMetricFilterAndAlarmForActiontrailConfigChangesEnabledId }}'
      name: '{{ r.LogMetricFilterAndAlarmForActiontrailConfigChangesEnabledId }}'
      resource_type: log_metric_filter_and_alarm_for_actiontrail_config_changes_enabled
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.log_metric_filter_and_alarm_for_config_changes_enabled
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogMetricFilterAndAlarmForConfigChangesEnableds
    params: {}
    save_as: log_metric_filter_and_alarm_for_config_changes_enabled_response
  emit:
    items_for: '{ log_metric_filter_and_alarm_for_config_changes_enabled_response.LogMetricFilterAndAlarmForConfigChangesEnableds.LogMetricFilterAndAlarmForConfigChangesEnabled
      }'
    as: r
    item:
      id: '{{ r.LogMetricFilterAndAlarmForConfigChangesEnabledId }}'
      name: '{{ r.LogMetricFilterAndAlarmForConfigChangesEnabledId }}'
      resource_type: log_metric_filter_and_alarm_for_config_changes_enabled
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.log_metric_filter_for_authentication_failures
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogMetricFilterForAuthenticationFailuress
    params: {}
    save_as: log_metric_filter_for_authentication_failures_response
  emit:
    items_for: '{ log_metric_filter_for_authentication_failures_response.LogMetricFilterForAuthenticationFailuress.LogMetricFilterForAuthenticationFailures
      }'
    as: r
    item:
      id: '{{ r.LogMetricFilterForAuthenticationFailuresId }}'
      name: '{{ r.LogMetricFilterForAuthenticationFailuresId }}'
      resource_type: log_metric_filter_for_authentication_failures
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.log_metric_filter_for_bucket_policy_changes
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogMetricFilterForBucketPolicyChangess
    params: {}
    save_as: log_metric_filter_for_bucket_policy_changes_response
  emit:
    items_for: '{ log_metric_filter_for_bucket_policy_changes_response.LogMetricFilterForBucketPolicyChangess.LogMetricFilterForBucketPolicyChanges
      }'
    as: r
    item:
      id: '{{ r.LogMetricFilterForBucketPolicyChangesId }}'
      name: '{{ r.LogMetricFilterForBucketPolicyChangesId }}'
      resource_type: log_metric_filter_for_bucket_policy_changes
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.log_metric_filter_for_kms_cmk_deletion_or_disablement
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogMetricFilterForKmsCmkDeletionOrDisablements
    params: {}
    save_as: log_metric_filter_for_kms_cmk_deletion_or_disablement_response
  emit:
    items_for: '{ log_metric_filter_for_kms_cmk_deletion_or_disablement_response.LogMetricFilterForKmsCmkDeletionOrDisablements.LogMetricFilterForKmsCmkDeletionOrDisablement
      }'
    as: r
    item:
      id: '{{ r.LogMetricFilterForKmsCmkDeletionOrDisablementId }}'
      name: '{{ r.LogMetricFilterForKmsCmkDeletionOrDisablementId }}'
      resource_type: log_metric_filter_for_kms_cmk_deletion_or_disablement
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.log_metric_filter_for_policy_changes
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogMetricFilterForPolicyChangess
    params: {}
    save_as: log_metric_filter_for_policy_changes_response
  emit:
    items_for: '{ log_metric_filter_for_policy_changes_response.LogMetricFilterForPolicyChangess.LogMetricFilterForPolicyChanges
      }'
    as: r
    item:
      id: '{{ r.LogMetricFilterForPolicyChangesId }}'
      name: '{{ r.LogMetricFilterForPolicyChangesId }}'
      resource_type: log_metric_filter_for_policy_changes
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.log_metric_filter_for_root_account_usage
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogMetricFilterForRootAccountUsages
    params: {}
    save_as: log_metric_filter_for_root_account_usage_response
  emit:
    items_for: '{ log_metric_filter_for_root_account_usage_response.LogMetricFilterForRootAccountUsages.LogMetricFilterForRootAccountUsage
      }'
    as: r
    item:
      id: '{{ r.LogMetricFilterForRootAccountUsageId }}'
      name: '{{ r.LogMetricFilterForRootAccountUsageId }}'
      resource_type: log_metric_filter_for_root_account_usage
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.log_metric_filter_for_security_group_changes
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogMetricFilterForSecurityGroupChangess
    params: {}
    save_as: log_metric_filter_for_security_group_changes_response
  emit:
    items_for: '{ log_metric_filter_for_security_group_changes_response.LogMetricFilterForSecurityGroupChangess.LogMetricFilterForSecurityGroupChanges
      }'
    as: r
    item:
      id: '{{ r.LogMetricFilterForSecurityGroupChangesId }}'
      name: '{{ r.LogMetricFilterForSecurityGroupChangesId }}'
      resource_type: log_metric_filter_for_security_group_changes
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.log_metric_filter_for_sign_in_without_mfa
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogMetricFilterForSignInWithoutMfas
    params: {}
    save_as: log_metric_filter_for_sign_in_without_mfa_response
  emit:
    items_for: '{ log_metric_filter_for_sign_in_without_mfa_response.LogMetricFilterForSignInWithoutMfas.LogMetricFilterForSignInWithoutMfa
      }'
    as: r
    item:
      id: '{{ r.LogMetricFilterForSignInWithoutMfaId }}'
      name: '{{ r.LogMetricFilterForSignInWithoutMfaId }}'
      resource_type: log_metric_filter_for_sign_in_without_mfa
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.log_metric_filter_for_unauthorized_api_calls
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogMetricFilterForUnauthorizedApiCallss
    params: {}
    save_as: log_metric_filter_for_unauthorized_api_calls_response
  emit:
    items_for: '{ log_metric_filter_for_unauthorized_api_calls_response.LogMetricFilterForUnauthorizedApiCallss.LogMetricFilterForUnauthorizedApiCalls
      }'
    as: r
    item:
      id: '{{ r.LogMetricFilterForUnauthorizedApiCallsId }}'
      name: '{{ r.LogMetricFilterForUnauthorizedApiCallsId }}'
      resource_type: log_metric_filter_for_unauthorized_api_calls
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.log_metric_filter_kms_cmk_deletion_or_disablement
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogMetricFilterKmsCmkDeletionOrDisablements
    params: {}
    save_as: log_metric_filter_kms_cmk_deletion_or_disablement_response
  emit:
    items_for: '{ log_metric_filter_kms_cmk_deletion_or_disablement_response.LogMetricFilterKmsCmkDeletionOrDisablements.LogMetricFilterKmsCmkDeletionOrDisablement
      }'
    as: r
    item:
      id: '{{ r.LogMetricFilterKmsCmkDeletionOrDisablementId }}'
      name: '{{ r.LogMetricFilterKmsCmkDeletionOrDisablementId }}'
      resource_type: log_metric_filter_kms_cmk_deletion_or_disablement
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.log_storage
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogStorages
    params: {}
    save_as: log_storage_response
  emit:
    items_for: '{ log_storage_response.LogStorages.LogStorage }'
    as: r
    item:
      id: '{{ r.LogStorageId }}'
      name: '{{ r.LogStorageId }}'
      resource_type: log_storage
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.network_acls_change_alarm_configured
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeNetworkAclsChangeAlarmConfigureds
    params: {}
    save_as: network_acls_change_alarm_configured_response
  emit:
    items_for: '{ network_acls_change_alarm_configured_response.NetworkAclsChangeAlarmConfigureds.NetworkAclsChangeAlarmConfigured
      }'
    as: r
    item:
      id: '{{ r.NetworkAclsChangeAlarmConfiguredId }}'
      name: '{{ r.NetworkAclsChangeAlarmConfiguredId }}'
      resource_type: network_acls_change_alarm_configured
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.network_gateways_change_alarm_configured
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeNetworkGatewaysChangeAlarmConfigureds
    params: {}
    save_as: network_gateways_change_alarm_configured_response
  emit:
    items_for: '{ network_gateways_change_alarm_configured_response.NetworkGatewaysChangeAlarmConfigureds.NetworkGatewaysChangeAlarmConfigured
      }'
    as: r
    item:
      id: '{{ r.NetworkGatewaysChangeAlarmConfiguredId }}'
      name: '{{ r.NetworkGatewaysChangeAlarmConfiguredId }}'
      resource_type: network_gateways_change_alarm_configured
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.oss_bucket_policy_changes_log_metric_filter_enabled
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeOssBucketPolicyChangesLogMetricFilterEnableds
    params: {}
    save_as: oss_bucket_policy_changes_log_metric_filter_enabled_response
  emit:
    items_for: '{ oss_bucket_policy_changes_log_metric_filter_enabled_response.OssBucketPolicyChangesLogMetricFilterEnableds.OssBucketPolicyChangesLogMetricFilterEnabled
      }'
    as: r
    item:
      id: '{{ r.OssBucketPolicyChangesLogMetricFilterEnabledId }}'
      name: '{{ r.OssBucketPolicyChangesLogMetricFilterEnabledId }}'
      resource_type: oss_bucket_policy_changes_log_metric_filter_enabled
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.route_tables_change_alarm_configured
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeRouteTablesChangeAlarmConfigureds
    params: {}
    save_as: route_tables_change_alarm_configured_response
  emit:
    items_for: '{ route_tables_change_alarm_configured_response.RouteTablesChangeAlarmConfigureds.RouteTablesChangeAlarmConfigured
      }'
    as: r
    item:
      id: '{{ r.RouteTablesChangeAlarmConfiguredId }}'
      name: '{{ r.RouteTablesChangeAlarmConfiguredId }}'
      resource_type: route_tables_change_alarm_configured
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cloudmonitor.vpcs_change_alarm_configured
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeVpcsChangeAlarmConfigureds
    params: {}
    save_as: vpcs_change_alarm_configured_response
  emit:
    items_for: '{ vpcs_change_alarm_configured_response.VpcsChangeAlarmConfigureds.VpcsChangeAlarmConfigured }'
    as: r
    item:
      id: '{{ r.VpcsChangeAlarmConfiguredId }}'
      name: '{{ r.VpcsChangeAlarmConfiguredId }}'
      resource_type: vpcs_change_alarm_configured
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
checks:
- rule_id: alicloud.cloudmonitor.actiontrail_config_changes_log_metric_filter_and_alarm_enabled.configured
  title: Ensure AliCloud CloudMonitor log metric filter and alarm are configured for ActionTrail configuration changes
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.actiontrail_config_changes_log_metric_filter_and_alarm_enabled
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cloudmonitor.alarm.cpu_utilization_threshold_set
  title: AliCloud CloudMonitor CPU Utilization Alarm Threshold Configuration
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alarm
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.alarm.memory_utilization_threshold_set
  title: AliCloud CloudMonitor Memory Utilization Alert Threshold Configuration
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alarm
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.alarm.thresholds_configured
  title: Ensure AliCloud CloudMonitor Alarm Thresholds Are Properly Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alarm
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.alert.nsg_creation_update_logged
  title: Ensure AliCloud CloudMonitor Alert is Configured for Network Security Group Creation and Updates
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alert
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.alert.nsg_deletion_logged
  title: Ensure AliCloud CloudMonitor Alert is Configured for Network Security Group Deletion Events
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alert
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.alert.policy_assignment_creation_logged
  title: Alibaba Cloud CloudMonitor Alert Policy Assignment Creation Must Be Logged
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alert
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.alert.policy_assignment_deletion_logged
  title: Alibaba Cloud CloudMonitor Alert Policy Assignment Deletion Events Must Be Logged
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alert
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.alert.public_ip_rule_change_logged
  title: Ensure AliCloud CloudMonitor Alert Rules for Public IP Changes Are Properly Logged
  severity: high
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alert
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.alert.public_ip_rule_deletion_logged
  title: Ensure AliCloud CloudMonitor Alert Rules for Public IP Deletion Events Are Properly Logged
  severity: high
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alert
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.alert.rds_sqlserver_firewall_rule_change_logged
  title: Ensure ApsaraDB RDS for SQL Server Firewall Rule Changes Are Logged in CloudMonitor
  severity: medium
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alert
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.alert.rds_sqlserver_firewall_rule_deletion_logged
  title: Ensure ApsaraDB RDS for SQL Server Firewall Rule Deletion Events Are Logged in CloudMonitor
  severity: medium
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alert
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.alerts.security_solution_creation_update_monitored
  title: AliCloud CloudMonitor Alert for Security Solution Creation and Update Events
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alerts
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.alerts.security_solution_deletion_monitored
  title: AliCloud CloudMonitor Alert for Security Solution Deletion Events
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alerts
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.config_changes_log_metric_filter_and_alarm_enabled.configured
  title: Ensure AliCloud CloudMonitor has log metric filter and alarm configured for configuration changes
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.config_changes_log_metric_filter_and_alarm_enabled
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cloudmonitor.diagnostic_settings.categories_appropriately_configured
  title: AliCloud CloudMonitor Diagnostic Settings Categories Should Be Appropriately Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.diagnostic_settings
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cloudmonitor.diagnostic_settings_presence_verified.configured
  title: Ensure AliCloud CloudMonitor diagnostic settings are properly configured for security monitoring
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.diagnostic_settings_presence_verified
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cloudmonitor.log.metric_filter_and_alarm_for_actiontrail_changes_with_90_day_retention
  title: Ensure AliCloud CloudMonitor Log Service Has Metric Filter And Alarm For ActionTrail Changes With 90 Day Retention
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.log.metric_filter_and_alert_for_oss_bucket_policy_changes
  title: Ensure CloudMonitor Log Service has metric filter and alert configured for Object Storage Service bucket policy changes
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.log_group.kms_encryption_at_rest_enabled
  title: Ensure AliCloud CloudMonitor Log Groups Have KMS Encryption At Rest Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_group
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.kms_key_id
      op: exists
    - var: item.logging_enabled
      op: equals
      value: true
- rule_id: alicloud.cloudmonitor.log_group.no_secrets_in_logs_with_access_control
  title: Ensure AliCloud CloudMonitor Log Groups Do Not Contain Secrets and Have Proper Access Control
  severity: high
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_group
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.log_group.not_publicly_accessible_with_encryption_enabled
  title: Ensure AliCloud CloudMonitor Log Groups Are Not Publicly Accessible and Have Encryption Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_group
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
    - var: item.logging_enabled
      op: equals
      value: true
- rule_id: alicloud.cloudmonitor.log_group.retention_90_days
  title: CloudMonitor Log Groups Should Have Minimum 90-Day Retention Period
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_group
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.log_group_kms_cmk_encryption_at_rest_enabled.configured
  title: Ensure CloudMonitor log groups have KMS CMK encryption at rest enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_group_kms_cmk_encryption_at_rest_enabled
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.kms_key_id
      op: exists
    - var: item.logging_enabled
      op: equals
      value: true
- rule_id: alicloud.cloudmonitor.log_group_retention_policy_90_days_enabled.configured
  title: Ensure AliCloud CloudMonitor log group retention policy is configured for 90 days
  severity: medium
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_group_retention_policy_90_days_enabled
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cloudmonitor.log_metric_filter.organizations_changes_with_alerting
  title: Ensure AliCloud CloudMonitor Log Metric Filter Monitors Resource Directory Organizations Changes with Alerting
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.log_metric_filter_and_alarm_for_actiontrail_config_changes_enabled.configured
  title: Ensure AliCloud CloudMonitor log metric filter and alarm for ActionTrail configuration changes is enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_and_alarm_for_actiontrail_config_changes_enabled
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cloudmonitor.log_metric_filter_and_alarm_for_config_changes_enabled.configured
  title: Ensure AliCloud CloudMonitor log metric filter and alarm for configuration changes is configured
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_and_alarm_for_config_changes_enabled
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cloudmonitor.log_metric_filter_for_authentication_failures.configured
  title: Ensure AliCloud CloudMonitor log metric filter for authentication failures is configured
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_for_authentication_failures
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.log_metric_filter_for_bucket_policy_changes.configured
  title: Ensure AliCloud CloudMonitor log metric filter is configured for Object Storage Service bucket policy changes
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_for_bucket_policy_changes
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.log_metric_filter_for_kms_cmk_deletion_or_disablement.configured
  title: Ensure AliCloud CloudMonitor log metric filter is configured for Key Management Service customer master key deletion
    or disablement
  severity: medium
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_for_kms_cmk_deletion_or_disablement
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.kms_key_id
      op: exists
- rule_id: alicloud.cloudmonitor.log_metric_filter_for_policy_changes.configured
  title: Ensure AliCloud CloudMonitor log metric filter for policy changes is configured
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_for_policy_changes
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.log_metric_filter_for_root_account_usage.configured
  title: Ensure AliCloud CloudMonitor Log Metric Filter is Configured for Root Account Usage Detection
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_for_root_account_usage
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.cloudmonitor.log_metric_filter_for_security_group_changes.configured
  title: Ensure AliCloud CloudMonitor log metric filter is configured for security group changes
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_for_security_group_changes
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.log_metric_filter_for_sign_in_without_mfa.configured
  title: Ensure AliCloud CloudMonitor log metric filter is configured for sign-in without MFA
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_for_sign_in_without_mfa
  params: {}
  conditions:
    var: item.mfa_enabled
    op: equals
    value: true
- rule_id: alicloud.cloudmonitor.log_metric_filter_for_unauthorized_api_calls.configured
  title: Ensure AliCloud CloudMonitor log metric filter for unauthorized API calls is configured
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_for_unauthorized_api_calls
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.log_metric_filter_kms_cmk_deletion_or_disablement.configured
  title: Ensure AliCloud CloudMonitor log metric filter for KMS Customer Master Key deletion or disablement is configured
  severity: medium
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_kms_cmk_deletion_or_disablement
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.kms_key_id
      op: exists
- rule_id: alicloud.cloudmonitor.log_storage.activity_logs_cmk_encryption_enabled
  title: Alibaba Cloud CloudMonitor Activity Logs Must Use Customer-Managed Key (CMK) Encryption
  severity: high
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_storage
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.kms_key_id
      op: exists
    - var: item.logging_enabled
      op: equals
      value: true
- rule_id: alicloud.cloudmonitor.log_storage.activity_logs_private_access_enforced
  title: Ensure AliCloud CloudMonitor Activity Logs Enforce Private Access Only
  severity: medium
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_storage
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.cloudmonitor.network_acls_change_alarm_configured.configured
  title: Ensure AliCloud CloudMonitor alarm is configured for Network ACL changes
  severity: medium
  assertion_id: ''
  for_each: alicloud.cloudmonitor.network_acls_change_alarm_configured
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.network_gateways_change_alarm_configured.configured
  title: Ensure AliCloud CloudMonitor Network Gateway Change Alarms Are Configured
  severity: medium
  assertion_id: ''
  for_each: alicloud.cloudmonitor.network_gateways_change_alarm_configured
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.oss_bucket_policy_changes_log_metric_filter_enabled.configured
  title: Ensure AliCloud CloudMonitor log metric filter is configured for Object Storage Service bucket policy changes
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.oss_bucket_policy_changes_log_metric_filter_enabled
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cloudmonitor.route_tables_change_alarm_configured.configured
  title: Ensure AliCloud CloudMonitor Route Table Change Alarms Are Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.route_tables_change_alarm_configured
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cloudmonitor.vpcs_change_alarm_configured.configured
  title: Ensure AliCloud CloudMonitor VPC Change Alarm is Configured
  severity: medium
  assertion_id: ''
  for_each: alicloud.cloudmonitor.vpcs_change_alarm_configured
  params: {}
  conditions:
    var: item.id
    op: exists
