version: '1.0'
provider: alicloud
service: bss
discovery:
- discovery_id: alicloud.bss.categories
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeCategoriess
    params: {}
    save_as: categories_response
  emit:
    items_for: '{ categories_response.Categoriess.Categories }'
    as: r
    item:
      id: '{{ r.CategoriesId }}'
      name: '{{ r.CategoriesId }}'
      resource_type: categories
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.bss.cost
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeCosts
    params: {}
    save_as: cost_response
  emit:
    items_for: '{ cost_response.Costs.Cost }'
    as: r
    item:
      id: '{{ r.CostId }}'
      name: '{{ r.CostId }}'
      resource_type: cost
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.bss.document
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDocuments
    params: {}
    save_as: document_response
  emit:
    items_for: '{ document_response.Documents.Document }'
    as: r
    item:
      id: '{{ r.DocumentId }}'
      name: '{{ r.DocumentId }}'
      resource_type: document
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.bss.documents
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDocumentss
    params: {}
    save_as: documents_response
  emit:
    items_for: '{ documents_response.Documentss.Documents }'
    as: r
    item:
      id: '{{ r.DocumentsId }}'
      name: '{{ r.DocumentsId }}'
      resource_type: documents
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.bss.ecs
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeEcss
    params: {}
    save_as: ecs_response
  emit:
    items_for: '{ ecs_response.Ecss.Ecs }'
    as: r
    item:
      id: '{{ r.EcsId }}'
      name: '{{ r.EcsId }}'
      resource_type: ecs
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.bss.encryption_at_rest_enabled
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeEncryptionAtRestEnableds
    params: {}
    save_as: encryption_at_rest_enabled_response
  emit:
    items_for: '{ encryption_at_rest_enabled_response.EncryptionAtRestEnableds.EncryptionAtRestEnabled }'
    as: r
    item:
      id: '{{ r.EncryptionAtRestEnabledId }}'
      name: '{{ r.EncryptionAtRestEnabledId }}'
      resource_type: encryption_at_rest_enabled
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.bss.instances
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeInstancess
    params: {}
    save_as: instances_response
  emit:
    items_for: '{ instances_response.Instancess.Instances }'
    as: r
    item:
      id: '{{ r.InstancesId }}'
      name: '{{ r.InstancesId }}'
      resource_type: instances
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.bss.managed
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeManageds
    params: {}
    save_as: managed_response
  emit:
    items_for: '{ managed_response.Manageds.Managed }'
    as: r
    item:
      id: '{{ r.ManagedId }}'
      name: '{{ r.ManagedId }}'
      resource_type: managed
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.bss.plans
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribePlanss
    params: {}
    save_as: plans_response
  emit:
    items_for: '{ plans_response.Planss.Plans }'
    as: r
    item:
      id: '{{ r.PlansId }}'
      name: '{{ r.PlansId }}'
      resource_type: plans
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.bss.plans_configured_and_active
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribePlansConfiguredAndActives
    params: {}
    save_as: plans_configured_and_active_response
  emit:
    items_for: '{ plans_configured_and_active_response.PlansConfiguredAndActives.PlansConfiguredAndActive }'
    as: r
    item:
      id: '{{ r.PlansConfiguredAndActiveId }}'
      name: '{{ r.PlansConfiguredAndActiveId }}'
      resource_type: plans_configured_and_active
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.bss.queues
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeQueuess
    params: {}
    save_as: queues_response
  emit:
    items_for: '{ queues_response.Queuess.Queues }'
    as: r
    item:
      id: '{{ r.QueuesId }}'
      name: '{{ r.QueuesId }}'
      resource_type: queues
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.bss.recovery_point
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeRecoveryPoints
    params: {}
    save_as: recovery_point_response
  emit:
    items_for: '{ recovery_point_response.RecoveryPoints.RecoveryPoint }'
    as: r
    item:
      id: '{{ r.RecoveryPointId }}'
      name: '{{ r.RecoveryPointId }}'
      resource_type: recovery_point
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.bss.recovery_point_encryption_at_rest_enabled
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeRecoveryPointEncryptionAtRestEnableds
    params: {}
    save_as: recovery_point_encryption_at_rest_enabled_response
  emit:
    items_for: '{ recovery_point_encryption_at_rest_enabled_response.RecoveryPointEncryptionAtRestEnableds.RecoveryPointEncryptionAtRestEnabled
      }'
    as: r
    item:
      id: '{{ r.RecoveryPointEncryptionAtRestEnabledId }}'
      name: '{{ r.RecoveryPointEncryptionAtRestEnabledId }}'
      resource_type: recovery_point_encryption_at_rest_enabled
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.bss.reportplans_configured_and_active
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeReportplansConfiguredAndActives
    params: {}
    save_as: reportplans_configured_and_active_response
  emit:
    items_for: '{ reportplans_configured_and_active_response.ReportplansConfiguredAndActives.ReportplansConfiguredAndActive
      }'
    as: r
    item:
      id: '{{ r.ReportplansConfiguredAndActiveId }}'
      name: '{{ r.ReportplansConfiguredAndActiveId }}'
      resource_type: reportplans_configured_and_active
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.bss.snapshot
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeSnapshots
    params: {}
    save_as: snapshot_response
  emit:
    items_for: '{ snapshot_response.Snapshots.Snapshot }'
    as: r
    item:
      id: '{{ r.SnapshotId }}'
      name: '{{ r.SnapshotId }}'
      resource_type: snapshot
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.bss.tls_via_cas_kms
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeTlsViaCasKmss
    params: {}
    save_as: tls_via_cas_kms_response
  emit:
    items_for: '{ tls_via_cas_kms_response.TlsViaCasKmss.TlsViaCasKms }'
    as: r
    item:
      id: '{{ r.TlsViaCasKmsId }}'
      name: '{{ r.TlsViaCasKmsId }}'
      resource_type: tls_via_cas_kms
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.bss.topics
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeTopicss
    params: {}
    save_as: topics_response
  emit:
    items_for: '{ topics_response.Topicss.Topics }'
    as: r
    item:
      id: '{{ r.TopicsId }}'
      name: '{{ r.TopicsId }}'
      resource_type: topics
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.bss.vault
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeVaults
    params: {}
    save_as: vault_response
  emit:
    items_for: '{ vault_response.Vaults.Vault }'
    as: r
    item:
      id: '{{ r.VaultId }}'
      name: '{{ r.VaultId }}'
      resource_type: vault
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.bss.vaults
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeVaultss
    params: {}
    save_as: vaults_response
  emit:
    items_for: '{ vaults_response.Vaultss.Vaults }'
    as: r
    item:
      id: '{{ r.VaultsId }}'
      name: '{{ r.VaultsId }}'
      resource_type: vaults
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.bss.vaults_configured_and_access_controlled
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeVaultsConfiguredAndAccessControlleds
    params: {}
    save_as: vaults_configured_and_access_controlled_response
  emit:
    items_for: '{ vaults_configured_and_access_controlled_response.VaultsConfiguredAndAccessControlleds.VaultsConfiguredAndAccessControlled
      }'
    as: r
    item:
      id: '{{ r.VaultsConfiguredAndAccessControlledId }}'
      name: '{{ r.VaultsConfiguredAndAccessControlledId }}'
      resource_type: vaults_configured_and_access_controlled
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.bss.volume
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeVolumes
    params: {}
    save_as: volume_response
  emit:
    items_for: '{ volume_response.Volumes.Volume }'
    as: r
    item:
      id: '{{ r.VolumeId }}'
      name: '{{ r.VolumeId }}'
      resource_type: volume
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
checks:
- rule_id: alicloud.bss.categories.access_billing_admins_mfa_required
  title: AliCloud Business Support System Billing Administrators Must Enable Multi-Factor Authentication
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.categories
  params: {}
  conditions:
    var: item.mfa_enabled
    op: equals
    value: true
- rule_id: alicloud.bss.categories.access_billing_console_rbac_least_privilege
  title: Billing Service Console Access Should Follow RBAC Least Privilege Principles
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.categories
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.bss.categories.access_cost_data_exports_private_and_encrypted
  title: Ensure AliCloud Business Support System Cost Data Exports Are Private and Encrypted
  severity: medium
  assertion_id: ''
  for_each: alicloud.bss.categories
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.bss.categories.access_cost_export_destinations_least_privilege
  title: AliCloud Business Support System Cost Export Destinations Should Follow Least Privilege Access Principles
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.categories
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.bss.cost.budget_modify_permissions_restricted
  title: AliCloud Business Support System Budget Modification Permissions Should Be Restricted
  severity: low
  assertion_id: ''
  for_each: alicloud.bss.cost
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.bss.document.secrets
  title: Billing Settlement System documents should not contain embedded secrets or sensitive credentials
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.document
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.bss.documents.set_as_public
  title: Ensure Business Support System (BSS) Documents Are Not Set As Public
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.documents
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.bss.ecs.regular_backups_configured
  title: Ensure Elastic Compute Service instances have regular backup snapshots configured
  severity: medium
  assertion_id: ''
  for_each: alicloud.bss.ecs
  params: {}
  conditions:
    var: item.backup_enabled
    op: equals
    value: true
- rule_id: alicloud.bss.encryption_at_rest_enabled.configured
  title: AliCloud Business Support System (BSS) Encryption at Rest Should Be Configured
  severity: medium
  assertion_id: ''
  for_each: alicloud.bss.encryption_at_rest_enabled
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.bss.instances.reservation_billing_admins_mfa_required
  title: Business Support System Reservation Billing Administrators Must Enable Multi-Factor Authentication
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.instances
  params: {}
  conditions:
    var: item.mfa_enabled
    op: equals
    value: true
- rule_id: alicloud.bss.instances.reservation_purchase_permissions_restricted
  title: Billing Service System Reservation Purchase Permissions Should Be Restricted
  severity: low
  assertion_id: ''
  for_each: alicloud.bss.instances
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.bss.managed.compliant_patching
  title: AliCloud Business Support Service Managed Resources Must Maintain Compliant Patching
  severity: medium
  assertion_id: ''
  for_each: alicloud.bss.managed
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.bss.plans.properly_configured
  title: Ensure AliCloud Business Support Service Plans Are Properly Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.bss.plans
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.bss.plans.retention_90_days_minimum
  title: Business Support System (BSS) Plans Must Have Minimum 90-Day Data Retention Period
  severity: low
  assertion_id: ''
  for_each: alicloud.bss.plans
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.bss.plans.savings_plan_billing_admins_mfa_required
  title: Business Support System Savings Plan Billing Administrators Must Have Multi-Factor Authentication Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.plans
  params: {}
  conditions:
    var: item.mfa_enabled
    op: equals
    value: true
- rule_id: alicloud.bss.plans_configured_and_active.configured
  title: Ensure Business Support Service (BSS) billing plans are properly configured and active
  severity: low
  assertion_id: ''
  for_each: alicloud.bss.plans_configured_and_active
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.bss.queues.not_publicly_accessible
  title: Ensure AliCloud Message Queue for Apache RocketMQ queues are not publicly accessible
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.queues
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.bss.queues.server_side_encryption_enabled
  title: AliCloud Message Service Queues Should Have Server-Side Encryption Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.queues
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.bss.recovery_point.encryption_at_rest_enabled
  title: AliCloud Hybrid Backup Recovery Point Encryption At Rest Should Be Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.recovery_point
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.backup_enabled
      op: equals
      value: true
- rule_id: alicloud.bss.recovery_point.retention_90_days_minimum
  title: Business Support System Recovery Points Must Maintain Minimum 90-Day Retention Period
  severity: low
  assertion_id: ''
  for_each: alicloud.bss.recovery_point
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.bss.recovery_point_encryption_at_rest_enabled.configured
  title: Ensure AliCloud Hybrid Backup Recovery (HBR) recovery points have encryption at rest enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.bss.recovery_point_encryption_at_rest_enabled
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.backup_enabled
      op: equals
      value: true
- rule_id: alicloud.bss.reportplans_configured_and_active.configured
  title: Ensure AliCloud Business Support Service (BSS) report plans are properly configured and active
  severity: low
  assertion_id: ''
  for_each: alicloud.bss.reportplans_configured_and_active
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.bss.snapshot.encryption
  title: Elastic Compute Service snapshots must be encrypted at rest
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.snapshot
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.bss.tls_via_cas_kms.encryption_mtls_required_for_internal_services_where_supported
  title: Ensure Mutual TLS Encryption is Required for Internal Business Support System Services Where Supported
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.tls_via_cas_kms
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.ssl_enabled
      op: equals
      value: true
- rule_id: alicloud.bss.tls_via_cas_kms.encryption_tls_min_1_2_enforced
  title: Business Support System TLS certificates via Certificate Authority Service and Key Management Service must enforce
    minimum TLS 1.2 encryption
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.tls_via_cas_kms
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.ssl_enabled
      op: equals
      value: true
    - var: item.min_tls_version
      op: gte
      value: '1.2'
- rule_id: alicloud.bss.topics.kms_encryption_at_rest_enabled
  title: Ensure AliCloud Message Service Topics Have KMS Encryption At Rest Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.topics
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.bss.topics.not_publicly_accessible
  title: Ensure AliCloud Business Support System Topics Are Not Publicly Accessible
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.topics
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.bss.vault.encryption_at_rest_enabled
  title: Alibaba Cloud Hybrid Backup Recovery Vault Encryption At Rest Should Be Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.vault
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.backup_enabled
      op: equals
      value: true
- rule_id: alicloud.bss.vaults.encryption_at_rest_enabled
  title: Hybrid Backup Recovery (HBR) vaults must have encryption at rest enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.vaults
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.backup_enabled
      op: equals
      value: true
- rule_id: alicloud.bss.vaults_configured_and_access_controlled.configured
  title: Ensure Hybrid Backup Recovery vaults are properly configured with appropriate access controls
  severity: medium
  assertion_id: ''
  for_each: alicloud.bss.vaults_configured_and_access_controlled
  params: {}
  conditions:
    var: item.backup_enabled
    op: equals
    value: true
- rule_id: alicloud.bss.volume.backup_configured
  title: Billing Settlement Service Volume Backup Configuration Check
  severity: medium
  assertion_id: ''
  for_each: alicloud.bss.volume
  params: {}
  conditions:
    var: item.backup_enabled
    op: equals
    value: true
