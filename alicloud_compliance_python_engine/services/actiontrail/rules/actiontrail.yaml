version: '1.0'
provider: alicloud
service: actiontrail
discovery:
- discovery_id: alicloud.actiontrail.cloudmonitor
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeCloudmonitors
    params: {}
    save_as: cloudmonitor_response
  emit:
    items_for: '{ cloudmonitor_response.Cloudmonitors.Cloudmonitor }'
    as: r
    item:
      id: '{{ r.CloudmonitorId }}'
      name: '{{ r.CloudmonitorId }}'
      resource_type: cloudmonitor
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.cloudwatch
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeCloudwatchs
    params: {}
    save_as: cloudwatch_response
  emit:
    items_for: '{ cloudwatch_response.Cloudwatchs.Cloudwatch }'
    as: r
    item:
      id: '{{ r.CloudwatchId }}'
      name: '{{ r.CloudwatchId }}'
      resource_type: cloudwatch
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.configuration
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeConfigurations
    params: {}
    save_as: configuration_response
  emit:
    items_for: '{ configuration_response.Configurations.Configuration }'
    as: r
    item:
      id: '{{ r.ConfigurationId }}'
      name: '{{ r.ConfigurationId }}'
      resource_type: configuration
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.data_events_read_logging_enabled
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDataEventsReadLoggingEnableds
    params: {}
    save_as: data_events_read_logging_enabled_response
  emit:
    items_for: '{ data_events_read_logging_enabled_response.DataEventsReadLoggingEnableds.DataEventsReadLoggingEnabled }'
    as: r
    item:
      id: '{{ r.DataEventsReadLoggingEnabledId }}'
      name: '{{ r.DataEventsReadLoggingEnabledId }}'
      resource_type: data_events_read_logging_enabled
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.delivery
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDeliverys
    params: {}
    save_as: delivery_response
  emit:
    items_for: '{ delivery_response.Deliverys.Delivery }'
    as: r
    item:
      id: '{{ r.DeliveryId }}'
      name: '{{ r.DeliveryId }}'
      resource_type: delivery
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.enabled
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeEnableds
    params: {}
    save_as: enabled_response
  emit:
    items_for: '{ enabled_response.Enableds.Enabled }'
    as: r
    item:
      id: '{{ r.EnabledId }}'
      name: '{{ r.EnabledId }}'
      resource_type: enabled
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.failed_console_signin_alerts
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeFailedConsoleSigninAlertss
    params: {}
    save_as: failed_console_signin_alerts_response
  emit:
    items_for: '{ failed_console_signin_alerts_response.FailedConsoleSigninAlertss.FailedConsoleSigninAlerts }'
    as: r
    item:
      id: '{{ r.FailedConsoleSigninAlertsId }}'
      name: '{{ r.FailedConsoleSigninAlertsId }}'
      resource_type: failed_console_signin_alerts
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.kms
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeKmss
    params: {}
    save_as: kms_response
  emit:
    items_for: '{ kms_response.Kmss.Kms }'
    as: r
    item:
      id: '{{ r.KmsId }}'
      name: '{{ r.KmsId }}'
      resource_type: kms
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.kms_encryption_active
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeKmsEncryptionActives
    params: {}
    save_as: kms_encryption_active_response
  emit:
    items_for: '{ kms_encryption_active_response.KmsEncryptionActives.KmsEncryptionActive }'
    as: r
    item:
      id: '{{ r.KmsEncryptionActiveId }}'
      name: '{{ r.KmsEncryptionActiveId }}'
      resource_type: kms_encryption_active
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.log_file_integrity_validation_enabled
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogFileIntegrityValidationEnableds
    params: {}
    save_as: log_file_integrity_validation_enabled_response
  emit:
    items_for: '{ log_file_integrity_validation_enabled_response.LogFileIntegrityValidationEnableds.LogFileIntegrityValidationEnabled
      }'
    as: r
    item:
      id: '{{ r.LogFileIntegrityValidationEnabledId }}'
      name: '{{ r.LogFileIntegrityValidationEnabledId }}'
      resource_type: log_file_integrity_validation_enabled
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.logging
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLoggings
    params: {}
    save_as: logging_response
  emit:
    items_for: '{ logging_response.Loggings.Logging }'
    as: r
    item:
      id: '{{ r.LoggingId }}'
      name: '{{ r.LoggingId }}'
      resource_type: logging
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.logging_all_regions_properly_configured
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLoggingAllRegionsProperlyConfigureds
    params: {}
    save_as: logging_all_regions_properly_configured_response
  emit:
    items_for: '{ logging_all_regions_properly_configured_response.LoggingAllRegionsProperlyConfigureds.LoggingAllRegionsProperlyConfigured
      }'
    as: r
    item:
      id: '{{ r.LoggingAllRegionsProperlyConfiguredId }}'
      name: '{{ r.LoggingAllRegionsProperlyConfiguredId }}'
      resource_type: logging_all_regions_properly_configured
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.logging_enabled_90_day_retention
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLoggingEnabled90DayRetentions
    params: {}
    save_as: logging_enabled_90_day_retention_response
  emit:
    items_for: '{ logging_enabled_90_day_retention_response.LoggingEnabled90DayRetentions.LoggingEnabled90DayRetention }'
    as: r
    item:
      id: '{{ r.LoggingEnabled90DayRetentionId }}'
      name: '{{ r.LoggingEnabled90DayRetentionId }}'
      resource_type: logging_enabled_90_day_retention
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.logging_enabled_with_90_day_retention
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLoggingEnabledWith90DayRetentions
    params: {}
    save_as: logging_enabled_with_90_day_retention_response
  emit:
    items_for: '{ logging_enabled_with_90_day_retention_response.LoggingEnabledWith90DayRetentions.LoggingEnabledWith90DayRetention
      }'
    as: r
    item:
      id: '{{ r.LoggingEnabledWith90DayRetentionId }}'
      name: '{{ r.LoggingEnabledWith90DayRetentionId }}'
      resource_type: logging_enabled_with_90_day_retention
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.logs
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogss
    params: {}
    save_as: logs_response
  emit:
    items_for: '{ logs_response.Logss.Logs }'
    as: r
    item:
      id: '{{ r.LogsId }}'
      name: '{{ r.LogsId }}'
      resource_type: logs
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.logservice
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogservices
    params: {}
    save_as: logservice_response
  emit:
    items_for: '{ logservice_response.Logservices.Logservice }'
    as: r
    item:
      id: '{{ r.LogserviceId }}'
      name: '{{ r.LogserviceId }}'
      resource_type: logservice
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.mfa_signin_alerts
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeMfaSigninAlertss
    params: {}
    save_as: mfa_signin_alerts_response
  emit:
    items_for: '{ mfa_signin_alerts_response.MfaSigninAlertss.MfaSigninAlerts }'
    as: r
    item:
      id: '{{ r.MfaSigninAlertsId }}'
      name: '{{ r.MfaSigninAlertsId }}'
      resource_type: mfa_signin_alerts
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.multi
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeMultis
    params: {}
    save_as: multi_response
  emit:
    items_for: '{ multi_response.Multis.Multi }'
    as: r
    item:
      id: '{{ r.MultiId }}'
      name: '{{ r.MultiId }}'
      resource_type: multi
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.multi_region_logging_enabled
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeMultiRegionLoggingEnableds
    params: {}
    save_as: multi_region_logging_enabled_response
  emit:
    items_for: '{ multi_region_logging_enabled_response.MultiRegionLoggingEnableds.MultiRegionLoggingEnabled }'
    as: r
    item:
      id: '{{ r.MultiRegionLoggingEnabledId }}'
      name: '{{ r.MultiRegionLoggingEnabledId }}'
      resource_type: multi_region_logging_enabled
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.oss
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeOsss
    params: {}
    save_as: oss_response
  emit:
    items_for: '{ oss_response.Osss.Oss }'
    as: r
    item:
      id: '{{ r.OssId }}'
      name: '{{ r.OssId }}'
      resource_type: oss
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.oss_bucket_access_logging_enabled
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeOssBucketAccessLoggingEnableds
    params: {}
    save_as: oss_bucket_access_logging_enabled_response
  emit:
    items_for: '{ oss_bucket_access_logging_enabled_response.OssBucketAccessLoggingEnableds.OssBucketAccessLoggingEnabled
      }'
    as: r
    item:
      id: '{{ r.OssBucketAccessLoggingEnabledId }}'
      name: '{{ r.OssBucketAccessLoggingEnabledId }}'
      resource_type: oss_bucket_access_logging_enabled
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.oss_bucket_public_access_blocked
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeOssBucketPublicAccessBlockeds
    params: {}
    save_as: oss_bucket_public_access_blocked_response
  emit:
    items_for: '{ oss_bucket_public_access_blocked_response.OssBucketPublicAccessBlockeds.OssBucketPublicAccessBlocked }'
    as: r
    item:
      id: '{{ r.OssBucketPublicAccessBlockedId }}'
      name: '{{ r.OssBucketPublicAccessBlockedId }}'
      resource_type: oss_bucket_public_access_blocked
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.oss_bucket_public_access_blocked_via_acl
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeOssBucketPublicAccessBlockedViaAcls
    params: {}
    save_as: oss_bucket_public_access_blocked_via_acl_response
  emit:
    items_for: '{ oss_bucket_public_access_blocked_via_acl_response.OssBucketPublicAccessBlockedViaAcls.OssBucketPublicAccessBlockedViaAcl
      }'
    as: r
    item:
      id: '{{ r.OssBucketPublicAccessBlockedViaAclId }}'
      name: '{{ r.OssBucketPublicAccessBlockedViaAclId }}'
      resource_type: oss_bucket_public_access_blocked_via_acl
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.oss_read_events_logging_enabled
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeOssReadEventsLoggingEnableds
    params: {}
    save_as: oss_read_events_logging_enabled_response
  emit:
    items_for: '{ oss_read_events_logging_enabled_response.OssReadEventsLoggingEnableds.OssReadEventsLoggingEnabled }'
    as: r
    item:
      id: '{{ r.OssReadEventsLoggingEnabledId }}'
      name: '{{ r.OssReadEventsLoggingEnabledId }}'
      resource_type: oss_read_events_logging_enabled
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.oss_write_events_logging_enabled
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeOssWriteEventsLoggingEnableds
    params: {}
    save_as: oss_write_events_logging_enabled_response
  emit:
    items_for: '{ oss_write_events_logging_enabled_response.OssWriteEventsLoggingEnableds.OssWriteEventsLoggingEnabled }'
    as: r
    item:
      id: '{{ r.OssWriteEventsLoggingEnabledId }}'
      name: '{{ r.OssWriteEventsLoggingEnabledId }}'
      resource_type: oss_write_events_logging_enabled
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.privacy
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribePrivacys
    params: {}
    save_as: privacy_response
  emit:
    items_for: '{ privacy_response.Privacys.Privacy }'
    as: r
    item:
      id: '{{ r.PrivacyId }}'
      name: '{{ r.PrivacyId }}'
      resource_type: privacy
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.s3
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeS3s
    params: {}
    save_as: s3_response
  emit:
    items_for: '{ s3_response.S3s.S3 }'
    as: r
    item:
      id: '{{ r.S3Id }}'
      name: '{{ r.S3Id }}'
      resource_type: s3
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.threat
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeThreats
    params: {}
    save_as: threat_response
  emit:
    items_for: '{ threat_response.Threats.Threat }'
    as: r
    item:
      id: '{{ r.ThreatId }}'
      name: '{{ r.ThreatId }}'
      resource_type: threat
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.threat_detection
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeThreatDetections
    params: {}
    save_as: threat_detection_response
  emit:
    items_for: '{ threat_detection_response.ThreatDetections.ThreatDetection }'
    as: r
    item:
      id: '{{ r.ThreatDetectionId }}'
      name: '{{ r.ThreatDetectionId }}'
      resource_type: threat_detection
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.trail
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeTrails
    params: {}
    save_as: trail_response
  emit:
    items_for: '{ trail_response.Trails.Trail }'
    as: r
    item:
      id: '{{ r.TrailId }}'
      name: '{{ r.TrailId }}'
      resource_type: trail
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.vpc
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeVpcs
    params: {}
    save_as: vpc_response
  emit:
    items_for: '{ vpc_response.Vpcs.Vpc }'
    as: r
    item:
      id: '{{ r.VpcId }}'
      name: '{{ r.VpcId }}'
      resource_type: vpc
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.actiontrail.vpc_change_alerts
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeVpcChangeAlertss
    params: {}
    save_as: vpc_change_alerts_response
  emit:
    items_for: '{ vpc_change_alerts_response.VpcChangeAlertss.VpcChangeAlerts }'
    as: r
    item:
      id: '{{ r.VpcChangeAlertsId }}'
      name: '{{ r.VpcChangeAlertsId }}'
      resource_type: vpc_change_alerts
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
checks:
- rule_id: alicloud.actiontrail.cloudmonitor.logging_enabled_with_90_day_retention
  title: Ensure AliCloud ActionTrail CloudMonitor logging is enabled with 90-day retention period
  severity: medium
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.cloudmonitor
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.cloudwatch.logging_enabled
  title: Ensure ActionTrail CloudWatch Logging is Enabled
  severity: medium
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.cloudwatch
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.configuration.config_delivery_destination_access_least_privilege
  title: Ensure ActionTrail Configuration Delivery Destination Access Follows Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.actiontrail.configuration
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.actiontrail.configuration.config_delivery_kms_encryption_enabled
  title: Ensure AliCloud ActionTrail Configuration Delivery Channel Has KMS Encryption Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.actiontrail.configuration
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.logging_enabled
      op: equals
      value: true
- rule_id: alicloud.actiontrail.data_events_read_logging_enabled.configured
  title: Ensure AliCloud ActionTrail data events read logging is configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.data_events_read_logging_enabled
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.delivery.channel_destination_access_least_privilege
  title: AliCloud ActionTrail Delivery Channel Destination Access Should Follow Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.actiontrail.delivery
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.actiontrail.delivery.channel_kms_encryption_enabled
  title: Ensure AliCloud ActionTrail Delivery Channel Has KMS Encryption Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.actiontrail.delivery
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.logging_enabled
      op: equals
      value: true
- rule_id: alicloud.actiontrail.enabled.configured
  title: Ensure AliCloud ActionTrail is Enabled and Properly Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.enabled
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.failed_console_signin_alerts.configured
  title: Ensure AliCloud ActionTrail Failed Console Sign-in Alerts Are Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.failed_console_signin_alerts
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.actiontrail.kms.encryption_enabled
  title: Ensure ActionTrail trails have KMS encryption enabled
  severity: high
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_CM-6_0046
  for_each: alicloud.actiontrail.kms
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.logging_enabled
      op: equals
      value: true
- rule_id: alicloud.actiontrail.kms_encryption_active.configured
  title: Ensure AliCloud ActionTrail KMS encryption is configured and active
  severity: medium
  assertion_id: ''
  for_each: alicloud.actiontrail.kms_encryption_active
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.logging_enabled
      op: equals
      value: true
- rule_id: alicloud.actiontrail.log_file_integrity_validation_enabled.configured
  title: Ensure AliCloud ActionTrail log file integrity validation is enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.log_file_integrity_validation_enabled
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.logging.all_regions_enabled
  title: Ensure Alibaba Cloud ActionTrail logging is enabled across all regions
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.logging
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.logging.enabled
  title: Ensure AliCloud ActionTrail logging is enabled for audit trail monitoring
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.logging
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.logging.multi_region_enabled_management_events_with_90_day_retention
  title: Ensure Alibaba Cloud ActionTrail has multi-region logging enabled for management events with 90-day retention
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.logging
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.logging_all_regions_properly_configured.configured
  title: Ensure ActionTrail logging is properly configured across all regions
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.logging_all_regions_properly_configured
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.actiontrail.logging_enabled_90_day_retention.configured
  title: Ensure AliCloud ActionTrail logging is enabled with 90-day retention period configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.logging_enabled_90_day_retention
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.logging_enabled_with_90_day_retention.configured
  title: Ensure AliCloud ActionTrail logging is enabled with 90-day retention period configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.logging_enabled_with_90_day_retention
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.logs.file_validation_enabled
  title: Ensure AliCloud ActionTrail Log File Validation is Enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.logs
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.logs.kms_encryption_at_rest_enabled
  title: Ensure ActionTrail Logs Have KMS Encryption At Rest Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.actiontrail.logs
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.logging_enabled
      op: equals
      value: true
- rule_id: alicloud.actiontrail.logs.monitor_mfa_signin_alert
  title: Monitor Multi-Factor Authentication Sign-in Events in AliCloud ActionTrail Logs
  severity: high
  assertion_id: ''
  for_each: alicloud.actiontrail.logs
  params: {}
  conditions:
    var: item.mfa_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.logs.oss_bucket_access_logging_enabled
  title: Ensure ActionTrail Object Storage Service Bucket Access Logging is Enabled
  severity: medium
  assertion_id: gdpr_multi_cloud_Article_25_Data_protection_by_design_and_by_defaul_0001
  for_each: alicloud.actiontrail.logs
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.logs.oss_bucket_is_not_publicly_accessible
  title: Ensure ActionTrail Logs Object Storage Service Bucket Is Not Publicly Accessible
  severity: high
  assertion_id: ''
  for_each: alicloud.actiontrail.logs
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.actiontrail.logs.s3_bucket_access_logging_enabled
  title: Ensure ActionTrail logs have Object Storage Service bucket access logging enabled
  severity: medium
  assertion_id: gdpr_multi_cloud_Article_25_Data_protection_by_design_and_by_defaul_0001
  for_each: alicloud.actiontrail.logs
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.logs.s3_bucket_is_not_publicly_accessible
  title: Ensure ActionTrail Log Storage S3 Bucket Is Not Publicly Accessible
  severity: high
  assertion_id: gdpr_multi_cloud_Article_25_Data_protection_by_design_and_by_defaul_0001
  for_each: alicloud.actiontrail.logs
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.actiontrail.logservice.failed_console_signin_alerts
  title: AliCloud ActionTrail Log Service Failed Console Sign-in Alerts Configuration
  severity: low
  assertion_id: cis_alicloud_alicloud_2.19_0153
  for_each: alicloud.actiontrail.logservice
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.actiontrail.mfa_signin_alerts.configured
  title: Ensure AliCloud ActionTrail MFA Sign-in Alerts are Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.mfa_signin_alerts
  params: {}
  conditions:
    var: item.mfa_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.multi.region_enabled
  title: Ensure Alibaba Cloud ActionTrail Multi-Region Trail is Enabled
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.multi
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.multi.region_enabled_logging_management_events
  title: Alibaba Cloud ActionTrail Multi-Region Management Events Logging Must Be Enabled
  severity: medium
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.multi
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.multi_region_logging_enabled.configured
  title: Ensure AliCloud ActionTrail Multi-Region Logging is Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.multi_region_logging_enabled
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.oss.dataevents_read_enabled
  title: Ensure ActionTrail Object Storage Service Data Events Read Logging is Enabled
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.oss
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.oss.dataevents_read_logging_enabled
  title: Ensure ActionTrail Data Events Read Logging is Enabled for Object Storage Service Buckets
  severity: medium
  assertion_id: ''
  for_each: alicloud.actiontrail.oss
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.oss.dataevents_write_enabled
  title: Ensure ActionTrail Object Storage Service data events write operations are enabled
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.oss
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.oss.dataevents_write_logging_enabled
  title: Ensure ActionTrail Data Events Write Logging is Enabled for Object Storage Service Buckets
  severity: medium
  assertion_id: ''
  for_each: alicloud.actiontrail.oss
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.oss.read_events_enabled
  title: Ensure ActionTrail Read Events are Enabled for Object Storage Service
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.oss
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.oss.write_events_enabled
  title: Ensure ActionTrail Write Events are Enabled for Object Storage Service (OSS)
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.oss
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.oss_bucket_access_logging_enabled.configured
  title: Ensure ActionTrail Object Storage Service bucket access logging is configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.oss_bucket_access_logging_enabled
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.oss_bucket_public_access_blocked.configured
  title: AliCloud ActionTrail OSS Bucket Public Access Blocking Must Be Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.oss_bucket_public_access_blocked
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.actiontrail.oss_bucket_public_access_blocked_via_acl.configured
  title: ActionTrail should monitor Object Storage Service bucket public access blocked via ACL configuration
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.oss_bucket_public_access_blocked_via_acl
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.actiontrail.oss_read_events_logging_enabled.configured
  title: Ensure AliCloud ActionTrail OSS read events logging is configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.oss_read_events_logging_enabled
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.oss_write_events_logging_enabled.configured
  title: Ensure AliCloud ActionTrail OSS Write Events Logging is Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.oss_write_events_logging_enabled
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.privacy.audit_logs_centralized_and_encrypted
  title: Ensure AliCloud ActionTrail audit logs are centralized and encrypted for security compliance
  severity: medium
  assertion_id: ''
  for_each: alicloud.actiontrail.privacy
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.actiontrail.s3.dataevents_read_enabled
  title: Ensure ActionTrail S3 data events read logging is enabled
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.s3
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.s3.dataevents_write_enabled
  title: Ensure AliCloud ActionTrail has S3 data events write logging enabled
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.s3
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.threat.detection_enumeration
  title: AliCloud ActionTrail Threat Detection Enumeration Monitoring
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.5.7_0039
  for_each: alicloud.actiontrail.threat
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.actiontrail.threat.detection_privilege_escalation
  title: AliCloud ActionTrail Privilege Escalation Threat Detection
  severity: high
  assertion_id: iso27001_2022_multi_cloud_A.5.7_0039
  for_each: alicloud.actiontrail.threat
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.actiontrail.threat.llm_jacking
  title: Alibaba Cloud ActionTrail LLM Jacking Threat Detection
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.5.7_0039
  for_each: alicloud.actiontrail.threat
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.actiontrail.threat_detection.enumeration_detected
  title: AliCloud ActionTrail Threat Detection - Enumeration Activity Detected
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.threat_detection
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.actiontrail.threat_detection.llm_jacking_detected
  title: AliCloud ActionTrail LLM Jacking Attack Detection
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.threat_detection
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.actiontrail.threat_detection.privilege_escalation_detected
  title: Alibaba Cloud ActionTrail Privilege Escalation Detection Alert
  severity: high
  assertion_id: ''
  for_each: alicloud.actiontrail.threat_detection
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.actiontrail.trail.logging_enabled
  title: Ensure AliCloud ActionTrail Trail Logging is Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.actiontrail.trail
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.actiontrail.vpc.change_monitoring
  title: Ensure ActionTrail monitors Virtual Private Cloud (VPC) configuration changes
  severity: medium
  assertion_id: cis_alicloud_alicloud_2.13_0147
  for_each: alicloud.actiontrail.vpc
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.actiontrail.vpc_change_alerts.configured
  title: Ensure ActionTrail VPC Change Alerts Are Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.vpc_change_alerts
  params: {}
  conditions:
    var: item.id
    op: exists
