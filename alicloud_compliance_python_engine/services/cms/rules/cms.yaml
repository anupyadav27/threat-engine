version: '1.0'
provider: alicloud
service: cms
discovery:
- discovery_id: alicloud.cms.alarm
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeAlarms
    params: {}
    save_as: alarm_response
  emit:
    items_for: '{ alarm_response.Alarms.Alarm }'
    as: r
    item:
      id: '{{ r.AlarmId }}'
      name: '{{ r.AlarmId }}'
      resource_type: alarm
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cms.alert_escalation
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeAlertEscalations
    params: {}
    save_as: alert_escalation_response
  emit:
    items_for: '{ alert_escalation_response.AlertEscalations.AlertEscalation }'
    as: r
    item:
      id: '{{ r.AlertEscalationId }}'
      name: '{{ r.AlertEscalationId }}'
      resource_type: alert_escalation
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cms.alerts
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeAlertss
    params: {}
    save_as: alerts_response
  emit:
    items_for: '{ alerts_response.Alertss.Alerts }'
    as: r
    item:
      id: '{{ r.AlertsId }}'
      name: '{{ r.AlertsId }}'
      resource_type: alerts
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cms.anomaly_detection
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeAnomalyDetections
    params: {}
    save_as: anomaly_detection_response
  emit:
    items_for: '{ anomaly_detection_response.AnomalyDetections.AnomalyDetection }'
    as: r
    item:
      id: '{{ r.AnomalyDetectionId }}'
      name: '{{ r.AnomalyDetectionId }}'
      resource_type: anomaly_detection
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cms.api
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeApis
    params: {}
    save_as: api_response
  emit:
    items_for: '{ api_response.Apis.Api }'
    as: r
    item:
      id: '{{ r.ApiId }}'
      name: '{{ r.ApiId }}'
      resource_type: api
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cms.changes
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeChangess
    params: {}
    save_as: changes_response
  emit:
    items_for: '{ changes_response.Changess.Changes }'
    as: r
    item:
      id: '{{ r.ChangesId }}'
      name: '{{ r.ChangesId }}'
      resource_type: changes
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cms.dashboard
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDashboards
    params: {}
    save_as: dashboard_response
  emit:
    items_for: '{ dashboard_response.Dashboards.Dashboard }'
    as: r
    item:
      id: '{{ r.DashboardId }}'
      name: '{{ r.DashboardId }}'
      resource_type: dashboard
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cms.diagnostic
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDiagnostics
    params: {}
    save_as: diagnostic_response
  emit:
    items_for: '{ diagnostic_response.Diagnostics.Diagnostic }'
    as: r
    item:
      id: '{{ r.DiagnosticId }}'
      name: '{{ r.DiagnosticId }}'
      resource_type: diagnostic
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cms.dr
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeDrs
    params: {}
    save_as: dr_response
  emit:
    items_for: '{ dr_response.Drs.Dr }'
    as: r
    item:
      id: '{{ r.DrId }}'
      name: '{{ r.DrId }}'
      resource_type: dr
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cms.emr
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeEmrs
    params: {}
    save_as: emr_response
  emit:
    items_for: '{ emr_response.Emrs.Emr }'
    as: r
    item:
      id: '{{ r.EmrId }}'
      name: '{{ r.EmrId }}'
      resource_type: emr
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cms.emr_admin
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeEmrAdmins
    params: {}
    save_as: emr_admin_response
  emit:
    items_for: '{ emr_admin_response.EmrAdmins.EmrAdmin }'
    as: r
    item:
      id: '{{ r.EmrAdminId }}'
      name: '{{ r.EmrAdminId }}'
      resource_type: emr_admin
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cms.global
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeGlobals
    params: {}
    save_as: global_response
  emit:
    items_for: '{ global_response.Globals.Global }'
    as: r
    item:
      id: '{{ r.GlobalId }}'
      name: '{{ r.GlobalId }}'
      resource_type: global
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cms.log
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogs
    params: {}
    save_as: log_response
  emit:
    items_for: '{ log_response.Logs.Log }'
    as: r
    item:
      id: '{{ r.LogId }}'
      name: '{{ r.LogId }}'
      resource_type: log
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cms.log_group
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogGroups
    params: {}
    save_as: log_group_response
  emit:
    items_for: '{ log_group_response.LogGroups.LogGroup }'
    as: r
    item:
      id: '{{ r.LogGroupId }}'
      name: '{{ r.LogGroupId }}'
      resource_type: log_group
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cms.log_metric_filter
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeLogMetricFilters
    params: {}
    save_as: log_metric_filter_response
  emit:
    items_for: '{ log_metric_filter_response.LogMetricFilters.LogMetricFilter }'
    as: r
    item:
      id: '{{ r.LogMetricFilterId }}'
      name: '{{ r.LogMetricFilterId }}'
      resource_type: log_metric_filter
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cms.metric
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeMetrics
    params: {}
    save_as: metric_response
  emit:
    items_for: '{ metric_response.Metrics.Metric }'
    as: r
    item:
      id: '{{ r.MetricId }}'
      name: '{{ r.MetricId }}'
      resource_type: metric
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cms.network
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeNetworks
    params: {}
    save_as: network_response
  emit:
    items_for: '{ network_response.Networks.Network }'
    as: r
    item:
      id: '{{ r.NetworkId }}'
      name: '{{ r.NetworkId }}'
      resource_type: network
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cms.network_acls
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeNetworkAclss
    params: {}
    save_as: network_acls_response
  emit:
    items_for: '{ network_acls_response.NetworkAclss.NetworkAcls }'
    as: r
    item:
      id: '{{ r.NetworkAclsId }}'
      name: '{{ r.NetworkAclsId }}'
      resource_type: network_acls
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cms.network_gateways
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeNetworkGatewayss
    params: {}
    save_as: network_gateways_response
  emit:
    items_for: '{ network_gateways_response.NetworkGatewayss.NetworkGateways }'
    as: r
    item:
      id: '{{ r.NetworkGatewaysId }}'
      name: '{{ r.NetworkGatewaysId }}'
      resource_type: network_gateways
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cms.route_tables
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeRouteTabless
    params: {}
    save_as: route_tables_response
  emit:
    items_for: '{ route_tables_response.RouteTabless.RouteTables }'
    as: r
    item:
      id: '{{ r.RouteTablesId }}'
      name: '{{ r.RouteTablesId }}'
      resource_type: route_tables
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cms.storage
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeStorages
    params: {}
    save_as: storage_response
  emit:
    items_for: '{ storage_response.Storages.Storage }'
    as: r
    item:
      id: '{{ r.StorageId }}'
      name: '{{ r.StorageId }}'
      resource_type: storage
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
- discovery_id: alicloud.cms.vpcs
  calls:
  - product: Unknown
    version: '2014-05-26'
    action: DescribeVpcss
    params: {}
    save_as: vpcs_response
  emit:
    items_for: '{ vpcs_response.Vpcss.Vpcs }'
    as: r
    item:
      id: '{{ r.VpcsId }}'
      name: '{{ r.VpcsId }}'
      resource_type: vpcs
      region: '{{ region }}'
      encrypted: '{{ r.Encrypted }}'
      kms_key_id: '{{ r.KMSKeyId }}'
      public_ip_address: '{{ r.PublicIpAddress }}'
      vpc_id: '{{ r.VpcId }}'
      status: '{{ r.Status }}'
      tags: '{{ r.Tags }}'
checks:
- rule_id: alicloud.cms.alarm.alert_alarm_actions_configured
  title: Ensure AliCloud CloudMonitor Service Alarm Alert Actions Are Properly Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.alarm
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.alarm.alert_critical_alarms_enabled
  title: Ensure CloudMonitor Service Critical Alarm Notifications Are Enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.alarm
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cms.alarm.alert_destinations_authenticated
  title: CloudMonitor Service Alarm Alert Destinations Must Be Authenticated
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.alarm
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.alarm.configured
  title: Ensure AliCloud CloudMonitor Service Alarms Are Properly Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.alarm
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.alarm.memory_utilization_configured
  title: CloudMonitor Service Memory Utilization Alarm Configuration
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.alarm
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.alert_escalation.escalation_change_audit_logging_enabled
  title: Ensure CloudMonitor Alert Escalation Change Audit Logging is Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.alert_escalation
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cms.alert_escalation.escalation_policy_exists_for_critical_severity
  title: Ensure AliCloud CloudMonitor Service Has Escalation Policy Configured for Critical Severity Alerts
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.alert_escalation
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.alerts.create_policy_assignment
  title: Ensure CloudMonitor Service Alert Policy Assignments Are Properly Created
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.alerts
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.alerts.create_update_nsg
  title: CloudMonitor Alert Configuration for Network Security Group Create/Update Operations
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.alerts
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.alerts.create_update_public_ip_address_rule
  title: Ensure CloudMonitor Service Alert Rules Are Configured for Public IP Address Changes
  severity: high
  assertion_id: ''
  for_each: alicloud.cms.alerts
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.alerts.create_update_security_solution
  title: Ensure CloudMonitor Service Alert Rules Are Created and Updated for Security Solutions
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.alerts
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.alerts.create_update_sqlserver_fr
  title: Ensure CloudMonitor Alert Rules Are Configured for SQL Server Failover and Recovery Operations
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.alerts
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.alerts.delete_nsg
  title: CloudMonitor Alert for Network Security Group Deletion Should Be Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.alerts
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.alerts.delete_policy_assignment
  title: AliCloud CloudMonitor Service Policy Assignment Deletion Detection
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.alerts
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.alerts.delete_public_ip_address_rule
  title: Ensure CloudMonitor Alert Rules for Public IP Address Deletion Are Configured
  severity: high
  assertion_id: ''
  for_each: alicloud.cms.alerts
  params: {}
  conditions:
    var: item.public_ip_address
    op: exists
- rule_id: alicloud.cms.alerts.delete_security_solution
  title: Prevent Deletion of CloudMonitor Security Solution Alert Rules
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.alerts
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.alerts.delete_sqlserver_fr
  title: Ensure AliCloud CloudMonitor SQL Server Failover Replica Alert Deletion is Monitored
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.alerts
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.alerts.notification_destinations_configured
  title: AliCloud CloudMonitor Alert Rules Must Have Notification Destinations Configured
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.alerts
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.alerts.notification_endpoints_authenticated
  title: Ensure CloudMonitor Service Alert Notification Endpoints Use Authentication
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.alerts
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.alerts.notification_message_encryption_in_transit
  title: Ensure CloudMonitor Service Alert Notifications Use Encryption in Transit
  severity: high
  assertion_id: ''
  for_each: alicloud.cms.alerts
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.cms.alerts.notification_no_public_webhooks
  title: Ensure CloudMonitor Service Alert Notifications Do Not Use Public Webhooks
  severity: high
  assertion_id: ''
  for_each: alicloud.cms.alerts
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.cms.anomaly_detection.anomaly_alerts_configured
  title: Ensure AliCloud CloudMonitor Service Anomaly Detection Alerts Are Properly Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.anomaly_detection
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.anomaly_detection.anomaly_detectors_enabled
  title: Ensure AliCloud CloudMonitor Service Anomaly Detectors Are Enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.anomaly_detection
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cms.api.monitoring_api_access_log_fields_identity_present
  title: Ensure CloudMonitor Service API Access Logs Include Identity Fields for User Attribution
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.api
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.api.monitoring_api_access_log_sink_configured
  title: Ensure CloudMonitor Service API Access Log Sink is Configured
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.api
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.api.monitoring_api_access_logging_enabled
  title: Ensure CloudMonitor Service API Access Logging is Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.api
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cms.changes.to_network_acls_alarm_configured
  title: Ensure CloudMonitor Service has alarm configured for Network ACL changes
  severity: medium
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_CA-7_0039
  for_each: alicloud.cms.changes
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.changes.to_network_gateways_alarm_configured
  title: Ensure CloudMonitor Service Has Alarm Configured for Network Gateway Changes
  severity: medium
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_CA-7_0039
  for_each: alicloud.cms.changes
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.changes.to_network_route_tables_alarm_configured
  title: Ensure CloudMonitor Service Has Alarm Configured for Network Route Table Changes
  severity: medium
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_CA-7_0039
  for_each: alicloud.cms.changes
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.changes.to_vpcs_alarm_configured
  title: Ensure CloudMonitor alarm is configured for Virtual Private Cloud (VPC) changes
  severity: medium
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_CA-7_0039
  for_each: alicloud.cms.changes
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.changes.vpcs_alarm_configured
  title: Ensure CloudMonitor Service Alarms are Configured for Virtual Private Cloud Changes
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.changes
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.dashboard.public_embeds_disabled
  title: AliCloud CloudMonitor Dashboard Public Embeds Should Be Disabled
  severity: high
  assertion_id: ''
  for_each: alicloud.cms.dashboard
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.dashboard.sso_required
  title: CloudMonitor Service Dashboard Must Require Single Sign-On Authentication
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.dashboard
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.diagnostic.setting_with_appropriate_categories
  title: Ensure AliCloud CloudMonitor Service diagnostic settings include appropriate log categories
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.diagnostic
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.diagnostic.settings_exists
  title: Ensure CloudMonitor Service diagnostic settings are configured
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.diagnostic
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.dr.monitoring_alert_destinations_configured
  title: Ensure CloudMonitor Alert Destinations Are Properly Configured for Disaster Recovery Resources
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.dr
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.dr.monitoring_alerts_for_backup_failures_configured
  title: Ensure CloudMonitor Alerts Are Configured for Disaster Recovery Backup Failures
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.dr
  params: {}
  conditions:
    var: item.backup_enabled
    op: equals
    value: true
- rule_id: alicloud.cms.dr.monitoring_alerts_for_replication_lag_configured
  title: Ensure CloudMonitor Alerts Are Configured for Disaster Recovery Replication Lag
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.dr
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.dr.monitoring_alerts_for_rpo_rto_breach_configured
  title: Ensure CloudMonitor Service Has Monitoring Alerts Configured for RPO/RTO Breach in Disaster Recovery
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.dr
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.emr.logging_enabled
  title: Ensure E-MapReduce (EMR) Cluster Logging is Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.emr
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cms.emr_admin.monitoring_enabled
  title: Ensure E-MapReduce cluster monitoring is enabled through CloudMonitor
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.emr_admin
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cms.global.endpoint_event_replication_enabled
  title: Ensure CloudMonitor Service Endpoint Event Replication is Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.global
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cms.log.group_kms_encryption_enabled
  title: Ensure CloudMonitor Service Log Groups Have KMS Encryption Enabled
  severity: high
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_CP-9_0059
  for_each: alicloud.cms.log
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.logging_enabled
      op: equals
      value: true
- rule_id: alicloud.cms.log.group_no_secrets_in_logs
  title: CloudMonitor Service Log Groups Should Not Contain Secrets in Log Data
  severity: high
  assertion_id: ''
  for_each: alicloud.cms.log
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.log.group_not_publicly_accessible
  title: Ensure CloudMonitor Service Log Groups Are Not Publicly Accessible
  severity: high
  assertion_id: ''
  for_each: alicloud.cms.log
  params: {}
  conditions:
    all:
    - var: item.public_ip_address
      op: not_exists
    - var: item.internet_facing
      op: not_equals
      value: true
- rule_id: alicloud.cms.log.group_retention
  title: CloudMonitor Service Log Group Retention Period Configuration
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.log
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.log.group_retention_policy_specific_days_enabled
  title: CloudMonitor Service Log Group Retention Policy Should Have Specific Days Configured
  severity: medium
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_CA-7_0039
  for_each: alicloud.cms.log
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cms.log.group_retention_policy_specific_days_enabled_alicloud_oss_bucket_lifecycle_enabled
  title: Ensure CloudMonitor Service Log Group Retention Policy and Object Storage Service Bucket Lifecycle Management Are
    Properly Configured
  severity: low
  assertion_id: pci_dss_v4_multi_cloud_10.7.2_0160
  for_each: alicloud.cms.log
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cms.log.metric_filter_alicloud_organizations_changes
  title: Ensure CloudMonitor Service has metric filter for AliCloud Organizations changes
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.log
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.log.metric_filter_and_alarm_for_actiontrail_configuration_changes_enabled
  title: Ensure CloudMonitor Service Has Metric Filter and Alarm Configured for ActionTrail Configuration Changes
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.log
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cms.log.metric_filter_and_alarm_for_alicloud_config_configuration_changes_enabled
  title: Ensure CloudMonitor Service Has Metric Filter and Alarm for AliCloud Config Configuration Changes
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.log
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cms.log.metric_filter_and_alarm_for_aws_config_configuration_changes_enabled
  title: Ensure CloudMonitor Service Has Metric Filter and Alarm for AWS Config Configuration Changes
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.log
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cms.log.metric_filter_and_alarm_for_cloudtrail_configuration_changes_enabled
  title: Ensure Cloud Monitor Service Has Metric Filter and Alarm for ActionTrail Configuration Changes
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.log
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cms.log.metric_filter_authentication_failures
  title: Ensure CloudMonitor Service has metric filters configured for authentication failures
  severity: high
  assertion_id: ''
  for_each: alicloud.cms.log
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.log.metric_filter_disable_or_scheduled_deletion_of_kms_cmk
  title: Ensure CloudMonitor Service Log Metric Filter Monitors Disable or Scheduled Deletion of Key Management Service Customer
    Master Keys
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.log
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.kms_key_id
      op: exists
- rule_id: alicloud.cms.log.metric_filter_for_oss_bucket_policy_changes
  title: Ensure CloudMonitor Service Log Service Has Metric Filter for Object Storage Service Bucket Policy Changes
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.log
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.log.metric_filter_for_s3_bucket_policy_changes
  title: Ensure CloudMonitor Service has metric filter configured for Object Storage Service bucket policy changes
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.log
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.log.metric_filter_policy_changes
  title: Ensure CloudMonitor Service Log Metric Filter Policy Changes Are Monitored
  severity: low
  assertion_id: pci_dss_v4_multi_cloud_8.1.1_0099
  for_each: alicloud.cms.log
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.log.metric_filter_policy_changes_alicloud_ram_password_policy_reuse_24_alicloud_ram_user_accesskey_unused_alicloud_ram_user_console_access_unused
  title: Ensure CloudMonitor Service Log Metric Filters Monitor Resource Access Management Policy Changes and Unused Access
    Credentials
  severity: high
  assertion_id: pci_dss_v4_multi_cloud_8.1.1_0099
  for_each: alicloud.cms.log
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.log.metric_filter_root_usage
  title: Ensure CloudMonitor Service has metric filters configured for root user account usage monitoring
  severity: high
  assertion_id: pci_dss_v4_multi_cloud_1.2.1_0003
  for_each: alicloud.cms.log
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.log.metric_filter_security_group_changes
  title: Ensure CloudMonitor Service has metric filters configured for security group changes
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.log
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.log.metric_filter_sign_in_without_mfa
  title: Ensure CloudMonitor Service has metric filter for sign-in events without multi-factor authentication
  severity: high
  assertion_id: ''
  for_each: alicloud.cms.log
  params: {}
  conditions:
    var: item.mfa_enabled
    op: equals
    value: true
- rule_id: alicloud.cms.log.metric_filter_unauthorized_api_calls
  title: Ensure CloudMonitor Service has metric filters configured for unauthorized API calls
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.log
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.log_group.kms_encryption_active
  title: Ensure CloudMonitor Service Log Groups Have KMS Encryption Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.cms.log_group
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.kms_key_id
      op: exists
    - var: item.logging_enabled
      op: equals
      value: true
- rule_id: alicloud.cms.log_group.retention_policy_90_days_enabled
  title: CloudMonitor Service Log Group Should Have 90-Day Retention Policy Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.log_group
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cms.log_metric_filter.iam_policy_changes_detected
  title: Alibaba Cloud Monitor Service Log Metric Filter Should Detect IAM Policy Changes
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.log_metric_filter
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.log_metric_filter.root_account_usage_detected
  title: Alibaba Cloud CloudMonitor Log Metric Filter Should Detect Root Account Usage
  severity: high
  assertion_id: ''
  for_each: alicloud.cms.log_metric_filter
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.cms.metric.metric_filter_console_root_login_detected_filter_present
  title: Ensure CloudMonitor Service has metric filter configured to detect root account console login attempts
  severity: high
  assertion_id: ''
  for_each: alicloud.cms.metric
  params: {}
  conditions:
    var: item.permissions
    op: not_contains
    value: '*'
- rule_id: alicloud.cms.metric.metric_filter_iam_policy_change_detected_filter_present
  title: Ensure CloudMonitor Service Metric Filter for IAM Policy Changes is Configured
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.metric
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.metric.metric_filter_kms_key_deletion_or_disable_detected_filter_present
  title: Ensure CloudMonitor Service Metric Filter for Key Management Service Key Deletion or Disable Events is Present
  severity: high
  assertion_id: ''
  for_each: alicloud.cms.metric
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.cms.metric.metric_filter_network_acl_or_sg_change_detected_filter_present
  title: Ensure CloudMonitor Service Has Metric Filter for Network ACL and Security Group Changes
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.metric
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.network.anomaly_destinations_encrypted
  title: Ensure CloudMonitor Service Network Anomaly Detection Destinations Use Encrypted Connections
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.network
  params: {}
  conditions:
    var: item.encrypted
    op: equals
    value: true
- rule_id: alicloud.cms.network.anomaly_detectors_enabled
  title: Ensure CloudMonitor Service Network Anomaly Detectors Are Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.network
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cms.network.monitoring_alerts_for_anomalies_configured
  title: Ensure CloudMonitor Service Network Anomaly Detection Alerts Are Properly Configured
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.network
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.network.monitoring_flow_logs_enabled
  title: Ensure AliCloud CloudMonitor Service Network Flow Logs Are Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.network
  params: {}
  conditions:
    var: item.logging_enabled
    op: equals
    value: true
- rule_id: alicloud.cms.network_acls.change_detection_alarm_configured
  title: Ensure CloudMonitor Change Detection Alarms are Configured for Network Access Control Lists
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.network_acls
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.network_gateways.change_detection_alarm_configured
  title: Ensure CloudMonitor Change Detection Alarms are Configured for Network Gateways
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.network_gateways
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.route_tables.change_detection_alarm_configured
  title: Ensure CloudMonitor Change Detection Alarms are Configured for Route Tables
  severity: low
  assertion_id: ''
  for_each: alicloud.cms.route_tables
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.storage.account_with_activity_logs_cmk_encrypted
  title: Ensure CloudMonitor Service Activity Logs Are Encrypted with Customer Managed Keys
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.storage
  params: {}
  conditions:
    all:
    - var: item.encrypted
      op: equals
      value: true
    - var: item.kms_key_id
      op: exists
- rule_id: alicloud.cms.storage.account_with_activity_logs_is_private
  title: Ensure AliCloud CloudMonitor Activity Log Storage Account Access Is Private
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.storage
  params: {}
  conditions:
    var: item.id
    op: exists
- rule_id: alicloud.cms.vpcs.change_detection_alarm_configured
  title: Ensure CloudMonitor Change Detection Alarms are Configured for Virtual Private Clouds
  severity: medium
  assertion_id: ''
  for_each: alicloud.cms.vpcs
  params: {}
  conditions:
    var: item.id
    op: exists
