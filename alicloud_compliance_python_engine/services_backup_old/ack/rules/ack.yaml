version: '1.0'
provider: alicloud
service: ack
discovery:
- discovery_id: alicloud.ack.addon
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeAddons
    params: {}
    save_as: addon_list
  emit:
    items_for: '{ addon_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: addon
- discovery_id: alicloud.ack.admission_webhook
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeAdmissionWebhooks
    params: {}
    save_as: admission_webhook_list
  emit:
    items_for: '{ admission_webhook_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: admission_webhook
- discovery_id: alicloud.ack.backup
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeBackups
    params: {}
    save_as: backup_list
  emit:
    items_for: '{ backup_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: backup
- discovery_id: alicloud.ack.certificates
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeCertificatess
    params: {}
    save_as: certificates_list
  emit:
    items_for: '{ certificates_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: certificates
- discovery_id: alicloud.ack.cluster
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeClusters
    params: {}
    save_as: cluster_list
  emit:
    items_for: '{ cluster_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: cluster
- discovery_id: alicloud.ack.configuration_management
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeConfigurationManagements
    params: {}
    save_as: configuration_management_list
  emit:
    items_for: '{ configuration_management_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: configuration_management
- discovery_id: alicloud.ack.control_plane
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeControlPlanes
    params: {}
    save_as: control_plane_list
  emit:
    items_for: '{ control_plane_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: control_plane
- discovery_id: alicloud.ack.disk
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeDisks
    params: {}
    save_as: disk_list
  emit:
    items_for: '{ disk_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: disk
- discovery_id: alicloud.ack.ebs
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeEbss
    params: {}
    save_as: ebs_list
  emit:
    items_for: '{ ebs_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: ebs
- discovery_id: alicloud.ack.enabled
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeEnableds
    params: {}
    save_as: enabled_list
  emit:
    items_for: '{ enabled_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: enabled
- discovery_id: alicloud.ack.endpoints
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeEndpointss
    params: {}
    save_as: endpoints_list
  emit:
    items_for: '{ endpoints_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: endpoints
- discovery_id: alicloud.ack.etcd
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeEtcds
    params: {}
    save_as: etcd_list
  emit:
    items_for: '{ etcd_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: etcd
- discovery_id: alicloud.ack.instance
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeInstances
    params: {}
    save_as: instance_list
  emit:
    items_for: '{ instance_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: instance
- discovery_id: alicloud.ack.kube
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeKubes
    params: {}
    save_as: kube_list
  emit:
    items_for: '{ kube_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: kube
- discovery_id: alicloud.ack.kube_apiserver
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeKubeApiservers
    params: {}
    save_as: kube_apiserver_list
  emit:
    items_for: '{ kube_apiserver_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: kube_apiserver
- discovery_id: alicloud.ack.kubernetes
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeKubernetess
    params: {}
    save_as: kubernetes_list
  emit:
    items_for: '{ kubernetes_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: kubernetes
- discovery_id: alicloud.ack.load_balancer
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeLoadBalancers
    params: {}
    save_as: load_balancer_list
  emit:
    items_for: '{ load_balancer_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: load_balancer
- discovery_id: alicloud.ack.log
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeLogs
    params: {}
    save_as: log_list
  emit:
    items_for: '{ log_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: log
- discovery_id: alicloud.ack.log_service
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeLogServices
    params: {}
    save_as: log_service_list
  emit:
    items_for: '{ log_service_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: log_service
- discovery_id: alicloud.ack.managed_services
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeManagedServicess
    params: {}
    save_as: managed_services_list
  emit:
    items_for: '{ managed_services_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: managed_services
- discovery_id: alicloud.ack.namespace
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeNamespaces
    params: {}
    save_as: namespace_list
  emit:
    items_for: '{ namespace_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: namespace
- discovery_id: alicloud.ack.network_policy
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeNetworkPolicys
    params: {}
    save_as: network_policy_list
  emit:
    items_for: '{ network_policy_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: network_policy
- discovery_id: alicloud.ack.network_policy_enforced_with_least_privilege
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeNetworkPolicyEnforcedWithLeastPrivileges
    params: {}
    save_as: network_policy_enforced_with_least_privilege_list
  emit:
    items_for: '{ network_policy_enforced_with_least_privilege_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: network_policy_enforced_with_least_privilege
- discovery_id: alicloud.ack.node
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeNodes
    params: {}
    save_as: node_list
  emit:
    items_for: '{ node_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: node
- discovery_id: alicloud.ack.node_pool
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeNodePools
    params: {}
    save_as: node_pool_list
  emit:
    items_for: '{ node_pool_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: node_pool
- discovery_id: alicloud.ack.plan
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribePlans
    params: {}
    save_as: plan_list
  emit:
    items_for: '{ plan_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: plan
- discovery_id: alicloud.ack.plans
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribePlanss
    params: {}
    save_as: plans_list
  emit:
    items_for: '{ plans_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: plans
- discovery_id: alicloud.ack.pod
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribePods
    params: {}
    save_as: pod_list
  emit:
    items_for: '{ pod_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: pod
- discovery_id: alicloud.ack.pod_security_policy
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribePodSecurityPolicys
    params: {}
    save_as: pod_security_policy_list
  emit:
    items_for: '{ pod_security_policy_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: pod_security_policy
- discovery_id: alicloud.ack.psp
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribePsps
    params: {}
    save_as: psp_list
  emit:
    items_for: '{ psp_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: psp
- discovery_id: alicloud.ack.ram
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeRams
    params: {}
    save_as: ram_list
  emit:
    items_for: '{ ram_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: ram
- discovery_id: alicloud.ack.ram_role
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeRamRoles
    params: {}
    save_as: ram_role_list
  emit:
    items_for: '{ ram_role_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: ram_role
- discovery_id: alicloud.ack.rbac
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeRbacs
    params: {}
    save_as: rbac_list
  emit:
    items_for: '{ rbac_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: rbac
- discovery_id: alicloud.ack.rbac_k8s
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeRbacK8Ss
    params: {}
    save_as: rbac_k8s_list
  emit:
    items_for: '{ rbac_k8s_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: rbac_k8s
- discovery_id: alicloud.ack.recovery
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeRecoverys
    params: {}
    save_as: recovery_list
  emit:
    items_for: '{ recovery_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: recovery
- discovery_id: alicloud.ack.registry
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeRegistrys
    params: {}
    save_as: registry_list
  emit:
    items_for: '{ registry_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: registry
- discovery_id: alicloud.ack.registry_lifecycle_policy
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeRegistryLifecyclePolicys
    params: {}
    save_as: registry_lifecycle_policy_list
  emit:
    items_for: '{ registry_lifecycle_policy_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: registry_lifecycle_policy
- discovery_id: alicloud.ack.reportplans
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeReportplanss
    params: {}
    save_as: reportplans_list
  emit:
    items_for: '{ reportplans_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: reportplans
- discovery_id: alicloud.ack.repository
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeRepositorys
    params: {}
    save_as: repository_list
  emit:
    items_for: '{ repository_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: repository
- discovery_id: alicloud.ack.scheduler
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeSchedulers
    params: {}
    save_as: scheduler_list
  emit:
    items_for: '{ scheduler_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: scheduler
- discovery_id: alicloud.ack.serverless
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeServerlesss
    params: {}
    save_as: serverless_list
  emit:
    items_for: '{ serverless_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: serverless
- discovery_id: alicloud.ack.service
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeServices
    params: {}
    save_as: service_list
  emit:
    items_for: '{ service_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: service
- discovery_id: alicloud.ack.service_account
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeServiceAccounts
    params: {}
    save_as: service_account_list
  emit:
    items_for: '{ service_account_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: service_account
- discovery_id: alicloud.ack.vault
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeVaults
    params: {}
    save_as: vault_list
  emit:
    items_for: '{ vault_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: vault
- discovery_id: alicloud.ack.vaults
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeVaultss
    params: {}
    save_as: vaults_list
  emit:
    items_for: '{ vaults_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: vaults
- discovery_id: alicloud.ack.workload
  calls:
  - product: ACK
    version: '2014-05-26'
    action: DescribeWorkloads
    params: {}
    save_as: workload_list
  emit:
    items_for: '{ workload_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: workload
checks:
- rule_id: alicloud.ack.addon.addon_no_privileged_permissions
  title: Container Service for Kubernetes (ACK) Addons Should Not Have Privileged
    Permissions
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.addon
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.admission_webhook.admission_host_namespace_usage_denied
  title: Container Service for Kubernetes Admission Controller Should Deny Host Namespace
    Usage
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.admission_webhook
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.admission_webhook.admission_image_registry_allowlist_enforced
  title: Container Service for Kubernetes Admission Controller Image Registry Allowlist
    Must Be Enforced
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.admission_webhook
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.admission_webhook.admission_image_signature_verification_enabled
  title: Container Service for Kubernetes Admission Webhook Image Signature Verification
    Should Be Enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.admission_webhook
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.admission_webhook.admission_pod_security_admission_restricted_default
  title: Container Service for Kubernetes admission webhook should enforce Pod Security
    Admission restricted policy as default
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.admission_webhook
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.admission_webhook.admission_privilege_escalation_denied
  title: Container Service for Kubernetes Admission Controller Must Deny Privilege
    Escalation
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.admission_webhook
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.backup.encryption_enabled
  title: Container Service for Kubernetes (ACK) backup encryption should be enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.backup
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.certificates.expiration_check
  title: Container Service for Kubernetes (ACK) Certificate Expiration Monitoring
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.certificates
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.certificates.not_expired_and_valid
  title: Alibaba Cloud Container Service for Kubernetes (ACK) Certificates Must Not
    Be Expired and Valid
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.certificates
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.approved_container_registries_enforced
  title: Container Service for Kubernetes Cluster Should Enforce Approved Container
    Registries
  severity: low
  assertion_id: cis_alicloud_alicloud_1.2.29_0049
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.audit_logging_remote_enforced
  title: Container Service for Kubernetes cluster must have audit logging with remote
    enforcement enabled
  severity: medium
  assertion_id: cis_alicloud_alicloud_6.5.1_0121
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.basic_auth_disabled_enforced
  title: Alibaba Cloud Container Service for Kubernetes Cluster Basic Authentication
    Must Be Disabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.cloud_monitoring_enabled
  title: Container Service for Kubernetes cluster should have Cloud Monitoring enabled
  severity: medium
  assertion_id: cis_alicloud_alicloud_7.2_0188
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.control_plane_private_access_ip_allowlist_enforced
  title: Container Service for Kubernetes Control Plane Private Access IP Allowlist
    Must Be Enforced
  severity: medium
  assertion_id: cis_alicloud_alicloud_5.1.4_0092
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.dashboard_access_restricted
  title: Container Service for Kubernetes (ACK) cluster dashboard access should be
    restricted
  severity: low
  assertion_id: cis_alicloud_alicloud_7.5_0191
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.endpoint_private_access_enforced
  title: Container Service for Kubernetes cluster endpoint private access should be
    enforced
  severity: medium
  assertion_id: iso27001_2022_multi_cloud_A.8.1_0064
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.kms_cmk_encryption_for_secrets_enabled
  title: Container Service for Kubernetes Cluster KMS Customer Master Key Encryption
    For Secrets Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.kms_cmk_encryption_in_secrets_enabled
  title: Container Service for Kubernetes (ACK) Cluster Should Enable KMS Customer
    Master Key Encryption for Secrets
  severity: high
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_SC-13_0136
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.logging_service_enabled
  title: Container Service for Kubernetes cluster must have logging service enabled
  severity: medium
  assertion_id: cis_alicloud_alicloud_6.5.1_0121
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.network_plugin_terway_compliance_enforced
  title: Container Service for Kubernetes Cluster Must Use Terway Network Plugin for
    Compliance
  severity: medium
  assertion_id: cis_alicloud_alicloud_1.2.29_0049
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.network_policy_enforced
  title: Alibaba Cloud Container Service for Kubernetes Cluster Should Have Network
    Policy Enforced
  severity: medium
  assertion_id: cis_alicloud_alicloud_6.3.4_0118
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.nodes_private_ip_required
  title: Container Service for Kubernetes cluster nodes must use private IP addresses
  severity: medium
  assertion_id: iso27001_2022_multi_cloud_A.8.14_0069
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.not_publicly_accessible
  title: Alibaba Cloud Container Service for Kubernetes (ACK) clusters should not
    be publicly accessible
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.pod_security_policy_compliance_enforced
  title: Container Service for Kubernetes Cluster Must Have Pod Security Policy Compliance
    Enforced
  severity: low
  assertion_id: cis_alicloud_alicloud_6.3.4_0118
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.private_access_enforced
  title: Alibaba Cloud Container Service for Kubernetes cluster should enforce private
    API server access
  severity: medium
  assertion_id: cis_alicloud_alicloud_5.1.4_0092
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.private_nodes_only
  title: Container Service for Kubernetes cluster should use private nodes only
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.public_access_blocked
  title: Container Service for Kubernetes (ACK) cluster should block public API server
    access
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.rbac_authorization_enforced
  title: Container Service for Kubernetes Cluster Must Have RBAC Authorization Enforced
  severity: medium
  assertion_id: cis_alicloud_alicloud_7.3_0189
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.rbac_permissions_least_privilege
  title: Container Service for Kubernetes cluster RBAC permissions should follow least
    privilege principle
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.secret_encryption_kms_enforced
  title: Container Service for Kubernetes Cluster Secret Encryption with KMS Must
    Be Enforced
  severity: high
  assertion_id: hipaa_multi_cloud_164_308_a_4_ii_a_0009
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.uses_latest_supported_version
  title: Container Service for Kubernetes (ACK) cluster should use the latest supported
    Kubernetes version
  severity: low
  assertion_id: pci_dss_v4_multi_cloud_6.2.1_0075
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.cluster.weekly_health_checks_enabled
  title: Container Service for Kubernetes (ACK) Cluster Weekly Health Checks Should
    Be Enabled
  severity: low
  assertion_id: cis_alicloud_alicloud_7.4_0190
  for_each: alicloud.ack.cluster
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.configuration_management.parameter_access_rbac_least_privilege
  title: Container Service for Kubernetes Parameter Access Should Follow RBAC Least
    Privilege Principles
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.configuration_management
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.configuration_management.parameter_kms_key_configured
  title: Alibaba Cloud Container Service for Kubernetes Parameter KMS Key Configuration
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.configuration_management
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.configuration_management.parameter_secure_string_type_for_sensitive
  title: Alibaba Cloud Container Service for Kubernetes Parameter Secure String Type
    For Sensitive Data
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.configuration_management
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.control_plane.admission_psa_enforce_mode
  title: Container Service for Kubernetes cluster control plane should have Pod Security
    Admission enforce mode enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.control_plane
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.control_plane.anonymous_auth_disabled
  title: Alibaba Cloud Container Service for Kubernetes Control Plane Anonymous Authentication
    Should Be Disabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.control_plane
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.control_plane.apiserver_anonymous_auth_disabled
  title: Alibaba Cloud Container Service for Kubernetes API Server Anonymous Authentication
    Should Be Disabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.control_plane
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.control_plane.apiserver_audit_logging_enabled
  title: Alibaba Cloud Container Service for Kubernetes API Server Audit Logging Should
    Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.control_plane
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.control_plane.apiserver_authorization_mode_rbac
  title: Container Service for Kubernetes API Server Should Use RBAC Authorization
    Mode
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.control_plane
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.control_plane.apiserver_etcd_connection_encrypted
  title: Container Service for Kubernetes API Server etcd Connection Must Be Encrypted
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.control_plane
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.control_plane.apiserver_insecure_port_disabled
  title: Alibaba Cloud Container Service for Kubernetes API Server Insecure Port Must
    Be Disabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.control_plane
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.control_plane.apiserver_tls_min_1_2_enforced
  title: Container Service for Kubernetes API Server Must Enforce TLS 1.2 Minimum
    Version
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.control_plane
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.control_plane.root_ca_file_configured
  title: Alibaba Cloud Container Service for Kubernetes Control Plane Root CA File
    Must Be Configured
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.control_plane
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.control_plane.secure_port_enabled
  title: Container Service for Kubernetes Control Plane Secure Port Should Be Enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.control_plane
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.control_plane.secure_port_tls_enabled
  title: Container Service for Kubernetes Control Plane Secure Port TLS Must Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.control_plane
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.control_plane.token_signing_enabled
  title: Alibaba Cloud Container Service for Kubernetes Control Plane Token Signing
    Must Be Enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.control_plane
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.control_plane.use_service_account_credentials_enabled
  title: Container Service for Kubernetes Control Plane Should Have Service Account
    Credentials Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.control_plane
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.disk.data_disk_cmek_encryption_enforced
  title: Alibaba Cloud Container Service for Kubernetes Data Disk CMEK Encryption
    Enforced
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.disk
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.ebs.data_disk_cmek_encryption_check
  title: Container Service for Kubernetes (ACK) EBS Data Disks Must Use Customer-Managed
    Encryption Keys (CMEK)
  severity: high
  assertion_id: cis_alicloud_alicloud_6.4.1_0120
  for_each: alicloud.ack.ebs
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.enabled.for_ec2
  title: Container Service for Kubernetes (ACK) Should Be Enabled for ECS Instances
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.enabled
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.endpoints.not_publicly_accessible
  title: Alibaba Cloud Container Service for Kubernetes (ACK) endpoints should not
    be publicly accessible
  severity: high
  assertion_id: iso27001_2022_multi_cloud_A.8.14_0069
  for_each: alicloud.ack.endpoints
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.endpoints.private_access_only
  title: Container Service for Kubernetes (ACK) API Server Endpoints Should Only Allow
    Private Access
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.endpoints
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.etcd.at_rest_enabled
  title: Container Service for Kubernetes (ACK) etcd encryption at rest should be
    enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.etcd
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.etcd.auth_enabled
  title: Container Service for Kubernetes (ACK) etcd Authentication Must Be Enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.etcd
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.etcd.cert_auth_enabled
  title: Container Service for Kubernetes etcd Certificate Authentication Should Be
    Enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.etcd
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.etcd.client_tls_enabled
  title: Alibaba Cloud Container Service for Kubernetes etcd Client TLS Must Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.etcd
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.etcd.encryption_at_rest_enabled
  title: Container Service for Kubernetes etcd Encryption at Rest Should Be Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.etcd
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.etcd.peer_tls_enabled
  title: Container Service for Kubernetes etcd Peer TLS Communication Must Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.etcd
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.instance.access_policy_network_restriction_enforced
  title: Container Service for Kubernetes (ACK) Cluster Access Policy Network Restriction
    Enforced
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.instance
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.kube.apiserver_client_ca_file_check
  title: Alibaba Cloud Container Service for Kubernetes API Server Client CA File
    Configuration Check
  severity: low
  assertion_id: cis_alicloud_alicloud_1.2.29_0049
  for_each: alicloud.ack.kube
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.kube_apiserver.client_ca_file_properly_configured
  title: Alibaba Cloud Container Service for Kubernetes API Server Client CA File
    Must Be Properly Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.kube_apiserver
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.kubernetes.pod_create_access_least_privilege
  title: Container Service for Kubernetes Pod Creation Should Follow Least Privilege
    Access Principles
  severity: high
  assertion_id: cis_alicloud_alicloud_5.1.4_0092
  for_each: alicloud.ack.kubernetes
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.load_balancer.https_tls_encryption_in_transit_enforced
  title: Container Service for Kubernetes Load Balancer HTTPS TLS Encryption In Transit
    Enforced
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.load_balancer
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.log.service_integration_check
  title: Container Service for Kubernetes Log Service Integration Check
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.log
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.log_service.integration_enabled
  title: Container Service for Kubernetes (ACK) Log Service Integration Should Be
    Enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.log_service
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.managed_services.cluster_service_kube_system_services_not_public
  title: Container Service for Kubernetes kube-system services should not be publicly
    accessible
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.managed_services
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.namespace.namespace_default_service_account_automount_disabled
  title: Alibaba Cloud Container Service for Kubernetes Namespace Default Service
    Account Automount Should Be Disabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.namespace
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.namespace.namespace_network_policies_present
  title: Alibaba Cloud Container Service for Kubernetes Namespace Network Policies
    Present
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.namespace
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.network_policy.networkpolicy_default_deny_egress_per_namespace
  title: Container Service for Kubernetes Network Policy Should Implement Default
    Deny Egress Rules Per Namespace
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.network_policy
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.network_policy.networkpolicy_default_deny_ingress_per_namespace
  title: Alibaba Cloud Container Service for Kubernetes (ACK) clusters should implement
    default deny ingress network policies per namespace
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.network_policy
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.network_policy.policy_enabled
  title: Container Service for Kubernetes Network Policy Should Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.network_policy
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.network_policy_enforced_with_least_privilege.configured
  title: Alibaba Cloud Container Service for Kubernetes network policies should enforce
    least privilege access controls
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.network_policy_enforced_with_least_privilege
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.node.auth_disabled
  title: Container Service for Kubernetes (ACK) Node Authentication Should Be Enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.node
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.node.kubelet_anonymous_auth_disabled
  title: Container Service for Kubernetes (ACK) Node Kubelet Anonymous Authentication
    Should Be Disabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.node
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.node.kubelet_authz_webhook_or_rbac_enabled
  title: Container Service for Kubernetes Node Kubelet Authorization Webhook or RBAC
    Must Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.node
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.node.kubelet_read_only_port_disabled
  title: Alibaba Cloud Container Service for Kubernetes Node Kubelet Read-Only Port
    Should Be Disabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.node
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.node.kubelet_tls_min_1_2_enforced
  title: Container Service for Kubernetes Node Kubelet TLS Minimum Version 1.2 Enforcement
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.node
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.node.only_port_disabled
  title: Alibaba Cloud Container Service for Kubernetes (ACK) nodes should have only
    necessary ports enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.node
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.node.security_patches_current
  title: Container Service for Kubernetes (ACK) Node Security Patches Must Be Current
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.node
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.node_pool.disk_encryption_enabled
  title: Alibaba Cloud Container Service for Kubernetes Node Pool Disk Encryption
    Should Be Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.node_pool
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.node_pool.nodes_no_public_ip
  title: Container Service for Kubernetes (ACK) node pool nodes should not have public
    IP addresses
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.node_pool
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.plan.configured
  title: Container Service for Kubernetes cluster plan must be configured
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.plan
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.plan.min_retention
  title: Container Service for Kubernetes cluster backup plans must have minimum retention
    period configured
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.plan
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.plans.exist
  title: Container Service for Kubernetes (ACK) clusters must have maintenance plans
    configured
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.plans
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.pod.seccomp_profile_runtime_default_enforced
  title: Container Service for Kubernetes Pod Seccomp Profile Runtime Default Enforcement
  severity: low
  assertion_id: cis_alicloud_alicloud_5.6.2_0107
  for_each: alicloud.ack.pod
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.pod.security_context_configured
  title: Alibaba Cloud Container Service for Kubernetes Pod Security Context Must
    Be Configured
  severity: low
  assertion_id: cis_alicloud_alicloud_5.6.3_0108
  for_each: alicloud.ack.pod
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.pod.service_account_token_mounting_disabled
  title: Container Service for Kubernetes Pod Service Account Token Mounting Should
    Be Disabled
  severity: low
  assertion_id: cis_alicloud_alicloud_5.1.6_0094
  for_each: alicloud.ack.pod
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.pod_security_policy.net_raw_capability_dropped
  title: Container Service for Kubernetes Pod Security Policy Should Drop NET_RAW
    Capability
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.pod_security_policy
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.psp.net_raw_capability_disabled
  title: Container Service for Kubernetes Pod Security Policy Should Disable NET_RAW
    Capability
  severity: low
  assertion_id: cis_alicloud_alicloud_5.2.7_0101
  for_each: alicloud.ack.psp
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.psp.root_user_access_prevented
  title: Container Service for Kubernetes Pod Security Policy Should Prevent Root
    User Access
  severity: high
  assertion_id: cis_alicloud_alicloud_5.2.6_0100
  for_each: alicloud.ack.psp
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.ram.role_acr_read_only_access_check
  title: Alibaba Cloud Container Service for Kubernetes RAM Role Should Have Read-Only
    Access to Container Registry
  severity: medium
  assertion_id: cis_alicloud_alicloud_6.1.3_0112
  for_each: alicloud.ack.ram
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.ram_role.acr_read_only_access_enforced
  title: Container Service for Kubernetes RAM Role Should Enforce Container Registry
    Read-Only Access
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.ram_role
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.rbac.authorization_mode_rbac_enabled
  title: Alibaba Cloud Container Service for Kubernetes (ACK) RBAC Authorization Mode
    Must Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.rbac
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.rbac.least_privilege_secrets_access_enforced
  title: Container Service for Kubernetes RBAC Least Privilege Secrets Access Enforced
  severity: high
  assertion_id: cis_alicloud_alicloud_5.1.2_0090
  for_each: alicloud.ack.rbac
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.rbac.no_cluster_admin_bindings_to_users
  title: Container Service for Kubernetes cluster should not have cluster-admin role
    bindings assigned to individual users
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.rbac
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.rbac.no_wildcard_rules_in_clusterroles
  title: Container Service for Kubernetes ClusterRoles Should Not Use Wildcard Permissions
    in RBAC Rules
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.rbac
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.rbac_k8s.cluster_admin_to_authenticated
  title: Container Service for Kubernetes cluster-admin role should not be bound to
    system:authenticated group
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.rbac_k8s
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.rbac_k8s.sa_not_cluster_admin
  title: Alibaba Cloud Container Service for Kubernetes Service Accounts Should Not
    Have Cluster Admin Privileges
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.rbac_k8s
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.recovery.point_encrypted
  title: Container Service for Kubernetes (ACK) Recovery Points Must Be Encrypted
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.recovery
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.recovery.point_encryption
  title: Alibaba Cloud Container Service for Kubernetes recovery point encryption
    should be enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.recovery
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.recovery.point_retention
  title: Container Service for Kubernetes Recovery Point Retention Configuration
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.recovery
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.registry.image_scan_on_push_enabled
  title: Alibaba Cloud Container Service for Kubernetes Registry Image Scan On Push
    Should Be Enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.registry
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.registry.repository_encryption_enabled
  title: Alibaba Cloud Container Registry Repository Encryption Should Be Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.registry
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.registry_lifecycle_policy.lifecycle_policy_policy_storage_encrypted
  title: Container Service for Kubernetes Registry Lifecycle Policy Storage Must Be
    Encrypted
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.registry_lifecycle_policy
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.reportplans.exist
  title: Ensure Container Service for Kubernetes (ACK) clusters have backup report
    plans configured
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.reportplans
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.repository.vulnerability_scanning_continuous
  title: Container Service for Kubernetes (ACK) repository should have continuous
    vulnerability scanning enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.repository
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.scheduler.authentication_kubeconfig_configured
  title: Container Service for Kubernetes Scheduler Authentication Kubeconfig Must
    Be Configured
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.scheduler
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.scheduler.authorization_kubeconfig_configured
  title: Container Service for Kubernetes Scheduler Authorization Kubeconfig Must
    Be Configured
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.scheduler
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.scheduler.secure_port_tls_enabled
  title: Container Service for Kubernetes Scheduler Secure Port TLS Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.scheduler
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.serverless.fargate_profile_execution_role_least_privilege
  title: Container Service for Kubernetes Serverless Fargate Profile Execution Role
    Should Follow Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.serverless
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.serverless.fargate_profile_logging_enabled
  title: Alibaba Cloud Container Service for Kubernetes Serverless Fargate Profile
    Logging Must Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.serverless
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.serverless.fargate_profile_private_subnets_only
  title: Container Service for Kubernetes Serverless Fargate profiles should only
    use private subnets
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.serverless
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.service.task_definition_logging_enabled
  title: Alibaba Cloud Container Service for Kubernetes Task Definition Logging Should
    Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.service
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.service_account.cluster_audit_logging_enabled
  title: Container Service for Kubernetes Cluster Audit Logging Should Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.service_account
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.service_account.cluster_default_service_account_automount_disabled
  title: Container Service for Kubernetes Default Service Account Should Have Automount
    Disabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.service_account
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.service_account.cluster_private_control_plane_endpoint_enabled
  title: Alibaba Cloud Container Service for Kubernetes Cluster Must Have Private
    Control Plane Endpoint Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.service_account
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.service_account.cluster_secrets_encryption_kms_enabled
  title: Container Service for Kubernetes Cluster Secrets Encryption with Key Management
    Service Must Be Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.service_account
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.service_account.default_no_token_no_roles_enforced
  title: Container Service for Kubernetes Default Service Account Token and Role Assignment
    Restrictions
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.service_account
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.service_account.external_ips_not_used
  title: Container Service for Kubernetes service accounts should not use external
    IP addresses
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.service_account
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.service_account.keys_not_used_or_rotated_90_days_or_less
  title: Container Service for Kubernetes service account keys should be used or rotated
    within 90 days
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.service_account
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.service_account.no_user_managed_long_lived_keys
  title: Container Service for Kubernetes service accounts should not use user-managed
    long-lived keys
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.service_account
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.service_account.scopes_or_roles_least_privilege
  title: Container Service for Kubernetes service accounts should follow least privilege
    principle for scopes and roles
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.service_account
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.service_account.token_auto_mount_disabled
  title: Container Service for Kubernetes Service Account Token Auto Mount Should
    Be Disabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.service_account
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.service_account.type_loadbalancer_internal_only_where_required
  title: Container Service for Kubernetes Service Account LoadBalancer Should Be Internal
    Only When Required
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.service_account
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.vault.encryption_enabled
  title: Container Service for Kubernetes (ACK) vault encryption should be enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.vault
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.vaults.encrypted
  title: Alibaba Cloud Container Service for Kubernetes backup vaults must be encrypted
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.vaults
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.vaults.exist
  title: Ensure Container Service for Kubernetes (ACK) clusters have backup vaults
    configured
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.vaults
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.workload.balancer_https_tls_encryption_in_transit
  title: Container Service for Kubernetes Workload Load Balancer HTTPS TLS Encryption
    In Transit
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.workload
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.workload.env_no_plaintext_secrets
  title: Container Service for Kubernetes workloads should not expose secrets in environment
    variables as plaintext
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.workload
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.workload.host_network_pid_ipc_disabled
  title: Alibaba Cloud Container Service for Kubernetes workloads should disable host
    network, PID, and IPC namespace sharing
  severity: medium
  assertion_id: ''
  for_each: alicloud.ack.workload
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.workload.no_hostpath_mounts
  title: Container Service for Kubernetes workloads should not use hostPath volume
    mounts
  severity: low
  assertion_id: ''
  for_each: alicloud.ack.workload
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.workload.no_privileged_containers
  title: Alibaba Cloud Container Service for Kubernetes workloads should not run privileged
    containers
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.workload
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ack.workload.run_as_non_root
  title: Alibaba Cloud Container Service for Kubernetes workloads should run as non-root
    user
  severity: high
  assertion_id: ''
  for_each: alicloud.ack.workload
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
