version: '1.0'
provider: alicloud
service: cloudmonitor
discovery:
- discovery_id: alicloud.cloudmonitor.actiontrail_config_changes_log_metric_filter_and_alarm_enabled
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeActiontrailConfigChangesLogMetricFilterAndAlarmEnableds
    params: {}
    save_as: actiontrail_config_changes_log_metric_filter_and_alarm_enabled_list
  emit:
    items_for: '{ actiontrail_config_changes_log_metric_filter_and_alarm_enabled_list
      }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: actiontrail_config_changes_log_metric_filter_and_alarm_enabled
- discovery_id: alicloud.cloudmonitor.alarm
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeAlarms
    params: {}
    save_as: alarm_list
  emit:
    items_for: '{ alarm_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: alarm
- discovery_id: alicloud.cloudmonitor.alert
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeAlerts
    params: {}
    save_as: alert_list
  emit:
    items_for: '{ alert_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: alert
- discovery_id: alicloud.cloudmonitor.alerts
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeAlertss
    params: {}
    save_as: alerts_list
  emit:
    items_for: '{ alerts_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: alerts
- discovery_id: alicloud.cloudmonitor.config_changes_log_metric_filter_and_alarm_enabled
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeConfigChangesLogMetricFilterAndAlarmEnableds
    params: {}
    save_as: config_changes_log_metric_filter_and_alarm_enabled_list
  emit:
    items_for: '{ config_changes_log_metric_filter_and_alarm_enabled_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: config_changes_log_metric_filter_and_alarm_enabled
- discovery_id: alicloud.cloudmonitor.diagnostic_settings
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeDiagnosticSettingss
    params: {}
    save_as: diagnostic_settings_list
  emit:
    items_for: '{ diagnostic_settings_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: diagnostic_settings
- discovery_id: alicloud.cloudmonitor.diagnostic_settings_presence_verified
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeDiagnosticSettingsPresenceVerifieds
    params: {}
    save_as: diagnostic_settings_presence_verified_list
  emit:
    items_for: '{ diagnostic_settings_presence_verified_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: diagnostic_settings_presence_verified
- discovery_id: alicloud.cloudmonitor.log
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeLogs
    params: {}
    save_as: log_list
  emit:
    items_for: '{ log_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: log
- discovery_id: alicloud.cloudmonitor.log_group
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeLogGroups
    params: {}
    save_as: log_group_list
  emit:
    items_for: '{ log_group_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: log_group
- discovery_id: alicloud.cloudmonitor.log_group_kms_cmk_encryption_at_rest_enabled
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeLogGroupKmsCmkEncryptionAtRestEnableds
    params: {}
    save_as: log_group_kms_cmk_encryption_at_rest_enabled_list
  emit:
    items_for: '{ log_group_kms_cmk_encryption_at_rest_enabled_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: log_group_kms_cmk_encryption_at_rest_enabled
- discovery_id: alicloud.cloudmonitor.log_group_retention_policy_90_days_enabled
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeLogGroupRetentionPolicy90DaysEnableds
    params: {}
    save_as: log_group_retention_policy_90_days_enabled_list
  emit:
    items_for: '{ log_group_retention_policy_90_days_enabled_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: log_group_retention_policy_90_days_enabled
- discovery_id: alicloud.cloudmonitor.log_metric_filter
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeLogMetricFilters
    params: {}
    save_as: log_metric_filter_list
  emit:
    items_for: '{ log_metric_filter_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: log_metric_filter
- discovery_id: alicloud.cloudmonitor.log_metric_filter_and_alarm_for_actiontrail_config_changes_enabled
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeLogMetricFilterAndAlarmForActiontrailConfigChangesEnableds
    params: {}
    save_as: log_metric_filter_and_alarm_for_actiontrail_config_changes_enabled_list
  emit:
    items_for: '{ log_metric_filter_and_alarm_for_actiontrail_config_changes_enabled_list
      }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: log_metric_filter_and_alarm_for_actiontrail_config_changes_enabled
- discovery_id: alicloud.cloudmonitor.log_metric_filter_and_alarm_for_config_changes_enabled
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeLogMetricFilterAndAlarmForConfigChangesEnableds
    params: {}
    save_as: log_metric_filter_and_alarm_for_config_changes_enabled_list
  emit:
    items_for: '{ log_metric_filter_and_alarm_for_config_changes_enabled_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: log_metric_filter_and_alarm_for_config_changes_enabled
- discovery_id: alicloud.cloudmonitor.log_metric_filter_for_authentication_failures
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeLogMetricFilterForAuthenticationFailuress
    params: {}
    save_as: log_metric_filter_for_authentication_failures_list
  emit:
    items_for: '{ log_metric_filter_for_authentication_failures_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: log_metric_filter_for_authentication_failures
- discovery_id: alicloud.cloudmonitor.log_metric_filter_for_bucket_policy_changes
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeLogMetricFilterForBucketPolicyChangess
    params: {}
    save_as: log_metric_filter_for_bucket_policy_changes_list
  emit:
    items_for: '{ log_metric_filter_for_bucket_policy_changes_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: log_metric_filter_for_bucket_policy_changes
- discovery_id: alicloud.cloudmonitor.log_metric_filter_for_kms_cmk_deletion_or_disablement
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeLogMetricFilterForKmsCmkDeletionOrDisablements
    params: {}
    save_as: log_metric_filter_for_kms_cmk_deletion_or_disablement_list
  emit:
    items_for: '{ log_metric_filter_for_kms_cmk_deletion_or_disablement_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: log_metric_filter_for_kms_cmk_deletion_or_disablement
- discovery_id: alicloud.cloudmonitor.log_metric_filter_for_policy_changes
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeLogMetricFilterForPolicyChangess
    params: {}
    save_as: log_metric_filter_for_policy_changes_list
  emit:
    items_for: '{ log_metric_filter_for_policy_changes_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: log_metric_filter_for_policy_changes
- discovery_id: alicloud.cloudmonitor.log_metric_filter_for_root_account_usage
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeLogMetricFilterForRootAccountUsages
    params: {}
    save_as: log_metric_filter_for_root_account_usage_list
  emit:
    items_for: '{ log_metric_filter_for_root_account_usage_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: log_metric_filter_for_root_account_usage
- discovery_id: alicloud.cloudmonitor.log_metric_filter_for_security_group_changes
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeLogMetricFilterForSecurityGroupChangess
    params: {}
    save_as: log_metric_filter_for_security_group_changes_list
  emit:
    items_for: '{ log_metric_filter_for_security_group_changes_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: log_metric_filter_for_security_group_changes
- discovery_id: alicloud.cloudmonitor.log_metric_filter_for_sign_in_without_mfa
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeLogMetricFilterForSignInWithoutMfas
    params: {}
    save_as: log_metric_filter_for_sign_in_without_mfa_list
  emit:
    items_for: '{ log_metric_filter_for_sign_in_without_mfa_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: log_metric_filter_for_sign_in_without_mfa
- discovery_id: alicloud.cloudmonitor.log_metric_filter_for_unauthorized_api_calls
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeLogMetricFilterForUnauthorizedApiCallss
    params: {}
    save_as: log_metric_filter_for_unauthorized_api_calls_list
  emit:
    items_for: '{ log_metric_filter_for_unauthorized_api_calls_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: log_metric_filter_for_unauthorized_api_calls
- discovery_id: alicloud.cloudmonitor.log_metric_filter_kms_cmk_deletion_or_disablement
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeLogMetricFilterKmsCmkDeletionOrDisablements
    params: {}
    save_as: log_metric_filter_kms_cmk_deletion_or_disablement_list
  emit:
    items_for: '{ log_metric_filter_kms_cmk_deletion_or_disablement_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: log_metric_filter_kms_cmk_deletion_or_disablement
- discovery_id: alicloud.cloudmonitor.log_storage
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeLogStorages
    params: {}
    save_as: log_storage_list
  emit:
    items_for: '{ log_storage_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: log_storage
- discovery_id: alicloud.cloudmonitor.network_acls_change_alarm_configured
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeNetworkAclsChangeAlarmConfigureds
    params: {}
    save_as: network_acls_change_alarm_configured_list
  emit:
    items_for: '{ network_acls_change_alarm_configured_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: network_acls_change_alarm_configured
- discovery_id: alicloud.cloudmonitor.network_gateways_change_alarm_configured
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeNetworkGatewaysChangeAlarmConfigureds
    params: {}
    save_as: network_gateways_change_alarm_configured_list
  emit:
    items_for: '{ network_gateways_change_alarm_configured_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: network_gateways_change_alarm_configured
- discovery_id: alicloud.cloudmonitor.oss_bucket_policy_changes_log_metric_filter_enabled
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeOssBucketPolicyChangesLogMetricFilterEnableds
    params: {}
    save_as: oss_bucket_policy_changes_log_metric_filter_enabled_list
  emit:
    items_for: '{ oss_bucket_policy_changes_log_metric_filter_enabled_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: oss_bucket_policy_changes_log_metric_filter_enabled
- discovery_id: alicloud.cloudmonitor.route_tables_change_alarm_configured
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeRouteTablesChangeAlarmConfigureds
    params: {}
    save_as: route_tables_change_alarm_configured_list
  emit:
    items_for: '{ route_tables_change_alarm_configured_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: route_tables_change_alarm_configured
- discovery_id: alicloud.cloudmonitor.vpcs_change_alarm_configured
  calls:
  - product: CLOUDMONITOR
    version: '2014-05-26'
    action: DescribeVpcsChangeAlarmConfigureds
    params: {}
    save_as: vpcs_change_alarm_configured_list
  emit:
    items_for: '{ vpcs_change_alarm_configured_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: vpcs_change_alarm_configured
checks:
- rule_id: alicloud.cloudmonitor.actiontrail_config_changes_log_metric_filter_and_alarm_enabled.configured
  title: Ensure AliCloud CloudMonitor log metric filter and alarm are configured for
    ActionTrail configuration changes
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.actiontrail_config_changes_log_metric_filter_and_alarm_enabled
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.alarm.cpu_utilization_threshold_set
  title: AliCloud CloudMonitor CPU Utilization Alarm Threshold Configuration
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alarm
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.alarm.memory_utilization_threshold_set
  title: AliCloud CloudMonitor Memory Utilization Alert Threshold Configuration
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alarm
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.alarm.thresholds_configured
  title: Ensure AliCloud CloudMonitor Alarm Thresholds Are Properly Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alarm
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.alert.nsg_creation_update_logged
  title: Ensure AliCloud CloudMonitor Alert is Configured for Network Security Group
    Creation and Updates
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alert
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.alert.nsg_deletion_logged
  title: Ensure AliCloud CloudMonitor Alert is Configured for Network Security Group
    Deletion Events
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alert
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.alert.policy_assignment_creation_logged
  title: Alibaba Cloud CloudMonitor Alert Policy Assignment Creation Must Be Logged
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alert
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.alert.policy_assignment_deletion_logged
  title: Alibaba Cloud CloudMonitor Alert Policy Assignment Deletion Events Must Be
    Logged
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alert
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.alert.public_ip_rule_change_logged
  title: Ensure AliCloud CloudMonitor Alert Rules for Public IP Changes Are Properly
    Logged
  severity: high
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alert
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.alert.public_ip_rule_deletion_logged
  title: Ensure AliCloud CloudMonitor Alert Rules for Public IP Deletion Events Are
    Properly Logged
  severity: high
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alert
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.alert.rds_sqlserver_firewall_rule_change_logged
  title: Ensure ApsaraDB RDS for SQL Server Firewall Rule Changes Are Logged in CloudMonitor
  severity: medium
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alert
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.alert.rds_sqlserver_firewall_rule_deletion_logged
  title: Ensure ApsaraDB RDS for SQL Server Firewall Rule Deletion Events Are Logged
    in CloudMonitor
  severity: medium
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alert
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.alerts.security_solution_creation_update_monitored
  title: AliCloud CloudMonitor Alert for Security Solution Creation and Update Events
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alerts
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.alerts.security_solution_deletion_monitored
  title: AliCloud CloudMonitor Alert for Security Solution Deletion Events
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.alerts
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.config_changes_log_metric_filter_and_alarm_enabled.configured
  title: Ensure AliCloud CloudMonitor has log metric filter and alarm configured for
    configuration changes
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.config_changes_log_metric_filter_and_alarm_enabled
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.diagnostic_settings.categories_appropriately_configured
  title: AliCloud CloudMonitor Diagnostic Settings Categories Should Be Appropriately
    Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.diagnostic_settings
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.diagnostic_settings_presence_verified.configured
  title: Ensure AliCloud CloudMonitor diagnostic settings are properly configured
    for security monitoring
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.diagnostic_settings_presence_verified
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log.metric_filter_and_alarm_for_actiontrail_changes_with_90_day_retention
  title: Ensure AliCloud CloudMonitor Log Service Has Metric Filter And Alarm For
    ActionTrail Changes With 90 Day Retention
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log.metric_filter_and_alert_for_oss_bucket_policy_changes
  title: Ensure CloudMonitor Log Service has metric filter and alert configured for
    Object Storage Service bucket policy changes
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log_group.kms_encryption_at_rest_enabled
  title: Ensure AliCloud CloudMonitor Log Groups Have KMS Encryption At Rest Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_group
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log_group.no_secrets_in_logs_with_access_control
  title: Ensure AliCloud CloudMonitor Log Groups Do Not Contain Secrets and Have Proper
    Access Control
  severity: high
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_group
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log_group.not_publicly_accessible_with_encryption_enabled
  title: Ensure AliCloud CloudMonitor Log Groups Are Not Publicly Accessible and Have
    Encryption Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_group
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log_group.retention_90_days
  title: CloudMonitor Log Groups Should Have Minimum 90-Day Retention Period
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_group
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log_group_kms_cmk_encryption_at_rest_enabled.configured
  title: Ensure CloudMonitor log groups have KMS CMK encryption at rest enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_group_kms_cmk_encryption_at_rest_enabled
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log_group_retention_policy_90_days_enabled.configured
  title: Ensure AliCloud CloudMonitor log group retention policy is configured for
    90 days
  severity: medium
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_group_retention_policy_90_days_enabled
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log_metric_filter.organizations_changes_with_alerting
  title: Ensure AliCloud CloudMonitor Log Metric Filter Monitors Resource Directory
    Organizations Changes with Alerting
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log_metric_filter_and_alarm_for_actiontrail_config_changes_enabled.configured
  title: Ensure AliCloud CloudMonitor log metric filter and alarm for ActionTrail
    configuration changes is enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_and_alarm_for_actiontrail_config_changes_enabled
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log_metric_filter_and_alarm_for_config_changes_enabled.configured
  title: Ensure AliCloud CloudMonitor log metric filter and alarm for configuration
    changes is configured
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_and_alarm_for_config_changes_enabled
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log_metric_filter_for_authentication_failures.configured
  title: Ensure AliCloud CloudMonitor log metric filter for authentication failures
    is configured
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_for_authentication_failures
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log_metric_filter_for_bucket_policy_changes.configured
  title: Ensure AliCloud CloudMonitor log metric filter is configured for Object Storage
    Service bucket policy changes
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_for_bucket_policy_changes
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log_metric_filter_for_kms_cmk_deletion_or_disablement.configured
  title: Ensure AliCloud CloudMonitor log metric filter is configured for Key Management
    Service customer master key deletion or disablement
  severity: medium
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_for_kms_cmk_deletion_or_disablement
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log_metric_filter_for_policy_changes.configured
  title: Ensure AliCloud CloudMonitor log metric filter for policy changes is configured
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_for_policy_changes
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log_metric_filter_for_root_account_usage.configured
  title: Ensure AliCloud CloudMonitor Log Metric Filter is Configured for Root Account
    Usage Detection
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_for_root_account_usage
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log_metric_filter_for_security_group_changes.configured
  title: Ensure AliCloud CloudMonitor log metric filter is configured for security
    group changes
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_for_security_group_changes
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log_metric_filter_for_sign_in_without_mfa.configured
  title: Ensure AliCloud CloudMonitor log metric filter is configured for sign-in
    without MFA
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_for_sign_in_without_mfa
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log_metric_filter_for_unauthorized_api_calls.configured
  title: Ensure AliCloud CloudMonitor log metric filter for unauthorized API calls
    is configured
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_for_unauthorized_api_calls
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log_metric_filter_kms_cmk_deletion_or_disablement.configured
  title: Ensure AliCloud CloudMonitor log metric filter for KMS Customer Master Key
    deletion or disablement is configured
  severity: medium
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_metric_filter_kms_cmk_deletion_or_disablement
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log_storage.activity_logs_cmk_encryption_enabled
  title: Alibaba Cloud CloudMonitor Activity Logs Must Use Customer-Managed Key (CMK)
    Encryption
  severity: high
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_storage
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.log_storage.activity_logs_private_access_enforced
  title: Ensure AliCloud CloudMonitor Activity Logs Enforce Private Access Only
  severity: medium
  assertion_id: ''
  for_each: alicloud.cloudmonitor.log_storage
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.network_acls_change_alarm_configured.configured
  title: Ensure AliCloud CloudMonitor alarm is configured for Network ACL changes
  severity: medium
  assertion_id: ''
  for_each: alicloud.cloudmonitor.network_acls_change_alarm_configured
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.network_gateways_change_alarm_configured.configured
  title: Ensure AliCloud CloudMonitor Network Gateway Change Alarms Are Configured
  severity: medium
  assertion_id: ''
  for_each: alicloud.cloudmonitor.network_gateways_change_alarm_configured
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.oss_bucket_policy_changes_log_metric_filter_enabled.configured
  title: Ensure AliCloud CloudMonitor log metric filter is configured for Object Storage
    Service bucket policy changes
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.oss_bucket_policy_changes_log_metric_filter_enabled
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.route_tables_change_alarm_configured.configured
  title: Ensure AliCloud CloudMonitor Route Table Change Alarms Are Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.cloudmonitor.route_tables_change_alarm_configured
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cloudmonitor.vpcs_change_alarm_configured.configured
  title: Ensure AliCloud CloudMonitor VPC Change Alarm is Configured
  severity: medium
  assertion_id: ''
  for_each: alicloud.cloudmonitor.vpcs_change_alarm_configured
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
