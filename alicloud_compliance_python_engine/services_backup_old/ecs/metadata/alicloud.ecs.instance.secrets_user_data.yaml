rule_id: alicloud.ecs.instance.secrets_user_data
service: ecs
resource: instance
requirement: Secrets User Data
scope: ecs.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: high
title: Elastic Compute Service instances should not contain secrets in user data
rationale: Ensures Elastic Compute Service instance has secrets user data properly
  configured for security compliance. This control is essential for maintaining a
  strong security posture and meeting regulatory requirements.
description: This rule ensures that ECS instance user data does not contain hardcoded
  secrets such as passwords, API keys, or access tokens. Secrets in user data pose
  significant security risks as they are stored in plaintext and can be accessed by
  anyone with instance metadata access permissions. This violates security best practices
  and compliance requirements for data protection.
references:
- https://www.alibabacloud.com/help/ecs/user-guide/user-data
- https://www.alibabacloud.com/help/kms/user-guide/what-is-key-management-service
compliance:
- iso27001_2022_multi_cloud_A.8.20_0076
- iso27001_2022_multi_cloud_A.8.21_0077
- iso27001_2022_multi_cloud_A.8.22_0078
