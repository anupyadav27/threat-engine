rule_id: alicloud.ecs.instance.user_data_secrets_exposure_prevented
service: ecs
resource: instance
requirement: User Data Secrets Exposure Prevented
scope: ecs.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: high
title: Elastic Compute Service Instance User Data Should Not Contain Exposed Secrets
rationale: Ensures Elastic Compute Service instance has user data secrets exposure
  prevented properly configured for security compliance. This control is essential
  for maintaining a strong security posture and meeting regulatory requirements.
description: Ensures that ECS instance user data does not contain hardcoded secrets,
  API keys, passwords, or other sensitive information that could be exposed during
  instance launch or metadata queries. Exposed secrets in user data create significant
  security risks as they can be accessed by unauthorized users and may lead to compliance
  violations under data protection regulations.
references:
- https://www.alibabacloud.com/help/ecs/user-guide/instance-user-data
- https://www.alibabacloud.com/help/kms/user-guide/use-kms-to-encrypt-secrets-in-ecs-user-data
compliance:
- iso27001_2022_multi_cloud_A.8.20_0076
- iso27001_2022_multi_cloud_A.8.21_0077
- iso27001_2022_multi_cloud_A.8.22_0078
- soc2_multi_cloud_cc_6_6_0012
