version: '1.0'
provider: alicloud
service: alb
discovery:
- discovery_id: alicloud.alb.deletion
  calls:
  - product: ALB
    version: '2014-05-26'
    action: DescribeDeletions
    params: {}
    save_as: deletion_list
  emit:
    items_for: '{ deletion_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: deletion
- discovery_id: alicloud.alb.hologres_access_control
  calls:
  - product: ALB
    version: '2014-05-26'
    action: DescribeHologresAccessControls
    params: {}
    save_as: hologres_access_control_list
  emit:
    items_for: '{ hologres_access_control_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: hologres_access_control
- discovery_id: alicloud.alb.hologres_endpoint
  calls:
  - product: ALB
    version: '2014-05-26'
    action: DescribeHologresEndpoints
    params: {}
    save_as: hologres_endpoint_list
  emit:
    items_for: '{ hologres_endpoint_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: hologres_endpoint
- discovery_id: alicloud.alb.hologres_parameter_group
  calls:
  - product: ALB
    version: '2014-05-26'
    action: DescribeHologresParameterGroups
    params: {}
    save_as: hologres_parameter_group_list
  emit:
    items_for: '{ hologres_parameter_group_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: hologres_parameter_group
- discovery_id: alicloud.alb.hologres_snapshots
  calls:
  - product: ALB
    version: '2014-05-26'
    action: DescribeHologresSnapshotss
    params: {}
    save_as: hologres_snapshots_list
  emit:
    items_for: '{ hologres_snapshots_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: hologres_snapshots
- discovery_id: alicloud.alb.insecure
  calls:
  - product: ALB
    version: '2014-05-26'
    action: DescribeInsecures
    params: {}
    save_as: insecure_list
  emit:
    items_for: '{ insecure_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: insecure
- discovery_id: alicloud.alb.internet
  calls:
  - product: ALB
    version: '2014-05-26'
    action: DescribeInternets
    params: {}
    save_as: internet_list
  emit:
    items_for: '{ internet_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: internet
- discovery_id: alicloud.alb.is
  calls:
  - product: ALB
    version: '2014-05-26'
    action: DescribeIss
    params: {}
    save_as: is_list
  emit:
    items_for: '{ is_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: is
- discovery_id: alicloud.alb.listener
  calls:
  - product: ALB
    version: '2014-05-26'
    action: DescribeListeners
    params: {}
    save_as: listener_list
  emit:
    items_for: '{ listener_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: listener
- discovery_id: alicloud.alb.logging
  calls:
  - product: ALB
    version: '2014-05-26'
    action: DescribeLoggings
    params: {}
    save_as: logging_list
  emit:
    items_for: '{ logging_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: logging
- discovery_id: alicloud.alb.network
  calls:
  - product: ALB
    version: '2014-05-26'
    action: DescribeNetworks
    params: {}
    save_as: network_list
  emit:
    items_for: '{ network_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: network
- discovery_id: alicloud.alb.ssl
  calls:
  - product: ALB
    version: '2014-05-26'
    action: DescribeSsls
    params: {}
    save_as: ssl_list
  emit:
    items_for: '{ ssl_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: ssl
- discovery_id: alicloud.alb.target
  calls:
  - product: ALB
    version: '2014-05-26'
    action: DescribeTargets
    params: {}
    save_as: target_list
  emit:
    items_for: '{ target_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: target
- discovery_id: alicloud.alb.target_group
  calls:
  - product: ALB
    version: '2014-05-26'
    action: DescribeTargetGroups
    params: {}
    save_as: target_group_list
  emit:
    items_for: '{ target_group_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: target_group
- discovery_id: alicloud.alb.waf
  calls:
  - product: ALB
    version: '2014-05-26'
    action: DescribeWafs
    params: {}
    save_as: waf_list
  emit:
    items_for: '{ waf_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: waf
checks:
- rule_id: alicloud.alb.deletion.protection
  title: Application Load Balancer Deletion Protection Should Be Enabled
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_CM-2_0042
  for_each: alicloud.alb.deletion
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.hologres_access_control.endpoint_authz_no_anonymous_access
  title: Application Load Balancer Hologres Access Control Should Not Allow Anonymous
    Access to Endpoints
  severity: medium
  assertion_id: ''
  for_each: alicloud.alb.hologres_access_control
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.hologres_access_control.endpoint_authz_rbac_least_privilege
  title: Application Load Balancer Hologres Access Control Should Implement Endpoint
    Authorization RBAC with Least Privilege Principles
  severity: high
  assertion_id: ''
  for_each: alicloud.alb.hologres_access_control
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.hologres_endpoint.endpoint_access_allowed_cidrs_minimized
  title: Application Load Balancer Hologres Endpoint Access CIDR Ranges Should Be
    Minimized
  severity: medium
  assertion_id: ''
  for_each: alicloud.alb.hologres_endpoint
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.hologres_endpoint.endpoint_access_private_only
  title: Application Load Balancer Hologres endpoints should be configured for private
    access only
  severity: medium
  assertion_id: ''
  for_each: alicloud.alb.hologres_endpoint
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.hologres_endpoint.endpoint_access_tls_required
  title: Application Load Balancer Hologres Endpoint Must Require TLS Encryption
  severity: medium
  assertion_id: ''
  for_each: alicloud.alb.hologres_endpoint
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.hologres_parameter_group.parameter_group_require_ssl
  title: Application Load Balancer Hologres Parameter Group Should Require SSL Encryption
  severity: medium
  assertion_id: ''
  for_each: alicloud.alb.hologres_parameter_group
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.hologres_snapshots.snapshot_cross_region_copy_encrypted
  title: Ensure Application Load Balancer Hologres Snapshots Enable Cross-Region Copy
    Encryption
  severity: low
  assertion_id: ''
  for_each: alicloud.alb.hologres_snapshots
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.hologres_snapshots.snapshot_encrypted_at_rest_cmek
  title: Ensure Application Load Balancer Hologres Snapshots Are Encrypted at Rest
    with Customer-Managed Encryption Keys
  severity: low
  assertion_id: ''
  for_each: alicloud.alb.hologres_snapshots
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.hologres_snapshots.snapshot_not_publicly_shared
  title: Ensure Hologres Snapshots Are Not Publicly Shared
  severity: high
  assertion_id: ''
  for_each: alicloud.alb.hologres_snapshots
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.insecure.ssl_ciphers
  title: Application Load Balancer uses insecure SSL cipher suites
  severity: medium
  assertion_id: nist_800_53_rev5_multi_cloud_SC-8_1_1227
  for_each: alicloud.alb.insecure
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.internet.facing
  title: Application Load Balancer Should Not Be Internet-Facing Unless Required
  severity: low
  assertion_id: ''
  for_each: alicloud.alb.internet
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.is.in_multiple_az
  title: Application Load Balancer should be deployed across multiple availability
    zones
  severity: low
  assertion_id: ''
  for_each: alicloud.alb.is
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.listener.cipher_policy_secure
  title: Application Load Balancer listener must use secure cipher policy
  severity: medium
  assertion_id: ''
  for_each: alicloud.alb.listener
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.listener.facing
  title: Application Load Balancer listener should not be internet-facing when handling
    sensitive traffic
  severity: low
  assertion_id: ''
  for_each: alicloud.alb.listener
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.listener.tls_min_1_2
  title: Application Load Balancer listeners should enforce TLS version 1.2 or higher
  severity: medium
  assertion_id: ''
  for_each: alicloud.alb.listener
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.logging.enabled
  title: Application Load Balancer Access Logging Should Be Enabled
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.alb.logging
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.network.lb_access_logs_enabled
  title: Application Load Balancer Access Logs Should Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.alb.network
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.network.lb_listener_tls_min_1_2
  title: Application Load Balancer listener should enforce minimum TLS version 1.2
  severity: medium
  assertion_id: ''
  for_each: alicloud.alb.network
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.network.lb_valid_certificate_attached
  title: Application Load Balancer Must Have Valid SSL/TLS Certificate Attached
  severity: medium
  assertion_id: ''
  for_each: alicloud.alb.network
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.ssl.listeners
  title: Application Load Balancer SSL listeners should be properly configured with
    secure protocols
  severity: medium
  assertion_id: gdpr_multi_cloud_Article_32_Security_of_processing_0003
  for_each: alicloud.alb.ssl
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.target.group_health_check_enabled
  title: Application Load Balancer Target Group Health Check Must Be Enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.alb.target
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.target_group.tg_targets_in_private_subnets
  title: Application Load Balancer Target Group Targets Should Be Deployed in Private
    Subnets
  severity: medium
  assertion_id: ''
  for_each: alicloud.alb.target_group
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.alb.waf.acl_attached
  title: Application Load Balancer Web Application Firewall ACL Attachment
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.8.20_0076
  for_each: alicloud.alb.waf
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
