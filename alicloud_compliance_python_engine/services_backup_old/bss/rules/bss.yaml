version: '1.0'
provider: alicloud
service: bss
discovery:
- discovery_id: alicloud.bss.categories
  calls:
  - product: BSS
    version: '2014-05-26'
    action: DescribeCategoriess
    params: {}
    save_as: categories_list
  emit:
    items_for: '{ categories_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: categories
- discovery_id: alicloud.bss.cost
  calls:
  - product: BSS
    version: '2014-05-26'
    action: DescribeCosts
    params: {}
    save_as: cost_list
  emit:
    items_for: '{ cost_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: cost
- discovery_id: alicloud.bss.document
  calls:
  - product: BSS
    version: '2014-05-26'
    action: DescribeDocuments
    params: {}
    save_as: document_list
  emit:
    items_for: '{ document_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: document
- discovery_id: alicloud.bss.documents
  calls:
  - product: BSS
    version: '2014-05-26'
    action: DescribeDocumentss
    params: {}
    save_as: documents_list
  emit:
    items_for: '{ documents_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: documents
- discovery_id: alicloud.bss.ecs
  calls:
  - product: BSS
    version: '2014-05-26'
    action: DescribeEcss
    params: {}
    save_as: ecs_list
  emit:
    items_for: '{ ecs_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: ecs
- discovery_id: alicloud.bss.encryption_at_rest_enabled
  calls:
  - product: BSS
    version: '2014-05-26'
    action: DescribeEncryptionAtRestEnableds
    params: {}
    save_as: encryption_at_rest_enabled_list
  emit:
    items_for: '{ encryption_at_rest_enabled_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: encryption_at_rest_enabled
- discovery_id: alicloud.bss.instances
  calls:
  - product: BSS
    version: '2014-05-26'
    action: DescribeInstancess
    params: {}
    save_as: instances_list
  emit:
    items_for: '{ instances_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: instances
- discovery_id: alicloud.bss.managed
  calls:
  - product: BSS
    version: '2014-05-26'
    action: DescribeManageds
    params: {}
    save_as: managed_list
  emit:
    items_for: '{ managed_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: managed
- discovery_id: alicloud.bss.plans
  calls:
  - product: BSS
    version: '2014-05-26'
    action: DescribePlanss
    params: {}
    save_as: plans_list
  emit:
    items_for: '{ plans_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: plans
- discovery_id: alicloud.bss.plans_configured_and_active
  calls:
  - product: BSS
    version: '2014-05-26'
    action: DescribePlansConfiguredAndActives
    params: {}
    save_as: plans_configured_and_active_list
  emit:
    items_for: '{ plans_configured_and_active_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: plans_configured_and_active
- discovery_id: alicloud.bss.queues
  calls:
  - product: BSS
    version: '2014-05-26'
    action: DescribeQueuess
    params: {}
    save_as: queues_list
  emit:
    items_for: '{ queues_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: queues
- discovery_id: alicloud.bss.recovery_point
  calls:
  - product: BSS
    version: '2014-05-26'
    action: DescribeRecoveryPoints
    params: {}
    save_as: recovery_point_list
  emit:
    items_for: '{ recovery_point_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: recovery_point
- discovery_id: alicloud.bss.recovery_point_encryption_at_rest_enabled
  calls:
  - product: BSS
    version: '2014-05-26'
    action: DescribeRecoveryPointEncryptionAtRestEnableds
    params: {}
    save_as: recovery_point_encryption_at_rest_enabled_list
  emit:
    items_for: '{ recovery_point_encryption_at_rest_enabled_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: recovery_point_encryption_at_rest_enabled
- discovery_id: alicloud.bss.reportplans_configured_and_active
  calls:
  - product: BSS
    version: '2014-05-26'
    action: DescribeReportplansConfiguredAndActives
    params: {}
    save_as: reportplans_configured_and_active_list
  emit:
    items_for: '{ reportplans_configured_and_active_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: reportplans_configured_and_active
- discovery_id: alicloud.bss.snapshot
  calls:
  - product: BSS
    version: '2014-05-26'
    action: DescribeSnapshots
    params: {}
    save_as: snapshot_list
  emit:
    items_for: '{ snapshot_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: snapshot
- discovery_id: alicloud.bss.tls_via_cas_kms
  calls:
  - product: BSS
    version: '2014-05-26'
    action: DescribeTlsViaCasKmss
    params: {}
    save_as: tls_via_cas_kms_list
  emit:
    items_for: '{ tls_via_cas_kms_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: tls_via_cas_kms
- discovery_id: alicloud.bss.topics
  calls:
  - product: BSS
    version: '2014-05-26'
    action: DescribeTopicss
    params: {}
    save_as: topics_list
  emit:
    items_for: '{ topics_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: topics
- discovery_id: alicloud.bss.vault
  calls:
  - product: BSS
    version: '2014-05-26'
    action: DescribeVaults
    params: {}
    save_as: vault_list
  emit:
    items_for: '{ vault_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: vault
- discovery_id: alicloud.bss.vaults
  calls:
  - product: BSS
    version: '2014-05-26'
    action: DescribeVaultss
    params: {}
    save_as: vaults_list
  emit:
    items_for: '{ vaults_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: vaults
- discovery_id: alicloud.bss.vaults_configured_and_access_controlled
  calls:
  - product: BSS
    version: '2014-05-26'
    action: DescribeVaultsConfiguredAndAccessControlleds
    params: {}
    save_as: vaults_configured_and_access_controlled_list
  emit:
    items_for: '{ vaults_configured_and_access_controlled_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: vaults_configured_and_access_controlled
- discovery_id: alicloud.bss.volume
  calls:
  - product: BSS
    version: '2014-05-26'
    action: DescribeVolumes
    params: {}
    save_as: volume_list
  emit:
    items_for: '{ volume_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: volume
checks:
- rule_id: alicloud.bss.categories.access_billing_admins_mfa_required
  title: AliCloud Business Support System Billing Administrators Must Enable Multi-Factor
    Authentication
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.categories
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.categories.access_billing_console_rbac_least_privilege
  title: Billing Service Console Access Should Follow RBAC Least Privilege Principles
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.categories
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.categories.access_cost_data_exports_private_and_encrypted
  title: Ensure AliCloud Business Support System Cost Data Exports Are Private and
    Encrypted
  severity: medium
  assertion_id: ''
  for_each: alicloud.bss.categories
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.categories.access_cost_export_destinations_least_privilege
  title: AliCloud Business Support System Cost Export Destinations Should Follow Least
    Privilege Access Principles
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.categories
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.cost.budget_modify_permissions_restricted
  title: AliCloud Business Support System Budget Modification Permissions Should Be
    Restricted
  severity: low
  assertion_id: ''
  for_each: alicloud.bss.cost
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.document.secrets
  title: Billing Settlement System documents should not contain embedded secrets or
    sensitive credentials
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.document
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.documents.set_as_public
  title: Ensure Business Support System (BSS) Documents Are Not Set As Public
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.documents
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.ecs.regular_backups_configured
  title: Ensure Elastic Compute Service instances have regular backup snapshots configured
  severity: medium
  assertion_id: ''
  for_each: alicloud.bss.ecs
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.encryption_at_rest_enabled.configured
  title: AliCloud Business Support System (BSS) Encryption at Rest Should Be Configured
  severity: medium
  assertion_id: ''
  for_each: alicloud.bss.encryption_at_rest_enabled
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.instances.reservation_billing_admins_mfa_required
  title: Business Support System Reservation Billing Administrators Must Enable Multi-Factor
    Authentication
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.instances
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.instances.reservation_purchase_permissions_restricted
  title: Billing Service System Reservation Purchase Permissions Should Be Restricted
  severity: low
  assertion_id: ''
  for_each: alicloud.bss.instances
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.managed.compliant_patching
  title: AliCloud Business Support Service Managed Resources Must Maintain Compliant
    Patching
  severity: medium
  assertion_id: ''
  for_each: alicloud.bss.managed
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.plans.properly_configured
  title: Ensure AliCloud Business Support Service Plans Are Properly Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.bss.plans
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.plans.retention_90_days_minimum
  title: Business Support System (BSS) Plans Must Have Minimum 90-Day Data Retention
    Period
  severity: low
  assertion_id: ''
  for_each: alicloud.bss.plans
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.plans.savings_plan_billing_admins_mfa_required
  title: Business Support System Savings Plan Billing Administrators Must Have Multi-Factor
    Authentication Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.plans
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.plans_configured_and_active.configured
  title: Ensure Business Support Service (BSS) billing plans are properly configured
    and active
  severity: low
  assertion_id: ''
  for_each: alicloud.bss.plans_configured_and_active
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.queues.not_publicly_accessible
  title: Ensure AliCloud Message Queue for Apache RocketMQ queues are not publicly
    accessible
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.queues
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.queues.server_side_encryption_enabled
  title: AliCloud Message Service Queues Should Have Server-Side Encryption Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.queues
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.recovery_point.encryption_at_rest_enabled
  title: AliCloud Hybrid Backup Recovery Point Encryption At Rest Should Be Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.recovery_point
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.recovery_point.retention_90_days_minimum
  title: Business Support System Recovery Points Must Maintain Minimum 90-Day Retention
    Period
  severity: low
  assertion_id: ''
  for_each: alicloud.bss.recovery_point
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.recovery_point_encryption_at_rest_enabled.configured
  title: Ensure AliCloud Hybrid Backup Recovery (HBR) recovery points have encryption
    at rest enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.bss.recovery_point_encryption_at_rest_enabled
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.reportplans_configured_and_active.configured
  title: Ensure AliCloud Business Support Service (BSS) report plans are properly
    configured and active
  severity: low
  assertion_id: ''
  for_each: alicloud.bss.reportplans_configured_and_active
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.snapshot.encryption
  title: Elastic Compute Service snapshots must be encrypted at rest
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.snapshot
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.tls_via_cas_kms.encryption_mtls_required_for_internal_services_where_supported
  title: Ensure Mutual TLS Encryption is Required for Internal Business Support System
    Services Where Supported
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.tls_via_cas_kms
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.tls_via_cas_kms.encryption_tls_min_1_2_enforced
  title: Business Support System TLS certificates via Certificate Authority Service
    and Key Management Service must enforce minimum TLS 1.2 encryption
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.tls_via_cas_kms
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.topics.kms_encryption_at_rest_enabled
  title: Ensure AliCloud Message Service Topics Have KMS Encryption At Rest Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.topics
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.topics.not_publicly_accessible
  title: Ensure AliCloud Business Support System Topics Are Not Publicly Accessible
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.topics
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.vault.encryption_at_rest_enabled
  title: Alibaba Cloud Hybrid Backup Recovery Vault Encryption At Rest Should Be Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.vault
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.vaults.encryption_at_rest_enabled
  title: Hybrid Backup Recovery (HBR) vaults must have encryption at rest enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.bss.vaults
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.vaults_configured_and_access_controlled.configured
  title: Ensure Hybrid Backup Recovery vaults are properly configured with appropriate
    access controls
  severity: medium
  assertion_id: ''
  for_each: alicloud.bss.vaults_configured_and_access_controlled
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.bss.volume.backup_configured
  title: Billing Settlement Service Volume Backup Configuration Check
  severity: medium
  assertion_id: ''
  for_each: alicloud.bss.volume
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
