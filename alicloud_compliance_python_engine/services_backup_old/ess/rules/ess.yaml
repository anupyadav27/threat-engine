version: '1.0'
provider: alicloud
service: ess
discovery:
- discovery_id: alicloud.ess.group
  calls:
  - product: ESS
    version: '2014-05-26'
    action: DescribeGroups
    params: {}
    save_as: group_list
  emit:
    items_for: '{ group_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: group
checks:
- rule_id: alicloud.ess.group.capacity_rebalance_enforced
  title: Auto Scaling Group Should Have Capacity Rebalance Enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.ess.group
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ess.group.health_check_configured
  title: Auto Scaling Group Health Check Must Be Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.ess.group
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ess.group.multi_az_deployment
  title: Auto Scaling Groups Should Be Deployed Across Multiple Availability Zones
  severity: low
  assertion_id: ''
  for_each: alicloud.ess.group
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.ess.group.properly_configured
  title: Auto Scaling Group Should Be Properly Configured with Security Best Practices
  severity: low
  assertion_id: ''
  for_each: alicloud.ess.group
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
