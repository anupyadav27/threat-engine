version: '1.0'
provider: alicloud
service: actiontrail
discovery:
- discovery_id: alicloud.actiontrail.cloudmonitor
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeCloudmonitors
    params: {}
    save_as: cloudmonitor_list
  emit:
    items_for: '{ cloudmonitor_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: cloudmonitor
- discovery_id: alicloud.actiontrail.cloudwatch
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeCloudwatchs
    params: {}
    save_as: cloudwatch_list
  emit:
    items_for: '{ cloudwatch_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: cloudwatch
- discovery_id: alicloud.actiontrail.configuration
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeConfigurations
    params: {}
    save_as: configuration_list
  emit:
    items_for: '{ configuration_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: configuration
- discovery_id: alicloud.actiontrail.data_events_read_logging_enabled
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeDataEventsReadLoggingEnableds
    params: {}
    save_as: data_events_read_logging_enabled_list
  emit:
    items_for: '{ data_events_read_logging_enabled_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: data_events_read_logging_enabled
- discovery_id: alicloud.actiontrail.delivery
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeDeliverys
    params: {}
    save_as: delivery_list
  emit:
    items_for: '{ delivery_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: delivery
- discovery_id: alicloud.actiontrail.enabled
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeEnableds
    params: {}
    save_as: enabled_list
  emit:
    items_for: '{ enabled_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: enabled
- discovery_id: alicloud.actiontrail.failed_console_signin_alerts
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeFailedConsoleSigninAlertss
    params: {}
    save_as: failed_console_signin_alerts_list
  emit:
    items_for: '{ failed_console_signin_alerts_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: failed_console_signin_alerts
- discovery_id: alicloud.actiontrail.kms
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeKmss
    params: {}
    save_as: kms_list
  emit:
    items_for: '{ kms_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: kms
- discovery_id: alicloud.actiontrail.kms_encryption_active
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeKmsEncryptionActives
    params: {}
    save_as: kms_encryption_active_list
  emit:
    items_for: '{ kms_encryption_active_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: kms_encryption_active
- discovery_id: alicloud.actiontrail.log_file_integrity_validation_enabled
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeLogFileIntegrityValidationEnableds
    params: {}
    save_as: log_file_integrity_validation_enabled_list
  emit:
    items_for: '{ log_file_integrity_validation_enabled_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: log_file_integrity_validation_enabled
- discovery_id: alicloud.actiontrail.logging
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeLoggings
    params: {}
    save_as: logging_list
  emit:
    items_for: '{ logging_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: logging
- discovery_id: alicloud.actiontrail.logging_all_regions_properly_configured
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeLoggingAllRegionsProperlyConfigureds
    params: {}
    save_as: logging_all_regions_properly_configured_list
  emit:
    items_for: '{ logging_all_regions_properly_configured_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: logging_all_regions_properly_configured
- discovery_id: alicloud.actiontrail.logging_enabled_90_day_retention
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeLoggingEnabled90DayRetentions
    params: {}
    save_as: logging_enabled_90_day_retention_list
  emit:
    items_for: '{ logging_enabled_90_day_retention_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: logging_enabled_90_day_retention
- discovery_id: alicloud.actiontrail.logging_enabled_with_90_day_retention
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeLoggingEnabledWith90DayRetentions
    params: {}
    save_as: logging_enabled_with_90_day_retention_list
  emit:
    items_for: '{ logging_enabled_with_90_day_retention_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: logging_enabled_with_90_day_retention
- discovery_id: alicloud.actiontrail.logs
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeLogss
    params: {}
    save_as: logs_list
  emit:
    items_for: '{ logs_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: logs
- discovery_id: alicloud.actiontrail.logservice
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeLogservices
    params: {}
    save_as: logservice_list
  emit:
    items_for: '{ logservice_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: logservice
- discovery_id: alicloud.actiontrail.mfa_signin_alerts
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeMfaSigninAlertss
    params: {}
    save_as: mfa_signin_alerts_list
  emit:
    items_for: '{ mfa_signin_alerts_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: mfa_signin_alerts
- discovery_id: alicloud.actiontrail.multi
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeMultis
    params: {}
    save_as: multi_list
  emit:
    items_for: '{ multi_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: multi
- discovery_id: alicloud.actiontrail.multi_region_logging_enabled
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeMultiRegionLoggingEnableds
    params: {}
    save_as: multi_region_logging_enabled_list
  emit:
    items_for: '{ multi_region_logging_enabled_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: multi_region_logging_enabled
- discovery_id: alicloud.actiontrail.oss
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeOsss
    params: {}
    save_as: oss_list
  emit:
    items_for: '{ oss_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: oss
- discovery_id: alicloud.actiontrail.oss_bucket_access_logging_enabled
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeOssBucketAccessLoggingEnableds
    params: {}
    save_as: oss_bucket_access_logging_enabled_list
  emit:
    items_for: '{ oss_bucket_access_logging_enabled_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: oss_bucket_access_logging_enabled
- discovery_id: alicloud.actiontrail.oss_bucket_public_access_blocked
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeOssBucketPublicAccessBlockeds
    params: {}
    save_as: oss_bucket_public_access_blocked_list
  emit:
    items_for: '{ oss_bucket_public_access_blocked_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: oss_bucket_public_access_blocked
- discovery_id: alicloud.actiontrail.oss_bucket_public_access_blocked_via_acl
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeOssBucketPublicAccessBlockedViaAcls
    params: {}
    save_as: oss_bucket_public_access_blocked_via_acl_list
  emit:
    items_for: '{ oss_bucket_public_access_blocked_via_acl_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: oss_bucket_public_access_blocked_via_acl
- discovery_id: alicloud.actiontrail.oss_read_events_logging_enabled
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeOssReadEventsLoggingEnableds
    params: {}
    save_as: oss_read_events_logging_enabled_list
  emit:
    items_for: '{ oss_read_events_logging_enabled_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: oss_read_events_logging_enabled
- discovery_id: alicloud.actiontrail.oss_write_events_logging_enabled
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeOssWriteEventsLoggingEnableds
    params: {}
    save_as: oss_write_events_logging_enabled_list
  emit:
    items_for: '{ oss_write_events_logging_enabled_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: oss_write_events_logging_enabled
- discovery_id: alicloud.actiontrail.privacy
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribePrivacys
    params: {}
    save_as: privacy_list
  emit:
    items_for: '{ privacy_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: privacy
- discovery_id: alicloud.actiontrail.s3
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeS3s
    params: {}
    save_as: s3_list
  emit:
    items_for: '{ s3_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: s3
- discovery_id: alicloud.actiontrail.threat
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeThreats
    params: {}
    save_as: threat_list
  emit:
    items_for: '{ threat_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: threat
- discovery_id: alicloud.actiontrail.threat_detection
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeThreatDetections
    params: {}
    save_as: threat_detection_list
  emit:
    items_for: '{ threat_detection_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: threat_detection
- discovery_id: alicloud.actiontrail.trail
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeTrails
    params: {}
    save_as: trail_list
  emit:
    items_for: '{ trail_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: trail
- discovery_id: alicloud.actiontrail.vpc
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeVpcs
    params: {}
    save_as: vpc_list
  emit:
    items_for: '{ vpc_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: vpc
- discovery_id: alicloud.actiontrail.vpc_change_alerts
  calls:
  - product: ACTIONTRAIL
    version: '2014-05-26'
    action: DescribeVpcChangeAlertss
    params: {}
    save_as: vpc_change_alerts_list
  emit:
    items_for: '{ vpc_change_alerts_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: vpc_change_alerts
checks:
- rule_id: alicloud.actiontrail.cloudmonitor.logging_enabled_with_90_day_retention
  title: Ensure AliCloud ActionTrail CloudMonitor logging is enabled with 90-day retention
    period
  severity: medium
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.cloudmonitor
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.cloudwatch.logging_enabled
  title: Ensure ActionTrail CloudWatch Logging is Enabled
  severity: medium
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.cloudwatch
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.configuration.config_delivery_destination_access_least_privilege
  title: Ensure ActionTrail Configuration Delivery Destination Access Follows Least
    Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.actiontrail.configuration
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.configuration.config_delivery_kms_encryption_enabled
  title: Ensure AliCloud ActionTrail Configuration Delivery Channel Has KMS Encryption
    Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.actiontrail.configuration
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.data_events_read_logging_enabled.configured
  title: Ensure AliCloud ActionTrail data events read logging is configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.data_events_read_logging_enabled
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.delivery.channel_destination_access_least_privilege
  title: AliCloud ActionTrail Delivery Channel Destination Access Should Follow Least
    Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.actiontrail.delivery
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.delivery.channel_kms_encryption_enabled
  title: Ensure AliCloud ActionTrail Delivery Channel Has KMS Encryption Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.actiontrail.delivery
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.enabled.configured
  title: Ensure AliCloud ActionTrail is Enabled and Properly Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.enabled
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.failed_console_signin_alerts.configured
  title: Ensure AliCloud ActionTrail Failed Console Sign-in Alerts Are Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.failed_console_signin_alerts
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.kms.encryption_enabled
  title: Ensure ActionTrail trails have KMS encryption enabled
  severity: high
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_CM-6_0046
  for_each: alicloud.actiontrail.kms
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.kms_encryption_active.configured
  title: Ensure AliCloud ActionTrail KMS encryption is configured and active
  severity: medium
  assertion_id: ''
  for_each: alicloud.actiontrail.kms_encryption_active
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.log_file_integrity_validation_enabled.configured
  title: Ensure AliCloud ActionTrail log file integrity validation is enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.log_file_integrity_validation_enabled
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.logging.all_regions_enabled
  title: Ensure Alibaba Cloud ActionTrail logging is enabled across all regions
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.logging
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.logging.enabled
  title: Ensure AliCloud ActionTrail logging is enabled for audit trail monitoring
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.logging
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.logging.multi_region_enabled_management_events_with_90_day_retention
  title: Ensure Alibaba Cloud ActionTrail has multi-region logging enabled for management
    events with 90-day retention
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.logging
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.logging_all_regions_properly_configured.configured
  title: Ensure ActionTrail logging is properly configured across all regions
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.logging_all_regions_properly_configured
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.logging_enabled_90_day_retention.configured
  title: Ensure AliCloud ActionTrail logging is enabled with 90-day retention period
    configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.logging_enabled_90_day_retention
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.logging_enabled_with_90_day_retention.configured
  title: Ensure AliCloud ActionTrail logging is enabled with 90-day retention period
    configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.logging_enabled_with_90_day_retention
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.logs.file_validation_enabled
  title: Ensure AliCloud ActionTrail Log File Validation is Enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.logs
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.logs.kms_encryption_at_rest_enabled
  title: Ensure ActionTrail Logs Have KMS Encryption At Rest Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.actiontrail.logs
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.logs.monitor_mfa_signin_alert
  title: Monitor Multi-Factor Authentication Sign-in Events in AliCloud ActionTrail
    Logs
  severity: high
  assertion_id: ''
  for_each: alicloud.actiontrail.logs
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.logs.oss_bucket_access_logging_enabled
  title: Ensure ActionTrail Object Storage Service Bucket Access Logging is Enabled
  severity: medium
  assertion_id: gdpr_multi_cloud_Article_25_Data_protection_by_design_and_by_defaul_0001
  for_each: alicloud.actiontrail.logs
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.logs.oss_bucket_is_not_publicly_accessible
  title: Ensure ActionTrail Logs Object Storage Service Bucket Is Not Publicly Accessible
  severity: high
  assertion_id: ''
  for_each: alicloud.actiontrail.logs
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.logs.s3_bucket_access_logging_enabled
  title: Ensure ActionTrail logs have Object Storage Service bucket access logging
    enabled
  severity: medium
  assertion_id: gdpr_multi_cloud_Article_25_Data_protection_by_design_and_by_defaul_0001
  for_each: alicloud.actiontrail.logs
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.logs.s3_bucket_is_not_publicly_accessible
  title: Ensure ActionTrail Log Storage S3 Bucket Is Not Publicly Accessible
  severity: high
  assertion_id: gdpr_multi_cloud_Article_25_Data_protection_by_design_and_by_defaul_0001
  for_each: alicloud.actiontrail.logs
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.logservice.failed_console_signin_alerts
  title: AliCloud ActionTrail Log Service Failed Console Sign-in Alerts Configuration
  severity: low
  assertion_id: cis_alicloud_alicloud_2.19_0153
  for_each: alicloud.actiontrail.logservice
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.mfa_signin_alerts.configured
  title: Ensure AliCloud ActionTrail MFA Sign-in Alerts are Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.mfa_signin_alerts
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.multi.region_enabled
  title: Ensure Alibaba Cloud ActionTrail Multi-Region Trail is Enabled
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.multi
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.multi.region_enabled_logging_management_events
  title: Alibaba Cloud ActionTrail Multi-Region Management Events Logging Must Be
    Enabled
  severity: medium
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.multi
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.multi_region_logging_enabled.configured
  title: Ensure AliCloud ActionTrail Multi-Region Logging is Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.multi_region_logging_enabled
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.oss.dataevents_read_enabled
  title: Ensure ActionTrail Object Storage Service Data Events Read Logging is Enabled
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.oss
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.oss.dataevents_read_logging_enabled
  title: Ensure ActionTrail Data Events Read Logging is Enabled for Object Storage
    Service Buckets
  severity: medium
  assertion_id: ''
  for_each: alicloud.actiontrail.oss
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.oss.dataevents_write_enabled
  title: Ensure ActionTrail Object Storage Service data events write operations are
    enabled
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.oss
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.oss.dataevents_write_logging_enabled
  title: Ensure ActionTrail Data Events Write Logging is Enabled for Object Storage
    Service Buckets
  severity: medium
  assertion_id: ''
  for_each: alicloud.actiontrail.oss
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.oss.read_events_enabled
  title: Ensure ActionTrail Read Events are Enabled for Object Storage Service
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.oss
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.oss.write_events_enabled
  title: Ensure ActionTrail Write Events are Enabled for Object Storage Service (OSS)
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.oss
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.oss_bucket_access_logging_enabled.configured
  title: Ensure ActionTrail Object Storage Service bucket access logging is configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.oss_bucket_access_logging_enabled
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.oss_bucket_public_access_blocked.configured
  title: AliCloud ActionTrail OSS Bucket Public Access Blocking Must Be Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.oss_bucket_public_access_blocked
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.oss_bucket_public_access_blocked_via_acl.configured
  title: ActionTrail should monitor Object Storage Service bucket public access blocked
    via ACL configuration
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.oss_bucket_public_access_blocked_via_acl
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.oss_read_events_logging_enabled.configured
  title: Ensure AliCloud ActionTrail OSS read events logging is configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.oss_read_events_logging_enabled
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.oss_write_events_logging_enabled.configured
  title: Ensure AliCloud ActionTrail OSS Write Events Logging is Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.oss_write_events_logging_enabled
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.privacy.audit_logs_centralized_and_encrypted
  title: Ensure AliCloud ActionTrail audit logs are centralized and encrypted for
    security compliance
  severity: medium
  assertion_id: ''
  for_each: alicloud.actiontrail.privacy
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.s3.dataevents_read_enabled
  title: Ensure ActionTrail S3 data events read logging is enabled
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.s3
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.s3.dataevents_write_enabled
  title: Ensure AliCloud ActionTrail has S3 data events write logging enabled
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.actiontrail.s3
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.threat.detection_enumeration
  title: AliCloud ActionTrail Threat Detection Enumeration Monitoring
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.5.7_0039
  for_each: alicloud.actiontrail.threat
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.threat.detection_privilege_escalation
  title: AliCloud ActionTrail Privilege Escalation Threat Detection
  severity: high
  assertion_id: iso27001_2022_multi_cloud_A.5.7_0039
  for_each: alicloud.actiontrail.threat
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.threat.llm_jacking
  title: Alibaba Cloud ActionTrail LLM Jacking Threat Detection
  severity: low
  assertion_id: iso27001_2022_multi_cloud_A.5.7_0039
  for_each: alicloud.actiontrail.threat
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.threat_detection.enumeration_detected
  title: AliCloud ActionTrail Threat Detection - Enumeration Activity Detected
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.threat_detection
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.threat_detection.llm_jacking_detected
  title: AliCloud ActionTrail LLM Jacking Attack Detection
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.threat_detection
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.threat_detection.privilege_escalation_detected
  title: Alibaba Cloud ActionTrail Privilege Escalation Detection Alert
  severity: high
  assertion_id: ''
  for_each: alicloud.actiontrail.threat_detection
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.trail.logging_enabled
  title: Ensure AliCloud ActionTrail Trail Logging is Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.actiontrail.trail
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.vpc.change_monitoring
  title: Ensure ActionTrail monitors Virtual Private Cloud (VPC) configuration changes
  severity: medium
  assertion_id: cis_alicloud_alicloud_2.13_0147
  for_each: alicloud.actiontrail.vpc
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.actiontrail.vpc_change_alerts.configured
  title: Ensure ActionTrail VPC Change Alerts Are Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.actiontrail.vpc_change_alerts
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
