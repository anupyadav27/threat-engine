version: '1.0'
provider: alicloud
service: flink
discovery:
- discovery_id: alicloud.flink.compute_for_apache_flink
  calls:
  - product: FLINK
    version: '2014-05-26'
    action: DescribeComputeForApacheFlinks
    params: {}
    save_as: compute_for_apache_flink_list
  emit:
    items_for: '{ compute_for_apache_flink_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: compute_for_apache_flink
checks:
- rule_id: alicloud.flink.compute_for_apache_flink.analytics_checkpoints_and_outputs_encrypted
  title: Ensure Realtime Compute for Apache Flink Analytics Checkpoints and Outputs
    Are Encrypted
  severity: low
  assertion_id: ''
  for_each: alicloud.flink.compute_for_apache_flink
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.flink.compute_for_apache_flink.analytics_network_private_only
  title: Ensure Realtime Compute for Apache Flink Analytics Network is Private Only
  severity: medium
  assertion_id: ''
  for_each: alicloud.flink.compute_for_apache_flink
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.flink.compute_for_apache_flink.analytics_role_least_privilege
  title: Ensure Realtime Compute for Apache Flink Analytics Roles Follow Least Privilege
    Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.flink.compute_for_apache_flink
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
