version: '1.0'
provider: alicloud
service: cdn
discovery:
- discovery_id: alicloud.cdn.cache_policy
  calls:
  - product: CDN
    version: '2014-05-26'
    action: DescribeCachePolicys
    params: {}
    save_as: cache_policy_list
  emit:
    items_for: '{ cache_policy_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: cache_policy
- discovery_id: alicloud.cdn.cloudfront
  calls:
  - product: CDN
    version: '2014-05-26'
    action: DescribeCloudfronts
    params: {}
    save_as: cloudfront_list
  emit:
    items_for: '{ cloudfront_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: cloudfront
- discovery_id: alicloud.cdn.dcdn
  calls:
  - product: CDN
    version: '2014-05-26'
    action: DescribeDcdns
    params: {}
    save_as: dcdn_list
  emit:
    items_for: '{ dcdn_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: dcdn
- discovery_id: alicloud.cdn.distribution
  calls:
  - product: CDN
    version: '2014-05-26'
    action: DescribeDistributions
    params: {}
    save_as: distribution_list
  emit:
    items_for: '{ distribution_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: distribution
- discovery_id: alicloud.cdn.domain
  calls:
  - product: CDN
    version: '2014-05-26'
    action: DescribeDomains
    params: {}
    save_as: domain_list
  emit:
    items_for: '{ domain_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: domain
- discovery_id: alicloud.cdn.edge
  calls:
  - product: CDN
    version: '2014-05-26'
    action: DescribeEdges
    params: {}
    save_as: edge_list
  emit:
    items_for: '{ edge_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: edge
- discovery_id: alicloud.cdn.origin
  calls:
  - product: CDN
    version: '2014-05-26'
    action: DescribeOrigins
    params: {}
    save_as: origin_list
  emit:
    items_for: '{ origin_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: origin
checks:
- rule_id: alicloud.cdn.cache_policy.no_sensitive_headers_cached
  title: AliCloud Content Delivery Network Cache Policy Should Not Cache Sensitive
    Headers
  severity: medium
  assertion_id: ''
  for_each: alicloud.cdn.cache_policy
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.cloudfront.https_enforced
  title: Alibaba Cloud Content Delivery Network Domain Must Enforce HTTPS Protocol
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_SC-8_0133
  for_each: alicloud.cdn.cloudfront
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.dcdn.cdn_access_logging_enabled
  title: AliCloud Dynamic Route for Content Delivery Network (DCDN) Access Logging
    Should Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.cdn.dcdn
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.dcdn.cdn_cache_key_excludes_sensitive_headers
  title: AliCloud Dynamic Route for Content Delivery Network Cache Key Should Exclude
    Sensitive Headers
  severity: high
  assertion_id: ''
  for_each: alicloud.cdn.dcdn
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.dcdn.cdn_hsts_enabled
  title: Ensure AliCloud Dynamic Route for Content Delivery Network (DCDN) has HTTP
    Strict Transport Security (HSTS) enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.cdn.dcdn
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.dcdn.cdn_https_only_viewer_protocol
  title: AliCloud Dynamic Content Delivery Network (DCDN) Should Enforce HTTPS-Only
    Viewer Protocol
  severity: low
  assertion_id: ''
  for_each: alicloud.cdn.dcdn
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.dcdn.cdn_origin_access_restricted
  title: AliCloud Dynamic Route for Content Delivery Network (DCDN) Origin Access
    Should Be Restricted
  severity: medium
  assertion_id: ''
  for_each: alicloud.cdn.dcdn
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.dcdn.cdn_signed_urls_or_headers_required_for_private_content
  title: AliCloud Dynamic Content Delivery Network (DCDN) Should Require Signed URLs
    or Headers for Private Content Access
  severity: medium
  assertion_id: ''
  for_each: alicloud.cdn.dcdn
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.dcdn.cdn_tls_min_1_2_enforced
  title: Alibaba Cloud Dynamic Route for CDN (DCDN) Should Enforce TLS Version 1.2
    or Higher
  severity: medium
  assertion_id: ''
  for_each: alicloud.cdn.dcdn
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.dcdn.cdn_valid_trusted_certificate_attached
  title: AliCloud Dynamic Route for Content Delivery Network (DCDN) Should Have Valid
    Trusted Certificate Attached
  severity: medium
  assertion_id: ''
  for_each: alicloud.cdn.dcdn
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.dcdn.cdn_waf_web_acl_attached
  title: Ensure Dynamic Route for Content Delivery Network (DCDN) has Web Application
    Firewall (WAF) Web ACL Attached
  severity: low
  assertion_id: ''
  for_each: alicloud.cdn.dcdn
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.distribution.custom_ssl_certificate_valid
  title: Alibaba Cloud Content Delivery Network Distribution Custom SSL Certificate
    Must Be Valid
  severity: medium
  assertion_id: ''
  for_each: alicloud.cdn.distribution
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.distribution.logging_enabled_90_day_retention
  title: AliCloud Content Delivery Network Distribution Must Have Logging Enabled
    with 90-Day Retention
  severity: medium
  assertion_id: ''
  for_each: alicloud.cdn.distribution
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.distribution.origin_traffic_encrypted_tls1_2_or_higher
  title: Alibaba Cloud Content Delivery Network distribution should encrypt origin
    traffic with TLS 1.2 or higher
  severity: medium
  assertion_id: ''
  for_each: alicloud.cdn.distribution
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.distribution.tls1_2_or_higher_enforced
  title: Alibaba Cloud Content Delivery Network Distribution Must Enforce TLS 1.2
    or Higher
  severity: medium
  assertion_id: ''
  for_each: alicloud.cdn.distribution
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.domain.custom_ssl_certificate
  title: Content Delivery Network Domain Should Use Custom SSL Certificate
  severity: medium
  assertion_id: ''
  for_each: alicloud.cdn.domain
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.domain.field_level_encryption_enabled
  title: AliCloud Content Delivery Network Domain Field Level Encryption Should Be
    Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.cdn.domain
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.domain.https_enabled
  title: Alibaba Cloud Content Delivery Network Domain Should Have HTTPS Enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.cdn.domain
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.domain.logging_enabled
  title: Alibaba Cloud Content Delivery Network Domain Logging Should Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.cdn.domain
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.domain.multiple_origin_failover_configured
  title: Alibaba Cloud Content Delivery Network Domain Multiple Origin Failover Configuration
  severity: low
  assertion_id: ''
  for_each: alicloud.cdn.domain
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.domain.origin_traffic_encrypted
  title: Alibaba Cloud Content Delivery Network domain should have encrypted origin
    traffic
  severity: low
  assertion_id: ''
  for_each: alicloud.cdn.domain
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.domain.using_deprecated_ssl_protocols
  title: AliCloud Content Delivery Network Domain Should Not Use Deprecated SSL Protocols
  severity: medium
  assertion_id: ''
  for_each: alicloud.cdn.domain
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.edge.cache_policy_no_sensitive_headers_cached
  title: AliCloud Content Delivery Network Cache Policy Should Not Cache Sensitive
    Headers
  severity: medium
  assertion_id: ''
  for_each: alicloud.cdn.edge
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.edge.cache_policy_respects_cache_control_no_store_private
  title: AliCloud Content Delivery Network Edge Cache Policy Should Respect Cache-Control
    No-Store and Private Directives
  severity: medium
  assertion_id: ''
  for_each: alicloud.cdn.edge
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.cdn.origin.origin_request_policy_no_secret_headers_forwarded
  title: Alibaba Cloud Content Delivery Network Origin Request Policy Should Not Forward
    Secret Headers
  severity: high
  assertion_id: ''
  for_each: alicloud.cdn.origin
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
