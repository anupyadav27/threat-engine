version: '1.0'
provider: alicloud
service: arms
discovery:
- discovery_id: alicloud.arms.api
  calls:
  - product: ARMS
    version: '2014-05-26'
    action: DescribeApis
    params: {}
    save_as: api_list
  emit:
    items_for: '{ api_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: api
- discovery_id: alicloud.arms.ml
  calls:
  - product: ARMS
    version: '2014-05-26'
    action: DescribeMls
    params: {}
    save_as: ml_list
  emit:
    items_for: '{ ml_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: ml
- discovery_id: alicloud.arms.tracing_analysis
  calls:
  - product: ARMS
    version: '2014-05-26'
    action: DescribeTracingAnalysiss
    params: {}
    save_as: tracing_analysis_list
  emit:
    items_for: '{ tracing_analysis_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: tracing_analysis
- discovery_id: alicloud.arms.tracing_sampling_rule
  calls:
  - product: ARMS
    version: '2014-05-26'
    action: DescribeTracingSamplingRules
    params: {}
    save_as: tracing_sampling_rule_list
  emit:
    items_for: '{ tracing_sampling_rule_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: tracing_sampling_rule
checks:
- rule_id: alicloud.arms.api.monitoring_api_access_log_fields_identity_present
  title: Application Real-Time Monitoring Service API Access Logs Must Include Identity
    Fields
  severity: medium
  assertion_id: ''
  for_each: alicloud.arms.api
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.arms.api.monitoring_api_access_log_sink_configured
  title: Application Real-Time Monitoring Service API Access Log Sink Must Be Configured
  severity: medium
  assertion_id: ''
  for_each: alicloud.arms.api
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.arms.api.monitoring_api_access_logging_enabled
  title: Application Real-Time Monitoring Service (ARMS) API Access Logging Should
    Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.arms.api
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.arms.ml.monitoring_logs_enabled
  title: Application Real-Time Monitoring Service Machine Learning Monitoring Logs
    Should Be Enabled
  severity: medium
  assertion_id: ''
  for_each: alicloud.arms.ml
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.arms.ml.monitoring_outputs_encrypted_and_private
  title: Application Real-Time Monitoring Service (ARMS) Machine Learning monitoring
    outputs should be encrypted and configured for private access
  severity: medium
  assertion_id: ''
  for_each: alicloud.arms.ml
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.arms.ml.monitoring_private_networking_enforced
  title: Application Real-Time Monitoring Service Machine Learning Private Networking
    Enforced
  severity: medium
  assertion_id: ''
  for_each: alicloud.arms.ml
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.arms.ml.monitoring_roles_least_privilege
  title: Application Real-Time Monitoring Service Machine Learning Monitoring Roles
    Should Follow Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.arms.ml
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.arms.tracing_analysis.trace_access_rbac_least_privilege
  title: Application Real-Time Monitoring Service Tracing Analysis Should Implement
    RBAC Least Privilege Access Controls
  severity: high
  assertion_id: ''
  for_each: alicloud.arms.tracing_analysis
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.arms.tracing_analysis.trace_store_encrypted
  title: Application Real-Time Monitoring Service (ARMS) Tracing Analysis Trace Store
    Should Be Encrypted
  severity: low
  assertion_id: ''
  for_each: alicloud.arms.tracing_analysis
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.arms.tracing_sampling_rule.sampling_rule_access_rbac_least_privilege
  title: Application Real-Time Monitoring Service (ARMS) Tracing Sampling Rule Access
    Should Follow RBAC Least Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.arms.tracing_sampling_rule
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.arms.tracing_sampling_rule.sampling_rule_storage_encrypted
  title: Application Real-Time Monitoring Service (ARMS) Tracing Sampling Rule Storage
    Should Be Encrypted
  severity: low
  assertion_id: ''
  for_each: alicloud.arms.tracing_sampling_rule
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
