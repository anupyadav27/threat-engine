version: '1.0'
provider: alicloud
service: config
discovery:
- discovery_id: alicloud.config.aggregator
  calls:
  - product: CONFIG
    version: '2014-05-26'
    action: DescribeAggregators
    params: {}
    save_as: aggregator_list
  emit:
    items_for: '{ aggregator_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: aggregator
- discovery_id: alicloud.config.compliance_monitoring_enabled
  calls:
  - product: CONFIG
    version: '2014-05-26'
    action: DescribeComplianceMonitoringEnableds
    params: {}
    save_as: compliance_monitoring_enabled_list
  emit:
    items_for: '{ compliance_monitoring_enabled_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: compliance_monitoring_enabled
- discovery_id: alicloud.config.delivery
  calls:
  - product: CONFIG
    version: '2014-05-26'
    action: DescribeDeliverys
    params: {}
    save_as: delivery_list
  emit:
    items_for: '{ delivery_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: delivery
- discovery_id: alicloud.config.delivery_channel
  calls:
  - product: CONFIG
    version: '2014-05-26'
    action: DescribeDeliveryChannels
    params: {}
    save_as: delivery_channel_list
  emit:
    items_for: '{ delivery_channel_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: delivery_channel
- discovery_id: alicloud.config.drift_detection
  calls:
  - product: CONFIG
    version: '2014-05-26'
    action: DescribeDriftDetections
    params: {}
    save_as: drift_detection_list
  emit:
    items_for: '{ drift_detection_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: drift_detection
- discovery_id: alicloud.config.enabled
  calls:
  - product: CONFIG
    version: '2014-05-26'
    action: DescribeEnableds
    params: {}
    save_as: enabled_list
  emit:
    items_for: '{ enabled_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: enabled
- discovery_id: alicloud.config.recorder
  calls:
  - product: CONFIG
    version: '2014-05-26'
    action: DescribeRecorders
    params: {}
    save_as: recorder_list
  emit:
    items_for: '{ recorder_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: recorder
- discovery_id: alicloud.config.recorder_enabled_in_all_regions
  calls:
  - product: CONFIG
    version: '2014-05-26'
    action: DescribeRecorderEnabledInAllRegionss
    params: {}
    save_as: recorder_enabled_in_all_regions_list
  emit:
    items_for: '{ recorder_enabled_in_all_regions_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: recorder_enabled_in_all_regions
- discovery_id: alicloud.config.remediation
  calls:
  - product: CONFIG
    version: '2014-05-26'
    action: DescribeRemediations
    params: {}
    save_as: remediation_list
  emit:
    items_for: '{ remediation_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: remediation
- discovery_id: alicloud.config.rule
  calls:
  - product: CONFIG
    version: '2014-05-26'
    action: DescribeRules
    params: {}
    save_as: rule_list
  emit:
    items_for: '{ rule_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: rule
- discovery_id: alicloud.config.workload
  calls:
  - product: CONFIG
    version: '2014-05-26'
    action: DescribeWorkloads
    params: {}
    save_as: workload_list
  emit:
    items_for: '{ workload_list }'
    as: r
    item:
      id: '{{ r.id }}'
      name: '{{ r.name }}'
      resource_type: workload
checks:
- rule_id: alicloud.config.aggregator.aggregation_authorization_trusts_least_privilege
  title: AliCloud Config Aggregator Aggregation Authorization Should Follow Least
    Privilege Principle
  severity: high
  assertion_id: ''
  for_each: alicloud.config.aggregator
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.config.compliance_monitoring_enabled.configured
  title: AliCloud Config Service Compliance Monitoring Must Be Enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.config.compliance_monitoring_enabled
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.config.delivery.config_delivery_destination_access_least_privilege
  title: AliCloud Config Delivery Channel Destination Should Follow Least Privilege
    Access Principles
  severity: high
  assertion_id: ''
  for_each: alicloud.config.delivery
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.config.delivery.config_delivery_kms_encryption_enabled
  title: Ensure AliCloud Config Delivery Channel Has KMS Encryption Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.config.delivery
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.config.delivery_channel.destination_access_least_privilege
  title: AliCloud Config Delivery Channel Should Use Least Privilege Access for Destination
    Resources
  severity: high
  assertion_id: ''
  for_each: alicloud.config.delivery_channel
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.config.delivery_channel.kms_encryption_enabled
  title: AliCloud Configuration Audit Delivery Channel KMS Encryption Should Be Enabled
  severity: high
  assertion_id: ''
  for_each: alicloud.config.delivery_channel
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.config.drift_detection.config_drift_alerts_configured
  title: AliCloud Config Service Drift Detection Alerts Must Be Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.config.drift_detection
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.config.drift_detection.config_drift_critical_resources_drift_detection_enabled
  title: AliCloud Config Drift Detection for Critical Resources Must Be Enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.config.drift_detection
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.config.enabled.configured
  title: Ensure AliCloud Config Service is Enabled and Properly Configured
  severity: low
  assertion_id: ''
  for_each: alicloud.config.enabled
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.config.recorder.active_all_regions_with_global_resources
  title: Ensure AliCloud Config Recorder is Active in All Regions with Global Resources
    Enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.config.recorder
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.config.recorder.config_delivery_secure_destination_configured
  title: AliCloud Config Service Configuration Recorder Must Use Secure Delivery Destination
  severity: medium
  assertion_id: ''
  for_each: alicloud.config.recorder
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.config.recorder.config_recorder_enabled
  title: AliCloud Config Recorder Must Be Enabled for Configuration Monitoring
  severity: low
  assertion_id: canada_pbmm_moderate_multi_cloud_CCCS_AU-2_0024
  for_each: alicloud.config.recorder
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.config.recorder.config_recorder_global_resource_types_tracked
  title: AliCloud Config Recorder Should Track Global Resource Types
  severity: low
  assertion_id: ''
  for_each: alicloud.config.recorder
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.config.recorder.delivery_channel_secure_destination_configured
  title: AliCloud Config Recorder Delivery Channel Must Use Secure Destination Configuration
  severity: medium
  assertion_id: ''
  for_each: alicloud.config.recorder
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.config.recorder_enabled_in_all_regions.configured
  title: AliCloud Config Service Configuration Recorder Must Be Enabled in All Regions
  severity: low
  assertion_id: ''
  for_each: alicloud.config.recorder_enabled_in_all_regions
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.config.remediation.config_remediation_auto_remediation_enabled_for_high
  title: AliCloud Config Remediation Auto Remediation Should Be Enabled For High Severity
    Rules
  severity: low
  assertion_id: ''
  for_each: alicloud.config.remediation
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.config.rule.config_rule_remediation_targets_bound
  title: AliCloud Config Rule Remediation Targets Must Be Bound
  severity: low
  assertion_id: ''
  for_each: alicloud.config.rule
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.config.rule.config_rule_required_rules_present
  title: AliCloud Config Service Required Configuration Rules Must Be Present
  severity: low
  assertion_id: ''
  for_each: alicloud.config.rule
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.config.rule.config_rule_rules_enabled
  title: Ensure AliCloud Config Service Rules Are Enabled
  severity: low
  assertion_id: ''
  for_each: alicloud.config.rule
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
- rule_id: alicloud.config.workload.no_high_or_medium_risks
  title: AliCloud Config Workloads Must Not Have High or Medium Risk Vulnerabilities
  severity: low
  assertion_id: ''
  for_each: alicloud.config.workload
  params: {}
  conditions:
    all:
    - var: item.id
      op: exists
      value: null
