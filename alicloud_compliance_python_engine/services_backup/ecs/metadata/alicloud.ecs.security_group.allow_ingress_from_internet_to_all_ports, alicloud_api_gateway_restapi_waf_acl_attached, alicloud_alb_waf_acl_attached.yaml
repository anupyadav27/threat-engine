description: This rule validates that ECS security groups do not permit ingress traffic
  from the internet to all ports, which creates significant security vulnerabilities
  and potential attack vectors. Additionally, it ensures that API Gateway REST APIs
  and Application Load Balancers have Web Application Firewall ACLs properly attached
  to provide essential protection against common web exploits and maintain compliance
  with security frameworks.
domain: network_security_and_connectivity
rationale: Ensures Elastic Compute Service security_group has allow ingress from internet
  to all ports, alicloud api gateway restapi waf acl attached, alicloud alb waf acl
  attached properly configured for security compliance. This control is essential
  for maintaining a strong security posture and meeting regulatory requirements.
references:
- https://www.alibabacloud.com/help/ecs/user-guide/security-groups
- https://www.alibabacloud.com/help/waf/user-guide/configure-a-whitelist-or-blacklist-for-an-api
requirement: Allow Ingress From Internet To All Ports, Alicloud API Gateway Restapi
  Waf ACL Attached, Alicloud Alb Waf ACL Attached
resource: security_group
rule_id: alicloud.ecs.security_group.allow_ingress_from_internet_to_all_ports, alicloud_api_gateway_restapi_waf_acl_attached,
  alicloud_alb_waf_acl_attached
scope: ecs.security_group.security
service: ecs
severity: medium
subcategory: network_access_control
title: Ensure Elastic Compute Service Security Groups Do Not Allow Unrestricted Internet
  Access and Web Application Firewall ACLs Are Properly Configured
