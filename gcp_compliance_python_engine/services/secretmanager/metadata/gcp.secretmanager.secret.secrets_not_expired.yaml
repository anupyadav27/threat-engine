rule_id: gcp.secretmanager.secret.secrets_not_expired
service: secretmanager
resource: secret
requirement: Secrets Not Expired
scope: secretmanager.secret.security
domain: secrets_and_key_management
subcategory: key_management
severity: high
title: Ensure Secrets in Secret Manager Have Expiration Dates
rationale: Secrets without expiration dates pose a security risk as they may be used
  indefinitely, increasing the chance of unauthorized access and potential data breaches.
  Expired secrets also help in minimizing the risk of exposure from unused or forgotten
  credentials, which can be exploited by attackers. Implementing expiration policies
  is critical for compliance with security frameworks like NIST and PCI-DSS, which
  require that secrets are rotated and managed properly.
description: This rule checks if secrets stored in Google Cloud Secret Manager are
  configured with expiration dates. To verify, review each secret's settings to ensure
  an expiration date is set. If not, update the secret configuration to include an
  appropriate expiration policy. Regularly rotate secrets and establish a lifecycle
  management policy to automatically handle secret expiration and renewal.
references:
- https://cloud.google.com/secret-manager/docs/managing-secrets
- https://cloud.google.com/security/compliance/cis-google-cloud-platform-foundations-benchmark
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/security/compliance
