rule_id: gcp.secretmanager.secret.secrets_kms_lessthan_wildcard_permissions
service: secretmanager
resource: secret
requirement: Secrets KMS Lessthan Wildcard Permissions
scope: secretmanager.secret.security
domain: secrets_and_key_management
subcategory: key_management
severity: high
title: Limit KMS Permissions for Secrets in Secret Manager
rationale: Excessive permissions on KMS keys used by Secret Manager can lead to unauthorized
  access and potential data breaches. By restricting permissions to specific actions,
  organizations minimize the risk of unauthorized key usage, aligning with compliance
  requirements such as PCI-DSS and protecting sensitive information from exposure.
description: This rule checks that the Cloud KMS key permissions associated with secrets
  in Secret Manager do not include wildcard permissions, which permit all actions.
  Ensure that permissions are explicitly defined to limit actions to only those necessary
  for operational purposes. To remediate, review IAM policies on KMS keys and replace
  wildcard permissions with specific actions like 'encrypt', 'decrypt', 'getCryptoKeyVersion'.
references:
- https://cloud.google.com/secret-manager/docs
- https://cloud.google.com/iam/docs/understanding-roles
- https://cloud.google.com/security/compliance
- https://cloud.google.com/kms/docs/reference/permissions-and-roles
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.nist.gov/cyberframework
