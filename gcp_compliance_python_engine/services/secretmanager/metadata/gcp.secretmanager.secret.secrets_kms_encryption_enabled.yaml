rule_id: gcp.secretmanager.secret.secrets_kms_encryption_enabled
service: secretmanager
resource: secret
requirement: Secrets KMS Encryption Enabled
scope: secretmanager.secret.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure Secrets Use Customer-Managed Encryption Keys
rationale: Utilizing Customer-Managed Encryption Keys (CMEK) for secrets enhances
  security by allowing organizations to control the encryption process and manage
  encryption keys centrally. This reduces the risk of unauthorized access and helps
  comply with regulatory standards such as PCI-DSS and HIPAA, which require strong
  encryption practices. Failure to properly encrypt secrets can lead to data breaches
  and exposure of sensitive information, impacting business reputation and incurring
  compliance fines.
description: This rule checks if secrets stored in Google Cloud Secret Manager are
  encrypted using customer-managed keys (CMEK) rather than Google-managed keys. To
  verify, ensure the secret has the 'replication.policy.userManaged' configuration
  with a valid KMS key ID. Remediation involves configuring your secrets to use CMEK
  by specifying the customer-managed key during secret creation or updating existing
  secrets to use a CMEK. This provides stronger security controls over encryption
  operations.
references:
- https://cloud.google.com/secret-manager/docs/secret-manager-overview
- https://cloud.google.com/kms/docs/cmek
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.hhs.gov/hipaa/for-professionals/security/index.html
- https://www.iso.org/iso-27001-information-security.html
