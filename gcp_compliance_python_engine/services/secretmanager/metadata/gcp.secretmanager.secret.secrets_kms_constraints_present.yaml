rule_id: gcp.secretmanager.secret.secrets_kms_constraints_present
service: secretmanager
resource: secret
requirement: Secrets KMS Constraints Present
scope: secretmanager.secret.security
domain: secrets_and_key_management
subcategory: key_management
severity: high
title: Ensure Secrets Use KMS Encryption Constraints
rationale: Implementing KMS constraints on secrets in Secret Manager is critical to
  ensuring that sensitive data is encrypted using organization-approved keys, mitigating
  the risk of unauthorized access and data breaches. This approach aligns with regulatory
  requirements and supports key management best practices by enforcing strong encryption
  policies and ensuring centralized control over encryption keys.
description: This rule checks if Secret Manager secrets have KMS constraints applied
  to ensure encryption with customer-managed keys (CMKs). Without these constraints,
  secrets may be encrypted with default keys, increasing exposure to potential security
  threats. To verify, inspect the secret's configuration for KMS constraints and ensure
  they reference a valid CMK. Remediation involves configuring secrets to use organization-approved
  KMS keys by setting the appropriate constraints in the Secret Manager settings.
references:
- https://cloud.google.com/secret-manager/docs/encrypting-secrets
- https://cloud.google.com/security/compliance/cis-gcp-benchmark
- https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
- https://cloud.google.com/kms/docs/key-policies
- https://cloud.google.com/secret-manager/docs/access-control
- https://cloud.google.com/security/compliance
