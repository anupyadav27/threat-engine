rule_id: gcp.secretmanager.secret.secrets_key_has_alias
service: secretmanager
resource: secret
requirement: Secrets Key Has Alias
scope: secretmanager.secret.security
domain: secrets_and_key_management
subcategory: key_management
severity: high
title: Ensure Secret Manager Secrets Have Key Alias
rationale: Aliases for keys in Secret Manager provide an additional layer of abstraction
  and security by allowing key rotation without changing the actual key ID used by
  applications. This practice helps mitigate the risk of key exposure and ensures
  easier management of cryptographic keys, thereby supporting compliance with security
  standards such as PCI-DSS and ISO 27001.
description: This rule checks whether secrets stored in GCP Secret Manager have an
  associated alias for their encryption keys. Ensuring that each key has an alias
  simplifies key rotation and management. To verify, navigate to the Secret Manager
  in the GCP Console, select a secret, and check the key settings for an alias. If
  none exists, create an alias through Cloud KMS and configure the secret to use it.
  This enhances security posture by decoupling key identity from application usage.
references:
- https://cloud.google.com/secret-manager/docs/set-secret-version-alias
- https://cloud.google.com/security/best-practices
- https://cloud.google.com/kms/docs/key-rotation
- https://www.pcisecuritystandards.org/pci_security/
- https://www.iso.org/iso-27001-information-security.html
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r4.pdf
