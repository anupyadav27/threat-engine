rule_id: gcp.secretmanager.secret.secrets_ca_key_in_hsm_where_supported
service: secretmanager
resource: secret
requirement: Secrets Ca Key In Hsm Where Supported
scope: secretmanager.secret.security
domain: secrets_and_key_management
subcategory: key_management
severity: high
title: Ensure Secrets CA Key Uses HSM Where Supported
rationale: Storing CA keys in a Hardware Security Module (HSM) enhances the protection
  of cryptographic keys by using dedicated hardware appliances, reducing the risk
  of key exposure and unauthorized access. This is crucial for maintaining the integrity
  and confidentiality of secrets, and it aligns with compliance frameworks like PCI-DSS
  and NIST that mandate strong key management practices.
description: This rule checks whether the CA keys for secrets in Google Cloud Secret
  Manager are stored in an HSM, where supported. An HSM provides robust physical and
  logical protection for cryptographic keys, ensuring they remain secure even if a
  software vulnerability is exploited. To verify, inspect the key management settings
  of your secrets and configure them to use HSM-backed keys when possible. Remediation
  involves migrating or creating keys in an HSM environment through GCP's Key Management
  Service (KMS).
references:
- https://cloud.google.com/secret-manager/docs
- https://cloud.google.com/security/overview/whitepaper#key_management
- https://cloud.google.com/kms/docs/hsm
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://www.pcisecuritystandards.org/
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r4.pdf
