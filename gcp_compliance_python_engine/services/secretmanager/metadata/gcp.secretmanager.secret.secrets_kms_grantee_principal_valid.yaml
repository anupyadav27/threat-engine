rule_id: gcp.secretmanager.secret.secrets_kms_grantee_principal_valid
service: secretmanager
resource: secret
requirement: Secrets KMS Grantee Principal Valid
scope: secretmanager.secret.security
domain: secrets_and_key_management
subcategory: key_management
severity: high
title: Ensure Valid KMS Grantee Principal for Secret Access
rationale: Validating the KMS grantee principal for secrets is crucial to prevent
  unauthorized access to sensitive data. Improperly configured principals can lead
  to data breaches, exposing critical secrets to unauthorized users. Compliance standards
  such as PCI-DSS and ISO 27001 require strict access controls on key management systems
  to safeguard sensitive information.
description: This rule checks whether the KMS key used for encrypting secrets in Secret
  Manager has valid grantee principals. Ensure that only authorized identities and
  service accounts are granted access to these keys. To verify, inspect the IAM policies
  associated with KMS keys and confirm that only necessary entities are included.
  Remediation involves adjusting IAM policies to remove unnecessary or invalid principals.
references:
- https://cloud.google.com/secret-manager/docs/access-control
- https://cloud.google.com/kms/docs/resource-hierarchy-access-control
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/document_library
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57pt1r4.pdf
- https://www.iso.org/iso-27001-information-security.html
