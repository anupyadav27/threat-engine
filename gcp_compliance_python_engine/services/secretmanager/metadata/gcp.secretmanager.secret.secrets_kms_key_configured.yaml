rule_id: gcp.secretmanager.secret.secrets_kms_key_configured
service: secretmanager
resource: secret
requirement: Secrets KMS Key Configured
scope: secretmanager.secret.security
domain: secrets_and_key_management
subcategory: key_management
severity: high
title: Ensure Secrets Use Customer-Managed Encryption Keys
rationale: Using Customer-Managed Encryption Keys (CMEK) for secrets in Secret Manager
  enhances security by allowing organizations to have control over the encryption
  keys used to protect their sensitive data. This reduces the risk of unauthorized
  access and aligns with compliance requirements that demand stringent encryption
  controls, such as GDPR and HIPAA. In the event of a breach, having CMEK configured
  can prevent data exposure by revoking access to the key, thereby safeguarding the
  secrets.
description: This rule checks if a Customer-Managed Encryption Key (CMEK) is configured
  for secrets stored in GCP Secret Manager. By default, Google Cloud encrypts secrets
  using Google-managed keys, but configuring CMEK provides enhanced security control.
  To ensure compliance with this rule, verify that CMEK is set for your secrets by
  checking the encryption settings in the Secret Manager console or via the gcloud
  CLI. If CMEK is not configured, update the secret's settings to use a specific Cloud
  KMS key for encryption. This involves selecting an appropriate key ring and key
  in Cloud KMS and applying it to the secret.
references:
- https://cloud.google.com/secret-manager/docs/encrypting-secrets
- https://cloud.google.com/security/compliance
- https://cloud.google.com/kms/docs/cmek
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://cloud.google.com/docs/security-overview
- https://www.iso.org/iso-27001-information-security.html
