rule_id: gcp.apikeys.key.platform_api_rotation_policy_defined
service: apikeys
resource: key
requirement: Platform API Rotation Policy Defined
scope: apikeys.key.key_rotation
domain: secrets_and_key_management
subcategory: key_management
severity: medium
title: Ensure API Key Rotation Policy is Defined for Platform APIs
rationale: Defining a key rotation policy for API keys is crucial to mitigate the
  risk of key compromise. Regular rotation reduces the window of opportunity for an
  attacker who obtains an API key, enhancing the overall security posture. It also
  aligns with compliance requirements such as PCI-DSS and ISO 27001, which mandate
  regular review and rotation of keys to protect sensitive data.
description: This rule checks whether a key rotation policy is defined for API keys
  used to access Google Cloud Platform services. A rotation policy should specify
  the frequency of key changes and ensure that keys are not used beyond their intended
  lifespan. To verify, ensure that API keys have an associated rotation schedule in
  the GCP Console under the 'API & Services' section. Remediation involves setting
  up a key rotation policy using automation tools like Cloud Functions or external
  scripts to regularly rotate keys.
references:
- https://cloud.google.com/docs/authentication/api-keys
- https://cloud.google.com/iam/docs/managing-api-keys
- CIS Google Cloud Platform Foundation Benchmark v1.2.0, Control 1.9
- PCI-DSS Requirement 3.6.4
- ISO 27001:2013 Section A.9.2.3
- https://cloud.google.com/security/best-practices
