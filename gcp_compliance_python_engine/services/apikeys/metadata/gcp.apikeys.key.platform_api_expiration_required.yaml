rule_id: gcp.apikeys.key.platform_api_expiration_required
service: apikeys
resource: key
requirement: Platform API Expiration Required
scope: apikeys.key.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Require API Key Expiration for Platform APIs
rationale: Requiring an expiration date for API keys mitigates the risk of unauthorized
  access by ensuring that unused or compromised keys are invalidated after a certain
  period. This practice reduces the attack surface and aligns with best practices
  for key management, supporting compliance with standards like PCI-DSS and SOC2.
  Expiring API keys also helps prevent data breaches and unauthorized data exposure,
  protecting sensitive business information.
description: This rule checks if API keys used for accessing platform APIs have an
  expiration date set. To verify, examine the API key configuration in the GCP Console
  or using the gcloud command-line tool. If an expiration date is not set, update
  the key settings to include one, ensuring it aligns with your organization's security
  policy on key rotation and lifecycle management. Regularly review and update expiration
  dates to adapt to changing security requirements.
references:
- https://cloud.google.com/docs/authentication/api-keys#enforcing_expiration_dates
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/security/compliance/soc-2
- https://cloud.google.com/iam/docs/using-manage-api-keys
- https://cloud.google.com/security/best-practices/encryption
