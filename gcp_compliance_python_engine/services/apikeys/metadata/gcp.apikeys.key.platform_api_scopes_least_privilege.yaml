rule_id: gcp.apikeys.key.platform_api_scopes_least_privilege
service: apikeys
resource: key
requirement: Platform API Scopes Least Privilege
scope: apikeys.key.least_privilege
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Ensure API Keys Use Least Privilege Platform API Scopes
rationale: Limiting API key permissions to the minimum required reduces the risk of
  unauthorized access and data breaches. By adhering to the principle of least privilege,
  organizations can prevent privilege escalation and minimize the attack surface,
  meeting compliance requirements for frameworks like NIST and ISO 27001.
description: This rule checks that API keys are configured with the minimum necessary
  platform API scopes to perform their intended functions. Ensure that each API key
  is scoped to access only the required APIs, avoiding overly broad permissions. To
  verify, review API key configurations in the Google Cloud Console or via the gcloud
  command-line tool. Remediation involves updating the API key settings to restrict
  scopes to the least privilege necessary for application functionality.
references:
- https://cloud.google.com/docs/authentication/api-keys
- https://cloud.google.com/iam/docs/understanding-roles
- https://www.cisecurity.org/benchmark/google_cloud_computing_foundation
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://www.iso.org/iso-27001-information-security.html
