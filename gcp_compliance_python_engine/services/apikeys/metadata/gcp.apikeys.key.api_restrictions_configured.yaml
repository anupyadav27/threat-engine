rule_id: gcp.apikeys.key.api_restrictions_configured
service: apikeys
resource: key
requirement: API Restrictions Configured
scope: apikeys.key.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure API Keys Have Configured API Restrictions
rationale: Configuring API restrictions for API keys limits their use to specific
  APIs, minimizing the risk of unauthorized access and misuse. Without restrictions,
  compromised keys can be exploited to access multiple services, leading to data breaches
  and potential financial and reputational damage. Compliance with standards such
  as GDPR and PCI-DSS often requires strict access controls on sensitive APIs.
description: This rule checks if API keys in GCP have API restrictions configured
  to limit their use to authorized APIs only. To verify, review the API key settings
  in the Google Cloud Console under 'API & Services > Credentials' and ensure that
  each key has specific APIs selected in the 'API restrictions' section. Remediation
  involves adding the necessary API restrictions to each key, ensuring they are only
  usable with the intended services.
references:
- https://cloud.google.com/docs/authentication/api-keys#restricting_api_keys
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/pci_security/
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/docs/security/best-practices
- https://cloud.google.com/security/compliance
