rule_id: gcp.monitoring.alert_policy.logging_metric_filter_console_root_login_detected_fi_present
service: monitoring
resource: alert_policy
requirement: Logging Metric Filter Console Root Login Detected Fi Present
scope: monitoring.alert_policy.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: critical
title: Detect Console Root Logins Using Logging Metric Filter
rationale: Monitoring console root logins is crucial for preventing unauthorized access
  and potential privilege escalation. Root account usage should be minimal and carefully
  audited due to the associated high-level privileges, which can lead to severe security
  breaches if misused. Compliance requirements often mandate the logging and monitoring
  of root account activities to ensure accountability and traceability.
description: This rule checks for the presence of a logging metric filter that detects
  console logins using the root account. To verify, ensure a log-based metric is configured
  to filter and capture 'gcloud' or 'console' login events where the user is 'root'.
  Remediation involves creating or updating logging metrics in Google Cloud Logging
  to capture such events, and setting up alert policies in Cloud Monitoring to notify
  security teams of any detected root logins.
references:
- https://cloud.google.com/logging/docs/logs-based-metrics
- https://cloud.google.com/monitoring/alerts
- CIS Google Cloud Platform Foundation Benchmark v1.3.0, Control 4.6
- 'NIST SP 800-53 Rev. 5, AC-2: Account Management'
- 'PCI-DSS 3.2.1 Requirement 10.2: Logging and Monitoring'
- https://cloud.google.com/security/compliance
