rule_id: gcp.monitoring.alert_policy.logging_metric_filter_iam_policy_change_detected_fil_present
service: monitoring
resource: alert_policy
requirement: Logging Metric Filter IAM Policy Change Detected Fil Present
scope: monitoring.alert_policy.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: medium
title: Alert on IAM Policy Changes via Logging Metric Filter
rationale: Monitoring IAM policy changes is crucial as unauthorized alterations can
  lead to privilege escalation and data breaches. Detecting these changes promptly
  helps mitigate risks by ensuring only authorized modifications occur, aligning with
  security best practices and compliance mandates like PCI-DSS and ISO 27001, which
  require strict access controls.
description: This rule checks for the presence of a logging metric filter that detects
  IAM policy changes. The filter should trigger an alert when a policy modification
  occurs, allowing for immediate investigation. To verify, ensure a logging metric
  exists that captures 'SetIamPolicy' or 'ModifyIamPolicy' operations within audit
  logs. Remediate by creating a filter in Google Cloud Logging and associating it
  with an alert policy in Monitoring, ensuring real-time notifications of policy changes.
references:
- https://cloud.google.com/logging/docs/audit
- https://cloud.google.com/iam/docs/monitoring-iam
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance/pci-dss
- https://cloud.google.com/security/compliance/iso-27001
- https://cloud.google.com/monitoring/alerts
