rule_id: gcp.artifactregistry.repository.supply_chain_registry_no_public_pull_push
service: artifactregistry
resource: repository
requirement: Supply Chain Registry No Public Pull Push
scope: artifactregistry.repository.public_access
domain: identity_and_access_management
subcategory: authentication
severity: critical
title: Restrict Public Pull/Push on Artifact Registry Repositories
rationale: Allowing public pull and push access to artifact repositories poses a significant
  security risk, as unauthorized users could introduce malicious artifacts or exfiltrate
  sensitive data. This exposure could lead to supply chain attacks, compromising the
  integrity of software deployments and violating compliance mandates such as SOC
  2, which emphasize access control. Limiting repository access helps protect against
  these threats, ensuring that only trusted entities can interact with critical software
  components.
description: This rule checks for repositories in Google Cloud's Artifact Registry
  that have public pull or push access enabled. Ensuring that repositories are not
  publicly accessible prevents unauthorized access and modifications. To verify and
  remediate, review the IAM policies of each repository to ensure that roles like
  'roles/artifactregistry.reader' and 'roles/artifactregistry.writer' are not granted
  to 'allUsers' or 'allAuthenticatedUsers'. Update these policies to restrict access
  to only necessary and trusted Google Cloud identities.
references:
- https://cloud.google.com/artifact-registry/docs/access-control
- https://cloud.google.com/security/compliance/soc-2
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/iam/docs/overview
