rule_id: gcp.artifactregistry.repository.registry_image_scan_on_push_enabled
service: artifactregistry
resource: repository
requirement: Registry Image Scan On Push Enabled
scope: artifactregistry.repository.security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: low
title: Enable Image Scan on Push for Artifact Registry Repositories
rationale: Enabling image scan on push in Artifact Registry helps identify vulnerabilities
  in container images early in the development process, reducing the risk of deploying
  insecure applications. This proactive approach aligns with security best practices
  and regulatory requirements such as PCI-DSS and ISO 27001, which emphasize the importance
  of vulnerability management and secure software development lifecycle.
description: This rule checks if the image scan on push feature is enabled for repositories
  in Google's Artifact Registry. Enabling this setting ensures that each image pushed
  to the registry is automatically scanned for vulnerabilities, providing immediate
  feedback to developers and preventing vulnerable images from progressing through
  the deployment pipeline. To verify and enable this setting, navigate to the GCP
  Console, select Artifact Registry, and configure the repository settings to enable
  automatic scanning. Alternatively, use the `gcloud` command-line tool to set the
  `scan-on-push` flag to true.
references:
- https://cloud.google.com/artifact-registry/docs/scan-images
- https://cloud.google.com/security/compliance/pci-dss
- https://www.iso.org/iso-27001-information-security.html
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
