rule_id: gcp.artifactregistry.repository.supply_chain_policy_storage_encrypted
service: artifactregistry
resource: repository
requirement: Supply Chain Policy Storage Encrypted
scope: artifactregistry.repository.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Artifact Registry Repositories Use Encrypted Storage
rationale: Encrypting storage containing supply chain artifacts protects against unauthorized
  data access and potential data breaches, which can compromise the integrity of software
  supply chains. This is crucial for compliance with data protection regulations like
  PCI-DSS and HIPAA, and mitigates risks of intellectual property theft and reputational
  damage.
description: This rule checks if Artifact Registry repositories have encryption enabled
  at rest. Ensure that Google-managed keys or Customer-Managed Encryption Keys (CMEK)
  are used to encrypt repository storage. Verification can be done through the GCP
  Console or gcloud CLI by inspecting repository configurations. To remediate, enable
  encryption by configuring CMEK or using default encryption settings provided by
  Google.
references:
- https://cloud.google.com/artifact-registry/docs/encryption
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/pci_security/
- https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
- https://cloud.google.com/security/encryption-at-rest/
