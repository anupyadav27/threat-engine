rule_id: gcp.artifactregistry.repository.supply_chain_registry_no_wildcard_admin
service: artifactregistry
resource: repository
requirement: Supply Chain Registry No Wildcard Admin
scope: artifactregistry.repository.security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: critical
title: Restrict Admin Rights in Artifact Registry Repositories
rationale: Using wildcard entries for admin access in Artifact Registry repositories
  poses a significant security risk by allowing unrestricted access, which can lead
  to unauthorized actions and potential data breaches. This can compromise the integrity
  of the software supply chain, impact business operations, and violate compliance
  standards such as PCI-DSS and SOC2.
description: This rule ensures that no wildcard entries are used for granting admin
  roles within Artifact Registry repositories. It checks for IAM policies that assign
  roles/artifactregistry.admin with wildcard identities, such as 'allUsers' or 'allAuthenticatedUsers.'
  To verify, review and modify IAM policies to replace wildcard entries with specific
  user or service account identities. Remediation involves updating IAM policies in
  the Google Cloud Console or using gcloud CLI to remove wildcard permissions.
references:
- https://cloud.google.com/artifact-registry/docs/access-control
- https://cloud.google.com/iam/docs/understanding-service-accounts
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://cloud.google.com/security/best-practices
