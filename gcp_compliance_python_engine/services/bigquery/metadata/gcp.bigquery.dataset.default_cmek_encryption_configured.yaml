rule_id: gcp.bigquery.dataset.default_cmek_encryption_configured
service: bigquery
resource: dataset
requirement: Default Cmek Encryption Configured
scope: bigquery.dataset.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure BigQuery Datasets Use Default CMEK Encryption
rationale: Configuring Customer-Managed Encryption Keys (CMEK) for BigQuery datasets
  protects sensitive data by providing control over encryption keys, reducing the
  risk of unauthorized data access. This is essential for meeting compliance requirements
  like GDPR and HIPAA, which mandate strict data protection measures. Additionally,
  using CMEK helps mitigate the risk of data breaches by ensuring that access to encryption
  keys is tightly controlled and auditable.
description: This rule checks that all BigQuery datasets have a default Customer-Managed
  Encryption Key (CMEK) configured. To verify, ensure that each dataset in your Google
  Cloud project specifies a CMEK in its encryption configuration. If not configured,
  update the dataset settings in the Google Cloud Console or use the `bq` command-line
  tool to specify a key from Cloud Key Management Service (Cloud KMS). This will ensure
  that data is encrypted at rest using keys that you control.
references:
- https://cloud.google.com/bigquery/docs/customer-managed-encryption
- https://cloud.google.com/security/compliance/cis
- https://cloud.google.com/security/compliance/gdpr
- https://cloud.google.com/kms/docs
- https://cloud.google.com/security/compliance/hipaa
