rule_id: gcp.bigquery.reservation.capacity_monitoring_configured
service: bigquery
resource: reservation
requirement: Capacity Monitoring Configured
scope: bigquery.reservation.monitoring
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: medium
title: Ensure BigQuery Reservation Capacity Monitoring is Configured
rationale: Monitoring BigQuery reservation capacity is crucial for optimizing resource
  allocation and cost management. Without proper monitoring, organizations risk over-provisioning,
  leading to unnecessary expenses, or under-provisioning, which can cause performance
  issues and service disruptions. Ensuring capacity monitoring helps in maintaining
  efficient resource utilization and meeting compliance requirements for data usage
  transparency.
description: This rule checks if capacity monitoring is configured for BigQuery reservations.
  To verify, ensure that the BigQuery reservation settings include monitoring metrics
  for slot utilization and reservation usage. Remediation involves configuring Stackdriver
  Monitoring to track these metrics and setting up alerts for threshold breaches.
  Such configurations enable proactive management of resource capacity and prevent
  unexpected billing spikes due to inefficient resource use.
references:
- https://cloud.google.com/bigquery/docs/reservations-intro
- https://cloud.google.com/monitoring
- 'CIS GCP Benchmark: Section 4.6 - Ensure logging and monitoring is configured for
  BigQuery'
- 'NIST SP 800-53: SI-4 - Monitoring tools and techniques'
- ISO/IEC 27001:2013 - A.12.4 Logging and monitoring
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf (PCI DSS 10.6)
