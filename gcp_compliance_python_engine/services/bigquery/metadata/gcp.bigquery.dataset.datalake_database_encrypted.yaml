rule_id: gcp.bigquery.dataset.datalake_database_encrypted
service: bigquery
resource: dataset
requirement: Datalake Database Encrypted
scope: bigquery.dataset.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure BigQuery Datasets Are Encrypted At Rest
rationale: Encrypting BigQuery datasets at rest protects sensitive data from unauthorized
  access and breaches, which can lead to data theft and financial losses. It is crucial
  for meeting compliance requirements such as GDPR, HIPAA, and PCI-DSS, as well as
  maintaining trust with stakeholders by ensuring that data is stored securely.
description: This rule checks if BigQuery datasets are encrypted using Customer-Managed
  Encryption Keys (CMEK) to enhance data protection over the default Google-managed
  keys. Verify that datasets have CMEK configured by reviewing the dataset encryption
  settings in the Google Cloud Console or via the gcloud command-line tool. To remediate,
  configure CMEK for BigQuery datasets by creating a Cloud Key Management Service
  (KMS) key and associating it with the dataset.
references:
- https://cloud.google.com/bigquery/docs/encryption-at-rest
- https://cloud.google.com/security/compliance
- https://cloud.google.com/kms/docs/cmek
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/bigquery/docs/reference/rest/v2/datasets/patch
- https://cloud.google.com/iam/docs/understanding-service-accounts
