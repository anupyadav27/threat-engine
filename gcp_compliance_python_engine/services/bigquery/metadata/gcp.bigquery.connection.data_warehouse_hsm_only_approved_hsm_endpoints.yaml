rule_id: gcp.bigquery.connection.data_warehouse_hsm_only_approved_hsm_endpoints
service: bigquery
resource: connection
requirement: Data Warehouse Hsm Only Approved Hsm Endpoints
scope: bigquery.connection.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Restrict BigQuery HSM Connections to Approved Endpoints
rationale: Restricting BigQuery connections to approved HSM endpoints ensures data
  encryption keys are managed securely, preventing unauthorized access and maintaining
  data integrity. This is critical for protecting sensitive data against breaches
  and meeting compliance with standards like PCI-DSS and HIPAA, which mandate stringent
  encryption practices.
description: This rule checks that connections to BigQuery data warehouses are only
  established with approved HSM endpoints, ensuring that encryption keys are securely
  managed and stored. Verification involves reviewing the list of configured HSM endpoints
  against approved lists in your organization's security policies. Remediation requires
  updating connection settings to exclude unapproved endpoints and ensuring all connections
  route through approved HSMs.
references:
- https://cloud.google.com/bigquery/docs/encryption-at-rest
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/pci_security/
- https://www.hhs.gov/hipaa/index.html
- https://cloud.google.com/security/encryption-at-rest/default-encryption
- https://www.iso.org/iso-27001-information-security.html
