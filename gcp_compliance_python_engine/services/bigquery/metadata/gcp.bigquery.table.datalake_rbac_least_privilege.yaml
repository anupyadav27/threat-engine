rule_id: gcp.bigquery.table.datalake_rbac_least_privilege
service: bigquery
resource: table
requirement: Datalake RBAC Least Privilege
scope: bigquery.table.authorization
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Ensure Least Privilege for BigQuery Table Access
rationale: Implementing least privilege access for BigQuery tables reduces the risk
  of unauthorized data exposure and potential data breaches. It helps in maintaining
  compliance with data protection regulations like GDPR and HIPAA, where access to
  sensitive data must be strictly controlled and auditable. Failing to enforce this
  can lead to significant financial penalties and reputational damage.
description: This rule checks for overly permissive roles assigned to BigQuery tables
  within your GCP projects. Specifically, it ensures that only necessary roles are
  granted at the table level, thereby adhering to the principle of least privilege.
  To verify, review the IAM policies and ensure that roles like 'Owner', 'Editor',
  or custom roles with excessive permissions are not broadly granted. Remediate by
  assigning specific roles that limit access to only what is required for users to
  perform their job functions.
references:
- https://cloud.google.com/bigquery/docs/access-control
- https://cloud.google.com/iam/docs/overview
- CIS Google Cloud Computing Foundations Benchmark v1.1.0, 4.2 Ensure that BigQuery
  datasets are not anonymously or publicly accessible
- NIST SP 800-53 AC-6 Least Privilege
- https://www.iso.org/iso-27001-information-security.html
