rule_id: gcp.bigquery.table.datalake_version_immutability_enforced
service: bigquery
resource: table
requirement: Datalake Version Immutability Enforced
scope: bigquery.table.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Enforce Immutability for BigQuery Table Versions
rationale: Enforcing immutability on BigQuery table versions ensures data integrity
  and prevents unauthorized or accidental modifications. This is crucial for maintaining
  data trustworthiness, supporting forensic investigations, and complying with regulations
  such as GDPR and HIPAA, which mandate stringent data protection and privacy measures.
description: This rule checks if BigQuery tables have immutability enforced on their
  versions to prevent changes post-creation. Immutability can be achieved by configuring
  appropriate access controls and using table snapshots. To verify, ensure that table
  access policies restrict editing permissions and that table snapshots are used for
  historical data. Remediation involves reviewing IAM roles and permissions and setting
  up a regular snapshot schedule to preserve data states.
references:
- https://cloud.google.com/bigquery/docs/managing-table-snapshots
- https://cloud.google.com/iam/docs/understanding-service-accounts
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.nist.gov/cyberframework
- https://documentation.compliance.io/gdpr-overview
- https://cloud.google.com/security/compliance
