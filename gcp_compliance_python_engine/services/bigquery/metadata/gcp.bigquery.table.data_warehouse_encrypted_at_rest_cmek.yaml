rule_id: gcp.bigquery.table.data_warehouse_encrypted_at_rest_cmek
service: bigquery
resource: table
requirement: Data Warehouse Encrypted At Rest Cmek
scope: bigquery.table.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure BigQuery Tables Use CMEK for Data Encryption at Rest
rationale: Encrypting BigQuery data at rest with Customer-Managed Encryption Keys
  (CMEK) provides enhanced security by allowing control over cryptographic keys, thus
  protecting sensitive data against unauthorized access. This approach mitigates risks
  associated with data breaches and non-compliance with data protection regulations
  like GDPR and HIPAA, which mandate stringent encryption standards.
description: This rule checks if BigQuery tables are encrypted using Customer-Managed
  Encryption Keys (CMEK) rather than Google-managed keys. To verify, inspect the table
  metadata for the encryption configuration. If not using CMEK, update the table settings
  to specify a CMEK, ensuring the key is stored in Cloud Key Management Service (KMS).
  This action enhances data security by giving organizations full control over encryption
  keys, including rotation and access permissions.
references:
- https://cloud.google.com/bigquery/docs/encryption-at-rest
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/kms/docs/cmek
- https://cloud.google.com/bigquery/docs/reference/rest/v2/tables
