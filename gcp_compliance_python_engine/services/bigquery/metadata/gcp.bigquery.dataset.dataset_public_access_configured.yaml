rule_id: gcp.bigquery.dataset.dataset_public_access_configured
service: bigquery
resource: dataset
requirement: Dataset Public Access Configured
scope: bigquery.dataset.public_access
domain: identity_and_access_management
subcategory: authentication
severity: critical
title: Ensure BigQuery Datasets Are Not Publicly Accessible
rationale: Public access to BigQuery datasets poses significant security risks, including
  unauthorized data exposure and potential data breaches. This can lead to non-compliance
  with data protection regulations such as GDPR and CCPA, resulting in financial penalties
  and damage to organizational reputation. Protecting datasets by restricting public
  access helps mitigate these risks and safeguard sensitive information.
description: This rule checks for datasets in BigQuery that are configured with public
  access, meaning any user on the internet can access the data without authentication.
  Verify that the dataset's permissions do not include 'allUsers' or 'allAuthenticatedUsers'
  roles, which grant public access. To remediate, update the IAM policy of the dataset
  to remove these roles and ensure access is limited to authorized users only. This
  can be done via the Google Cloud Console, gcloud command-line tool, or the BigQuery
  API.
references:
- https://cloud.google.com/bigquery/docs/access-control
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/iam/docs/overview
- https://cloud.google.com/bigquery/docs/reference/rest/v2/datasets/setIamPolicy
