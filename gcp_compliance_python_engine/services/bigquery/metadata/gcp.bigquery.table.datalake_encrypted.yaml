rule_id: gcp.bigquery.table.datalake_encrypted
service: bigquery
resource: table
requirement: Datalake Encrypted
scope: bigquery.table.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure BigQuery Tables are Encrypted at Rest
rationale: Encrypting BigQuery tables at rest protects sensitive data from unauthorized
  access and potential data breaches. This is crucial for maintaining data confidentiality
  and integrity, especially for organizations handling regulated data. Compliance
  with encryption requirements is necessary for adhering to standards like GDPR, HIPAA,
  and PCI-DSS, reducing legal and financial risks.
description: This rule verifies that all BigQuery tables in the datalake are encrypted
  at rest using Google-managed or customer-managed keys. Ensure that the `encryptionConfiguration`
  property is set appropriately for each table. Remediation involves configuring BigQuery
  to use either Google Cloud's default encryption or specifying a customer-managed
  encryption key (CMEK) through Cloud KMS. Regular audits and updates to key management
  policies are recommended to maintain security posture.
references:
- https://cloud.google.com/bigquery/docs/encryption-at-rest
- https://cloud.google.com/security/compliance/cis#gcp
- https://www.nist.gov/cyberframework
- https://cloud.google.com/security/compliance/hipaa
- https://cloud.google.com/kms/docs
- https://cloud.google.com/bigquery/docs/reference/rest/v2/tables#resource
