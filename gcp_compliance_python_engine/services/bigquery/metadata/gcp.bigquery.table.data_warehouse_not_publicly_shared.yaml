rule_id: gcp.bigquery.table.data_warehouse_not_publicly_shared
service: bigquery
resource: table
requirement: Data Warehouse Not Publicly Shared
scope: bigquery.table.public_access
domain: identity_and_access_management
subcategory: authentication
severity: critical
title: Prevent Public Sharing of BigQuery Data Warehouse Tables
rationale: Publicly shared BigQuery tables can expose sensitive data to unauthorized
  users, increasing the risk of data breaches and non-compliance with privacy regulations
  such as GDPR and CCPA. Limiting access to only authorized personnel helps protect
  sensitive information and maintain data integrity.
description: This rule checks if any BigQuery tables, particularly those used as data
  warehouses, are publicly accessible. Public access can be verified through the IAM
  policy of the table, ensuring that no 'allUsers' or 'allAuthenticatedUsers' roles
  are granted. To remediate, review and update the IAM policy to restrict access to
  necessary users only, removing any public roles.
references:
- https://cloud.google.com/bigquery/docs/access-control
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/iam/docs/overview
