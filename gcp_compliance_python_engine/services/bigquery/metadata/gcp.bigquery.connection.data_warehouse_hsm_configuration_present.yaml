rule_id: gcp.bigquery.connection.data_warehouse_hsm_configuration_present
service: bigquery
resource: connection
requirement: Data Warehouse Hsm Configuration Present
scope: bigquery.connection.configuration_management
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure BigQuery HSM Configuration for Data Warehouse Connections
rationale: Configuring a Hardware Security Module (HSM) for BigQuery connections enhances
  data protection by ensuring that encryption keys are securely stored and managed.
  This reduces the risk of unauthorized data access and helps meet compliance requirements
  for data protection standards such as PCI-DSS and HIPAA, which mandate strong encryption
  measures for sensitive data.
description: This rule checks for the presence of an HSM configuration in BigQuery
  connection settings, ensuring that data is encrypted at rest using keys managed
  by a secure external source. To verify, inspect the BigQuery connection configurations
  to ensure they reference a Cloud HSM key. Remediation involves configuring your
  BigQuery connections to use Cloud HSM for managing encryption keys, which can be
  done via the GCP Console or the gcloud command-line tool.
references:
- https://cloud.google.com/bigquery/docs/encryption-at-rest
- https://cloud.google.com/security/compliance/cis
- https://cloud.google.com/security/compliance
- https://cloud.google.com/hsm/docs
- https://cloud.google.com/bigquery/docs/reference/rest
