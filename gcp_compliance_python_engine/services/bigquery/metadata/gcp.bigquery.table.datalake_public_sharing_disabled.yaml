rule_id: gcp.bigquery.table.datalake_public_sharing_disabled
service: bigquery
resource: table
requirement: Datalake Public Sharing Disabled
scope: bigquery.table.public_access
domain: identity_and_access_management
subcategory: authentication
severity: critical
title: Disable Public Sharing for BigQuery Datalake Tables
rationale: Allowing public sharing of BigQuery tables can lead to unauthorized access
  to sensitive data, resulting in data breaches and regulatory non-compliance. Publicly
  accessible data lakes may expose personally identifiable information (PII) or intellectual
  property, leading to financial and reputational damage. Ensuring data is only accessible
  to authorized users mitigates the risk of data leaks and supports compliance with
  regulations such as GDPR and HIPAA.
description: This rule checks if any BigQuery tables within the datalake are publicly
  accessible, which is a critical security concern. Public access should be explicitly
  disabled by setting the appropriate IAM policies, ensuring that only authorized
  users or service accounts can access the data. To remediate, review table permissions
  and remove 'allUsers' or 'allAuthenticatedUsers' from the IAM policy bindings. Regular
  audits and monitoring should be conducted to prevent unauthorized access.
references:
- https://cloud.google.com/bigquery/docs/security
- https://cloud.google.com/security/compliance/cis#gcp
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/iam/docs/overview
- https://cloud.google.com/security/best-practices/iam
