rule_id: gcp.bigquery.dataset.dataset_cmk_encryption_configured
service: bigquery
resource: dataset
requirement: Dataset CMK Encryption Configured
scope: bigquery.dataset.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure BigQuery Datasets Use Customer-Managed Encryption Keys
rationale: Using Customer-Managed Encryption Keys (CMKs) for BigQuery datasets enhances
  data protection by allowing organizations to control and rotate encryption keys,
  mitigating the risk of unauthorized access. This is especially crucial for sensitive
  data, helping to meet regulatory requirements such as GDPR, HIPAA, and PCI-DSS,
  and protecting against data breaches and insider threats.
description: This rule verifies that BigQuery datasets are configured to use Customer-Managed
  Encryption Keys (CMKs) rather than the default Google-managed keys. To ensure compliance,
  check the dataset settings in the Google Cloud Console or use the bq command-line
  tool to confirm that a CMK is specified. To remediate, create a Cloud KMS key in
  the desired location and update the dataset's encryption settings to use this key.
  This process involves setting the kmsKeyName property in the dataset's encryptionConfiguration.
references:
- https://cloud.google.com/bigquery/docs/encryption-at-rest
- https://cloud.google.com/kms/docs
- CIS Google Cloud Platform Foundation Benchmark v1.3.0 - Section 6.8
- https://cloud.google.com/security/compliance
- https://cloud.google.com/bigquery/docs/reference/rest/v2/datasets#resource
- https://cloud.google.com/kms/docs/rotating-keys
