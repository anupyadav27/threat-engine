rule_id: gcp.bigquery.dataset.datalake_database_policy_least_privilege
service: bigquery
resource: dataset
requirement: Datalake Database Policy Least Privilege
scope: bigquery.dataset.policy_management
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Ensure BigQuery Dataset Policies Enforce Least Privilege
rationale: Implementing the principle of least privilege in BigQuery dataset policies
  minimizes the risk of unauthorized access and data breaches. Over-permissioned roles
  can lead to data exfiltration, unauthorized data manipulation, and compliance violations,
  impacting business continuity and integrity. Compliance with frameworks like NIST
  and HIPAA requires stringent access controls to protect sensitive data.
description: This rule checks that all BigQuery datasets have IAM policies granting
  only the necessary permissions required for specific roles, avoiding broad permissions
  like 'Owner' or overly permissive custom roles. Verify the IAM policies using the
  Google Cloud Console or gcloud CLI to ensure roles are appropriately assigned. Remediation
  involves reviewing and modifying IAM policies to align with least privilege principles,
  creating custom roles if necessary, and regularly auditing permissions.
references:
- https://cloud.google.com/bigquery/docs/access-control
- https://cloud.google.com/security/compliance/cis#gcp
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://cloud.google.com/iam/docs/understanding-roles
- https://cloud.google.com/bigquery/docs/reference/rest/v2/datasets
- https://www.hhs.gov/hipaa/for-professionals/security/index.html
