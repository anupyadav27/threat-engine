rule_id: gcp.bigquery.connection.datalake_credentials_in_secrets_manager
service: bigquery
resource: connection
requirement: Datalake Credentials In Secrets Manager
scope: bigquery.connection.security
domain: secrets_and_key_management
subcategory: key_management
severity: high
title: Store Datalake Credentials Using GCP Secrets Manager
rationale: Storing Datalake credentials directly in code or unprotected environments
  poses significant security risks, including unauthorized data access and potential
  data breaches. By using GCP Secrets Manager, organizations can centrally manage,
  audit, and control access to these sensitive credentials, aligning with compliance
  requirements such as PCI-DSS and ISO 27001.
description: This rule checks that Datalake credentials used in BigQuery connections
  are securely stored in GCP Secrets Manager instead of being hardcoded or stored
  in less secure environments. To verify, review the BigQuery connection settings
  and ensure that any credentials are referenced via Secrets Manager. Remediation
  involves migrating existing credentials to Secrets Manager and updating connection
  configurations to retrieve credentials from there.
references:
- https://cloud.google.com/secret-manager/docs
- https://cloud.google.com/bigquery/docs/reference/rest/v2/ConnectionService
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://www.iso.org/iso-27001-information-security.html
