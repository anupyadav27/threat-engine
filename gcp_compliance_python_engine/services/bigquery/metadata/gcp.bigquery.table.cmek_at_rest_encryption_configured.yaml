rule_id: gcp.bigquery.table.cmek_at_rest_encryption_configured
service: bigquery
resource: table
requirement: Cmek At Rest Encryption Configured
scope: bigquery.table.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure BigQuery Tables Use CMEK for Data Encryption
rationale: Configuring Customer-Managed Encryption Keys (CMEK) for BigQuery tables
  ensures that sensitive data is protected using encryption keys managed by the organization.
  This approach mitigates risks of unauthorized data access and enhances control over
  data encryption policies. It also supports compliance with regulations such as GDPR,
  HIPAA, and PCI-DSS that require stringent data protection measures.
description: This rule verifies that all BigQuery tables are configured to use CMEK
  for encryption at rest. Specifically, it checks if a customer-managed key is specified
  in the table's encryption configuration. To comply, update your table settings to
  reference a Cloud Key Management Service (KMS) key. This can be done via the GCP
  Console, gcloud CLI, or REST API by specifying the appropriate KMS key resource
  ID.
references:
- https://cloud.google.com/bigquery/docs/encryption-at-rest
- https://cloud.google.com/kms/docs
- 'CIS Google Cloud Platform Foundation Benchmark v1.3.0, ID: 8.1'
- 'NIST SP 800-53: SC-13, SC-28'
- 'PCI-DSS v3.2.1: Requirement 3.5'
- https://cloud.google.com/security/compliance
