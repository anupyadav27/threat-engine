rule_id: gcp.bigquery.table.data_analytics_kms_key_policy_least_privilege
service: bigquery
resource: table
requirement: Data Analytics KMS Key Policy Least Privilege
scope: bigquery.table.policy_management
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure BigQuery Table KMS Key Policy Uses Least Privilege
rationale: Implementing the least privilege principle for KMS key policies in BigQuery
  ensures that only authorized users have access to decrypt data, reducing the risk
  of data breaches. This is crucial for complying with data protection regulations
  like GDPR and CCPA, and for safeguarding sensitive business information from unauthorized
  access or misuse.
description: This rule checks that BigQuery tables encrypted with Customer-Managed
  Encryption Keys (CMEK) have KMS key policies granting minimal access only to necessary
  identities. Verify that the IAM policy on the KMS key does not include overly broad
  roles, such as roles/cloudkms.admin. Remediation involves reviewing the KMS key
  IAM policy, ensuring only specific roles like roles/cloudkms.cryptoKeyEncrypterDecrypter
  are granted to trusted identities, and removing unnecessary permissions.
references:
- https://cloud.google.com/bigquery/docs/encryption-at-rest
- https://cloud.google.com/iam/docs/understanding-roles
- https://cloud.google.com/security/compliance/cis-benchmarks
- https://cloud.google.com/security/compliance
