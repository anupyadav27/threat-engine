rule_id: gcp.bigquery.dataset.data_warehouse_cluster_encryption_at_rest_cmek
service: bigquery
resource: dataset
requirement: Data Warehouse Cluster Encryption At Rest Cmek
scope: bigquery.dataset.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure BigQuery Dataset Uses CMEK for Encryption at Rest
rationale: Using Customer-Managed Encryption Keys (CMEK) for encrypting BigQuery datasets
  at rest enhances data security by allowing organizations to have full control over
  their encryption keys. This reduces the risk of unauthorized data access and can
  help meet regulatory requirements such as GDPR and HIPAA, which mandate stringent
  data protection measures.
description: This rule checks if BigQuery datasets are encrypted with Customer-Managed
  Encryption Keys (CMEK) instead of Google-managed keys. To verify, ensure that the
  'encryptionConfiguration' field is set with a valid 'kmsKeyName' in the dataset's
  configuration. If not configured, update the dataset settings to use a key from
  Google Cloud KMS to enable CMEK. This ensures that datasets are protected with keys
  managed by your organization, offering an additional layer of security.
references:
- https://cloud.google.com/bigquery/docs/encryption-at-rest
- https://cloud.google.com/kms/docs/cmek
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance/gdpr
- https://cloud.google.com/security/compliance/hipaa
- https://cloud.google.com/security/encryption-at-rest/default-encryption
