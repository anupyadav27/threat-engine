rule_id: gcp.bigquery.dataset.datalake_database_cross_account_sharing_restricted
service: bigquery
resource: dataset
requirement: Datalake Database Cross Account Sharing Restricted
scope: bigquery.dataset.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Restrict Cross-Account BigQuery Dataset Sharing
rationale: Restricting cross-account sharing of BigQuery datasets helps prevent unauthorized
  access to sensitive data, mitigating risks of data breaches and ensuring compliance
  with privacy laws such as GDPR and CCPA. It also protects intellectual property
  by limiting data access to trusted entities within the organization, reducing the
  attack surface.
description: This rule checks if BigQuery datasets are being shared with accounts
  outside the organization's domain. By ensuring datasets are only shared internally,
  organizations can protect data from unauthorized access. Verify by reviewing dataset
  IAM policies and ensure external accounts are not granted roles. Remediate by removing
  any permissions granted to external accounts and regularly auditing access controls.
references:
- https://cloud.google.com/bigquery/docs/access-control
- https://cloud.google.com/security/compliance/cis-benchmarks
- https://cloud.google.com/security/compliance/gdpr
- https://cloud.google.com/security/compliance/ccpa
