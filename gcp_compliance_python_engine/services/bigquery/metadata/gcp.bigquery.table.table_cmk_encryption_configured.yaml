rule_id: gcp.bigquery.table.table_cmk_encryption_configured
service: bigquery
resource: table
requirement: Table CMK Encryption Configured
scope: bigquery.table.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure BigQuery Tables Use Customer-Managed Keys (CMK) for Encryption
rationale: Using Customer-Managed Keys (CMK) for BigQuery table encryption ensures
  that organizations maintain control over encryption keys, thereby reducing the risk
  of unauthorized data access. This approach aligns with data protection regulations
  such as GDPR and CCPA, which necessitate strict control over data security and privacy.
  Additionally, CMK provides an additional layer of security against potential insider
  threats and supports forensic investigations.
description: This rule verifies that BigQuery tables are encrypted using Customer-Managed
  Keys (CMK) instead of the default Google-managed keys. To ensure compliance, configure
  the BigQuery table to use a Cloud Key Management Service (KMS) key by specifying
  the 'encryptionConfiguration.kmsKeyName' property. Remediation involves updating
  table settings to include a specific KMS key for encryption, which can be done via
  the GCP Console or gcloud command-line tool. Regular audits should be conducted
  to ensure ongoing compliance with this encryption policy.
references:
- https://cloud.google.com/bigquery/docs/encryption-at-rest
- https://cloud.google.com/security/compliance/cis-benchmarks
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
- https://cloud.google.com/kms/docs/key-rotation
- https://cloud.google.com/security/encryption-at-rest/default-encryption
