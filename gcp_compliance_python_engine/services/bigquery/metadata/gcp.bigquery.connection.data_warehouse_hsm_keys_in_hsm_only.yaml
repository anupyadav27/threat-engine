rule_id: gcp.bigquery.connection.data_warehouse_hsm_keys_in_hsm_only
service: bigquery
resource: connection
requirement: Data Warehouse Hsm Keys In Hsm Only
scope: bigquery.connection.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure HSM-Only Storage for BigQuery HSM Keys
rationale: Storing HSM keys securely in HSMs is critical to prevent unauthorized access
  and ensure that cryptographic operations are performed in a tamper-resistant environment.
  This reduces the risk of data breaches and supports compliance with data protection
  regulations like PCI-DSS and HIPAA, which mandate strong encryption management practices.
description: This rule checks whether BigQuery connections are configured to use HSM-stored
  keys exclusively for encryption at rest. Verify that all relevant BigQuery configurations
  utilize Cloud HSM for key management by inspecting the key ring and key location
  settings in your GCP project. Remediation involves updating BigQuery connections
  to point to HSM-stored keys in Cloud KMS, ensuring that encryption keys never leave
  the secure boundaries of the HSM.
references:
- https://cloud.google.com/bigquery/docs/encryption-at-rest
- https://cloud.google.com/kms/docs/hsm
- https://www.pcisecuritystandards.org/pci_security/
- https://www.hipaajournal.com/hipaa-encryption-requirements/
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt3r1.pdf
