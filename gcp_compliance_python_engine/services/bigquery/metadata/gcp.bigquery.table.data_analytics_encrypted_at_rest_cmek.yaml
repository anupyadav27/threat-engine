rule_id: gcp.bigquery.table.data_analytics_encrypted_at_rest_cmek
service: bigquery
resource: table
requirement: Data Analytics Encrypted At Rest Cmek
scope: bigquery.table.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure BigQuery Tables Use CMEK for Data Encryption at Rest
rationale: Encrypting data at rest using Customer-Managed Encryption Keys (CMEK) in
  BigQuery enhances data security by allowing organizations to control the encryption
  keys, reducing the risk of unauthorized data access. This is crucial for protecting
  sensitive analytics data against potential threats and complying with strict regulatory
  requirements such as GDPR, HIPAA, and PCI-DSS, which mandate strong data protection
  measures.
description: This rule checks if BigQuery tables are encrypted at rest using CMEK
  instead of Google-managed keys. To verify, ensure that the 'encryptionConfiguration'
  property of a BigQuery table includes a valid KMS key reference. Remediation involves
  configuring BigQuery table settings to specify a CMEK by setting the 'kmsKeyName'
  parameter. This process not only enhances data security but also provides compliance
  with regulatory standards requiring encryption at rest.
references:
- https://cloud.google.com/bigquery/docs/encryption-at-rest
- https://cloud.google.com/security/compliance
- https://cloud.google.com/kms/docs/cmek
- CIS Google Cloud Platform Foundation Benchmark v1.3.0 - Section 7.2
- NIST SP 800-53 Rev. 5 - SC-13 Cryptographic Protection
- 'PCI-DSS v3.2.1 - Requirement 3: Protect Stored Cardholder Data'
