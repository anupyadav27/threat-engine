rule_id: gcp.bigquery.dataset.data_analytics_workgroup_query_result_encryption_enabled
service: bigquery
resource: dataset
requirement: Data Analytics Workgroup Query Result Encryption Enabled
scope: bigquery.dataset.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure BigQuery Query Result Encryption for Data Analytics
rationale: Encrypting query results at rest protects sensitive data from unauthorized
  access, minimizing the risk of data breaches and ensuring compliance with data protection
  regulations such as GDPR and HIPAA. Without encryption, query results may be exposed
  to internal and external threats, potentially leading to significant financial and
  reputational damage.
description: This rule checks that BigQuery datasets used by data analytics workgroups
  have query result encryption enabled, using either Google-managed or customer-managed
  encryption keys (CMEK). To verify, ensure that datasets are configured with the
  'encryptionConfiguration.kmsKeyName' property set. Remediation involves updating
  the dataset's encryption settings through the GCP Console or gcloud command-line
  tool by specifying a valid KMS key.
references:
- https://cloud.google.com/bigquery/docs/encryption
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/security/compliance
