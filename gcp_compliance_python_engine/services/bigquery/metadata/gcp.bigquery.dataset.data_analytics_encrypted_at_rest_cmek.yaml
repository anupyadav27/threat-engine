rule_id: gcp.bigquery.dataset.data_analytics_encrypted_at_rest_cmek
service: bigquery
resource: dataset
requirement: Data Analytics Encrypted At Rest Cmek
scope: bigquery.dataset.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure BigQuery Datasets Use CMEK for Encryption at Rest
rationale: Encrypting BigQuery datasets with Customer-Managed Encryption Keys (CMEK)
  at rest enhances data security by providing greater control over encryption keys.
  This reduces the risk of unauthorized access and meets compliance requirements for
  data protection, such as those in GDPR, HIPAA, and other frameworks. It helps safeguard
  sensitive data from potential breaches and insider threats.
description: This rule checks if BigQuery datasets are encrypted using CMEK, offering
  stronger security by allowing customers to manage and rotate their own encryption
  keys. Verify that CMEK is configured by checking the dataset's encryption configuration
  settings in the GCP Console or via the `bq` command-line tool. To remediate, update
  the dataset to use a CMEK by applying a key from Cloud Key Management Service (KMS)
  and ensure that the necessary IAM permissions are granted to BigQuery to use the
  key.
references:
- https://cloud.google.com/bigquery/docs/encryption-at-rest
- https://cloud.google.com/security/compliance
- https://cloud.google.com/kms/docs/cmek
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
- https://www.iso.org/iso-27001-information-security.html
