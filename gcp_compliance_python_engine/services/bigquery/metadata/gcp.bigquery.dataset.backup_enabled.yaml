rule_id: gcp.bigquery.dataset.backup_enabled
service: bigquery
resource: dataset
requirement: Backup Enabled
scope: bigquery.dataset.backup_recovery
domain: resilience_and_disaster_recovery
subcategory: backup_configuration
severity: medium
title: Ensure BigQuery Datasets Have Backup and Recovery Configured
rationale: Enabling backups for BigQuery datasets is crucial for data resilience and
  disaster recovery. In the event of accidental data deletion or corruption, maintaining
  up-to-date backups enables quick restoration of data, minimizing business disruption.
  Non-compliance with data protection regulations like GDPR or HIPAA can result in
  significant legal and financial penalties.
description: This rule verifies that BigQuery datasets have an appropriate backup
  and recovery configuration. It checks for the presence of mechanisms such as scheduled
  exports to Google Cloud Storage or Data Transfer Service for automated backups.
  To remediate, configure regular data exports to a secure storage location, ensuring
  backup integrity and accessibility. Verify the backup settings through the GCP Console
  or by using command-line tools like 'bq' to ensure that backup procedures are active
  and properly configured.
references:
- https://cloud.google.com/bigquery/docs/managing-tables#copying_a_table
- https://cloud.google.com/bigquery/docs/reference/rest/v2/tables#resource
- CIS Google Cloud Platform Foundation Benchmark v1.3.0, Section 5.2
- 'NIST SP 800-53 Rev. 5 CP-9: Information System Backup'
- 'PCI-DSS Requirement 9.5.1: Protect stored cardholder data'
- https://cloud.google.com/solutions/bigquery-data-transfer-service
