rule_id: gcp.bigquery.routine.data_warehouse_group_logging_enabled_where_supported
service: bigquery
resource: routine
requirement: Data Warehouse Group Logging Enabled Where Supported
scope: bigquery.routine.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: medium
title: Enable Logging for BigQuery Routines in Data Warehouse Group
rationale: Enabling logging for BigQuery routines is crucial for monitoring and auditing
  data access and manipulation activities. This helps identify unauthorized access
  or malicious activities, ensuring data integrity and supporting compliance with
  regulations like GDPR and CCPA. Without logging, detecting anomalies or tracing
  data breaches becomes challenging, increasing the risk of data loss and non-compliance
  fines.
description: This rule checks whether logging is enabled for BigQuery routines within
  the data warehouse group. To verify, ensure audit logging is configured for all
  relevant BigQuery datasets and projects. If not enabled, configure audit logs by
  setting up Google Cloud's Audit Logs for BigQuery to capture Data Access logs. This
  involves enabling the BigQuery Data Access logs in Google Cloud Logging under the
  project's IAM & Admin section.
references:
- https://cloud.google.com/bigquery/docs/reference/auditlogs
- https://cloud.google.com/security/compliance/cis/gcp
- https://cloud.google.com/security/compliance
- https://cloud.google.com/logging/docs/audit
