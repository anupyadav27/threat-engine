rule_id: gcp.bigquery.connection.data_warehouse_endpoint_authz_no_anonymous_access
service: bigquery
resource: connection
requirement: Data Warehouse Endpoint Authz No Anonymous Access
scope: bigquery.connection.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Prevent Anonymous Access to BigQuery Connection Endpoints
rationale: Allowing anonymous access to BigQuery connection endpoints can lead to
  unauthorized data retrieval or manipulation, posing significant risks to data confidentiality
  and integrity. This can result in non-compliance with regulations like GDPR and
  HIPAA, and expose organizations to potential data breaches, financial penalties,
  and reputational damage.
description: This rule checks if BigQuery connection endpoints are configured to prevent
  anonymous access by ensuring authorization is required for all connections. To verify,
  ensure that all connection endpoints have IAM policies granting access only to authenticated
  users with appropriate roles. Remediation involves reviewing and updating IAM policies
  to restrict access to authorized identities only, removing any wildcard ('allUsers'
  or 'allAuthenticatedUsers') permissions.
references:
- https://cloud.google.com/bigquery/docs/reference/rest/v2/projects.connections
- https://cloud.google.com/security/compliance/cis#gcp
- https://www.nist.gov/cyberframework
- https://cloud.google.com/docs/enterprise/best-practices-for-identity-and-access-management#restrict-usage
