rule_id: gcp.bigquery.connection.data_warehouse_endpoint_authz_rbac_least_privilege
service: bigquery
resource: connection
requirement: Data Warehouse Endpoint Authz RBAC Least Privilege
scope: bigquery.connection.authorization
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Ensure BigQuery Endpoint Uses RBAC with Least Privilege
rationale: Implementing RBAC with the principle of least privilege on BigQuery connections
  minimizes the risk of unauthorized data access and potential data breaches. This
  approach helps organizations comply with regulatory standards and reduces the attack
  surface by limiting permissions to only those necessary for specific roles. Ensuring
  least privilege is critical in environments where sensitive data is processed or
  stored, aligning with security best practices and compliance mandates.
description: This rule checks that all BigQuery connection endpoints enforce Role-Based
  Access Control (RBAC) with the principle of least privilege. Verify that roles assigned
  to users or service accounts have only the necessary permissions required for their
  specific tasks. Remediation involves reviewing current roles and permissions, removing
  any excessive access rights, and utilizing predefined roles where applicable to
  enforce strict access controls.
references:
- https://cloud.google.com/bigquery/docs/reference/rest/v2/ConnectionService
- https://cloud.google.com/iam/docs/understanding-roles
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- https://cloud.google.com/security/compliance
