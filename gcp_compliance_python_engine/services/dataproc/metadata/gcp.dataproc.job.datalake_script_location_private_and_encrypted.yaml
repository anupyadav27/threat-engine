rule_id: gcp.dataproc.job.datalake_script_location_private_and_encrypted
service: dataproc
resource: job
requirement: Datalake Script Location Private And Encrypted
scope: dataproc.job.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Dataproc Script Locations are Private and Encrypted
rationale: Storing Dataproc job scripts in non-private or unencrypted locations exposes
  sensitive data and intellectual property to unauthorized access. This can lead to
  data breaches, financial loss, and non-compliance with regulatory standards such
  as PCI-DSS and HIPAA. Ensuring scripts are private and encrypted mitigates these
  risks by protecting data at rest and maintaining confidentiality.
description: This rule checks that Dataproc job scripts are stored in Google Cloud
  Storage buckets configured with access controls that restrict public access and
  enforce encryption. Verify that the bucket's 'Public access prevention' setting
  is enabled and that 'Default encryption' uses a customer-managed encryption key
  (CMEK). Remediate by updating bucket permissions to remove public access and configure
  encryption using CMEK to enhance data protection.
references:
- https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/security#encryption
- https://cloud.google.com/storage/docs/encryption
- https://www.cisecurity.org/controls/cis-google-cloud-computing-foundations-benchmark
- https://cloud.google.com/security/compliance
- https://cloud.google.com/security/encryption-at-rest/default-encryption/
