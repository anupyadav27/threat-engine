rule_id: gcp.dataproc.cluster.datalake_dev_endpoint_role_least_privilege
service: dataproc
resource: cluster
requirement: Datalake Dev Endpoint Role Least Privilege
scope: dataproc.cluster.least_privilege
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Ensure Dataproc Cluster Dev Endpoints Use Least Privilege Roles
rationale: Assigning excessive permissions to Dataproc clusters can lead to unauthorized
  access and data exfiltration, compromising sensitive data and violating compliance
  frameworks such as PCI-DSS and HIPAA. By adhering to the principle of least privilege,
  organizations minimize potential attack vectors and reduce the risk of privilege
  escalation.
description: This rule checks that Dataproc clusters used for development purposes
  in a data lake environment have the least privilege roles assigned. Verify that
  IAM roles associated with the clusters do not grant permissions beyond what is necessary
  for their specific tasks. Remediation involves auditing current IAM policies, removing
  superfluous permissions, and assigning roles that follow the principle of least
  privilege. Regularly review and update IAM policies to ensure compliance with security
  best practices.
references:
- https://cloud.google.com/dataproc/docs/concepts/iam
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://cloud.google.com/security/compliance
- https://cloud.google.com/iam/docs/understanding-service-accounts
- https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/security
