rule_id: gcp.dataproc.job.datalake_role_least_privilege
service: dataproc
resource: job
requirement: Datalake Role Least Privilege
scope: dataproc.job.least_privilege
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Ensure Dataproc Job Uses Least Privilege Role
rationale: Applying the principle of least privilege minimizes the potential attack
  surface by ensuring that Dataproc jobs only have the permissions necessary to perform
  their tasks. This reduces the risk of accidental or malicious activity that can
  lead to data breaches or unauthorized access, aligning with compliance standards
  such as PCI-DSS and ISO 27001.
description: This rule checks if Dataproc jobs are assigned roles with the minimum
  necessary permissions in Google Cloud IAM. To verify, audit the roles assigned to
  Dataproc jobs for excessive permissions. Remediation involves reviewing and updating
  IAM roles to match the specific needs of the job while removing unnecessary permissions.
  This can be achieved by customizing predefined roles or creating custom roles tailored
  to job requirements.
references:
- https://cloud.google.com/dataproc/docs/concepts/iam
- https://cloud.google.com/iam/docs/understanding-roles
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://www.pcisecuritystandards.org/
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/security/best-practices/iam
