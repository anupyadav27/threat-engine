rule_id: gcp.dataproc.workflow_template.datalake_cross_account_trusts_restricted
service: dataproc
resource: workflow_template
requirement: Datalake Cross Account Trusts Restricted
scope: dataproc.workflow_template.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Restrict Cross-Account Trusts in Dataproc Workflow Templates
rationale: Restricting cross-account trusts in Dataproc workflow templates is critical
  to prevent unauthorized access and potential data breaches. Cross-account access
  can expose sensitive data and resources to entities outside your organization, increasing
  the risk of data exfiltration and non-compliance with regulations such as GDPR and
  CCPA. Properly managing these trusts ensures that only authorized accounts can access
  and operate on your data lakes, maintaining data integrity and privacy.
description: This rule verifies that Dataproc workflow templates do not permit cross-account
  trusts unless explicitly required and securely managed. It checks the IAM policies
  associated with the workflow templates to ensure that no external accounts have
  been granted unnecessary permissions. To remediate, review and update IAM policies
  to limit access to internal accounts only, and establish cross-account roles with
  the least privilege principle if external access is necessary. Regular audits and
  monitoring should be conducted to maintain compliance.
references:
- https://cloud.google.com/dataproc/docs/concepts/workflows/using-workflows
- https://cloud.google.com/iam/docs/overview
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://cloud.google.com/security/compliance
- https://cloud.google.com/security/best-practices
- https://cloud.google.com/iam/docs/using-iam-securely
