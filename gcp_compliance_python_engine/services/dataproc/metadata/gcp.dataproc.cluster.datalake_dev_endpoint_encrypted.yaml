rule_id: gcp.dataproc.cluster.datalake_dev_endpoint_encrypted
service: dataproc
resource: cluster
requirement: Datalake Dev Endpoint Encrypted
scope: dataproc.cluster.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Dataproc Cluster Datalake Endpoint is Encrypted
rationale: Encryption of data at rest is crucial for protecting sensitive information
  stored in Dataproc clusters. Without encryption, data is vulnerable to unauthorized
  access, which could lead to data breaches, financial loss, and non-compliance with
  regulations like GDPR and HIPAA. Encrypted endpoints help mitigate risks related
  to data exposure and enhance the overall security posture of your cloud environment.
description: This rule checks whether Dataproc clusters have encryption enabled for
  Datalake endpoints. To ensure data protection, configure your clusters to use customer-managed
  encryption keys (CMEK) or Google-managed keys for all data at rest. Verify this
  setting via the Google Cloud Console under the 'Clusters' section by ensuring the
  'Encryption' field is properly set. If not configured, update the cluster settings
  to enable encryption, thereby securing the data against unauthorized access.
references:
- https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/encryption
- https://cloud.google.com/security/compliance/cis-gcp-benchmarks
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/security/encryption-at-rest/default-encryption
- https://cloud.google.com/kms/docs/cmek
