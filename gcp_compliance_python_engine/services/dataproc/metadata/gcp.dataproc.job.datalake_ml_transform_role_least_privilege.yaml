rule_id: gcp.dataproc.job.datalake_ml_transform_role_least_privilege
service: dataproc
resource: job
requirement: Datalake Ml Transform Role Least Privilege
scope: dataproc.job.least_privilege
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Ensure Least Privilege for Dataproc Datalake ML Transform Role
rationale: Implementing least privilege access for Dataproc jobs minimizes the risk
  of unauthorized data access and potential data breaches. By restricting permissions
  to the minimum necessary, organizations reduce their exposure to threats, meet compliance
  mandates such as GDPR, and protect sensitive data from internal and external threats.
description: This rule checks that Dataproc jobs using the Datalake ML Transform Role
  do not have excessive permissions beyond what is necessary for their function. Verify
  that IAM policies grant only essential permissions. Remediation involves auditing
  current role assignments, using predefined roles where possible, and customizing
  roles to remove unnecessary permissions.
references:
- https://cloud.google.com/dataproc/docs/concepts/iam
- https://cloud.google.com/iam/docs/understanding-roles
- CIS GCP Benchmark v1.3.0, Section 4.6
- NIST SP 800-53 Rev. 5 AC-6 Least Privilege
- https://cloud.google.com/security/compliance/gdpr
- https://cloud.google.com/security/best-practices/iam
