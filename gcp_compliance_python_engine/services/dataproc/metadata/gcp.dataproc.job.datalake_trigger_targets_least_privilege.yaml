rule_id: gcp.dataproc.job.datalake_trigger_targets_least_privilege
service: dataproc
resource: job
requirement: Datalake Trigger Targets Least Privilege
scope: dataproc.job.least_privilege
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Ensure Dataproc Jobs Use Least Privilege Principle for Datalake Access
rationale: Applying the least privilege principle to Dataproc jobs minimizes the risk
  of unauthorized access to sensitive data within a datalake, reducing potential data
  breaches and ensuring compliance with data protection regulations such as GDPR and
  CCPA. Ensuring that jobs have only the permissions necessary to perform their tasks
  mitigates the risk of privilege escalation and unauthorized data manipulation or
  exfiltration.
description: This rule checks that Dataproc jobs accessing a datalake are configured
  with the minimum required permissions. It involves verifying IAM roles associated
  with service accounts used by these jobs to ensure they do not exceed necessary
  access levels. Remediation includes auditing the roles assigned to these service
  accounts and adjusting permissions to align with the least privilege model. This
  can be done by reviewing and modifying IAM policy bindings for Dataproc job service
  accounts to restrict over-privileged permissions.
references:
- https://cloud.google.com/dataproc/docs/concepts/iam
- https://cloud.google.com/iam/docs/understanding-service-accounts
- https://cloud.google.com/security/compliance/cis-gcp-foundations-benchmark
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r3.pdf
- https://cloud.google.com/security/overview/whitepaper
- https://pages.nist.gov/800-63-3/
