rule_id: gcp.dataproc.workflow_template.datalake_kms_encryption_enabled
service: dataproc
resource: workflow_template
requirement: Datalake KMS Encryption Enabled
scope: dataproc.workflow_template.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure KMS Encryption for Dataproc Workflow Templates
rationale: Enabling KMS encryption for Dataproc workflow templates is crucial for
  protecting sensitive data processed in data lakes. Without encryption, data at rest
  is vulnerable to unauthorized access, potentially leading to data breaches and non-compliance
  with regulations such as GDPR and HIPAA. Encrypting data at rest helps mitigate
  risks associated with insider threats and external attacks.
description: This rule checks if Google Cloud Key Management Service (KMS) encryption
  is enabled for Dataproc workflow templates, ensuring data at rest within the data
  lake is encrypted. To verify, check the 'encryptionConfig' field in the workflow
  template configuration. If not set, configure the workflow templates to use a KMS
  key by specifying it in the 'encryptionConfig' section. This configuration ensures
  that all data processed by the workflow templates is encrypted at rest using a customer-managed
  key.
references:
- https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/kms
- https://cloud.google.com/security/compliance/cis#gcp
- https://www.iso.org/standard/54534.html
- https://cloud.google.com/security/encryption-at-rest/default-encryption
