rule_id: gcp.dataproc.cluster.data_analytics_subnet_group_private_subnets_only
service: dataproc
resource: cluster
requirement: Data Analytics Subnet Group Private Subnets Only
scope: dataproc.cluster.private_networking
domain: network_security_and_connectivity
subcategory: network_access_control
severity: low
title: Enforce Private Subnets for Dataproc Cluster Networking
rationale: Ensuring that Dataproc clusters operate within private subnets minimizes
  exposure to public internet threats, thereby reducing the risk of unauthorized access
  and data breaches. This control helps meet privacy and security requirements crucial
  for compliance with regulations such as PCI-DSS and GDPR, protecting sensitive data
  processed and analyzed by Dataproc clusters.
description: This rule checks if Dataproc clusters are configured to use subnets that
  are restricted to private IP addresses only. To verify, ensure that the 'enablePrivateEndpoint'
  setting is true within the cluster's network configuration. This setting prevents
  the cluster's nodes from obtaining public IP addresses, thereby restricting inbound
  and outbound traffic to internal network paths only. Remediation involves updating
  the cluster configuration to enable private subnet usage, which can be accomplished
  through the GCP Console or gcloud CLI.
references:
- https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/network
- https://cloud.google.com/security/compliance/cis-gcp-benchmark
- https://cloud.google.com/security/compliance
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
