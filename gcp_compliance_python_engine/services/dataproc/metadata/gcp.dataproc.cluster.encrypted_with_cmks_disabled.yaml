rule_id: gcp.dataproc.cluster.encrypted_with_cmks_disabled
service: dataproc
resource: cluster
requirement: Encrypted With Cmks Disabled
scope: dataproc.cluster.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Dataproc Clusters Use CMKs for Encryption
rationale: Using Customer-Managed Encryption Keys (CMKs) for Dataproc clusters enhances
  data protection by giving organizations full control over the encryption keys, which
  can mitigate risks related to unauthorized data access and satisfy regulatory compliance
  requirements. Failure to use CMKs can expose sensitive data to unauthorized access
  and may lead to non-compliance with data protection laws such as GDPR and industry
  standards like PCI-DSS.
description: This rule checks if Google Cloud Dataproc clusters are using Customer-Managed
  Encryption Keys (CMKs) for encryption at rest. To comply with this rule, configure
  the Dataproc clusters to use a CMK from Cloud Key Management Service (Cloud KMS)
  during cluster creation. Verifying compliance involves checking the cluster's encryption
  configuration in the Google Cloud Console or using the gcloud command-line tool.
  Remediation involves updating the cluster configuration to specify a CMK from Cloud
  KMS.
references:
- https://cloud.google.com/dataproc/docs/guides/encryption
- https://cloud.google.com/security/compliance/cis#gcp_cis_benchmark
- https://cloud.google.com/security/compliance/iso-27001
- https://cloud.google.com/kms/docs/key-rotation
