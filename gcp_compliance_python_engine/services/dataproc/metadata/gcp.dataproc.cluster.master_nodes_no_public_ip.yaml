rule_id: gcp.dataproc.cluster.master_nodes_no_public_ip
service: dataproc
resource: cluster
requirement: Master Nodes No Public Ip
scope: dataproc.cluster.public_access
domain: identity_and_access_management
subcategory: authentication
severity: critical
title: Ensure Dataproc Master Nodes Don't Have Public IPs
rationale: Public IPs on Dataproc master nodes expose critical infrastructure to the
  internet, increasing the risk of unauthorized access and potential data breaches.
  This can lead to significant business disruptions and non-compliance with regulatory
  mandates such as PCI-DSS and HIPAA, which require strict controls on network access.
description: This rule checks that Google Cloud Dataproc clusters are configured such
  that master nodes do not have publicly accessible IP addresses. Ensuring only private
  IPs are used limits exposure to potential threats. Verify by checking the network
  configuration of Dataproc clusters to confirm that master nodes are only accessible
  within a VPC. Remediate by modifying the cluster's network settings to use private
  IPs, or by setting up firewall rules to restrict access.
references:
- https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/network
- https://cloud.google.com/security/compliance/cis-gcp-foundations-benchmark
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf
- https://cloud.google.com/architecture/best-practices-for-enterprise-organizations
- https://cloud.google.com/security/compliance
- https://cloud.google.com/dataproc/docs/guides/dataproc-security
