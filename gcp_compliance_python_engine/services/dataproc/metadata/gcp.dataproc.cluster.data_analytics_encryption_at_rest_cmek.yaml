rule_id: gcp.dataproc.cluster.data_analytics_encryption_at_rest_cmek
service: dataproc
resource: cluster
requirement: Data Analytics Encryption At Rest Cmek
scope: dataproc.cluster.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure Dataproc Clusters Use CMEK for Encryption at Rest
rationale: Using Customer-Managed Encryption Keys (CMEK) for encrypting data at rest
  in Dataproc clusters provides control over encryption keys, enhancing data protection
  and compliance with regulatory standards. Without CMEK, you risk unauthorized data
  access if Google-managed keys are compromised, which can lead to data breaches and
  non-compliance with frameworks like PCI-DSS and HIPAA.
description: This rule checks if Dataproc clusters are configured to use Customer-Managed
  Encryption Keys (CMEK) for encrypting data at rest. To verify, inspect the Dataproc
  cluster settings in the Google Cloud Console or use the gcloud CLI to ensure CMEK
  is enabled. Remediation involves configuring CMEK by creating a Cloud KMS key and
  specifying it in the Dataproc cluster's encryption settings during cluster creation
  or updating existing clusters.
references:
- https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/encryption
- https://cloud.google.com/security/compliance/cis-gcp-foundations-benchmark
- https://cloud.google.com/security/compliance
- https://cloud.google.com/kms/docs/cmek
