rule_id: gcp.dataproc.cluster.data_analytics_audit_logging_enabled
service: dataproc
resource: cluster
requirement: Data Analytics Audit Logging Enabled
scope: dataproc.cluster.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: medium
title: Enable Data Analytics Audit Logging in Dataproc Clusters
rationale: Enabling audit logging for Dataproc clusters is crucial for tracking data
  access and administrative actions, helping to detect unauthorized activities and
  support forensic investigations. This practice supports compliance with regulations
  such as GDPR and CCPA, which mandate detailed logging of data processing activities.
  Without adequate logging, organizations face increased risks of undetected data
  breaches and non-compliance penalties.
description: This rule ensures that audit logging is enabled for Dataproc clusters,
  capturing details of data access and administrative operations. To verify, check
  the cluster's IAM policy to ensure the 'roles/logging.logWriter' role is attached
  to the service account running the cluster. Remediation involves updating the IAM
  policy to include this role, thereby enabling audit logs to be sent to Cloud Logging
  for review and alerting.
references:
- https://cloud.google.com/dataproc/docs/concepts/logging
- https://cloud.google.com/logging/docs/audit
- CIS Google Cloud Platform Foundation Benchmark v1.3.0
- https://cloud.google.com/security/compliance
- 'NIST SP 800-53: AU-2, AU-3'
- ISO/IEC 27001:2013 - A.12.4
