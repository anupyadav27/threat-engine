rule_id: gcp.dataproc.cluster.datalake_dev_endpoint_no_public_access
service: dataproc
resource: cluster
requirement: Datalake Dev Endpoint No Public Access
scope: dataproc.cluster.public_access
domain: network_security_and_connectivity
subcategory: network_access_control
severity: critical
title: Prevent Public Access to Dataproc Dev Endpoints
rationale: Publicly accessible Dataproc dev endpoints can lead to unauthorized data
  access and potential data breaches. This configuration exposes sensitive information
  to external threats, increasing the risk of exploitation and non-compliance with
  regulations such as GDPR and HIPAA. Ensuring private access helps protect business
  assets and maintains customer trust.
description: This rule checks if Dataproc clusters in development environments are
  configured without public IP addresses. Public IPs should be replaced with private
  IPs to restrict access to trusted networks only. Verification involves reviewing
  the cluster's network configuration settings in the GCP Console or via the gcloud
  command-line tool. To remediate, update the cluster's network settings to use private
  IPs and configure firewall rules to limit access to specific IP ranges.
references:
- https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/network
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://cloud.google.com/security/best-practices
