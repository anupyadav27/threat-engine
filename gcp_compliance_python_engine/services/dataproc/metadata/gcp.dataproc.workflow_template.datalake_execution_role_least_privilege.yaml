rule_id: gcp.dataproc.workflow_template.datalake_execution_role_least_privilege
service: dataproc
resource: workflow_template
requirement: Datalake Execution Role Least Privilege
scope: dataproc.workflow_template.least_privilege
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Ensure Least Privilege for Dataproc Execution Role
rationale: Limiting privileges for Dataproc execution roles reduces the risk of unauthorized
  data access and potential data breaches. Over-privileged roles can lead to accidental
  or malicious operations affecting data integrity and confidentiality, posing significant
  business risks and non-compliance with standards like PCI-DSS and SOC2.
description: This rule checks whether Dataproc workflow templates are utilizing roles
  with the least privilege necessary for execution. It ensures that roles are not
  over-privileged by auditing IAM policies associated with the workflow templates.
  Remediation involves reviewing the roles and permissions assigned, ensuring they
  align strictly with the operational requirements of the data lake tasks, and removing
  excess permissions.
references:
- https://cloud.google.com/dataproc/docs/concepts/iam
- https://cloud.google.com/iam/docs/understanding-roles
- https://cloud.google.com/security/compliance/cis-gcp-foundations-benchmark
- https://www.pcisecuritystandards.org/pci_security/
- https://cloud.google.com/docs/security/best-practices-for-enterprise-organizations
- https://www.nist.gov/cyberframework
