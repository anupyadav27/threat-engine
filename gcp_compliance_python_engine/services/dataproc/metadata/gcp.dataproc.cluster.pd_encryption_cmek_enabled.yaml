rule_id: gcp.dataproc.cluster.pd_encryption_cmek_enabled
service: dataproc
resource: cluster
requirement: Pd Encryption Cmek Enabled
scope: dataproc.cluster.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure CMEK is Enabled for Dataproc Clusters
rationale: Enabling Customer-Managed Encryption Keys (CMEK) for Dataproc clusters
  ensures that the encryption keys are managed by the organization, reducing the risk
  of unauthorized access and enhancing control over data encryption. This is crucial
  for complying with regulatory requirements such as GDPR and HIPAA, which mandate
  strict control over encryption keys to protect sensitive data.
description: This rule checks if Dataproc clusters are configured with Customer-Managed
  Encryption Keys (CMEK) for persistent disk (PD) encryption. To verify, ensure that
  the 'gceClusterConfig.diskConfig.bootDiskKmsKeyName' field is specified in the cluster's
  configuration. If not enabled, configure CMEK by specifying a valid KMS key during
  the cluster creation process. This provides enhanced security by allowing organizations
  to manage encryption keys, ensuring data at rest is protected by keys under their
  control.
references:
- https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/customer-managed-encryption
- https://cloud.google.com/security/compliance/cis#gcp
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/kms/docs/cmek
- https://cloud.google.com/security/encryption-at-rest/default-encryption
