rule_id: gcp.dataproc.cluster.data_analytics_private_networking_enforced
service: dataproc
resource: cluster
requirement: Data Analytics Private Networking Enforced
scope: dataproc.cluster.network_security
domain: network_security_and_connectivity
subcategory: network_access_control
severity: medium
title: Enforce Private Networking for Dataproc Clusters
rationale: Enforcing private networking for Dataproc clusters mitigates the risk of
  exposing sensitive data and processing operations to public networks. This configuration
  helps prevent unauthorized access, reduces attack surface, and ensures compliance
  with regulations such as GDPR and HIPAA, which mandate secure data processing environments.
description: This rule checks if Dataproc clusters are configured to use private IP
  addresses instead of public IPs, ensuring that communication occurs within a secure
  VPC. To verify, ensure the 'enablePrivateEndpoint' and 'enablePrivateNodes' fields
  are set to true in the cluster configuration. Remediation involves updating the
  cluster settings to disable public IPs and enabling private networking options.
references:
- https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/network
- https://cloud.google.com/security/compliance
- https://cloud.google.com/architecture/best-practices-vpc-design
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://www.nist.gov/cyberframework
- https://cloud.google.com/security/compliance/gdpr/
