rule_id: gcp.firestore.document.data_protection_storage_table_private_network_only_supported
service: firestore
resource: document
requirement: Data Protection Storage Table Private Network Only Supported
scope: firestore.document.network_security
domain: network_security_and_connectivity
subcategory: network_access_control
severity: medium
title: Restrict Firestore Document Access to Private Networks
rationale: Restricting access to Firestore documents to private networks reduces the
  risk of unauthorized access and data breaches, which are critical concerns for business
  continuity and regulatory compliance. Exposing data to public networks increases
  the attack surface, enabling potential threat actors to exploit vulnerabilities,
  leading to loss of sensitive information and detrimental financial and reputational
  impact.
description: This rule checks that Firestore documents are only accessible via private
  networks, preventing public internet exposure. Verify that your Firestore instance
  is configured with a private IP and restrict access using VPC Service Controls.
  Remediate by setting up private network configurations and firewall rules to limit
  access to trusted internal networks only.
references:
- https://cloud.google.com/firestore/docs/security/rules-structure
- https://cloud.google.com/vpc-service-controls/docs/firestore
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://www.iso.org/iso-27001-information-security.html
