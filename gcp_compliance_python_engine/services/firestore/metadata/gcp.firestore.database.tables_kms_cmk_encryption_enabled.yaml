rule_id: gcp.firestore.database.tables_kms_cmk_encryption_enabled
service: firestore
resource: database
requirement: Tables KMS CMK Encryption Enabled
scope: firestore.database.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure Firestore Tables Use Customer-Managed Encryption Keys
rationale: Using Customer-Managed Encryption Keys (CMK) for Firestore tables enhances
  data security by allowing organizations to control the encryption keys used for
  data at rest. This reduces the risk of unauthorized access and potential data breaches,
  and ensures compliance with regulations like GDPR, which require strong encryption
  and data protection measures.
description: This rule checks whether Firestore tables are encrypted using Google
  Cloud KMS Customer-Managed Keys (CMK). To ensure your Firestore data is encrypted
  with CMK, navigate to the Firestore console, select your database, and verify that
  Customer-Managed Keys are enabled for encryption. If not, configure your Firestore
  instance to use CMK by setting the appropriate encryption key in the Google Cloud
  Console or via the CLI, ensuring that the keys are securely managed and rotated
  regularly.
references:
- https://cloud.google.com/firestore/docs/encryption
- https://cloud.google.com/security/compliance/gdpr
- https://cloud.google.com/kms/docs/how-tos
- https://cloud.google.com/security/encryption-at-rest/default-encryption
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
