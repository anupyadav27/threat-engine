rule_id: gcp.firestore.document.data_protection_storage_table_rbac_least_privilege
service: firestore
resource: document
requirement: Data Protection Storage Table RBAC Least Privilege
scope: firestore.document.authorization
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Ensure Firestore Document RBAC Uses Least Privilege Principle
rationale: Enforcing least privilege in Firestore document access is crucial to minimize
  unauthorized data exposure, reduce the attack surface, and comply with regulatory
  requirements such as GDPR and HIPAA. Improper permissions can lead to data breaches,
  impacting business reputation and incurring financial penalties.
description: This rule checks Firestore document permissions to ensure that access
  is granted strictly based on the principle of least privilege. Review IAM roles
  associated with Firestore documents and verify that only necessary permissions are
  assigned. Use 'roles/firestore.viewer' or custom roles with minimal permissions
  for users requiring read access. Audit and remove any excessive permissions regularly.
references:
- https://cloud.google.com/firestore/docs/security/rules-structure
- https://cloud.google.com/iam/docs/understanding-roles
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://www.iso.org/standard/73906.html
