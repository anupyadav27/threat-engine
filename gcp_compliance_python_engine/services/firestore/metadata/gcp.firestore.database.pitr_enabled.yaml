rule_id: gcp.firestore.database.pitr_enabled
service: firestore
resource: database
requirement: Pitr Enabled
scope: firestore.database.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Enable Point-In-Time Recovery for Firestore Databases
rationale: Point-In-Time Recovery (PITR) for Firestore databases is crucial for protecting
  against accidental data loss, corruption, or malicious attacks that could compromise
  data integrity. Enabling PITR helps ensure business continuity by allowing restoration
  of databases to a specific state at an earlier point in time, which aligns with
  compliance requirements such as GDPR and HIPAA that demand robust data protection
  measures.
description: This rule checks if Point-In-Time Recovery (PITR) is enabled for Firestore
  databases. To verify, ensure that PITR is configured in the Firestore settings within
  the Google Cloud Console, allowing databases to be restored to any state within
  the retention period. Remediation involves enabling PITR through the console, which
  can be done by navigating to the Firestore database settings and activating the
  PITR feature, ensuring the retention period aligns with organizational policies.
references:
- https://cloud.google.com/firestore/docs/manage-data/backups
- https://cloud.google.com/security/compliance/cis
- https://www.nist.gov/cyberframework
- https://www.pcisecuritystandards.org/
- https://www.hipaajournal.com/hipaa-compliance-guide/
- https://www.iso.org/standard/54534.html
