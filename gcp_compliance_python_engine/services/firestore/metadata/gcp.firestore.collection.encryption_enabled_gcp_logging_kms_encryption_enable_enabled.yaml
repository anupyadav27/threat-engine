rule_id: gcp.firestore.collection.encryption_enabled_gcp_logging_kms_encryption_enable_enabled
service: firestore
resource: collection
requirement: Encryption Enabled Gcp Logging KMS Encryption Enable Enabled
scope: firestore.collection.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure Firestore Collections Use KMS for Encryption at Rest
rationale: Encrypting Firestore collections using Cloud KMS protects sensitive data
  from unauthorized access and potential breaches, which can lead to regulatory non-compliance
  and reputational damage. This approach leverages Google Cloud's robust key management
  to enhance data security and meet compliance mandates such as PCI-DSS and HIPAA.
description: This rule checks if Firestore collections are encrypted with a customer-managed
  encryption key (CMEK) via Cloud KMS. To verify, ensure the Firestore collection's
  encryption configuration specifies a valid KMS key. Remediation involves enabling
  CMEK by configuring Firestore to use a Cloud KMS key for data encryption, which
  can be done through the GCP Console or gcloud CLI.
references:
- https://cloud.google.com/firestore/docs/encryption
- https://cloud.google.com/security/compliance/cis#gcp
- https://cloud.google.com/security/compliance
- https://cloud.google.com/kms/docs
- https://cloud.google.com/security/encryption-at-rest/default-encryption
