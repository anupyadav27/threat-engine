rule_id: gcp.firestore.database.tables_pitr_enabled
service: firestore
resource: database
requirement: Tables Pitr Enabled
scope: firestore.database.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Enable Point-in-Time Recovery for Firestore Databases
rationale: Point-in-Time Recovery (PITR) is crucial for mitigating data loss due to
  accidental deletions, corruption, or malicious activities. It ensures business continuity
  and aligns with compliance requirements for data protection, such as GDPR and SOC
  2, by allowing restoration of databases to a specific state in time. Failure to
  enable PITR can lead to significant operational disruptions and legal liabilities.
description: This rule checks if Point-in-Time Recovery is enabled for Google Cloud
  Firestore databases. PITR allows the recovery of a database to a state within a
  specific time window, providing a robust mechanism to protect against data loss.
  To verify, ensure that Firestore databases have PITR configured in the Google Cloud
  Console, under the Firestore settings. Remediation involves enabling PITR in the
  Firestore settings, which can be done by navigating to the Firestore database in
  the Google Cloud Console and configuring the PITR settings under the backup and
  restore options.
references:
- https://cloud.google.com/firestore/docs/backups
- https://cloud.google.com/security/compliance/soc-2
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance/gdpr
- https://cloud.google.com/firestore/docs/manage-data/export-import
