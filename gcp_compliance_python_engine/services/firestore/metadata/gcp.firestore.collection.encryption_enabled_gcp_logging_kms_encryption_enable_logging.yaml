rule_id: gcp.firestore.collection.encryption_enabled_gcp_logging_kms_encryption_enable_logging
service: firestore
resource: collection
requirement: Encryption Enabled Gcp Logging KMS Encryption Enable Logging
scope: firestore.collection.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure Firestore Collections Use KMS for Encryption and Logging
rationale: Enabling encryption for Firestore collections using Cloud KMS and logging
  ensures data is protected against unauthorized access and modification. This helps
  in mitigating risks of data breaches and supports compliance with regulations such
  as GDPR and HIPAA, which mandate robust data protection measures.
description: This rule checks whether Google Cloud Firestore collections are encrypted
  at rest using Customer-Managed Encryption Keys (CMEK) provided by Google Cloud Key
  Management Service (KMS), and whether logging is enabled for these operations. To
  verify, ensure that Firestore collections are configured with CMEK and that Cloud
  Audit Logs are set up to track access and administrative actions. Remediation involves
  configuring Firestore to use a specific KMS key and enabling logging through the
  GCP Console or CLI.
references:
- https://cloud.google.com/firestore/docs/encryption
- https://cloud.google.com/kms/docs
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/logging/docs/audit
- https://cloud.google.com/security/compliance/gdpr
- https://cloud.google.com/security/compliance/hipaa
