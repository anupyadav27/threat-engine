rule_id: gcp.trace.trace.monitoring_retention_days_minimum
service: trace
resource: trace
requirement: Monitoring Retention Days Minimum
scope: trace.trace.monitoring
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: medium
title: Ensure Trace Monitoring Retention Meets Minimum Days
rationale: Retaining trace data for a sufficient period is critical for auditing application
  behavior, detecting anomalies, and meeting compliance requirements. Insufficient
  retention can hinder incident investigation and compromise the ability to identify
  long-term trends or threats, potentially leading to non-compliance with regulatory
  frameworks like PCI-DSS or SOC 2.
description: This rule checks that Google Cloud Trace data retention is configured
  to meet a minimum threshold of days, ensuring adequate historical data is available
  for analysis. Verify the retention period by reviewing the Stackdriver Trace settings
  in the GCP Console under 'Monitoring' and 'Trace'. To remediate, adjust the retention
  settings to meet the minimum required days through the console or via the CLI using
  `gcloud beta trace` commands.
references:
- https://cloud.google.com/trace/docs/setup
- https://cloud.google.com/trace/docs/overview
- CIS Google Cloud Platform Foundation Benchmark v1.3.0
- https://www.pcisecuritystandards.org/
- https://cloud.google.com/security/compliance/soc-2/
- https://cloud.google.com/security/compliance
