rule_id: gcp.storage.bucket.log_retention_policy_lock
service: storage
resource: bucket
requirement: Log Retention Policy Lock
scope: storage.bucket.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: low
title: Ensure Storage Bucket Log Retention Policy is Locked
rationale: Locking the log retention policy on GCP storage buckets prevents accidental
  or malicious alterations, ensuring logs are retained for appropriate audit and compliance
  purposes. This is crucial for incident response, forensic investigations, and meeting
  regulatory requirements such as GDPR or CCPA, which mandate data retention and auditability.
description: This rule checks if the log retention policy of a GCP storage bucket
  is locked, preventing changes to the duration logs are stored. A locked policy aids
  in maintaining data integrity and compliance with organizational and regulatory
  log retention requirements. To verify, access the Cloud Console, navigate to the
  storage bucket, and check the log retention settings. To lock the policy, use the
  Cloud Console or gsutil to set and enforce a policy with a lock, ensuring it cannot
  be modified without specific permissions.
references:
- https://cloud.google.com/storage/docs/bucket-lock
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/storage/docs/audit-logs
- https://cloud.google.com/logging/docs/audit
