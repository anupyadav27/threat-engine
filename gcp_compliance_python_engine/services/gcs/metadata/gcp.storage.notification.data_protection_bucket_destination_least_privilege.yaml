rule_id: gcp.storage.notification.data_protection_bucket_destination_least_privilege
service: storage
resource: notification
requirement: Data Protection Bucket Destination Least Privilege
scope: storage.notification.least_privilege
domain: storage_and_database_security
subcategory: storage_encryption
severity: high
title: Enforce Least Privilege on Storage Notification Destinations
rationale: Implementing least privilege for storage notification destinations minimizes
  the risk of unauthorized data exposure and potential data breaches. This is crucial
  for maintaining data integrity and supporting compliance with regulations such as
  GDPR and HIPAA, which mandate strict access controls to sensitive data. By limiting
  access, organizations reduce their attack surface and protect against insider threats.
description: This rule checks that IAM roles assigned to GCS bucket notification destinations
  do not exceed the permissions necessary for their function. Ensure that roles are
  tailored to specific actions required, such as publishing messages to a Pub/Sub
  topic, without granting additional permissions. Verify current permissions through
  the Google Cloud Console or via the `gcloud` command-line tool. Remediate by reviewing
  and updating IAM policies to remove superfluous permissions, adhering to the principle
  of least privilege.
references:
- https://cloud.google.com/storage/docs/pubsub-notifications
- https://cloud.google.com/iam/docs/understanding-service-accounts
- CIS Google Cloud Platform Foundation Benchmark v1.3.0, Section 4.4
- https://cloud.google.com/security/compliance
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://www.iso.org/standard/54534.html
