rule_id: gcp.container.cluster.private_nodes_enabled
service: container
resource: cluster
requirement: Private Nodes Enabled
scope: container.cluster.private_networking
domain: network_security_and_connectivity
subcategory: network_access_control
severity: low
title: Enable Private Nodes in GKE Clusters
rationale: Enabling private nodes in Google Kubernetes Engine (GKE) clusters ensures
  that the nodes have internal IP addresses only, reducing exposure to the public
  internet and minimizing the attack surface. This configuration helps protect sensitive
  workloads and complies with regulatory frameworks that mandate network segmentation
  and access control, such as PCI DSS and HIPAA. It also mitigates risks associated
  with data breaches and unauthorized access by limiting the network pathways available
  to potential attackers.
description: This rule verifies that private nodes are enabled in GKE clusters, ensuring
  that nodes do not have external IP addresses and communicate over a private network.
  To verify, check the cluster configuration for 'privateNodesConfig' and ensure 'enablePrivateNodes'
  is set to true. Remediation involves modifying the cluster to enable private nodes,
  which can be done via the GCP Console, gcloud CLI, or Terraform. This configuration
  enhances security by isolating nodes from the public internet while still allowing
  communication with other Google Cloud services through private IPs.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/private-clusters
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/architecture/best-practices-for-private-gke-clusters
- https://cloud.google.com/security/best-practices/networking
