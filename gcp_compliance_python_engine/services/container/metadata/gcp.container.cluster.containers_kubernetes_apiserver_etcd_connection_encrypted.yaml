rule_id: gcp.container.cluster.containers_kubernetes_apiserver_etcd_connection_encrypted
service: container
resource: cluster
requirement: Containers Kubernetes Apiserver Etcd Connection Encrypted
scope: container.cluster.encryption
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: low
title: Ensure Kubernetes API Server to Etcd Connections are Encrypted
rationale: Encrypting connections between the Kubernetes API server and Etcd is crucial
  to protect sensitive data, such as cluster configurations and secrets, from interception
  and unauthorized access. Unencrypted connections can expose the cluster to man-in-the-middle
  attacks, increasing the risk of data breaches and compliance violations with standards
  like PCI-DSS and HIPAA.
description: This rule checks whether the communication between the Kubernetes API
  server and Etcd is encrypted with Transport Layer Security (TLS). To verify, ensure
  that the '--etcd-certfile' and '--etcd-keyfile' flags are specified in the API server
  configuration. If not, update the API server configuration to include these flags
  with the correct certificate and key files. This ensures data integrity and confidentiality
  during transmission.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/securing-clusters
- https://www.cisecurity.org/benchmark/google_cloud_computing
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/security/compliance/hipaa
- https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/
- https://cloud.google.com/architecture/security-foundations
