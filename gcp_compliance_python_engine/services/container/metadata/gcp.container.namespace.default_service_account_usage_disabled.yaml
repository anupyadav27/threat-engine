rule_id: gcp.container.namespace.default_service_account_usage_disabled
service: container
resource: namespace
requirement: Default Service Account Usage Disabled
scope: container.namespace.security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: low
title: Disable Default Service Account Usage in Kubernetes Namespaces
rationale: Using the default service account in Kubernetes namespaces can lead to
  elevated security risks. It might provide unnecessary permissions that could be
  exploited by attackers if a container is compromised. Disabling its usage reduces
  the attack surface and aligns with the principle of least privilege, thus protecting
  sensitive data and operations.
description: This rule checks whether the default service account is disabled in all
  Kubernetes namespaces within GCP. To verify, inspect the service account configurations
  in each namespace and ensure no workloads are using the default account. Remediation
  involves creating custom service accounts with minimal permissions tailored to application
  needs and updating workloads to use these instead of the default account.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#use_least_privilege_sa
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- NIST SP 800-53 AC-6 Least Privilege
- 'PCI-DSS Requirement 7: Restrict access to cardholder data by business need to know'
- https://kubernetes.io/docs/concepts/security/pod-security-standards/
- ISO/IEC 27001:2013 A.9.1.2 Access control to networks and network services
