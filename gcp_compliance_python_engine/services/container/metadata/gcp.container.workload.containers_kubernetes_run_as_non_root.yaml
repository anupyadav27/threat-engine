rule_id: gcp.container.workload.containers_kubernetes_run_as_non_root
service: container
resource: workload
requirement: Containers Kubernetes Run As Non Root
scope: container.workload.security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: critical
title: Ensure Kubernetes Containers Run as Non-Root User
rationale: Running containers as a non-root user reduces the risk of privilege escalation
  within the container, thereby mitigating potential impacts from vulnerabilities
  or malicious attacks. This practice is crucial for maintaining a secure environment,
  aligning with compliance requirements such as PCI-DSS and ISO 27001, which demand
  strict control over user permissions.
description: This rule verifies that Kubernetes workloads are configured to run containers
  as non-root users. The check ensures the 'runAsNonRoot' field in the security context
  of a PodSpec is set to true. To remediate, update your Kubernetes deployment configurations
  to include a security context that specifies a non-root user ID, ensuring that no
  container within the workload can execute processes as the root user.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#prevent_root
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://csrc.nist.gov/publications/detail/sp/800-190/final
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.iso.org/iso-27001-information-security.html
- https://kubernetes.io/docs/concepts/policy/pod-security-policy/#users-and-groups
