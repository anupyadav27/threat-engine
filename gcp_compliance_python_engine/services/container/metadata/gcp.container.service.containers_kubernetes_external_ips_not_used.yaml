rule_id: gcp.container.service.containers_kubernetes_external_ips_not_used
service: container
resource: service
requirement: Containers Kubernetes External Ips Not Used
scope: container.service.security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: low
title: Disable External IPs for Kubernetes Services
rationale: Exposing Kubernetes services with external IPs can lead to unauthorized
  access and potential data breaches. By restricting external IPs, you minimize the
  attack surface of your cluster, thus protecting sensitive workloads and meeting
  compliance with industry standards such as NIST and ISO 27001.
description: This rule checks if any Kubernetes service within your GCP environment
  is configured with an external IP. To enhance security, it's recommended to use
  internal IPs and leverage ingress controllers for controlled external access. Review
  your Kubernetes service configurations in the GCP Console or via kubectl, and ensure
  external IPs are not specified. Transition to internal-only IPs to mitigate exposure
  risks.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/exposing-apps
- https://cloud.google.com/kubernetes-engine/docs/concepts/ingress
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://www.iso.org/standard/73906.html
- https://kubernetes.io/docs/concepts/services-networking/service/#publishing-services-service-types
