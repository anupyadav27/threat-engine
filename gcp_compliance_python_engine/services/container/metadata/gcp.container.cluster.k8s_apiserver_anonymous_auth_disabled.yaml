rule_id: gcp.container.cluster.k8s_apiserver_anonymous_auth_disabled
service: container
resource: cluster
requirement: K8s Apiserver Anonymous Auth Disabled
scope: container.cluster.security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: low
title: Disable Anonymous Auth on Kubernetes API Server
rationale: Disabling anonymous authentication on the Kubernetes API server is crucial
  to prevent unauthorized access to the cluster's control plane. Allowing anonymous
  requests can lead to potential exploitation by malicious actors, which may result
  in unauthorized data access, cluster disruption, or compromise of sensitive workloads.
  This configuration aligns with compliance requirements such as PCI-DSS and ISO 27001,
  ensuring that only authenticated and authorized users can interact with the Kubernetes
  API.
description: This rule checks if the Kubernetes API server on GKE clusters has anonymous
  authentication disabled. Anonymous authentication allows requests to the API server
  without credentials, posing a security risk. To verify, ensure the 'anonymous-auth'
  flag is set to 'false' in the API server configuration. Remediation involves updating
  the GKE cluster configuration to explicitly disable anonymous authentication, which
  can typically be managed via the Google Cloud Console or using gcloud CLI commands.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#restrict_authn_methods
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance/pci-dss
- https://cloud.google.com/security/compliance/iso-27001
- https://kubernetes.io/docs/reference/access-authn-authz/authentication/#configuring-authentication
