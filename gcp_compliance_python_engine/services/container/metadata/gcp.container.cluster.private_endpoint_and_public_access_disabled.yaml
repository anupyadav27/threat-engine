rule_id: gcp.container.cluster.private_endpoint_and_public_access_disabled
service: container
resource: cluster
requirement: Private Endpoint And Public Access Disabled
scope: container.cluster.public_access
domain: network_security_and_connectivity
subcategory: network_access_control
severity: critical
title: Ensure Private Endpoint and Disable Public Access for GKE Clusters
rationale: Disabling public access and configuring private endpoints for Google Kubernetes
  Engine (GKE) clusters reduces the attack surface by preventing unauthorized access
  from the internet. This setup mitigates risks such as unauthorized data exposure
  and potential DDoS attacks, which can lead to service disruptions and data breaches.
  Ensuring private-only access aligns with compliance requirements like PCI-DSS and
  ISO 27001, which mandate strict network access controls.
description: This rule checks if GKE clusters have public access disabled and are
  configured with a private endpoint. To verify, inspect the cluster's networking
  configuration to ensure 'privateClusterConfig.enablePrivateEndpoint' is true and
  'privateClusterConfig.enablePrivateNodes' is true, while ensuring 'publicClusterConfig'
  is not set. Remediation involves using the GCP Console or gcloud command to update
  the cluster settings to enable private endpoints and disable public access.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/private-clusters
- https://cloud.google.com/kubernetes-engine/docs/best-practices-for-private-clusters
- CIS Google Cloud Platform Foundation Benchmark
- https://www.pcisecuritystandards.org/
- https://www.iso.org/iso-27001-information-security.html
