rule_id: gcp.container.pod.service_account_token_mount_configured
service: container
resource: pod
requirement: Service Account Token Mount Configured
scope: container.pod.security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: low
title: Ensure Service Account Token Mount Configuration in Pods
rationale: Proper configuration of service account token mounts in Kubernetes pods
  is crucial to prevent unauthorized access to the Kubernetes API, reducing the risk
  of privilege escalation and data breaches. Misconfigured tokens can expose sensitive
  information, leading to potential compliance violations with standards like NIST
  SP 800-53 and PCI-DSS.
description: This rule checks if Kubernetes pods have their service account token
  volumes properly configured, ensuring that tokens are not automatically mounted
  unless explicitly needed. To verify, inspect the pod specifications for the 'automountServiceAccountToken'
  field and ensure it is set to 'false' for pods that do not require API access. Remediation
  involves updating the pod configuration to disable automatic token mounting unless
  required for specific workloads.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster
- https://kubernetes.io/docs/reference/access-authn-authz/service-accounts-admin/#token-volume-projection
- https://www.cisecurity.org/benchmark/kubernetes
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.iso.org/iso-27001-information-security.html
