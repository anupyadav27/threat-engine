rule_id: gcp.container.cluster.secrets_encryption_kms_enabled
service: container
resource: cluster
requirement: Secrets Encryption KMS Enabled
scope: container.cluster.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Enable KMS for Secrets Encryption in GKE Clusters
rationale: Encrypting secrets with a Key Management Service (KMS) reduces the risk
  of unauthorized access and exposure of sensitive data, which can lead to data breaches
  and compliance violations. Using KMS enhances security by providing additional control
  over the encryption keys, which is crucial for meeting regulatory requirements such
  as PCI DSS, HIPAA, and GDPR.
description: This rule checks if Google Kubernetes Engine (GKE) clusters have Secrets
  Encryption enabled using Google Cloud Key Management Service (KMS). To verify, ensure
  that the cluster encryption configuration is set to use a Customer Managed Encryption
  Key (CMEK). Remediation involves updating the cluster's encryption settings to integrate
  with KMS by specifying a valid KMS key in the cluster's configuration, enhancing
  the security of stored secrets.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/encrypting-secrets
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://cloud.google.com/security/compliance/pci-dss
- https://cloud.google.com/security/compliance/hipaa
- https://cloud.google.com/security/compliance/gdpr
- https://cloud.google.com/kms/docs/
