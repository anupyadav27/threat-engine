rule_id: gcp.container.node.pool_image_type_cos_containerd_configured
service: container
resource: node
requirement: Pool Image Type Cos Containerd Configured
scope: container.node.security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: low
title: Ensure Node Pool Image Type is COS with Containerd
rationale: Using COS with containerd as the node image type enhances security by providing
  a minimal, hardened OS that reduces the attack surface and ensures compatibility
  with GKE features. This configuration aligns with security best practices and can
  help meet compliance requirements by ensuring that nodes run a consistent, secure
  OS environment, minimizing risks associated with vulnerabilities in more complex
  OS setups.
description: This check verifies that the node pool image type is set to Container-Optimized
  OS (COS) with containerd for Google Kubernetes Engine (GKE) clusters. To ensure
  this, inspect the node pool configurations in the GCP Console or using gcloud CLI.
  Remediation involves updating any node pools using non-COS images to use COS with
  containerd, which is handled via the GCP Console, gcloud CLI, or Terraform. This
  setup offers improved security and stability by leveraging the lightweight, secure
  nature of COS.
references:
- https://cloud.google.com/kubernetes-engine/docs/concepts/node-images#cos
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://kubernetes.io/docs/concepts/containers/runtime-class/#containerd
- https://cloud.google.com/containers/security/container-optimized-os-overview
