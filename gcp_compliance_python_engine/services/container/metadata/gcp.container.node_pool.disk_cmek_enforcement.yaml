rule_id: gcp.container.node_pool.disk_cmek_enforcement
service: container
resource: node_pool
requirement: Disk Cmek Enforcement
scope: container.node_pool.security
domain: storage_and_database_security
subcategory: storage_encryption
severity: low
title: Ensure Node Pool Disks Use Customer-Managed Encryption Keys
rationale: Enforcing the use of Customer-Managed Encryption Keys (CMEK) for node pool
  disks enhances data security by allowing organizations to maintain control over
  encryption keys. This minimizes the risk of unauthorized access to sensitive data,
  aligns with data protection regulations, and reduces the impact of potential data
  breaches. Implementing CMEK also supports compliance with standards like PCI-DSS
  and HIPAA that require strong encryption practices.
description: This rule checks if node pools in Google Kubernetes Engine (GKE) clusters
  are configured to use Customer-Managed Encryption Keys for their persistent disks.
  To verify, inspect the node pool's configuration for CMEK settings in the GCP Console
  or use the gcloud CLI. Remediation involves updating the node pool to specify a
  CMEK during creation or through a configuration update. This ensures that data at
  rest is encrypted using keys managed and controlled by the organization, rather
  than Google-managed keys.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/encrypting-disks
- https://cloud.google.com/security/compliance/cis#cis-gke
- https://cloud.google.com/security/compliance
- https://cloud.google.com/kms/docs/cmek
- https://cloud.google.com/security/encryption-at-rest/default-encryption
