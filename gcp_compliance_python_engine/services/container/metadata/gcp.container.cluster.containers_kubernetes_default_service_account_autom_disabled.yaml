rule_id: gcp.container.cluster.containers_kubernetes_default_service_account_autom_disabled
service: container
resource: cluster
requirement: Containers Kubernetes Default Service Account Autom Disabled
scope: container.cluster.security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: low
title: Disable Kubernetes Default Service Account for GKE Clusters
rationale: Using the default service account in Kubernetes clusters can lead to privilege
  escalation and unauthorized access within Google Kubernetes Engine (GKE). Misuse
  of default service accounts may result in potential exposure of sensitive data or
  unauthorized actions by workloads. Ensuring that workloads do not automatically
  use the default service account helps in maintaining least privilege and reducing
  attack surface.
description: This rule checks if the default Kubernetes service account is disabled
  for automatic use within GKE clusters. By default, Kubernetes assigns the default
  service account to workloads, which can inadvertently grant excessive permissions.
  To verify, ensure that workloads specify custom service accounts with minimal permissions.
  Remediation involves explicitly specifying a custom service account with the required
  permissions in pod specifications, and disabling the automatic mounting of default
  service accounts by setting the 'automountServiceAccountToken' to false.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#use_least_privilege_sa
- https://cloud.google.com/kubernetes-engine/docs/concepts/service-accounts
- CIS Google Kubernetes Engine Benchmark
- https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/
- NIST SP 800-190 Application Container Security Guide
- https://www.iso.org/iso-27001-information-security.html
