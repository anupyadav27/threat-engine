rule_id: gcp.container.cluster.k8s_controllermanager_service_account_token_signing_enabled
service: container
resource: cluster
requirement: K8s Controllermanager Service Account Token Signing Enabled
scope: container.cluster.security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: low
title: Ensure K8s Service Account Token Signing is Enabled
rationale: Enabling service account token signing in Kubernetes ensures that tokens
  are cryptographically secure, reducing the risk of unauthorized access and token
  forgery. This feature is critical for maintaining the integrity and confidentiality
  of service account tokens, thus protecting sensitive workloads and data in the cluster.
  Compliance with security standards such as NIST and CIS often requires such measures
  to safeguard cloud environments.
description: This check verifies whether the Kubernetes Controller Manager has service
  account token signing enabled in GCP clusters. To ensure this, check the cluster's
  configuration for the --service-account-signing-key-file and --root-ca-file flags.
  If these flags are not set, it is crucial to configure them to enable token signing.
  Remediation involves updating the Kubernetes Controller Manager configuration to
  include these flags, ensuring that all service account tokens are signed and verified.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#restricting_service_account_usage
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://csrc.nist.gov/publications/detail/sp/800-190/final
- https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/
