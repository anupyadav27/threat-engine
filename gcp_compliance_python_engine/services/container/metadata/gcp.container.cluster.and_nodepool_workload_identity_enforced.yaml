rule_id: gcp.container.cluster.and_nodepool_workload_identity_enforced
service: container
resource: cluster
requirement: And Nodepool Workload Identity Enforced
scope: container.cluster.security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: low
title: Ensure Workload Identity is Enforced for GKE Clusters and Nodepools
rationale: Enforcing Workload Identity in GKE clusters and nodepools mitigates the
  risk of credential theft by ensuring that Google Kubernetes Engine (GKE) workloads
  run with specific and minimal IAM permissions. This approach reduces the attack
  surface by eliminating the need for long-lived credentials and helps in meeting
  compliance requirements by adhering to the principle of least privilege.
description: This rule checks whether Workload Identity is enforced for GKE clusters
  and their associated nodepools. Workload Identity allows Kubernetes service accounts
  to act as IAM service accounts, providing secure access to Google Cloud services.
  To verify, ensure that the 'workloadIdentityConfig' field is configured with a valid
  'identityNamespace'. Remediation involves updating the GKE cluster configuration
  to enable Workload Identity, using the command 'gcloud container clusters update
  CLUSTER_NAME --workload-pool=PROJECT_ID.svc.id.goog'.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity
- https://cloud.google.com/kubernetes-engine/docs/concepts/security-overview#workload-identity
- CIS Google Kubernetes Engine Benchmark v1.0.0 - Section 6.10
- NIST SP 800-53 Rev. 5 - AC-3 Access Enforcement
- 'PCI DSS v3.2.1 - Requirement 7: Restrict access to cardholder data by business
  need to know'
- ISO/IEC 27001:2013 - A.9.4.1 Information access restriction
