rule_id: gcp.container.cluster.containers_kubernetes_service_kube_system_services_no_public
service: container
resource: cluster
requirement: Containers Kubernetes Service Kube System Services No Public
scope: container.cluster.public_access
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: critical
title: Restrict Public Access to Kubernetes System Services
rationale: Exposing Kubernetes system services to the public internet can lead to
  unauthorized access and potential compromise of the cluster's control plane. This
  exposure increases the risk of data breaches, denial-of-service attacks, and compliance
  violations, particularly for standards like PCI-DSS and HIPAA, which require strict
  access controls.
description: This check ensures that Kubernetes system services within the kube-system
  namespace are not publicly accessible. It verifies the network configurations and
  firewall rules associated with the Kubernetes Engine cluster to restrict access
  to internal IPs only. To remediate, configure private clusters and update firewall
  rules to allow access only from specific IP ranges or VPCs, ensuring that no public
  IP addresses can reach the kube-system services.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster
- https://cloud.google.com/security/compliance/cis-benchmarks
- https://www.pcisecuritystandards.org/pci_security/
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://cloud.google.com/architecture/best-practices-for-enterprise-organizations
- https://kubernetes.io/docs/concepts/security/overview/
