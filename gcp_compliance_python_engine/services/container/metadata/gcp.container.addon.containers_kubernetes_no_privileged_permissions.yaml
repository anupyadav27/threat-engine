rule_id: gcp.container.addon.containers_kubernetes_no_privileged_permissions
service: container
resource: addon
requirement: Containers Kubernetes No Privileged Permissions
scope: container.addon.least_privilege
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: high
title: Prohibit Privileged Permissions for Kubernetes Add-ons
rationale: Using privileged permissions in Kubernetes add-ons can expose the cluster
  to security risks, including unauthorized access to sensitive resources and potential
  privilege escalation attacks. Ensuring that add-ons operate with the least privilege
  necessary helps mitigate vulnerabilities and align with compliance requirements
  such as PCI-DSS and ISO 27001.
description: This rule checks that Kubernetes add-ons deployed in GCP do not run with
  privileged permissions. It verifies that the securityContext.privileged field is
  set to false in the Pod specifications of add-ons. Remediation involves auditing
  add-on configurations for privileged access and modifying them to adhere to the
  principle of least privilege by updating security settings to non-privileged modes.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-190.pdf
- https://cloud.google.com/security/compliance/pci-dss
- https://cloud.google.com/security/compliance/iso-27001
- https://kubernetes.io/docs/concepts/security/pod-security-standards/
