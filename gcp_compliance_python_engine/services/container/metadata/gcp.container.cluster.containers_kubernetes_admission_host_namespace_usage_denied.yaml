rule_id: gcp.container.cluster.containers_kubernetes_admission_host_namespace_usage_denied
service: container
resource: cluster
requirement: Containers Kubernetes Admission Host Namespace Usage Denied
scope: container.cluster.security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: low
title: Restrict Host Namespace Usage in GKE Clusters
rationale: Allowing containers to share the host's namespace can lead to privilege
  escalation and potential exposure of sensitive host-level data. This configuration
  can be exploited by attackers to gain unauthorized access to the host system, posing
  a significant security risk. Ensuring that containers do not use the host's namespace
  helps maintain isolation and aligns with security best practices and compliance
  requirements.
description: This rule checks that Kubernetes clusters in GCP do not allow containers
  to use the host's namespace, which is a potential security risk. Verify that the
  PodSecurityPolicy or similar admission controls are configured to deny the usage
  of 'hostPID', 'hostIPC', and 'hostNetwork'. To remediate, update your cluster's
  security policies to restrict these settings, ensuring that all container deployments
  adhere to these constraints.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#admission_controllers
- https://cloud.google.com/kubernetes-engine/docs/concepts/pod-security-policies
- CIS Google Kubernetes Engine (GKE) Benchmark
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
- https://www.iso.org/iso-27001-information-security.html
- https://kubernetes.io/docs/concepts/policy/pod-security-policy/
