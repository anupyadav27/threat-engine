rule_id: gcp.container.cluster.private_nodes_configured
service: container
resource: cluster
requirement: Private Nodes Configured
scope: container.cluster.private_networking
domain: network_security_and_connectivity
subcategory: network_access_control
severity: low
title: Ensure GKE Clusters Have Private Nodes Configured
rationale: Configuring private nodes in GKE clusters is crucial for reducing exposure
  to the public internet, minimizing the attack surface, and adhering to best practices
  for data protection and compliance with regulations such as HIPAA and PCI-DSS. This
  configuration helps protect sensitive workloads from unauthorized access and potential
  data breaches by ensuring that nodes communicate over private IP addresses.
description: This rule checks whether Google Kubernetes Engine (GKE) clusters are
  configured to use private nodes. Private nodes must be enabled to ensure that all
  node-to-node and node-to-master communications occur over a private network, enhancing
  security and reducing public exposure. To verify, check the cluster's privateClusterConfig
  settings via the GCP Console or gcloud CLI. Remediation involves enabling private
  clusters through the GCP Console or updating the cluster with the `--enable-private-nodes`
  flag using the gcloud CLI.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/private-clusters
- https://cloud.google.com/kubernetes-engine/docs/concepts/private-cluster-concept
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://www.nist.gov/itl/applied-cybersecurity/nistcyberframework
- https://cloud.google.com/architecture/security-foundations
