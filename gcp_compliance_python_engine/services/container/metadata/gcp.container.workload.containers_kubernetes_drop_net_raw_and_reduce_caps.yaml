rule_id: gcp.container.workload.containers_kubernetes_drop_net_raw_and_reduce_caps
service: container
resource: workload
requirement: Containers Kubernetes Drop Net Raw And Reduce Caps
scope: container.workload.security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: low
title: Enforce Least Privilege on Kubernetes Container Capabilities
rationale: Restricting container capabilities, particularly dropping NET_RAW, minimizes
  the attack surface by preventing containers from performing potentially harmful
  network operations. This is crucial for maintaining a secure Kubernetes environment
  and protecting against privilege escalation attacks, which can lead to unauthorized
  access and data breaches. Complying with this helps meet security standards and
  reduces risks associated with misconfigured containers.
description: This rule ensures that Kubernetes containers have the NET_RAW capability
  dropped and other unnecessary capabilities minimized. Containers should only be
  granted the capabilities they need to function, adhering to the principle of least
  privilege. Verify the security context of your Kubernetes Pod specifications and
  adjust them to drop NET_RAW and other superfluous capabilities. Remediation involves
  updating your Pod or Deployment configurations to include a securityContext section
  that explicitly drops these capabilities.
references:
- https://cloud.google.com/kubernetes-engine/docs/concepts/pod-security-policies
- https://cloud.google.com/security/compliance/cis-benchmarks
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
- https://kubernetes.io/docs/tasks/configure-pod-container/security-context/
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/security_and_compliance/using-scc
