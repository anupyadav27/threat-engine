rule_id: gcp.container.node_pool.containers_kubernetes_workload_identity_enabled
service: container
resource: node_pool
requirement: Containers Kubernetes Workload Identity Enabled
scope: container.node_pool.security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: low
title: Enable Kubernetes Workload Identity on GKE Node Pools
rationale: Enabling Kubernetes Workload Identity on GKE node pools enhances security
  by ensuring that workloads have minimal permissions necessary to access Google Cloud
  services, reducing the risk of privilege escalation and data breaches. This configuration
  aligns with the principle of least privilege, mitigating risks associated with credential
  management and unauthorized access to resources.
description: This rule verifies that Kubernetes Workload Identity is enabled on Google
  Kubernetes Engine (GKE) node pools. Workload Identity allows Kubernetes service
  accounts to act as Google service accounts, providing secure and fine-grained access
  control. To enable it, configure the node pool with Workload Identity during creation
  or update by setting the `--workload-pool` flag. Ensure that Kubernetes service
  accounts are properly annotated to utilize this identity feature. Remediation involves
  updating existing node pools to enable this setting through the GCP Console or `gcloud`
  CLI.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity
- https://cloud.google.com/security/best-practices/identity
- https://cloud.google.com/kubernetes-engine/docs/concepts/workload-identity
- https://cloud.google.com/kubernetes-engine/docs/reference/rest/v1/nodePools
- 'CIS GCP Benchmark: Section 5.3.1 Enable Workload Identity for GKE Clusters'
- 'NIST SP 800-53: AC-6 Least Privilege'
