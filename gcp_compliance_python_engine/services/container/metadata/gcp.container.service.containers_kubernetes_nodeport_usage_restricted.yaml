rule_id: gcp.container.service.containers_kubernetes_nodeport_usage_restricted
service: container
resource: service
requirement: Containers Kubernetes Nodeport Usage Restricted
scope: container.service.security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: low
title: Restrict Kubernetes NodePort Service Usage
rationale: Open NodePorts can expose Kubernetes services to the entire internet, increasing
  the risk of unauthorized access and potential attacks such as Denial of Service
  (DoS). Restricting NodePort usage helps mitigate these risks and aligns with best
  practices for minimizing exposure of internal services, which is crucial for maintaining
  a secure and compliant cloud environment.
description: This rule checks if Kubernetes services are configured to use NodePort,
  which exposes an application on a static port on each node's IP. It is recommended
  to minimize the use of NodePorts due to their exposure to the internet. Verification
  involves inspecting service configurations for NodePort usage. Remediation includes
  using internal or ClusterIP services, or implementing ingress controllers for controlled
  external access.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/exposing-apps
- https://cloud.google.com/security-command-center/docs/how-to-remediate-container-vulnerabilities
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://cloud.google.com/kubernetes-engine/docs/concepts/ingress
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-190.pdf
- https://www.iso.org/iso-27001-information-security.html
