rule_id: gcp.container.cluster.containers_kubernetes_networkpolicy_required_allowl_services
service: container
resource: cluster
requirement: Containers Kubernetes Networkpolicy Required Allowl Services
scope: container.cluster.network_security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: medium
title: Ensure Kubernetes NetworkPolicies Allow Only Essential Services
rationale: Implementing Kubernetes NetworkPolicies is crucial to control and restrict
  traffic between pods within a GKE cluster, minimizing the attack surface and reducing
  the risk of unauthorized access. Without these policies, clusters could be vulnerable
  to lateral movement by an attacker who gains access to a single pod, potentially
  violating compliance requirements like PCI-DSS and HIPAA, which mandate strict network
  segmentation and data protection.
description: This rule checks if Kubernetes NetworkPolicies are applied to all services
  in the GKE cluster, ensuring that only allowed traffic can communicate with the
  pods. NetworkPolicies should be configured to permit only required ingress and egress
  traffic, effectively isolating workloads and protecting sensitive data. To verify
  compliance, inspect the NetworkPolicy resources in your cluster using 'kubectl get
  networkpolicies --all-namespaces'. Remediation involves creating and applying NetworkPolicies
  for each service, defining allowed ingress and egress traffic according to your
  security policy.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/network-policy
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
- https://kubernetes.io/docs/concepts/services-networking/network-policies/
- https://cloud.google.com/security/compliance
