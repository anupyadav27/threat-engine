rule_id: gcp.container.cluster.intranode_visibility_and_vpc_flow_logs_enabled
service: container
resource: cluster
requirement: Intranode Visibility And VPC Flow Logs Enabled
scope: container.cluster.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: low
title: Enable Intranode Visibility and VPC Flow Logs for Clusters
rationale: Enabling intranode visibility and VPC flow logs enhances network monitoring
  and security by providing detailed insights into internal cluster communications
  and network traffic. This aids in the detection of anomalies, prevents potential
  data breaches, and supports compliance with regulations requiring detailed network
  activity logging, such as PCI-DSS and HIPAA.
description: This rule checks if GKE clusters have both intranode visibility and VPC
  flow logs enabled. Intranode visibility allows for monitoring traffic between nodes
  within a cluster, while VPC flow logs capture information about network flows sent
  from and received by VM instances. To verify and enable these settings, navigate
  to the GKE cluster settings in the Google Cloud Console, enable intranode visibility
  under networking, and ensure VPC flow logs are activated in the VPC network settings.
  Remediation involves configuring these settings for each cluster to ensure comprehensive
  network monitoring.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/intranode-visibility
- https://cloud.google.com/vpc/docs/using-flow-logs
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster
- https://www.pcisecuritystandards.org/
