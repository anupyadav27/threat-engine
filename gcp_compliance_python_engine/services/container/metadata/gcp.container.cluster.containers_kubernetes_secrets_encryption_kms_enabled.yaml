rule_id: gcp.container.cluster.containers_kubernetes_secrets_encryption_kms_enabled
service: container
resource: cluster
requirement: Containers Kubernetes Secrets Encryption KMS Enabled
scope: container.cluster.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Enable KMS for Kubernetes Secrets Encryption in GKE
rationale: Encrypting Kubernetes secrets using Customer-Managed Encryption Keys (CMEK)
  enhances security by ensuring sensitive information is protected with a robust encryption
  mechanism. It mitigates the risk of unauthorized access and data breaches, which
  can lead to significant financial loss and damage to brand reputation. Additionally,
  it helps meet compliance requirements for data protection standards such as PCI-DSS
  and HIPAA, which mandate strong encryption practices.
description: This rule checks whether Google Kubernetes Engine (GKE) clusters have
  Kubernetes secrets encrypted with CMEK through Google Cloud Key Management Service
  (KMS). To verify, ensure clusters are configured to use KMS keys for encrypting
  secrets by setting the '--kms-key' flag during cluster creation. Remediation involves
  updating existing clusters to enable CMEK by modifying the encryption settings via
  the GCP console or gcloud CLI, ensuring that the KMS key is properly managed and
  rotated regularly.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/encrypting-secrets
- https://cloud.google.com/security/compliance/cis-gcp-foundations-benchmark
- https://www.pcisecuritystandards.org/pci_security/
- https://www.hhs.gov/hipaa/for-professionals/security/index.html
- https://cloud.google.com/security/encryption-at-rest/
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
