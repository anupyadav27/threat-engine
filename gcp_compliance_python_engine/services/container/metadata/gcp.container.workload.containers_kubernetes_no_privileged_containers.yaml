rule_id: gcp.container.workload.containers_kubernetes_no_privileged_containers
service: container
resource: workload
requirement: Containers Kubernetes No Privileged Containers
scope: container.workload.least_privilege
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: high
title: Ensure No Privileged Containers in Kubernetes Workloads
rationale: Running containers in privileged mode grants them elevated permissions,
  potentially allowing attackers to gain root access to the host node, leading to
  data breaches or infrastructure compromise. This can result in severe business impacts,
  including financial losses, reputational damage, and non-compliance with regulations
  like PCI-DSS and SOC2.
description: This rule checks Kubernetes workloads to ensure that no containers are
  running with privileged access. Privileged containers can bypass security controls
  and have unrestricted access to the host system. To verify, inspect the security
  context configurations in your Kubernetes deployment YAML files and ensure the 'privileged'
  flag is set to false. Remediate by updating configurations to disable privileged
  mode and redeploy the workloads.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/pci_security/
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-190.pdf
- https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted
- https://cloud.google.com/security/compliance
