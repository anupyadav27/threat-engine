rule_id: gcp.container.cluster.containers_kubernetes_networkpolicy_default_deny_i_namespace
service: container
resource: cluster
requirement: Containers Kubernetes Networkpolicy Default Deny I Namespace
scope: container.cluster.network_security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: medium
title: Implement Default Deny Policy for Kubernetes Namespaces
rationale: Applying a default deny network policy in Kubernetes namespaces is crucial
  for minimizing the attack surface by restricting both ingress and egress traffic
  to only what is necessary. This control reduces the risk of unauthorized access
  and potential data exfiltration, thereby safeguarding sensitive applications and
  data. It also aligns with compliance requirements for data protection and network
  security, such as PCI-DSS and NIST.
description: This rule checks that all Kubernetes namespaces within a GCP container
  cluster have a default deny network policy implemented. A default deny policy ensures
  that no traffic is allowed by default, and only explicitly allowed traffic can pass
  through. To verify, review the network policies for each namespace and ensure they
  start with a deny-all rule. Remediation involves creating or updating network policies
  to include a 'deny all ingress and egress' rule, then selectively allowing necessary
  traffic.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/network-policy
- https://cloud.google.com/security/compliance/cis-benchmarks
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-190.pdf
- https://kubernetes.io/docs/concepts/services-networking/network-policies/
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.iso.org/iso-27001-information-security.html
