rule_id: gcp.container.cluster.shielded_nodes_enabled
service: container
resource: cluster
requirement: Shielded Nodes Enabled
scope: container.cluster.security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: low
title: Ensure Shielded Nodes are Enabled in GKE Clusters
rationale: Enabling Shielded Nodes in Google Kubernetes Engine (GKE) clusters enhances
  node security by protecting against rootkit and bootkit attacks, which can compromise
  the integrity of the node operating system. This feature is crucial for maintaining
  the confidentiality, integrity, and availability of workloads, particularly in environments
  subject to compliance requirements like PCI-DSS or HIPAA, where data protection
  is paramount.
description: This rule checks if Shielded Nodes are enabled in GKE clusters. Shielded
  Nodes provide verifiable integrity of node boot processes and protect against unauthorized
  changes to the guest operating system. To enable Shielded Nodes, update the cluster
  to set the 'enableShieldedNodes' field to 'true'. Verification can be done via the
  GCP Console under Kubernetes Engine settings or using the 'gcloud' CLI with 'gcloud
  container clusters describe'. If not enabled, modify the cluster configuration to
  activate Shielded Nodes and apply changes.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/shielded-gke-nodes
- https://cloud.google.com/kubernetes-engine/docs/concepts/shielded-nodes
- CIS Google Kubernetes Engine Benchmark
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/security/compliance
