rule_id: gcp.container.namespace.containers_kubernetes_default_service_account_autom_disabled
service: container
resource: namespace
requirement: Containers Kubernetes Default Service Account Autom Disabled
scope: container.namespace.security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: low
title: Disable Automatic Default Service Account in Kubernetes
rationale: Disabling the automatic assignment of the default service account for Kubernetes
  containers reduces the risk of privilege escalation and unauthorized access to resources.
  This practice helps maintain the principle of least privilege, ensuring that applications
  run with only the permissions they need, thus minimizing potential attack vectors
  and aligning with compliance standards such as PCI-DSS and ISO 27001.
description: This rule checks if the default service account is disabled for Kubernetes
  containers in a namespace. The default service account often has elevated permissions
  that could be misused if exploited. To verify, review the namespace configurations
  and ensure no pods are using the default service account. Remediation involves setting
  custom service accounts with tailored permissions and updating pod specifications
  to reference these accounts.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#default-service-account
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
- https://cloud.google.com/blog/topics/developers-practitioners/best-practices-using-google-kubernetes-engine-gke
