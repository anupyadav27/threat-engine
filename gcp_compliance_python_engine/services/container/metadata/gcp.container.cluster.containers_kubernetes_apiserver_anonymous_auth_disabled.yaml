rule_id: gcp.container.cluster.containers_kubernetes_apiserver_anonymous_auth_disabled
service: container
resource: cluster
requirement: Containers Kubernetes Apiserver Anonymous Auth Disabled
scope: container.cluster.security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: low
title: Disable Anonymous Auth on Kubernetes API Server
rationale: Anonymous authentication allows unauthenticated access to the Kubernetes
  API server, posing a security risk by potentially exposing sensitive operations
  to unauthorized users. This can lead to unauthorized access, data breaches, and
  compromise of cluster integrity. Disabling anonymous authentication helps in maintaining
  strict access control, complying with security best practices and regulatory standards
  like CIS and NIST.
description: This rule checks if the Kubernetes API server on GCP Kubernetes Engine
  clusters has anonymous authentication disabled. Anonymous access should be turned
  off to ensure that all requests to the API server are authenticated. Verification
  involves examining the 'enableAnonymousAuth' field in the 'kube-apiserver' configuration
  and ensuring it is set to 'false'. To remediate, modify the cluster configuration
  to disable anonymous authentication, typically through the GCP Console or gcloud
  command-line tool.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster
- https://cloud.google.com/kubernetes-engine/docs/reference/rest/v1/projects.locations.clusters
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf
- https://kubernetes.io/docs/reference/access-authn-authz/authentication/#anonymous-requests
- https://cloud.google.com/kubernetes-engine/docs/concepts/using-rbac
