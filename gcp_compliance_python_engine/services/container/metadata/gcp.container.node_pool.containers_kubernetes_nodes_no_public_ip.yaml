rule_id: gcp.container.node_pool.containers_kubernetes_nodes_no_public_ip
service: container
resource: node_pool
requirement: Containers Kubernetes Nodes No Public Ip
scope: container.node_pool.public_access
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: critical
title: Prevent Public IPs on GKE Node Pools
rationale: Exposing Kubernetes nodes with public IP addresses increases the attack
  surface, allowing potential unauthorized access to your cluster. This can lead to
  data breaches, service disruptions, and non-compliance with industry standards like
  PCI-DSS and HIPAA, which mandate strict control over network access and data protection.
description: This rule checks that Google Kubernetes Engine (GKE) node pools do not
  have public IP addresses assigned to their nodes. To ensure that nodes are not publicly
  accessible, configure your GKE cluster to use private IP addresses only. Verification
  involves reviewing the networking settings of your node pools and adjusting them
  via Google Cloud Console or gcloud CLI to disable public IP allocation. Remediation
  can be done by creating node pools with private IP addresses only, enhancing security
  and compliance.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/private-clusters
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance/pci-dss
- https://cloud.google.com/security/compliance/hipaa
