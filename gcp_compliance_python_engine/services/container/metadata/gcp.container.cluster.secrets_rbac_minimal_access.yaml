rule_id: gcp.container.cluster.secrets_rbac_minimal_access
service: container
resource: cluster
requirement: Secrets RBAC Minimal Access
scope: container.cluster.authorization
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Limit RBAC Access to Secrets in GKE Clusters
rationale: Minimizing RBAC access to secrets in Google Kubernetes Engine (GKE) clusters
  reduces the risk of unauthorized access to sensitive information, such as database
  credentials and API keys. Excessive permissions can lead to data breaches or service
  disruptions if credentials are misused or leaked. This practice supports compliance
  with regulations such as GDPR and PCI-DSS, which mandate strict access controls
  to sensitive data.
description: This rule checks that RBAC roles in GKE clusters do not grant excessive
  permissions to access Kubernetes secrets. It ensures that only necessary roles have
  read or write access to secrets, aligning with the principle of least privilege.
  To verify, review the RBAC role bindings in your GKE clusters and ensure only intended
  service accounts and users have access to secrets. Remediation involves updating
  role bindings to remove excessive permissions and creating custom roles as needed.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#rbac
- https://cloud.google.com/iam/docs/understanding-roles
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.nist.gov/cyberframework
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/security
