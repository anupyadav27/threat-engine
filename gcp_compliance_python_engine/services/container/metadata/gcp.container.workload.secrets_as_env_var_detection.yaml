rule_id: gcp.container.workload.secrets_as_env_var_detection
service: container
resource: workload
requirement: Secrets As Env Var Detection
scope: container.workload.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: high
title: Detect and Mitigate Secrets in Env Vars for GKE Workloads
rationale: Storing secrets such as API keys or passwords in environment variables
  can expose sensitive information if the pod is compromised, leading to unauthorized
  access and potential data breaches. This practice violates compliance requirements
  such as PCI-DSS and HIPAA, which mandate strict controls over sensitive data handling.
description: This rule checks if Kubernetes workloads in Google Kubernetes Engine
  (GKE) clusters are configured with secrets exposed as environment variables, which
  is a risky practice. To verify, inspect the workload configurations for any environment
  variable that contains sensitive information. Remediation involves using Kubernetes
  Secrets to store and manage sensitive data securely, and referencing them in workloads
  without directly exposing them as environment variables.
references:
- https://cloud.google.com/kubernetes-engine/docs/concepts/secrets
- 'CIS GCP Benchmark: 5.4.1 Ensure that Secrets are not stored in the pod specification'
- https://www.pcisecuritystandards.org/pci_security/maintaining_payment_security
- https://www.hhs.gov/hipaa/for-professionals/security/index.html
- https://kubernetes.io/docs/concepts/configuration/secret/
