rule_id: gcp.container.node_pool.containers_kubernetes_container_instance_env_no_plai_secrets
service: container
resource: node_pool
requirement: Containers Kubernetes Container Instance Env No Plai Secrets
scope: container.node_pool.security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: high
title: Avoid Plaintext Secrets in Kubernetes Container Environment Variables
rationale: Exposing secrets as plaintext in environment variables can lead to unauthorized
  access and data breaches if a container is compromised. This practice poses significant
  security risks, as attackers can easily extract sensitive information such as API
  keys and credentials, leading to potential data loss, service disruptions, and non-compliance
  with regulations like PCI-DSS and HIPAA.
description: This rule checks if Kubernetes container instances within a node pool
  have environment variables set with plaintext secrets. The recommended practice
  is to use Kubernetes Secrets to manage sensitive data securely. Verify configurations
  using tools like kubectl to inspect environment variables and ensure they are sourced
  from Secrets. To remediate, refactor workloads to use Kubernetes Secrets and update
  deployment configurations accordingly.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/secrets
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-190.pdf
- https://kubernetes.io/docs/concepts/configuration/secret/
- https://cloud.google.com/security/compliance
- https://cloud.google.com/kubernetes-engine/docs/best-practices
