rule_id: gcp.container.nodepool.metadata_server_enabled
service: container
resource: nodepool
requirement: Metadata Server Enabled
scope: container.nodepool.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Enable Metadata Server on GKE Node Pools
rationale: Enabling the metadata server on GKE node pools is crucial for managing
  service accounts, accessing instance metadata securely, and ensuring proper authorization
  checks are in place. This configuration mitigates the risk of unauthorized access
  to sensitive metadata that could lead to data breaches or privilege escalation attacks,
  thereby supporting compliance with data protection regulations like GDPR and HIPAA.
description: This rule checks if the metadata server is enabled on Google Kubernetes
  Engine (GKE) node pools. The metadata server provides a secure channel for workloads
  to access metadata and service account credentials necessary for operations. Verifying
  this setting involves ensuring that the 'workload-metadata' configuration is set
  to 'GKE_METADATA' or 'SECURE', which can be adjusted through the GCP Console or
  gcloud CLI. Remediation involves updating the node pool configuration to enable
  the metadata server if it is not already active.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/protecting-cluster-metadata
- CIS Google Kubernetes Engine Benchmark v1.2.0, Section 6.3.1
- NIST SP 800-53 Rev. 5, AC-3 Access Enforcement
- https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster
- https://cloud.google.com/iam/docs/understanding-service-accounts
