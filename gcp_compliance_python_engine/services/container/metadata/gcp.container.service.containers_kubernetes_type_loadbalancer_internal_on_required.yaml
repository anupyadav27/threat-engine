rule_id: gcp.container.service.containers_kubernetes_type_loadbalancer_internal_on_required
service: container
resource: service
requirement: Containers Kubernetes Type Loadbalancer Internal On Required
scope: container.service.security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: low
title: Ensure LoadBalancer Services are Internal Only
rationale: Requiring Kubernetes LoadBalancer services to be internal minimizes exposure
  to external networks, reducing the attack surface and protecting against unauthorized
  access. This is crucial for safeguarding sensitive data in compliance with regulations
  like GDPR and PCI-DSS, and for mitigating risks such as data breaches and DDoS attacks.
description: This rule checks if Kubernetes LoadBalancer services in GCP are configured
  as internal-only, which restricts traffic to within the Google Cloud Virtual Private
  Cloud (VPC). Verify this setting by ensuring the spec.loadBalancerIP field is not
  specified or the spec.loadBalancerSourceRanges field is set to internal IP ranges.
  To remediate, update the service manifest to remove any external IP configurations
  and specify internal-only settings in the GCP Console or via kubectl.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/internal-load-balancing
- https://cloud.google.com/kubernetes-engine/docs/concepts/network-overview#external_load_balancing
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://kubernetes.io/docs/concepts/services-networking/service/#loadbalancer
