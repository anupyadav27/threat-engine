rule_id: gcp.container.node_pool.k8s_kubelet_client_cert_rotation_enabled
service: container
resource: node_pool
requirement: K8s Kubelet Client Cert Rotation Enabled
scope: container.node_pool.key_rotation
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: low
title: Enable K8s Kubelet Client Cert Rotation in Node Pools
rationale: Enabling Kubelet client certificate rotation helps ensure that the certificates
  used by each node's Kubelet component are automatically and regularly renewed, reducing
  the risk of certificate expiration which can lead to service disruptions. It mitigates
  potential attack vectors where expired certificates could be exploited, thus maintaining
  continuous, secure communication in your Kubernetes environment.
description: This rule checks if the automatic rotation of client certificates for
  Kubelets in GCP Kubernetes Engine node pools is enabled. Without this setting, node-level
  security is weakened as certificates can expire without notice, leading to potential
  denial of service or unauthorized access. Verify this setting via the GCP Console
  under Kubernetes Engine settings or use gcloud CLI commands to ensure that the --rotate-certificates
  flag is enabled. Remediate by configuring your node pool with certificate rotation
  enabled, ensuring Kubelets are set to automatically renew their client certificates.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity
- https://cloud.google.com/kubernetes-engine/docs/concepts/node-pools
- 'CIS GCP Benchmark: 5.2.3 - Ensure Kubelet client certificate rotation is enabled'
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://www.iso.org/iso-27001-information-security.html
- https://security.googleblog.com/2017/10/introducing-gke-110-security-improvements.html
