rule_id: gcp.storage.bucket.data_protection_bucket_no_public_principals
service: storage
resource: bucket
requirement: Data Protection Bucket No Public Principals
scope: storage.bucket.public_access
domain: storage_and_database_security
subcategory: storage_encryption
severity: critical
title: Prevent Public Access to GCP Storage Buckets
rationale: Publicly accessible storage buckets can lead to unauthorized data exposure,
  resulting in data breaches or compliance violations. Ensuring no public principals
  have access to storage buckets protects sensitive data and helps meet regulatory
  requirements such as HIPAA and PCI-DSS, which mandate strict access controls.
description: This rule checks for any public principals (e.g., allUsers, allAuthenticatedUsers)
  that have access to storage buckets, which can be verified by examining the bucket's
  IAM policy. To remediate, remove public access by updating the bucket's IAM policy
  to restrict access to only authorized users or service accounts. This involves carefully
  auditing and modifying the bucket policy using the Google Cloud Console or the gcloud
  CLI to ensure compliance with data protection policies.
references:
- https://cloud.google.com/storage/docs/access-control/iam
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.hhs.gov/sites/default/files/hipaa-for-professionals.pdf
- https://cloud.google.com/iam/docs/overview
- https://cloud.google.com/storage/docs/best-practices
