rule_id: gcp.storage.notification.data_protection_bucket_cross_account_destinations_restricted
service: storage
resource: notification
requirement: Data Protection Bucket Cross Account Destinations Restricted
scope: storage.notification.security
domain: storage_and_database_security
subcategory: storage_encryption
severity: low
title: Restrict Cross-Account Storage Notification Destinations
rationale: Allowing storage bucket notifications to be sent to destinations in other
  accounts can expose sensitive data to unauthorized entities, increasing the risk
  of data breaches. This risk is particularly relevant in scenarios involving misconfigured
  access controls or compromised credentials. Limiting destinations to within the
  same account helps maintain control over data flows and supports compliance with
  data protection regulations such as GDPR and HIPAA.
description: This rule checks for storage bucket notifications configured to send
  data to destinations outside the originating GCP account. It is crucial to ensure
  that notifications are restricted to trusted endpoints within the same account to
  prevent unauthorized data exposure. To verify, review the notification configurations
  in each bucket and ensure they are limited to internal destinations. To remediate,
  modify the notification settings to remove any external endpoints and configure
  appropriate IAM policies to enforce this restriction.
references:
- https://cloud.google.com/storage/docs/gsutil/commands/notification
- https://cloud.google.com/security/compliance
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/storage/docs/access-control
- https://cloud.google.com/iam/docs/overview
