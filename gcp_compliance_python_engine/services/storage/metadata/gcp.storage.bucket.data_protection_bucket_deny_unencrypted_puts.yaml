rule_id: gcp.storage.bucket.data_protection_bucket_deny_unencrypted_puts
service: storage
resource: bucket
requirement: Data Protection Bucket Deny Unencrypted Puts
scope: storage.bucket.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Enforce Encryption for GCP Storage Bucket PUT Requests
rationale: Preventing unencrypted data from being uploaded to storage buckets is crucial
  for protecting sensitive information from unauthorized access and potential data
  breaches. It mitigates risks associated with data leakage and ensures compliance
  with regulatory requirements like GDPR, HIPAA, and PCI-DSS, which mandate encryption
  of data at rest.
description: This rule checks if GCP Storage Buckets are configured to deny PUT requests
  that do not specify server-side encryption. To verify, ensure that the bucket's
  IAM policy includes a condition that requires the 'x-goog-encryption-algorithm'
  header for PUT operations. Remediation involves updating the bucket policy to enforce
  this condition, ensuring all data is encrypted at rest using customer-managed keys
  or Google-managed encryption.
references:
- https://cloud.google.com/storage/docs/encryption
- https://cloud.google.com/security/compliance/cis-gcp-benchmark
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
