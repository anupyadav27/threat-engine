rule_id: gcp.storage.bucket.data_protection_fileshare_kms_key_policy_least_privilege
service: storage
resource: bucket
requirement: Data Protection Fileshare KMS Key Policy Least Privilege
scope: storage.bucket.policy_management
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure Least Privilege on KMS Key Policies for Storage Buckets
rationale: Implementing least privilege on KMS key policies reduces the risk of unauthorized
  access and potential data breaches. This is crucial for maintaining data confidentiality
  and integrity, especially when handling sensitive information subject to compliance
  regulations such as PCI-DSS and HIPAA. Over-permissive access can lead to data exposure
  and significant financial and reputational damage.
description: This rule checks if Cloud Key Management Service (KMS) key policies used
  by Cloud Storage buckets adhere to the principle of least privilege. It ensures
  that only necessary roles and identities have access to encryption keys, minimizing
  the attack surface. Verify the IAM policy on your KMS keys to confirm that only
  specific service accounts and users have the required permissions. Remediation involves
  reviewing and updating IAM policies to restrict permissions to the smallest scope
  necessary.
references:
- https://cloud.google.com/storage/docs/encryption/using-customer-managed-keys
- https://cloud.google.com/iam/docs/understanding-roles
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
