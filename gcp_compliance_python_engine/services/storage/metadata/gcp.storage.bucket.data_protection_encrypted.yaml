rule_id: gcp.storage.bucket.data_protection_encrypted
service: storage
resource: bucket
requirement: Data Protection Encrypted
scope: storage.bucket.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Cloud Storage Buckets Use Customer-Managed Encryption Keys
rationale: Encrypting data at rest in Cloud Storage buckets with customer-managed
  encryption keys (CMEK) provides enhanced data control and security. It mitigates
  the risk of unauthorized access by allowing organizations to manage their own encryption
  keys. This practice also aids in meeting stringent compliance requirements such
  as PCI-DSS and HIPAA by ensuring sensitive data is protected and access is logged.
description: This rule checks whether Cloud Storage buckets are configured to use
  CMEK for data encryption. It verifies that a Cloud KMS key is associated with each
  bucket. To remediate, navigate to the GCP Console, select the desired bucket, and
  update its encryption settings to use a key managed in Cloud KMS. This can also
  be automated using gcloud commands or Terraform scripts to enforce encryption policies
  consistently across your organization.
references:
- https://cloud.google.com/storage/docs/encryption/customer-managed-keys
- https://cloud.google.com/security/compliance/cis#gcp
- https://www.pcisecuritystandards.org/document_library
- https://cloud.google.com/security/compliance/hipaa
- https://cloud.google.com/kms/docs/
- https://cloud.google.com/storage/docs/json_api/v1/buckets/setIamPolicy
