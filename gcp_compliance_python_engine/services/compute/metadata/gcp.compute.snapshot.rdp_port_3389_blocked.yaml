rule_id: gcp.compute.snapshot.rdp_port_3389_blocked
service: compute
resource: snapshot
requirement: Rdp Port 3389 Blocked
scope: compute.snapshot.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Ensure RDP Port 3389 is Blocked on Compute Snapshots
rationale: Exposing RDP port 3389 can lead to unauthorized access and potential data
  breaches, especially if sensitive information is stored on instances. Blocking this
  port mitigates the risk of brute force attacks and unauthorized access, aligning
  with compliance and governance standards that require minimizing unnecessary exposure
  of services.
description: This check ensures that RDP port 3389 is not open on any snapshots of
  compute instances. Snapshots should be configured to block inbound traffic on port
  3389 to prevent unauthorized remote desktop access. Verify by reviewing firewall
  rules associated with the snapshots and adjust the rules to deny access on this
  port. Remediation involves updating firewall settings to explicitly block port 3389
  for all instances derived from these snapshots.
references:
- https://cloud.google.com/compute/docs/firewalls
- https://www.cisecurity.org/cis-benchmarks/
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/security/best-practices
- https://cloud.google.com/compute/docs/instances/windows/connecting-rdp
