rule_id: gcp.compute.url_map.edge_origin_request_policy_forward_headers_minimal
service: compute
resource: url_map
requirement: Edge Origin Request Policy Forward Headers Minimal
scope: compute.url_map.policy_management
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Minimize Forwarded Headers in Edge Origin Requests
rationale: Minimizing the headers forwarded in edge origin requests reduces the risk
  of exposing sensitive information and limits the attack surface. This is crucial
  for maintaining secure communication channels and protecting data integrity. Ensuring
  minimal header forwarding aligns with best practices for data protection and supports
  compliance with privacy regulations such as GDPR and CCPA.
description: This rule checks that Compute Engine URL Maps are configured to forward
  only necessary headers to origins. To verify, inspect the URL Map settings in the
  GCP Console or via gcloud CLI to ensure the 'edgeSecurityPolicy' is set to forward
  minimal headers. Remediation involves adjusting the policy to exclude unnecessary
  headers, thus enhancing data privacy and security.
references:
- https://cloud.google.com/load-balancing/docs/https/policies
- https://cloud.google.com/security/compliance/cis-gcp-foundations-benchmark
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/docs/security
- https://www.pcisecuritystandards.org/pci_security/
