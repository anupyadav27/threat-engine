rule_id: gcp.compute.instance.vpc_subnet_flow_logs_compliance_configured
service: compute
resource: instance
requirement: VPC Subnet Flow Logs Compliance Configured
scope: compute.instance.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: low
title: Ensure VPC Subnet Flow Logs Are Enabled for Instances
rationale: Enabling VPC subnet flow logs is crucial for monitoring network traffic,
  detecting anomalous behavior, and fulfilling audit requirements. It helps in identifying
  potential security threats, such as data exfiltration or unauthorized access patterns,
  thereby reducing the risk of data breaches. Compliance with regulatory frameworks
  often mandates detailed logging for forensic analysis and reporting purposes.
description: This rule checks if flow logs are enabled for VPC subnets associated
  with instances in your GCP environment. VPC flow logs capture information about
  the ingress and egress IP traffic, which can be used for performance analysis and
  security insights. To verify, ensure that the 'Enable flow logs' option is active
  on your VPC subnets. Remediation involves navigating to the VPC network details
  in the GCP Console, selecting 'Edit' for the subnet, and enabling flow logs, specifying
  the desired log format and sampling rate.
references:
- https://cloud.google.com/vpc/docs/flow-logs
- https://cloud.google.com/security/compliance/cis-gcp-benchmark
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/logging/docs/reference
- https://cloud.google.com/security/best-practices
