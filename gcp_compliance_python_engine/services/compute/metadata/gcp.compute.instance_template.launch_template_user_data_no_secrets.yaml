rule_id: gcp.compute.instance_template.launch_template_user_data_no_secrets
service: compute
resource: instance_template
requirement: Launch Template User Data No Secrets
scope: compute.instance_template.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: high
title: Ensure No Secrets in Instance Template User Data
rationale: Storing secrets such as passwords, API keys, or sensitive configuration
  data in instance templates can lead to unauthorized access and data breaches. This
  poses significant security risks, including potential exposure of sensitive data
  and violation of compliance standards like PCI-DSS and HIPAA. Protecting these secrets
  is crucial to maintaining the integrity and confidentiality of your systems.
description: This rule checks that sensitive data is not included in the user data
  field of GCP compute instance templates. Storing secrets in this field can lead
  to exposure as the user data is accessible to any user with read access to the instance
  template. To remediate, use secret management tools like Google Secret Manager to
  securely store and access sensitive data, and ensure instance templates are configured
  without embedding secrets directly.
references:
- https://cloud.google.com/compute/docs/instance-templates
- https://cloud.google.com/secret-manager/docs
- 'CIS GCP Benchmark: 1.0.0 - Ensure Instance Templates Do Not Contain Sensitive Data'
- 'NIST SP 800-53: AC-6 Least Privilege'
- 'PCI-DSS Requirement 3: Protect Stored Cardholder Data'
- https://cloud.google.com/security/best-practices
