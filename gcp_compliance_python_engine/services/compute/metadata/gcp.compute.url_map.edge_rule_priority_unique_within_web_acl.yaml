rule_id: gcp.compute.url_map.edge_rule_priority_unique_within_web_acl
service: compute
resource: url_map
requirement: Edge Rule Priority Unique Within Web ACL
scope: compute.url_map.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Ensure Unique Edge Rule Priority in URL Maps
rationale: Unique priorities for edge rules within a URL map are crucial to ensuring
  predictable traffic routing and security rule application. Duplicate priorities
  can lead to conflicts and unexpected behavior, potentially exposing services to
  unauthorized access or data leakage. Maintaining unique priorities helps in complying
  with organizational security policies and regulatory requirements by ensuring clarity
  and control over network traffic management.
description: This rule checks that each edge rule within a URL map in Google Cloud
  has a unique priority. URL maps are used to route requests to appropriate backend
  services, and edge rules define specific behaviors based on request attributes.
  Conflicting priorities can lead to ambiguous routing decisions, so it is important
  to assign distinct priorities to each rule. To remediate, review and update the
  URL map configurations to ensure each edge rule has a unique priority value, and
  test routing behavior post-update.
references:
- https://cloud.google.com/load-balancing/docs/url-map-concepts
- https://cloud.google.com/security/compliance/cis-gcp-foundations-benchmark
- https://cloud.google.com/docs/enterprise/best-practices-for-enterprise-organizations
- https://cloud.google.com/security/compliance
