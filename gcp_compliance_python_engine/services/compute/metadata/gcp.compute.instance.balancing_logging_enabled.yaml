rule_id: gcp.compute.instance.balancing_logging_enabled
service: compute
resource: instance
requirement: Balancing Logging Enabled
scope: compute.instance.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: medium
title: Enable Load Balancer Logging for Compute Instances
rationale: Enabling logging for load-balanced compute instances in GCP provides critical
  insights into traffic patterns and potential security threats. Without logging,
  anomalous activities and unauthorized access attempts may go undetected, increasing
  the risk of data breaches and non-compliance with regulatory standards such as PCI-DSS
  and SOC2. Logging aids in forensic analysis, operational troubleshooting, and ensures
  adherence to audit requirements.
description: This rule checks if load balancing logging is enabled for compute instances.
  To verify, ensure that the HTTP(S) load balancer associated with the compute instance
  has logging configured in the Google Cloud Console under 'Network services' > 'Load
  balancing'. Remediation involves enabling logging at the load balancer level, specifying
  a Cloud Storage bucket for logs. This process includes setting up IAM permissions
  to allow the load balancer to write logs to the specified bucket.
references:
- https://cloud.google.com/load-balancing/docs/https/logging
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://cloud.google.com/security/compliance/resources/pci-dss
- https://cloud.google.com/security/compliance/soc-2
- https://cloud.google.com/logging/docs/audit/configure-data-access
- https://cloud.google.com/iam/docs/understanding-service-accounts
