rule_id: gcp.compute.instance.block_project_wide_ssh_keys_disabled
service: compute
resource: instance
requirement: Block Project Wide Ssh Keys Disabled
scope: compute.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: high
title: Ensure Block Project-Wide SSH Keys Enabled for Instances
rationale: Disabling project-wide SSH keys prevents unauthorized access to instances
  by limiting SSH key usage to instance-specific keys only. This reduces the risk
  of unauthorized access due to compromised keys that might be used across multiple
  instances, thus enhancing security posture. Ensuring this setting aligns with compliance
  requirements like PCI-DSS and HIPAA, which mandate strict access controls.
description: This rule checks whether the 'blockProjectWideSshKeys' setting is enabled
  for GCP Compute Instances. Enabling this setting ensures that only instance-specific
  SSH keys are allowed, preventing the use of project-wide keys that could lead to
  unintended access. To verify, inspect the instance's metadata and ensure the 'blockProjectWideSshKeys'
  attribute is set to true. Remediation involves updating the instance metadata to
  enable this setting via the GCP Console or gcloud CLI.
references:
- https://cloud.google.com/compute/docs/oslogin
- https://cloud.google.com/security/compliance
- https://cloud.google.com/compute/docs/instances/connecting-advanced#project-wide-keys
- CIS Google Cloud Platform Foundation Benchmark v1.1.0, Section 4.3
- PCI-DSS Requirement 7.1.2
- ISO 27001 Annex A.9.4.2
