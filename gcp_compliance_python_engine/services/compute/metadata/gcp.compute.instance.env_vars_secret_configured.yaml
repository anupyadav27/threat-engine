rule_id: gcp.compute.instance.env_vars_secret_configured
service: compute
resource: instance
requirement: Env Vars Secret Configured
scope: compute.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: high
title: Ensure Secrets in Environment Variables are Securely Configured
rationale: Storing sensitive data such as API keys, database credentials, or other
  secrets in environment variables without proper security measures can lead to unauthorized
  access and data breaches. This practice can expose critical business operations
  to cyber threats and compromise compliance with standards like PCI-DSS and HIPAA,
  which mandate strict controls over sensitive information handling.
description: This rule checks if sensitive information is stored securely within the
  environment variables of Google Compute Engine (GCE) instances. It verifies that
  secrets are encrypted and managed through GCP Secret Manager rather than being stored
  in plaintext. To remediate, ensure that all secrets are moved to Secret Manager,
  and access them programmatically within your application using IAM roles and permissions.
  Follow the principle of least privilege to limit access to these secrets.
references:
- https://cloud.google.com/compute/docs/instances
- https://cloud.google.com/secret-manager/docs
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/pci_security/
- https://www.hipaajournal.com/hipaa-security-rule/
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
