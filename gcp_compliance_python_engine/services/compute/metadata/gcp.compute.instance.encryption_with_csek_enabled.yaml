rule_id: gcp.compute.instance.encryption_with_csek_enabled
service: compute
resource: instance
requirement: Encryption With Csek Enabled
scope: compute.instance.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Enforce Customer-Supplied Encryption Keys for VM Disks
rationale: Utilizing customer-supplied encryption keys (CSEK) ensures that the data
  remains under the customer's control, even if Google Cloud Platform experiences
  a breach. This approach aligns with stringent compliance requirements such as GDPR
  and PCI-DSS, which mandate robust data protection measures. Without CSEK, sensitive
  data may be at risk of unauthorized access, leading to significant financial and
  reputational damage.
description: This rule checks whether Google Compute Engine VM instances are configured
  to use customer-supplied encryption keys (CSEK) for disk encryption. To verify,
  check that the disks associated with the instances are encrypted with keys managed
  by the customer rather than Google. Remediation involves updating the disk encryption
  settings to use CSEK, which can be done via the GCP Console, CLI, or API by specifying
  the CSEK during instance creation or disk attachment.
references:
- https://cloud.google.com/compute/docs/disks/customer-supplied-encryption
- https://cloud.google.com/security/compliance/cis-benchmarks
- https://www.pcisecuritystandards.org/pci_security/
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/security/encryption-at-rest/default-encryption
