rule_id: gcp.compute.instance.vm_user_data_no_secrets
service: compute
resource: instance
requirement: VM User Data No Secrets
scope: compute.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: high
title: Ensure VM User Data Does Not Contain Secrets
rationale: Storing secrets such as API keys, passwords, or private keys in VM user
  data poses significant security risks. Unauthorized access to these secrets can
  lead to data breaches, financial loss, or compromised services. Regulatory compliance
  frameworks like PCI-DSS and HIPAA mandate secure handling of sensitive information,
  making it crucial to avoid embedding secrets in VM configurations.
description: This rule checks that VM user data does not contain any sensitive information
  such as secrets or credentials. User data is often used for instance initialization
  scripts, but it should never include confidential data. Verify user data configurations
  through the GCP Console or CLI and ensure encryption and secret management solutions
  like Google Secret Manager are used for sensitive data. Remediation involves auditing
  user data and removing any embedded secrets, replacing them with secure reference
  calls to managed secret services.
references:
- https://cloud.google.com/compute/docs/metadata/overview
- https://cloud.google.com/secret-manager/docs
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/security/compliance
