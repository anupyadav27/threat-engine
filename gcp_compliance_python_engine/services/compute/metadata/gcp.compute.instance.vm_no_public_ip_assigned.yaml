rule_id: gcp.compute.instance.vm_no_public_ip_assigned
service: compute
resource: instance
requirement: VM No Public Ip Assigned
scope: compute.instance.public_access
domain: compute_and_workload_security
subcategory: instance_configuration
severity: critical
title: Ensure VM Instances Have No Public IP Assigned
rationale: Public IP addresses on VM instances expose them to the internet, increasing
  the risk of unauthorized access, DDoS attacks, and data breaches. This can lead
  to loss of sensitive data, service disruption, and non-compliance with regulations
  such as PCI-DSS and GDPR, which mandate secure handling of data.
description: This rule checks whether any VM instances have public IP addresses assigned,
  which should be avoided to reduce exposure to external attacks. Ensure that VM instances
  are only accessible through secure internal networks or via a VPN. To remediate,
  configure instances to use private IPs and access them through a bastion host or
  secure gateway. You can verify this setting in the Google Cloud Console under the
  instance's network interface settings.
references:
- https://cloud.google.com/compute/docs/ip-addresses#ephemeraladdress
- https://cloud.google.com/security/compliance/cis
- https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
- https://cloud.google.com/architecture/best-practices-vpc-design
