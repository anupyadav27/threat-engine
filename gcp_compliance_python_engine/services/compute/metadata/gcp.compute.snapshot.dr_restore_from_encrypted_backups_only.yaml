rule_id: gcp.compute.snapshot.dr_restore_from_encrypted_backups_only
service: compute
resource: snapshot
requirement: DR Restore From Encrypted Backups Only
scope: compute.snapshot.encryption
domain: resilience_and_disaster_recovery
subcategory: backup_configuration
severity: medium
title: Ensure Snapshots are Restored from Encrypted Backups Only
rationale: Restoring from encrypted backups ensures data confidentiality and integrity,
  mitigating the risk of data breaches during disaster recovery. This practice protects
  sensitive information from unauthorized access, and aligns with compliance requirements
  such as GDPR and PCI-DSS, which mandate strong encryption for data at rest.
description: This rule verifies that all Compute Engine snapshots used for disaster
  recovery are created with encryption. To ensure compliance, check that snapshots
  are encrypted using either Google-managed or customer-supplied encryption keys.
  To remediate, enable encryption on existing snapshots by creating new encrypted
  snapshots from the original disks, and ensure all future snapshots are encrypted
  by default.
references:
- https://cloud.google.com/compute/docs/disks/snapshots
- https://cloud.google.com/security/compliance
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
- https://cloud.google.com/security/encryption-at-rest/default-encryption
