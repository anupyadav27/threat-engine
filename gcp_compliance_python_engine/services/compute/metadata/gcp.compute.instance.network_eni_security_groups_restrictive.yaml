rule_id: gcp.compute.instance.network_eni_security_groups_restrictive
service: compute
resource: instance
requirement: Network Eni Security Groups Restrictive
scope: compute.instance.network_security
domain: network_security_and_connectivity
subcategory: network_access_control
severity: medium
title: Ensure Network ENI Security Groups are Restrictive
rationale: Restrictive security group configurations minimize the attack surface by
  limiting unnecessary access to instances, reducing the risk of unauthorized access
  or data breaches. Properly configured security groups help comply with regulations
  such as PCI-DSS and HIPAA, which mandate robust network access controls.
description: This rule checks that security groups associated with network interfaces
  (ENIs) of compute instances enforce restrictive ingress and egress rules. Specifically,
  it requires that only necessary ports and IP addresses are allowed. To verify, review
  security group rules for overly permissive settings, such as open ports to any IP.
  Remediation involves updating security group rules to follow the principle of least
  privilege, ensuring only trusted IPs can access necessary services.
references:
- https://cloud.google.com/vpc/docs/using-firewalls
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
