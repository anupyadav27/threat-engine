rule_id: gcp.compute.firewall.network_sg_only_required_ports_open
service: compute
resource: firewall
requirement: Network Sg Only Required Ports Open
scope: compute.firewall.network_security
domain: network_security_and_connectivity
subcategory: network_access_control
severity: medium
title: Restrict Firewall to Open Only Necessary Ports
rationale: Opening unnecessary ports in network security groups increases the attack
  surface, potentially allowing unauthorized access to systems and data. This can
  lead to breaches, data loss, and non-compliance with regulations such as PCI-DSS
  and HIPAA, which mandate strict access controls.
description: This rule checks GCP firewall configurations to ensure that only required
  ports are open, minimizing exposure to potential threats. Firewall rules should
  be configured to allow traffic only on specific ports needed for business operations.
  Verification involves reviewing firewall rules in the Google Cloud Console or via
  gcloud commands and closing any ports not essential for application functionality.
  Remediation includes updating firewall rules to restrict access and logging rule
  changes for audit purposes.
references:
- https://cloud.google.com/vpc/docs/using-firewalls
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/
- https://www.hipaajournal.com/hipaa-compliance-guide/
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- https://www.iso.org/iso-27001-information-security.html
