rule_id: gcp.compute.instance.key_pair_disable_unused_keys
service: compute
resource: instance
requirement: Key Pair Disable Unused Keys
scope: compute.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: high
title: Disable Unused SSH Keys on Compute Instances
rationale: Unused SSH keys on compute instances pose a significant security risk as
  they may allow unauthorized access if compromised. This is particularly critical
  in environments where key rotation and user deactivation are not consistently managed.
  Disabling unused keys reduces the attack surface and helps maintain compliance with
  security standards such as CIS benchmarks and regulatory frameworks like PCI-DSS
  and ISO 27001.
description: This rule checks for and disables any SSH keys on GCP Compute Engine
  instances that have not been used for a predefined period, indicating potential
  obsolescence or abandonment. To verify, review the instance metadata for SSH keys
  and cross-reference with access logs to determine usage patterns. Remediation involves
  removing or disabling keys that have not been accessed within the organization's
  key management policy timeframe. This can be automated using IAM policies and regular
  audits of access logs.
references:
- https://cloud.google.com/compute/docs/instances/adding-removing-ssh-keys
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/security/best-practices
- https://cloud.google.com/iam/docs/overview
