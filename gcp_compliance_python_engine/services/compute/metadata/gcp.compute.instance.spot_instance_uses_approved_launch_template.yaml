rule_id: gcp.compute.instance.spot_instance_uses_approved_launch_template
service: compute
resource: instance
requirement: Spot Instance Uses Approved Launch Template
scope: compute.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Ensure Spot Instances Use Approved Launch Templates
rationale: Using approved launch templates for Spot Instances ensures that instances
  are created with consistent and secure configurations. It mitigates risks associated
  with misconfigurations which could lead to vulnerabilities, data exposure, or service
  disruptions. This is particularly important for maintaining compliance with security
  standards and reducing the operational costs associated with manual configuration
  errors.
description: This rule checks that all Spot Instances in your GCP environment are
  launched using pre-approved launch templates. These templates should include security
  settings such as firewall rules, IAM roles, and instance metadata settings. To verify,
  review instance configurations in the GCP Console or use the gcloud CLI to ensure
  templates are used consistently. If discrepancies are found, update your launch
  processes to enforce template usage and document any exceptions.
references:
- https://cloud.google.com/compute/docs/instances/spot
- https://cloud.google.com/compute/docs/instance-templates
- https://cloud.google.com/security/compliance
- CIS Google Cloud Platform Foundation Benchmark v1.3.0 - 3.1
- NIST SP 800-53 Rev. 5
- ISO/IEC 27001:2013
