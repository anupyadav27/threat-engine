rule_id: gcp.compute.security_policy.edge_waf_web_acl_attached_to_cdn
service: compute
resource: security_policy
requirement: Edge Waf Web ACL Attached To Cdn
scope: compute.security_policy.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Ensure Edge WAF Web ACL is Attached to GCP CDN
rationale: Attaching an Edge WAF Web ACL to a CDN in GCP helps mitigate web-based
  attacks such as SQL injection and cross-site scripting, reducing the risk of data
  breaches and service disruptions. This is critical for maintaining the integrity
  and availability of web applications and ensuring compliance with industry standards
  like PCI-DSS and ISO 27001.
description: This rule checks if an Edge WAF Web ACL is attached to a Google Cloud
  CDN, ensuring incoming traffic is filtered through configured security policies.
  Verify by checking the security policy configuration in the Cloud Console or via
  gcloud CLI. If missing, attach an appropriate Web ACL to your CDN distribution to
  filter out malicious requests. Remediation involves creating or selecting a Web
  ACL with rules tailored to your application's security needs and associating it
  with your CDN.
references:
- https://cloud.google.com/cdn/docs/security
- https://cloud.google.com/armor/docs/security-policy-concepts
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.iso.org/isoiec-27001-information-security.html
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://cloud.google.com/armor/docs/rule-tuning
