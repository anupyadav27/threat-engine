rule_id: gcp.compute.url_map.edge_rule_references_valid_ip_or_regex_sets_only
service: compute
resource: url_map
requirement: Edge Rule References Valid Ip Or Regex Sets Only
scope: compute.url_map.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Validate IP/Regex Sets in URL Map Edge Rules
rationale: Ensuring edge rules in URL maps reference valid IP or regex sets helps
  prevent unauthorized access and potential misconfigurations that could lead to exposure
  of sensitive data. This is crucial for maintaining the integrity of network traffic
  management and aligning with security best practices. Proper validation supports
  compliance with regulatory standards by ensuring that only intended traffic patterns
  are matched and processed.
description: This rule checks that edge rules in GCP URL maps only reference valid
  IP or regex sets. Invalid references can lead to unintended access or misdirected
  traffic, compromising the security of applications. To verify compliance, review
  your URL map configurations in the Google Cloud Console or via the gcloud command-line
  tool, ensuring all edge rules are correctly referencing existing and authorized
  IP or regex sets. Remediate by updating any invalid references to point to correct
  and authorized sets.
references:
- https://cloud.google.com/load-balancing/docs/https/https-load-balancer-url-map
- https://cloud.google.com/load-balancing/docs/https/setting-up-https
- https://cloud.google.com/security/compliance
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://cloud.google.com/architecture/best-practices-for-cloud-security-controls
