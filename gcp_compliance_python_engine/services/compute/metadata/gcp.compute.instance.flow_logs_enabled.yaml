rule_id: gcp.compute.instance.flow_logs_enabled
service: compute
resource: instance
requirement: Flow Logs Enabled
scope: compute.instance.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: low
title: Ensure VPC Flow Logs are Enabled for Compute Instances
rationale: Enabling VPC Flow Logs for Google Cloud Compute Instances is crucial for
  monitoring network traffic, diagnosing network issues, and ensuring compliance with
  security policies. It provides visibility into traffic patterns and helps detect
  anomalies, which could indicate potential security threats or misuse. This logging
  capability supports incident response and forensic investigations, aligning with
  regulatory requirements such as PCI-DSS and ISO 27001.
description: This rule verifies that VPC Flow Logs are enabled for each Google Cloud
  Compute Instance. Flow Logs capture IP traffic information flowing to and from network
  interfaces, which can be enabled by configuring the subnet containing the instance.
  To verify, access the Google Cloud Console, navigate to the VPC network settings,
  and ensure Flow Logs are set to 'On' for the respective subnets. Remediation involves
  enabling Flow Logs in the subnet configuration, specifying log aggregation options
  such as sampling rate and log format.
references:
- https://cloud.google.com/vpc/docs/using-flow-logs
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance/iso-27001
- https://cloud.google.com/security/compliance/pci-dss
- https://cloud.google.com/security/compliance/soc-2
- https://cloud.google.com/blog/products/gcp/using-vpc-flow-logs-and-bigquery-for-network-analytics
