rule_id: gcp.compute.instance.ip_forwarding_configured
service: compute
resource: instance
requirement: Ip Forwarding Configured
scope: compute.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Ensure IP Forwarding is Properly Configured for Instances
rationale: Improper configuration of IP forwarding on instances can lead to unauthorized
  data transit, making the network susceptible to man-in-the-middle attacks and data
  exfiltration. Ensuring IP forwarding is correctly set aligns with security best
  practices and helps maintain compliance with industry standards such as PCI-DSS
  and NIST, which require stringent control over network traffic.
description: This check verifies whether IP forwarding is enabled on Google Compute
  Engine instances, which may be necessary for specific network configurations such
  as NAT or VPN gateways. However, it should be disabled for instances not intended
  to forward packets to prevent unauthorized routing. To verify, review the 'canIpForward'
  setting in the instance configuration. Remediation involves disabling IP forwarding
  for non-gateway instances by setting 'canIpForward' to false in the instance's properties.
references:
- https://cloud.google.com/compute/docs/troubleshooting/general-tips#ipforwarding
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/security/compliance
- https://cloud.google.com/compute/docs/instances/create-start-instance
