rule_id: gcp.compute.instance.vm_data_volumes_encrypted_cmek
service: compute
resource: instance
requirement: VM Data Volumes Encrypted Cmek
scope: compute.instance.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure VM Data Volumes Use CMEK for Encryption
rationale: Encrypting VM data volumes with Customer-Managed Encryption Keys (CMEK)
  enhances data protection by allowing organizations to control key rotation, revocation,
  and management. This mitigates risks such as unauthorized access and data breaches,
  which can have significant financial and reputational impacts. Compliance with regulatory
  frameworks like PCI-DSS and HIPAA often requires strict encryption controls.
description: This rule checks if Google Cloud Platform Compute Engine VM instances
  use Customer-Managed Encryption Keys for encrypting attached data volumes. To verify,
  review the 'properties.disks' field in the VM instance configurations for the 'kmsKeyName'
  attribute. If it's absent, update the instance configuration to include a CMEK.
  Remediation involves specifying a KMS key in the VM instance settings, ensuring
  that data is encrypted using organization-controlled keys.
references:
- https://cloud.google.com/compute/docs/disks/customer-managed-encryption
- https://cloud.google.com/security/compliance/cis-gcp-foundations-benchmark
- https://cloud.google.com/security/compliance/pci-dss
- https://cloud.google.com/security/compliance/hipaa
- https://cloud.google.com/security/compliance/soc-2
- https://cloud.google.com/security/compliance/iso-27001
