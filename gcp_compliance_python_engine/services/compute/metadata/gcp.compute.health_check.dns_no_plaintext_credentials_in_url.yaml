rule_id: gcp.compute.health_check.dns_no_plaintext_credentials_in_url
service: compute
resource: health_check
requirement: Dns No Plaintext Credentials In Url
scope: compute.health_check.security
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Avoid Plaintext Credentials in Health Check URLs
rationale: Including plaintext credentials in DNS health check URLs can lead to unauthorized
  access if intercepted, compromising system integrity and exposing sensitive data.
  This practice increases the risk of credential leakage, potentially violating compliance
  requirements such as ISO 27001 and PCI-DSS, and can result in severe business impacts
  including data breaches and financial loss.
description: This rule checks that no plaintext credentials are embedded in DNS health
  check URLs within GCP Compute Engine configurations. Review and ensure that health
  check configurations do not include credentials in the URL or switch to using secure
  methods like OAuth tokens or service accounts. Remediation involves updating the
  health check settings and ensuring credentials are managed securely through GCP's
  Secret Manager or environment variables.
references:
- https://cloud.google.com/compute/docs/load-balancing/health-checks
- https://cloud.google.com/security/compliance/cis-gcp-foundations-benchmark
- https://www.iso.org/standard/54534.html
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/secret-manager/docs/best-practices
- https://cloud.google.com/iam/docs/understanding-service-accounts
