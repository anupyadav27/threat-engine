rule_id: gcp.compute.snapshot.dr_backup_encrypted_at_rest_cmek
service: compute
resource: snapshot
requirement: DR Backup Encrypted At Rest Cmek
scope: compute.snapshot.encryption
domain: resilience_and_disaster_recovery
subcategory: backup_configuration
severity: medium
title: Ensure Snapshots Are Encrypted with Customer-Managed Keys
rationale: Encrypting snapshots using Customer-Managed Encryption Keys (CMEK) enhances
  data confidentiality and control, reducing the risk of unauthorized access during
  a disaster recovery scenario. This approach aligns with compliance standards that
  require strong encryption methods and empowers organizations to manage encryption
  keys, crucial for sectors handling sensitive data.
description: This rule verifies that all Compute Engine snapshots are encrypted at
  rest using Customer-Managed Encryption Keys (CMEK). By default, Google Cloud encrypts
  data with Google-managed keys, but using CMEK provides greater control and allows
  for key rotation and revocation policies. To comply, ensure that snapshot configurations
  specify CMEK, which can be verified via the GCP Console or gcloud CLI. Remediation
  involves updating snapshot settings to refer to the appropriate CMEK.
references:
- https://cloud.google.com/compute/docs/disks/customer-supplied-encryption
- https://cloud.google.com/security/encryption-at-rest/default-encryption
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
- https://cloud.google.com/security/compliance
- https://cloud.google.com/kms/docs
