rule_id: gcp.compute.url_map.edge_cache_policy_no_sensitive_headers_cached
service: compute
resource: url_map
requirement: Edge Cache Policy No Sensitive Headers Cached
scope: compute.url_map.policy_management
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Prevent Caching of Sensitive Headers in Edge Cache Policies
rationale: Caching sensitive headers at the edge can expose confidential information
  such as authentication tokens or personal data, increasing the risk of unauthorized
  access and data breaches. This practice can compromise user privacy and violate
  compliance standards like GDPR, PCI-DSS, and HIPAA, leading to potential legal penalties
  and reputational damage.
description: This rule checks if URL maps in GCP Compute Engine have edge cache policies
  that improperly cache sensitive headers. Configuration should exclude headers like
  Authorization or Set-Cookie from being cached. To verify, inspect the edge cache
  configuration within each URL map and ensure sensitive headers are omitted. Remediation
  involves updating the edge cache settings to exclude sensitive headers and aligning
  with best practices for secure data handling.
references:
- https://cloud.google.com/load-balancing/docs/https/traffic-management#cache-key-policy
- https://cloud.google.com/security/compliance/cis#gcp-compute-engine-2-0
- https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
- https://www.nist.gov/cyberframework
- https://cloud.google.com/security/best-practices#data_protection
- https://cloud.google.com/architecture/security-foundations
