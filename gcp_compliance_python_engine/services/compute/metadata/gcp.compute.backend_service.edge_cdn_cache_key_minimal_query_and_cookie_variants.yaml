rule_id: gcp.compute.backend_service.edge_cdn_cache_key_minimal_query_and_cookie_variants
service: compute
resource: backend_service
requirement: Edge Cdn Cache Key Minimal Query And Cookie Variants
scope: compute.backend_service.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure Minimal Query and Cookie Variants for CDN Cache Keys
rationale: This rule helps prevent cache poisoning attacks by ensuring that Google
  Cloud's CDN cache keys are minimally affected by query strings and cookies. By minimizing
  these variants, the backend service reduces risk of unauthorized data exposure and
  ensures consistent content delivery, which is crucial for maintaining data integrity
  and meeting compliance requirements such as PCI-DSS and GDPR.
description: This check ensures that the CDN cache key configuration for Google Cloud
  Backend Services is set to use minimal query and cookie variants. This involves
  verifying the 'includeHttpHeaders', 'includeNamedCookies', and 'queryStringWhitelist'
  settings in the backend service configuration. To remediate, adjust these settings
  to only include necessary cookies and query parameters, or use a whitelist approach
  to limit exposure. This minimizes cache key variability, enhancing security and
  performance.
references:
- https://cloud.google.com/cdn/docs/caching
- https://cloud.google.com/architecture/best-practices-for-using-cdn#cache_keys
- CIS Google Cloud Platform Foundation Benchmark v1.3.0 - Control 4.9
- PCI-DSS Requirement 6.5 - Develop security guidelines and procedures
- 'NIST SP 800-53 Rev. 5: SI-10 - Information Input Validation'
- https://cloud.google.com/security/compliance
