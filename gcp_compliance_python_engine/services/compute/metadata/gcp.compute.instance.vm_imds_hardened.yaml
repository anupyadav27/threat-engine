rule_id: gcp.compute.instance.vm_imds_hardened
service: compute
resource: instance
requirement: VM Imds Hardened
scope: compute.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Harden Metadata Server Access on VM Instances
rationale: Properly securing access to the VM Instance Metadata Server (IMDS) mitigates
  risks of unauthorized access to sensitive metadata, which could lead to privilege
  escalation or data exfiltration. This is crucial for maintaining the integrity and
  confidentiality of workloads running in Google Cloud, and aligns with regulatory
  requirements like PCI-DSS and ISO 27001.
description: This rule checks that VM instances have restricted access to the metadata
  server by utilizing GCP firewall rules or configuring the metadata concealment feature.
  To verify, ensure that the metadata server is only accessible from trusted sources
  or has been disabled where not needed. Remediation involves setting up network tags
  and firewall rules that block access to the metadata server from unauthorized sources,
  or using GCP's metadata concealment feature to limit exposure.
references:
- https://cloud.google.com/compute/docs/storing-retrieving-metadata
- https://cloud.google.com/compute/docs/security-best-practices
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://cloud.google.com/security/compliance/pci-dss
- https://cloud.google.com/security/compliance/iso-27001
