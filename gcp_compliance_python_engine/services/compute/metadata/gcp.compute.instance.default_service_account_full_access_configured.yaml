rule_id: gcp.compute.instance.default_service_account_full_access_configured
service: compute
resource: instance
requirement: Default Service Account Full Access Configured
scope: compute.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Avoid Default Service Account Full Access on Compute Instances
rationale: Using the default service account with full access on compute instances
  can lead to over-privileged configurations, increasing the risk of unauthorized
  access and potential data breaches. This can compromise the principle of least privilege,
  leading to non-compliance with security standards such as CIS, NIST, and ISO 27001,
  which emphasize minimal access and role-based permissions.
description: This rule checks whether GCP compute instances are configured to use
  the default service account with full access. Such a configuration can unintentionally
  grant more permissions than necessary, making it critical to customize service accounts
  with the least privilege principle in mind. To remediate, create a custom service
  account with only the necessary permissions and update the compute instance to use
  this account instead of the default. Verification can be done through the Google
  Cloud Console or using the gcloud command-line tool.
references:
- https://cloud.google.com/compute/docs/access/service-accounts
- https://cloud.google.com/iam/docs/service-accounts
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/docs/security/compliance
- https://cloud.google.com/security/best-practices
- https://cloud.google.com/iam/docs/understanding-service-accounts
