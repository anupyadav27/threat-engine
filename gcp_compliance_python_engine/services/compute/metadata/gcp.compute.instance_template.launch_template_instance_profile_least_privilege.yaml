rule_id: gcp.compute.instance_template.launch_template_instance_profile_least_privilege
service: compute
resource: instance_template
requirement: Launch Template Instance Profile Least Privilege
scope: compute.instance_template.least_privilege
domain: compute_and_workload_security
subcategory: instance_configuration
severity: high
title: Ensure Instance Templates Use Least Privilege Profiles
rationale: Ensuring instance templates use the least privilege principle minimizes
  the attack surface by restricting unnecessary permissions, reducing the risk of
  exploitation in case of a compromised instance. This approach mitigates potential
  data breaches and aligns with compliance frameworks that require stringent access
  controls to protect sensitive information.
description: This rule checks that instance templates in GCP do not associate with
  overly permissive IAM roles. It verifies that the service accounts tied to instance
  templates have the minimum required permissions. To remediate, review the permissions
  granted through IAM roles and adjust them to ensure only essential permissions are
  assigned. This involves using custom roles tailored to the specific needs of applications
  running on the instances.
references:
- https://cloud.google.com/compute/docs/instance-templates
- https://cloud.google.com/iam/docs/understanding-roles
- https://cloud.google.com/security/compliance/cis-benchmarks
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://cloud.google.com/security/best-practices/identity
- https://cloud.google.com/iam/docs/least-privilege
