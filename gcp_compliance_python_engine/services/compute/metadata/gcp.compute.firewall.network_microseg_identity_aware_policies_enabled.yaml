rule_id: gcp.compute.firewall.network_microseg_identity_aware_policies_enabled
service: compute
resource: firewall
requirement: Network Microseg Identity Aware Policies Enabled
scope: compute.firewall.network_security
domain: network_security_and_connectivity
subcategory: network_access_control
severity: medium
title: Enable Identity-Aware Policies for Network Microsegmentation
rationale: Identity-aware policies enhance security by enforcing access controls based
  on user identity and context, reducing the risk of unauthorized access to sensitive
  data. This approach helps in mitigating insider threats and limits the attack surface
  by ensuring only authenticated and authorized entities can access specific network
  segments. It also aids in meeting compliance with regulations such as GDPR and HIPAA,
  which mandate stringent access controls.
description: This rule checks if identity-aware policies are enabled for microsegmented
  networks in GCP. These policies should be configured to restrict access based on
  user identity and contextual attributes. Verification involves reviewing firewall
  rules to ensure they incorporate identity-based restrictions. To remediate, configure
  Identity-Aware Proxy (IAP) for your applications and define firewall rules that
  incorporate identity conditions to control access effectively.
references:
- https://cloud.google.com/iap/docs/concepts-overview
- https://cloud.google.com/security-command-center/docs/concepts-cspm
- CIS Google Cloud Platform Foundation Benchmark v1.3.0, Control 9.1
- NIST SP 800-53 Rev. 5, AC-3 Access Enforcement
- https://cloud.google.com/security/infrastructure/design
- ISO/IEC 27001:2013, A.9.1.2 Access Control Policy
