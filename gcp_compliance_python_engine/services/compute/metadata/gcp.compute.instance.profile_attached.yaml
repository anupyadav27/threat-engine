rule_id: gcp.compute.instance.profile_attached
service: compute
resource: instance
requirement: Profile Attached
scope: compute.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Verify Compute Instances Have Service Accounts Attached
rationale: Attaching a service account to a Compute Engine instance is essential for
  controlling permissions and access to other Google Cloud services. Without a service
  account, instances may operate with excessive privileges or lack necessary access,
  increasing the risk of unauthorized actions or service disruptions. Adhering to
  this practice supports compliance with security frameworks by ensuring least privilege
  access.
description: This rule checks whether all Compute Engine instances have a service
  account profile attached. Instances without a service account lack the ability to
  access Google Cloud APIs securely, potentially leading to security vulnerabilities.
  To verify, inspect the 'serviceAccounts' property of the instance configuration.
  If missing, attach an appropriate service account with minimal permissions required
  for the instance's operations. This can be done via the GCP Console or gcloud CLI.
references:
- https://cloud.google.com/compute/docs/access/create-enable-service-accounts-for-instances
- https://cloud.google.com/iam/docs/service-accounts
- CIS Google Cloud Platform Foundation Benchmark v1.3.0, 5.1
- https://cloud.google.com/security/compliance
