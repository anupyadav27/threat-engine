rule_id: gcp.compute.instance.service_account_non_default_configured
service: compute
resource: instance
requirement: Service Account Non Default Configured
scope: compute.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Ensure Custom Service Accounts for Compute Instances
rationale: Assigning non-default service accounts to compute instances limits permissions
  to only those necessary for the instance to function, reducing the risk of privilege
  escalation and lateral movement within the cloud environment. This practice helps
  to minimize the attack surface and supports compliance with least privilege access
  principles, which are vital for meeting regulatory requirements such as PCI-DSS
  and SOC2.
description: This rule checks if Google Cloud Compute Engine instances are configured
  with a non-default service account. By default, Compute Engine instances use the
  default service account, which often has more permissions than necessary. To verify,
  inspect the instance metadata and ensure a custom service account is specified.
  Remediation involves creating a custom service account with the minimal required
  IAM roles and updating the instance configuration to use this account.
references:
- https://cloud.google.com/compute/docs/access/service-accounts
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloudsecurityalliance.org/guidance
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.nist.gov/cyberframework
- https://www.isaca.org/resources/cobit
