rule_id: gcp.compute.instance.vm_ssh_key_based_auth_required
service: compute
resource: instance
requirement: VM Ssh Key Based Auth Required
scope: compute.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: high
title: Enforce SSH Key-Based Authentication for GCP VMs
rationale: Relying solely on password-based authentication for VM instances can expose
  systems to brute force attacks, leading to unauthorized access and potential data
  breaches. Enforcing SSH key-based authentication mitigates these risks by requiring
  cryptographic keys that are significantly more secure and align with compliance
  standards such as PCI-DSS and ISO 27001.
description: This rule checks if SSH key-based authentication is enforced on all GCP
  VM instances. SSH keys provide a more secure method of accessing instances by using
  asymmetric encryption keys instead of passwords. To ensure compliance, administrators
  should disable password authentication and configure instances to accept SSH keys
  only. This can be verified using the GCP Console or CLI by checking the instance
  metadata settings and ensuring 'block-project-ssh-keys' is not set, and the 'ssh-keys'
  metadata entry is configured.
references:
- https://cloud.google.com/compute/docs/instances/connecting-advanced
- https://cloud.google.com/compute/docs/instances/adding-removing-ssh-keys
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/document_library
- https://www.nist.gov/cyberframework
- https://www.iso.org/iso-27001-information-security.html
