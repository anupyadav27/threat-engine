rule_id: gcp.compute.backend_service.edge_cdn_hsts_enabled
service: compute
resource: backend_service
requirement: Edge Cdn Hsts Enabled
scope: compute.backend_service.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Enable HSTS for Edge CDN on Backend Services
rationale: Enabling HTTP Strict Transport Security (HSTS) for Edge CDN on backend
  services mitigates man-in-the-middle attacks by ensuring browsers interact with
  the server using a secure HTTPS connection. This configuration is crucial for protecting
  sensitive data, maintaining user trust, and achieving compliance with data protection
  regulations such as GDPR and PCI-DSS.
description: This rule checks if HSTS is enabled for the Edge CDN on GCP Compute backend
  services. HSTS ensures that all communications between clients and the service are
  conducted over secure HTTPS connections, preventing downgrade attacks. To verify
  this setting, check the 'cdnPolicy' configuration of the backend service in the
  Google Cloud Console or use the gcloud command-line tool. Remediation involves setting
  'cdnPolicy.edgeSecurityPolicy' to enforce HSTS.
references:
- https://cloud.google.com/cdn/docs/edge-security-policy
- https://cloud.google.com/security-compliance
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/
- https://datatracker.ietf.org/doc/html/rfc6797
- https://cloud.google.com/architecture/best-practices-for-securing-cloud-cdn
