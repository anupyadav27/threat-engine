rule_id: gcp.compute.instance.project_source_repo_url_no_sensitive_credentials_g_variables
service: compute
resource: instance
requirement: Project Source Repo Url No Sensitive Credentials G Variables
scope: compute.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: high
title: Ensure No Sensitive Credentials in GCP Project Source Repo URLs
rationale: Embedding sensitive credentials in source repository URLs can lead to unauthorized
  access and data breaches, significantly impacting business operations and client
  trust. Such exposure can also result in non-compliance with regulatory frameworks
  like PCI-DSS, HIPAA, and SOC2, leading to potential legal penalties and reputational
  damage.
description: This rule checks for the presence of sensitive credentials within environment
  variables that reference project source repository URLs in GCP Compute Engine instances.
  It ensures that no sensitive information, such as API keys or passwords, is included
  in URLs. To verify, review instance metadata and environment variables, and remove
  any credentials embedded in URLs. Instead, use IAM roles and service accounts for
  secure authentication.
references:
- https://cloud.google.com/compute/docs/instances/adding-removing-ssh-keys
- https://cloud.google.com/security/compliance/cis-gcp-1-2-0
- https://cloud.google.com/security/compliance
- https://cloud.google.com/iam/docs/understanding-service-accounts
- https://cloud.google.com/architecture/best-practices-for-using-service-accounts
