rule_id: gcp.compute.instance.spot_instance_no_public_ip_assigned
service: compute
resource: instance
requirement: Spot Instance No Public Ip Assigned
scope: compute.instance.public_access
domain: compute_and_workload_security
subcategory: instance_configuration
severity: critical
title: Spot Instances Must Not Have Public IPs Assigned
rationale: Assigning public IPs to spot instances increases the attack surface, exposing
  these ephemeral resources to potential unauthorized access and attacks. This can
  lead to data breaches, unauthorized access to sensitive workloads, and service disruptions.
  Complying with security frameworks like NIST and PCI-DSS necessitates minimizing
  public exposure of cloud resources to protect against potential threats.
description: This rule checks if any spot instances in your GCP environment have public
  IP addresses assigned. Spot instances are usually short-lived and should be tightly
  controlled to prevent exposure to the internet. Verification involves ensuring that
  spot instances do not have 'networkInterfaces.accessConfigs' configured. Remediation
  requires removing any public IPs assigned to spot instances by updating the network
  interface settings to restrict to private IPs only.
references:
- https://cloud.google.com/compute/docs/instances/spot
- https://cloud.google.com/vpc/docs/compute-instances#no-external-ip
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://www.pcisecuritystandards.org/pci_security/
