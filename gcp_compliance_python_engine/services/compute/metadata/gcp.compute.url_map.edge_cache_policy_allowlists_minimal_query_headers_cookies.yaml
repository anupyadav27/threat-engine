rule_id: gcp.compute.url_map.edge_cache_policy_allowlists_minimal_query_headers_cookies
service: compute
resource: url_map
requirement: Edge Cache Policy Allowlists Minimal Query Headers Cookies
scope: compute.url_map.policy_management
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Restrict Edge Cache Policy for Minimal Query Headers and Cookies
rationale: Allowing excessive query headers and cookies in an edge cache policy can
  expose sensitive information, increase the attack surface, and lead to cache poisoning
  attacks. Restricting this ensures that only the necessary data is cached, reducing
  the risk of unauthorized access and data breaches, while complying with security
  frameworks like PCI-DSS and HIPAA which mandate minimal data exposure.
description: This rule checks that the Edge Cache Policy in `url_map` resources minimizes
  the use of query headers and cookies, allowing only essential ones. Verify that
  the configuration explicitly specifies which headers and cookies are permitted.
  Remediation involves reviewing the `url_map` configuration and updating the `edge_cache_policy`
  to restrict query headers and cookies to only those required for functionality.
  This reduces potential security vulnerabilities and limits data exposure.
references:
- https://cloud.google.com/load-balancing/docs/https/edge-cache
- https://cloud.google.com/security/compliance/pci-dss
- https://cloud.google.com/security/compliance/hipaa
- https://cloud.google.com/architecture/best-practices-for-enterprise-organizations
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://cloud.google.com/docs/security/best-practices
