rule_id: gcp.compute.url_map.edge_origin_request_policy_no_secret_headers_forwarded
service: compute
resource: url_map
requirement: Edge Origin Request Policy No Secret Headers Forwarded
scope: compute.url_map.policy_management
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Prevent Forwarding Secret Headers in URL Map Policies
rationale: Forwarding secret headers in URL map configurations can expose sensitive
  information to unauthorized parties, leading to data breaches and compliance violations.
  Proper handling of such headers is crucial to prevent threat actors from exploiting
  them to gain unauthorized access or perform malicious actions, aligning with compliance
  requirements like PCI-DSS and HIPAA.
description: This rule checks whether URL map configurations in GCP's Compute Engine
  are forwarding secret headers to the origin. The absence of restrictions on forwarding
  secret headers can lead to security vulnerabilities. To ensure security, verify
  the URL map's edge origin request policies to ensure no secret headers are forwarded.
  Remediation involves updating the URL map configuration to explicitly disallow forwarding
  of sensitive headers.
references:
- https://cloud.google.com/load-balancing/docs/url-map
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/load-balancing/docs/https
- https://cloud.google.com/architecture/best-practices-for-enterprise-organizations
