rule_id: gcp.compute.instance.default_service_account_in_use_with_full_api_access
service: compute
resource: instance
requirement: Default Service Account In Use With Full API Access
scope: compute.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Avoid Default Service Account with Full API Access in Instances
rationale: Using the default service account with full API access increases the risk
  of privilege escalation and unauthorized data access if the account is compromised.
  It can lead to extensive exposure of cloud resources and sensitive data, undermining
  compliance with security frameworks and increasing the attack surface for malicious
  actors.
description: This rule checks if any Compute Engine instances are configured to use
  the default service account with full API access. Best practices recommend creating
  and using custom service accounts with the principle of least privilege applied.
  To verify, inspect the service account settings of each instance in the GCP Console
  or via the gcloud CLI, and adjust permissions as necessary by assigning a custom
  service account with only the necessary IAM roles.
references:
- https://cloud.google.com/compute/docs/access/service-accounts#default_service_account
- https://cloud.google.com/iam/docs/understanding-service-accounts
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/docs/enterprise/best-practices-for-enterprise-organizations#service_accounts
