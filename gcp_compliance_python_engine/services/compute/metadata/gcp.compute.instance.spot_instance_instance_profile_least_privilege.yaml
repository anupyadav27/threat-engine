rule_id: gcp.compute.instance.spot_instance_instance_profile_least_privilege
service: compute
resource: instance
requirement: Spot Instance Instance Profile Least Privilege
scope: compute.instance.least_privilege
domain: compute_and_workload_security
subcategory: instance_configuration
severity: high
title: Ensure Spot Instance Profiles Use Least Privilege
rationale: Applying the principle of least privilege to Spot Instance profiles minimizes
  the risk of unauthorized access and potential data breaches. Incorrectly configured
  instance profiles can lead to privilege escalation, allowing attackers to exploit
  permissions not needed for the instance's operation. This practice is crucial for
  maintaining a secure and compliant cloud environment, especially under regulatory
  frameworks like PCI-DSS and ISO 27001.
description: This rule checks if Spot Instances are assigned instance profiles with
  excessive permissions beyond what is necessary for their operation. Ensure that
  IAM roles linked to Spot Instances only include permissions essential for their
  specific task. Regularly review and update IAM policies to align with current workload
  requirements and remove any superfluous permissions. Remediation involves adjusting
  the IAM roles assigned to Spot Instances to enforce the least privilege principle.
references:
- https://cloud.google.com/compute/docs/instances
- https://cloud.google.com/iam/docs/understanding-roles
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
- https://cloud.google.com/security/compliance
