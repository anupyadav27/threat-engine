rule_id: gcp.compute.instance_group.no_public_ip_assigned
service: compute
resource: instance_group
requirement: No Public Ip Assigned
scope: compute.instance_group.public_access
domain: compute_and_workload_security
subcategory: instance_configuration
severity: critical
title: Prevent Public IP Assignment to GCP Instance Groups
rationale: Assigning public IPs to instance groups can expose your infrastructure
  to the internet, increasing the risk of unauthorized access and potential data breaches.
  Public IPs can be exploited by attackers to perform reconnaissance or launch attacks
  on your instances, leading to potential business disruptions, data loss, and non-compliance
  with regulations such as PCI-DSS and SOC2 that mandate secure access controls.
description: This rule checks that no public IP addresses are assigned to any instances
  within a GCP instance group. Instances with public IPs should be reconfigured to
  use private IPs to leverage Google's VPC for secure communication. To verify, review
  the instance group's network interface settings in the Google Cloud Console or via
  the gcloud CLI for IP address configurations. Remediation involves removing public
  IP assignments and setting up a Cloud NAT or VPN for secure external communications.
references:
- https://cloud.google.com/compute/docs/ip-addresses#assigning_ip_addresses
- https://cloud.google.com/security/compliance/cis-benchmarks
- https://www.pcisecuritystandards.org/pci_security/
- https://cloud.google.com/vpc/docs/vpc#vpc_networks_and_subnets
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- https://cloud.google.com/security/best-practices
