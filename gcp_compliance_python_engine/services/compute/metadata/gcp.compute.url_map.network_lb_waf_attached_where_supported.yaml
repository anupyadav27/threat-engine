rule_id: gcp.compute.url_map.network_lb_waf_attached_where_supported
service: compute
resource: url_map
requirement: Network Lb Waf Attached Where Supported
scope: compute.url_map.network_security
domain: network_security_and_connectivity
subcategory: network_access_control
severity: medium
title: Ensure Network LB WAF is Configured on Supported URL Maps
rationale: Attaching a Web Application Firewall (WAF) to Network Load Balancer URL
  Maps mitigates security threats such as SQL injection and cross-site scripting by
  filtering and monitoring HTTP traffic. This reduces the risk of application-layer
  attacks, which can lead to data breaches or service disruptions, ensuring compliance
  with security frameworks like PCI-DSS and enhancing overall system resilience.
description: This rule verifies that a Web Application Firewall is attached to URL
  Maps where supported within Network Load Balancer configurations. A WAF protects
  applications by monitoring and filtering HTTP traffic between a web application
  and the Internet. To ensure compliance, inspect the URL Map settings in the Google
  Cloud Console and confirm that a WAF is enabled for each applicable URL Map. Remediate
  by configuring a WAF via the Console or gcloud CLI to enhance security posture.
references:
- https://cloud.google.com/load-balancing/docs/https/setting-up-https#waf
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org
- https://cloud.google.com/security
- https://cloud.google.com/armor/docs/rules-overview
- https://cloud.google.com/architecture/security-foundations
