rule_id: gcp.compute.instance.no_public_ip
service: compute
resource: instance
requirement: No Public Ip
scope: compute.instance.public_access
domain: compute_and_workload_security
subcategory: instance_configuration
severity: critical
title: Ensure Instances Do Not Have Public IP Addresses
rationale: Exposing instances to the public internet significantly increases the risk
  of unauthorized access, data breaches, and exploitation by attackers. Instances
  with public IPs are more susceptible to attacks such as brute force, DDoS, and unauthorized
  data extraction. Ensuring instances remain private helps comply with regulations
  like PCI-DSS and HIPAA, which mandate strict control over network access to sensitive
  data.
description: This rule checks if any compute instance is assigned a public IP address.
  Instances should be configured to use private IPs and access the internet through
  secure channels like Cloud NAT or VPN. To verify, review instance network interfaces
  for public IP associations. Remediation involves removing public IPs and utilizing
  VPNs or private connectivity options for necessary internet access.
references:
- https://cloud.google.com/compute/docs/instances/instance-config#public_ip
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://cloud.google.com/security/compliance
- https://cloud.google.com/nat/docs/overview
- https://cloud.google.com/network-connectivity/docs/vpn/concepts/overview
- https://cloud.google.com/architecture/best-practices-for-enterprise-organizations
