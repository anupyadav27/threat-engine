rule_id: gcp.compute.instance.public_ip
service: compute
resource: instance
requirement: Public Ip
scope: compute.instance.public_access
domain: compute_and_workload_security
subcategory: instance_configuration
severity: critical
title: Ensure Compute Instances Do Not Have Public IP Addresses
rationale: Exposing compute instances to the public internet can significantly increase
  the attack surface, making them vulnerable to unauthorized access, data breaches,
  and distributed denial-of-service (DDoS) attacks. This exposure can lead to compliance
  violations under standards such as PCI-DSS and GDPR, which require stringent data
  protection measures. Limiting public access helps safeguard sensitive data and maintain
  service availability.
description: This rule checks for Google Cloud Compute instances configured with public
  IP addresses. Instances with public IPs are accessible from the internet, posing
  potential security risks. To verify, inspect the network interface configurations
  for each instance and ensure no public IPs are assigned. Remediation involves either
  removing the public IP or replacing it with a private IP and using a VPN or Cloud
  NAT for necessary external communications.
references:
- https://cloud.google.com/compute/docs/instances/connecting-advanced#no-public-ip
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/security/compliance/gdpr
- https://cloud.google.com/nat/docs/overview
- https://cloud.google.com/vpc/docs/using-vpn
