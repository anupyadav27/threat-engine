rule_id: gcp.compute.security_policy.edge_waf_logging_enabled
service: compute
resource: security_policy
requirement: Edge Waf Logging Enabled
scope: compute.security_policy.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: medium
title: Enable Edge WAF Logging for Security Policies
rationale: Enabling Edge WAF logging is crucial for detecting and investigating potential
  security incidents, as it provides visibility into web application attacks targeted
  at your infrastructure. Without logging, threat actors could exploit vulnerabilities
  undetected, leading to data breaches, service disruptions, or non-compliance with
  regulations like PCI-DSS and ISO 27001 which mandate audit trails.
description: This rule checks if logging is enabled for Edge WAF within your security
  policies on GCP. To verify, ensure that 'enableLogging' is set to true in the security
  policy configuration. If logging is not enabled, configure your WAF settings to
  log all traffic, providing critical data for analysis. This can be done via the
  GCP Console under 'Security Policies' or using the gcloud command line tool. Enabling
  logging facilitates proactive monitoring and response to security threats.
references:
- https://cloud.google.com/armor/docs/security-policy-concepts#logging
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://cloud.google.com/armor/docs/configure-security-policies
