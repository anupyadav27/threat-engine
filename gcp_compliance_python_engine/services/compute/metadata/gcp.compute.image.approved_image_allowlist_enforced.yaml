rule_id: gcp.compute.image.approved_image_allowlist_enforced
service: compute
resource: image
requirement: Approved Image Allowlist Enforced
scope: compute.image.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Enforce Approved Image Allowlist for Compute Images
rationale: Using unapproved images on GCP can lead to potential security vulnerabilities,
  compliance violations, and operational inefficiencies. Enforcing an approved image
  allowlist helps mitigate risks by ensuring that only vetted and compliant images
  are used, thus reducing the attack surface and aligning with industry standards
  and best practices.
description: This rule verifies that all compute instances are launched using images
  from a predefined allowlist. It checks for the enforcement of image allowlists to
  prevent unauthorized or insecure images from being used. To remediate, implement
  IAM policies that restrict image creation and selection to approved images only.
  Regularly review and update the allowlist to include necessary images that comply
  with security and operational guidelines.
references:
- https://cloud.google.com/compute/docs/images
- https://cloud.google.com/security/compliance/cis-benchmarks
- https://www.nist.gov/cyberframework
- https://cloud.google.com/iam/docs/overview
- https://cloud.google.com/compute/docs/instances/image-management-best-practices
