rule_id: gcp.compute.instance.metadata_block_project_ssh_keys_enabled
service: compute
resource: instance
requirement: Metadata Block Project Ssh Keys Enabled
scope: compute.instance.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure Instance Metadata Blocks Project SSH Keys
rationale: Allowing project-wide SSH keys can lead to unauthorized access if those
  keys are compromised, posing a significant risk to data integrity and confidentiality.
  Disabling project SSH keys at the instance level minimizes the attack surface and
  aligns with the principle of least privilege, thus enhancing the security of sensitive
  data and meeting compliance requirements such as PCI-DSS and HIPAA.
description: 'This rule checks that the metadata key ''block-project-ssh-keys'' is
  set to true for each GCP compute instance, ensuring that project-wide SSH keys are
  not used. This configuration prevents users with project-level access from SSH-ing
  into instances, thus limiting access to those explicitly granted instance-level
  credentials. To verify this setting, review the instance metadata in the GCP Console
  or use the gcloud command-line tool. Remediation involves updating the instance
  metadata to include ''block-project-ssh-keys'': ''true''.'
references:
- https://cloud.google.com/compute/docs/instances/adding-removing-ssh-keys#block-project-keys
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/
- https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
- https://cloud.google.com/security/best-practices
- https://cloud.google.com/compute/docs/instances/metadata-protection
