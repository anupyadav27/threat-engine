rule_id: gcp.compute.instance.ssh_key_authentication
service: compute
resource: instance
requirement: Ssh Key Authentication
scope: compute.instance.authentication
domain: compute_and_workload_security
subcategory: instance_configuration
severity: high
title: Enforce SSH Key Authentication on Compute Instances
rationale: SSH key authentication enhances security by eliminating password-based
  logins, reducing the risk of brute force attacks and unauthorized access. It is
  crucial for maintaining the confidentiality and integrity of sensitive data processed
  by compute instances, and is often a requirement for compliance with standards like
  PCI-DSS and ISO 27001.
description: This rule checks if SSH key authentication is enforced on Google Compute
  Engine instances. Instances should be configured to accept only SSH keys instead
  of passwords for remote access. To verify, ensure the 'Block project-wide SSH keys'
  setting is disabled, and instance-specific SSH keys are configured. Remediation
  involves updating instance metadata to include only authorized public SSH keys and
  disabling password authentication in the SSH daemon configuration.
references:
- https://cloud.google.com/compute/docs/instances/adding-removing-ssh-keys
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://www.pcisecuritystandards.org/
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://www.iso.org/iso-27001-information-security.html
