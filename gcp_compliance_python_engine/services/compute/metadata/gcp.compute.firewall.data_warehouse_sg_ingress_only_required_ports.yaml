rule_id: gcp.compute.firewall.data_warehouse_sg_ingress_only_required_ports
service: compute
resource: firewall
requirement: Data Warehouse Sg Ingress Only Required Ports
scope: compute.firewall.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Restrict Data Warehouse Ingress to Required Ports
rationale: Allowing only necessary ports for ingress to your data warehouse minimizes
  the attack surface, reducing the likelihood of unauthorized access or data breaches.
  This is critical for protecting sensitive data and meeting compliance requirements
  such as PCI-DSS and HIPAA, which mandate strict access controls to safeguard sensitive
  information.
description: This rule checks whether ingress traffic to Google Cloud data warehouses
  is limited to only the required ports. By default, all traffic should be denied
  except for specific ports used by your applications or services. To verify, review
  the firewall rule settings to ensure only necessary ports are open, such as port
  5432 for PostgreSQL. Remediation involves updating or creating firewall rules to
  restrict inbound traffic to these specified ports, ensuring all other ingress traffic
  is denied.
references:
- https://cloud.google.com/vpc/docs/firewalls
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.hhs.gov/hipaa/for-professionals/security/index.html
- https://cloud.google.com/security/best-practices
