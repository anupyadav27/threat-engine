rule_id: gcp.compute.reservation.cost_approval_workflow_required
service: compute
resource: reservation
requirement: Cost Approval Workflow Required
scope: compute.reservation.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Mandatory Cost Approval for Compute Reservations
rationale: Implementing a cost approval workflow for compute reservations ensures
  that financial expenditures are monitored and validated by appropriate stakeholders,
  reducing the risk of unexpected charges and budget overruns. This is essential for
  organizations to maintain financial accountability and align with budgetary constraints,
  particularly in environments with multiple users and teams. It also aids in detecting
  and preventing unauthorized or frivolous resource allocations that could lead to
  financial waste.
description: This rule checks if a cost approval workflow is in place before compute
  reservations are finalized in GCP. It requires configurations in Google Cloud's
  billing settings to enforce an approval process, such as using workflows to route
  reservation requests to financial controllers or managers for review. To verify,
  audit the billing account settings to ensure an approval policy exists. Remediation
  involves setting up a workflow using Google Cloud Functions and Cloud Pub/Sub to
  trigger notifications and approvals based on reservation requests.
references:
- https://cloud.google.com/billing/docs/how-to/billing-access
- https://cloud.google.com/iam/docs/using-workload-identity-federation
- https://cloud.google.com/functions/docs/calling/pubsub
- CIS Google Cloud Computing Foundations Benchmark v1.2.0 - Section 4.10
- NIST SP 800-53 Rev. 5 - CM-5 Access Restrictions for Change
- https://cloud.google.com/architecture/cost-management
