rule_id: gcp.compute.instance_template.launch_template_imds_hardened
service: compute
resource: instance_template
requirement: Launch Template Imds Hardened
scope: compute.instance_template.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Harden IMDS Access in Compute Instance Templates
rationale: Ensuring that the Instance Metadata Service (IMDS) is properly configured
  in GCP Compute instance templates is crucial for preventing unauthorized access
  to sensitive metadata, which could lead to potential data breaches. By hardening
  IMDS access, organizations can mitigate risks such as metadata exposure and privilege
  escalation, thus enhancing their security posture and aligning with compliance requirements
  like SOC2 and ISO 27001.
description: This rule checks if the Instance Metadata Service (IMDS) access is properly
  restricted in GCP Compute instance templates. It verifies that the 'metadataFlavor'
  header is set to 'Google' and metadata server requests are secured to prevent unauthorized
  access. To remediate, ensure that the instance template's metadata options are configured
  with 'enable-oslogin' set to 'TRUE' and 'block-project-ssh-keys' set to 'TRUE'.
  Regular audits and updates to these settings are recommended to maintain security.
references:
- https://cloud.google.com/compute/docs/instances/accessing-instance-metadata
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://www.iso.org/iso-27001-information-security.html
