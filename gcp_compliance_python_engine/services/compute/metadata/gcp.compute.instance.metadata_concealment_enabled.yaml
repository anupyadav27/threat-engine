rule_id: gcp.compute.instance.metadata_concealment_enabled
service: compute
resource: instance
requirement: Metadata Concealment Enabled
scope: compute.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Enable Metadata Concealment for Compute Instances
rationale: Enabling metadata concealment for compute instances is crucial to prevent
  unauthorized access to sensitive data such as service account tokens and instance
  metadata, which can be exploited by attackers to escalate privileges or perform
  lateral movements. This configuration helps mitigate risks associated with data
  exposure and meets compliance requirements outlined in frameworks like NIST SP 800-53
  and ISO 27001, ensuring robust protection against metadata-related vulnerabilities.
description: This rule checks if metadata concealment is enabled for GCP Compute Engine
  instances, which prevents direct access to instance metadata from within the virtual
  machine. To verify, inspect the instance's metadata server configuration and ensure
  the 'enable-oslogin' metadata key is set to 'true'. Remediation involves configuring
  the instance's metadata server to enable concealment, which can be done via the
  Google Cloud Console, CLI, or API by updating instance settings to enable 'enable-oslogin'.
references:
- https://cloud.google.com/compute/docs/instances/access-advanced-configurations
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://cloud.google.com/security/best-practices
- https://cloud.google.com/compute/docs/metadata/overview
- https://cloud.google.com/compute/docs/security
