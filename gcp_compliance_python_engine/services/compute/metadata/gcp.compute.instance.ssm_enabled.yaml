rule_id: gcp.compute.instance.ssm_enabled
service: compute
resource: instance
requirement: Ssm Enabled
scope: compute.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Ensure SSM Agent is Enabled on GCP Compute Instances
rationale: Enabling the SSM (Systems Manager) agent on GCP Compute instances enhances
  security by allowing administrators to manage and automate configurations securely
  without direct SSH access. This reduces the attack surface by limiting open ports
  and direct access, mitigating risks such as unauthorized access and potential data
  breaches. It also ensures compliance with security policies requiring centralized
  management and monitoring of virtual machines.
description: This rule checks if the SSM agent is installed and running on GCP Compute
  instances. Verify that the agent is enabled by reviewing instance metadata or using
  gcloud command-line tools. If not enabled, install the SSM agent using the appropriate
  package manager for the instance's operating system and ensure it is configured
  to start on boot. This can be automated across instances using startup scripts or
  configuration management tools.
references:
- https://cloud.google.com/compute/docs/instances/access-overview
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/solutions/automating-secure-infrastructure
