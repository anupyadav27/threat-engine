rule_id: gcp.compute.url_map.edge_origin_request_policy_forward_cookies_minimal
service: compute
resource: url_map
requirement: Edge Origin Request Policy Forward Cookies Minimal
scope: compute.url_map.policy_management
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Enforce Minimal Cookie Forwarding in URL Map Policy
rationale: Minimizing cookie forwarding in URL Map policies reduces the risk of exposing
  sensitive data to unintended endpoints, thereby mitigating potential lateral movement
  or data breaches. This control is crucial for maintaining a secure and compliant
  environment, especially under regulations like GDPR, which emphasize data protection
  and privacy.
description: This rule verifies that URL Map configurations in GCP's Compute Engine
  enforce minimal cookie forwarding settings. This involves checking that only essential
  cookies are forwarded to the origin, preventing unnecessary exposure of sensitive
  information. To remediate, configure the URL Map to restrict cookie forwarding by
  selecting the 'Minimal' option under 'Edge Origin Request Policy'. Verification
  can be done through the Google Cloud Console or gcloud CLI by reviewing URL Map
  settings.
references:
- https://cloud.google.com/load-balancing/docs/https/https-load-balancer-url-map
- https://cloud.google.com/security/compliance
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://www.nist.gov/cyberframework
- https://cloud.google.com/docs/security/best-practices
