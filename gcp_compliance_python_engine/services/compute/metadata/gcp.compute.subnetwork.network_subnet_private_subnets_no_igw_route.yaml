rule_id: gcp.compute.subnetwork.network_subnet_private_subnets_no_igw_route
service: compute
resource: subnetwork
requirement: Network Subnet Private Subnets No Igw Route
scope: compute.subnetwork.network_security
domain: network_security_and_connectivity
subcategory: network_access_control
severity: medium
title: Ensure No Internet Gateway Route for Private Subnets
rationale: Allowing internet access to private subnets via an internet gateway route
  can lead to unauthorized data exposure and potential attacks from public networks.
  This exposure can increase the risk of data breaches, non-compliance with regulations
  like PCI-DSS, and violation of internal security policies. Maintaining strict control
  over network routes helps preserve data confidentiality and integrity.
description: This rule checks that private subnets in GCP do not have routes directing
  traffic through an internet gateway. Ensure that private subnets only communicate
  through internal or VPN/Interconnect routes, avoiding public internet exposure.
  To verify, inspect the routing table of each subnetwork and ensure that no route
  with a destination of 0.0.0.0/0 is pointing to an internet gateway. As a remediation
  step, remove any such routes and restrict the route table to internal addresses
  only.
references:
- https://cloud.google.com/vpc/docs/routes
- https://cloud.google.com/security/compliance/cis-gcp-benchmark
- https://www.pcisecuritystandards.org/pci_security
- https://www.nist.gov/cyberframework
- https://cloud.google.com/vpc/docs/vpc-best-practices
- https://cloud.google.com/security/compliance
