rule_id: gcp.compute.instance.restrict_public_access
service: compute
resource: instance
requirement: Restrict Public Access
scope: compute.instance.public_access
domain: compute_and_workload_security
subcategory: instance_configuration
severity: critical
title: Restrict Public IPs on Compute Instances
rationale: Allowing public IP access on compute instances increases the risk of unauthorized
  access, exposing sensitive applications and data to potential attackers, which can
  lead to data breaches and compliance violations. Restricting public access helps
  protect against common attack vectors such as brute force attacks and reduces the
  attack surface, aligning with compliance requirements like PCI-DSS and ISO 27001.
description: This rule checks whether Google Cloud Compute instances have external
  IP addresses assigned, which can be accessed over the internet. Instances should
  be configured without public IPs, instead utilizing private IPs and appropriate
  network configurations like VPNs or Bastion Hosts for secure access. To verify,
  review instance settings in the GCP Console or use the gcloud command-line tool.
  Remediation involves removing the external IP and ensuring access through secure
  internal networks.
references:
- https://cloud.google.com/compute/docs/instances/connecting-to-instance
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/architecture/best-practices-for-enterprise-organizations#security
- https://cloud.google.com/vpc/docs/best-practices
- https://cloud.google.com/security/best-practices
