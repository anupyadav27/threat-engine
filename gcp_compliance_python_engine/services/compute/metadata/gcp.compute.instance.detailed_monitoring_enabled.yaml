rule_id: gcp.compute.instance.detailed_monitoring_enabled
service: compute
resource: instance
requirement: Detailed Monitoring Enabled
scope: compute.instance.monitoring
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: medium
title: Enable Detailed Monitoring on Compute Instances
rationale: Enabling detailed monitoring on compute instances allows for better visibility
  into system performance, enabling proactive identification of potential issues.
  This is crucial for maintaining system reliability and meeting compliance requirements
  for performance monitoring in frameworks like ISO 27001. Without detailed monitoring,
  businesses risk undetected performance degradation and potential loss of service
  availability.
description: This rule checks whether detailed monitoring is enabled on Google Compute
  Engine instances. Detailed monitoring provides additional metrics that are crucial
  for performance analysis and capacity planning. To verify this setting, ensure that
  the 'monitoring' service is enabled on each instance. Remediation involves enabling
  the 'Stackdriver Monitoring' agent on the instance, which can be done via the Google
  Cloud Console or using gcloud commands.
references:
- https://cloud.google.com/monitoring
- https://cloud.google.com/compute/docs/instances
- CIS Google Cloud Computing Foundations Benchmark v1.2.0, Section 5.2
- ISO 27001:2013 - A.12.1.3 Capacity management
- https://cloud.google.com/monitoring/agent
- NIST SP 800-53 Rev. 5 - CA-7 Continuous Monitoring
