rule_id: gcp.compute.snapshot.dr_restore_roles_least_privilege
service: compute
resource: snapshot
requirement: DR Restore Roles Least Privilege
scope: compute.snapshot.least_privilege
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Enforce Least Privilege for Snapshot Restoration Roles
rationale: Assigning the least privilege necessary for snapshot restoration reduces
  the risk of unauthorized access to sensitive data and potential data loss. Over-privileged
  roles can lead to accidental or malicious data exposure, violating compliance with
  regulations like GDPR and HIPAA, and increasing the attack surface of your cloud
  infrastructure.
description: This rule checks if roles assigned for snapshot restoration have the
  minimum permissions required. Ensure that only essential personnel have the ability
  to restore snapshots by using custom roles or predefined roles with limited permissions.
  Regularly audit IAM policies to verify compliance with the principle of least privilege
  and remove excessive permissions.
references:
- https://cloud.google.com/iam/docs/understanding-custom-roles
- https://cloud.google.com/compute/docs/disks/snapshots
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://cloud.google.com/iam/docs/using-iam-securely
- https://www.iso.org/standard/54534.html
