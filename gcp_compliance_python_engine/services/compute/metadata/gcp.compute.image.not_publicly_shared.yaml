rule_id: gcp.compute.image.not_publicly_shared
service: compute
resource: image
requirement: Not Publicly Shared
scope: compute.image.public_access
domain: identity_and_access_management
subcategory: authentication
severity: critical
title: Prevent Public Access to GCP Compute Images
rationale: Publicly shared compute images can expose sensitive data and lead to unauthorized
  access or resource misuse. Ensuring images are not publicly accessible reduces the
  risk of data breaches and aligns with compliance requirements such as PCI-DSS and
  ISO 27001, which mandate controlled access to sensitive resources.
description: This rule checks if any Google Cloud Platform compute images are publicly
  accessible. To verify, examine the IAM policy bindings for each image to ensure
  'allUsers' or 'allAuthenticatedUsers' are not granted 'roles/compute.imageUser'.
  Remediation involves updating the IAM policies to restrict access to only necessary
  users or groups, thereby preventing potential unauthorized access.
references:
- https://cloud.google.com/compute/docs/images
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/iam/docs/understanding-roles
