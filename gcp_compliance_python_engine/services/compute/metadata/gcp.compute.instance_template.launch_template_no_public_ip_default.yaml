rule_id: gcp.compute.instance_template.launch_template_no_public_ip_default
service: compute
resource: instance_template
requirement: Launch Template No Public Ip Default
scope: compute.instance_template.public_access
domain: compute_and_workload_security
subcategory: instance_configuration
severity: critical
title: Ensure Instance Templates Do Not Use Public IP by Default
rationale: Public IP addresses expose instances directly to the internet, increasing
  the risk of unauthorized access, data breaches, and other security threats. Limiting
  public IP usage helps protect sensitive workloads and aligns with compliance requirements
  such as CIS Benchmarks, which advocate for minimizing public exposure to reduce
  attack surfaces.
description: This rule checks that instance templates do not have a public IP address
  set as default upon launch. Verify by inspecting the 'networkInterfaces' configuration
  in the instance template to ensure 'accessConfigs' is not set with a public IP.
  To remediate, modify the instance template to use private IP addresses only, and
  utilize Cloud NAT or VPNs for external connectivity if needed.
references:
- https://cloud.google.com/compute/docs/ip-addresses#types
- https://cloud.google.com/compute/docs/instance-templates
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/nat/docs/overview
- https://cloud.google.com/vpn/docs/concepts/overview
