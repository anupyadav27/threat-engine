rule_id: gcp.compute.firewall.data_warehouse_sg_only_required_ports_open
service: compute
resource: firewall
requirement: Data Warehouse Sg Only Required Ports Open
scope: compute.firewall.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Restrict Ports for Data Warehouse Firewalls
rationale: Opening only necessary ports for data warehouse firewalls minimizes the
  attack surface, reducing the risk of unauthorized access or data breaches. This
  practice helps protect sensitive data and supports compliance with regulations like
  PCI-DSS and HIPAA, which require stringent access controls and data protection mechanisms.
description: This rule checks if firewall rules for data warehouse instances are configured
  to allow only the necessary ports. Specifically, it ensures that ports such as 5432
  for PostgreSQL or 3306 for MySQL are open while unnecessary ports are closed. To
  verify, review firewall rules in the GCP Console, ensuring only required ports are
  listed. Remediate by modifying firewall rules to restrict ports to those essential
  for data warehouse operations.
references:
- https://cloud.google.com/vpc/docs/firewalls
- https://cloud.google.com/security/compliance/cis-benchmarks
- https://www.pcisecuritystandards.org/
- https://www.hipaajournal.com/hipaa-compliance-checklist/
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://cloud.google.com/security/best-practices
