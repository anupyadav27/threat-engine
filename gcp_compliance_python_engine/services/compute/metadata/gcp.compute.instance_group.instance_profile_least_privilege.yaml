rule_id: gcp.compute.instance_group.instance_profile_least_privilege
service: compute
resource: instance_group
requirement: Instance Profile Least Privilege
scope: compute.instance_group.least_privilege
domain: compute_and_workload_security
subcategory: instance_configuration
severity: high
title: Enforce Least Privilege for Compute Instance Profiles
rationale: Implementing least privilege for instance profiles minimizes the risk of
  unauthorized access and potential data breaches by ensuring that compute resources
  have only the permissions necessary for their function. This approach reduces the
  attack surface and helps comply with regulatory standards like PCI-DSS and ISO 27001,
  which mandate access controls to protect sensitive information.
description: This rule verifies that GCP Compute Instance Groups are configured with
  the minimum permissions necessary for their intended purpose. It checks for overly
  permissive roles attached to instance profiles and suggests replacing them with
  custom roles that grant only essential permissions. Remediation involves auditing
  instance roles and adjusting IAM policies to align with the principle of least privilege,
  using the GCP Console or gcloud CLI.
references:
- https://cloud.google.com/iam/docs/understanding-service-accounts
- https://cloud.google.com/iam/docs/creating-custom-roles
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/docs/security/compliance
- https://cloud.google.com/compute/docs/access/iam
- https://www.nist.gov/itl/applied-cybersecurity/nist-cybersecurity-framework
