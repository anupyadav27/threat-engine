rule_id: gcp.compute.instance.gke_worker_nodes_firewall_restriction
service: compute
resource: instance
requirement: Gke Worker Nodes Firewall Restriction
scope: compute.instance.network_security
domain: network_security_and_connectivity
subcategory: network_access_control
severity: medium
title: Restrict GKE Worker Nodes with Specific Firewall Rules
rationale: Unrestricted network access to GKE worker nodes can expose them to potential
  threats such as unauthorized access, data breaches, and Denial-of-Service (DoS)
  attacks. Implementing specific firewall rules minimizes the attack surface by allowing
  only necessary traffic, thereby enhancing the security posture and ensuring compliance
  with standards like PCI-DSS and ISO 27001.
description: This rule checks if GKE worker nodes have restrictive firewall rules
  that limit inbound and outbound traffic to only what is necessary for operations.
  Verifying this involves inspecting firewall configurations associated with the nodes
  to ensure they adhere to the principle of least privilege. Remediation includes
  defining and applying specific firewall rules that only allow required traffic,
  such as SSH from trusted IPs and inter-node communications, while blocking all other
  traffic.
references:
- https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#restrict_access_to_the_control_plane
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/vpc/docs/firewalls
