rule_id: gcp.dns.resource_record_set.record_set_caa_records_present_for_root_and_wildcard
service: dns
resource: resource_record_set
requirement: Record Set Caa Records Present For Root And Wildcard
scope: dns.resource_record_set.security
domain: compliance_and_governance
subcategory: security_monitoring
severity: critical
title: Ensure CAA Records Exist for Root and Wildcard DNS Entries
rationale: CAA (Certification Authority Authorization) records control which certificate
  authorities (CAs) can issue SSL/TLS certificates for a domain, preventing unauthorized
  certificates that could lead to man-in-the-middle attacks. Ensuring these records
  exist for both root and wildcard entries helps maintain domain integrity and supports
  compliance with security standards like PCI-DSS and ISO 27001.
description: This rule checks for the presence of CAA records in DNS configurations
  for both root and wildcard entries. A CAA record specifies which CAs are permitted
  to issue certificates for a domain, reducing the risk of certificate misuse. To
  remediate, add CAA records in your DNS settings, specifying authorized CAs for each
  domain and subdomain. Verify using the 'gcloud dns record-sets list' command to
  ensure correct configuration.
references:
- https://cloud.google.com/dns/docs/records/caa-records
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/
- https://www.iso.org/iso-27001-information-security.html
- https://tools.ietf.org/html/rfc6844
- https://cloud.google.com/security/compliance
