rule_id: gcp.dns.managed_zone.zone_query_logging_enabled
service: dns
resource: managed_zone
requirement: Zone Query Logging Enabled
scope: dns.managed_zone.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: medium
title: Ensure DNS Managed Zone Query Logging is Enabled
rationale: Enabling query logging for DNS managed zones is crucial for maintaining
  visibility into DNS queries, which can help detect malicious activities such as
  data exfiltration, unauthorized access, or misconfigurations. Query logs provide
  audit trails that are essential for incident response and forensic investigations,
  and they support compliance with regulatory standards that mandate monitoring of
  network activities.
description: This rule checks if DNS managed zones have query logging enabled. Query
  logging provides detailed records of all DNS queries, which are instrumental in
  analyzing traffic patterns and identifying security threats. To enable query logging,
  ensure that the 'logging' configuration is set to 'true' for the DNS managed zone.
  This can be verified and configured through the Google Cloud Console under 'Cloud
  DNS' or by using the 'gcloud dns managed-zones update' command.
references:
- https://cloud.google.com/dns/docs/query-logging
- https://cloud.google.com/docs/security/compliance
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/document_library
