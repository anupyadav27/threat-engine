rule_id: gcp.dns.policy.traffic_health_checks_required_for_failover
service: dns
resource: policy
requirement: Traffic Health Checks Required For Failover
scope: dns.policy.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Ensure DNS Policies Require Traffic Health Checks for Failover
rationale: Health checks are crucial for ensuring that DNS failover mechanisms work
  effectively, preventing potential downtime and service disruption. Without health
  checks, DNS failover might not detect a service outage promptly, leading to business
  continuity risks and potential financial losses. Compliance with standards such
  as ISO 27001 requires robust failover mechanisms to protect against service interruptions.
description: This rule checks if Google Cloud DNS policies are configured to require
  traffic health checks for failover scenarios. Health checks should be correctly
  set up to monitor the availability and performance of services, ensuring that DNS
  policies can automatically redirect traffic in the event of a failure. To verify,
  review the DNS policy settings in the Google Cloud Console under Cloud DNS -> Policies
  and ensure health checks are configured. Remediation involves setting up and associating
  appropriate health checks with DNS policies to enable automatic failover.
references:
- https://cloud.google.com/dns/docs/policies
- https://cloud.google.com/architecture/best-practices-for-using-cloud-dns
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/security/compliance
