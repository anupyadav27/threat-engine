rule_id: gcp.dns.resource_record_set.record_set_dmarc_record_present_when_mx_present
service: dns
resource: resource_record_set
requirement: Record Set Dmarc Record Present When Mx Present
scope: dns.resource_record_set.security
domain: compliance_and_governance
subcategory: security_monitoring
severity: low
title: Ensure DMARC Records Exist for Domains with MX Records
rationale: Ensuring DMARC records are present for domains with MX records helps protect
  against email spoofing and phishing attacks by specifying policies for handling
  unauthenticated emails. This is crucial for maintaining brand reputation and adhering
  to email security best practices, reducing the risk of business email compromise
  and potential data breaches.
description: This rule checks that a DMARC (Domain-based Message Authentication, Reporting
  & Conformance) record is configured for any domain that has an MX (Mail Exchange)
  record set in Google Cloud DNS. Without a DMARC record, domains are vulnerable to
  email spoofing. To verify, check for the presence of a TXT record starting with
  'v=DMARC1' in the DNS settings. To remediate, add a DMARC record specifying the
  desired policy (e.g., 'p=none', 'p=quarantine', or 'p=reject') to guide email receivers
  on handling messages that fail authentication checks.
references:
- https://cloud.google.com/dns/docs
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://tools.ietf.org/html/rfc7489
- https://www.nist.gov/publications/email-security-standards-guidelines
- https://dmarc.org/resources/specification/
- https://cloud.google.com/security/compliance
