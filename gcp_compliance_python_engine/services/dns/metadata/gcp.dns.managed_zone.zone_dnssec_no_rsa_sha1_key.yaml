rule_id: gcp.dns.managed_zone.zone_dnssec_no_rsa_sha1_key
service: dns
resource: managed_zone
requirement: Zone Dnssec No Rsa Sha1 Key
scope: dns.managed_zone.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Avoid RSA SHA-1 Keys in DNSSEC for Managed Zones
rationale: Using RSA SHA-1 keys in DNSSEC poses a significant security risk due to
  their weak cryptographic strength, making DNS zones vulnerable to spoofing and data
  integrity attacks. This can lead to unauthorized access, data corruption, and non-compliance
  with security standards such as NIST and PCI-DSS, potentially resulting in reputational
  damage and legal consequences.
description: This rule checks that DNSSEC configurations for GCP managed zones do
  not use RSA SHA-1 keys, which are considered obsolete and insecure. Verify that
  the key-signing and zone-signing algorithms in your DNSSEC settings utilize stronger
  cryptographic algorithms like RSA SHA-256 or ECDSA. Remediation involves updating
  the DNSSEC settings in the Cloud DNS console or via gcloud CLI to replace RSA SHA-1
  with secure alternatives.
references:
- https://cloud.google.com/dns/docs/dnssec-config
- https://cloud.google.com/security/compliance/cis#gcp_cis_v1.2_1.4
- https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf
- https://www.pcisecuritystandards.org/document_library?document=pci_dss_v3-2-1
- https://tools.ietf.org/html/rfc6781
