rule_id: gcp.datacatalog.entry.lineage_job_script_location_private_and_encrypted
service: datacatalog
resource: entry
requirement: Lineage Job Script Location Private And Encrypted
scope: datacatalog.entry.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Lineage Job Script Locations Are Private & Encrypted
rationale: Lineage job scripts in Data Catalog contain sensitive metadata that can
  expose data lineage and dependencies. If not properly secured, unauthorized users
  could access or tamper with these scripts, leading to potential data breaches and
  compliance violations. Ensuring scripts are stored in private and encrypted locations
  mitigates these risks and aligns with data protection standards.
description: This rule checks if the locations where lineage job scripts are stored
  are both private and encrypted. Specifically, it verifies that these scripts are
  in Google Cloud Storage buckets with appropriate IAM policies that restrict access
  and have default encryption enabled. To verify, review bucket permissions and ensure
  default encryption keys are set. Remediation involves adjusting IAM policies for
  least privilege and enabling default bucket encryption with customer-managed keys
  (CMEK) if necessary.
references:
- https://cloud.google.com/storage/docs/encryption
- https://cloud.google.com/iam/docs/understanding-roles
- https://cloud.google.com/security/compliance/cis
- https://cloud.google.com/security/compliance/nist
- https://cloud.google.com/security/compliance/iso-27001
- https://cloud.google.com/security/compliance/hipaa
