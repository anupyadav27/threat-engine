rule_id: gcp.datacatalog.entry.lineage_table_public_sharing_disabled
service: datacatalog
resource: entry
requirement: Lineage Table Public Sharing Disabled
scope: datacatalog.entry.public_access
domain: identity_and_access_management
subcategory: authentication
severity: critical
title: Disable Public Sharing for Data Catalog Lineage Tables
rationale: Publicly shared lineage tables in GCP's Data Catalog can expose sensitive
  metadata, leading to data breaches and unauthorized access. This poses a significant
  risk to data integrity and confidentiality, potentially violating compliance requirements
  such as GDPR, HIPAA, and PCI-DSS. Ensuring lineage tables are not publicly accessible
  helps maintain strict access controls and reduces the attack surface.
description: This check ensures that lineage tables within GCP's Data Catalog are
  not shared with the public. It verifies that the 'allAuthenticatedUsers' and 'allUsers'
  members are not granted roles on Data Catalog entries. To remediate, review the
  IAM policy bindings for Data Catalog entries and remove any public access, ensuring
  only authorized users have the necessary permissions. This can be done via the GCP
  Console or using the gcloud CLI by inspecting and modifying the IAM policies.
references:
- https://cloud.google.com/data-catalog/docs/reference/rest/v1/projects.locations.entryGroups.entries
- https://cloud.google.com/iam/docs/understanding-roles
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://cloud.google.com/security/compliance
- https://www.nist.gov/cyberframework
- https://cloud.google.com/docs/security/best-practices
