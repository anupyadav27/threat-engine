rule_id: gcp.datacatalog.entry.lineage_workflow_kms_encryption_enabled
service: datacatalog
resource: entry
requirement: Lineage Workflow KMS Encryption Enabled
scope: datacatalog.entry.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure KMS Encryption for Data Catalog Lineage Workflows
rationale: Enabling KMS encryption for Data Catalog lineage workflows helps protect
  sensitive metadata and lineage information from unauthorized access, reducing the
  risk of data breaches. This is critical for compliance with data protection regulations
  such as GDPR and CCPA, which mandate strong encryption practices to safeguard personal
  and sensitive data. Failing to encrypt this information could expose organizations
  to significant legal and reputational risks.
description: This rule checks if Cloud KMS encryption is enabled for Data Catalog
  lineage workflows, ensuring that metadata and lineage data are encrypted at rest
  using customer-managed keys. To verify, confirm that the 'encryptionSpec' field
  is configured with a valid KMS key in the Data Catalog entry settings. Remediation
  involves assigning a Cloud KMS key to the respective Data Catalog entries by updating
  the 'encryptionSpec' to include the 'kmsKeyName' parameter pointing to a Cloud KMS
  key resource.
references:
- https://cloud.google.com/data-catalog/docs/how-to/lineage
- https://cloud.google.com/security/encryption-at-rest/default-encryption
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.nist.gov/cyberframework
- https://cloud.google.com/security/compliance/gdpr
- https://cloud.google.com/security/compliance/ccpa
