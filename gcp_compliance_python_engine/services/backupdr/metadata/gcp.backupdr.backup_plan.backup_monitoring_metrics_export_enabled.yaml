rule_id: gcp.backupdr.backup_plan.backup_monitoring_metrics_export_enabled
service: backupdr
resource: backup_plan
requirement: Backup Monitoring Metrics Export Enabled
scope: backupdr.backup_plan.monitoring
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: medium
title: Enable Backup Monitoring Metrics Export for Backup Plans
rationale: Exporting backup monitoring metrics is crucial for maintaining visibility
  into the health and performance of backup operations. This enables organizations
  to quickly identify and respond to potential issues, ensuring data integrity and
  compliance with regulations like GDPR and HIPAA that mandate reliable data protection.
  Without these metrics, organizations face increased risk of undetected backup failures,
  leading to data loss and potential non-compliance fines.
description: This rule checks if backup monitoring metrics export is enabled for backup
  plans on GCP. Ensure that the `monitoring_metrics_enabled` flag is set to true in
  your backup configuration. Verify this setting in the Cloud Console under Backup
  and DR service, or use the CLI command `gcloud backup plans describe [PLAN_NAME]`
  to confirm. If not enabled, update the backup plan settings to include metric exports
  or configure it using Infrastructure as Code (IaC) tools like Terraform.
references:
- https://cloud.google.com/backup-and-dr/docs/monitoring
- https://cloud.google.com/backup-and-dr/docs/creating-backup-plans
- https://cloud.google.com/security/compliance/gdpr
- https://cloud.google.com/security/compliance/hipaa
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
