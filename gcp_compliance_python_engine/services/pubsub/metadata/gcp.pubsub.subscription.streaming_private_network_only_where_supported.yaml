rule_id: gcp.pubsub.subscription.streaming_private_network_only_where_supported
service: pubsub
resource: subscription
requirement: Streaming Private Network Only Where Supported
scope: pubsub.subscription.network_security
domain: network_security_and_connectivity
subcategory: network_access_control
severity: medium
title: Ensure Pub/Sub Subscriptions Use Private Network for Streaming
rationale: Configuring Pub/Sub subscriptions to use a private network minimizes exposure
  to the public internet, reducing the risk of unauthorized access and data breaches.
  This aligns with best practices for network segmentation and fulfills compliance
  requirements for data protection, especially in regulated industries such as finance
  and healthcare.
description: This rule checks if Google Cloud Pub/Sub subscriptions that support private
  access are configured to use a private network for streaming. To verify, ensure
  that the 'usePrivateEndpoint' setting is enabled. Remediation involves configuring
  the Pub/Sub subscription to use VPC Service Controls, restricting network access
  to trusted internal IP addresses, and ensuring that the 'usePrivateEndpoint' flag
  is set to true.
references:
- https://cloud.google.com/pubsub/docs/private-access-options
- https://cloud.google.com/security/compliance/cis-gcp-foundations-benchmark
- https://www.nist.gov/document-2670
- https://cloud.google.com/vpc-service-controls/docs/
