rule_id: gcp.pubsub.subscription.data_warehouse_event_cross_account_sharing_restricted
service: pubsub
resource: subscription
requirement: Data Warehouse Event Cross Account Sharing Restricted
scope: pubsub.subscription.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Restrict Cross-Account Sharing for Pub/Sub Subscriptions
rationale: Restricting cross-account sharing for Pub/Sub subscriptions helps prevent
  unauthorized access to sensitive data events, reducing the risk of data breaches.
  This is crucial for maintaining data privacy and meeting compliance requirements
  such as GDPR and CCPA, which mandate data protection across boundaries. Unauthorized
  access could lead to misuse or exposure of sensitive data, affecting business reputation
  and incurring potential legal penalties.
description: This rule checks if any Pub/Sub subscriptions associated with data warehouse
  events are shared across different accounts unnecessarily. Ideally, subscriptions
  should be limited to accounts within the same organization to ensure data is not
  exposed to unauthorized parties. To verify, review the IAM policies attached to
  Pub/Sub subscriptions for non-organizational accounts and adjust permissions accordingly.
  Remediation involves updating IAM roles to ensure only authorized accounts have
  access, following the principle of least privilege.
references:
- https://cloud.google.com/pubsub/docs/security
- https://cloud.google.com/iam/docs/overview
- CIS Google Cloud Computing Foundations Benchmark v1.2.0 - Recommendation 6.3
- https://www.iso.org/iso-27001-information-security.html
- https://www.nist.gov/privacy-framework
- https://cloud.google.com/security/compliance
