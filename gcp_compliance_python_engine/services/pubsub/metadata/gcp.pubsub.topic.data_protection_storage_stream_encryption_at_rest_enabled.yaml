rule_id: gcp.pubsub.topic.data_protection_storage_stream_encryption_at_rest_enabled
service: pubsub
resource: topic
requirement: Data Protection Storage Stream Encryption At Rest Enabled
scope: pubsub.topic.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure Pub/Sub Topic Encryption at Rest is Enabled
rationale: Enabling encryption at rest for Google Cloud Pub/Sub topics ensures that
  sensitive data is protected from unauthorized access, reducing the risk of data
  breaches. It supports compliance with regulations such as GDPR and HIPAA, which
  mandate data protection measures. Failure to encrypt data could lead to financial
  penalties and reputational damage.
description: This rule checks if Cloud Pub/Sub topics have server-side encryption
  enabled using Google-managed keys. To verify, inspect the topic settings in the
  GCP Console or use the `gcloud` command-line tool. Remediate by ensuring that encryption
  is enabled during topic creation or update the topic configuration to use Google-managed
  encryption keys.
references:
- https://cloud.google.com/pubsub/docs/encryption
- https://cloud.google.com/security/compliance/cis#section_5.6
- https://cloud.google.com/security/compliance/gdpr
- https://cloud.google.com/security/compliance/hipaa
- https://cloud.google.com/kms/docs/encrypt-decrypt
