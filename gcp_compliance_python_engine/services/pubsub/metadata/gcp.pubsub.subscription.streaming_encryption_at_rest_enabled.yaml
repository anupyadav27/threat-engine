rule_id: gcp.pubsub.subscription.streaming_encryption_at_rest_enabled
service: pubsub
resource: subscription
requirement: Streaming Encryption At Rest Enabled
scope: pubsub.subscription.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure Pub/Sub Subscription Encryption At Rest is Enabled
rationale: Enabling encryption at rest for Pub/Sub subscriptions protects sensitive
  data from unauthorized access and potential breaches. This is crucial for maintaining
  data confidentiality and integrity, especially for organizations handling sensitive
  or regulated information. Failure to encrypt data at rest can lead to severe legal
  penalties, reputational damage, and financial loss in the event of a data breach.
description: This rule verifies that Google Cloud Pub/Sub subscriptions have streaming
  encryption at rest enabled to protect stored messages. To ensure compliance, users
  should verify that a Customer-Managed Encryption Key (CMEK) or Google-managed key
  is applied to all subscriptions. If encryption is not enabled, configure the subscription
  to use a CMEK via the Google Cloud Console, CLI, or API, thus enhancing data security
  and meeting regulatory requirements.
references:
- https://cloud.google.com/pubsub/docs/encryption
- https://cloud.google.com/security/compliance/cis#gcp_cis_benchmark
- https://www.nist.gov/cyberframework
- https://www.pcisecuritystandards.org/pci_security/
