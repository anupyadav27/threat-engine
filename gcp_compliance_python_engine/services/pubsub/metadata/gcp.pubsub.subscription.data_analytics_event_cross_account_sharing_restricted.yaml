rule_id: gcp.pubsub.subscription.data_analytics_event_cross_account_sharing_restricted
service: pubsub
resource: subscription
requirement: Data Analytics Event Cross Account Sharing Restricted
scope: pubsub.subscription.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Restrict Cross-Account Sharing for Pub/Sub Data Analytics Events
rationale: Ensuring that Pub/Sub subscriptions do not allow cross-account sharing
  of data analytics events is crucial to prevent unauthorized access and data breaches.
  This restriction is essential for maintaining data privacy and adhering to compliance
  requirements such as GDPR and CCPA. Unrestricted sharing can lead to violation of
  data protection standards, resulting in legal penalties and damage to an organization's
  reputation.
description: This rule verifies that Pub/Sub subscriptions are configured to restrict
  cross-account sharing of data analytics events. It ensures that only authorized
  accounts have access to sensitive data. To comply, review the IAM policies associated
  with your Pub/Sub subscriptions and ensure that only trusted accounts have access.
  Remediation involves auditing current permissions and revoking any unnecessary cross-account
  access. Use the GCP Console or gcloud CLI to update IAM policies appropriately.
references:
- https://cloud.google.com/pubsub/docs/access-control
- CIS Google Cloud Platform Foundation Benchmark v1.3.0, Section 4.1
- https://www.iso.org/standard/54534.html
- https://cloud.google.com/security/compliance
- https://cloud.google.com/iam/docs/overview
- https://cloud.google.com/pubsub/docs/quickstart-console
