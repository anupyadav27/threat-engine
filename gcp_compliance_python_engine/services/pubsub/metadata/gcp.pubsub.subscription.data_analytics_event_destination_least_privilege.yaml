rule_id: gcp.pubsub.subscription.data_analytics_event_destination_least_privilege
service: pubsub
resource: subscription
requirement: Data Analytics Event Destination Least Privilege
scope: pubsub.subscription.least_privilege
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Ensure Pub/Sub Subscriptions Use Least Privilege for Data Analytics
rationale: Implementing least privilege for Pub/Sub subscription permissions minimizes
  the risk of unauthorized access to sensitive data. Over-permissioned roles can lead
  to data breaches, compliance violations, and increased exposure to insider threats,
  especially in environments handling critical data analytics. Adhering to least privilege
  is essential for meeting compliance with standards like NIST and GDPR.
description: This rule checks that IAM permissions for Pub/Sub subscriptions used
  in data analytics are configured with the principle of least privilege. It ensures
  that only necessary roles and permissions are granted to service accounts or users
  interacting with these subscriptions. Verify by reviewing IAM policies and removing
  excessive permissions that are not required for intended tasks. Remediate by using
  predefined roles specific to Pub/Sub and limiting access to essential permissions
  only.
references:
- https://cloud.google.com/pubsub/docs/access-control
- https://cloud.google.com/security/compliance/cis#section-5.3
- https://www.nist.gov/cyberframework
- https://cloud.google.com/docs/iam
- https://cloud.google.com/security/best-practices
- https://cloud.google.com/iam/docs/least-privilege
