rule_id: gcp.pubsub.subscription.streaming_video_encryption_at_rest_enabled
service: pubsub
resource: subscription
requirement: Streaming Video Encryption At Rest Enabled
scope: pubsub.subscription.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure Pub/Sub Subscriptions Encrypt Streaming Video At Rest
rationale: Encrypting streaming video data at rest in Pub/Sub mitigates the risk of
  unauthorized data access and potential data breaches, which can result in substantial
  financial losses and damage to reputation. Compliance with standards such as PCI-DSS
  and HIPAA requires that sensitive data is protected through encryption, thus reducing
  the likelihood of regulatory fines and ensuring trust with customers and stakeholders.
description: This rule verifies that Google Cloud Pub/Sub subscriptions handling streaming
  video data are configured to use Customer-Managed Encryption Keys (CMEK) for encryption
  at rest. Check that each subscription is associated with a CMEK in the subscription's
  settings. Remediate by updating the subscription configuration to include a reference
  to a valid CMEK, ensuring that sensitive video data is encrypted according to your
  security requirements.
references:
- https://cloud.google.com/pubsub/docs/encryption
- https://cloud.google.com/security/compliance/cis-gcp-benchmark
- https://www.pcisecuritystandards.org/pci_security/
- https://www.hhs.gov/hipaa/index.html
- https://cloud.google.com/kms/docs/cmek
- https://www.iso.org/iso-27001-information-security.html
