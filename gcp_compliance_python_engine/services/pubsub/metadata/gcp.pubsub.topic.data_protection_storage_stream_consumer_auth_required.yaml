rule_id: gcp.pubsub.topic.data_protection_storage_stream_consumer_auth_required
service: pubsub
resource: topic
requirement: Data Protection Storage Stream Consumer Auth Required
scope: pubsub.topic.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Enforce Auth on Pub/Sub Topic Stream Consumers
rationale: Requiring authentication for Pub/Sub topic stream consumers ensures that
  only authorized applications can consume sensitive data. This mitigates risks of
  unauthorized data access, which can lead to data breaches, regulatory non-compliance,
  and potential financial and reputational damage.
description: This rule checks if authentication is enforced for consumers of a Pub/Sub
  topic. Ensure that only authenticated identities are granted permissions to consume
  messages from a topic. Verify IAM policies associated with the topic to ensure 'roles/pubsub.subscriber'
  is only assigned to authenticated identities. To remediate, update IAM policies
  to restrict access to trusted service accounts or identities.
references:
- https://cloud.google.com/pubsub/docs/access-control
- https://cloud.google.com/security/compliance/cis-gcp-foundations-benchmark
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://cloud.google.com/iam/docs/understanding-roles
- https://cloud.google.com/pubsub/docs/security-best-practices
