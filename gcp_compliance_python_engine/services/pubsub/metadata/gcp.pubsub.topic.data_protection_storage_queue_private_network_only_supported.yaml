rule_id: gcp.pubsub.topic.data_protection_storage_queue_private_network_only_supported
service: pubsub
resource: topic
requirement: Data Protection Storage Queue Private Network Only Supported
scope: pubsub.topic.network_security
domain: network_security_and_connectivity
subcategory: network_access_control
severity: medium
title: Ensure Pub/Sub Topics Use Private Network for Enhanced Security
rationale: Restricting Pub/Sub topic access to private networks minimizes exposure
  to unauthorized access and data breaches. It ensures data confidentiality by confining
  data flow within trusted network boundaries, which is crucial for compliance with
  regulations such as GDPR and HIPAA. This practice reduces the risk of data interception
  or misuse by malicious actors.
description: This rule checks if Pub/Sub topics are configured to only allow access
  from private networks. Ensure that the topics are not exposed to the public internet
  by using VPC Service Controls or private IP addresses. Verification involves checking
  network settings in the Google Cloud Console under the Pub/Sub section and configuring
  the network to restrict access. Remediation includes adjusting the IAM policies
  and network settings to limit access to trusted internal networks only.
references:
- https://cloud.google.com/pubsub/docs/security-overview
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/vpc-service-controls/docs
- https://www.iso.org/isoiec-27001-information-security.html
- https://www.pcisecuritystandards.org/documents/PCI-DSS-v3_2_1.pdf
