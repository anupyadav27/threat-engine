rule_id: gcp.pubsub.topic.data_protection_storage_queue_cross_account_send__restricted
service: pubsub
resource: topic
requirement: Data Protection Storage Queue Cross Account Send Restricted
scope: pubsub.topic.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Restrict Cross-Account Data Sent via Pub/Sub Topics
rationale: Restricting cross-account data sends in Pub/Sub topics is critical to prevent
  unauthorized access and data leakage between different projects or organizations.
  This control helps mitigate risks associated with data exfiltration and ensures
  adherence to data protection regulations such as GDPR and CCPA, which require stringent
  controls over data access and sharing.
description: This rule checks that Pub/Sub topics are configured to restrict cross-account
  data sends, ensuring that only authorized entities within the same account can publish
  messages. Verify that the IAM policies on Pub/Sub topics do not allow 'roles/pubsub.publisher'
  or similar permissions to external accounts. Remediate by reviewing and refining
  IAM policies, ensuring only necessary internal roles have publishing capabilities,
  and use VPC Service Controls to further restrict data movement.
references:
- https://cloud.google.com/pubsub/docs/access-control
- https://cloud.google.com/security/compliance/cis#gcp_pubsub
- https://www.nist.gov/cyberframework
- https://cloud.google.com/security/compliance/gdpr
- https://cloud.google.com/vpc-service-controls/docs/overview
