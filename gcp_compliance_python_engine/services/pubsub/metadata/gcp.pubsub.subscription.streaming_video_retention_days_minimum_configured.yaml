rule_id: gcp.pubsub.subscription.streaming_video_retention_days_minimum_configured
service: pubsub
resource: subscription
requirement: Streaming Video Retention Days Minimum Configured
scope: pubsub.subscription.security
domain: compliance_and_governance
subcategory: security_monitoring
severity: low
title: Ensure Minimum Retention for Streaming Video Subscriptions in Pub/Sub
rationale: Setting a minimum retention period for streaming video data in Pub/Sub
  is crucial to ensure that data is available for auditing, troubleshooting, and compliance
  purposes. Insufficient retention can lead to data loss, impacting business operations
  and regulatory compliance, especially in industries with strict data governance
  requirements.
description: This rule checks that Google Cloud Pub/Sub subscriptions associated with
  streaming video data have a minimum retention period configured. Specifically, it
  ensures that the 'ackDeadlineSeconds' and 'retainAckedMessages' settings are appropriately
  configured to prevent premature data deletion. To verify, inspect the subscription
  configuration in the GCP Console or via the gcloud command-line tool. If not compliant,
  update the settings to meet the required retention period.
references:
- https://cloud.google.com/pubsub/docs/subscriber
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/pubsub/docs/best-practices
- https://cloud.google.com/iam/docs/overview
