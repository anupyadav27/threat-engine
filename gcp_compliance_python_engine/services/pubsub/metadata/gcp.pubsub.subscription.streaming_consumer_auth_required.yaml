rule_id: gcp.pubsub.subscription.streaming_consumer_auth_required
service: pubsub
resource: subscription
requirement: Streaming Consumer Auth Required
scope: pubsub.subscription.security
domain: compliance_and_governance
subcategory: security_monitoring
severity: low
title: Ensure Pub/Sub Streaming Consumers Use Authenticated Connections
rationale: Requiring authentication for Pub/Sub streaming consumers mitigates the
  risk of unauthorized data access and potential data leakage. It helps maintain data
  integrity and confidentiality, ensuring that only authorized entities can consume
  sensitive messages. This is critical for meeting compliance requirements and protecting
  intellectual property.
description: This rule checks that all Pub/Sub subscriptions configured for streaming
  pull operations require authentication using service accounts. To verify, ensure
  that IAM roles granting subscriber permissions are only assigned to trusted service
  accounts. Remediation involves auditing current IAM policies and updating them to
  restrict unauthorized access by enforcing service account usage for streaming consumers.
references:
- https://cloud.google.com/pubsub/docs/authentication
- https://cloud.google.com/pubsub/docs/access-control
- https://cloud.google.com/iam/docs/understanding-service-accounts
- 'CIS GCP Benchmark: Ensure Pub/Sub topics and subscriptions are configured with
  appropriate IAM policies'
- 'NIST SP 800-53 Rev. 5: AC-6 Least Privilege'
