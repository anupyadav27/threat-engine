rule_id: gcp.pubsub.subscription.streaming_logging_enabled
service: pubsub
resource: subscription
requirement: Streaming Logging Enabled
scope: pubsub.subscription.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: medium
title: Ensure Pub/Sub Subscription Has Streaming Logging Enabled
rationale: Enabling streaming logging for Pub/Sub subscriptions is critical for security
  and operational visibility. It allows tracking of message delivery and access patterns,
  which helps in detecting unauthorized use, troubleshooting issues, and complying
  with data governance policies. Without logging, organizations may face increased
  risk of undetected data breaches and non-compliance with standards like PCI-DSS
  and SOC 2.
description: This rule checks whether streaming logging is enabled for Google Cloud
  Pub/Sub subscriptions. Streaming logs capture detailed information about message
  delivery activities and access events. Organizations should enable this feature
  through the Google Cloud Console or via the gcloud command-line tool. To remediate,
  configure the subscription to send logs to a Cloud Logging sink, ensuring real-time
  monitoring and alerting capabilities are active.
references:
- https://cloud.google.com/pubsub/docs/monitoring
- https://cloud.google.com/logging/docs/audit
- https://www.cisecurity.org/benchmark/google_cloud_computing_foundations
- https://cloud.google.com/security/compliance
- https://cloud.google.com/logging/docs
- https://cloud.google.com/pubsub/docs/admin
