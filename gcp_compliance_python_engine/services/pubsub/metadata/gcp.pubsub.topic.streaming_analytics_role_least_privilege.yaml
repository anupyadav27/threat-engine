rule_id: gcp.pubsub.topic.streaming_analytics_role_least_privilege
service: pubsub
resource: topic
requirement: Streaming Analytics Role Least Privilege
scope: pubsub.topic.least_privilege
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Enforce Least Privilege for Pub/Sub Streaming Analytics Roles
rationale: Implementing least privilege for Pub/Sub topics minimizes the risk of unauthorized
  data access and potential data breaches. Excessive permissions can lead to inadvertent
  data exposure or malicious actions by insiders or compromised accounts. Ensuring
  that roles only have the necessary permissions supports compliance with regulations
  like PCI-DSS and GDPR, which mandate strict access controls.
description: This rule checks that IAM roles assigned to Pub/Sub topics used in streaming
  analytics are configured with the least privilege principle. It verifies that roles
  do not include excessive permissions that are not required for their specific tasks.
  To remediate, audit the IAM roles associated with these topics and adjust permissions
  to include only those necessary for the task, following the principle of least privilege.
  Regularly review and update the roles to adapt to any changes in business processes
  or team responsibilities.
references:
- https://cloud.google.com/pubsub/docs/access-control
- https://cloud.google.com/security/compliance/cis-gcp-foundations-benchmark
- https://www.pcisecuritystandards.org/
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- https://cloud.google.com/iam/docs/understanding-roles
- https://cloud.google.com/security/overview/whitepaper
