rule_id: gcp.pubsub.subscription.streaming_consumer_access_least_privilege
service: pubsub
resource: subscription
requirement: Streaming Consumer Access Least Privilege
scope: pubsub.subscription.least_privilege
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Ensure Least Privilege for Pub/Sub Subscription Consumers
rationale: Implementing least privilege for Pub/Sub subscription consumers minimizes
  the risk of data breaches by reducing the attack surface. Over-permissioned roles
  can lead to unauthorized access to sensitive messages, potentially violating compliance
  with standards such as PCI-DSS and HIPAA. Ensuring least privilege supports secure
  operations and protects organizational data integrity.
description: This rule checks that IAM roles granted to streaming consumers on Pub/Sub
  subscriptions have only the necessary permissions to perform their tasks. Verify
  and adjust roles to ensure consumers cannot perform actions beyond what is needed
  for their specific function, such as removing 'roles/pubsub.viewer' if 'roles/pubsub.subscriber'
  suffices. Remediation involves auditing IAM policies and using the principle of
  least privilege to restrict permissions accordingly.
references:
- https://cloud.google.com/pubsub/docs/access-control
- https://cloud.google.com/security/compliance/cis#gcp_cis_benchmarks
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/iam/docs/using-iam-securely
- https://cloud.google.com/architecture/security-foundations
