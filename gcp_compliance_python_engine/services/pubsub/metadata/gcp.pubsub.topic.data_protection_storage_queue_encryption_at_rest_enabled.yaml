rule_id: gcp.pubsub.topic.data_protection_storage_queue_encryption_at_rest_enabled
service: pubsub
resource: topic
requirement: Data Protection Storage Queue Encryption At Rest Enabled
scope: pubsub.topic.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure Pub/Sub Topic Encryption at Rest is Enabled
rationale: Encrypting data at rest is crucial for protecting sensitive information
  from unauthorized access and potential data breaches. It helps mitigate risks associated
  with data theft and ensures compliance with regulatory standards such as GDPR and
  HIPAA, which mandate the protection of personal and sensitive data. Failure to encrypt
  can lead to significant financial and reputational damage in the event of data compromise.
description: This rule verifies that all Pub/Sub topics have encryption at rest enabled
  using either Google-managed or customer-managed encryption keys. Ensure that the
  topic is configured to use Cloud KMS keys if custom encryption is preferred. To
  verify, check the encryption properties of each Pub/Sub topic in the GCP Console
  or using the gcloud command-line tool. Remediation involves configuring the topic
  to use the desired encryption key, ensuring data remains protected.
references:
- https://cloud.google.com/pubsub/docs/encryption
- https://cloud.google.com/security/compliance/cis#gcp
- https://cloud.google.com/security/compliance/gdpr
- https://cloud.google.com/security/compliance/hipaa
- https://cloud.google.com/kms/docs/encrypt-decrypt
