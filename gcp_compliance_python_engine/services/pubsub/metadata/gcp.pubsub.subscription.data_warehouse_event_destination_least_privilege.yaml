rule_id: gcp.pubsub.subscription.data_warehouse_event_destination_least_privilege
service: pubsub
resource: subscription
requirement: Data Warehouse Event Destination Least Privilege
scope: pubsub.subscription.least_privilege
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Ensure Least Privilege for Pub/Sub Data Warehouse Subscriptions
rationale: Granting excessive permissions to Pub/Sub subscriptions for data warehouse
  events can lead to unauthorized data access and potential data breaches. Ensuring
  least privilege helps mitigate the risk of data exposure and supports compliance
  with data protection standards such as PCI-DSS and ISO 27001, which require stringent
  access controls.
description: This rule verifies that Pub/Sub subscriptions used as event destinations
  for data warehouses have the minimal set of permissions necessary to function. It
  checks the IAM policies attached to these subscriptions to ensure they are not overly
  permissive. To remediate, audit the IAM roles associated with the subscription and
  adjust them to restrict access to only what is necessary for the required operations.
references:
- https://cloud.google.com/pubsub/docs/access-control
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/iam/docs/understanding-roles
- https://cloud.google.com/iam/docs/least-privilege
