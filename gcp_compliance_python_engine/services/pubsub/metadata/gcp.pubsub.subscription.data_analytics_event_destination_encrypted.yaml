rule_id: gcp.pubsub.subscription.data_analytics_event_destination_encrypted
service: pubsub
resource: subscription
requirement: Data Analytics Event Destination Encrypted
scope: pubsub.subscription.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Pub/Sub Analytics Destinations are Encrypted
rationale: Encrypting data at rest for Pub/Sub analytics event destinations is crucial
  to protect sensitive information from unauthorized access and data breaches, especially
  in environments handling regulated data. This measure helps satisfy compliance requirements
  such as GDPR and HIPAA, and mitigates risks associated with data leakage and cyber
  threats.
description: This rule checks if Pub/Sub subscriptions for data analytics events have
  encryption at rest enabled using customer-managed keys (CMKs) or Google-managed
  encryption keys. To verify, ensure that the 'encryptionConfig' field within your
  Pub/Sub subscription configuration is defined and points to the correct Cloud KMS
  key. Remediation involves updating the subscription settings to specify an appropriate
  encryption key using the Google Cloud Console or gcloud CLI.
references:
- https://cloud.google.com/pubsub/docs/encryption
- https://cloud.google.com/kms/docs
- CIS Google Cloud Computing Foundations Benchmark v1.3.0, Section 4.2
- https://cloud.google.com/security/compliance
- NIST SP 800-57 Part 1 - Recommendation for Key Management
- https://cloud.google.com/security/encryption-at-rest/default-encryption
