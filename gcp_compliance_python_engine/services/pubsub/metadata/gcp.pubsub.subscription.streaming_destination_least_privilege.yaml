rule_id: gcp.pubsub.subscription.streaming_destination_least_privilege
service: pubsub
resource: subscription
requirement: Streaming Destination Least Privilege
scope: pubsub.subscription.least_privilege
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Ensure Pub/Sub Subscriptions Use Least Privilege
rationale: Implementing least privilege for Pub/Sub subscriptions minimizes the risk
  of unauthorized data access and potential data breaches. Misconfigured permissions
  can lead to privilege escalation, allowing malicious actors to exploit data streams.
  Ensuring least privilege aligns with compliance standards like PCI-DSS and ISO 27001,
  protecting sensitive data and maintaining trust.
description: This rule checks that IAM roles assigned to Pub/Sub subscriptions grant
  only the necessary permissions for their specific task. Review and adjust the IAM
  policies associated with your subscriptions to ensure they follow the principle
  of least privilege. Verify roles via Google Cloud Console or gcloud CLI and limit
  permissions to only those required for the subscription's intended function. Regular
  audits and updates to these roles are recommended to adapt to evolving security
  needs.
references:
- https://cloud.google.com/pubsub/docs/access-control
- https://cloud.google.com/security/compliance/cis-gcp-benchmark
- https://www.nist.gov/cyberframework
- https://cloud.google.com/iam/docs/best-practices
- https://cloud.google.com/security/compliance/iso-27001
- https://cloud.google.com/security/compliance/pci-dss
