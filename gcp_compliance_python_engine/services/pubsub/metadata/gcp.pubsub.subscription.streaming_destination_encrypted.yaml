rule_id: gcp.pubsub.subscription.streaming_destination_encrypted
service: pubsub
resource: subscription
requirement: Streaming Destination Encrypted
scope: pubsub.subscription.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Pub/Sub Streaming Destination Encryption at Rest
rationale: Encrypting Pub/Sub subscription data at rest is crucial for protecting
  sensitive information from unauthorized access and meeting compliance mandates such
  as GDPR and HIPAA. Without encryption, data is vulnerable to breaches, potentially
  leading to financial loss and reputational damage. It is essential for organizations
  to ensure that all data stored in Google Cloud Pub/Sub is encrypted to mitigate
  these risks.
description: This rule checks that all Google Cloud Pub/Sub subscriptions have their
  streaming data destinations encrypted at rest using Customer-Managed Encryption
  Keys (CMEK) or Google-managed encryption. Verify that the `kmsKeyName` is set for
  subscriptions requiring CMEK. If not configured, apply the necessary encryption
  settings via the Google Cloud Console or gcloud CLI to ensure compliance with data
  protection policies.
references:
- https://cloud.google.com/pubsub/docs/encryption
- https://cloud.google.com/security/compliance
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://cloud.google.com/security/encryption-at-rest/default-encryption
