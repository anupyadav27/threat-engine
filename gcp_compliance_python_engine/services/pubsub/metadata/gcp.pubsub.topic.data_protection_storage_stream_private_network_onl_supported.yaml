rule_id: gcp.pubsub.topic.data_protection_storage_stream_private_network_onl_supported
service: pubsub
resource: topic
requirement: Data Protection Storage Stream Private Network Onl Supported
scope: pubsub.topic.network_security
domain: network_security_and_connectivity
subcategory: network_access_control
severity: medium
title: Ensure Pub/Sub Topics Use Private Network for Data Streaming
rationale: Using a private network to stream data to Pub/Sub topics minimizes the
  exposure of sensitive information to potential attackers. This approach reduces
  the risk of data breaches, unauthorized access, and man-in-the-middle attacks, which
  can have severe business impacts and violate compliance with regulations like GDPR
  and HIPAA.
description: This rule checks whether data streaming to Pub/Sub topics is restricted
  to a private network, ensuring that the data exchange between producers and Pub/Sub
  happens securely over a Virtual Private Cloud (VPC). Verify that all Pub/Sub topics
  are configured to use VPC Service Controls. To remediate, configure your Pub/Sub
  topic to enforce VPC Service Controls by using the 'private service connect' feature,
  which restricts access to your VPC network.
references:
- https://cloud.google.com/pubsub/docs/vpc
- https://cloud.google.com/vpc-service-controls/docs
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/network-connectivity/docs/psc/configure
