rule_id: gcp.pubsub.subscription.data_warehouse_event_destination_encrypted
service: pubsub
resource: subscription
requirement: Data Warehouse Event Destination Encrypted
scope: pubsub.subscription.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Pub/Sub Subscription Event Destination is Encrypted
rationale: Encryption of data at rest is crucial for protecting sensitive information
  from unauthorized access and potential data breaches. Inadequately encrypted data
  can lead to exposure of confidential business information, violating compliance
  with standards such as PCI-DSS and HIPAA. Encrypting data within Pub/Sub ensures
  that event data sent to data warehouses is secure, maintaining data integrity and
  privacy.
description: This rule checks if the Google Cloud Pub/Sub subscription used as a data
  warehouse event destination is encrypted at rest. Specifically, it verifies that
  Cloud KMS keys are used to encrypt the data. To ensure compliance, configure the
  subscription to use customer-managed encryption keys (CMEK) via the Pub/Sub console
  or gcloud CLI. Remediation involves setting the appropriate CMEK during the subscription
  creation or updating the configuration to include encryption settings.
references:
- https://cloud.google.com/pubsub/docs/encryption
- https://cloud.google.com/security/compliance/cis-gcp-benchmark
- https://cloud.google.com/security/compliance
- https://cloud.google.com/kms/docs/overview
- https://cloud.google.com/security/encryption-at-rest/
