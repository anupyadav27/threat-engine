rule_id: gcp.pubsub.topic.streaming_analytics_checkpoints_and_outputs_encrypted
service: pubsub
resource: topic
requirement: Streaming Analytics Checkpoints And Outputs Encrypted
scope: pubsub.topic.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Pub/Sub Topics for Streaming Analytics Are Encrypted
rationale: Encrypting Pub/Sub topics that handle streaming analytics data prevents
  unauthorized access and ensures data integrity. This is crucial for protecting sensitive
  information and complying with regulations such as GDPR and HIPAA that mandate data
  encryption. Failure to encrypt data at rest can lead to data breaches, financial
  loss, and reputational damage.
description: This rule checks if Pub/Sub topics used in streaming analytics pipelines
  have encryption enabled. Verify that Cloud KMS keys are used for encrypting Pub/Sub
  topic data at rest. To remediate, configure the Pub/Sub topic to use a customer-managed
  encryption key (CMEK) by specifying the KMS key in the topic settings. This enhances
  data protection and aligns with best practices for encryption.
references:
- https://cloud.google.com/pubsub/docs/encryption
- https://cloud.google.com/security/compliance/cis-benchmarks
- https://cloud.google.com/security/compliance/gdpr
- https://cloud.google.com/kms/docs/cmek
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/security/compliance/hipaa
