rule_id: gcp.cloudsql.instance.postgres_log_min_error_statement_flag
service: cloudsql
resource: instance
requirement: Postgres Log Min Error Statement Flag
scope: cloudsql.instance.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: low
title: Ensure Postgres Log Min Error Statement is Configured Correctly
rationale: Proper configuration of the Postgres log_min_error_statement flag helps
  in identifying and troubleshooting SQL errors by capturing error statements in the
  logs. This is crucial for detecting potential security incidents and operational
  issues. Misconfiguration can lead to incomplete logging, hindering forensic investigations
  and failing to meet compliance standards such as PCI-DSS and HIPAA.
description: This rule checks if the Postgres 'log_min_error_statement' flag is set
  to 'ERROR' or a more detailed level on Cloud SQL instances. This setting ensures
  that all SQL statements that generate errors, including syntax errors and permission
  denials, are logged. To verify, inspect the database flags configuration in the
  GCP Console or via gcloud CLI. Remediate by updating the flag in the Cloud SQL instance
  settings to 'ERROR' or 'ALL', and restart the instance for changes to take effect.
references:
- https://cloud.google.com/sql/docs/postgres/flags
- https://cloud.google.com/sql/docs/postgres/diagnose-issues
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/sql/docs/postgres/configure-logging
- https://cloud.google.com/sql/docs/postgres/audit-logging
