rule_id: gcp.cloudsql.instance.postgres_log_disconnections_flag
service: cloudsql
resource: instance
requirement: Postgres Log Disconnections Flag
scope: cloudsql.instance.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: low
title: Enable Postgres Log Disconnections for Cloud SQL Instances
rationale: Logging disconnections in PostgreSQL helps in tracking user sessions and
  identifying unexpected disconnections, which can indicate potential security incidents
  or misconfigurations. This is crucial for forensic analysis and compliance with
  regulations that require detailed activity logs, such as PCI-DSS and SOC2.
description: This rule checks whether the 'log_disconnections' flag is enabled for
  PostgreSQL instances on Cloud SQL. Enabling this flag ensures that all disconnection
  events are logged, providing visibility into session terminations. To verify, navigate
  to the Cloud SQL instance settings in the Google Cloud Console and ensure that 'log_disconnections'
  is set to 'on'. Remediation involves setting this flag to 'on' via the Cloud Console
  or using gcloud CLI.
references:
- https://cloud.google.com/sql/docs/postgres/flags#postgres-flags
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/sql/docs/postgres/logging
