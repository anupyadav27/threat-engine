rule_id: gcp.cloudsql.instance.db_public_access_disabled
service: cloudsql
resource: instance
requirement: Db Public Access Disabled
scope: cloudsql.instance.public_access
domain: identity_and_access_management
subcategory: authentication
severity: critical
title: Disable Public Access for Cloud SQL Instances
rationale: Exposing Cloud SQL instances to the public internet increases the risk
  of unauthorized access, data breaches, and potential exploitation of database vulnerabilities.
  By disabling public access, organizations can ensure that only authorized internal
  networks can access database services, reducing the attack surface and aligning
  with compliance requirements such as PCI-DSS and ISO 27001.
description: This rule checks if Cloud SQL instances have public IP addresses assigned,
  which allows connections from any IP address on the internet. To verify, inspect
  the SQL instance settings via the GCP Console or use gcloud commands to list instances
  with public IPs. Remediation involves configuring instances to use private IPs by
  modifying network settings, ensuring access is restricted to specific internal networks
  or VPNs.
references:
- https://cloud.google.com/sql/docs/mysql/private-ip
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/pci_security/
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/security/best-practices
