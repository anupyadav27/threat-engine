rule_id: gcp.cloudsql.instance.public_ip_configured
service: cloudsql
resource: instance
requirement: Public Ip Configured
scope: cloudsql.instance.public_access
domain: identity_and_access_management
subcategory: authentication
severity: critical
title: Ensure Cloud SQL Instances Do Not Use Public IP Addresses
rationale: Exposing Cloud SQL instances to the internet via public IPs increases the
  risk of unauthorized access and data breaches. This can lead to sensitive information
  exposure, non-compliance with regulations like GDPR and HIPAA, and potential financial
  and reputational damage to the organization. Limiting access to private IPs within
  VPC networks enhances security by reducing the attack surface.
description: This rule checks if a Cloud SQL instance is configured with a public
  IP address. Public IPs allow direct internet access, which can be exploited by attackers.
  To verify, check the instance's IP configuration in the GCP Console or via gcloud
  CLI. Remediation involves disabling the public IP and ensuring the instance is accessed
  through a private IP within a VPC network, possibly utilizing Cloud SQL Proxy for
  secure connections.
references:
- https://cloud.google.com/sql/docs/mysql/configure-private-ip
- https://cloud.google.com/sql/docs/mysql/private-ip
- https://cloud.google.com/security/compliance/cis
- https://cloud.google.com/security/compliance
- https://cloud.google.com/sql/docs/mysql/sql-proxy
- https://cloud.google.com/security/best-practices
