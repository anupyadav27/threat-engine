rule_id: gcp.cloudsql.instance.db_only_approved_extensions_enabled
service: cloudsql
resource: instance
requirement: Db Only Approved Extensions Enabled
scope: cloudsql.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Ensure Only Approved Extensions Enabled on Cloud SQL Instances
rationale: Enabling only approved database extensions in Cloud SQL reduces the attack
  surface by preventing potentially vulnerable or unnecessary features from being
  used. This minimizes the risk of data breaches and ensures compliance with internal
  security policies and external regulations, such as PCI-DSS and HIPAA, which require
  minimizing the exposure of sensitive data to unvetted code.
description: This rule verifies that only approved extensions are enabled on Cloud
  SQL instances. Administrators should maintain a list of allowed extensions, ensuring
  that any unapproved extensions are disabled. To verify, audit the extensions enabled
  on the instance via the Google Cloud Console or gcloud command-line tool, and compare
  them against the approved list. Remediation involves disabling unapproved extensions
  and revisiting database functionality to ensure business operations are not disrupted.
references:
- https://cloud.google.com/sql/docs/mysql/extensions
- https://cloud.google.com/security/compliance/cis#gcp
- https://www.pcisecuritystandards.org/pci_security/
- https://www.hipaajournal.com/hipaa-compliance-requirements/
- https://cloud.google.com/security/best-practices
