rule_id: gcp.cloudsql.ssl_cert.db_sg_egress_restricted
service: cloudsql
resource: ssl_cert
requirement: Db Sg Egress Restricted
scope: cloudsql.ssl_cert.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Restrict Egress for Cloud SQL SSL Certificates
rationale: Restricting egress traffic for SSL certificates in Cloud SQL is crucial
  to prevent unauthorized data exfiltration and to ensure compliance with data protection
  regulations. Unrestricted egress can lead to potential exposure of sensitive data
  and can increase the risk of data breaches, affecting business continuity and trust.
description: This rule checks if egress traffic from Cloud SQL SSL certificates is
  restricted to specific IPs or networks. Proper configuration involves setting up
  firewall rules that limit outbound connections to only trusted destinations. Verify
  that network security groups associated with Cloud SQL instances have specific egress
  rules. Remediation includes configuring egress rules in the VPC firewall to permit
  only necessary traffic, ensuring that all data transfers are encrypted and securely
  transmitted.
references:
- https://cloud.google.com/sql/docs/mysql/configure-ssl-instance
- https://cloud.google.com/sql/docs/security-overview
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.iso.org/iso-27001-information-security.html
