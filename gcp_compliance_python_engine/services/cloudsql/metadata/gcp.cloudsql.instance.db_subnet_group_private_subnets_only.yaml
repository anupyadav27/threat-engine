rule_id: gcp.cloudsql.instance.db_subnet_group_private_subnets_only
service: cloudsql
resource: instance
requirement: Db Subnet Group Private Subnets Only
scope: cloudsql.instance.private_networking
domain: network_security_and_connectivity
subcategory: network_access_control
severity: low
title: Ensure Cloud SQL Instances Use Private Subnets Only
rationale: Using private subnets for Cloud SQL instances reduces exposure to potential
  attacks from the internet and unauthorized access. It aligns with best practices
  for protecting sensitive data against breaches and complies with regulatory requirements
  such as HIPAA and PCI-DSS, which mandate strict control over network access to databases.
description: This rule checks whether Cloud SQL instances are configured to use private
  subnets only within their Db Subnet Group, ensuring that instances do not have public
  IP addresses and are isolated from internet traffic. Verify that the 'Private Service
  Connect' is enabled, and ensure the instance is part of a VPC with private IP enabled.
  Remediation involves updating the instance's settings to disable public IP and configure
  networking to use private IPs only according to GCP documentation.
references:
- https://cloud.google.com/sql/docs/mysql/configure-private-ip
- https://cloud.google.com/sql/docs/postgres/configure-private-ip
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://cloud.google.com/security/compliance
- https://cloud.google.com/sql/docs/sqlserver/configure-private-ip
