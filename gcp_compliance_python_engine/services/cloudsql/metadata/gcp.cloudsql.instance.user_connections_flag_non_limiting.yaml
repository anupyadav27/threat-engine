rule_id: gcp.cloudsql.instance.user_connections_flag_non_limiting
service: cloudsql
resource: instance
requirement: User Connections Flag Non Limiting
scope: cloudsql.instance.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Limit User Connections in Cloud SQL Instances
rationale: Unrestricted user connections to Cloud SQL instances can lead to resource
  exhaustion, potentially causing service disruptions and increased vulnerability
  to denial-of-service attacks. Limiting connections helps maintain availability,
  ensures fair resource usage, and complies with best practices for access management.
  It also aids in meeting compliance requirements for data protection and system integrity.
description: This rule checks whether the 'max_connections' flag is set to a limiting
  value for Cloud SQL instances. A non-limiting configuration can allow excessive
  simultaneous connections, impacting performance and security. To verify, ensure
  that the 'max_connections' flag is configured with a value appropriate for your
  workload and usage patterns. Remediation involves accessing the Cloud SQL instance
  settings and setting a reasonable limit based on expected traffic and resource capacity.
references:
- https://cloud.google.com/sql/docs/mysql/flags
- https://cloud.google.com/sql/docs/postgres/flags
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
