rule_id: gcp.cloudsql.instance.user_options_flag_not_configured
service: cloudsql
resource: instance
requirement: User Options Flag Not Configured
scope: cloudsql.instance.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Ensure Cloud SQL User Options Flag is Properly Configured
rationale: Improper configuration of the user options flag in Cloud SQL instances
  can lead to unauthorized access and potential data breaches. This setting controls
  user-defined parameters that can affect the security posture of the database. Ensuring
  it is configured appropriately helps mitigate risks associated with unauthorized
  database modifications and enhance regulatory compliance with standards such as
  PCI-DSS and HIPAA.
description: This rule verifies that the user options flag is correctly configured
  on Cloud SQL instances to prevent security vulnerabilities. It checks whether any
  user-defined options that could compromise security are enabled. To verify, review
  the SQL instance settings in the GCP Console or use the gcloud command-line tool.
  Remediation involves setting a secure configuration by adjusting the user options
  flag via the Cloud SQL settings interface or by using gcloud CLI commands.
references:
- https://cloud.google.com/sql/docs/mysql/flags
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/sql/docs/mysql/security-overview
- https://cloud.google.com/sql/docs/mysql/configure-instance-settings
- https://www.pcisecuritystandards.org/pci_security/
