rule_id: gcp.cloudsql.instance.public_ip_whitelist_configured
service: cloudsql
resource: instance
requirement: Public Ip Whitelist Configured
scope: cloudsql.instance.public_access
domain: identity_and_access_management
subcategory: authentication
severity: critical
title: Enforce Public IP Whitelisting for Cloud SQL Instances
rationale: Unrestricted public access to Cloud SQL instances can expose sensitive
  data to unauthorized users, leading to potential data breaches and compliance violations.
  Restricting access through IP whitelisting helps mitigate risks from unauthorized
  access, ensuring only trusted networks can connect, aligning with regulatory requirements
  such as PCI-DSS and GDPR.
description: This rule verifies that public IP addresses accessing Cloud SQL instances
  are restricted to a defined set of authorized IP ranges. To ensure security, configure
  the 'Authorized networks' settings in the Cloud SQL instance to include only trusted
  IP addresses. Regularly review and update the IP whitelist to reflect changes in
  trusted network infrastructure. Remediation involves navigating to the Google Cloud
  Console, accessing the Cloud SQL instance settings, and updating the public IP whitelist
  under 'Connections'.
references:
- https://cloud.google.com/sql/docs/mysql/configure-ip
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://cloud.google.com/security/compliance/gdpr/
- https://cloud.google.com/security/compliance/pci-dss/
- https://cloud.google.com/sql/docs/postgres/authorized-networks
- https://cloud.google.com/sql/docs/sqlserver/configure-ip
