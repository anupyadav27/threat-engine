rule_id: gcp.cloudsql.backup.db_snapshot_not_publicly_shared
service: cloudsql
resource: backup
requirement: Db Snapshot Not Publicly Shared
scope: cloudsql.backup.backup_recovery
domain: resilience_and_disaster_recovery
subcategory: backup_configuration
severity: critical
title: Prevent Public Access to Cloud SQL Backup Snapshots
rationale: Publicly shared database snapshots can lead to unauthorized access to sensitive
  data, posing significant security risks and potential compliance violations. Unauthorized
  access could result in data breaches, affecting the organization's reputation and
  potentially leading to regulatory fines under frameworks such as GDPR and HIPAA.
description: This rule checks that Cloud SQL backup snapshots are not publicly shared,
  ensuring they are protected from unauthorized access. To verify, review the access
  control settings in the Cloud SQL backup configuration and ensure that no public
  IAM policies or ACLs are applied. Remediation involves updating permissions to restrict
  access only to necessary users and roles, following the principle of least privilege.
references:
- https://cloud.google.com/sql/docs/mysql/backup-recovery/backups
- https://cloud.google.com/security/compliance/gdpr
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/iam/docs/overview#policy_hierarchy
- https://cloud.google.com/sql/docs/mysql/security
