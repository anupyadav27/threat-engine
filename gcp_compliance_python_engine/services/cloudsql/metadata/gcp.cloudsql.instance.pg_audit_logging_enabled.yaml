rule_id: gcp.cloudsql.instance.pg_audit_logging_enabled
service: cloudsql
resource: instance
requirement: Pg Audit Logging Enabled
scope: cloudsql.instance.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: medium
title: Ensure Pg Audit Logging is Enabled for Cloud SQL Instances
rationale: Enabling Pg Audit logging for Cloud SQL instances is crucial for monitoring
  and tracking access to sensitive database resources. It helps in detecting unauthorized
  access attempts and potential data breaches, thereby safeguarding business-critical
  data. Compliance with regulations such as GDPR, PCI-DSS, and HIPAA often mandates
  comprehensive logging of database activities.
description: This rule verifies that Pg Audit logging is enabled for PostgreSQL instances
  in Google Cloud SQL. Pg Audit provides detailed logging of database activities,
  including connection attempts, disconnections, and data access queries. To enable
  Pg Audit logging, configure the 'cloudsql.enable_pg_audit' flag for your Cloud SQL
  instance. This can be done via the GCP Console, gcloud command-line tool, or API.
  Ensure logs are regularly reviewed and stored securely for audit purposes.
references:
- https://cloud.google.com/sql/docs/postgres/pg-audit-logging
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/
- https://cloud.google.com/security/compliance
- https://cloud.google.com/logging/docs/audit
- https://cloud.google.com/sql/docs/postgres/configure-logs
