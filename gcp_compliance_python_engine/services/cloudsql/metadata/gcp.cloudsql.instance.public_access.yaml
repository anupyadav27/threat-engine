rule_id: gcp.cloudsql.instance.public_access
service: cloudsql
resource: instance
requirement: Public Access
scope: cloudsql.instance.public_access
domain: identity_and_access_management
subcategory: authentication
severity: critical
title: Restrict Public Access to Cloud SQL Instances
rationale: Allowing public access to Cloud SQL instances exposes them to potential
  unauthorized access and attacks, such as brute force or SQL injection. This increases
  the risk of data breaches, compromising sensitive information, and potentially violating
  compliance standards like PCI-DSS, SOC2, or HIPAA, which mandate strict access controls.
description: This rule checks if Cloud SQL instances are configured to allow public
  IP access. Instances should be configured to use private IPs and accessed via a
  secure, private network or VPN. To remediate, ensure that the 'Public IP' setting
  is disabled in the GCP console under the SQL instance settings or configure a private
  IP on the instance. Regularly audit and monitor network configurations to ensure
  no public endpoints are exposed.
references:
- https://cloud.google.com/sql/docs/mysql/configure-ip
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://www.pcisecuritystandards.org/
- https://www.iso.org/iso-27001-information-security.html
- https://www.nist.gov/cyberframework
- https://cloud.google.com/sql/docs/mysql/private-ip
