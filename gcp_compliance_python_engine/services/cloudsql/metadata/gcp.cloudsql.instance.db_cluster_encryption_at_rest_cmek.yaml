rule_id: gcp.cloudsql.instance.db_cluster_encryption_at_rest_cmek
service: cloudsql
resource: instance
requirement: Db Cluster Encryption At Rest Cmek
scope: cloudsql.instance.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Enable CMEK for Cloud SQL Encryption at Rest
rationale: Using Customer-Managed Encryption Keys (CMEK) for Cloud SQL ensures that
  organizations retain control over the encryption keys used to protect sensitive
  data at rest. This reduces the risk of unauthorized data access and enables compliance
  with regulations that require customer control over encryption keys, such as GDPR,
  HIPAA, and PCI-DSS.
description: This rule checks that Cloud SQL instances are configured to use CMEK
  for encryption at rest. To verify, ensure that each Cloud SQL instance has a CMEK
  enabled in the settings. Remediation involves creating a Cloud Key Management Service
  (KMS) key and configuring the Cloud SQL instances to use this key for encrypting
  data at rest.
references:
- https://cloud.google.com/sql/docs/mysql/configure-cmek
- https://cloud.google.com/security/compliance/cis-gcp-foundations-benchmark
- https://cloud.google.com/security/compliance
- https://cloud.google.com/kms/docs/cmek
- https://cloud.google.com/sql/docs/mysql/encryption-at-rest
