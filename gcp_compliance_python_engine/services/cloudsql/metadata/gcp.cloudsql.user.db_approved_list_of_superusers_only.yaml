rule_id: gcp.cloudsql.user.db_approved_list_of_superusers_only
service: cloudsql
resource: user
requirement: Db Approved List Of Superusers Only
scope: cloudsql.user.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Restrict Cloud SQL Superusers to Approved List Only
rationale: Limiting superuser access to Cloud SQL databases to an approved list mitigates
  the risk of unauthorized data access and potential breaches. Superusers have elevated
  privileges, making them prime targets for exploitation in cyber attacks. Ensuring
  only vetted individuals have such access helps maintain data integrity and supports
  compliance with regulations like PCI-DSS and HIPAA.
description: This rule checks that only users from a predefined, approved list have
  superuser privileges in Cloud SQL instances. It verifies that no unauthorized users
  can escalate privileges to a superuser level, which could lead to unauthorized access
  and data manipulation. To remediate, regularly audit user roles and update the approved
  list in your IAM policy settings, ensuring only necessary personnel have superuser
  access. Use the Google Cloud Console or gcloud CLI to manage and verify these configurations.
references:
- https://cloud.google.com/sql/docs/mysql/users
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance/pci-dss
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://cloud.google.com/iam/docs/understanding-service-accounts
- https://cloud.google.com/sql/docs/mysql/roles-and-permissions
