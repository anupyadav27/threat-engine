rule_id: gcp.cloudsql.instance.log_connections_flag_configured
service: cloudsql
resource: instance
requirement: Log Connections Flag Configured
scope: cloudsql.instance.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: low
title: Ensure Cloud SQL Log Connections Flag is Enabled
rationale: Enabling the log connections flag for Cloud SQL instances is crucial for
  monitoring access and detecting potential unauthorized attempts. This setting aids
  in compliance with regulations that mandate logging of access to sensitive data,
  such as PCI-DSS and ISO 27001, and helps in forensic investigations by providing
  detailed connection logs.
description: This rule checks whether the 'log_connections' flag is enabled for Cloud
  SQL instances, which logs all connection requests to the database. To verify, access
  the Cloud SQL instance settings in the GCP Console, navigate to the 'Flags' section,
  and ensure 'log_connections' is set to 'on'. If not enabled, modify the instance
  configuration to include this flag, which can be done via the GCP Console, gcloud
  command-line tool, or Terraform scripts.
references:
- https://cloud.google.com/sql/docs/mysql/flags
- https://cloud.google.com/sql/docs/mysql/monitoring
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance/pci-dss
- https://cloud.google.com/security/compliance/iso-27001
- https://cloud.google.com/sql/docs/mysql/configure-advanced-settings#flags
