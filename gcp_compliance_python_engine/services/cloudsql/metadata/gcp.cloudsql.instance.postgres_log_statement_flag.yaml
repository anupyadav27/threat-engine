rule_id: gcp.cloudsql.instance.postgres_log_statement_flag
service: cloudsql
resource: instance
requirement: Postgres Log Statement Flag
scope: cloudsql.instance.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: low
title: Enable Postgres Log Statement for Cloud SQL Instances
rationale: Enabling the log_statement flag in Cloud SQL for PostgreSQL instances is
  critical for auditing and monitoring activities within your database. This setting
  provides visibility into SQL queries, helping identify potential malicious activities
  such as SQL injection attempts or unauthorized data access. It supports compliance
  requirements by maintaining a clear record of database interactions, which is essential
  for audits and forensic investigations.
description: This rule checks if the log_statement flag is enabled for PostgreSQL
  instances in Cloud SQL. This setting logs SQL statements executed against the database,
  which can be set to log all statements, none, or specific types of statements. To
  ensure comprehensive logging, configure the log_statement parameter to 'all'. This
  can be verified and set in the instance's database flags configuration. If not enabled,
  update the Cloud SQL instance settings to include the log_statement flag set to
  'all' to ensure complete logging of database activities.
references:
- https://cloud.google.com/sql/docs/postgres/flags#log_statement
- https://cloud.google.com/security/compliance/cis/benchmark
- https://cloud.google.com/security/compliance/nist
- https://cloud.google.com/sql/docs/audit-logs
- https://cloud.google.com/sql/docs/postgres/configure-pg-flags
