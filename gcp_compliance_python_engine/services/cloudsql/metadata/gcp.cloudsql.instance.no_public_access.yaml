rule_id: gcp.cloudsql.instance.no_public_access
service: cloudsql
resource: instance
requirement: No Public Access
scope: cloudsql.instance.public_access
domain: identity_and_access_management
subcategory: authentication
severity: critical
title: Disable Public IP for Cloud SQL Instances
rationale: Exposing Cloud SQL instances to the public internet increases the risk
  of unauthorized access and potential data breaches. Public IP access can be exploited
  by attackers to launch brute force attacks or exploit vulnerabilities. Restricting
  access to private IPs helps maintain data confidentiality and aligns with compliance
  requirements such as PCI-DSS and HIPAA, which mandate the protection of sensitive
  data.
description: This rule checks if a Cloud SQL instance is configured with a public
  IP, which should be disabled to prevent unauthorized internet access. Verify that
  all instances use private IP connections by checking the 'IP configuration' settings
  in the GCP Console or via the gcloud command-line tool. To remediate, modify the
  instance settings to disable public IP and enable private IP connectivity, ensuring
  that access is controlled through authorized networks and identity-based access
  management.
references:
- https://cloud.google.com/sql/docs/mysql/private-ip
- CIS Google Cloud Platform Foundation Benchmark v1.1.0, Section 6.4
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/security/compliance/hipaa
