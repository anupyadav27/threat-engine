rule_id: gcp.cloudsql.backup.db_snapshot_encrypted
service: cloudsql
resource: backup
requirement: Db Snapshot Encrypted
scope: cloudsql.backup.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Cloud SQL Snapshots are Encrypted at Rest
rationale: Encrypting database snapshots is crucial to prevent unauthorized access
  to sensitive data, which could lead to data breaches and non-compliance with regulatory
  standards such as GDPR and PCI-DSS. Without encryption, any snapshot could be accessed
  by malicious actors, posing a threat to data integrity and privacy.
description: This rule checks whether Cloud SQL snapshots are encrypted at rest using
  customer-managed encryption keys (CMEK) or Google-managed encryption keys. To verify,
  ensure that the 'backups' setting for your Cloud SQL instance is enabled and that
  encryption configurations are properly set up. Remediation involves configuring
  your Cloud SQL instance to use the appropriate encryption keys and verifying the
  encryption status of existing snapshots.
references:
- https://cloud.google.com/sql/docs/mysql/backup-recovery/backups
- https://cloud.google.com/security/encryption-at-rest/default-encryption
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://www.pcisecuritystandards.org/
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/security/compliance
