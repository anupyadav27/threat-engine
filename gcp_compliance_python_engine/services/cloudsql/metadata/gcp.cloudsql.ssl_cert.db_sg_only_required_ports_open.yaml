rule_id: gcp.cloudsql.ssl_cert.db_sg_only_required_ports_open
service: cloudsql
resource: ssl_cert
requirement: Db Sg Only Required Ports Open
scope: cloudsql.ssl_cert.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Cloud SQL SSL Certs Have Only Required Ports Open
rationale: Limiting open ports for Cloud SQL SSL certificates reduces the attack surface,
  mitigating risks of unauthorized access and potential data breaches. This is crucial
  for protecting sensitive data hosted in databases, ensuring compliance with data
  privacy regulations such as GDPR and HIPAA, and maintaining operational integrity
  by preventing service disruptions from malicious activities.
description: This rule checks that only necessary ports are open for Cloud SQL instances
  utilizing SSL certificates, in accordance with security best practices. Administrators
  should verify that the database security groups (SG) only allow traffic on ports
  required for application functionality, typically port 3306 for MySQL or port 5432
  for PostgreSQL. Remediation involves reviewing and updating firewall rules to restrict
  open ports to only those essential for legitimate database operations, minimizing
  exposure to potential threats.
references:
- https://cloud.google.com/sql/docs/mysql/authorize-networks
- https://cloud.google.com/sql/docs/postgres/configure-ssl-instance
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://www.iso.org/iso-27001-information-security.html
- https://www.pcisecuritystandards.org/
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
