rule_id: gcp.cloudsql.instance.enhanced_monitoring_enabled
service: cloudsql
resource: instance
requirement: Enhanced Monitoring Enabled
scope: cloudsql.instance.monitoring
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: medium
title: Ensure Enhanced Monitoring for Cloud SQL Instances
rationale: Enabling enhanced monitoring for Cloud SQL instances provides deeper insights
  into system performance, which is critical for identifying and mitigating potential
  security threats and ensuring optimal operation. It helps in meeting compliance
  requirements by providing detailed metrics and logs, which are necessary for audit
  trails and forensic investigations in case of a security incident.
description: This rule checks whether enhanced monitoring is enabled for Cloud SQL
  instances, which involves configuring the instances to export detailed performance
  metrics to Cloud Monitoring. To verify, check the 'Database' section in the Google
  Cloud Console and ensure 'Enable Cloud Monitoring' is activated. Remediation involves
  enabling this feature, which can be done via the Cloud Console or gcloud command-line
  tool, ensuring that the Cloud SQL Admin API is enabled and proper IAM roles are
  assigned.
references:
- https://cloud.google.com/sql/docs/mysql/monitoring
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.nist.gov/cyberframework
- https://cloud.google.com/monitoring
- https://cloud.google.com/sql/docs/postgres/monitoring
- https://cloud.google.com/sql/docs/sqlserver/monitoring
