rule_id: gcp.cloudsql.user.db_password_auth_hardened_or_iam_auth_preferred_wh_supported
service: cloudsql
resource: user
requirement: Db Password Auth Hardened Or IAM Auth Preferred Wh Supported
scope: cloudsql.user.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Ensure Cloud SQL Users Use Hardened Passwords or IAM Authentication
rationale: Weak database password authentication increases the risk of unauthorized
  access to sensitive data, potentially leading to data breaches and non-compliance
  with regulations like PCI-DSS and HIPAA. Enforcing IAM authentication or hardened
  password policies reduces these risks by implementing stronger access controls and
  centralized identity management.
description: This rule checks Cloud SQL user accounts to ensure they are using either
  IAM authentication, where supported, or database passwords that meet hardened security
  requirements. Verify that IAM authentication is enabled for databases that support
  it, or enforce strong password policies, such as a minimum length of 12 characters
  with complexity requirements, for database password authentication. To remediate,
  configure IAM roles for database access or update the password policy settings in
  the Google Cloud Console for Cloud SQL.
references:
- https://cloud.google.com/sql/docs/mysql/authentication
- https://cloud.google.com/sql/docs/postgres/authentication
- https://cloud.google.com/iam/docs/overview
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.hipaajournal.com/hipaa-security-rule/
