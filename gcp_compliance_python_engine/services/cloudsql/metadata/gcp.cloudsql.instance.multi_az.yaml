rule_id: gcp.cloudsql.instance.multi_az
service: cloudsql
resource: instance
requirement: Multi Az
scope: cloudsql.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Ensure Cloud SQL Instances Use Multi-Region Deployment
rationale: Deploying Cloud SQL instances across multiple availability zones (AZs)
  enhances fault tolerance and availability. This configuration protects against zonal
  outages, ensuring business continuity and minimizing downtime, which is critical
  for applications requiring high availability. It also aligns with compliance frameworks
  demanding robust failover mechanisms as part of disaster recovery strategies.
description: This rule checks if Cloud SQL instances are configured to use multi-region
  (multi-AZ) deployment. To verify, inspect the instance settings in the Google Cloud
  Console or via the gcloud command-line tool to confirm that the 'region' setting
  includes multiple AZs. Remediation involves enabling the high-availability (HA)
  option during instance setup or modifying existing instances to enable HA, ensuring
  they are spread across multiple AZs for redundancy.
references:
- https://cloud.google.com/sql/docs/mysql/high-availability
- https://cloud.google.com/sql/docs/postgres/high-availability
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/security/best-practices
