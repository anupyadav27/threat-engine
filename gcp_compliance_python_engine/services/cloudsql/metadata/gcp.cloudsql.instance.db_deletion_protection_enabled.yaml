rule_id: gcp.cloudsql.instance.db_deletion_protection_enabled
service: cloudsql
resource: instance
requirement: Db Deletion Protection Enabled
scope: cloudsql.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Enable Deletion Protection for Cloud SQL Instances
rationale: Enabling deletion protection for Cloud SQL instances helps prevent accidental
  or malicious deletion of critical databases, which can lead to data loss, service
  downtime, and potential non-compliance with data retention policies. Protecting
  databases from deletion is crucial for maintaining business continuity and safeguarding
  sensitive data against unauthorized alterations.
description: This rule checks if deletion protection is enabled for Cloud SQL instances.
  Deletion protection ensures that an instance cannot be deleted without first disabling
  this setting, providing a safeguard against unintended data loss. To verify, access
  the Cloud SQL instance settings in the Google Cloud Console and ensure the 'Deletion
  Protection' option is enabled. If not, update the instance configuration to enable
  this feature through the console or via gcloud command-line tool.
references:
- https://cloud.google.com/sql/docs/mysql/instance-settings#deletion_protection
- https://cloud.google.com/security/compliance/cis#section-5.3
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/sql/docs/security
- https://cloud.google.com/architecture/securing-sql-instances
