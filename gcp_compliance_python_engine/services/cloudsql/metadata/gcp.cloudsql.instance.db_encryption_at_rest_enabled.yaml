rule_id: gcp.cloudsql.instance.db_encryption_at_rest_enabled
service: cloudsql
resource: instance
requirement: Db Encryption At Rest Enabled
scope: cloudsql.instance.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Enable Encryption at Rest for Cloud SQL Instances
rationale: Encryption at rest protects sensitive data stored in Cloud SQL instances
  from unauthorized access and potential data breaches. This is crucial for meeting
  compliance requirements such as PCI-DSS and HIPAA, and it helps prevent data theft
  in the event of physical hardware compromise or unauthorized database access.
description: This rule checks if a Cloud SQL instance has encryption at rest enabled,
  which ensures that the data stored on the disk is encrypted using Google-managed
  encryption keys by default. To verify this setting, access the Cloud SQL instance
  settings in the Google Cloud Console and ensure that encryption is enabled. To remediate,
  create a new Cloud SQL instance with the 'Enable Encryption' option selected, or
  use customer-managed encryption keys (CMEK) for additional control.
references:
- https://cloud.google.com/sql/docs/mysql/configure-instance-settings#enable-encryption
- https://cloud.google.com/security/compliance/cis/benchmark
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.hhs.gov/sites/default/files/hipaa-simplified.pdf
- https://cloud.google.com/security/encryption-at-rest
- https://cloud.google.com/iam/docs/using-cmek
