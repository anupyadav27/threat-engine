rule_id: gcp.cloudsql.instance.postgres_log_connections_flag
service: cloudsql
resource: instance
requirement: Postgres Log Connections Flag
scope: cloudsql.instance.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: low
title: Ensure Postgres Log Connections Flag is Enabled
rationale: Enabling the Postgres log_connections flag helps in auditing and monitoring
  PostgreSQL database access patterns, which is crucial for detecting unauthorized
  access attempts and ensuring compliance with security policies. This logging capability
  supports forensic analysis and can assist in identifying potential security incidents
  or misuse.
description: This rule checks for the activation of the log_connections flag on Cloud
  SQL PostgreSQL instances. When enabled, this flag logs each successful connection,
  aiding in the auditing of database access. To verify, navigate to the 'Flags' tab
  in the Cloud SQL instance settings and ensure 'log_connections' is set to 'on'.
  Remediation involves enabling this flag in the Cloud SQL instance configuration,
  either through the GCP console, gcloud CLI, or the API.
references:
- https://cloud.google.com/sql/docs/postgres/flags
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/sql/docs/postgres
- https://cloud.google.com/sql/docs/postgres/logging
- https://cloud.google.com/sql/docs/postgres/flags#log_connections
