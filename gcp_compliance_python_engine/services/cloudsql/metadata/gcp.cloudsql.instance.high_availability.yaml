rule_id: gcp.cloudsql.instance.high_availability
service: cloudsql
resource: instance
requirement: High Availability
scope: cloudsql.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Ensure Cloud SQL Instances Have High Availability Configured
rationale: Configuring high availability for Cloud SQL instances is crucial to minimize
  service downtime and ensure business continuity in case of zone failures. Without
  high availability, database instances are vulnerable to disruptions, potentially
  leading to data loss and financial impacts. High availability is often a requirement
  for compliance with standards such as PCI-DSS and ISO 27001, which demand resilient
  and fault-tolerant systems.
description: This rule checks that Cloud SQL instances are configured with high availability,
  which involves setting up a primary instance and one or more replicas in different
  zones. To verify, ensure that the 'availabilityType' is set to 'REGIONAL' in the
  Cloud SQL instance settings. If not configured, enable high availability by modifying
  the instance settings to include multi-zone replication. This ensures automatic
  failover and data redundancy across zones.
references:
- https://cloud.google.com/sql/docs/mysql/high-availability
- https://cloudsecurityalliance.org/download/gcp-security-best-practices/
- https://www.cisecurity.org/benchmark/google_cloud_computing_foundations
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/sql/docs/mysql/configure-ha
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
