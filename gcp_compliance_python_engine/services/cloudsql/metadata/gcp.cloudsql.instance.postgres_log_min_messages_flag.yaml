rule_id: gcp.cloudsql.instance.postgres_log_min_messages_flag
service: cloudsql
resource: instance
requirement: Postgres Log Min Messages Flag
scope: cloudsql.instance.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: low
title: Ensure Postgres Log Min Messages Flag is Configured
rationale: Configuring the Postgres log_min_messages flag is crucial as it determines
  the minimum level of messages that are logged. This can help in identifying potential
  security incidents by capturing relevant logs. Not setting this flag appropriately
  can lead to insufficient logging, missing critical events, and potentially violating
  regulatory compliance requirements such as those outlined by HIPAA or PCI-DSS.
description: This rule checks if the Postgres log_min_messages flag for Cloud SQL
  instances is set to a level that ensures adequate logging of important events, such
  as 'WARNING' or 'ERROR'. It is important to configure this setting to capture essential
  logs for security monitoring and incident response. To verify, navigate to the GCP
  Console, access the Cloud SQL instance settings, and ensure the log_min_messages
  flag is set appropriately. For remediation, update this setting under the 'Flags'
  section of your Cloud SQL instance.
references:
- https://cloud.google.com/sql/docs/postgres/flags
- https://cloud.google.com/sql/docs/postgres/diagnose-issues
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/sql/docs/compliance
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
