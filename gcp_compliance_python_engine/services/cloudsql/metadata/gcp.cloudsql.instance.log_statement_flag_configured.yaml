rule_id: gcp.cloudsql.instance.log_statement_flag_configured
service: cloudsql
resource: instance
requirement: Log Statement Flag Configured
scope: cloudsql.instance.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: low
title: Ensure Cloud SQL Log Statement Flag is Configured
rationale: Configuring the log statement flag in Cloud SQL is crucial for auditing
  and troubleshooting. It helps detect suspicious activities by capturing SQL statements
  executed on the database, which can aid in forensic investigations and compliance
  with standards like PCI-DSS and SOC2. Without logging, potential security incidents
  might go unnoticed, increasing the risk of data breaches.
description: This rule checks if the log_statement flag is configured for Cloud SQL
  instances. The flag should be set to 'all' or 'mod' to capture all SQL statements
  or modifications, respectively. To verify, access the Cloud SQL instance settings
  and ensure the log_statement parameter is configured appropriately. If not configured,
  update the instance settings to enable logging. This enhances visibility into database
  operations, helping to monitor access and changes.
references:
- https://cloud.google.com/sql/docs/postgres/flags
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/
- https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/sorhome.html
- https://www.nist.gov/cyberframework
- https://cloud.google.com/security/compliance/iso-27001
