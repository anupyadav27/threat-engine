rule_id: gcp.cloudsql.instance.cross_db_ownership_chaining_off
service: cloudsql
resource: instance
requirement: Cross Db Ownership Chaining Off
scope: cloudsql.instance.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Disable Cross Database Ownership Chaining in Cloud SQL
rationale: Disabling cross-database ownership chaining reduces the risk of unauthorized
  access between databases. This setting prevents users with permissions on one database
  from exploiting trust relationships to access objects in another database, thereby
  enhancing the overall security posture and supporting compliance with data separation
  policies.
description: This rule checks if cross-database ownership chaining is disabled on
  Cloud SQL instances. Cross-database ownership chaining can be a security risk as
  it allows users to access objects they do not own across databases. To verify, inspect
  Cloud SQL instance settings for the 'cross_db_ownership_chaining' parameter and
  ensure it is set to 'off'. Remediation involves updating the instance configuration
  to disable this feature.
references:
- https://cloud.google.com/sql/docs/postgres/configure-instance-settings
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://docs.microsoft.com/en-us/sql/relational-databases/security/database-engine-permissions-grants?view=sql-server-ver15
- https://cloud.google.com/sql/docs/mysql/security
