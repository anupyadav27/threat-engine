rule_id: gcp.cloudsql.instance.log_min_messages_compliance_configured
service: cloudsql
resource: instance
requirement: Log Min Messages Compliance Configured
scope: cloudsql.instance.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: low
title: Configure Cloud SQL Instances for Minimum Log Level Compliance
rationale: Properly configuring the minimum log level for Cloud SQL instances is crucial
  to ensure that relevant security events are captured while reducing noise from less
  critical log messages. This aids in timely detection of anomalies and compliance
  with standards such as PCI-DSS and ISO 27001, which require effective logging mechanisms
  to track access and changes.
description: This rule checks whether the 'log_min_messages' setting for Cloud SQL
  instances is set to a compliance-friendly level, such as 'ERROR' or 'WARNING'. This
  configuration is intended to log only significant events that might indicate potential
  security issues or system malfunctions. Verification can be performed by reviewing
  the Cloud SQL instance settings in the GCP Console under 'Logs' or using the gcloud
  command-line tool. Remediation involves updating the 'log_min_messages' setting
  in the Cloud SQL instance configuration to a more appropriate level if it is not
  already set.
references:
- https://cloud.google.com/sql/docs/mysql/flags#mysql_flags
- https://cloud.google.com/security/compliance/cis#gcp_cis_benchmark
- https://www.pcisecuritystandards.org/
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/logging/docs/audit/configure-data-access
- https://cloud.google.com/sql/docs/mysql/logging
