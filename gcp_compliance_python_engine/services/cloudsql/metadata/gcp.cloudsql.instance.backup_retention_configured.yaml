rule_id: gcp.cloudsql.instance.backup_retention_configured
service: cloudsql
resource: instance
requirement: Backup Retention Configured
scope: cloudsql.instance.backup_recovery
domain: resilience_and_disaster_recovery
subcategory: backup_configuration
severity: medium
title: Ensure Cloud SQL Backup Retention is Properly Configured
rationale: Configuring backup retention for Cloud SQL instances is crucial for ensuring
  data can be restored in the event of accidental deletion, corruption, or other data
  loss scenarios. It helps maintain business continuity and meets compliance requirements
  for data protection and disaster recovery, such as those outlined by PCI-DSS and
  SOC2.
description: This rule checks whether a backup retention policy is configured for
  Cloud SQL instances. Without this, data recovery may not be possible, leading to
  potential data loss. To verify, ensure that the 'backupConfiguration.enabled' setting
  is true and that a retention period is defined. Remediation involves setting an
  appropriate retention period in the Google Cloud Console under the SQL instance
  settings or using the gcloud CLI.
references:
- https://cloud.google.com/sql/docs/mysql/backup-recovery/backups
- https://cloud.google.com/sql/docs/postgres/backup-recovery/backups
- CIS Google Cloud Computing Foundations Benchmark v1.2.0, Section 6.1
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/soc2report.html
