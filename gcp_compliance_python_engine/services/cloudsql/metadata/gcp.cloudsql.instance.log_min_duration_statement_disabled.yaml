rule_id: gcp.cloudsql.instance.log_min_duration_statement_disabled
service: cloudsql
resource: instance
requirement: Log Min Duration Statement Disabled
scope: cloudsql.instance.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: low
title: Ensure Cloud SQL Log Min Duration Statement is Enabled
rationale: Without logging the minimum duration of SQL statements, it becomes difficult
  to identify and troubleshoot long-running queries which may indicate performance
  issues or potential security incidents, impacting business operations and data integrity.
  Enabling this feature aids in compliance with regulatory requirements for auditing
  and monitoring, such as PCI-DSS and SOC2, which mandate detailed logging.
description: This rule checks if the 'log_min_duration_statement' setting is disabled
  on Cloud SQL instances. When disabled, SQL statement execution times are not logged,
  obscuring performance insights and security audit trails. To verify, ensure the
  'log_min_duration_statement' is set to an appropriate threshold in the PostgreSQL
  or MySQL configuration of the Cloud SQL instance. Remediate by enabling and configuring
  this setting through the GCP Console or gcloud CLI to capture statements exceeding
  a specified duration.
references:
- https://cloud.google.com/sql/docs/postgres/flags
- https://cloud.google.com/sql/docs/mysql/flags
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/sql/docs/postgres/audit-logging
