rule_id: gcp.cloudsql.instance.no_public_access_gcp_compute_securitygroup_allow__configured
service: cloudsql
resource: instance
requirement: No Public Access Gcp Compute Securitygroup Allow Configured
scope: cloudsql.instance.public_access
domain: compute_and_workload_security
subcategory: instance_configuration
severity: critical
title: Prevent Public Access to Cloud SQL Instances
rationale: Allowing public access to Cloud SQL instances can expose sensitive data
  to unauthorized users, leading to potential data breaches. It increases the risk
  of attacks such as SQL injection and unauthorized data exfiltration. Compliance
  with regulations such as PCI-DSS, HIPAA, and SOC2 often mandates restricted access
  to secure databases, thereby ensuring data privacy and integrity.
description: This rule checks for Cloud SQL instances that have public IP addresses
  or are configured to allow public access through GCP compute security groups. It
  is essential to ensure that these instances are not accessible from the public internet
  and are instead restricted to internal IP addresses or specific trusted networks.
  To remediate, disable public IP addresses in the instance settings and configure
  VPC firewall rules to limit access to authorized IP ranges only.
references:
- https://cloud.google.com/sql/docs/mysql/private-ip
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://cloud.google.com/security/compliance
- https://cloud.google.com/sql/docs/mysql/configure-ip
- https://cloud.google.com/sql/docs/mysql/sql-proxy
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
