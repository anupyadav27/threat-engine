rule_id: gcp.cloudsql.instance.public_ip
service: cloudsql
resource: instance
requirement: Public Ip
scope: cloudsql.instance.public_access
domain: identity_and_access_management
subcategory: authentication
severity: critical
title: Ensure Cloud SQL Instances Do Not Use Public IPs
rationale: Public IP exposure of Cloud SQL instances can lead to unauthorized access
  and data breaches, increasing the attack surface. Limiting access to private IPs
  helps in compliance with regulations such as PCI-DSS and HIPAA that mandate secure
  data environments and reduces the risk of exposure to external threats.
description: This rule checks for Cloud SQL instances configured with a public IP
  address, which can be accessed from the internet. To enhance security, disable public
  IP and configure a private IP within a VPC. Verification can be done through the
  GCP Console by navigating to the SQL instances and checking the IP configuration.
  Remediation involves switching the instance to use only private IPs and ensuring
  access through secure, internal networks.
references:
- https://cloud.google.com/sql/docs/mysql/configure-ip
- https://cloud.google.com/sql/docs/mysql/private-ip
- https://cloud.google.com/security/compliance/cis-gcp-benchmark
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/architecture/using-private-google-access-and-cloud-nat
- https://cloud.google.com/sql/docs/mysql/sql-proxy
