rule_id: gcp.cloudsql.instance.postgres_log_min_duration_statement_flag
service: cloudsql
resource: instance
requirement: Postgres Log Min Duration Statement Flag
scope: cloudsql.instance.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: low
title: Postgres Log Min Duration Statement Configuration
rationale: Configuring the log_min_duration_statement flag in PostgreSQL instances
  helps identify slow queries that might indicate performance bottlenecks or potential
  security vulnerabilities, such as SQL injection attempts. This setting aids in proactive
  database monitoring and optimization, aligning with compliance requirements for
  audit logging and performance monitoring.
description: This rule checks whether the 'log_min_duration_statement' flag is set
  for PostgreSQL instances in Cloud SQL. The flag must be adjusted to log queries
  exceeding a specified execution time, aiding in the detection of inefficient queries
  and potential anomalies. To verify and remediate, access the Cloud SQL instance
  settings, navigate to the 'Flags' section, and set 'log_min_duration_statement'
  to a reasonable value, such as 1000 milliseconds, based on your application needs.
references:
- https://cloud.google.com/sql/docs/postgres/flags
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://cloud.google.com/architecture/best-practices-for-working-with-postgresql-on-google-cloud
- https://www.postgresql.org/docs/current/runtime-config-logging.html
