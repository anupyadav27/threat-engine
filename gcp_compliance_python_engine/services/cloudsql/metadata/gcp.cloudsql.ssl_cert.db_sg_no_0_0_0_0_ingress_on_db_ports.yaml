rule_id: gcp.cloudsql.ssl_cert.db_sg_no_0_0_0_0_ingress_on_db_ports
service: cloudsql
resource: ssl_cert
requirement: Db Sg No 0 0 0 0 Ingress On Db Ports
scope: cloudsql.ssl_cert.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Restrict Cloud SQL Ingress from 0.0.0.0/0 on DB Ports
rationale: Allowing ingress to Cloud SQL from 0.0.0.0/0 poses a significant security
  risk as it exposes databases to potential attacks from any IP address on the internet.
  This can lead to unauthorized access, data breaches, or exploitation of database
  vulnerabilities. Compliance frameworks such as PCI-DSS and HIPAA require restricted
  access to sensitive data, ensuring only trusted sources can connect.
description: This rule checks for Cloud SQL instances allowing ingress traffic from
  0.0.0.0/0 on database ports. To secure your database, configure the instance's authorized
  networks to allow connections only from trusted IP ranges or VPNs. Review and modify
  the VPC firewall rules associated with your Cloud SQL instances to ensure they do
  not permit unrestricted access. Regularly audit and update these settings to comply
  with best practices and regulatory requirements.
references:
- https://cloud.google.com/sql/docs/mysql/configure-ip
- https://cloud.google.com/security/compliance/pci-dss
- https://cloud.google.com/security/compliance/hipaa
- https://cloud.google.com/security/best-practices
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
