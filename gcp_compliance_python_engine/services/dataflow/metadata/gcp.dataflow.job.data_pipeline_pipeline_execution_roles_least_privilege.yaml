rule_id: gcp.dataflow.job.data_pipeline_pipeline_execution_roles_least_privilege
service: dataflow
resource: job
requirement: Data Pipeline Pipeline Execution Roles Least Privilege
scope: dataflow.job.least_privilege
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Ensure Dataflow Pipeline Roles Use Least Privilege
rationale: Ensuring least privilege for Dataflow pipeline roles reduces the risk of
  unauthorized access and potential data leaks. Misconfigured roles can lead to excessive
  permissions that may be exploited by malicious actors, impacting data integrity
  and confidentiality. Compliance with least privilege principles is crucial for meeting
  regulatory standards such as GDPR and HIPAA.
description: This rule checks that Dataflow pipeline roles are configured with the
  least privilege necessary for their function. It verifies that roles assigned to
  Dataflow jobs do not include permissions beyond what is needed for pipeline execution.
  To remediate, review and update IAM policies to ensure roles have only the necessary
  permissions, removing any excessive privileges.
references:
- https://cloud.google.com/dataflow/docs/concepts/security-and-permissions
- https://cloud.google.com/iam/docs/understanding-roles
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://cloud.google.com/security/compliance/gdpr
- https://cloud.google.com/security/compliance/hipaa
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
