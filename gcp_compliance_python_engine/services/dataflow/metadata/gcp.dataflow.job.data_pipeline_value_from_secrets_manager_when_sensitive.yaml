rule_id: gcp.dataflow.job.data_pipeline_value_from_secrets_manager_when_sensitive
service: dataflow
resource: job
requirement: Data Pipeline Value From Secrets Manager When Sensitive
scope: dataflow.job.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure Sensitive Data in Dataflow Uses Secrets Manager
rationale: Using Secrets Manager for sensitive data in Dataflow jobs mitigates the
  risk of data leaks and unauthorized access. This practice aligns with data protection
  regulations such as GDPR and CCPA, reducing legal and financial risks. It also enhances
  security by ensuring that sensitive information is encrypted and managed securely,
  reducing exposure to threats like insider attacks and data breaches.
description: This rule checks that any sensitive parameters used in Dataflow jobs
  are retrieved securely from Google Cloud Secrets Manager. Verify that configurations
  in Dataflow pipelines reference secrets stored in Secrets Manager rather than hardcoding
  sensitive values. To remediate, update Dataflow job configurations to use the Secret
  Manager API for sensitive data retrieval, ensuring data is encrypted at rest and
  access is controlled via IAM roles.
references:
- https://cloud.google.com/dataflow/docs/guides/security
- https://cloud.google.com/secret-manager/docs
- https://cloud.google.com/security/compliance
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
