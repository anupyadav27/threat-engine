rule_id: gcp.dataflow.job.data_pipeline_metadata_values_not_plaintext_secret
service: dataflow
resource: job
requirement: Data Pipeline Metadata Values Not Plaintext Secret
scope: dataflow.job.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure Dataflow Metadata Values Are Not Plaintext Secrets
rationale: Storing plaintext secrets in Dataflow metadata increases the risk of unauthorized
  access to sensitive information, potentially leading to data breaches. This practice
  can also violate compliance requirements such as GDPR, HIPAA, and PCI-DSS, where
  protecting sensitive data is mandated. Ensuring metadata does not contain plaintext
  secrets helps maintain data confidentiality and integrity, reducing the organization's
  risk exposure.
description: This rule checks that no plaintext secrets, such as passwords or API
  keys, are stored within the metadata of Dataflow jobs. To verify, inspect Dataflow
  job configurations for any sensitive information stored in plaintext. Remediation
  involves using secret management services like Google Cloud Secret Manager to store
  sensitive data securely and referring to them in the configurations via environment
  variables or other secure methods.
references:
- https://cloud.google.com/dataflow/docs/guides/security
- https://cloud.google.com/secret-manager/docs
- https://cloud.google.com/security/compliance
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://www.iso.org/standard/54534.html
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
