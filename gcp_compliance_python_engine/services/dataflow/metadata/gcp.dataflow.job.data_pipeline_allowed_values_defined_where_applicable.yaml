rule_id: gcp.dataflow.job.data_pipeline_allowed_values_defined_where_applicable
service: dataflow
resource: job
requirement: Data Pipeline Allowed Values Defined Where Applicable
scope: dataflow.job.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Dataflow Pipeline Uses Allowed Parameter Values
rationale: Defining allowed parameter values for Dataflow pipelines is crucial for
  maintaining data integrity and preventing unauthorized data processing activities.
  Without clear restrictions, there's an increased risk of data breaches or non-compliance
  with regulatory standards such as GDPR or HIPAA, especially when dealing with sensitive
  data. This practice helps organizations maintain control over data processing operations
  and safeguards against inadvertent data exposure.
description: This rule checks if Dataflow jobs have clearly defined allowed values
  for parameters, ensuring that only approved configurations are used. To verify compliance,
  review the Dataflow job configurations and confirm that parameter values are restricted
  to pre-approved ranges or sets. If discrepancies are found, update the job configurations
  to enforce allowed values, using GCP's parameter validation options. This ensures
  consistent and secure data processing operations.
references:
- https://cloud.google.com/dataflow/docs/guides/security
- https://cloud.google.com/security/compliance/cis#gcp
- https://cloud.google.com/security/compliance/gdpr
- https://cloud.google.com/security/compliance/hipaa
- https://cloud.google.com/architecture/best-practices-for-enterprise-organizations#data-management
- https://cloud.google.com/dataflow/docs/guides/setting-pipeline-options
