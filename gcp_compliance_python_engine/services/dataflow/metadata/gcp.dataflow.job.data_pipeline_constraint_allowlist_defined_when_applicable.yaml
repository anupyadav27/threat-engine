rule_id: gcp.dataflow.job.data_pipeline_constraint_allowlist_defined_when_applicable
service: dataflow
resource: job
requirement: Data Pipeline Constraint Allowlist Defined When Applicable
scope: dataflow.job.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Dataflow Job Pipeline Constraints Are Allowlisted
rationale: Defining an allowlist for data pipeline constraints in GCP Dataflow jobs
  helps mitigate risks of unauthorized data processing and potential data breaches.
  It ensures that only approved pipelines can be executed, aligning with security
  best practices and compliance requirements such as GDPR and HIPAA, which mandate
  strict data processing controls.
description: This rule checks whether a Dataflow job has an allowlist defined for
  pipeline constraints. Without this, there is a risk of executing unauthorized or
  potentially harmful data processing tasks. Verify the allowlist configuration in
  the job settings and update it to include only trusted data pipelines. This can
  be done through the GCP Console or by using gcloud commands to update the job's
  parameter settings.
references:
- https://cloud.google.com/dataflow/docs/guides/security
- https://cloud.google.com/security/compliance
- CIS Google Cloud Platform Foundation Benchmark v1.3.0
- https://www.iso.org/standard/73906.html
- https://www.nist.gov/cyberframework
- https://cloud.google.com/dataflow/docs/guides/using-gcloud
