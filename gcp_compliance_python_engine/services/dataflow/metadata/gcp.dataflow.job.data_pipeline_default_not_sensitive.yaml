rule_id: gcp.dataflow.job.data_pipeline_default_not_sensitive
service: dataflow
resource: job
requirement: Data Pipeline Default Not Sensitive
scope: dataflow.job.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Dataflow Job Pipelines Are Not Using Default Encryption
rationale: Using default encryption for Dataflow jobs can expose sensitive data to
  unauthorized access and potential breaches if the default keys are compromised.
  Encrypting data with customer-managed keys enhances control over data privacy and
  compliance with regulations such as GDPR and CCPA, which require stringent data
  protection measures.
description: This rule checks if Dataflow jobs use customer-managed encryption keys
  instead of the default Google-managed keys for encrypting data at rest. To verify,
  review the Dataflow job configurations for the `kmsKeyName` property. Remediation
  involves configuring Dataflow jobs to use a specific customer-managed key by specifying
  its `kmsKeyName`, ensuring enhanced data security and compliance with regulatory
  requirements.
references:
- https://cloud.google.com/dataflow/docs/guides/security
- https://cloud.google.com/security/encryption-at-rest/
- https://cloud.google.com/security/compliance/gdpr/
- CIS GCP Foundation Benchmark v1.3.0 - Section 7.10
- NIST SP 800-57 Part 1
- ISO/IEC 27001:2013
