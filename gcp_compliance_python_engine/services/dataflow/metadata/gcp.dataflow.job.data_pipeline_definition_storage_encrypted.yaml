rule_id: gcp.dataflow.job.data_pipeline_definition_storage_encrypted
service: dataflow
resource: job
requirement: Data Pipeline Definition Storage Encrypted
scope: dataflow.job.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Dataflow Job Pipeline Definitions Are Encrypted at Rest
rationale: Encrypting Dataflow job pipeline definitions at rest safeguards sensitive
  configuration data from unauthorized access and potential data breaches. This is
  critical to maintain data confidentiality and integrity, especially when handling
  sensitive information that may be subject to regulatory compliance such as PCI-DSS
  or HIPAA. Inadequate encryption can lead to exposure of operational details that
  could be exploited by malicious actors.
description: This check verifies that all Dataflow job pipeline definitions are stored
  with encryption at rest enabled. By default, Google Cloud encrypts data at rest,
  but it is essential to confirm that customer-managed encryption keys (CMEK) are
  used for enhanced security. To verify, inspect the Dataflow job settings to ensure
  that the 'kmsKeyName' parameter is set appropriately. Remediation involves configuring
  Dataflow jobs to use CMEK by specifying a valid Cloud KMS key, ensuring the key
  is managed securely and access is restricted to authorized personnel.
references:
- https://cloud.google.com/dataflow/docs/guides/encryption
- https://cloud.google.com/security/compliance/cis-gcp-foundations-benchmark
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57p1r4.pdf
- https://cloud.google.com/kms/docs/encrypt-decrypt
- https://cloud.google.com/security/encryption-at-rest/
- https://cloud.google.com/security/compliance
