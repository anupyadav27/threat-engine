rule_id: gcp.dataflow.job.data_pipeline_pipeline_private_networking_enforced
service: dataflow
resource: job
requirement: Data Pipeline Pipeline Private Networking Enforced
scope: dataflow.job.network_security
domain: network_security_and_connectivity
subcategory: network_access_control
severity: medium
title: Enforce Private Networking for Dataflow Pipelines
rationale: Enforcing private networking in Dataflow pipelines reduces the risk of
  data exposure by limiting network access to internal IPs only. This mitigates threats
  such as unauthorized access and data breaches, crucial for maintaining data confidentiality
  and integrity. Compliance with network security policies and standards such as ISO
  27001 and SOC 2 reinforces trust and ensures regulatory adherence.
description: This rule ensures that Dataflow jobs are configured to use private IP
  addresses. Verify that the 'network' setting in the Dataflow job configuration specifies
  a VPC with private Google access enabled. To remediate, update the Dataflow job
  settings to utilize a private VPC network, ensuring no public IPs are assigned.
  This enhances security by confining network traffic within the Google Cloud internal
  network.
references:
- https://cloud.google.com/vpc/docs/private-access-options
- https://cloud.google.com/dataflow/docs/guides/specifying-networks
- CIS Google Cloud Computing Foundations Benchmark v1.2.0, Section 7.8
- ISO/IEC 27001:2013
- https://cloud.google.com/security/best-practices
