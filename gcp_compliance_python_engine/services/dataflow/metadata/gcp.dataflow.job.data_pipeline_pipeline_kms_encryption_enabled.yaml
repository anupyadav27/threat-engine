rule_id: gcp.dataflow.job.data_pipeline_pipeline_kms_encryption_enabled
service: dataflow
resource: job
requirement: Data Pipeline Pipeline KMS Encryption Enabled
scope: dataflow.job.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure Dataflow Job Uses KMS for Pipeline Encryption
rationale: Enabling KMS encryption for Dataflow pipelines helps protect sensitive
  data from unauthorized access and meets regulatory requirements such as PCI-DSS
  and HIPAA. Without encryption, data at rest is vulnerable to breaches, potentially
  leading to data loss, reputational damage, and financial penalties.
description: This rule checks whether Google Cloud Dataflow jobs have Key Management
  Service (KMS) encryption enabled for pipelines. To verify, ensure that a KMS key
  is specified in the pipeline's configuration settings. Remediation involves setting
  up a KMS key in Google Cloud and configuring the Dataflow job to use this key for
  encrypting pipeline data during job initialization.
references:
- https://cloud.google.com/dataflow/docs/guides/security
- https://cloud.google.com/security/compliance
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/kms/docs/encrypt-decrypt
