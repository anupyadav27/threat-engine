rule_id: gcp.dataflow.job.data_pipeline_type_set
service: dataflow
resource: job
requirement: Data Pipeline Type Set
scope: dataflow.job.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Dataflow Pipeline Type is Correctly Configured
rationale: Misconfiguration of Dataflow pipeline types can lead to ineffective data
  processing and potential data exposure. By ensuring the correct pipeline type, organizations
  reduce the risk of processing sensitive data in an unsecured manner, which is crucial
  for maintaining data privacy and meeting compliance requirements such as GDPR and
  CCPA.
description: This rule checks that Dataflow jobs have the appropriate pipeline type
  set, ensuring data is processed securely and efficiently. Verify that the pipeline
  type is set to 'streaming' or 'batch' based on the intended use case and data sensitivity.
  Remediation involves reviewing the Dataflow job configurations and updating the
  pipeline type to match the data processing requirements, ensuring encryption at
  rest is enabled for all data processed by the pipeline.
references:
- https://cloud.google.com/dataflow/docs/concepts/security-and-permissions#encryption
- https://cloud.google.com/security/compliance/cis#gcp
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/dataflow/docs/guides/security
- https://www.nist.gov/cyberframework
- https://cloud.google.com/dataflow/docs/resources/faq
