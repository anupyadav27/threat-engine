rule_id: gcp.dataflow.job.data_pipeline_pipeline_logs_and_metrics_enabled
service: dataflow
resource: job
requirement: Data Pipeline Pipeline Logs And Metrics Enabled
scope: dataflow.job.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: low
title: Enable Dataflow Pipeline Logs and Metrics Collection
rationale: Enabling logs and metrics for Dataflow jobs is crucial for monitoring and
  troubleshooting data pipelines. Without these logs, identifying performance bottlenecks,
  errors, and unusual activity becomes challenging, which can lead to data integrity
  issues and potential breaches. Additionally, many compliance frameworks require
  logging and monitoring to ensure data processing activities are auditable.
description: This check ensures that logging and monitoring are enabled for Dataflow
  jobs to capture detailed pipeline execution data. Verify that Stackdriver Logging
  and Monitoring are configured to collect logs and metrics for Dataflow pipelines.
  Remediation involves enabling these settings in the Dataflow job configuration to
  facilitate real-time insights and historical analysis of pipeline behavior.
references:
- https://cloud.google.com/dataflow/docs/guides/logging-and-monitoring
- https://cloud.google.com/monitoring
- https://cloud.google.com/logging/docs/audit
- CIS Google Cloud Platform Foundation Benchmark
- NIST SP 800-53
- ISO/IEC 27001
