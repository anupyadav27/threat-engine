rule_id: gcp.dataflow.job.data_pipeline_metadata_disallowed_attribute_keys_blocked
service: dataflow
resource: job
requirement: Data Pipeline Metadata Disallowed Attribute Keys Blocked
scope: dataflow.job.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Block Disallowed Metadata Keys in Dataflow Jobs
rationale: Blocking disallowed metadata keys in Dataflow jobs is crucial to prevent
  unauthorized access to sensitive information. Metadata can inadvertently expose
  information that could be exploited by attackers, leading to data breaches or non-compliance
  with data protection regulations. Ensuring that only approved metadata keys are
  used mitigates the risk of data leakage and supports organizational compliance with
  frameworks like GDPR and HIPAA.
description: This rule checks that Dataflow jobs do not use metadata keys that are
  disallowed by policy. Administrators must review and configure the Dataflow job
  settings to ensure only authorized metadata keys are utilized. Verification involves
  auditing the job configurations and employing IAM policies to restrict the use of
  sensitive metadata keys. Remediation requires updating job configurations and applying
  IAM roles that enforce these restrictions.
references:
- https://cloud.google.com/dataflow/docs/guides/security
- https://cloud.google.com/security/compliance
- https://cloud.google.com/iam/docs/overview
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.nist.gov/cyberframework
- https://www.iso.org/iso-27001-information-security.html
