rule_id: gcp.dataflow.job.data_pipeline_constraint_pattern_defined_when_applicable
service: dataflow
resource: job
requirement: Data Pipeline Constraint Pattern Defined When Applicable
scope: dataflow.job.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Dataflow Job Constraint Patterns for Data Pipelines
rationale: Defining constraint patterns for Dataflow jobs is crucial for maintaining
  data integrity and security. Without these constraints, data pipelines may inadvertently
  process or expose sensitive data, increasing the risk of data breaches and non-compliance
  with regulations such as GDPR and HIPAA. By enforcing constraint patterns, organizations
  can ensure that their data processing activities are within the defined security
  boundaries, reducing the risk of unauthorized data access and potential legal penalties.
description: This check verifies that Dataflow jobs have defined constraint patterns
  when applicable, ensuring that data pipelines adhere to organizational security
  policies. To define these constraints, configure job parameters to include security
  specifications, such as encryption at rest using Cloud KMS. Remediation involves
  modifying the Dataflow job configuration to include these constraints and ensuring
  they are enforced during job execution. Verify compliance by reviewing job settings
  in the GCP Console or using gcloud commands to inspect job configurations.
references:
- https://cloud.google.com/dataflow/docs/guides/security
- https://cloud.google.com/security/compliance/cis-gcp-benchmark
- https://www.iso.org/iso-27001-information-security.html
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://cloud.google.com/security/encryption-at-rest/default-encryption
- https://cloud.google.com/kms/docs/encrypt-decrypt
