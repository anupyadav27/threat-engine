rule_id: gcp.dataflow.job.data_pipeline_pipeline_artifacts_private_and_encrypted
service: dataflow
resource: job
requirement: Data Pipeline Pipeline Artifacts Private And Encrypted
scope: dataflow.job.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Dataflow Pipeline Artifacts Are Private and Encrypted
rationale: Encrypting Dataflow pipeline artifacts at rest ensures that sensitive data
  remains protected from unauthorized access and potential breaches. This is crucial
  for maintaining data confidentiality, meeting regulatory compliance such as GDPR
  and HIPAA, and safeguarding intellectual property and customer data from malicious
  actors.
description: This rule verifies that Dataflow pipeline artifacts are stored in a private
  and encrypted manner. Ensure that data storage buckets used for Dataflow jobs are
  configured with 'Uniform bucket-level access' and use customer-managed encryption
  keys (CMEK) for encryption at rest. To verify, check the bucket settings in the
  Google Cloud Console and configure the necessary IAM permissions and CMEK settings
  to restrict access and enable encryption.
references:
- https://cloud.google.com/dataflow/docs/concepts/security-and-permissions
- https://cloud.google.com/storage/docs/encryption/customer-managed-keys
- CIS GCP Benchmark v1.1.0 - 4.1 Ensure that Cloud Storage bucket is not anonymously
  or publicly accessible
- NIST SP 800-53 Rev. 5 SC-13 Cryptographic Protection
- 'PCI-DSS v3.2.1 Requirement 3: Protect Stored Cardholder Data'
- https://cloud.google.com/security/encryption-at-rest/default-encryption
