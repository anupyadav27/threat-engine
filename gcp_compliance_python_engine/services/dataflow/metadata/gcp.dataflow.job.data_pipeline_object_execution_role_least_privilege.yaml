rule_id: gcp.dataflow.job.data_pipeline_object_execution_role_least_privilege
service: dataflow
resource: job
requirement: Data Pipeline Object Execution Role Least Privilege
scope: dataflow.job.least_privilege
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Ensure Dataflow Job Roles Follow Least Privilege Principle
rationale: Applying the principle of least privilege to Dataflow job roles reduces
  the risk of unauthorized access and potential data breaches. This practice minimizes
  the impact of compromised credentials and aligns with compliance mandates such as
  PCI-DSS and ISO 27001, which require strict access controls to protect sensitive
  data and maintain trust with stakeholders.
description: This rule checks that the roles assigned to Dataflow jobs only have the
  permissions necessary to perform their intended tasks. Verify that service accounts
  and users with access to Dataflow jobs are granted the minimal set of permissions
  required for their function. Remediation involves auditing current role assignments
  and tightening permissions using custom roles or predefined roles with the least
  privilege necessary to execute data pipeline tasks.
references:
- https://cloud.google.com/dataflow/docs/concepts/security-and-permissions
- https://cloud.google.com/iam/docs/understanding-roles#dataflow-roles
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/iam/docs/using-iam-securely
- https://www.iso.org/iso-27001-information-security.html
