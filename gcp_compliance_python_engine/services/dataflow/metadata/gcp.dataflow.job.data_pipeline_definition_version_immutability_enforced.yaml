rule_id: gcp.dataflow.job.data_pipeline_definition_version_immutability_enforced
service: dataflow
resource: job
requirement: Data Pipeline Definition Version Immutability Enforced
scope: dataflow.job.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Dataflow Pipeline Definition Version Immutability
rationale: Enforcing immutability of data pipeline definitions in Dataflow reduces
  the risk of unauthorized changes, ensuring consistent and repeatable data processing.
  This is crucial for maintaining data integrity and meeting compliance requirements
  such as SOC2 and PCI-DSS, which mandate strict controls over data processing environments.
description: This rule checks if the Dataflow pipeline definitions are immutable,
  preventing modifications to deployed versions. Verify that the Dataflow jobs use
  settings that lock the pipeline definition upon deployment. To enforce this, configure
  your CI/CD pipeline to deploy new versions instead of updating existing ones. This
  ensures auditability and traceability of data processing logic changes.
references:
- https://cloud.google.com/dataflow/docs/guides/deploying-a-pipeline
- https://cloud.google.com/dataflow/docs/concepts/security-and-compliance
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/security/compliance/soc-2
