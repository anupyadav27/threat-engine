rule_id: gcp.dataflow.job.data_pipeline_definition_signed_and_verified
service: dataflow
resource: job
requirement: Data Pipeline Definition Signed And Verified
scope: dataflow.job.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Dataflow Pipeline Definitions are Signed and Verified
rationale: Signing and verifying Dataflow pipeline definitions ensure that the jobs
  are not tampered with and originate from a trusted source. This practice mitigates
  risks such as unauthorized data manipulation, phishing attacks, and ensures compliance
  with data protection regulations by maintaining data integrity and authenticity.
description: This rule checks that all Dataflow job definitions are digitally signed
  and verified before execution. Organizations should implement a process where pipeline
  definitions are signed using a GCP-managed key and verified to prevent the execution
  of malicious code. Remediation involves enabling signing and verification in the
  Dataflow job submission process, and using Cloud KMS to manage and store cryptographic
  keys securely.
references:
- https://cloud.google.com/dataflow/docs/guides/security
- https://cloud.google.com/security/compliance/cis-gcp-foundations-benchmark
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-57p1r4.pdf
- https://cloud.google.com/kms/docs/best-practices
- https://www.iso.org/iso-27001-information-security.html
