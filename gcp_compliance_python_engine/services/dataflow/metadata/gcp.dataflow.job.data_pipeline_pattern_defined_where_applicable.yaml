rule_id: gcp.dataflow.job.data_pipeline_pattern_defined_where_applicable
service: dataflow
resource: job
requirement: Data Pipeline Pattern Defined Where Applicable
scope: dataflow.job.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure Dataflow Jobs Define Data Pipeline Patterns
rationale: Defining data pipeline patterns in Dataflow jobs is critical for maintaining
  data integrity and security. Without defined patterns, there is an increased risk
  of data mismanagement, unauthorized access, and non-compliance with data protection
  regulations such as GDPR and HIPAA. This practice also helps in standardizing processes,
  which reduces errors and enhances auditability.
description: This rule checks whether Dataflow jobs in GCP have defined data pipeline
  patterns applicable to their operations. To verify, review the job configurations
  to ensure patterns are explicitly stated and align with organizational security
  policies. If patterns are undefined, update the Dataflow job configurations to include
  appropriate patterns that enforce encryption at rest and control data access. This
  can be done by using predefined templates or custom JSON files that specify the
  necessary parameters.
references:
- https://cloud.google.com/dataflow/docs/guides/templates/provided-templates
- https://cloud.google.com/security/compliance/cis-gcp-benchmark
- https://www.nist.gov/cyberframework
- https://cloud.google.com/security/privacy/
- https://cloud.google.com/dataflow/docs/guides/security
- https://www.iso.org/iso-27001-information-security.html
