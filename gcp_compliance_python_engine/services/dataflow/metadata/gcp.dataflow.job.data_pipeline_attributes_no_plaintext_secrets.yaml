rule_id: gcp.dataflow.job.data_pipeline_attributes_no_plaintext_secrets
service: dataflow
resource: job
requirement: Data Pipeline Attributes No Plaintext Secrets
scope: dataflow.job.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Prevent Plaintext Secrets in Dataflow Job Attributes
rationale: Storing secrets in plaintext within Dataflow job attributes poses significant
  security risks, including unauthorized access and data breaches. This is critical
  for protecting sensitive data and maintaining compliance with regulations like GDPR
  and HIPAA, which mandate strict data protection measures. Ensuring secrets are encrypted
  mitigates the risk of exposure and potential financial and reputational damage.
description: This rule checks that no secrets or sensitive information are stored
  in plaintext within the attributes of a Google Cloud Dataflow job. Verify that secrets
  are not included directly in job configurations or command-line arguments. Instead,
  use Google Cloud Secret Manager to securely reference secrets. Remediation involves
  updating job configurations to remove any plaintext secrets and replacing them with
  secure references.
references:
- https://cloud.google.com/dataflow/docs/guides/security
- https://cloud.google.com/secret-manager/docs
- CIS GCP Benchmark v1.3.0 - 5.1 Ensure that Cloud Dataflow jobs do not contain sensitive
  information
- 'NIST SP 800-53: AC-3 Access Enforcement'
- 'PCI-DSS Requirement 3: Protect stored cardholder data'
- ISO/IEC 27001:2013 A.8.2 Information Classification
