rule_id: gcp.dataflow.job.data_pipeline_binding_secret_refs_resolved_at_runtime
service: dataflow
resource: job
requirement: Data Pipeline Binding Secret Refs Resolved At Runtime
scope: dataflow.job.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure Dataflow Secret Refs Resolved at Runtime for Security
rationale: Resolving secret references at runtime minimizes the risk of exposing sensitive
  information, thereby protecting data integrity and confidentiality. This practice
  is crucial in mitigating unauthorized access and ensuring compliance with data protection
  regulations such as GDPR and HIPAA, which mandate rigorous control over sensitive
  data handling.
description: This rule checks that Dataflow jobs are configured to resolve secret
  references at runtime, ensuring that secrets are not hardcoded or stored insecurely.
  Verify that your Dataflow pipeline uses secret managers or other secure methods
  to retrieve secrets dynamically during execution. To remediate, configure your Dataflow
  job to use the GCP Secret Manager API or equivalent to fetch secrets securely at
  runtime, ensuring these configurations are not exposed in code.
references:
- https://cloud.google.com/dataflow/docs/guides/security
- https://cloud.google.com/secret-manager/docs
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://www.iso.org/iso-27001-information-security.html
- https://www.nist.gov/cyberframework
