rule_id: gcp.dataflow.job.data_pipeline_object_environment_no_plaintext_secrets
service: dataflow
resource: job
requirement: Data Pipeline Object Environment No Plaintext Secrets
scope: dataflow.job.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Avoid Plaintext Secrets in Dataflow Pipeline Environments
rationale: Storing plaintext secrets in Dataflow pipeline environments poses significant
  security risks, including unauthorized access to sensitive data and potential data
  breaches. Compliance frameworks such as PCI-DSS and HIPAA require strict management
  of sensitive information, and failing to encrypt secrets can lead to non-compliance
  and financial penalties.
description: This rule checks for the presence of plaintext secrets within Dataflow
  pipeline environment variables. It is essential to encrypt secrets using Google
  Cloud's Secret Manager or similar services, ensuring they are not exposed in plaintext.
  Verification involves inspecting Dataflow job configurations for unsecured environment
  variables and updating them to reference encrypted secrets. Remediation includes
  using Secret Manager API calls in your pipeline code to securely retrieve sensitive
  information.
references:
- https://cloud.google.com/dataflow/docs/guides/security
- https://cloud.google.com/security/compliance/cis-gcp-benchmark
- https://cloud.google.com/security/compliance
- https://cloud.google.com/secret-manager/docs/overview
- https://cloud.google.com/dataflow/docs/guides/using-public-datasets
