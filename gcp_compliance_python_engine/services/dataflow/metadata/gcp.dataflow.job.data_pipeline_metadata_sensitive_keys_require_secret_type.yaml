rule_id: gcp.dataflow.job.data_pipeline_metadata_sensitive_keys_require_secret_type
service: dataflow
resource: job
requirement: Data Pipeline Metadata Sensitive Keys Require Secret Type
scope: dataflow.job.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure Secret Type for Sensitive Keys in Dataflow Metadata
rationale: It is crucial to protect sensitive information in data pipeline metadata
  to prevent unauthorized access and potential data breaches. Ensuring that sensitive
  keys are stored as secrets reduces the risk of exposure, aligns with best practices
  for data protection, and helps maintain compliance with regulatory requirements
  such as GDPR and HIPAA.
description: This rule checks that sensitive keys within Google Cloud Dataflow job
  metadata are configured as secret types rather than plain text. Verify that any
  configuration parameter or metadata key that contains sensitive information, such
  as API keys or passwords, is stored using the Secret Manager service. Remediation
  involves identifying these keys and migrating them to Secret Manager, updating your
  Dataflow jobs to reference the secrets securely.
references:
- https://cloud.google.com/dataflow/docs/guides/security
- https://cloud.google.com/secret-manager/docs/best-practices
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://www.iso.org/iso-27001-information-security.html
