rule_id: gcp.workflows.workflow.incident_kms_encryption_enabled
service: workflows
resource: workflow
requirement: Incident KMS Encryption Enabled
scope: workflows.workflow.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure KMS Encryption is Enabled for GCP Workflows
rationale: Enabling KMS encryption for GCP workflows is critical to protecting sensitive
  information processed by workflows. Without encryption, data is vulnerable to unauthorized
  access, potentially leading to data breaches and non-compliance with regulations
  such as GDPR and HIPAA. KMS encryption provides an additional layer of security
  by ensuring that data is encrypted at rest using Google-managed or customer-managed
  keys, thereby reducing the risk of data exposure.
description: This rule checks whether workflows in GCP have Key Management Service
  (KMS) encryption enabled. Specifically, it verifies that the 'kmsKeyName' attribute
  is set for each workflow, indicating that data processed by the workflow is encrypted
  using a specified KMS key. To remediate non-compliant workflows, configure the workflow
  to use a KMS key by setting the 'kmsKeyName' attribute in the workflow's configuration.
  This ensures that all data processed by the workflow is encrypted at rest, aligning
  with best practices for data protection.
references:
- https://cloud.google.com/workflows/docs/encryption
- https://cloud.google.com/kms/docs
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.nist.gov/cyberframework
- https://cloud.google.com/security/compliance
- https://cloud.google.com/security/encryption-at-rest/default-encryption
