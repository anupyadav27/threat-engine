rule_id: gcp.endpoints.endpoint.api_monitoring_api_access_logging_enabled
service: endpoints
resource: endpoint
requirement: API Monitoring API Access Logging Enabled
scope: endpoints.endpoint.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: medium
title: Enable API Monitoring API Access Logging on Endpoints
rationale: Enabling API access logging provides visibility into API usage, helping
  to detect unauthorized access and potential data breaches. It supports compliance
  with regulations requiring detailed audit trails, such as GDPR and PCI-DSS, and
  assists in forensic investigations by maintaining a history of API interactions.
description: This rule checks if API Monitoring API Access Logging is enabled for
  Google Cloud Endpoints. To verify, ensure that logging is configured in the Endpoints
  configuration file by including the 'logging' section with 'access_log' parameters
  specified. Remediation involves updating the service configuration YAML file to
  enable access logging, followed by redeploying the service.
references:
- https://cloud.google.com/endpoints/docs/openapi/logging
- https://cloud.google.com/security/compliance/cis/gcp-1.1
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/security/compliance
- https://cloud.google.com/logging/docs/audit
- https://cloud.google.com/architecture/security-foundations
