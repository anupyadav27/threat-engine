rule_id: gcp.endpoints.endpoint.api_monitoring_api_access_log_fields_identity_present
service: endpoints
resource: endpoint
requirement: API Monitoring API Access Log Fields Identity Present
scope: endpoints.endpoint.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: medium
title: Ensure API Access Log Fields Include Identity Information
rationale: Including identity information in API access logs is crucial for auditing
  and tracing activities to specific users or service accounts. This enhances the
  ability to detect unauthorized access or anomalous behavior, thereby reducing the
  risk of data breaches and ensuring compliance with regulatory requirements like
  GDPR and HIPAA, which mandate detailed logging of access to sensitive data.
description: This rule checks that API monitoring logs for GCP endpoints include the
  identity fields, enabling detailed tracking of who accessed the APIs. To verify,
  ensure that the logging configuration for your endpoints includes identity fields
  in the access logs. If missing, update the logging settings in the Google Cloud
  Console or via the gcloud command-line tool to include identity information in API
  access logs.
references:
- https://cloud.google.com/endpoints/docs/grpc/logging
- https://cloud.google.com/logging/docs/audit#configuring_audit_logs
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/iam/docs/audit-logging
