rule_id: gcp.endpoints.endpoint.api_monitoring_api_logs_retention_days_minimum
service: endpoints
resource: endpoint
requirement: API Monitoring API Logs Retention Days Minimum
scope: endpoints.endpoint.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: medium
title: Ensure Minimum Retention of API Monitoring Logs
rationale: Retaining API monitoring logs for a minimum period is crucial for effective
  incident response, forensic analysis, and compliance with regulatory requirements
  such as PCI-DSS and HIPAA. Insufficient log retention can lead to undetected malicious
  activity and non-compliance with data retention policies, increasing the risk of
  security breaches and legal penalties.
description: This rule checks whether API monitoring logs for Google Cloud Endpoints
  are retained for at least the prescribed minimum number of days. It involves verifying
  the logging configuration of each endpoint to ensure logs are stored for a minimum
  duration that meets organizational and regulatory compliance needs. Remediation
  includes configuring the log retention settings in the Google Cloud Console or via
  the gcloud command-line tool to meet the minimum requirements.
references:
- https://cloud.google.com/logging/docs/audit
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance/pci-dss
- https://cloud.google.com/security/compliance/hipaa
- https://cloud.google.com/logging/docs/best-practices
