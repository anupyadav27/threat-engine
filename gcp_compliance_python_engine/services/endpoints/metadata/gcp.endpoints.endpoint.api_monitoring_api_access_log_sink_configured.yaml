rule_id: gcp.endpoints.endpoint.api_monitoring_api_access_log_sink_configured
service: endpoints
resource: endpoint
requirement: API Monitoring API Access Log Sink Configured
scope: endpoints.endpoint.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: medium
title: Ensure API Monitoring Access Logs are Configured for Endpoints
rationale: Configuring API monitoring access logs is crucial for tracking API usage,
  detecting anomalous behavior, and meeting compliance requirements such as GDPR and
  SOC 2. Without proper logging, organizations face increased risks of undetected
  security breaches, data exfiltration, and non-compliance penalties.
description: This rule checks if API Monitoring API access log sinks are configured
  for Google Cloud Endpoints. Proper configuration involves setting up a log sink
  that captures and exports API access logs to a centralized logging service like
  Cloud Logging. To verify, ensure the existence of a log sink with a filter for API
  access logs. Remediation involves creating or updating the log sink configuration
  in the GCP Console or via gcloud CLI.
references:
- https://cloud.google.com/endpoints/docs/openapi/logging
- https://cloud.google.com/logging/docs/export/configure_export_v2
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://cloud.google.com/security/compliance/gdpr
