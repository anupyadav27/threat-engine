rule_id: gcp.endpoints.endpoint.api_monitoring_api_execution_logging_level_minimum_error
service: endpoints
resource: endpoint
requirement: API Monitoring API Execution Logging Level Minimum Error
scope: endpoints.endpoint.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: medium
title: Ensure API Execution Logs at Minimum Error Level for Endpoints
rationale: Setting the API execution logging level to at least 'Error' ensures that
  critical issues and failures are captured for troubleshooting and audit purposes.
  This practice helps in identifying potential security breaches, unauthorized access
  attempts, and system failures, thus mitigating risks and aiding in compliance with
  standards like PCI-DSS and SOC2 that require effective logging mechanisms.
description: This rule checks if the API execution logging level for Google Cloud
  Endpoints is configured to at least 'Error' level. By doing so, it ensures that
  all error events are logged, which is crucial for security audits and incident investigations.
  To verify, inspect the 'logging' section of the endpoint configuration in the Google
  Cloud Console or via gcloud CLI. If not set to 'Error' or higher, update the configuration
  by setting the 'logging' parameter to 'ERROR' in the endpoint's YAML configuration
  file and redeploy the service.
references:
- https://cloud.google.com/endpoints/docs/openapi/logging
- https://cloud.google.com/security/compliance
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/pci_security/
- https://cloud.google.com/architecture/security-logs-monitoring
- https://cloud.google.com/endpoints/docs/openapi/restricting-api-access
