rule_id: gcp.cloudfunctions.function.serverless_source_trusted
service: cloudfunctions
resource: function
requirement: Serverless Source Trusted
scope: cloudfunctions.function.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Ensure Cloud Functions Source is from Trusted Locations
rationale: Allowing Cloud Functions to execute code from untrusted sources poses security
  risks such as data exfiltration, unauthorized access, and execution of malicious
  code. This could lead to breaches of sensitive data, service disruptions, and non-compliance
  with regulations like GDPR, HIPAA, or PCI-DSS.
description: This rule checks whether Cloud Functions are configured to execute code
  only from trusted and verified sources, such as authorized repositories or storage
  locations. Administrators should verify the source of the code before deployment
  by ensuring proper IAM roles and permissions are applied, and by utilizing version
  control systems with strong access controls. Remediation involves using Google Cloud's
  IAM to restrict who can modify the function's source and employing signed URLs or
  checksums for integrity verification.
references:
- https://cloud.google.com/functions/docs/bestpractices/security
- https://cloud.google.com/iam/docs/overview
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss
- https://www.iso.org/standard/54534.html
