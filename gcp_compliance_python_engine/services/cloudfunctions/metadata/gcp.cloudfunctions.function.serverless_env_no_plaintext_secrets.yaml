rule_id: gcp.cloudfunctions.function.serverless_env_no_plaintext_secrets
service: cloudfunctions
resource: function
requirement: Serverless Env No Plaintext Secrets
scope: cloudfunctions.function.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: high
title: Avoid Plaintext Secrets in Cloud Functions Environment Variables
rationale: Storing plaintext secrets in environment variables of Cloud Functions can
  lead to unauthorized access if the function's configuration is exposed. This exposure
  can result in data breaches or system compromise, particularly if sensitive credentials
  are leaked. Ensuring secrets are encrypted helps meet compliance requirements like
  PCI-DSS and protects against potential insider threats and external attacks.
description: This rule checks whether Google Cloud Functions use plaintext environment
  variables to store sensitive information, such as API keys or passwords. Functions
  should leverage Google Secret Manager for storing sensitive data securely. To verify,
  inspect the function's configuration for any hardcoded secrets in the environment
  variables. Remediation involves migrating these secrets to Secret Manager and updating
  the function to access secrets at runtime securely.
references:
- https://cloud.google.com/functions/docs/configuring/secrets
- https://cloud.google.com/secret-manager/docs/best-practices
- CIS Google Cloud Platform Foundation Benchmark v1.3.0, Section 4.1
- NIST SP 800-53 Rev. 5, System and Communications Protection
- 'PCI-DSS v3.2.1, Requirement 3: Protect Stored Cardholder Data'
- https://cloud.google.com/security/compliance
