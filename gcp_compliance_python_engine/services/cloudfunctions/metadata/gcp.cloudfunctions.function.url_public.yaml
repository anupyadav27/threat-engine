rule_id: gcp.cloudfunctions.function.url_public
service: cloudfunctions
resource: function
requirement: Url Public
scope: cloudfunctions.function.public_access
domain: identity_and_access_management
subcategory: authentication
severity: critical
title: Restrict Public Access to GCP Cloud Functions URLs
rationale: Allowing public access to Cloud Functions URLs can expose sensitive data
  and operations to unauthorized users, leading to potential data breaches and service
  disruptions. Unrestricted access could be exploited by attackers to execute malicious
  actions or access confidential information, thereby violating compliance with regulations
  such as PCI-DSS, HIPAA, and SOC2.
description: This rule checks for GCP Cloud Functions that are configured with publicly
  accessible URLs, which can be a significant security risk. To verify, ensure that
  Cloud Functions are only accessible to authorized users and service accounts using
  IAM policies. Remediation involves updating IAM settings to restrict access to specific
  users and roles, and removing 'allUsers' or 'allAuthenticatedUsers' from the function's
  permissions.
references:
- https://cloud.google.com/functions/docs/securing/managing-access
- https://cloud.google.com/iam/docs/understanding-roles
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.hipaajournal.com/hipaa-security-rule/
