rule_id: gcp.cloudfunctions.function.serverless_role_least_privilege
service: cloudfunctions
resource: function
requirement: Serverless Role Least Privilege
scope: cloudfunctions.function.least_privilege
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Ensure Least Privilege for Cloud Functions Service Accounts
rationale: Assigning excessive permissions to Cloud Functions can lead to unauthorized
  access, data breaches, and compliance violations. By adhering to the principle of
  least privilege, organizations minimize the potential impact of compromised credentials
  or malicious actors exploiting over-privileged roles. This practice aligns with
  compliance frameworks such as PCI-DSS and ISO 27001, which require strict access
  controls.
description: This rule checks that Cloud Functions are not granted excessive permissions
  beyond what is necessary for their operation. Ensure that the service accounts associated
  with Cloud Functions have roles that are specific to their function and activity.
  Remediation involves reviewing the roles and permissions associated with each function's
  service account and adjusting them to match the minimum necessary permissions. It
  is recommended to use IAM Policy Analyzer and IAM Recommender to evaluate and refine
  these permissions.
references:
- https://cloud.google.com/functions/docs/securing/function-identity
- https://cloud.google.com/iam/docs/understanding-service-accounts
- https://cloud.google.com/security/compliance/cis-gcp-benchmark
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.iso.org/iso-27001-information-security.html
