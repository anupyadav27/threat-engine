rule_id: gcp.cloudfunctions.function.serverless_dead_letter_queue_configured
service: cloudfunctions
resource: function
requirement: Serverless Dead Letter Queue Configured
scope: cloudfunctions.function.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Ensure Dead Letter Queue Configured for Cloud Functions
rationale: Configuring a Dead Letter Queue (DLQ) for Cloud Functions ensures that
  unprocessed messages are not lost, helping maintain data integrity and enabling
  easier troubleshooting in case of failures. Without a DLQ, failed executions can
  result in data loss and impact business continuity, potentially leading to non-compliance
  with data handling regulations such as GDPR and HIPAA.
description: This rule checks if a Dead Letter Queue is configured for Google Cloud
  Functions. A DLQ captures messages that cannot be processed successfully, providing
  a mechanism for reprocessing or analyzing failures. To verify, ensure that the 'deadLetterPolicy'
  is set within the function's 'eventTrigger' configuration. Remediation involves
  specifying a Pub/Sub topic for unprocessed messages in the Cloud Function's settings,
  ensuring failed events are retained for further analysis.
references:
- https://cloud.google.com/functions/docs/monitoring/logging
- https://cloud.google.com/functions/docs/bestpractices/reliability
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/pubsub/docs/dead-letter-topics
