rule_id: gcp.cloudfunctions.function.serverless_vpc_private_networking_enabled
service: cloudfunctions
resource: function
requirement: Serverless VPC Private Networking Enabled
scope: cloudfunctions.function.network_security
domain: network_security_and_connectivity
subcategory: network_access_control
severity: medium
title: Enable Serverless VPC Access for Cloud Functions
rationale: Enabling Serverless VPC Access for Cloud Functions is crucial for securing
  network traffic and ensuring that function executions remain within a controlled
  network environment. This reduces the risk of unauthorized access over the public
  internet and helps comply with stringent data protection regulations by maintaining
  data within private network boundaries.
description: This rule verifies that Google Cloud Functions have Serverless VPC Access
  enabled, allowing them to communicate privately with resources in a Virtual Private
  Cloud (VPC). To configure, associate your function with a VPC connector. This can
  be done via the Google Cloud Console by navigating to the 'VPC Access' section under
  Cloud Functions or by using the gcloud CLI. Remediation involves creating a serverless
  VPC access connector if one does not exist and updating the function configuration
  to use this connector.
references:
- https://cloud.google.com/functions/docs/networking/network-settings
- https://cloud.google.com/functions/docs/networking/connecting-vpc
- https://cloud.google.com/architecture/serverless-vpc-access
- https://cloud.google.com/security/compliance
- https://www.cisecurity.org/benchmark/google_cloud_computing_foundations
