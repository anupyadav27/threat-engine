rule_id: gcp.cloudfunctions.function.serverless_version_immutable
service: cloudfunctions
resource: function
requirement: Serverless Version Immutable
scope: cloudfunctions.function.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Ensure Cloud Functions Use Immutable Serverless Versions
rationale: Immutable serverless versions in Google Cloud Functions prevent unintended
  changes and ensure consistent, repeatable deployments. This minimizes the risk of
  unauthorized code changes, which could introduce vulnerabilities or disrupt services.
  Regulatory frameworks often require integrity and consistency in deployment processes
  to ensure compliance with standards like SOC2 and ISO 27001.
description: This rule checks that Google Cloud Functions are configured to use immutable
  versions, ensuring that once deployed, the function code cannot be altered without
  deploying a new version. To verify, ensure that your deployment process includes
  specific versioning practices for Cloud Functions. Remediation involves setting
  up deployment pipelines using tools like Cloud Build, which automatically version
  functions and maintain deployment integrity.
references:
- https://cloud.google.com/functions/docs/versioning
- https://cloud.google.com/security/compliance/soc-2
- https://cloud.google.com/security/compliance/iso-27001
- https://cloud.google.com/architecture/serverless-best-practices
- https://cloud.google.com/cloud-build/docs/configuring-builds/create-basic-configuration
