rule_id: gcp.cloudfunctions.function.serverless_prov_conc_execution_role_least_privilege
service: cloudfunctions
resource: function
requirement: Serverless Prov Conc Execution Role Least Privilege
scope: cloudfunctions.function.least_privilege
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Ensure Cloud Functions Use Least Privilege for Execution Roles
rationale: Using the least privilege principle for Cloud Functions execution roles
  minimizes the risk of unauthorized access and data breaches. Over-privileged roles
  can lead to potential exploitation if compromised, impacting data confidentiality
  and integrity. Adhering to this principle supports compliance with regulatory frameworks
  such as NIST and PCI-DSS, which mandate minimal access necessary for functionality.
description: This rule checks whether Cloud Functions in GCP are configured to use
  execution roles with the least privilege necessary. It ensures that the role assigned
  to a function has only the necessary permissions to perform its operations, reducing
  the attack surface. Verify by reviewing the IAM policies attached to execution roles
  and adjust permissions to align with the function's operational requirements. Remediation
  involves editing the IAM policy to remove any excessive permissions not required
  by the function.
references:
- https://cloud.google.com/functions/docs/securing/function-identity
- https://cloud.google.com/iam/docs/understanding-service-accounts
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/iam/docs/best-practices-for-using-granting-roles
