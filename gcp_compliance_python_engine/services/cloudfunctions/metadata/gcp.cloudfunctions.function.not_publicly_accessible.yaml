rule_id: gcp.cloudfunctions.function.not_publicly_accessible
service: cloudfunctions
resource: function
requirement: Not Publicly Accessible
scope: cloudfunctions.function.public_access
domain: identity_and_access_management
subcategory: authentication
severity: critical
title: Ensure Cloud Functions are Not Publicly Accessible
rationale: Publicly accessible Cloud Functions can be exploited by unauthorized parties,
  leading to potential data breaches and service disruptions. This exposure increases
  the risk of malicious actors executing harmful code, consuming resources, or accessing
  sensitive information. Compliance with standards such as PCI-DSS and ISO 27001 requires
  limiting public access to minimize attack surfaces.
description: This check verifies that Google Cloud Functions are not set to be publicly
  accessible by reviewing IAM policies for roles that grant 'allUsers' or 'allAuthenticatedUsers'
  permissions. To remediate, adjust the function's IAM policies to restrict access
  to specific users or service accounts that require it. Ensure the 'roles/cloudfunctions.invoker'
  role is only granted to trusted entities by modifying permissions in the GCP Console
  or using the gcloud CLI.
references:
- https://cloud.google.com/functions/docs/securing
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/iam/docs/understanding-roles
