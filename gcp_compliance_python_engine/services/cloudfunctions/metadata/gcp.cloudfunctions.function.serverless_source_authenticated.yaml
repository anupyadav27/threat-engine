rule_id: gcp.cloudfunctions.function.serverless_source_authenticated
service: cloudfunctions
resource: function
requirement: Serverless Source Authenticated
scope: cloudfunctions.function.security
domain: compute_and_workload_security
subcategory: instance_configuration
severity: low
title: Ensure Cloud Functions Have Authenticated Source Traffic
rationale: Allowing unauthenticated traffic to Cloud Functions can expose your application
  to unauthorized access, leading to data breaches or resource misuse. Enforcing authentication
  ensures that only intended and verified sources can invoke the functions, mitigating
  risks associated with unauthorized data exposure and potential exploitation. This
  is crucial for maintaining the integrity and confidentiality of your serverless
  applications and meeting compliance standards.
description: This rule checks that Google Cloud Functions are configured to allow
  traffic only from authenticated sources. Specifically, it verifies the IAM policies
  and ingress settings to ensure only authorized entities can invoke the functions.
  To remediate, configure the Cloud Function's ingress settings to 'Allow internal
  traffic only' or set up identity-based authentication using IAM roles and policies.
  Verify using the GCP Console or gcloud CLI to ensure the function's ingress settings
  are correctly configured.
references:
- https://cloud.google.com/functions/docs/securing/authenticating
- https://cloud.google.com/iam/docs/understanding-service-accounts
- https://cloud.google.com/security/compliance/cis
- https://cloud.google.com/security/compliance/nist
- https://cloud.google.com/security/compliance/iso-27001
- https://cloud.google.com/architecture/serverless/security
