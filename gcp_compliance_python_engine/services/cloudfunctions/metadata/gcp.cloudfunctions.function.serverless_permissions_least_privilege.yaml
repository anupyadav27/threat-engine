rule_id: gcp.cloudfunctions.function.serverless_permissions_least_privilege
service: cloudfunctions
resource: function
requirement: Serverless Permissions Least Privilege
scope: cloudfunctions.function.least_privilege
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Ensure Least Privilege for GCP Cloud Functions Permissions
rationale: Enforcing least privilege on Cloud Functions reduces the risk of unauthorized
  access and potential data breaches. Excessive permissions can lead to privilege
  escalation and exploitation, posing significant security risks and compliance violations
  with frameworks like PCI-DSS and ISO 27001.
description: This rule checks if Cloud Functions are assigned only the necessary permissions
  to perform their tasks. Verify that roles granted do not exceed the minimum required
  and remove any excess permissions. Use IAM roles such as 'roles/cloudfunctions.invoker'
  judiciously to avoid broad access. Review and adjust IAM policies regularly to maintain
  compliance with least privilege principles.
references:
- https://cloud.google.com/functions/docs/securing
- https://cloud.google.com/iam/docs/understanding-roles
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/iam/docs/best-practices-for-managing-iam-policies
