rule_id: gcp.iam.role.identity_access_trust_principals_allowlist_only
service: iam
resource: role
requirement: Identity Access Trust Principals Allowlist Only
scope: iam.role.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Restrict IAM Role Trust Principals to Allowlist
rationale: Restricting IAM role trust principals to a predefined allowlist reduces
  the risk of unauthorized access by ensuring that only approved and vetted identities
  can assume roles. This control mitigates the threat of privilege escalation and
  data breaches, aligning with compliance requirements such as PCI-DSS and ISO 27001.
description: This rule checks if IAM roles in GCP have trust policies that only allow
  identities from a specified allowlist to assume them. Verify that role bindings
  are limited to known and necessary service accounts or identities. Remediation involves
  auditing existing IAM roles and updating their trust policies to include only approved
  principals, preventing unauthorized access.
references:
- https://cloud.google.com/iam/docs/understanding-service-accounts
- https://cloud.google.com/iam/docs/allow-policies
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/security/best-practices
