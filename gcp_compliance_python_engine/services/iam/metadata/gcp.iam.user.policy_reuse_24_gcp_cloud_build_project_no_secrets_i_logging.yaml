rule_id: gcp.iam.user.policy_reuse_24_gcp_cloud_build_project_no_secrets_i_logging
service: iam
resource: user
requirement: Policy Reuse 24 Gcp Cloud Build Project No Secrets I Logging
scope: iam.user.logging
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Prevent Secrets in Cloud Build Logs
rationale: Exposing secrets in Cloud Build logs can lead to unauthorized access and
  potential data breaches. This poses significant security risks as attackers could
  gain access to sensitive systems and data, violating compliance requirements such
  as PCI-DSS and HIPAA. Ensuring secrets are not logged helps protect the organization's
  infrastructure and maintains trust with clients and stakeholders.
description: This rule checks Cloud Build configurations to ensure sensitive information
  such as API keys and passwords are not logged. Verify that steps in Cloud Build
  do not output secrets to logs by using environment substitutions and secret management
  best practices. Remediation involves reviewing build configurations for secret exposure
  and implementing secret manager or environment variables to securely handle sensitive
  information.
references:
- https://cloud.google.com/build/docs/securing-builds/use-secrets
- https://cloud.google.com/iam/docs/using-iam-securely
- CIS Google Cloud Platform Foundation Benchmark v1.3.0, Section 7.4
- https://www.pcisecuritystandards.org/pci_security/
- https://www.hhs.gov/hipaa/index.html
- https://cloud.google.com/security/best-practices
