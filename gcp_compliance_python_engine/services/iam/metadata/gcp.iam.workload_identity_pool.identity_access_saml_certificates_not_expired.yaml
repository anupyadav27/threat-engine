rule_id: gcp.iam.workload_identity_pool.identity_access_saml_certificates_not_expired
service: iam
resource: workload_identity_pool
requirement: Identity Access Saml Certificates Not Expired
scope: iam.workload_identity_pool.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Ensure SAML Certificates in Workload Identity Pools Are Valid
rationale: Expired SAML certificates in workload identity pools can lead to authentication
  failures, disrupting service operations and potentially causing unauthorized access
  if not properly managed. This poses a security risk by allowing attackers to exploit
  expired certificates for malicious activities. Maintaining valid certificates is
  crucial for compliance with regulations like NIST and SOC2, which require robust
  identity and access management practices.
description: This rule checks that all SAML certificates associated with GCP IAM Workload
  Identity Pools are valid and not expired. Expired certificates can prevent successful
  SSO authentication, leading to access issues for services relying on these identities.
  To verify, regularly audit your certificate expiration dates and replace or renew
  certificates before they expire. Remediation involves updating the SAML provider
  configurations with a valid certificate in the GCP Console or via gcloud CLI.
references:
- https://cloud.google.com/iam/docs/workload-identity-pools
- https://cloud.google.com/iam/docs/managing-workload-identity-pools
- https://cloud.google.com/iam/docs/saml
- https://www.nist.gov/cyberframework
- https://www.isc2.org/Certifications/SSCP
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
