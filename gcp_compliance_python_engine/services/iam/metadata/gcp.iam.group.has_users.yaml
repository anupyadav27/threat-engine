rule_id: gcp.iam.group.has_users
service: iam
resource: group
requirement: Has Users
scope: iam.group.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Ensure IAM Groups Contain Active Users
rationale: IAM groups without users can lead to misconfigurations and potential security
  gaps, as they may be overlooked during audits and reviews. Empty groups can accumulate
  over time, resulting in unnecessary complexity and the risk of inappropriate access
  if mistakenly assigned policies. Ensuring that groups have active users aligns with
  security best practices and compliance requirements, reducing the attack surface
  and maintaining a clear overview of access control within the organization.
description: This rule checks if IAM groups in GCP contain at least one active user.
  Groups should not be empty to ensure they serve a functional purpose and are properly
  monitored. Administrators should regularly audit IAM groups and remove any that
  no longer have users or are not in use. Remediation involves reviewing group membership
  through the GCP Console or gcloud CLI and adding users where necessary or deleting
  obsolete groups.
references:
- https://cloud.google.com/iam/docs/overview
- https://cloud.google.com/iam/docs/using-iam-securely
- https://cloud.google.com/docs/enterprise/best-practices-for-enterprise-organizations#identity_management
- CIS Google Cloud Computing Foundations Benchmark v1.3.0 - 1.1 Ensure that corporate
  login credentials are used
- 'NIST SP 800-53 AC-2: Account Management'
- ISO/IEC 27001:2013 - A.9 Access Control
