rule_id: gcp.iam.workload_identity_pool.identity_access_saml_idp_metadata_signed
service: iam
resource: workload_identity_pool
requirement: Identity Access Saml Idp Metadata Signed
scope: iam.workload_identity_pool.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Ensure SAML IdP Metadata is Signed for Workload Identity Pools
rationale: Unsigned SAML IdP metadata can lead to security vulnerabilities such as
  unauthorized access, identity spoofing, and data breaches. Ensuring metadata is
  signed helps maintain integrity and authenticity, reducing the risk of man-in-the-middle
  attacks and ensuring compliance with security frameworks like NIST SP 800-63 and
  ISO 27001.
description: This rule verifies that SAML IdP metadata associated with GCP Workload
  Identity Pools is signed, ensuring authenticity and integrity. To check compliance,
  review the metadata configuration in your identity provider settings. Remediate
  by configuring your identity provider to sign the SAML metadata, and update the
  GCP Workload Identity Pool to trust metadata only if it's signed by a trusted certificate
  authority (CA).
references:
- https://cloud.google.com/iam/docs/workload-identity-federation
- https://cloud.google.com/iam/docs/manage-workload-identity-pools
- https://csrc.nist.gov/publications/detail/sp/800-63/4/final
- https://www.iso.org/iso-27001-information-security.html
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/best-practices/identity
