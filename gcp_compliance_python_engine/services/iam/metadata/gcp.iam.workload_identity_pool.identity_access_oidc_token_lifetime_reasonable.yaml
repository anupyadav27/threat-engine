rule_id: gcp.iam.workload_identity_pool.identity_access_oidc_token_lifetime_reasonable
service: iam
resource: workload_identity_pool
requirement: Identity Access Oidc Token Lifetime Reasonable
scope: iam.workload_identity_pool.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Ensure Reasonable OIDC Token Lifetime for Workload Identity Pools
rationale: Setting a reasonable lifetime for OIDC tokens in Workload Identity Pools
  is crucial to minimize the risk of token misuse and unauthorized access. Short-lived
  tokens reduce the window of opportunity for attackers to exploit a compromised token,
  aligning with security best practices and compliance requirements such as NIST SP
  800-63B and PCI-DSS. This control helps maintain a secure identity and access management
  posture, preventing potential data breaches and unauthorized resource access.
description: This rule checks that the lifetime of OIDC tokens issued by Workload
  Identity Pools is set to a reasonable duration, typically no longer than one hour.
  To verify, ensure that the 'token_lifetime' property is configured within this threshold
  when creating or updating the identity pool. Remediation involves updating the pool
  configuration to reduce the token lifetime, thereby enhancing security by limiting
  token validity. Administrators can use the GCP Console or gcloud CLI to adjust these
  settings.
references:
- https://cloud.google.com/iam/docs/workload-identity-federation
- https://cloud.google.com/iam/docs/creating-managing-workload-identity-pools
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/security/best-practices/identity-access-management
