rule_id: gcp.iam.service_account.identity_access_instance_profile_role_attached
service: iam
resource: service_account
requirement: Identity Access Instance Profile Role Attached
scope: iam.service_account.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Ensure Service Account Has No Instance Profile Role Attached
rationale: Attaching an instance profile role to a service account can lead to privilege
  escalation, where unauthorized users may gain access to resources beyond their intended
  scope. This misconfiguration poses a security risk by potentially allowing lateral
  movement within the cloud infrastructure, which can lead to data breaches and non-compliance
  with regulations such as PCI-DSS and SOC2.
description: This rule checks for service accounts with identity access to instance
  profile roles attached, which should be avoided to minimize risks of privilege escalation.
  Verify that no service accounts have roles granting excessive permissions by inspecting
  the IAM policy bindings. If such a role is found, detach it to limit access. Regularly
  audit IAM policies and utilize least privilege principles to ensure service accounts
  have only necessary permissions.
references:
- https://cloud.google.com/iam/docs/service-accounts
- https://cloud.google.com/iam/docs/understanding-roles
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/pci_security/
