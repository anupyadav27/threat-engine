rule_id: gcp.iam.service_account.roles_at_project_level
service: iam
resource: service_account
requirement: Roles At Project Level
scope: iam.service_account.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Restrict Service Account Roles at Project Level
rationale: Assigning service account roles at the project level can inadvertently
  grant excessive permissions across all resources within the project, increasing
  the risk of privilege escalation and unauthorized access. This can lead to data
  breaches or service disruptions, affecting business operations and potentially leading
  to non-compliance with regulations such as PCI-DSS and SOC2.
description: This rule checks for service accounts that have roles assigned at the
  project level, which may grant excessive permissions. Ensure that service accounts
  are only assigned the minimum necessary roles at the most granular level required,
  such as specific resources or services, to adhere to the principle of least privilege.
  Remediate by auditing service account permissions and adjusting roles to be more
  restrictive where possible.
references:
- https://cloud.google.com/iam/docs/understanding-roles
- https://cloud.google.com/security/compliance/cis-gcp-benchmark
- https://www.pcisecuritystandards.org/pci_security/
- https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/sorhome.html
- https://cloud.google.com/iam/docs/service-accounts
