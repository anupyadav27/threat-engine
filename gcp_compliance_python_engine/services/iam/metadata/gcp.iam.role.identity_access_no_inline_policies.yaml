rule_id: gcp.iam.role.identity_access_no_inline_policies
service: iam
resource: role
requirement: Identity Access No Inline Policies
scope: iam.role.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Avoid Inline Policies in IAM Roles
rationale: Inline policies in IAM roles can lead to complex and fragmented access
  management, increasing the risk of privilege escalation and unauthorized access.
  They hinder the ability to uniformly enforce security policies and audit access
  controls. Adopting managed policies instead supports compliance with standards like
  ISO 27001 and facilitates easier policy management and auditing.
description: This rule checks for the presence of inline policies attached directly
  to IAM roles in GCP. Inline policies create tightly coupled configurations that
  are harder to manage and audit. To verify, examine IAM roles and ensure policies
  are defined as standalone entities and not embedded directly in the role. Remediation
  involves migrating inline policies to standalone IAM policies and attaching them
  to roles, improving manageability and security oversight.
references:
- https://cloud.google.com/iam/docs/policies#inline_policies
- https://www.cisecurity.org/benchmark/google_cloud_computing_foundations/
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://cloud.google.com/iam/docs/understanding-roles
- https://cloud.google.com/iam/docs/using-iam-securely
