rule_id: gcp.iam.workload_identity_pool.identity_access_oidc_allowed_client_ids_audiences_restricted
service: iam
resource: workload_identity_pool
requirement: Identity Access Oidc Allowed Client Ids Audiences Restricted
scope: iam.workload_identity_pool.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Restrict OIDC Client IDs and Audiences in Workload Identity Pools
rationale: Restricting OIDC allowed client IDs and audiences prevents unauthorized
  access and misuse of identity tokens within your environment. Failure to enforce
  such restrictions can lead to impersonation attacks and unauthorized access to sensitive
  resources, posing a significant security threat and potential non-compliance with
  regulations like NIST and PCI-DSS.
description: This rule checks that OIDC allowed client IDs and audiences within workload
  identity pools are explicitly specified and restricted. To verify, ensure that the
  workload identity pool configuration only includes trusted client IDs and audiences.
  Remediation involves updating the identity pool settings to define a precise list
  of allowed client IDs and audiences, thereby minimizing the risk of token misuse.
references:
- https://cloud.google.com/iam/docs/workload-identity-federation
- https://cloud.google.com/architecture/identity/access-management-best-practices#workload-identity-federation
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.nist.gov/cyberframework
- https://www.pcisecuritystandards.org/document_library
