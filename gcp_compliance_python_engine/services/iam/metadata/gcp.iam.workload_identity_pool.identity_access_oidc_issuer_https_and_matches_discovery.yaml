rule_id: gcp.iam.workload_identity_pool.identity_access_oidc_issuer_https_and_matches_discovery
service: iam
resource: workload_identity_pool
requirement: Identity Access Oidc Issuer HTTPS And Matches Discovery
scope: iam.workload_identity_pool.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Ensure Workload Identity OIDC Issuer Uses HTTPS and Matches Discovery
rationale: Using HTTPS for OIDC issuers ensures the confidentiality and integrity
  of identity tokens during transmission, mitigating risks of interception or tampering.
  Compliance with discovery document specifications helps prevent unauthorized entities
  from impersonating identity providers, reducing the risk of unauthorized access
  and data breaches.
description: This rule verifies that the OIDC issuer URL for a workload identity pool
  uses HTTPS and matches the discovery document. To ensure secure communication, configure
  the issuer to use HTTPS and confirm it aligns with the discovery endpoint details.
  Remediation involves updating any non-compliant issuer URLs to use HTTPS and verifying
  they match the well-known discovery document hosted by the identity provider.
references:
- https://cloud.google.com/iam/docs/workload-identity-federation
- https://cloud.google.com/iam/docs/reference/rest/v1/projects.locations.workloadIdentityPools
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63c.pdf
- https://tools.ietf.org/html/rfc8414
- https://cloud.google.com/security/compliance
