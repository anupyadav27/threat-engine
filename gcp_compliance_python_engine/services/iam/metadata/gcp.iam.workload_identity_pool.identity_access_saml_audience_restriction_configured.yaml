rule_id: gcp.iam.workload_identity_pool.identity_access_saml_audience_restriction_configured
service: iam
resource: workload_identity_pool
requirement: Identity Access Saml Audience Restriction Configured
scope: iam.workload_identity_pool.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Ensure SAML Audience Restriction is Configured for Workload Identity Pools
rationale: Configuring SAML Audience Restrictions for Workload Identity Pools is crucial
  to prevent unauthorized access by ensuring that tokens are only accepted by intended
  services. This reduces the risk of identity spoofing and helps organizations comply
  with regulatory requirements such as NIST SP 800-63B and ISO 27001, which demand
  strict identity and access management controls.
description: This rule checks if SAML Audience Restrictions are configured for Workload
  Identity Pools in GCP. Proper configuration ensures that SAML assertions are only
  valid for specific intended recipients, mitigating the risk of token misuse. To
  verify, inspect the Workload Identity Pool's SAML configuration settings in the
  GCP Console or through the gcloud CLI. Remediation involves updating the SAML provider
  settings to include the correct audience restriction URIs.
references:
- https://cloud.google.com/iam/docs/workload-identity-federation
- https://cloud.google.com/iam/docs/reference/rest/v1/projects.locations.workloadIdentityPools.providers#Saml
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf
- https://www.iso.org/standard/54534.html
- https://cloud.google.com/security/best-practices
