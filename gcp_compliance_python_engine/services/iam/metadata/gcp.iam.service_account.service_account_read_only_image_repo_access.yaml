rule_id: gcp.iam.service_account.service_account_read_only_image_repo_access
service: iam
resource: service_account
requirement: Service Account Read Only Image Repo Access
scope: iam.service_account.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Enforce Read-Only Image Repo Access for Service Accounts
rationale: Restricting service account permissions to read-only for image repositories
  reduces the risk of unauthorized image modification or deletion, which could lead
  to service disruptions or security vulnerabilities. This practice supports compliance
  with least privilege principles and helps prevent potential data exfiltration or
  corruption scenarios.
description: This rule ensures that service accounts have read-only access to image
  repositories in Google Container Registry (GCR) or Artifact Registry. It checks
  for policies granting only the 'roles/storage.objectViewer' role to service accounts
  for these repositories. To verify, review IAM policies for service accounts and
  ensure no write or admin roles are granted. Remediation involves removing excessive
  permissions and assigning the correct read-only roles.
references:
- https://cloud.google.com/container-registry/docs/access-control
- https://cloud.google.com/iam/docs/understanding-roles
- https://cloud.google.com/security/compliance/cis
- https://www.nist.gov/cyberframework
- https://cloud.google.com/docs/security/best-practices
