rule_id: gcp.iam.role.identity_access_attached_policies_not_admin_star
service: iam
resource: role
requirement: Identity Access Attached Policies Not Admin Star
scope: iam.role.security
domain: identity_and_access_management
subcategory: authentication
severity: critical
title: Restrict Admin Role Assignments in IAM Policies
rationale: Allowing roles with wildcard permissions (e.g., 'roles/*') can lead to
  excessive privileges and potential misuse by malicious actors. Properly scoped permissions
  reduce the risk of privilege escalation and data breaches, and ensure compliance
  with least privilege principles required by regulatory standards such as ISO 27001
  and SOC2.
description: This rule checks IAM roles to ensure that no policy grants overly broad
  permissions using 'roles/*'. Review and update policies to adhere to the principle
  of least privilege by assigning only specific, necessary roles. Use IAM Recommender
  to identify and remove unused permissions. Regular audits and policy reviews are
  essential to maintain a secure and compliant environment.
references:
- https://cloud.google.com/iam/docs/understanding-roles
- https://cloud.google.com/iam/docs/recommender-overview
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://cloud.google.com/security/compliance/iso-27001
- https://cloud.google.com/security/compliance/soc-2
