rule_id: gcp.iam.policy.attached_only_to_group_or_roles
service: iam
resource: policy
requirement: Attached Only To Group Or Roles
scope: iam.policy.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Ensure IAM Policies Are Attached Only to Groups or Roles
rationale: Attaching IAM policies directly to individual users increases the risk
  of excessive permissions, which can lead to unauthorized access and potential data
  breaches. By limiting policy attachments to groups or roles, organizations can manage
  permissions more effectively and ensure compliance with least privilege principles.
  This approach also facilitates easier audits and compliance with standards like
  ISO 27001 and SOC2.
description: This rule checks that IAM policies are not directly attached to individual
  user accounts but are instead associated with groups or roles. To verify, review
  IAM policies in the GCP Console under the IAM & Admin section and ensure no policies
  are directly assigned to users. Remediation involves reassigning these policies
  to appropriate groups or roles, ensuring that permissions are granted through group
  membership or role assumption, which can be managed via the IAM & Admin interface
  or by using the gcloud CLI.
references:
- https://cloud.google.com/iam/docs/understanding-roles
- https://cloud.google.com/iam/docs/manage-access
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/docs/security/compliance
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- https://www.iso.org/isoiec-27001-information-security.html
