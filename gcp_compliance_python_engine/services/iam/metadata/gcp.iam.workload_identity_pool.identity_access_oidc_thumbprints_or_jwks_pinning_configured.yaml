rule_id: gcp.iam.workload_identity_pool.identity_access_oidc_thumbprints_or_jwks_pinning_configured
service: iam
resource: workload_identity_pool
requirement: Identity Access Oidc Thumbprints Or Jwks Pinning Configured
scope: iam.workload_identity_pool.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Ensure OIDC Thumbprints or JWKs Pinning Configured for Workload Identity Pools
rationale: Configuring OIDC thumbprints or JWKs pinning is crucial to preventing man-in-the-middle
  attacks and ensuring the integrity of identity tokens used for authentication. Without
  this configuration, attackers could intercept or tamper with identity assertions,
  leading to unauthorized access. This setup also aids in meeting compliance requirements
  by ensuring secure communication channels for identity verification.
description: This rule checks whether OpenID Connect (OIDC) thumbprints or JSON Web
  Key Sets (JWKS) pinning is configured for Workload Identity Pools in GCP. To verify,
  ensure that the OIDC provider's thumbprints or JWKs are specified in the workload
  identity pool configuration. This can be done via the GCP Console or by using the
  gcloud CLI. Remediation involves updating the identity pool settings to include
  the correct thumbprints or JWKs from the identity provider.
references:
- https://cloud.google.com/iam/docs/workload-identity-federation
- https://cloud.google.com/iam/docs/understanding-workload-identity-federation
- https://csrc.nist.gov/publications/detail/sp/800-63/4/draft
- https://cloud.google.com/security/best-practices/identity
