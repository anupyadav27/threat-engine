rule_id: gcp.iam.role.identity_access_trust_requires_external_id_or_audi_supported
service: iam
resource: role
requirement: Identity Access Trust Requires External Id Or Audi Supported
scope: iam.role.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Ensure Identity Access Trust Uses External Id or Audi
rationale: Enforcing the use of External Id or Audi ensures that trust relationships
  with external identities or services are explicit and verified, preventing unauthorized
  access. This protects sensitive resources from impersonation attacks and meets compliance
  requirements for secure identity management, such as those outlined in ISO 27001
  and SOC 2.
description: This rule checks if roles requiring identity access trust have either
  an External Id or Audi configuration. External Ids and Audi claims facilitate secure
  and verified connections between GCP resources and external identities or services.
  To verify, review IAM role configurations for the presence of these identifiers.
  Remediation involves updating IAM role trust policies to include External Id or
  Audi claims, strengthening your security posture against unauthorized access.
references:
- https://cloud.google.com/iam/docs/understanding-service-accounts
- https://cloud.google.com/docs/security/compliance/cis-gcp-foundations-benchmark
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/security/best-practices/identity
