rule_id: gcp.iam.workload_identity_pool.identity_access_saml_assertion_lifetime_reasonable
service: iam
resource: workload_identity_pool
requirement: Identity Access Saml Assertion Lifetime Reasonable
scope: iam.workload_identity_pool.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Ensure Reasonable SAML Assertion Lifetime for Workload Identity Pools
rationale: Setting a reasonable lifetime for SAML assertions in workload identity
  pools is crucial to minimize the risk of token misuse and unauthorized resource
  access. Shorter assertion lifetimes reduce the time window for attackers to exploit
  stolen tokens, thereby enhancing security posture. This practice aligns with compliance
  requirements such as NIST SP 800-63B, which advocates for stringent identity and
  authentication controls.
description: This rule checks that the SAML assertion lifetime for GCP workload identity
  pools is set to a reasonable duration, typically not exceeding one hour. Administrators
  can verify this by inspecting the 'session_duration' attribute in the workload identity
  configuration. To remediate, configure the assertion lifetime using the GCP Console
  or gcloud CLI to ensure it meets security best practices, reducing potential attack
  vectors caused by long-lived tokens.
references:
- https://cloud.google.com/iam/docs/workload-identity-federation
- https://cloud.google.com/iam/docs/reference/rest/v1/projects.locations.workloadIdentityPools
- https://pages.nist.gov/800-63-3/sp800-63b.html
- https://cloud.google.com/security/best-practices/identity
- https://csrc.nist.gov/publications/detail/sp/800-63b/final
