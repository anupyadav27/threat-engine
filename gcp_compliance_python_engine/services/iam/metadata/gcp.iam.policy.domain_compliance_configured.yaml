rule_id: gcp.iam.policy.domain_compliance_configured
service: iam
resource: policy
requirement: Domain Compliance Configured
scope: iam.policy.compliance
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Ensure Domain Compliance for IAM Policies
rationale: Configuring domain compliance in IAM policies is crucial to mitigate unauthorized
  access risks and ensure that only approved domains can authenticate and access resources.
  This is particularly important for protecting sensitive data and maintaining compliance
  with industry regulations such as GDPR and HIPAA, which mandate strict access controls
  and data protection measures.
description: This rule checks whether IAM policies are configured to enforce domain
  compliance, ensuring that only identities from specified domains can be granted
  access. To verify, inspect the IAM policy bindings for the presence of domain-restricted
  conditions. Remediation involves updating IAM policies to include domain compliance
  conditions, using the 'member' field with a valid domain format (e.g., 'user:example.com').
  This configuration helps prevent unauthorized access from external domains.
references:
- https://cloud.google.com/iam/docs/conditions-overview
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/security/compliance
