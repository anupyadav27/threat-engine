rule_id: gcp.iam.service_account.no_guest_accounts_with_permissions_configured
service: iam
resource: service_account
requirement: No Guest Accounts With Permissions Configured
scope: iam.service_account.security
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Prevent Guest Accounts from Having Service Account Permissions
rationale: Assigning permissions to guest accounts poses a significant security risk
  as it can lead to unauthorized access to sensitive resources. Guest accounts often
  lack the scrutiny applied to regular user accounts, increasing the likelihood of
  malicious activity or data breaches. Ensuring that guest accounts do not have permissions
  aligns with compliance requirements such as NIST SP 800-53 and helps maintain a
  secure and controlled access environment.
description: This rule checks for any IAM service accounts that have permissions configured
  for guest users, which are typically external and not managed by the organization.
  To verify, review the IAM policy bindings for each service account and ensure no
  bindings include external or guest users. For remediation, remove any permissions
  granted to guest accounts and reassign them to appropriate internal users or groups.
  This helps maintain strict access control and reduces the attack surface.
references:
- https://cloud.google.com/iam/docs/service-accounts
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://cloud.google.com/iam/docs/understanding-service-accounts
