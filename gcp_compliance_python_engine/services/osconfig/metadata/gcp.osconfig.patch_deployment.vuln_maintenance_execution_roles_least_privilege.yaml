rule_id: gcp.osconfig.patch_deployment.vuln_maintenance_execution_roles_least_privilege
service: osconfig
resource: patch_deployment
requirement: Vuln Maintenance Execution Roles Least Privilege
scope: osconfig.patch_deployment.least_privilege
domain: identity_and_access_management
subcategory: authentication
severity: high
title: Ensure Least Privilege for Patch Deployment Roles
rationale: Properly scoped IAM roles prevent unauthorized access and modifications,
  minimizing the risk of privilege escalation and data breaches. Ensuring least privilege
  aligns with regulatory requirements such as ISO 27001 and PCI-DSS, reducing the
  attack surface and protecting sensitive workloads from potential exploitation during
  patch management operations.
description: This rule checks that IAM roles assigned for executing patch deployments
  in the osconfig service are minimized to the least privilege necessary. Verify that
  roles such as 'osconfig.patchDeploymentRunner' have only the permissions needed
  for their specific tasks without additional access rights. To remediate, review
  current IAM policies for patch deployment and adjust them to restrict access based
  on the principle of least privilege, removing unnecessary permissions and ensuring
  proper role assignment.
references:
- https://cloud.google.com/osconfig/docs
- https://cloud.google.com/iam/docs/understanding-roles
- https://cloud.google.com/security/compliance/pdf/cis-gcp-foundations-benchmark-v1.3.0.pdf
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://www.iso.org/iso-27001-information-security.html
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
