rule_id: gcp.apigateway.api.platform_endpoint_authz_policies_enforced
service: apigateway
resource: api
requirement: Platform Endpoint Authz Policies Enforced
scope: apigateway.api.security
domain: network_security_and_connectivity
subcategory: network_access_control
severity: low
title: Enforce Platform Endpoint Authz Policies for API Gateway
rationale: Enforcing authorization policies on API Gateway endpoints mitigates risks
  of unauthorized access and data breaches, which could lead to financial loss, reputational
  damage, and compliance violations. It is crucial for maintaining secure communication
  channels and protecting sensitive data flowing through APIs.
description: This rule checks whether authorization policies are enforced on all API
  Gateway platform endpoints. Specifically, it verifies that IAM roles and conditions
  are correctly configured to restrict access based on the principle of least privilege.
  To verify, review API Gateway configurations and ensure that appropriate authorization
  mechanisms, such as OAuth 2.0 or API keys, are implemented. Remediate by updating
  IAM policies to include necessary roles and conditions to enforce access control.
references:
- https://cloud.google.com/api-gateway/docs/authz
- https://cloud.google.com/security/compliance/cis-gcp-foundations-benchmark
- https://www.nist.gov/cyberframework
- https://cloud.google.com/security/best-practices
- https://cloud.google.com/iam/docs/overview
