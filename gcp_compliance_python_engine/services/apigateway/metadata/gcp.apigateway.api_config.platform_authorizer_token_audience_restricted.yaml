rule_id: gcp.apigateway.api_config.platform_authorizer_token_audience_restricted
service: apigateway
resource: api_config
requirement: Platform Authorizer Token Audience Restricted
scope: apigateway.api_config.security
domain: container_and_kubernetes_security
subcategory: security_monitoring
severity: low
title: Restrict API Gateway Token Audience for Security
rationale: Restricting the token audience for API Gateway's platform authorizer is
  crucial to prevent unauthorized access to APIs. An unrestricted audience can lead
  to token misuse, potentially allowing attackers to impersonate clients and access
  sensitive data. This practice supports compliance with security standards like PCI-DSS
  and SOC2, ensuring that only designated services can interact with your APIs.
description: This rule checks that the API Gateway configuration specifies a restricted
  token audience in the platform authorizer settings. This ensures that only authorized
  services can use the token to access the API. To verify, examine the API Gateway's
  configuration settings for 'audiences' under the 'authorizer' section. Remediation
  involves updating the API configuration to specify a limited set of audience values
  that match only intended client identifiers.
references:
- https://cloud.google.com/api-gateway/docs/authenticating-users
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/pci_security/
- https://trust.salesforce.com/en/compliance/soc-2/
- https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-53r4.pdf
- https://cloud.google.com/security/best-practices
