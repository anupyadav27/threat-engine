rule_id: gcp.apigateway.api_config.platform_stage_logging_enabled
service: apigateway
resource: api_config
requirement: Platform Stage Logging Enabled
scope: apigateway.api_config.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: medium
title: Ensure API Gateway Platform Stage Logging is Enabled
rationale: Enabling logging for API Gateway's platform stages is critical for tracking
  access patterns, identifying potential misuse, and ensuring compliance with data
  protection regulations. Without logging, organizations may be unaware of unauthorized
  access, leading to data breaches and non-compliance with frameworks like PCI-DSS
  and SOC2.
description: This rule checks that logging is enabled for all API Gateway platform
  stages in GCP. Logging provides visibility into request and response activities,
  which is essential for auditing and forensic investigations. To verify, ensure the
  'logConfig' setting is populated in the API Gateway configurations. Remediation
  involves configuring the API Gateway to send logs to a designated Cloud Logging
  sink, ensuring all platform stages are properly monitored.
references:
- https://cloud.google.com/api-gateway/docs/logging
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org
- https://cloud.google.com/security/compliance/soc-2
- https://cloud.google.com/logging/docs/setup
- https://cloud.google.com/security/compliance
