rule_id: gcp.apigateway.api.gateway_restapi_waf_acl_attached_configured
service: apigateway
resource: api
requirement: Gateway Restapi Waf ACL Attached Configured
scope: apigateway.api.security
domain: compliance_and_governance
subcategory: security_monitoring
severity: low
title: Ensure WAF Configured for API Gateway REST APIs
rationale: Configuring a Web Application Firewall (WAF) for API Gateway REST APIs
  is crucial for protecting against common web exploits and vulnerabilities such as
  SQL injection, cross-site scripting (XSS), and others. Without a WAF, APIs are vulnerable
  to attacks that can lead to data breaches, service interruptions, and non-compliance
  with security standards like PCI-DSS and NIST. Proper WAF configuration helps mitigate
  these risks and ensures that sensitive data is adequately protected from external
  threats.
description: This rule checks that a Web Application Firewall (WAF) is attached and
  properly configured for each API Gateway REST API. It involves verifying that the
  WAF policies are applied and that they align with security requirements to filter
  malicious traffic. To ensure compliance, review the WAF configuration in the GCP
  Console under API Gateway settings and confirm that the appropriate firewall rules
  are active. Remediation involves attaching a suitable WAF policy to the API Gateway
  and regularly updating the rules to respond to new threats.
references:
- https://cloud.google.com/api-gateway/docs/configure-waf
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/pci_security/
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://cloud.google.com/security/best-practices
- https://cloud.google.com/security/compliance
