rule_id: gcp.apigateway.api_config.platform_authorizer_cache_ttl_reasonable
service: apigateway
resource: api_config
requirement: Platform Authorizer Cache Ttl Reasonable
scope: apigateway.api_config.security
domain: compliance_and_governance
subcategory: security_monitoring
severity: low
title: Ensure Reasonable TTL for API Gateway Authorizer Cache
rationale: Setting a reasonable time-to-live (TTL) for the API Gateway authorizer
  cache helps balance security with performance. Short TTLs can lead to increased
  latency and higher costs due to frequent authorizer invocations, while overly long
  TTLs may allow outdated authorization data to persist, potentially exposing the
  API to unauthorized access. Ensuring an appropriate TTL supports compliance with
  security policies and reduces the risk of exposing sensitive data.
description: This rule checks if the TTL for the API Gateway authorizer cache is set
  to a reasonable duration. Verify the TTL setting in the api_config resource of the
  API Gateway service to ensure it aligns with security best practices, typically
  not exceeding 300 seconds. To remediate, adjust the TTL value in the API Gateway
  configuration to ensure it is neither too short, causing performance issues, nor
  too long, risking stale authorization data.
references:
- https://cloud.google.com/api-gateway/docs/using-api-gateway
- https://cloud.google.com/security/compliance/cis-gcp-foundations-benchmark
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://cloud.google.com/security/best-practices
