rule_id: gcp.apigateway.api.platform_endpoint_waf_attached
service: apigateway
resource: api
requirement: Platform Endpoint Waf Attached
scope: apigateway.api.security
domain: network_security_and_connectivity
subcategory: network_access_control
severity: low
title: Ensure WAF is Attached to API Gateway Endpoints
rationale: Attaching a Web Application Firewall (WAF) to API Gateway endpoints helps
  protect against common web exploits that could compromise application security,
  such as SQL injection and cross-site scripting (XSS). This is crucial for maintaining
  the integrity and availability of APIs, which are often critical components of business
  operations. Additionally, this can aid in compliance with regulatory standards that
  mandate the protection of sensitive data and the implementation of security controls.
description: This rule checks if a Web Application Firewall is attached to API Gateway
  endpoints to filter and monitor HTTP traffic. To verify, inspect the API Gateway
  configuration in the GCP Console to ensure a WAF policy is associated with the API.
  Remediation involves configuring a WAF policy using Google Cloud Armor and attaching
  it to the API Gateway. This setup helps mitigate risks from malicious traffic and
  enhances the security posture of your APIs.
references:
- https://cloud.google.com/api-gateway/docs
- https://cloud.google.com/armor/docs
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://www.pcisecuritystandards.org/pci_security/
