rule_id: gcp.apigateway.api.gateway_authorization_enabled
service: apigateway
resource: api
requirement: Gateway Authorization Enabled
scope: apigateway.api.authorization
domain: identity_and_access_management
subcategory: authentication
severity: medium
title: Ensure API Gateway Authorization is Enabled
rationale: Enabling authorization in GCP API Gateway is critical to ensure that only
  authenticated and authorized users can access API resources. This mitigates the
  risk of unauthorized data exposure and potential data breaches, aligning with regulatory
  requirements like PCI-DSS and HIPAA, which mandate secure access controls for sensitive
  data.
description: This rule checks if authorization is enabled for API Gateways in GCP.
  It verifies that an authorization configuration, such as a JWT token validation,
  is in place for APIs to prevent unauthorized access. To remediate, ensure that API
  Gateways are configured with appropriate authentication mechanisms like Google ID
  tokens or OAuth2. This can be done through the GCP Console by navigating to the
  API Gateway service, selecting the relevant API, and configuring the authorization
  settings under the 'Gateway' section.
references:
- https://cloud.google.com/api-gateway/docs/auth-overview
- https://cloud.google.com/security/compliance/cis#gcp
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
- https://cloud.google.com/security/best-practices/identity
