rule_id: gcp.apigateway.api.platform_endpoint_private_networking_enforced
service: apigateway
resource: api
requirement: Platform Endpoint Private Networking Enforced
scope: apigateway.api.network_security
domain: network_security_and_connectivity
subcategory: network_access_control
severity: medium
title: Enforce Private Networking for API Gateway Endpoints
rationale: Enforcing private networking for API Gateway endpoints protects sensitive
  data from exposure to the public internet, mitigating risks such as unauthorized
  access and data breaches. This control is crucial for maintaining data confidentiality
  and integrity, especially for organizations handling sensitive information subject
  to compliance requirements like PCI-DSS and HIPAA.
description: This rule checks that all API Gateway endpoints are configured to use
  private networking, ensuring they are only accessible within a VPC. To verify, inspect
  the API Gateway configuration to ensure the 'network' attribute is set to a valid
  VPC network. Remediation involves updating the API configuration to enforce private
  networking, which can be achieved by using the 'gcloud apigateway apis update' command
  with the appropriate network settings.
references:
- https://cloud.google.com/api-gateway/docs/network-security
- https://cloud.google.com/security/compliance/cis#gcp
- https://www.pcisecuritystandards.org/
- https://www.hipaajournal.com/
- https://cloud.google.com/blog/products/api-management/using-google-cloud-api-gateway-to-securely-manage-and-monitor-apis
