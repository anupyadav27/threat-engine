rule_id: gcp.apigateway.api.api_key_restrictions_verified
service: apigateway
resource: api
requirement: API Key Restrictions Verified
scope: apigateway.api.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure API Key Restrictions are Properly Configured
rationale: Unrestricted API keys pose significant risks as they can be easily exploited
  by malicious actors, leading to unauthorized access to sensitive data and services.
  Implementing API key restrictions minimizes the attack surface and aligns with regulatory
  requirements such as GDPR for protecting user data.
description: This rule checks whether API keys used in Google Cloud's API Gateway
  are configured with appropriate restrictions, such as IP address restrictions, application
  restrictions, and service restrictions. To verify, navigate to the API key settings
  in the Google Cloud Console and ensure that restrictions are applied. Remediate
  by editing the API key to add necessary restrictions, which helps prevent misuse
  and unauthorized access.
references:
- https://cloud.google.com/docs/authentication/api-keys#api_key_restrictions
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/security/best-practices
- https://cloud.google.com/architecture/security-best-practices
