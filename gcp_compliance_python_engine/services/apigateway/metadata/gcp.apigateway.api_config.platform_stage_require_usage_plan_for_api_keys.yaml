rule_id: gcp.apigateway.api_config.platform_stage_require_usage_plan_for_api_keys
service: apigateway
resource: api_config
requirement: Platform Stage Require Usage Plan For API Keys
scope: apigateway.api_config.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure Usage Plans for API Keys in API Gateway
rationale: Requiring usage plans for API keys is critical in managing API access,
  preventing abuse, and ensuring fair usage. Without enforcing usage plans, there's
  a higher risk of API misuse, leading to potential data breaches or service disruptions.
  This measure also aligns with compliance requirements for data protection and access
  control.
description: This rule checks that all API configurations in the API Gateway have
  usage plans associated with API keys. Usage plans define request quotas and rate
  limits, which are essential for controlling access to your APIs. To verify, review
  the API Gateway settings to ensure that all API keys are linked to a defined usage
  plan. Remediation involves creating or updating usage plans and associating them
  with the relevant API keys.
references:
- https://cloud.google.com/api-gateway/docs/quotas-overview
- https://cloud.google.com/api-gateway/docs/using-api-keys
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://www.iso.org/standard/54534.html
- https://cloud.google.com/security/compliance
