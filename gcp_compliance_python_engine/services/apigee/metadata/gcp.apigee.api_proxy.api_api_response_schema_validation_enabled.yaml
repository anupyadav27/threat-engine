rule_id: gcp.apigee.api_proxy.api_api_response_schema_validation_enabled
service: apigee
resource: api_proxy
requirement: API API Response Schema Validation Enabled
scope: apigee.api_proxy.security
domain: compliance_and_governance
subcategory: security_monitoring
severity: low
title: Ensure API Response Schema Validation is Enabled in Apigee
rationale: Enabling API response schema validation in Apigee ensures that the data
  returned by APIs conforms to the defined structure, reducing the risk of unexpected
  data exposure and ensuring data integrity. This helps maintain API reliability and
  trustworthiness while meeting compliance requirements related to data protection
  and privacy such as GDPR and CCPA.
description: This rule checks if response schema validation is enabled for API proxies
  in Apigee. API response schema validation helps in verifying that the response payloads
  match the expected schema definitions, preventing schema violations that could lead
  to data leakage or security vulnerabilities. To enable this, configure the `Response`
  policy with schema validation in the Apigee API proxy settings. Regular audits and
  updates to the schema definitions are recommended to adapt to new compliance standards.
references:
- https://cloud.google.com/apigee/docs/api-platform/fundamentals/security
- https://cloud.google.com/apigee/docs/api-platform/reference/policies/response-schema-validation
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.nist.gov/cyberframework
- https://cloud.google.com/security/compliance
- https://cloud.google.com/apigee/docs/api-platform/fundamentals/proxy-endpoints
