rule_id: gcp.apigee.api_proxy.api_api_content_type_whitelist_enforced
service: apigee
resource: api_proxy
requirement: API API Content Type Whitelist Enforced
scope: apigee.api_proxy.security
domain: compliance_and_governance
subcategory: security_monitoring
severity: low
title: Enforce API Proxy Content Type Whitelist in Apigee
rationale: Enforcing a content type whitelist for API proxies in Apigee helps mitigate
  security risks such as injection attacks, data breaches, and service misuse by ensuring
  only allowed content types are processed. This is crucial for maintaining data integrity,
  meeting compliance requirements, and protecting sensitive information from unauthorized
  access.
description: This rule checks if API proxies in Apigee have a content type whitelist
  enforced, ensuring that only predefined content types are accepted. To verify, inspect
  the API proxy configurations to ensure the 'Content-Type' header is validated against
  an approved list. To remediate, configure Apigee API proxies to include a 'Content-Type'
  validation policy that specifies allowed content types, thereby preventing the processing
  of potentially harmful or unexpected data.
references:
- https://cloud.google.com/apigee/docs/api-platform/security/secure-api-proxies
- https://cloud.google.com/security/compliance/cis-gcp-foundations-benchmark
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/apigee/docs/api-platform/reference/policies/json-threat-protection-policy
- https://cloud.google.com/apigee/docs/api-platform/reference/policies/xml-threat-protection-policy
