rule_id: gcp.apigee.environment.api_rate_limiting_api_usage_plan_required_for_api_keys
service: apigee
resource: environment
requirement: API Rate Limiting API Usage Plan Required For API Keys
scope: apigee.environment.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Enforce API Rate Limiting with Usage Plans for API Keys in Apigee
rationale: Implementing API rate limiting with usage plans is crucial to protect APIs
  from abuse and unexpected traffic spikes that could lead to degraded performance
  or denial of service. It also helps in managing costs and maintaining service quality
  by controlling the consumption of API resources. Regulatory frameworks like PCI-DSS
  require mechanisms to prevent excessive user activity that could compromise system
  integrity.
description: This rule checks if API rate limiting is enforced for API keys through
  usage plans in Apigee environments. Without usage plans, API keys might allow unregulated
  access, leading to potential service disruptions and security incidents. To verify,
  ensure that all APIs associated with API keys have a corresponding usage plan that
  defines limits. Remediation involves creating or updating usage plans to include
  specific rate limits for APIs accessed via API keys.
references:
- https://cloud.google.com/apigee/docs/api-platform/reference/policies/quota-policy
- https://cloud.google.com/apigee/docs/api-platform/security/api-security-best-practices
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://cloud.google.com/security/compliance
- https://cloud.google.com/apigee/docs/api-platform/antipatterns/rate-limiting
