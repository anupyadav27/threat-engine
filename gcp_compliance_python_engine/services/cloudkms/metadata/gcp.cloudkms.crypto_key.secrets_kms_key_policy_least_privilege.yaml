rule_id: gcp.cloudkms.crypto_key.secrets_kms_key_policy_least_privilege
service: cloudkms
resource: crypto_key
requirement: Secrets KMS Key Policy Least Privilege
scope: cloudkms.crypto_key.policy_management
domain: secrets_and_key_management
subcategory: key_management
severity: high
title: Ensure KMS Key Policies Enforce Least Privilege Access
rationale: Applying least privilege principles to KMS key policies is crucial to minimize
  unauthorized access and potential data breaches. Overly permissive key policies
  can lead to misuse of encryption keys, resulting in exposure of sensitive data and
  non-compliance with regulations like GDPR and PCI-DSS. Ensuring restrictive access
  helps maintain data confidentiality and integrity, reducing potential attack vectors.
description: This rule checks that Cloud KMS key policies grant only the necessary
  permissions to intended users or service accounts. Review and adjust the IAM policies
  associated with your KMS keys to ensure they follow the principle of least privilege.
  Audit the roles assigned to each key and remove any excessive permissions. Use the
  GCP Console or CLI to examine IAM policy bindings and update configurations to align
  with best practices.
references:
- https://cloud.google.com/kms/docs/resource-hierarchy-access-control
- https://www.cisecurity.org/controls/cis-google-cloud-computing-foundations-benchmark-v1-2-0
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://cloud.google.com/iam/docs/understanding-roles
