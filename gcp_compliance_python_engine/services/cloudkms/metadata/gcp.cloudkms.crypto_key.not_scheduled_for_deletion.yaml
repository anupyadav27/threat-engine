rule_id: gcp.cloudkms.crypto_key.not_scheduled_for_deletion
service: cloudkms
resource: crypto_key
requirement: Not Scheduled For Deletion
scope: cloudkms.crypto_key.security
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: medium
title: Ensure GCP KMS Keys Are Not Scheduled for Deletion
rationale: Preventing KMS keys from being scheduled for deletion is critical to maintaining
  data integrity and availability. If a key is deleted, any data encrypted with that
  key becomes irretrievable, which can lead to data loss and business disruption.
  Moreover, unnecessary deletion of encryption keys can breach compliance requirements
  in frameworks like PCI-DSS and HIPAA that mandate data protection and retention.
description: This rule checks for Google Cloud KMS keys that are scheduled for deletion
  to ensure they remain available for decrypting data. To verify this, inspect the
  key's lifecycle state using the Cloud Console or gcloud CLI. Remediation involves
  canceling the deletion operation if the key is scheduled for deletion by using the
  'gcloud kms keys cancel-deletion' command. Ensure key management policies include
  regular audits to prevent accidental deletion.
references:
- https://cloud.google.com/kms/docs/key-states#key_scheduled_for_deletion
- https://cloud.google.com/security/compliance/cis-gcp-benchmark
- https://cloud.google.com/security/compliance
- https://cloud.google.com/kms/docs/best-practices
