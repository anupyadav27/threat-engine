rule_id: gcp.cloudkms.crypto_key.secrets_kms_key_not_publicly_accessible
service: cloudkms
resource: crypto_key
requirement: Secrets KMS Key Not Publicly Accessible
scope: cloudkms.crypto_key.public_access
domain: secrets_and_key_management
subcategory: key_management
severity: critical
title: Ensure KMS Keys Are Not Publicly Accessible
rationale: Publicly accessible KMS keys pose a severe risk as they can be exploited
  by malicious actors to access sensitive data. Unauthorized access to keys can lead
  to data breaches and non-compliance with standards like PCI-DSS and HIPAA, resulting
  in legal and financial repercussions. Ensuring keys are private protects against
  these threats and maintains trust.
description: This rule checks that KMS keys used for encrypting secrets are not publicly
  accessible. Public access should be disabled by configuring IAM policies to restrict
  permissions to only trusted users and services. Verify key access policies via the
  GCP Console or gcloud CLI, and remove any public bindings. Restrict access using
  the principle of least privilege to prevent unauthorized access.
references:
- https://cloud.google.com/kms/docs/securing-keys
- https://cloud.google.com/kms/docs/iam
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.hipaajournal.com/hipaa-encryption-requirements
- https://cloud.google.com/security/compliance
