rule_id: gcp.cloudkms.crypto_key.privacy_encryption_at_rest_cmek_enabled
service: cloudkms
resource: crypto_key
requirement: Privacy Encryption At Rest Cmek Enabled
scope: cloudkms.crypto_key.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure CMEK is Enabled for KMS Encryption at Rest
rationale: Using Customer-Managed Encryption Keys (CMEK) for encrypting data at rest
  in Google Cloud's Key Management Service (KMS) enhances control over cryptographic
  operations and key lifecycle management. This reduces the risk of unauthorized access
  to sensitive data and ensures compliance with stringent data protection regulations
  such as GDPR and HIPAA. Without CMEK, organizations may face increased risk of data
  breaches and non-compliance penalties.
description: This rule verifies that all KMS crypto keys are configured to use Customer-Managed
  Encryption Keys (CMEK) for encryption at rest. It checks the key configuration settings
  to ensure that CMEK is enabled and properly managed. To remediate, ensure that all
  crypto keys are created or updated with CMEK settings via the Cloud Console or gcloud
  CLI by specifying a user-managed key ring and key. Regular audits should be conducted
  to maintain compliance and security posture.
references:
- https://cloud.google.com/kms/docs/cmek
- https://cloud.google.com/architecture/compliance/gdpr
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/encryption-at-rest/default-encryption
- https://cloud.google.com/kms/docs/creating-keys
- https://cloud.google.com/security/compliance
