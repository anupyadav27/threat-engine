rule_id: gcp.cloudkms.crypto_key.project_no_secrets_in_variables_gcp_cloud_build_proj_logging
service: cloudkms
resource: crypto_key
requirement: Project No Secrets In Variables Gcp Cloud Build Proj Logging
scope: cloudkms.crypto_key.logging
domain: secrets_and_key_management
subcategory: key_management
severity: high
title: Prevent Secrets in Cloud Build Variables and Enable Logging
rationale: Inadvertently storing secrets in Cloud Build environment variables can
  lead to unauthorized access to sensitive information, posing a significant security
  risk. Such exposure can result in data breaches, non-compliance with regulations
  like PCI-DSS and HIPAA, and reputational damage. Effective logging ensures that
  access and modifications to keys are monitored, providing an audit trail for compliance
  and forensic investigations.
description: This rule checks that no sensitive secrets are stored in the environment
  variables of Cloud Build projects and that logging is enabled for cryptographic
  key activities. Verify that Cloud Build configuration files do not contain hardcoded
  secrets. Instead, use Google Cloud's Secret Manager. Ensure Cloud KMS key logging
  is enabled in Cloud Audit Logs to track access and usage. To remediate, audit Cloud
  Build project configurations, use Secret Manager for sensitive data, and configure
  logging in the Google Cloud Console under 'Logging' to monitor key usage.
references:
- https://cloud.google.com/build/docs/securing-builds/store-secrets
- https://cloud.google.com/kms/docs/logging
- https://cloud.google.com/security/compliance/pci-dss
- https://cloud.google.com/security/compliance/hipaa
- https://cloud.google.com/security/compliance/soc-2
- https://www.iso.org/iso-27001-information-security.html
