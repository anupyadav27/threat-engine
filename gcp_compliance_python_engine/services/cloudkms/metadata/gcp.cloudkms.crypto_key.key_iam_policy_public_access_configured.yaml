rule_id: gcp.cloudkms.crypto_key.key_iam_policy_public_access_configured
service: cloudkms
resource: crypto_key
requirement: Key IAM Policy Public Access Configured
scope: cloudkms.crypto_key.public_access
domain: identity_and_access_management
subcategory: authentication
severity: critical
title: Prevent Public Access to Cloud KMS Crypto Keys
rationale: Allowing public access to Cloud KMS crypto keys poses significant security
  risks, including unauthorized data decryption and potential data breaches. Such
  access violates best practices and compliance standards like PCI-DSS and ISO 27001,
  which mandate strict control over cryptographic keys to safeguard sensitive data.
  Misconfigured access can lead to financial losses and damage to organizational reputation.
description: This rule checks for configurations that grant public access to Cloud
  KMS crypto keys by reviewing IAM policies attached to the keys. A key that is publicly
  accessible can be exploited by unauthorized users, leading to potential data exposure.
  To remediate, ensure no IAM policy grants 'allUsers' or 'allAuthenticatedUsers'
  roles that allow access to the crypto key. Regularly audit key permissions using
  the GCP Console or gcloud command-line tool to maintain strict access controls.
references:
- https://cloud.google.com/kms/docs/iam
- https://cloud.google.com/security/compliance/cis-gcp-benchmark
- https://www.pcisecuritystandards.org/pci_security/
- https://www.iso.org/iso-27001-information-security.html
- https://cloud.google.com/kms/docs/securing
- https://cloud.google.com/iam/docs/understanding-roles
