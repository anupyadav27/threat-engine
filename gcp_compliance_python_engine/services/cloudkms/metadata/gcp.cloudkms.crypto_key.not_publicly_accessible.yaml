rule_id: gcp.cloudkms.crypto_key.not_publicly_accessible
service: cloudkms
resource: crypto_key
requirement: Not Publicly Accessible
scope: cloudkms.crypto_key.public_access
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: critical
title: Ensure KMS Crypto Keys Are Not Publicly Accessible
rationale: Publicly accessible KMS crypto keys pose a significant risk as unauthorized
  access could lead to data breaches, compromising sensitive information and violating
  data protection regulations. Ensuring these keys are not publicly accessible protects
  against unauthorized decryption of critical data and aligns with compliance requirements
  such as PCI-DSS and HIPAA.
description: This rule checks the IAM policies associated with KMS crypto keys to
  ensure that no public access is granted. Verify that no 'allUsers' or 'allAuthenticatedUsers'
  entries exist in the key's IAM policy. To remediate, review the IAM policy of each
  crypto key and remove any public access entries. Implement principle of least privilege
  by granting access only to necessary users or service accounts.
references:
- https://cloud.google.com/kms/docs/iam
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://www.pcisecuritystandards.org/
- https://www.hhs.gov/hipaa/index.html
- https://cloud.google.com/security/overview/whitepaper
