rule_id: gcp.cloudkms.crypto_key.secrets_kms_key_deletion_requires_waiting_period
service: cloudkms
resource: crypto_key
requirement: Secrets KMS Key Deletion Requires Waiting Period
scope: cloudkms.crypto_key.security
domain: secrets_and_key_management
subcategory: key_management
severity: high
title: Require Waiting Period for KMS Key Deletion
rationale: Enforcing a waiting period for KMS key deletion prevents accidental or
  malicious data loss by allowing time to recover keys before permanent deletion.
  This reduces the risk of data breaches associated with lost encryption keys and
  complies with security standards that mandate data protection and integrity. Implementing
  this control aids in meeting regulatory requirements such as GDPR and PCI-DSS which
  emphasize data confidentiality and availability.
description: This rule checks if a waiting period is configured for the deletion of
  Cloud KMS keys used to encrypt secrets. Specifically, it ensures that a minimum
  waiting period of 7 days is enforced, allowing sufficient time to recover keys if
  a deletion request was made in error. Verification can be done by reviewing the
  key lifecycle settings in the Google Cloud Console or using the Google Cloud SDK.
  Remediation involves setting a 'deleteProtection' attribute on the crypto key to
  true, ensuring a waiting period is enforced before deletion.
references:
- https://cloud.google.com/kms/docs/key-rotation
- CIS Google Cloud Platform Foundation Benchmark v1.3.0, 4.3
- https://www.nist.gov/publications/nist-special-publication-800-57-part-1-revision-5
- https://cloud.google.com/security/compliance/gdpr
