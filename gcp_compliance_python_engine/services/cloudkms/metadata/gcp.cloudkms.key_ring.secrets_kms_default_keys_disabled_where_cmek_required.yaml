rule_id: gcp.cloudkms.key_ring.secrets_kms_default_keys_disabled_where_cmek_required
service: cloudkms
resource: key_ring
requirement: Secrets KMS Default Keys Disabled Where Cmek Required
scope: cloudkms.key_ring.security
domain: secrets_and_key_management
subcategory: key_management
severity: high
title: Disable Default KMS Keys for Secrets When CMEK is Required
rationale: Using default KMS keys for secrets management can expose your organization
  to potential data breaches, as these keys are not sufficiently isolated and may
  not meet compliance requirements for data encryption. By disabling default keys
  where Customer-Managed Encryption Keys (CMEK) are required, you ensure that sensitive
  data is protected with stronger, customer-controlled encryption, reducing the risk
  of unauthorized access and aligning with regulatory standards.
description: This rule checks that default KMS keys are disabled for managing secrets
  in environments where Customer-Managed Encryption Keys (CMEK) are mandated. Organizations
  should configure their key rings to use CMEK instead of default Google-managed keys
  to maintain full control over encryption keys and compliance. Verify this by checking
  the key ring configuration settings in Cloud KMS and ensure that only CMEK are used.
  To remediate, update your Cloud KMS settings to disable default keys and configure
  CMEK usage as per your security policy.
references:
- https://cloud.google.com/kms/docs/cmek
- https://cloud.google.com/security/compliance/cis-gcp-foundations-benchmark
- https://www.iso.org/isoiec-27001-information-security.html
- https://cloud.google.com/security/compliance/nist
- https://cloud.google.com/security/compliance/pci-dss
- https://cloud.google.com/security/compliance/hipaa
