rule_id: gcp.appengine.application.paas_app_env_secrets_from_vault_only
service: appengine
resource: application
requirement: Paas App Env Secrets From Vault Only
scope: appengine.application.security
domain: secrets_and_key_management
subcategory: key_management
severity: high
title: Ensure App Engine Uses Vault for Environment Secrets
rationale: Storing application secrets directly within code or environment variables
  poses a significant security risk, including unauthorized access and data breaches.
  Using a centralized secret management solution like Google Cloud Secret Manager
  ensures that secrets are securely stored, accessed, and audited, aligning with compliance
  standards such as PCI-DSS and ISO 27001.
description: This rule checks that all environment secrets used in Google App Engine
  applications are sourced exclusively from Google Cloud Secret Manager. Verify that
  applications access secrets via the Secret Manager API and do not hardcode them
  in configuration files or environment variables. To remediate, refactor applications
  to retrieve secrets using the Secret Manager client library and update deployment
  procedures to remove sensitive information from environment settings.
references:
- https://cloud.google.com/secret-manager/docs
- https://cloud.google.com/security/compliance
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/appengine/docs/security
- https://cloud.google.com/iam/docs/understanding-service-accounts
- https://cloud.google.com/kms/docs/secrets
