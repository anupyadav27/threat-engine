rule_id: gcp.logging.log.metric_custom_role_changes_alerts_enabled
service: logging
resource: log
requirement: Metric Custom Role Changes Alerts Enabled
scope: logging.log.security
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: low
title: Enable Alerts for GCP Custom Role Changes
rationale: Monitoring changes to custom roles is critical as it helps detect unauthorized
  or malicious modifications that could lead to privilege escalation and potential
  data breaches. Ensuring alerts for these changes helps organizations maintain control
  over access management and comply with regulatory requirements such as PCI-DSS and
  ISO 27001, which mandate strict access controls.
description: This rule verifies that alerts are configured for changes to custom IAM
  roles in GCP. It checks if log-based metrics are set up to trigger alerts when modifications
  to these roles occur. To ensure compliance, create a log-based metric on custom
  role changes in Cloud Logging and set up an alerting policy in Cloud Monitoring
  to notify security teams of any changes. This setup provides real-time awareness
  of potential security risks associated with IAM role modifications.
references:
- https://cloud.google.com/logging/docs/logs-based-metrics
- https://cloud.google.com/monitoring/alerts
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform/
- https://cloud.google.com/security/compliance
- https://cloud.google.com/iam/docs/understanding-custom-roles
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
