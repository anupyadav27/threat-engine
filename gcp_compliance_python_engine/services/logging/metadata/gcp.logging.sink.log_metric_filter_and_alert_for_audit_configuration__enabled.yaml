rule_id: gcp.logging.sink.log_metric_filter_and_alert_for_audit_configuration__enabled
service: logging
resource: sink
requirement: Log Metric Filter And Alert For Audit Configuration Enabled
scope: logging.sink.logging
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: medium
title: Enable Log Metric Filter and Alert for Audit Config Changes
rationale: Monitoring audit configuration changes is crucial for ensuring the integrity
  and accountability of logging practices in GCP. Unauthorized or unmonitored changes
  can lead to loss of critical security data, impacting compliance with standards
  like PCI-DSS and SOC2. This rule helps detect and respond promptly to potential
  misconfigurations or malicious activities.
description: This rule checks if a log metric filter and alert is configured for audit
  configuration changes in GCP. By setting up a filter for 'auditConfig' changes within
  the logging sink, you can ensure that any alterations to logging configurations
  are captured and alerted upon. Verify this by checking the existence of a metric
  filter for 'protoPayload.methodName="SetIamPolicy"' and configure alerts to notify
  security teams of any changes. To remediate, create a log metric for these changes
  and set up an alerting policy in GCP Monitoring.
references:
- https://cloud.google.com/logging/docs/audit/configure-data-access
- https://cloud.google.com/monitoring/alerts
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://cloud.google.com/iam/docs/audit-logging
- https://cloud.google.com/logging/docs/view/logging-query-language
