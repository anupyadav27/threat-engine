rule_id: gcp.logging.sink.stream_encryption_at_rest_enabled
service: logging
resource: sink
requirement: Stream Encryption At Rest Enabled
scope: logging.sink.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure Logging Sink Encryption At Rest is Enabled
rationale: Enabling encryption at rest for logging sinks protects sensitive data from
  unauthorized access and potential breaches, ensuring compliance with regulatory
  requirements such as PCI-DSS and HIPAA. Without encryption, sensitive log data could
  be exposed, leading to data leaks, reputational damage, and financial penalties.
description: This rule checks that all logging sinks in your GCP environment have
  encryption at rest enabled. This ensures that the data written to any storage destination
  is encrypted using Google-managed or customer-managed encryption keys. To verify,
  inspect the logging sink configurations for the 'writerIdentity' field and ensure
  it is set to use an appropriate key. Remediate by enabling Cloud KMS for managing
  encryption keys and updating sink configurations accordingly.
references:
- https://cloud.google.com/logging/docs/export/configure_export_v2
- https://cloud.google.com/security/compliance/cis#gcp_cis_v1.3_2.8
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
- https://cloud.google.com/security/encryption-at-rest/default-encryption
- https://cloud.google.com/kms/docs
