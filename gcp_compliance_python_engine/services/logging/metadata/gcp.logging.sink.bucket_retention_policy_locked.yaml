rule_id: gcp.logging.sink.bucket_retention_policy_locked
service: logging
resource: sink
requirement: Bucket Retention Policy Locked
scope: logging.sink.policy_management
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: low
title: Ensure Bucket Retention Policy is Locked for Logging Sinks
rationale: Locking the bucket retention policy for logging sinks ensures that log
  data is retained for the required period, protecting against accidental or malicious
  deletion. This is crucial for forensic analysis, compliance with data retention
  laws, and maintaining audit trails crucial for security investigations and regulatory
  requirements.
description: This rule checks if the retention policy for buckets used by logging
  sinks is locked, preventing changes to the retention period. To verify, ensure that
  the 'isLocked' property of the bucket's retention policy is set to true. Remediation
  involves updating the bucket's IAM policy to lock the retention, ensuring it cannot
  be reduced or removed, thus preserving the integrity of the log data.
references:
- https://cloud.google.com/logging/docs/best-practices
- https://cloud.google.com/storage/docs/bucket-lock
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final
- https://cloud.google.com/security/compliance
- https://cloud.google.com/iam/docs/overview
