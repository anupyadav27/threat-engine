rule_id: gcp.logging.sink.kms_encryption_enabled
service: logging
resource: sink
requirement: KMS Encryption Enabled
scope: logging.sink.encryption
domain: data_protection_and_privacy
subcategory: encryption_at_rest
severity: high
title: Ensure KMS Encryption is Enabled for Logging Sinks
rationale: Enabling KMS encryption for logging sinks is crucial to protect sensitive
  log data at rest. This prevents unauthorized access and tampering, mitigates the
  risk of data breaches, and ensures compliance with data protection laws such as
  GDPR and CCPA. It also aligns with security best practices and industry standards,
  reducing potential financial and reputational harm.
description: This rule checks that Cloud Logging sinks have CMEK (Customer-Managed
  Encryption Keys) enabled. To verify, ensure that each logging sink is configured
  with a KMS key by reviewing the 'destination' and 'filter' fields in the sink configuration.
  Remediation involves updating or creating a sink to specify a KMS key for encryption
  in the 'kmsKeyName' parameter. This enhances the security of log data by leveraging
  GCP's encryption capabilities.
references:
- https://cloud.google.com/logging/docs/export/configure_storage
- CIS Google Cloud Computing Foundations Benchmark v1.3.0 - 7.1
- https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final
- https://cloud.google.com/security/encryption-at-rest/default-encryption
- https://cloud.google.com/kms/docs/encrypt-decrypt
