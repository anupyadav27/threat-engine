rule_id: gcp.logging.log.metric_filter_alerts_vpc_changes
service: logging
resource: log
requirement: Metric Filter Alerts VPC Changes
scope: logging.log.security
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: low
title: Monitor VPC Configuration Changes via Log Metric Alerts
rationale: Monitoring VPC configuration changes is crucial for identifying unauthorized
  network access or potential security breaches. Without alerts on such changes, organizations
  risk exposure to network misconfigurations that can lead to data leaks or compliance
  violations. Ensuring visibility into these changes supports compliance with standards
  like PCI-DSS and NIST, which require robust logging and monitoring of network activities.
description: This rule ensures that a log metric filter is set up to monitor and alert
  on changes to the Virtual Private Cloud (VPC) configurations in GCP. Specifically,
  it checks for the presence of a metric filter that captures operations such as creation,
  deletion, and modification of VPC resources within Cloud Logging. To verify, navigate
  to the 'Logs-based metrics' page in GCP Logging, and confirm the presence of a metric
  filter with conditions for VPC changes. Remediation involves creating a logs-based
  metric and setting up an alerting policy to notify security teams of any unauthorized
  or suspicious VPC changes.
references:
- https://cloud.google.com/logging/docs/logs-based-metrics
- https://cloud.google.com/vpc/docs
- https://www.cisecurity.org/benchmark/google_cloud_computing_platform
- https://cloud.google.com/security/compliance
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
