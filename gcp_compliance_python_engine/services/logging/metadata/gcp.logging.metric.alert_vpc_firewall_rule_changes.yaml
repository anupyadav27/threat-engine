rule_id: gcp.logging.metric.alert_vpc_firewall_rule_changes
service: logging
resource: metric
requirement: Alert VPC Firewall Rule Changes
scope: logging.metric.network_security
domain: logging_monitoring_and_alerting
subcategory: audit_logging
severity: medium
title: Alert on VPC Firewall Rule Modifications
rationale: Monitoring changes to VPC firewall rules is critical as unauthorized alterations
  can expose sensitive data to unauthorized access and compromise network integrity.
  Such changes can lead to data breaches or service disruptions, violating compliance
  requirements like PCI-DSS and ISO 27001, which mandate strict access controls and
  monitoring.
description: This rule checks for modifications in VPC firewall rules by leveraging
  Google Cloud's Logging service to create a metric filter that triggers alerts on
  any detected changes. Administrators should configure this alert to notify security
  teams of any rule alterations, enabling immediate investigation and response. Ensure
  the metric is properly set up in the Logs Explorer, and verify alerting configurations
  are active and tested. Remediation involves reviewing the change, reverting unauthorized
  modifications, and updating access controls as needed.
references:
- https://cloud.google.com/logging/docs/logs-based-metrics
- https://cloud.google.com/firewalls/docs/rules-overview
- https://cloud.google.com/security/compliance/pci-dss
- https://cloud.google.com/security/compliance/iso-27001
- https://cloud.google.com/iam/docs/audit-logging
- https://cloud.google.com/security/best-practices
