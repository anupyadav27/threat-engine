{
  "service": "ecr",
  "fixes": [
    {
      "rule_id": "ecr_replication_status",
      "suggested_check": {
        "var": "imageStatus",
        "op": "equals",
        "value": "replicated",
        "derived": "is_public",
        "derive_key": "aws.ecr.replication_status.is_public"
      },
      "suggested_aliases": {
        "entity_aliases": {
          "replication_status_status": "replicationStatus"
        },
        "param_aliases": {
          "param": [
            "status"
          ]
        }
      },
      "confidence": 0.85,
      "reason": "The imageStatus directly correlates with the replication status indicating whether the image has been successfully replicated."
    },
    {
      "rule_id": "ecr_signing_status",
      "suggested_check": {
        "var": "imageScanStatus",
        "op": "equals",
        "value": "signed",
        "derived": "has_findings",
        "derive_key": "aws.ecr.signing_status.has_findings"
      },
      "suggested_aliases": {
        "entity_aliases": {
          "signing_status_status": "signingStatus"
        },
        "param_aliases": {
          "param": [
            "status"
          ]
        }
      },
      "confidence": 0.9,
      "reason": "The imageScanStatus can indicate the signing status of the image, particularly if it has been scanned and signed."
    },
    {
      "rule_id": "ecr_lifecycle_policy_preview",
      "suggested_check": {
        "var": "lifecyclePolicy",
        "op": "equals",
        "value": "active",
        "derived": "imageScanningConfiguration",
        "derive_key": "aws.ecr.lifecycle_policy_preview.imageScanningConfiguration"
      },
      "suggested_aliases": {
        "entity_aliases": {
          "lifecycle_policy_preview_status": "lifecyclePolicyPreview"
        },
        "param_aliases": {
          "param": [
            "status"
          ]
        }
      },
      "confidence": 0.88,
      "reason": "The lifecyclePolicy can indicate the status of the lifecycle policy preview, especially if it is active."
    },
    {
      "type": "llm_fix",
      "original": "ecr_replication_status",
      "fix": {
        "var": "imageStatus",
        "op": "equals",
        "value": "replicated",
        "derived": "replication_status",
        "derive_key": "aws.ecr.replication_status"
      },
      "confidence": 0.85,
      "reason": "The imageStatus variable directly relates to the replication status of images in ECR.",
      "aliases": {
        "entity_aliases": {
          "replication_status_status": "replication_status"
        },
        "param_aliases": {
          "param": [
            "status"
          ]
        }
      }
    },
    {
      "type": "llm_fix",
      "original": "ecr_signing_status",
      "fix": {
        "var": "imageScanStatus",
        "op": "equals",
        "value": "signed",
        "derived": "signing_status",
        "derive_key": "aws.ecr.signing_status"
      },
      "confidence": 0.9,
      "reason": "The imageScanStatus variable indicates whether the image is signed, which aligns with the signing status.",
      "aliases": {
        "entity_aliases": {
          "signing_status_status": "signing_status"
        },
        "param_aliases": {
          "param": [
            "status"
          ]
        }
      }
    },
    {
      "type": "llm_fix",
      "original": "ecr_lifecycle_policy_preview",
      "fix": {
        "var": "lifecyclePolicy",
        "op": "equals",
        "value": "preview",
        "derived": "lifecycle_policy_preview_status",
        "derive_key": "aws.ecr.lifecycle_policy_preview"
      },
      "confidence": 0.8,
      "reason": "The lifecyclePolicy variable can indicate the status of lifecycle policy previews.",
      "aliases": {
        "entity_aliases": {
          "lifecycle_policy_preview_status": "lifecycle_policy_preview"
        },
        "param_aliases": {
          "param": [
            "status"
          ]
        }
      }
    }
  ],
  "summary": {
    "total_fixes": 6,
    "remaining_unresolved": 4
  }
}