{
  "identity_access.authentication": {
    "core": [
      {
        "service": "azuread",
        "resource": "identity.user",
        "adapter": "azure.azuread.user_mfa_status",
        "not_applicable_when": "no_azure_ad_users",
        "resource_type": "identity.user"
      },
      {
        "service": "azuread",
        "resource": "identity.user",
        "adapter": "azure.azuread.password_policy",
        "not_applicable_when": "no_azure_ad_users",
        "resource_type": "identity.user"
      },
      {
        "service": "azuread",
        "resource": "identity.tenant",
        "adapter": "azure.azuread.security_defaults",
        "not_applicable_when": "no_privileged_users",
        "resource_type": "identity.user"
      },
      {
        "service": "azuread",
        "resource": "identity.user",
        "adapter": "azure.azuread.legacy_authentication_blocked",
        "not_applicable_when": "no_azure_ad_configured",
        "resource_type": "identity.user"
      },
      {
        "service": "azuread",
        "resource": "identity.user",
        "adapter": "azure.azuread.self_service_password_reset",
        "not_applicable_when": "no_azure_ad_users",
        "resource_type": "identity.user"
      },
      {
        "service": "azuread",
        "resource": "identity.user",
        "adapter": "azure.azuread.authentication_methods",
        "not_applicable_when": "no_azure_ad_users",
        "resource_type": "identity.user"
      }
    ],
    "exhaustive": [
      {
        "service": "azuread",
        "resource": "identity.user",
        "adapter": "azure.azuread.microsoft_authenticator",
        "not_applicable_when": "no_azure_ad_users",
        "resource_type": "identity.user"
      },
      {
        "service": "azuread",
        "resource": "identity.user",
        "adapter": "azure.azuread.fido2_authentication",
        "not_applicable_when": "no_azure_ad_users",
        "resource_type": "identity.user"
      },
      {
        "service": "azuread",
        "resource": "identity.user",
        "adapter": "azure.azuread.phone_authentication",
        "not_applicable_when": "no_azure_ad_users",
        "resource_type": "identity.user"
      },
      {
        "service": "azuread",
        "resource": "identity.user",
        "adapter": "azure.azuread.email_authentication",
        "not_applicable_when": "no_azure_ad_users",
        "resource_type": "identity.user"
      }
    ]
  },
  "identity_access.authorization": {
    "core": [
      {
        "service": "azuread",
        "resource": "rbac.role",
        "adapter": "azure.azuread.role_definitions",
        "not_applicable_when": "no_azure_ad_roles",
        "resource_type": "rbac.role"
      },
      {
        "service": "azuread",
        "resource": "rbac.policy",
        "adapter": "azure.azuread.conditional_access_policies",
        "not_applicable_when": "no_azure_ad_configured",
        "resource_type": "rbac.policy"
      }
    ],
    "extended": [
      {
        "service": "azuread",
        "resource": "rbac.policy",
        "adapter": "azure.azuread.app_consent_policies",
        "not_applicable_when": "no_azure_ad_configured",
        "resource_type": "rbac.policy"
      },
      {
        "service": "azuread",
        "resource": "rbac.group",
        "adapter": "azure.azuread.group_membership_policies",
        "not_applicable_when": "no_azure_ad_groups",
        "resource_type": "rbac.group"
      },
      {
        "service": "azuread",
        "resource": "rbac.role",
        "adapter": "azure.azuread.privileged_identity_management",
        "not_applicable_when": "no_pim_configured",
        "resource_type": "rbac.role"
      },
      {
        "service": "azuread",
        "resource": "identity.application",
        "adapter": "azure.azuread.app_registrations_policies",
        "not_applicable_when": "no_app_registrations",
        "resource_type": "identity.application"
      }
    ],
    "exhaustive": [
      {
        "service": "azuread",
        "resource": "rbac.role",
        "adapter": "azure.azuread.custom_role_permissions",
        "not_applicable_when": "no_custom_roles",
        "resource_type": "rbac.role"
      },
      {
        "service": "azuread",
        "resource": "rbac.policy",
        "adapter": "azure.azuread.risk_based_conditional_access",
        "not_applicable_when": "no_conditional_access",
        "resource_type": "rbac.policy"
      },
      {
        "service": "azuread",
        "resource": "rbac.policy",
        "adapter": "azure.azuread.device_based_conditional_access",
        "not_applicable_when": "no_conditional_access",
        "resource_type": "rbac.policy"
      },
      {
        "service": "azuread",
        "resource": "identity.tenant",
        "adapter": "azure.azuread.emergency_access_accounts",
        "not_applicable_when": "no_azure_ad_tenant",
        "resource_type": "identity.tenant"
      },
      {
        "service": "azuread",
        "resource": "identity.service_principal",
        "adapter": "azure.azuread.service_principal_secret_expiry",
        "not_applicable_when": "no_service_principals",
        "resource_type": "identity.service_principal"
      }
    ]
  },
  "identity_access.federation": {
    "core": [
      {
        "service": "azuread",
        "resource": "identity.tenant",
        "adapter": "azure.azuread.external_identity_providers",
        "not_applicable_when": "no_external_identity_providers",
        "resource_type": "identity.tenant"
      }
    ],
    "extended": [
      {
        "service": "azuread",
        "resource": "identity.tenant",
        "adapter": "azure.azuread.saml_identity_providers",
        "not_applicable_when": "no_saml_providers",
        "resource_type": "identity.tenant"
      },
      {
        "service": "azuread",
        "resource": "identity.tenant",
        "adapter": "azure.azuread.oidc_identity_providers",
        "not_applicable_when": "no_oidc_providers",
        "resource_type": "identity.tenant"
      }
    ],
    "exhaustive": [
      {
        "service": "azuread",
        "resource": "identity.tenant",
        "adapter": "azure.azuread.b2b_guest_settings",
        "not_applicable_when": "no_b2b_configured",
        "resource_type": "identity.tenant"
      },
      {
        "service": "azuread",
        "resource": "identity.tenant",
        "adapter": "azure.azuread.cross_tenant_access_settings",
        "not_applicable_when": "no_cross_tenant_access",
        "resource_type": "identity.tenant"
      }
    ]
  },
  "identity_access.mfa": {
    "core": [
      {
        "service": "azuread",
        "resource": "identity.user",
        "adapter": "azure.azuread.mfa_registration",
        "not_applicable_when": "no_azure_ad_users",
        "resource_type": "identity.user"
      },
      {
        "service": "azuread",
        "resource": "identity.tenant",
        "adapter": "azure.azuread.mfa_policy",
        "not_applicable_when": "no_azure_ad_tenant",
        "resource_type": "identity.tenant"
      }
    ],
    "extended": [
      {
        "service": "azuread",
        "resource": "identity.user",
        "adapter": "azure.azuread.authentication_methods",
        "not_applicable_when": "no_azure_ad_users",
        "resource_type": "identity.user"
      },
      {
        "service": "azuread",
        "resource": "identity.user",
        "adapter": "azure.azuread.microsoft_authenticator",
        "not_applicable_when": "no_azure_ad_users",
        "resource_type": "identity.user"
      }
    ],
    "exhaustive": [
      {
        "service": "azuread",
        "resource": "identity.user",
        "adapter": "azure.azuread.fido2_authentication",
        "not_applicable_when": "no_azure_ad_users",
        "resource_type": "identity.user"
      },
      {
        "service": "azuread",
        "resource": "identity.user",
        "adapter": "azure.azuread.phone_authentication",
        "not_applicable_when": "no_azure_ad_users",
        "resource_type": "identity.user"
      },
      {
        "service": "azuread",
        "resource": "identity.user",
        "adapter": "azure.azuread.email_authentication",
        "not_applicable_when": "no_azure_ad_users",
        "resource_type": "identity.user"
      }
    ]
  },
  "identity_access.session_management": {
    "core": [
      {
        "service": "azuread",
        "resource": "identity.user",
        "adapter": "azure.azuread.sign_in_frequency",
        "not_applicable_when": "no_azure_ad_users",
        "resource_type": "identity.user"
      },
      {
        "service": "azuread",
        "resource": "identity.user",
        "adapter": "azure.azuread.session_timeout",
        "not_applicable_when": "no_azure_ad_users",
        "resource_type": "identity.user"
      }
    ],
    "extended": [
      {
        "service": "azuread",
        "resource": "identity.tenant",
        "adapter": "azure.azuread.conditional_access_session_controls",
        "not_applicable_when": "no_conditional_access",
        "resource_type": "identity.tenant"
      }
    ],
    "exhaustive": [
      {
        "service": "azuread",
        "resource": "identity.user",
        "adapter": "azure.azuread.risk_based_session_controls",
        "not_applicable_when": "no_azure_ad_users",
        "resource_type": "identity.user"
      },
      {
        "service": "azuread",
        "resource": "identity.user",
        "adapter": "azure.azuread.device_based_session_controls",
        "not_applicable_when": "no_azure_ad_users",
        "resource_type": "identity.user"
      },
      {
        "service": "azuread",
        "resource": "identity.tenant",
        "adapter": "azure.azuread.device_compliance_requirements",
        "not_applicable_when": "no_conditional_access",
        "resource_type": "identity.tenant"
      }
    ]
  },
  "rbac_entitlements.role_definition": {
    "core": [
      {
        "service": "azuread",
        "resource": "rbac.role",
        "adapter": "azure.azuread.built_in_roles",
        "not_applicable_when": "no_azure_ad_roles",
        "resource_type": "rbac.role"
      }
    ],
    "extended": [
      {
        "service": "azuread",
        "resource": "rbac.role",
        "adapter": "azure.azuread.custom_roles",
        "not_applicable_when": "no_custom_roles",
        "resource_type": "rbac.role"
      },
      {
        "service": "azuread",
        "resource": "rbac.role",
        "adapter": "azure.azuread.role_permissions",
        "not_applicable_when": "no_azure_ad_roles",
        "resource_type": "rbac.role"
      }
    ],
    "exhaustive": [
      {
        "service": "azuread",
        "resource": "rbac.role",
        "adapter": "azure.azuread.role_analytics",
        "not_applicable_when": "no_azure_ad_roles",
        "resource_type": "rbac.role"
      },
      {
        "service": "azuread",
        "resource": "rbac.role",
        "adapter": "azure.azuread.role_usage_analytics",
        "not_applicable_when": "no_azure_ad_roles",
        "resource_type": "rbac.role"
      }
    ]
  },
  "rbac_entitlements.role_assignment": {
    "core": [
      {
        "service": "azuread",
        "resource": "rbac.role",
        "adapter": "azure.azuread.role_assignments",
        "not_applicable_when": "no_azure_ad_roles",
        "resource_type": "rbac.role"
      }
    ],
    "extended": [
      {
        "service": "azuread",
        "resource": "rbac.role",
        "adapter": "azure.azuread.privileged_role_assignments",
        "not_applicable_when": "no_pim_configured",
        "resource_type": "rbac.role"
      },
      {
        "service": "azuread",
        "resource": "rbac.group",
        "adapter": "azure.azuread.group_role_assignments",
        "not_applicable_when": "no_azure_ad_groups",
        "resource_type": "rbac.group"
      }
    ],
    "exhaustive": [
      {
        "service": "azuread",
        "resource": "rbac.role",
        "adapter": "azure.azuread.just_in_time_access",
        "not_applicable_when": "no_pim_configured",
        "resource_type": "rbac.role"
      },
      {
        "service": "azuread",
        "resource": "rbac.role",
        "adapter": "azure.azuread.emergency_access",
        "not_applicable_when": "no_pim_configured",
        "resource_type": "rbac.role"
      }
    ]
  },
  "rbac_entitlements.least_privilege": {
    "core": [
      {
        "service": "azuread",
        "resource": "rbac.role",
        "adapter": "azure.azuread.role_permissions_audit",
        "not_applicable_when": "no_azure_ad_roles",
        "resource_type": "rbac.role"
      }
    ],
    "extended": [
      {
        "service": "azuread",
        "resource": "rbac.policy",
        "adapter": "azure.azuread.permission_analytics",
        "not_applicable_when": "no_azure_ad_configured",
        "resource_type": "rbac.policy"
      },
      {
        "service": "azuread",
        "resource": "rbac.role",
        "adapter": "azure.azuread.unused_permissions",
        "not_applicable_when": "no_azure_ad_roles",
        "resource_type": "rbac.role"
      }
    ],
    "exhaustive": [
      {
        "service": "azuread",
        "resource": "rbac.role",
        "adapter": "azure.azuread.permission_creep_analysis",
        "not_applicable_when": "no_azure_ad_roles",
        "resource_type": "rbac.role"
      },
      {
        "service": "azuread",
        "resource": "rbac.role",
        "adapter": "azure.azuread.access_review_automation",
        "not_applicable_when": "no_azure_ad_roles",
        "resource_type": "rbac.role"
      }
    ]
  },
  "rbac_entitlements.entitlement_management": {
    "core": [
      {
        "service": "azuread",
        "resource": "rbac.policy",
        "adapter": "azure.azuread.entitlement_management",
        "not_applicable_when": "no_entitlement_management",
        "resource_type": "rbac.policy"
      }
    ],
    "extended": [
      {
        "service": "azuread",
        "resource": "rbac.policy",
        "adapter": "azure.azuread.access_packages",
        "not_applicable_when": "no_access_packages",
        "resource_type": "rbac.policy"
      },
      {
        "service": "azuread",
        "resource": "rbac.policy",
        "adapter": "azure.azuread.catalog_management",
        "not_applicable_when": "no_catalogs",
        "resource_type": "rbac.policy"
      }
    ],
    "exhaustive": [
      {
        "service": "azuread",
        "resource": "rbac.policy",
        "adapter": "azure.azuread.lifecycle_workflows",
        "not_applicable_when": "no_lifecycle_workflows",
        "resource_type": "rbac.policy"
      },
      {
        "service": "azuread",
        "resource": "rbac.policy",
        "adapter": "azure.azuread.connected_organizations",
        "not_applicable_when": "no_connected_organizations",
        "resource_type": "rbac.policy"
      }
    ]
  },
  "secrets_key_mgmt.secret_storage": {
    "core": [
      {
        "service": "keyvault",
        "resource": "secrets.secret",
        "adapter": "azure.keyvault.secret_encryption",
        "not_applicable_when": "no_key_vault",
        "resource_type": "secrets.secret"
      },
      {
        "service": "keyvault",
        "resource": "secrets.secret",
        "adapter": "azure.keyvault.secret_access_policies",
        "not_applicable_when": "no_key_vault",
        "resource_type": "secrets.secret"
      }
    ],
    "extended": [
      {
        "service": "keyvault",
        "resource": "secrets.secret",
        "adapter": "azure.keyvault.secret_rotation",
        "not_applicable_when": "no_key_vault",
        "resource_type": "secrets.secret"
      },
      {
        "service": "keyvault",
        "resource": "secrets.secret",
        "adapter": "azure.keyvault.secret_versioning",
        "not_applicable_when": "no_key_vault",
        "resource_type": "secrets.secret"
      },
      {
        "service": "keyvault",
        "resource": "secrets.secret",
        "adapter": "azure.keyvault.secret_soft_delete",
        "not_applicable_when": "no_key_vault",
        "resource_type": "secrets.secret"
      }
    ],
    "exhaustive": [
      {
        "service": "keyvault",
        "resource": "secrets.secret",
        "adapter": "azure.keyvault.secret_import_export",
        "not_applicable_when": "no_key_vault",
        "resource_type": "secrets.secret"
      },
      {
        "service": "keyvault",
        "resource": "secrets.secret",
        "adapter": "azure.keyvault.secret_backup",
        "not_applicable_when": "no_key_vault",
        "resource_type": "secrets.secret"
      },
      {
        "service": "keyvault",
        "resource": "secrets.secret",
        "adapter": "azure.keyvault.secret_attestation",
        "not_applicable_when": "no_key_vault",
        "resource_type": "secrets.secret"
      }
    ]
  },
  "secrets_key_mgmt.key_rotation": {
    "core": [
      {
        "service": "keyvault",
        "resource": "crypto.kms.key",
        "adapter": "azure.keyvault.key_rotation",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms.key"
      }
    ],
    "extended": [
      {
        "service": "keyvault",
        "resource": "crypto.kms.key",
        "adapter": "azure.keyvault.auto_rotation",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms.key"
      },
      {
        "service": "keyvault",
        "resource": "crypto.kms.key",
        "adapter": "azure.keyvault.rotation_policies",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms.key"
      }
    ],
    "exhaustive": [
      {
        "service": "keyvault",
        "resource": "crypto.kms.key",
        "adapter": "azure.keyvault.rotation_monitoring",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms.key"
      },
      {
        "service": "keyvault",
        "resource": "crypto.kms.key",
        "adapter": "azure.keyvault.rotation_alerts",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms.key"
      }
    ]
  },
  "secrets_key_mgmt.key_protection": {
    "core": [
      {
        "service": "keyvault",
        "resource": "crypto.kms.key",
        "adapter": "azure.keyvault.key_access_policies",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms.key"
      }
    ],
    "extended": [
      {
        "service": "keyvault",
        "resource": "crypto.kms.key",
        "adapter": "azure.keyvault.key_backup",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms.key"
      },
      {
        "service": "keyvault",
        "resource": "crypto.kms.key",
        "adapter": "azure.keyvault.key_versioning",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms.key"
      },
      {
        "service": "keyvault",
        "resource": "keyvault.vault",
        "adapter": "azure.keyvault.rbac_authorization_enabled",
        "not_applicable_when": "no_key_vault",
        "resource_type": "keyvault.vault"
      },
      {
        "service": "keyvault",
        "resource": "keyvault.vault",
        "adapter": "azure.keyvault.purge_protection_enabled",
        "not_applicable_when": "no_key_vault",
        "resource_type": "keyvault.vault"
      }
    ],
    "exhaustive": [
      {
        "service": "keyvault",
        "resource": "crypto.kms.key",
        "adapter": "azure.keyvault.hsm_protection",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms.key"
      },
      {
        "service": "keyvault",
        "resource": "crypto.kms.key",
        "adapter": "azure.keyvault.key_attestation",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms.key"
      }
    ]
  },
  "secrets_key_mgmt.secret_retrieval": {
    "core": [
      {
        "service": "keyvault",
        "resource": "secrets.secret",
        "adapter": "azure.keyvault.secret_access_logging",
        "not_applicable_when": "no_key_vault",
        "resource_type": "secrets.secret"
      }
    ],
    "extended": [
      {
        "service": "keyvault",
        "resource": "secrets.secret",
        "adapter": "azure.keyvault.secret_audit_logs",
        "not_applicable_when": "no_key_vault",
        "resource_type": "secrets.secret"
      },
      {
        "service": "keyvault",
        "resource": "secrets.secret",
        "adapter": "azure.keyvault.secret_access_monitoring",
        "not_applicable_when": "no_key_vault",
        "resource_type": "secrets.secret"
      }
    ],
    "exhaustive": [
      {
        "service": "keyvault",
        "resource": "secrets.secret",
        "adapter": "azure.keyvault.secret_access_analytics",
        "not_applicable_when": "no_key_vault",
        "resource_type": "secrets.secret"
      },
      {
        "service": "keyvault",
        "resource": "secrets.secret",
        "adapter": "azure.keyvault.secret_anomaly_detection",
        "not_applicable_when": "no_key_vault",
        "resource_type": "secrets.secret"
      }
    ]
  },
  "crypto_data_protection.encryption_at_rest": {
    "core": [
      {
        "service": "keyvault",
        "resource": "crypto.kms",
        "adapter": "azure.keyvault.key_encryption",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms"
      },
      {
        "service": "storage",
        "resource": "storage.bucket",
        "adapter": "azure.storage.encryption_at_rest",
        "not_applicable_when": "no_storage_accounts",
        "resource_type": "storage.bucket"
      },
      {
        "service": "compute",
        "resource": "compute.disk",
        "adapter": "azure.compute.disk_encryption",
        "not_applicable_when": "no_virtual_machines",
        "resource_type": "compute.disk"
      }
    ],
    "extended": [
      {
        "service": "sql",
        "resource": "db.instance",
        "adapter": "azure.sql.transparent_data_encryption",
        "not_applicable_when": "no_sql_databases",
        "resource_type": "db.instance"
      },
      {
        "service": "cosmosdb",
        "resource": "db.instance",
        "adapter": "azure.cosmosdb.encryption_at_rest",
        "not_applicable_when": "no_cosmosdb_accounts",
        "resource_type": "db.instance"
      },
      {
        "service": "postgresql",
        "resource": "db.instance",
        "adapter": "azure.postgresql.encryption_at_rest",
        "not_applicable_when": "no_postgresql_servers",
        "resource_type": "db.instance"
      },
      {
        "service": "mysql",
        "resource": "db.instance",
        "adapter": "azure.mysql.encryption_at_rest",
        "not_applicable_when": "no_mysql_servers",
        "resource_type": "db.instance"
      },
      {
        "service": "storage",
        "resource": "storage.queue",
        "adapter": "azure.storage.queue_encryption_at_rest",
        "not_applicable_when": "no_storage_accounts",
        "resource_type": "storage.queue"
      },
      {
        "service": "storage",
        "resource": "storage.table",
        "adapter": "azure.storage.table_encryption_at_rest",
        "not_applicable_when": "no_storage_accounts",
        "resource_type": "storage.table"
      },
      {
        "service": "storage",
        "resource": "storage.bucket",
        "adapter": "azure.storage.encryption_cmk_required",
        "not_applicable_when": "no_storage_accounts",
        "resource_type": "storage.bucket"
      },
      {
        "service": "compute",
        "resource": "compute.disk",
        "adapter": "azure.compute.disk_cmk_required",
        "not_applicable_when": "no_virtual_machines",
        "resource_type": "compute.disk"
      },
      {
        "service": "sql",
        "resource": "db.instance",
        "adapter": "azure.sql.tde_cmk",
        "not_applicable_when": "no_sql_databases",
        "resource_type": "db.instance"
      },
      {
        "service": "synapse",
        "resource": "db.instance",
        "adapter": "azure.synapse.customer_managed_key",
        "not_applicable_when": "no_synapse_workspaces",
        "resource_type": "db.instance"
      },
      {
        "service": "cosmosdb",
        "resource": "db.instance",
        "adapter": "azure.cosmosdb.customer_managed_key",
        "not_applicable_when": "no_cosmosdb_accounts",
        "resource_type": "db.instance"
      },
      {
        "service": "eventhub",
        "resource": "storage.queue",
        "adapter": "azure.eventhub.namespace_encryption",
        "not_applicable_when": "no_event_hub_namespaces",
        "resource_type": "storage.queue"
      },
      {
        "service": "datafactory",
        "resource": "paas.app",
        "adapter": "azure.datafactory.linked_service_encryption",
        "not_applicable_when": "no_data_factories",
        "resource_type": "paas.app"
      }
    ],
    "exhaustive": [
      {
        "service": "redis",
        "resource": "db.instance",
        "adapter": "azure.redis.encryption_at_rest",
        "not_applicable_when": "no_redis_caches",
        "resource_type": "db.instance"
      },
      {
        "service": "synapse",
        "resource": "db.instance",
        "adapter": "azure.synapse.encryption_at_rest",
        "not_applicable_when": "no_synapse_workspaces",
        "resource_type": "db.instance"
      },
      {
        "service": "databricks",
        "resource": "db.instance",
        "adapter": "azure.databricks.encryption_at_rest",
        "not_applicable_when": "no_databricks_workspaces",
        "resource_type": "db.instance"
      },
      {
        "service": "search",
        "resource": "db.instance",
        "adapter": "azure.search.encryption_at_rest",
        "not_applicable_when": "no_search_services",
        "resource_type": "db.instance"
      }
    ]
  },
  "crypto_data_protection.encryption_in_transit": {
    "core": [
      {
        "service": "storage",
        "resource": "storage.bucket",
        "adapter": "azure.storage.https_required",
        "not_applicable_when": "no_storage_accounts",
        "resource_type": "storage.bucket"
      },
      {
        "service": "compute",
        "resource": "compute.vm",
        "adapter": "azure.compute.rdp_encryption",
        "not_applicable_when": "no_virtual_machines",
        "resource_type": "compute.vm"
      },
      {
        "service": "appservice",
        "resource": "paas.app",
        "adapter": "azure.appservice.https_only",
        "not_applicable_when": "no_app_services",
        "resource_type": "paas.app"
      }
    ],
    "extended": [
      {
        "service": "sql",
        "resource": "db.instance",
        "adapter": "azure.sql.ssl_enforcement",
        "not_applicable_when": "no_sql_databases",
        "resource_type": "db.instance"
      },
      {
        "service": "cosmosdb",
        "resource": "db.instance",
        "adapter": "azure.cosmosdb.ssl_enforcement",
        "not_applicable_when": "no_cosmosdb_accounts",
        "resource_type": "db.instance"
      },
      {
        "service": "postgresql",
        "resource": "db.instance",
        "adapter": "azure.postgresql.ssl_enforcement",
        "not_applicable_when": "no_postgresql_servers",
        "resource_type": "db.instance"
      },
      {
        "service": "mysql",
        "resource": "db.instance",
        "adapter": "azure.mysql.ssl_enforcement",
        "not_applicable_when": "no_mysql_servers",
        "resource_type": "db.instance"
      }
    ],
    "exhaustive": [
      {
        "service": "redis",
        "resource": "db.instance",
        "adapter": "azure.redis.ssl_enforcement",
        "not_applicable_when": "no_redis_caches",
        "resource_type": "db.instance"
      },
      {
        "service": "servicebus",
        "resource": "storage.queue",
        "adapter": "azure.servicebus.tls_enforcement",
        "not_applicable_when": "no_service_bus_namespaces",
        "resource_type": "storage.queue"
      },
      {
        "service": "eventhub",
        "resource": "storage.queue",
        "adapter": "azure.eventhub.tls_enforcement",
        "not_applicable_when": "no_event_hub_namespaces",
        "resource_type": "storage.queue"
      },
      {
        "service": "apimanagement",
        "resource": "platform.api_endpoint",
        "adapter": "azure.apimanagement.tls_enforcement",
        "not_applicable_when": "no_api_management_instances",
        "resource_type": "platform.api_endpoint"
      },
      {
        "service": "storage",
        "resource": "storage.bucket",
        "adapter": "azure.storage.minimum_tls_1_2",
        "not_applicable_when": "no_storage_accounts",
        "resource_type": "storage.bucket"
      },
      {
        "service": "sql",
        "resource": "db.instance",
        "adapter": "azure.sql.minimum_tls_1_2",
        "not_applicable_when": "no_sql_databases",
        "resource_type": "db.instance"
      },
      {
        "service": "redis",
        "resource": "db.instance",
        "adapter": "azure.redis.minimum_tls_1_2",
        "not_applicable_when": "no_redis_caches",
        "resource_type": "db.instance"
      },
      {
        "service": "apimanagement",
        "resource": "platform.api_endpoint",
        "adapter": "azure.apimanagement.minimum_tls_1_2",
        "not_applicable_when": "no_api_management_instances",
        "resource_type": "platform.api_endpoint"
      },
      {
        "service": "frontdoor",
        "resource": "network.load_balancer",
        "adapter": "azure.frontdoor.minimum_tls_1_2",
        "not_applicable_when": "no_frontdoor",
        "resource_type": "network.load_balancer"
      },
      {
        "service": "application-gateway",
        "resource": "network.load_balancer",
        "adapter": "azure.appgw.minimum_tls_1_2",
        "not_applicable_when": "no_app_gateways",
        "resource_type": "network.load_balancer"
      },
      {
        "service": "storage",
        "resource": "storage.queue",
        "adapter": "azure.storage.minimum_tls_1_2_queue",
        "not_applicable_when": "no_storage_accounts",
        "resource_type": "storage.queue"
      },
      {
        "service": "storage",
        "resource": "storage.table",
        "adapter": "azure.storage.minimum_tls_1_2_table",
        "not_applicable_when": "no_storage_accounts",
        "resource_type": "storage.table"
      },
      {
        "service": "application-gateway",
        "resource": "network.load_balancer",
        "adapter": "azure.appgw.https_listeners",
        "not_applicable_when": "no_app_gateways",
        "resource_type": "network.load_balancer"
      },
      {
        "service": "frontdoor",
        "resource": "network.load_balancer",
        "adapter": "azure.frontdoor.https_enforcement",
        "not_applicable_when": "no_frontdoor",
        "resource_type": "network.load_balancer"
      }
    ]
  },
  "crypto_data_protection.key_management": {
    "core": [
      {
        "service": "keyvault",
        "resource": "crypto.kms.key",
        "adapter": "azure.keyvault.key_rotation",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms.key"
      },
      {
        "service": "keyvault",
        "resource": "crypto.kms.key",
        "adapter": "azure.keyvault.key_access_policies",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms.key"
      }
    ],
    "extended": [
      {
        "service": "keyvault",
        "resource": "crypto.kms.key",
        "adapter": "azure.keyvault.key_backup",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms.key"
      },
      {
        "service": "keyvault",
        "resource": "crypto.kms.key",
        "adapter": "azure.keyvault.key_versioning",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms.key"
      },
      {
        "service": "keyvault",
        "resource": "crypto.kms.key",
        "adapter": "azure.keyvault.key_import_export",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms.key"
      }
    ],
    "exhaustive": [
      {
        "service": "keyvault",
        "resource": "crypto.kms.key",
        "adapter": "azure.keyvault.hsm_protection",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms.key"
      },
      {
        "service": "keyvault",
        "resource": "crypto.kms.key",
        "adapter": "azure.keyvault.key_attestation",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms.key"
      },
      {
        "service": "keyvault",
        "resource": "crypto.kms.key",
        "adapter": "azure.keyvault.key_escrow",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms.key"
      }
    ]
  },
  "crypto_data_protection.certificate_management": {
    "core": [
      {
        "service": "keyvault",
        "resource": "crypto.certificate",
        "adapter": "azure.keyvault.certificate_management",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.certificate"
      }
    ],
    "extended": [
      {
        "service": "keyvault",
        "resource": "crypto.certificate",
        "adapter": "azure.keyvault.certificate_auto_rotation",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.certificate"
      },
      {
        "service": "keyvault",
        "resource": "crypto.certificate",
        "adapter": "azure.keyvault.certificate_policy",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.certificate"
      }
    ],
    "exhaustive": [
      {
        "service": "keyvault",
        "resource": "crypto.certificate",
        "adapter": "azure.keyvault.certificate_issuance",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.certificate"
      },
      {
        "service": "keyvault",
        "resource": "crypto.certificate",
        "adapter": "azure.keyvault.certificate_renewal",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.certificate"
      }
    ]
  },
  "crypto_data_protection.crypto_policies": {
    "core": [
      {
        "service": "keyvault",
        "resource": "crypto.kms",
        "adapter": "azure.keyvault.crypto_policies",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms"
      }
    ],
    "extended": [
      {
        "service": "keyvault",
        "resource": "crypto.kms",
        "adapter": "azure.keyvault.key_policies",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms"
      },
      {
        "service": "keyvault",
        "resource": "crypto.kms",
        "adapter": "azure.keyvault.secret_policies",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms"
      }
    ],
    "exhaustive": [
      {
        "service": "keyvault",
        "resource": "crypto.kms",
        "adapter": "azure.keyvault.certificate_policies",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms"
      },
      {
        "service": "keyvault",
        "resource": "crypto.kms",
        "adapter": "azure.keyvault.access_policies",
        "not_applicable_when": "no_key_vault",
        "resource_type": "crypto.kms"
      }
    ]
  },
  "data_protection_storage.data_classification": {
    "core": [
      {
        "service": "purview",
        "resource": "data.catalog",
        "adapter": "azure.purview.data_map_scans",
        "not_applicable_when": "no_purview_accounts",
        "resource_type": "data.catalog"
      }
    ],
    "extended": [
      {
        "service": "storage",
        "resource": "storage.bucket",
        "adapter": "azure.storage.blob_classification",
        "not_applicable_when": "no_storage_accounts",
        "resource_type": "storage.bucket"
      },
      {
        "service": "storage",
        "resource": "storage.object",
        "adapter": "azure.storage.sensitive_data_discovery",
        "not_applicable_when": "no_storage_accounts",
        "resource_type": "storage.object"
      }
    ],
    "exhaustive": [
      {
        "service": "purview",
        "resource": "data.catalog",
        "adapter": "azure.purview.sensitive_data_classification",
        "not_applicable_when": "no_purview_accounts",
        "resource_type": "data.catalog"
      }
    ]
  },
  "data_protection_storage.data_retention": {
    "core": [
      {
        "service": "storage",
        "resource": "storage.bucket",
        "adapter": "azure.storage.lifecycle_management",
        "not_applicable_when": "no_storage_accounts",
        "resource_type": "storage.bucket"
      }
    ],
    "extended": [
      {
        "service": "storage",
        "resource": "storage.bucket",
        "adapter": "azure.storage.immutability_policy",
        "not_applicable_when": "no_storage_accounts",
        "resource_type": "storage.bucket"
      },
      {
        "service": "storage",
        "resource": "storage.bucket",
        "adapter": "azure.storage.versioning",
        "not_applicable_when": "no_storage_accounts",
        "resource_type": "storage.bucket"
      },
      {
        "service": "storage",
        "resource": "storage.bucket",
        "adapter": "azure.storage.soft_delete",
        "not_applicable_when": "no_storage_accounts",
        "resource_type": "storage.bucket"
      }
    ],
    "exhaustive": [
      {
        "service": "storage",
        "resource": "storage.bucket",
        "adapter": "azure.storage.time_based_retention",
        "not_applicable_when": "no_storage_accounts",
        "resource_type": "storage.bucket"
      }
    ]
  },
  "data_protection_storage.backup_recovery": {
    "core": [
      {
        "service": "recoveryservices",
        "resource": "backup.vault",
        "adapter": "azure.backup.vault_protection",
        "not_applicable_when": "no_recovery_vaults",
        "resource_type": "backup.vault"
      }
    ],
    "extended": [
      {
        "service": "recoveryservices",
        "resource": "backup.plan",
        "adapter": "azure.backup.protection_policies",
        "not_applicable_when": "no_recovery_vaults",
        "resource_type": "backup.plan"
      },
      {
        "service": "recoveryservices",
        "resource": "backup.item",
        "adapter": "azure.backup.item_protection",
        "not_applicable_when": "no_recovery_vaults",
        "resource_type": "backup.item"
      }
    ],
    "exhaustive": [
      {
        "service": "sql",
        "resource": "storage.snapshot",
        "adapter": "azure.sql.long_term_retention_backups",
        "not_applicable_when": "no_sql_databases",
        "resource_type": "storage.snapshot"
      },
      {
        "service": "compute",
        "resource": "storage.snapshot",
        "adapter": "azure.compute.disk_snapshots",
        "not_applicable_when": "no_virtual_machines",
        "resource_type": "storage.snapshot"
      },
      {
        "service": "cosmosdb",
        "resource": "db.instance",
        "adapter": "azure.cosmosdb.backup_policy",
        "not_applicable_when": "no_cosmosdb_accounts",
        "resource_type": "db.instance"
      }
    ]
  },
  "data_protection_storage.data_masking": {
    "core": [
      {
        "service": "sql",
        "resource": "db.instance",
        "adapter": "azure.sql.dynamic_data_masking",
        "not_applicable_when": "no_sql_databases",
        "resource_type": "db.instance"
      }
    ],
    "extended": [
      {
        "service": "synapse",
        "resource": "db.instance",
        "adapter": "azure.synapse.dynamic_data_masking",
        "not_applicable_when": "no_synapse_workspaces",
        "resource_type": "db.instance"
      }
    ],
    "exhaustive": [
      {
        "service": "postgresql",
        "resource": "db.instance",
        "adapter": "azure.postgresql.column_masking_policies",
        "not_applicable_when": "no_postgresql_servers",
        "resource_type": "db.instance"
      }
    ]
  },
  "data_protection_storage.storage_security": {
    "core": [
      {
        "service": "storage",
        "resource": "storage.bucket",
        "adapter": "azure.storage.public_access_block",
        "not_applicable_when": "no_storage_accounts",
        "resource_type": "storage.bucket"
      },
      {
        "service": "storage",
        "resource": "storage.bucket",
        "adapter": "azure.storage.logging_and_monitoring",
        "not_applicable_when": "no_storage_accounts",
        "resource_type": "storage.bucket"
      }
    ],
    "extended": [
      {
        "service": "storage",
        "resource": "storage.bucket",
        "adapter": "azure.storage.firewall_vnet_rules",
        "not_applicable_when": "no_storage_accounts",
        "resource_type": "storage.bucket"
      }
    ],
    "exhaustive": [
      {
        "service": "storage",
        "resource": "storage.bucket",
        "adapter": "azure.storage.immutability_scoped_policies",
        "not_applicable_when": "no_storage_accounts",
        "resource_type": "storage.bucket"
      }
    ]
  },
  "network_perimeter.network_segmentation": {
    "core": [
      {
        "service": "network",
        "resource": "network.vnet",
        "adapter": "azure.network.vnet_segmentation",
        "not_applicable_when": "no_vnets",
        "resource_type": "network.vnet"
      }
    ],
    "extended": [
      {
        "service": "network",
        "resource": "network.subnet",
        "adapter": "azure.network.subnet_nsg_association",
        "not_applicable_when": "no_subnets",
        "resource_type": "network.subnet"
      },
      {
        "service": "network",
        "resource": "route_table",
        "adapter": "azure.network.route_tables",
        "not_applicable_when": "no_route_tables",
        "resource_type": "route_table"
      },
      {
        "service": "network",
        "resource": "route_table",
        "adapter": "azure.network.route_table_restrictions",
        "not_applicable_when": "no_route_tables",
        "resource_type": "route_table"
      }
    ],
    "exhaustive": [
      {
        "service": "network",
        "resource": "network.endpoint",
        "adapter": "azure.private_link.endpoints",
        "not_applicable_when": "no_vnets",
        "resource_type": "network.endpoint"
      },
      {
        "service": "network",
        "resource": "peering",
        "adapter": "azure.network.vnet_peering",
        "not_applicable_when": "no_vnets",
        "resource_type": "peering"
      }
    ]
  },
  "network_perimeter.firewall_rules": {
    "core": [
      {
        "service": "network",
        "resource": "network.security_group",
        "adapter": "azure.network.nsg_rules",
        "not_applicable_when": "no_nsgs",
        "resource_type": "network.security_group"
      },
      {
        "service": "network",
        "resource": "network.security_group",
        "adapter": "azure.network.nsg_default_deny",
        "not_applicable_when": "no_nsgs",
        "resource_type": "network.security_group"
      },
      {
        "service": "network",
        "resource": "network.security_group",
        "adapter": "azure.network.nsg_restrict_admin_ports",
        "not_applicable_when": "no_nsgs",
        "resource_type": "network.security_group"
      }
    ],
    "extended": [
      {
        "service": "firewall",
        "resource": "network.firewall",
        "adapter": "azure.firewall.policy",
        "not_applicable_when": "no_firewalls",
        "resource_type": "network.firewall"
      },
      {
        "service": "application-gateway",
        "resource": "network.waf",
        "adapter": "azure.appgw.waf_policies",
        "not_applicable_when": "no_app_gateways",
        "resource_type": "network.waf"
      },
      {
        "service": "firewall",
        "resource": "network.firewall",
        "adapter": "azure.firewall.dns_proxy_enabled",
        "not_applicable_when": "no_firewalls",
        "resource_type": "network.firewall"
      },
      {
        "service": "cdn",
        "resource": "edge.cdn",
        "adapter": "azure.cdn.https_enforcement",
        "not_applicable_when": "no_cdn_profiles",
        "resource_type": "edge.cdn"
      }
    ],
    "exhaustive": [
      {
        "service": "frontdoor",
        "resource": "network.waf",
        "adapter": "azure.frontdoor.waf_policies",
        "not_applicable_when": "no_frontdoor",
        "resource_type": "network.waf"
      }
    ]
  },
  "network_perimeter.dns_security": {
    "core": [
      {
        "service": "dns",
        "resource": "dns.hosted_zone",
        "adapter": "azure.dns.secure_records",
        "not_applicable_when": "no_dns_zones",
        "resource_type": "dns.hosted_zone"
      }
    ],
    "extended": [
      {
        "service": "private-dns",
        "resource": "dns.resolver",
        "adapter": "azure.private_dns.resolver_rules",
        "not_applicable_when": "no_dns_resolvers",
        "resource_type": "dns.resolver"
      },
      {
        "service": "dns",
        "resource": "dns.resolver",
        "adapter": "azure.dns.resolver_policies",
        "not_applicable_when": "no_dns_resolvers",
        "resource_type": "dns.resolver"
      }
    ],
    "exhaustive": [
      {
        "service": "dns",
        "resource": "dns.hosted_zone",
        "adapter": "azure.dns.dnssec_enabled",
        "not_applicable_when": "no_dns_zones",
        "resource_type": "dns.hosted_zone"
      }
    ]
  },
  "network_perimeter.load_balancing": {
    "core": [
      {
        "service": "load-balancer",
        "resource": "network.load_balancer",
        "adapter": "azure.lb.security",
        "not_applicable_when": "no_load_balancers",
        "resource_type": "network.load_balancer"
      }
    ],
    "extended": [
      {
        "service": "application-gateway",
        "resource": "network.load_balancer",
        "adapter": "azure.appgw.security",
        "not_applicable_when": "no_app_gateways",
        "resource_type": "network.load_balancer"
      },
      {
        "service": "frontdoor",
        "resource": "network.load_balancer",
        "adapter": "azure.frontdoor.security",
        "not_applicable_when": "no_frontdoor",
        "resource_type": "network.load_balancer"
      }
    ],
    "exhaustive": [
      {
        "service": "traffic-manager",
        "resource": "network.load_balancer",
        "adapter": "azure.traffic_manager.profile_security",
        "not_applicable_when": "no_traffic_manager_profiles",
        "resource_type": "network.load_balancer"
      }
    ]
  },
  "network_perimeter.vpn_connectivity": {
    "core": [
      {
        "service": "vpn",
        "resource": "network.connection",
        "adapter": "azure.vpn.connections",
        "not_applicable_when": "no_vpn_gateways",
        "resource_type": "network.connection"
      }
    ],
    "extended": [
      {
        "service": "expressroute",
        "resource": "network.connection",
        "adapter": "azure.expressroute.circuit_policies",
        "not_applicable_when": "no_expressroute_circuits",
        "resource_type": "network.connection"
      }
    ],
    "exhaustive": [
      {
        "service": "virtual-wan",
        "resource": "network.gateway",
        "adapter": "azure.virtual_wan.hub_connections",
        "not_applicable_when": "no_virtual_wans",
        "resource_type": "network.gateway"
      }
    ]
  },
  "network_perimeter.ddos_protection": {
    "core": [
      {
        "service": "network",
        "resource": "network.ddos_plan",
        "adapter": "azure.network.ddos_protection_plan",
        "not_applicable_when": "no_ddos_plans",
        "resource_type": "network.ddos_plan"
      }
    ],
    "extended": [
      {
        "service": "network",
        "resource": "network.vnet",
        "adapter": "azure.network.ddos_protection_on_vnet",
        "not_applicable_when": "no_vnets",
        "resource_type": "network.vnet"
      }
    ],
    "exhaustive": []
  },
  "compute_host_security.os_hardening": {
    "core": [
      {
        "service": "compute",
        "resource": "compute.vm",
        "adapter": "azure.compute.vm_security_baseline",
        "not_applicable_when": "no_virtual_machines",
        "resource_type": "compute.vm"
      }
    ],
    "extended": [
      {
        "service": "compute",
        "resource": "compute.disk",
        "adapter": "azure.compute.disk_encryption_set_usage",
        "not_applicable_when": "no_virtual_machines",
        "resource_type": "compute.disk"
      },
      {
        "service": "compute",
        "resource": "compute.vm",
        "adapter": "azure.compute.guest_configuration_baselines",
        "not_applicable_when": "no_virtual_machines",
        "resource_type": "compute.vm"
      }
    ],
    "exhaustive": []
  },
  "compute_host_security.patch_management": {
    "core": [
      {
        "service": "automation",
        "resource": "patch_baseline",
        "adapter": "azure.automation.update_management",
        "not_applicable_when": "no_automation_account",
        "resource_type": "patch_baseline"
      }
    ],
    "extended": [
      {
        "service": "update-manager",
        "resource": "patch_group",
        "adapter": "azure.update_manager.patch_groups",
        "not_applicable_when": "no_update_manager",
        "resource_type": "patch_group"
      }
    ],
    "exhaustive": [
      {
        "service": "update-manager",
        "resource": "maintenance_window",
        "adapter": "azure.update_manager.maintenance_windows",
        "not_applicable_when": "no_update_manager",
        "resource_type": "maintenance_window"
      }
    ]
  },
  "compute_host_security.endpoint_protection": {
    "core": [
      {
        "service": "defender",
        "resource": "compute.vm",
        "adapter": "azure.defender.mde_vm",
        "not_applicable_when": "defender_not_configured",
        "resource_type": "compute.vm"
      }
    ],
    "extended": [],
    "exhaustive": []
  },
  "compute_host_security.vulnerability_management": {
    "core": [
      {
        "service": "defender",
        "resource": "assessment",
        "adapter": "azure.defender.vulnerability_assessments",
        "not_applicable_when": "defender_not_configured",
        "resource_type": "assessment"
      }
    ],
    "extended": [],
    "exhaustive": []
  },
  "compute_host_security.compliance_monitoring": {
    "core": [
      {
        "service": "defender",
        "resource": "findings",
        "adapter": "azure.defender.secure_score",
        "not_applicable_when": "defender_not_configured",
        "resource_type": "findings"
      }
    ],
    "extended": [
      {
        "service": "policy",
        "resource": "standards",
        "adapter": "azure.policy.regulatory_compliance",
        "not_applicable_when": "no_policy_assignments",
        "resource_type": "standards"
      }
    ],
    "exhaustive": []
  },
  "containers_kubernetes.image_security": {
    "core": [
      {
        "service": "acr",
        "resource": "repository",
        "adapter": "azure.acr.image_scanning",
        "not_applicable_when": "no_acr_registries",
        "resource_type": "repository"
      }
    ],
    "extended": [
      {
        "service": "acr",
        "resource": "repository",
        "adapter": "azure.acr.defender_vulnerability_scans",
        "not_applicable_when": "no_acr_registries",
        "resource_type": "repository"
      }
    ],
    "exhaustive": [
      {
        "service": "acr",
        "resource": "repository",
        "adapter": "azure.acr.image_signing",
        "not_applicable_when": "no_acr_registries",
        "resource_type": "repository"
      }
    ]
  },
  "containers_kubernetes.runtime_security": {
    "core": [
      {
        "service": "aks",
        "resource": "k8s.cluster",
        "adapter": "azure.aks.defender_runtime",
        "not_applicable_when": "no_aks_clusters",
        "resource_type": "k8s.cluster"
      }
    ],
    "extended": [],
    "exhaustive": []
  },
  "containers_kubernetes.network_policies": {
    "core": [
      {
        "service": "aks",
        "resource": "k8s.cluster",
        "adapter": "azure.aks.network_policies",
        "not_applicable_when": "no_aks_clusters",
        "resource_type": "k8s.cluster"
      }
    ],
    "extended": [
      {
        "service": "aks",
        "resource": "k8s.cluster",
        "adapter": "azure.aks.private_cluster",
        "not_applicable_when": "no_aks_clusters",
        "resource_type": "k8s.cluster"
      }
    ],
    "exhaustive": []
  },
  "containers_kubernetes.rbac_policies": {
    "core": [
      {
        "service": "aks",
        "resource": "k8s.cluster",
        "adapter": "azure.aks.azure_rbac",
        "not_applicable_when": "no_aks_clusters",
        "resource_type": "k8s.cluster"
      }
    ],
    "extended": [
      {
        "service": "aks",
        "resource": "k8s.cluster",
        "adapter": "azure.aks.oidc_issuer_enabled",
        "not_applicable_when": "no_aks_clusters",
        "resource_type": "k8s.cluster"
      }
    ],
    "exhaustive": []
  },
  "containers_kubernetes.admission_control": {
    "core": [
      {
        "service": "aks",
        "resource": "k8s.cluster",
        "adapter": "azure.aks.admission_webhooks",
        "not_applicable_when": "no_aks_clusters",
        "resource_type": "k8s.cluster"
      }
    ],
    "extended": [
      {
        "service": "aks",
        "resource": "k8s.cluster",
        "adapter": "azure.aks.gatekeeper",
        "not_applicable_when": "no_aks_clusters",
        "resource_type": "k8s.cluster"
      },
      {
        "service": "aks",
        "resource": "k8s.cluster",
        "adapter": "azure.aks.pod_security_admission",
        "not_applicable_when": "no_aks_clusters",
        "resource_type": "k8s.cluster"
      }
    ],
    "exhaustive": []
  },
  "serverless_paas.function_security": {
    "core": [
      {
        "service": "functions",
        "resource": "serverless.function",
        "adapter": "azure.functions.app_settings_secrets_encrypted",
        "not_applicable_when": "no_functions_apps",
        "resource_type": "serverless.function"
      }
    ],
    "extended": [
      {
        "service": "functions",
        "resource": "serverless.function",
        "adapter": "azure.functions.managed_identity_enforced",
        "not_applicable_when": "no_functions_apps",
        "resource_type": "serverless.function"
      },
      {
        "service": "functions",
        "resource": "serverless.function",
        "adapter": "azure.functions.https_only",
        "not_applicable_when": "no_functions_apps",
        "resource_type": "serverless.function"
      }
    ],
    "exhaustive": []
  },
  "serverless_paas.api_security": {
    "core": [
      {
        "service": "apimanagement",
        "resource": "platform.api_endpoint",
        "adapter": "azure.apimanagement.api_policies_tls",
        "not_applicable_when": "no_api_management_instances",
        "resource_type": "platform.api_endpoint"
      }
    ],
    "extended": [
      {
        "service": "apimanagement",
        "resource": "platform.api_endpoint",
        "adapter": "azure.apimanagement.rate_limiting",
        "not_applicable_when": "no_api_management_instances",
        "resource_type": "platform.api_endpoint"
      }
    ],
    "exhaustive": [
      {
        "service": "apimanagement",
        "resource": "platform.api_endpoint",
        "adapter": "azure.apimanagement.api_keys",
        "not_applicable_when": "no_api_management_instances",
        "resource_type": "platform.api_endpoint"
      }
    ]
  },
  "serverless_paas.paas_security": {
    "core": [
      {
        "service": "appservice",
        "resource": "paas.app",
        "adapter": "azure.appservice.https_only",
        "not_applicable_when": "no_app_services",
        "resource_type": "paas.app"
      },
      {
        "service": "appservice",
        "resource": "paas.app",
        "adapter": "azure.appservice.ftps_state",
        "not_applicable_when": "no_app_services",
        "resource_type": "paas.app"
      },
      {
        "service": "appservice",
        "resource": "paas.app",
        "adapter": "azure.appservice.scm_basic_auth_disabled",
        "not_applicable_when": "no_app_services",
        "resource_type": "paas.app"
      }
    ],
    "extended": [
      {
        "service": "appservice",
        "resource": "paas.app",
        "adapter": "azure.appservice.managed_identity_required",
        "not_applicable_when": "no_app_services",
        "resource_type": "paas.app"
      }
    ],
    "exhaustive": []
  },
  "serverless_paas.event_security": {
    "core": [
      {
        "service": "servicebus",
        "resource": "storage.queue",
        "adapter": "azure.servicebus.queue_encryption_tls",
        "not_applicable_when": "no_service_bus_namespaces",
        "resource_type": "storage.queue"
      },
      {
        "service": "eventgrid",
        "resource": "platform.api_endpoint",
        "adapter": "azure.eventgrid.minimum_tls_1_2",
        "not_applicable_when": "no_eventgrid_configured",
        "resource_type": "platform.api_endpoint"
      }
    ],
    "extended": [
      {
        "service": "eventhub",
        "resource": "storage.queue",
        "adapter": "azure.eventhub.tls_enforcement",
        "not_applicable_when": "no_event_hub_namespaces",
        "resource_type": "storage.queue"
      },
      {
        "service": "servicebus",
        "resource": "storage.queue",
        "adapter": "azure.servicebus.access_policies",
        "not_applicable_when": "no_service_bus_namespaces",
        "resource_type": "storage.queue"
      },
      {
        "service": "eventgrid",
        "resource": "network.endpoint",
        "adapter": "azure.eventgrid.private_endpoints",
        "not_applicable_when": "no_eventgrid_configured",
        "resource_type": "network.endpoint"
      }
    ],
    "exhaustive": [
      {
        "service": "eventgrid",
        "resource": "rbac.policy",
        "adapter": "azure.eventgrid.subscription_auth_policies",
        "not_applicable_when": "no_eventgrid_configured",
        "resource_type": "rbac.policy"
      }
    ]
  },
  "serverless_paas.resource_limits": {
    "core": [],
    "extended": [
      {
        "service": "appservice",
        "resource": "paas.app",
        "adapter": "azure.appservice.resource_limits",
        "not_applicable_when": "no_app_services",
        "resource_type": "paas.app"
      },
      {
        "service": "functions",
        "resource": "serverless.function",
        "adapter": "azure.functions.resource_limits",
        "not_applicable_when": "no_functions_apps",
        "resource_type": "serverless.function"
      }
    ],
    "exhaustive": []
  },
  "supply_chain_registries.registry_security": {
    "core": [
      {
        "service": "acr",
        "resource": "repository",
        "adapter": "azure.acr.private_endpoints_and_firewall",
        "not_applicable_when": "no_acr_registries",
        "resource_type": "repository"
      }
    ],
    "extended": [
      {
        "service": "acr",
        "resource": "repository",
        "adapter": "azure.acr.content_trust",
        "not_applicable_when": "no_acr_registries",
        "resource_type": "repository"
      },
      {
        "service": "acr",
        "resource": "repository",
        "adapter": "azure.acr.retention_policies",
        "not_applicable_when": "no_acr_registries",
        "resource_type": "repository"
      }
    ],
    "exhaustive": [
      {
        "service": "acr",
        "resource": "repository",
        "adapter": "azure.acr.network_rules",
        "not_applicable_when": "no_acr_registries",
        "resource_type": "repository"
      }
    ]
  },
  "supply_chain_registries.dependency_management": {
    "core": [],
    "extended": [
      {
        "service": "devops",
        "resource": "repository",
        "adapter": "azure.devops.artifacts_retention_and_permissions",
        "not_applicable_when": "no_devops_projects",
        "resource_type": "repository"
      }
    ],
    "exhaustive": []
  },
  "supply_chain_registries.build_security": {
    "core": [
      {
        "service": "devops",
        "resource": "governance.project",
        "adapter": "azure.devops.pipelines.build_security",
        "not_applicable_when": "no_devops_projects",
        "resource_type": "governance.project"
      }
    ],
    "extended": [],
    "exhaustive": []
  },
  "supply_chain_registries.vulnerability_scanning": {
    "core": [],
    "extended": [
      {
        "service": "acr",
        "resource": "repository",
        "adapter": "azure.acr.microsoft_defender_vulnerability_scans",
        "not_applicable_when": "no_acr_registries",
        "resource_type": "repository"
      }
    ],
    "exhaustive": []
  },
  "supply_chain_registries.signing_verification": {
    "core": [],
    "extended": [
      {
        "service": "acr",
        "resource": "repository",
        "adapter": "azure.acr.image_signing",
        "not_applicable_when": "no_acr_registries",
        "resource_type": "repository"
      }
    ],
    "exhaustive": []
  },
  "logging_monitoring.log_collection": {
    "core": [
      {
        "service": "monitor",
        "resource": "trail",
        "adapter": "azure.monitor.activity_logs_enabled",
        "not_applicable_when": "no_azure_ad_tenant",
        "resource_type": "trail"
      }
    ],
    "extended": [
      {
        "service": "diagnostic",
        "resource": "log_group",
        "adapter": "azure.diagnostic_settings.to_log_analytics",
        "not_applicable_when": "no_log_analytics_workspaces",
        "resource_type": "log_group"
      },
      {
        "service": "network-watcher",
        "resource": "flow_log",
        "adapter": "azure.network_watcher.nsg_flow_logs",
        "not_applicable_when": "no_network_watcher",
        "resource_type": "flow_log"
      }
    ],
    "exhaustive": []
  },
  "logging_monitoring.monitoring_alerting": {
    "core": [
      {
        "service": "monitor",
        "resource": "alarm",
        "adapter": "azure.monitor.metric_alerts",
        "not_applicable_when": "no_log_analytics_workspaces",
        "resource_type": "alarm"
      }
    ],
    "extended": [
      {
        "service": "monitor",
        "resource": "alarm",
        "adapter": "azure.monitor.action_groups",
        "not_applicable_when": "no_log_analytics_workspaces",
        "resource_type": "alarm"
      }
    ],
    "exhaustive": []
  },
  "logging_monitoring.audit_logging": {
    "core": [
      {
        "service": "monitor",
        "resource": "trail",
        "adapter": "azure.activity_logs.retention_and_categories",
        "not_applicable_when": "no_azure_ad_tenant",
        "resource_type": "trail"
      }
    ],
    "extended": [],
    "exhaustive": []
  },
  "logging_monitoring.log_retention": {
    "core": [
      {
        "service": "log-analytics",
        "resource": "log_group",
        "adapter": "azure.log_analytics.workspace_retention",
        "not_applicable_when": "no_log_analytics_workspaces",
        "resource_type": "log_group"
      }
    ],
    "extended": [],
    "exhaustive": []
  },
  "logging_monitoring.log_analysis": {
    "core": [],
    "extended": [
      {
        "service": "sentinel",
        "resource": "findings",
        "adapter": "azure.sentinel.analytics_rules",
        "not_applicable_when": "no_sentinel",
        "resource_type": "findings"
      }
    ],
    "exhaustive": []
  },
  "resilience_recovery.backup_strategy": {
    "core": [
      {
        "service": "recoveryservices",
        "resource": "backup.vault",
        "adapter": "azure.backup.vaults_and_policies",
        "not_applicable_when": "no_recovery_vaults",
        "resource_type": "backup.vault"
      }
    ],
    "extended": [
      {
        "service": "recoveryservices",
        "resource": "backup.vault",
        "adapter": "azure.backup.vault_immutability",
        "not_applicable_when": "no_recovery_vaults",
        "resource_type": "backup.vault"
      }
    ],
    "exhaustive": []
  },
  "resilience_recovery.disaster_recovery": {
    "core": [
      {
        "service": "site-recovery",
        "resource": "replication_configuration",
        "adapter": "azure.asr.replication_policies",
        "not_applicable_when": "no_asr_configured",
        "resource_type": "replication_configuration"
      }
    ],
    "extended": [],
    "exhaustive": []
  },
  "resilience_recovery.high_availability": {
    "core": [
      {
        "service": "compute",
        "resource": "compute.vm",
        "adapter": "azure.compute.availability_zones_sets",
        "not_applicable_when": "no_virtual_machines",
        "resource_type": "compute.vm"
      }
    ],
    "extended": [
      {
        "service": "sql",
        "resource": "db.instance",
        "adapter": "azure.sql.ha_config",
        "not_applicable_when": "no_sql_databases",
        "resource_type": "db.instance"
      }
    ],
    "exhaustive": []
  },
  "resilience_recovery.recovery_testing": {
    "core": [],
    "extended": [
      {
        "service": "site-recovery",
        "resource": "replication_configuration",
        "adapter": "azure.asr.test_failover_drills",
        "not_applicable_when": "no_asr_configured",
        "resource_type": "replication_configuration"
      }
    ],
    "exhaustive": []
  },
  "governance_compliance.policy_management": {
    "core": [
      {
        "service": "policy",
        "resource": "rbac.policy",
        "adapter": "azure.policy.assignment_and_effects",
        "not_applicable_when": "no_policy_assignments",
        "resource_type": "rbac.policy"
      }
    ],
    "extended": [
      {
        "service": "policy",
        "resource": "rbac.policy",
        "adapter": "azure.policy.initiatives",
        "not_applicable_when": "no_policy_assignments",
        "resource_type": "rbac.policy"
      }
    ],
    "exhaustive": []
  },
  "governance_compliance.compliance_framework": {
    "core": [
      {
        "service": "defender",
        "resource": "standards",
        "adapter": "azure.defender.regulatory_compliance_scores",
        "not_applicable_when": "defender_not_configured",
        "resource_type": "standards"
      }
    ],
    "extended": [
      {
        "service": "policy",
        "resource": "standards",
        "adapter": "azure.policy.regulatory_compliance",
        "not_applicable_when": "no_policy_assignments",
        "resource_type": "standards"
      }
    ],
    "exhaustive": []
  },
  "governance_compliance.resource_governance": {
    "core": [
      {
        "service": "management-groups",
        "resource": "rbac.policy",
        "adapter": "azure.management_groups.hierarchy",
        "not_applicable_when": "no_management_groups",
        "resource_type": "rbac.policy"
      }
    ],
    "extended": [
      {
        "service": "locks",
        "resource": "rbac.policy",
        "adapter": "azure.resource_locks.locks",
        "not_applicable_when": "no_resource_locks",
        "resource_type": "rbac.policy"
      },
      {
        "service": "tag",
        "resource": "rbac.policy",
        "adapter": "azure.tags.enforcement",
        "not_applicable_when": "no_policy_assignments",
        "resource_type": "rbac.policy"
      }
    ],
    "exhaustive": []
  },
  "governance_compliance.cost_governance": {
    "core": [
      {
        "service": "cost-management",
        "resource": "budget",
        "adapter": "azure.cost_management.budgets",
        "not_applicable_when": "no_cost_management_configured",
        "resource_type": "budget"
      }
    ],
    "extended": [
      {
        "service": "advisor",
        "resource": "report",
        "adapter": "azure.advisor.recommendations",
        "not_applicable_when": "no_advisor_recommendations",
        "resource_type": "report"
      }
    ],
    "exhaustive": []
  },
  "platform_surfaces_versions.version_management": {
    "core": [
      {
        "service": "aks",
        "resource": "k8s.cluster",
        "adapter": "azure.aks.version_policy",
        "not_applicable_when": "no_aks_clusters",
        "resource_type": "k8s.cluster"
      }
    ],
    "extended": [
      {
        "service": "appservice",
        "resource": "paas.app",
        "adapter": "azure.appservice.runtime_versions",
        "not_applicable_when": "no_app_services",
        "resource_type": "paas.app"
      },
      {
        "service": "sql",
        "resource": "db.instance",
        "adapter": "azure.sql.minor_version",
        "not_applicable_when": "no_sql_databases",
        "resource_type": "db.instance"
      }
    ],
    "exhaustive": []
  },
  "platform_surfaces_versions.deprecation_mgmt": {
    "core": [
      {
        "service": "compute",
        "resource": "compute.vm",
        "adapter": "azure.compute.deprecated_images_detection",
        "not_applicable_when": "no_virtual_machines",
        "resource_type": "compute.vm"
      }
    ],
    "extended": [],
    "exhaustive": []
  },
  "platform_surfaces_versions.api_management": {
    "core": [
      {
        "service": "apimanagement",
        "resource": "platform.api_endpoint",
        "adapter": "azure.apimanagement.api_version_sets",
        "not_applicable_when": "no_api_management_instances",
        "resource_type": "platform.api_endpoint"
      }
    ],
    "extended": [],
    "exhaustive": []
  },
  "platform_surfaces_versions.platform_monitoring": {
    "core": [
      {
        "service": "monitor",
        "resource": "alarm",
        "adapter": "azure.monitor.service_health_alerts",
        "not_applicable_when": "no_log_analytics_workspaces",
        "resource_type": "alarm"
      }
    ],
    "extended": [],
    "exhaustive": []
  },
  "platform_surfaces_versions.security_updates": {
    "core": [
      {
        "service": "update-manager",
        "resource": "patch_baseline",
        "adapter": "azure.update_manager.baselines",
        "not_applicable_when": "no_update_manager",
        "resource_type": "patch_baseline"
      }
    ],
    "extended": [],
    "exhaustive": []
  },
  "identity_access.authentication": {
    "core": [
      {
        "service": "azuread",
        "resource": "identity.group",
        "adapter": "azure.azuread.group_mfa_enforcement",
        "not_applicable_when": "no_azure_ad_groups",
        "resource_type": "identity.group"
      }
    ]
  },
  "rbac_entitlements.role_definition": {
    "core": [
      {
        "service": "azuread",
        "resource": "rbac.group",
        "adapter": "azure.azuread.group_roles",
        "not_applicable_when": "no_azure_ad_groups",
        "resource_type": "rbac.group"
      }
    ]
  },
  "crypto_data_protection.encryption_at_rest": {
    "core": [
      {
        "service": "storage",
        "resource": "storage.fileshare",
        "adapter": "azure.storage.fileshare_encryption",
        "not_applicable_when": "no_storage_fileshares",
        "resource_type": "storage.fileshare"
      },
      {
        "service": "servicebus",
        "resource": "storage.queue",
        "adapter": "azure.servicebus.queue_encryption",
        "not_applicable_when": "no_servicebus_queues",
        "resource_type": "storage.queue"
      },
      {
        "service": "cosmosdb",
        "resource": "storage.table",
        "adapter": "azure.cosmosdb.table_encryption",
        "not_applicable_when": "no_cosmosdb_tables",
        "resource_type": "storage.table"
      },
      {
        "service": "compute",
        "resource": "storage.snapshot",
        "adapter": "azure.compute.snapshot_encryption",
        "not_applicable_when": "no_compute_snapshots",
        "resource_type": "storage.snapshot"
      },
      {
        "service": "compute",
        "resource": "storage.volume",
        "adapter": "azure.compute.disk_encryption",
        "not_applicable_when": "no_compute_disks",
        "resource_type": "storage.volume"
      }
    ]
  },
  "templates_images.golden_images": {
    "core": [
      {
        "service": "compute",
        "resource": "compute.image",
        "adapter": "azure.compute.image_approval",
        "not_applicable_when": "no_compute_images",
        "resource_type": "compute.image"
      }
    ]
  },
  "templates_images.image_scanning": {
    "core": [
      {
        "service": "compute",
        "resource": "compute.image",
        "adapter": "azure.compute.image_vulnerability_scan",
        "not_applicable_when": "no_compute_images",
        "resource_type": "compute.image"
      }
    ]
  },
  "cluster_management_plane.capacity_management": {
    "core": [
      {
        "service": "compute",
        "resource": "compute.instance_group",
        "adapter": "azure.compute.vmss_configuration",
        "not_applicable_when": "no_vmss_groups",
        "resource_type": "compute.instance_group"
      }
    ]
  },
  "network_segmentation.microsegmentation": {
    "core": [
      {
        "service": "network",
        "resource": "network.security_group",
        "adapter": "azure.network.nsg_rules",
        "not_applicable_when": "no_network_security_groups",
        "resource_type": "network.security_group"
      }
    ]
  },
  "network_segmentation.network_segmentation": {
    "core": [
      {
        "service": "network",
        "resource": "network.route_table",
        "adapter": "azure.network.route_table_routes",
        "not_applicable_when": "no_route_tables",
        "resource_type": "network.route_table"
      }
    ]
  },
  "containers_kubernetes.crypto_data_protection": {
    "core": [
      {
        "service": "aks",
        "resource": "k8s.cluster",
        "adapter": "azure.aks.cluster_encryption",
        "not_applicable_when": "no_aks_clusters",
        "resource_type": "k8s.cluster"
      }
    ]
  },
  "containers_kubernetes.host_hardening": {
    "core": [
      {
        "service": "aks",
        "resource": "k8s.node_pool",
        "adapter": "azure.aks.node_pool_security",
        "not_applicable_when": "no_aks_node_pools",
        "resource_type": "k8s.node_pool"
      }
    ]
  },
  "supply_chain_registries.registry_security": {
    "core": [
      {
        "service": "containerregistry",
        "resource": "registry.policy",
        "adapter": "azure.containerregistry.access_policy",
        "not_applicable_when": "no_container_registries",
        "resource_type": "registry.policy"
      }
    ]
  },
  "supply_chain_registries.vulnerability_scanning": {
    "core": [
      {
        "service": "containerregistry",
        "resource": "registry.policy",
        "adapter": "azure.containerregistry.vulnerability_scanning",
        "not_applicable_when": "no_container_registries",
        "resource_type": "registry.policy"
      }
    ]
  }
}
