event_notifications:
  version: '1.0'
  provider: ibm
  service: event_notifications
  scope: regional
  client_class: ResourceControllerV2
  discovery:
  - discovery_id: event_notifications.subscriptions
    calls:
    - action: list_resource_instances
      params: &id001 {}
      save_as: subscriptions
  - discovery_id: event_notifications.applications
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: applications
  - discovery_id: event_notifications.destinations
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: destinations
  - discovery_id: event_notifications.topics
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: topics
  - discovery_id: event_notifications.sources
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: sources
  - discovery_id: event_notifications.resources
    calls:
    - action: list_resource_instances
      params: {}
      save_as: resources
  - discovery_id: event_notifications.hub_topics
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: hub_topics
  - discovery_id: event_notifications.keys
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: keys
  - discovery_id: event_notifications.topics_not_publicly_accessibles
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: topics_not_publicly_accessibles
  - discovery_id: event_notifications.queues_not_publicly_accessibles
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: queues_not_publicly_accessibles
  checks:
  - check_id: ibm.event_notifications.subscription.notifications_topic_subscription_configured
    title: Ensure Notifications Topic Subscription is Configured for Event Notifications
    severity: low
    for_each: subscriptions
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_notifications.subscriptions response'
  - check_id: ibm.event_notifications.application.streaming_analytics_checkpoints_and_outputs_encrypted
    title: Ensure Encryption of Streaming Analytics Checkpoints and Outputs
    severity: medium
    for_each: applications
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in event_notifications.applications response'
  - check_id: ibm.event_notifications.application.streaming_analytics_network_private_only
    title: Enforce Private Network for Streaming Analytics in Event Notifications
    severity: medium
    for_each: applications
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_notifications.applications response'
  - check_id: ibm.event_notifications.application.streaming_analytics_role_least_privilege
    title: Enforce Least Privilege for Streaming Analytics Role in Event Notifications
    severity: high
    for_each: applications
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_notifications.applications response'
  - check_id: ibm.event_notifications.destination.streaming_firehose_destination_encrypted
    title: Ensure Streaming Firehose Destination Encryption in IBM Event Notifications
    severity: medium
    for_each: destinations
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in event_notifications.destinations response'
  - check_id: ibm.event_notifications.destination.streaming_firehose_destination_least_privilege
    title: Enforce Least Privilege for Streaming Firehose Destination in Event Notifications
    severity: high
    for_each: destinations
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_notifications.destinations response'
  - check_id: ibm.event_notifications.destination.streaming_firehose_logging_enabled
    title: Ensure Streaming Firehose Logging is Enabled for Event Notifications
    severity: medium
    for_each: destinations
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in event_notifications.destinations response'
  - check_id: ibm.event_notifications.topic.streaming_stream_consumer_auth_required
    title: Enforce Consumer Authentication for Streaming in Event Notifications
    severity: low
    for_each: topics
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_notifications.topics response'
  - check_id: ibm.event_notifications.topic.streaming_stream_encryption_at_rest_enabled
    title: Ensure Encryption at Rest for IBM Event Notifications Streaming
    severity: high
    for_each: topics
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in event_notifications.topics response'
  - check_id: ibm.event_notifications.topic.streaming_stream_private_network_only_where_supported
    title: Enforce Private Network for Streaming in Event Notifications Topics
    severity: medium
    for_each: topics
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_notifications.topics response'
  - check_id: ibm.event_notifications.subscription.streaming_consumer_access_least_privilege
    title: Enforce Least Privilege for Streaming Consumer Access in Event Notifications
    severity: high
    for_each: subscriptions
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_notifications.subscriptions response'
  - check_id: ibm.event_notifications.subscription.streaming_consumer_auth_required
    title: Enforce Authentication for Streaming Consumers in Event Notifications
    severity: low
    for_each: subscriptions
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_notifications.subscriptions response'
  - check_id: ibm.event_notifications.subscription.data_analytics_subscription_cross_account_sharing_restricted
    title: Restrict Cross-Account Sharing for Data Analytics Subscriptions
    severity: medium
    for_each: subscriptions
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_notifications.subscriptions response'
  - check_id: ibm.event_notifications.subscription.data_analytics_subscription_destination_encrypted
    title: Ensure Encryption for Data Analytics Subscription Destinations
    severity: medium
    for_each: subscriptions
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in event_notifications.subscriptions response'
  - check_id: ibm.event_notifications.subscription.data_analytics_subscription_destination_least_privilege
    title: Ensure Least Privilege for Data Analytics Subscription Destinations
    severity: high
    for_each: subscriptions
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_notifications.subscriptions response'
  - check_id: ibm.event_notifications.subscription.data_warehouse_subscription_cross_account_sharing_restricted
    title: Restrict Cross-Account Sharing of Data Warehouse Subscriptions
    severity: medium
    for_each: subscriptions
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_notifications.subscriptions response'
  - check_id: ibm.event_notifications.subscription.data_warehouse_subscription_destination_encrypted
    title: Enforce Encryption for Event Notifications Data Warehouse Subscriptions
    severity: medium
    for_each: subscriptions
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in event_notifications.subscriptions response'
  - check_id: ibm.event_notifications.subscription.data_warehouse_subscription_destination_least_privilege
    title: Enforce Least Privilege for Data Warehouse Event Notification Subscriptions
    severity: high
    for_each: subscriptions
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_notifications.subscriptions response'
  - check_id: ibm.event_notifications.topic.storage_stream_consumer_auth_required
    title: Ensure Authentication for Storage Stream Consumers in Event Notifications
    severity: low
    for_each: topics
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_notifications.topics response'
  - check_id: ibm.event_notifications.topic.storage_stream_encryption_at_rest_enabled
    title: Ensure Encryption at Rest for IBM Cloud Event Notifications Topics
    severity: high
    for_each: topics
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in event_notifications.topics response'
  - check_id: ibm.event_notifications.topic.storage_stream_private_network_only_where_supported
    title: Enforce Private Network Access for Event Notifications Storage Streams
    severity: medium
    for_each: topics
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_notifications.topics response'
  - check_id: ibm.event_notifications.source.streaming_video_encryption_at_rest_enabled
    title: Ensure Streaming Video Encryption at Rest is Enabled for Event Notifications
    severity: high
    for_each: sources
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in event_notifications.sources response'
  - check_id: ibm.event_notifications.source.streaming_video_encryption_in_transit_required
    title: Ensure Encryption In Transit for Streaming Video in Event Notifications
    severity: high
    for_each: sources
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in event_notifications.sources response'
  - check_id: ibm.event_notifications.source.streaming_video_retention_days_minimum_configured
    title: Enforce Minimum Retention Days for Streaming Video Sources
    severity: low
    for_each: sources
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_notifications.sources response'
  - check_id: ibm.event_notifications.resource.global_endpoint_event_replication_enabled
    title: Ensure Global Endpoint Event Replication is Enabled for Event Notifications
    severity: low
    for_each: resources
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_notifications.resources response'
  - check_id: ibm.event_notifications.hub_topic.storage_queue_auth_required
    title: Ensure Storage Queue Authentication for Event Notifications Hub Topics
    severity: low
    for_each: hub_topics
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_notifications.hub_topics response'
  - check_id: ibm.event_notifications.hub_topic.storage_queue_cross_account_send_receive_restricted
    title: Restrict Cross-Account Access to Event Notifications Storage Queues
    severity: low
    for_each: hub_topics
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_notifications.hub_topics response'
  - check_id: ibm.event_notifications.hub_topic.storage_queue_encryption_at_rest_enabled
    title: Ensure Encryption at Rest for Event Notifications Hub Topic
    severity: high
    for_each: hub_topics
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in event_notifications.hub_topics response'
  - check_id: ibm.event_notifications.hub_topic.storage_queue_private_network_only_where_supported
    title: Enforce Private Network Access for Storage Queues in Event Notifications
    severity: medium
    for_each: hub_topics
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_notifications.hub_topics response'
  - check_id: ibm.event_notifications.key.protect_encryption_at_rest_enabled
    title: Ensure Encryption at Rest for IBM Event Notifications Keys
    severity: high
    for_each: keys
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in event_notifications.keys response'
  - check_id: ibm.event_notifications.resource.topics_kms_encryption_at_rest_enabled
    title: Ensure KMS Encryption for IBM Event Notifications Topics at Rest
    severity: high
    for_each: resources
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: encryption.kms_key_crn
        operator: exists
        expected: true
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption.kms_key_crn" exists in event_notifications.resources response'
  - check_id: ibm.event_notifications.topics_not_publicly_accessible.topics_not_publicly_accessible_blocked
    title: Prevent Public Accessibility of IBM Cloud Event Notifications Topics
    severity: critical
    for_each: topics_not_publicly_accessibles
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: public_access
        operator: equals
        expected: false
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "public_access" exists in event_notifications.topics_not_publicly_accessibles
      response'
  - check_id: ibm.event_notifications.queues_not_publicly_accessible.queues_not_publicly_accessible_blocked
    title: Ensure Event Notification Queues Are Not Publicly Accessible
    severity: critical
    for_each: queues_not_publicly_accessibles
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: public_access
        operator: equals
        expected: false
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "public_access" exists in event_notifications.queues_not_publicly_accessibles
      response'
  - check_id: ibm.event_notifications.resource.queues_server_side_encryption_enabled
    title: Ensure Server-Side Encryption for IBM Cloud Event Notifications Queues
    severity: high
    for_each: resources
    calls:
    - action: get_event_notifications_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM event_notifications compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in event_notifications.resources response'
  sdk_package: ibm_platform_services
