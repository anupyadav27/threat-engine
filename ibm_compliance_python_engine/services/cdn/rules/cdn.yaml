cdn:
  version: '1.0'
  provider: ibm
  service: cdn
  scope: regional
  client_class: ResourceControllerV2
  discovery:
  - discovery_id: cdn.cache_behaviors
    calls:
    - action: list_resource_instances
      params: &id001 {}
      save_as: cache_behaviors
  - discovery_id: cdn.distributions
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: distributions
  - discovery_id: cdn.whitelists
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: whitelists
  - discovery_id: cdn.origins
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: origins
  - discovery_id: cdn.rules
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: rules
  - discovery_id: cdn.rule_groups
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: rule_groups
  - discovery_id: cdn.distributions_multiple_origin_failover_configureds
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: distributions_multiple_origin_failover_configureds
  checks:
  - check_id: ibm.cdn.cache_behavior.edge_allowlists_minimal_query_headers_cookies
    title: Restrict Query Headers and Cookies for CDN Edge Cache Behavior
    severity: low
    for_each: cache_behaviors
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.cache_behaviors response'
  - check_id: ibm.cdn.cache_behavior.edge_no_sensitive_headers_cached
    title: Prevent Caching of Sensitive Headers at CDN Edge
    severity: low
    for_each: cache_behaviors
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.cache_behaviors response'
  - check_id: ibm.cdn.cache_behavior.edge_respects_cache_control_no_store_private
    title: Ensure CDN Edge Respects Cache-Control for No-Store and Private Data
    severity: low
    for_each: cache_behaviors
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.cache_behaviors response'
  - check_id: ibm.cdn.distribution.cloudfront_https_required
    title: Enforce HTTPS for Secure IBM Cloud CDN Distribution
    severity: low
    for_each: distributions
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.distributions response'
  - check_id: ibm.cdn.distribution.edge_access_logging_enabled
    title: Ensure Edge Access Logging is Enabled for CDN Distributions
    severity: medium
    for_each: distributions
    calls:
    - action: get_cdn_details
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in cdn.distributions response'
  - check_id: ibm.cdn.distribution.edge_cache_key_excludes_sensitive_headers
    title: Ensure Edge Cache Key Excludes Sensitive Headers in CDN Distributions
    severity: high
    for_each: distributions
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.distributions response'
  - check_id: ibm.cdn.distribution.edge_cache_key_minimal_query_and_cookie_variants
    title: Optimize Edge Cache Key for Secure CDN Data Handling
    severity: high
    for_each: distributions
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.distributions response'
  - check_id: ibm.cdn.distribution.edge_hsts_enabled
    title: Enforce Edge HSTS for Enhanced CDN Security
    severity: low
    for_each: distributions
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.distributions response'
  - check_id: ibm.cdn.distribution.edge_https_only_viewer_protocol
    title: Enforce HTTPS-Only Protocol for CDN Edge Distributions
    severity: low
    for_each: distributions
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.distributions response'
  - check_id: ibm.cdn.distribution.edge_origin_access_restricted
    title: Secure Edge-Origin Access for IBM CDN Distributions
    severity: medium
    for_each: distributions
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.distributions response'
  - check_id: ibm.cdn.distribution.edge_signed_urls_or_headers_required_for_private_content
    title: Enforce Edge Signed URLs/Headers for Private CDN Content
    severity: low
    for_each: distributions
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.distributions response'
  - check_id: ibm.cdn.distribution.edge_tls_min_1_2_enforced
    title: Ensure Edge TLS 1.2 Minimum for CDN Distributions
    severity: medium
    for_each: distributions
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.distributions response'
  - check_id: ibm.cdn.distribution.edge_valid_trusted_certificate_attached
    title: Ensure Valid Trusted Certificate for CDN Edge Distribution
    severity: medium
    for_each: distributions
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.distributions response'
  - check_id: ibm.cdn.distribution.edge_waf_web_acl_attached
    title: Ensure Edge WAF Web ACL is Attached to CDN Distributions
    severity: low
    for_each: distributions
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.distributions response'
  - check_id: ibm.cdn.distribution.distributions_logging_enabled
    title: Ensure CDN Distribution Logging is Enabled for Enhanced Auditability
    severity: medium
    for_each: distributions
    calls:
    - action: get_cdn_details
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in cdn.distributions response'
  - check_id: ibm.cdn.distribution.distributions_using_deprecated_ssl_protocols_required
    title: Enforce Modern SSL Protocols for Secure CDN Distributions
    severity: medium
    for_each: distributions
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.distributions response'
  - check_id: ibm.cdn.whitelist.edge_cidrs_valid_and_minimized
    title: Ensure Valid and Minimized Edge CIDRs in CDN Whitelist
    severity: low
    for_each: whitelists
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.whitelists response'
  - check_id: ibm.cdn.whitelist.edge_cross_account_sharing_restricted
    title: Restrict Edge Cross Account Sharing in IBM Cloud CDN Whitelists
    severity: low
    for_each: whitelists
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.whitelists response'
  - check_id: ibm.cdn.whitelist.edge_not_empty
    title: Ensure CDN Edge Whitelist is Configured for Enhanced Security
    severity: low
    for_each: whitelists
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.whitelists response'
  - check_id: ibm.cdn.whitelist.edge_used_by_at_least_one_rule
    title: Ensure CDN Whitelist Edge is Associated with at Least One Rule
    severity: low
    for_each: whitelists
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.whitelists response'
  - check_id: ibm.cdn.origin.edge_forward_cookies_minimal
    title: Enforce Minimal Edge Forward Cookies for IBM CDN Origins
    severity: low
    for_each: origins
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.origins response'
  - check_id: ibm.cdn.origin.edge_forward_headers_minimal
    title: Ensure Minimal Edge Forward Headers in IBM CDN Configuration
    severity: low
    for_each: origins
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.origins response'
  - check_id: ibm.cdn.origin.edge_forward_querystrings_minimal
    title: Enforce Minimal Edge Forwarding of Query Strings for CDN Origins
    severity: low
    for_each: origins
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.origins response'
  - check_id: ibm.cdn.origin.edge_no_secret_headers_forwarded
    title: Prevent Forwarding of Secret Headers from CDN Edge to Origin Servers
    severity: high
    for_each: origins
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.origins response'
  - check_id: ibm.cdn.rule.edge_regex_set_no_overly_broad_patterns
    title: Ensure Specificity in Edge Regex Patterns for CDN Rules
    severity: low
    for_each: rules
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.rules response'
  - check_id: ibm.cdn.rule.edge_regex_set_not_empty
    title: Ensure CDN Edge Regex Set is Configured to Enhance Security
    severity: low
    for_each: rules
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.rules response'
  - check_id: ibm.cdn.rule.edge_regex_set_used_by_at_least_one_rule
    title: Ensure Edge Regex Set is Utilized by at Least One CDN Rule
    severity: low
    for_each: rules
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.rules response'
  - check_id: ibm.cdn.rule.edge_has_effective_action_not_count_only
    title: Ensure CDN Edge Rules Have Effective Actions Beyond Count Only
    severity: low
    for_each: rules
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.rules response'
  - check_id: ibm.cdn.rule.edge_priority_unique_within_web_acl
    title: Ensure Unique Edge Priority for Rules Within Web ACL in IBM CDN
    severity: low
    for_each: rules
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.rules response'
  - check_id: ibm.cdn.rule.edge_references_valid_ip_or_regex_sets_only
    title: Ensure Edge References Use Valid IP or Regex Sets in IBM CDN Rules
    severity: low
    for_each: rules
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.rules response'
  - check_id: ibm.cdn.rule_group.edge_allow_blockedpermit_all_rule
    title: Ensure CDN Edge Rules Permit Only Authorized Traffic
    severity: low
    for_each: rule_groups
    calls:
    - action: get_cdn_details
      fields:
      - path: locked
        operator: equals
        expected: false
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "locked" exists in cdn.rule_groups response'
  - check_id: ibm.cdn.rule_group.edge_references_only_approved_managed_sets_where_used
    title: Enforce Use of Approved Managed Sets for CDN Edge References
    severity: low
    for_each: rule_groups
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.rule_groups response'
  - check_id: ibm.cdn.rule_group.edge_unique_priorities
    title: Ensure Unique Priorities in IBM Cloud CDN Rule Groups
    severity: low
    for_each: rule_groups
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.rule_groups response'
  - check_id: ibm.cdn.rule_group.edge_visibility_config_enabled
    title: Ensure Edge Visibility Configuration is Enabled for CDN Rule Groups
    severity: low
    for_each: rule_groups
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.rule_groups response'
  - check_id: ibm.cdn.distribution.distributions_field_level_encryption_enabled
    title: Ensure Field-Level Encryption for CDN Distributions is Enabled
    severity: high
    for_each: distributions
    calls:
    - action: get_cdn_details
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in cdn.distributions response'
  - check_id: ibm.cdn.distribution.distributions_https_enabled
    title: Ensure HTTPS is Enabled for All IBM CDN Distributions
    severity: low
    for_each: distributions
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.distributions response'
  - check_id: ibm.cdn.distributions_multiple_origin_failover_configured.distributions_multiple_origin_failover_configured
    title: Ensure Multi-Origin Failover for CDN Distributions
    severity: low
    for_each: distributions_multiple_origin_failover_configureds
    calls:
    - action: get_cdn_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cdn.distributions_multiple_origin_failover_configureds response'
  - check_id: ibm.cdn.distribution.distributions_origin_traffic_encrypted
    title: Ensure Encryption of CDN Distribution Origin Traffic
    severity: medium
    for_each: distributions
    calls:
    - action: get_cdn_details
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM cdn compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in cdn.distributions response'
  sdk_package: ibm_platform_services
