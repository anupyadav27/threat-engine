security_compliance_center:
  version: '1.0'
  provider: ibm
  service: security_compliance_center
  scope: regional
  client_class: ResourceControllerV2
  discovery:
  - discovery_id: security_compliance_center.profiles
    calls:
    - action: list_resource_instances
      params: &id001 {}
      save_as: profiles
  - discovery_id: security_compliance_center.classifications
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: classifications
  - discovery_id: security_compliance_center.compliances
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: compliances
  - discovery_id: security_compliance_center.workload_no_high_or_medium_riskss
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: workload_no_high_or_medium_riskss
  checks:
  - check_id: ibm.security_compliance_center.profile.feature_enabled
    title: Ensure Security Compliance Center Profile Feature is Enabled
    severity: low
    for_each: profiles
    calls:
    - action: get_security_compliance_center_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_compliance_center compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_compliance_center.profiles response'
  - check_id: ibm.security_compliance_center.profile.recorder_all_regions_enabled
    title: Ensure All Regions Are Enabled for Security Profile Recording
    severity: low
    for_each: profiles
    calls:
    - action: get_security_compliance_center_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_compliance_center compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_compliance_center.profiles response'
  - check_id: ibm.security_compliance_center.classification.auto_classification_enabled_where_supported
    title: Ensure Auto Classification is Enabled for Data Protection
    severity: medium
    for_each: classifications
    calls:
    - action: get_security_compliance_center_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_compliance_center compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_compliance_center.classifications response'
  - check_id: ibm.security_compliance_center.classification.policy_blocks_public_for_sensitive
    title: Enforce Sensitive Data Protection by Blocking Public Access
    severity: critical
    for_each: classifications
    calls:
    - action: get_security_compliance_center_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_compliance_center compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_compliance_center.classifications response'
  - check_id: ibm.security_compliance_center.classification.required_sensitivity_tags_present
    title: Ensure Sensitivity Tags Are Assigned to Classified Data
    severity: medium
    for_each: classifications
    calls:
    - action: get_security_compliance_center_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_compliance_center compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_compliance_center.classifications response'
  - check_id: ibm.security_compliance_center.compliance.access_rbac_least_privilege
    title: Enforce RBAC Least Privilege in IBM Cloud Security Compliance Center
    severity: high
    for_each: compliances
    calls:
    - action: get_security_compliance_center_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_compliance_center compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_compliance_center.compliances response'
  - check_id: ibm.security_compliance_center.compliance.export_destinations_private
    title: Ensure Export Destinations are Configured for Private Networking
    severity: low
    for_each: compliances
    calls:
    - action: get_security_compliance_center_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_compliance_center compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_compliance_center.compliances response'
  - check_id: ibm.security_compliance_center.compliance.reports_storage_encrypted
    title: Enforce Encryption for Compliance Reports Storage
    severity: medium
    for_each: compliances
    calls:
    - action: get_security_compliance_center_details
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM security_compliance_center compliance
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in security_compliance_center.compliances response'
  - check_id: ibm.security_compliance_center.workload_no_high_or_medium_risks.workload_no_high_or_medium_risks_enabled
    title: Ensure Workloads Have No High or Medium Security Risks Enabled
    severity: low
    for_each: workload_no_high_or_medium_riskss
    calls:
    - action: get_security_compliance_center_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_compliance_center compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_compliance_center.workload_no_high_or_medium_riskss
      response'
  sdk_package: ibm_platform_services
