security_advisor:
  version: '1.0'
  provider: ibm
  service: security_advisor
  scope: regional
  package: ibm-cloud-sdk-core
  client_class: Security_AdvisorV1
  discovery:
  - discovery_id: security_advisor.additional_email_configured_with_a_security_contacts
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: additional_email_configured_with_a_security_contacts
  - discovery_id: security_advisor.apps
    calls:
    - action: list_applications
      note: IBM security_advisor SDK method
      save_as: apps
  - discovery_id: security_advisor.auto_provisioning_log_analytics_agent_vms_ons
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: auto_provisioning_log_analytics_agent_vms_ons
  - discovery_id: security_advisor.auto_provisioning_vulnerabilty_assessments_machines_ons
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: auto_provisioning_vulnerabilty_assessments_machines_ons
  - discovery_id: security_advisor.container_images_resolved_vulnerabilitiess
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: container_images_resolved_vulnerabilitiess
  - discovery_id: security_advisor.resources
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: resources
  - discovery_id: security_advisor.ensure_defender_for_arm_is_ons
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: ensure_defender_for_arm_is_ons
  - discovery_id: security_advisor.ensure_defender_for_containers_is_ons
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: ensure_defender_for_containers_is_ons
  - discovery_id: security_advisor.ensure_defender_for_cosmosdb_is_ons
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: ensure_defender_for_cosmosdb_is_ons
  - discovery_id: security_advisor.ensure_defender_for_databases_is_ons
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: ensure_defender_for_databases_is_ons
  - discovery_id: security_advisor.ensure_defender_for_dns_is_ons
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: ensure_defender_for_dns_is_ons
  - discovery_id: security_advisor.ensure_defender_for_ibm_sql_databases_is_ons
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: ensure_defender_for_ibm_sql_databases_is_ons
  - discovery_id: security_advisor.ensure_defender_for_keyvault_is_ons
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: ensure_defender_for_keyvault_is_ons
  - discovery_id: security_advisor.ensure_defender_for_os_relational_databases_is_ons
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: ensure_defender_for_os_relational_databases_is_ons
  - discovery_id: security_advisor.ensure_defender_for_server_is_ons
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: ensure_defender_for_server_is_ons
  - discovery_id: security_advisor.ensure_defender_for_sql_servers_is_ons
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: ensure_defender_for_sql_servers_is_ons
  - discovery_id: security_advisor.ensure_iot_hub_defender_is_ons
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: ensure_iot_hub_defender_is_ons
  - discovery_id: security_advisor.ensure_notify_alerts_severity_is_highs
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: ensure_notify_alerts_severity_is_highs
  - discovery_id: security_advisor.ensure_notify_emails_to_ownerss
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: ensure_notify_emails_to_ownerss
  - discovery_id: security_advisor.ensure_system_updates_are_applieds
    calls:
    - action: list_applications
      note: IBM security_advisor SDK method
      save_as: ensure_system_updates_are_applieds
  - discovery_id: security_advisor.storages
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: storages
  - discovery_id: security_advisor.vms
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: vms
  - discovery_id: security_advisor.no_high_severity_findingss
    calls:
    - action: list_findings
      note: IBM security_advisor SDK method
      save_as: no_high_severity_findingss
  - discovery_id: security_advisor.advisor_assessments
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: advisor_assessments
  - discovery_id: security_advisor.advisor_automations
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: advisor_automations
  - discovery_id: security_advisor.advisor_baselines
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: advisor_baselines
  - discovery_id: security_advisor.advisor_breach_detections
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: advisor_breach_detections
  - discovery_id: security_advisor.advisor_centrally_manageds
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: advisor_centrally_manageds
  - discovery_id: security_advisor.advisor_custom_identifiers
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: advisor_custom_identifiers
  - discovery_id: security_advisor.advisor_detectors
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: advisor_detectors
  - discovery_id: security_advisor.advisor_findings
    calls:
    - action: list_findings
      note: IBM security_advisor SDK method
      save_as: advisor_findings
  - discovery_id: security_advisor.advisor_hubs
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: advisor_hubs
  - discovery_id: security_advisor.advisor_ip_sets
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: advisor_ip_sets
  - discovery_id: security_advisor.advisor_maintenances
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: advisor_maintenances
  - discovery_id: security_advisor.advisor_patchs
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: advisor_patchs
  - discovery_id: security_advisor.advisor_responses
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: advisor_responses
  - discovery_id: security_advisor.advisor_scans
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: advisor_scans
  - discovery_id: security_advisor.advisor_workflows
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: advisor_workflows
  - discovery_id: security_advisor.groups_access_controls
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: groups_access_controls
  - discovery_id: security_advisor.groups_anomaly_detections
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: groups_anomaly_detections
  - discovery_id: security_advisor.groups_automations
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: groups_automations
  - discovery_id: security_advisor.groups_egress_rules
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: groups_egress_rules
  - discovery_id: security_advisor.groups_encryptions
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: groups_encryptions
  - discovery_id: security_advisor.groups_groups
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: groups_groups
  - discovery_id: security_advisor.groups_ingress_rules
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: groups_ingress_rules
  - discovery_id: security_advisor.groups_isolations
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: groups_isolations
  - discovery_id: security_advisor.groups_micro_segmentations
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: groups_micro_segmentations
  - discovery_id: security_advisor.groups_monitorings
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: groups_monitorings
  - discovery_id: security_advisor.groups_segmentations
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: groups_segmentations
  - discovery_id: security_advisor.groups_traffic_analysiss
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: groups_traffic_analysiss
  - discovery_id: security_advisor.groups_wafs
    calls:
    - action: list_security_findings
      note: IBM security_advisor SDK method
      save_as: groups_wafs
  checks:
  - check_id: ibm.security_advisor.additional_email_configured_with_a_security_contact.additional_email_configured_with_a_security_contact_enabled
    title: Ensure Additional Email for Security Contact is Configured in IBM Cloud
    severity: low
    for_each: security_advisor.additional_email_configured_with_a_security_contacts
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.additional_email_configured_with_a_security_contacts
      response'
  - check_id: ibm.security_advisor.app.services_is_on
    title: Ensure IBM Cloud Security Advisor Services Are Enabled
    severity: low
    for_each: security_advisor.apps
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.apps
      response'
  - check_id: ibm.security_advisor.auto_provisioning_log_analytics_agent_vms_on.auto_provisioning_log_analytics_agent_vms_on_enabled
    title: Enable Auto-Provisioning of Log Analytics Agents for Enhanced Security
    severity: low
    for_each: security_advisor.auto_provisioning_log_analytics_agent_vms_ons
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in security_advisor.auto_provisioning_log_analytics_agent_vms_ons
      response'
  - check_id: ibm.security_advisor.auto_provisioning_vulnerabilty_assessments_machines_on.auto_provisioning_vulnerabilty_assessments_machines_on_en
    title: Ensure Auto-Provisioning of Vulnerability Assessments is Enabled
    severity: low
    for_each: security_advisor.auto_provisioning_vulnerabilty_assessments_machines_ons
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.auto_provisioning_vulnerabilty_assessments_machines_ons
      response'
  - check_id: ibm.security_advisor.container_images_resolved_vulnerabilities.container_images_resolved_vulnerabilities_enabled
    title: Ensure Resolved Vulnerabilities Monitoring for Container Images
    severity: low
    for_each: security_advisor.container_images_resolved_vulnerabilitiess
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.container_images_resolved_vulnerabilitiess
      response'
  - check_id: ibm.security_advisor.resource.container_images_scan_enabled
    title: Ensure Container Images Scanning is Enabled on IBM Cloud
    severity: low
    for_each: security_advisor.resources
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.resources
      response'
  - check_id: ibm.security_advisor.ensure_defender_for_arm_is_on.defender_for_arm_is_on_enabled
    title: Ensure IBM Cloud Defender for ARM is Enabled for Enhanced Security
    severity: low
    for_each: security_advisor.ensure_defender_for_arm_is_ons
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.ensure_defender_for_arm_is_ons
      response'
  - check_id: ibm.security_advisor.ensure_defender_for_containers_is_on.defender_for_containers_is_on_enabled
    title: Ensure IBM Defender for Containers is Enabled for Enhanced Security
    severity: low
    for_each: security_advisor.ensure_defender_for_containers_is_ons
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.ensure_defender_for_containers_is_ons
      response'
  - check_id: ibm.security_advisor.ensure_defender_for_cosmosdb_is_on.defender_for_cosmosdb_is_on_enabled
    title: Ensure IBM Cloud Defender for CosmosDB is Enabled
    severity: low
    for_each: security_advisor.ensure_defender_for_cosmosdb_is_ons
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.ensure_defender_for_cosmosdb_is_ons
      response'
  - check_id: ibm.security_advisor.ensure_defender_for_databases_is_on.defender_for_databases_is_on_enabled
    title: Ensure IBM Cloud Defender for Databases is Enabled for Data Security
    severity: medium
    for_each: security_advisor.ensure_defender_for_databases_is_ons
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.ensure_defender_for_databases_is_ons
      response'
  - check_id: ibm.security_advisor.ensure_defender_for_dns_is_on.defender_for_dns_is_on_enabled
    title: Ensure IBM Cloud Defender for DNS is Enabled for Enhanced Security
    severity: low
    for_each: security_advisor.ensure_defender_for_dns_is_ons
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.ensure_defender_for_dns_is_ons
      response'
  - check_id: ibm.security_advisor.ensure_defender_for_ibm_sql_databases_is_on.defender_for_ibm_sql_databases_is_on_enabled
    title: Ensure Defender for IBM SQL Databases is Enabled for Enhanced Security
    severity: medium
    for_each: security_advisor.ensure_defender_for_ibm_sql_databases_is_ons
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.ensure_defender_for_ibm_sql_databases_is_ons
      response'
  - check_id: ibm.security_advisor.ensure_defender_for_keyvault_is_on.defender_for_keyvault_is_on_enabled
    title: Ensure IBM Cloud Key Protect Defender is Activated for Enhanced Security
    severity: high
    for_each: security_advisor.ensure_defender_for_keyvault_is_ons
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.ensure_defender_for_keyvault_is_ons
      response'
  - check_id: ibm.security_advisor.ensure_defender_for_os_relational_databases_is_on.defender_for_os_relational_databases_is_on_enabled
    title: Ensure IBM Defender for OS Relational Databases is Enabled
    severity: medium
    for_each: security_advisor.ensure_defender_for_os_relational_databases_is_ons
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.ensure_defender_for_os_relational_databases_is_ons
      response'
  - check_id: ibm.security_advisor.ensure_defender_for_server_is_on.defender_for_server_is_on_enabled
    title: Enable Defender for Server to Ensure Enhanced Workload Protection
    severity: low
    for_each: security_advisor.ensure_defender_for_server_is_ons
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.ensure_defender_for_server_is_ons
      response'
  - check_id: ibm.security_advisor.ensure_defender_for_sql_servers_is_on.defender_for_sql_servers_is_on_enabled
    title: Ensure IBM Defender for SQL Servers is Enabled for Enhanced Security
    severity: low
    for_each: security_advisor.ensure_defender_for_sql_servers_is_ons
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.ensure_defender_for_sql_servers_is_ons
      response'
  - check_id: ibm.security_advisor.ensure_iot_hub_defender_is_on.iot_hub_defender_is_on_enabled
    title: Ensure IoT Hub Defender is Enabled for Enhanced Security Monitoring
    severity: low
    for_each: security_advisor.ensure_iot_hub_defender_is_ons
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.ensure_iot_hub_defender_is_ons
      response'
  - check_id: ibm.security_advisor.resource.mcas_is_enabled
    title: Ensure IBM Cloud Activity Tracker is Enabled for Enhanced Security Monitoring
    severity: low
    for_each: security_advisor.resources
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.resources
      response'
  - check_id: ibm.security_advisor.ensure_notify_alerts_severity_is_high.notify_alerts_severity_is_high_enabled
    title: Ensure High Severity Alerts Notifications Are Enabled in Security Advisor
    severity: low
    for_each: security_advisor.ensure_notify_alerts_severity_is_highs
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.ensure_notify_alerts_severity_is_highs
      response'
  - check_id: ibm.security_advisor.ensure_notify_emails_to_owners.notify_emails_to_owners_enabled
    title: Ensure Email Notifications to Resource Owners are Enabled
    severity: low
    for_each: security_advisor.ensure_notify_emails_to_ownerss
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.ensure_notify_emails_to_ownerss
      response'
  - check_id: ibm.security_advisor.ensure_system_updates_are_applied.system_updates_are_applied_enabled
    title: Ensure System Updates Are Applied for Compliance and Security
    severity: low
    for_each: security_advisor.ensure_system_updates_are_applieds
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.ensure_system_updates_are_applieds
      response'
  - check_id: ibm.security_advisor.resource.wdatp_is_enabled
    title: Ensure Wdatp is Enabled for Enhanced Threat Detection
    severity: low
    for_each: security_advisor.resources
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.resources
      response'
  - check_id: ibm.security_advisor.storage.is_on
    title: Ensure Storage Encryption is Enabled for IBM Cloud Resources
    severity: low
    for_each: security_advisor.storages
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in security_advisor.storages
      response'
  - check_id: ibm.security_advisor.vm.endpoint_protection_installed
    title: Essential Endpoint Protection for IBM Cloud Virtual Machines
    severity: low
    for_each: security_advisor.vms
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.vms
      response'
  - check_id: ibm.security_advisor.resource.is_enabled
    title: Ensure IBM Cloud Security Advisor is Enabled for Resource Monitoring
    severity: low
    for_each: security_advisor.resources
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.resources
      response'
  - check_id: ibm.security_advisor.no_high_severity_findings.no_high_severity_findings_enabled
    title: Ensure No High Severity Findings Are Enabled in IBM Security Advisor
    severity: low
    for_each: security_advisor.no_high_severity_findingss
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.no_high_severity_findingss
      response'
  - check_id: ibm.security_advisor.advisor_assessment.vuln_assessment_policy_store_encrypted
    title: Ensure Vulnerability Assessment Policies Are Encrypted at Rest
    severity: medium
    for_each: security_advisor.advisor_assessments
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in security_advisor.advisor_assessments
      response'
  - check_id: ibm.security_advisor.advisor_assessment.vuln_assessment_roles_least_privilege
    title: Enforce Least Privilege for Vulnerability Assessment Roles
    severity: high
    for_each: security_advisor.advisor_assessments
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_assessments
      response'
  - check_id: ibm.security_advisor.advisor_automation.incident_automation_artifacts_encrypted_and_private
    title: Ensure Incident Automation Artifacts are Encrypted and Private
    severity: medium
    for_each: security_advisor.advisor_automations
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in security_advisor.advisor_automations
      response'
  - check_id: ibm.security_advisor.advisor_automation.incident_automation_change_audit_logging_enabled
    title: Ensure Audit Logging is Enabled for Incident Automation Changes
    severity: medium
    for_each: security_advisor.advisor_automations
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in security_advisor.advisor_automations
      response'
  - check_id: ibm.security_advisor.advisor_automation.incident_automation_execution_roles_least_privilege
    title: Enforce Least Privilege for Incident Automation Execution Roles
    severity: high
    for_each: security_advisor.advisor_automations
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_automations
      response'
  - check_id: ibm.security_advisor.advisor_automation.vuln_automation_change_audit_logging_enabled
    title: Enable Audit Logging for Vulnerability Automation Changes
    severity: medium
    for_each: security_advisor.advisor_automations
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in security_advisor.advisor_automations
      response'
  - check_id: ibm.security_advisor.advisor_automation.vuln_automation_execution_roles_least_privilege
    title: Enforce Least Privilege for Vuln Automation Execution Roles
    severity: high
    for_each: security_advisor.advisor_automations
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_automations
      response'
  - check_id: ibm.security_advisor.advisor_baseline.vuln_baseline_exemptions_have_expiry_and_owner
    title: Ensure Vuln Baseline Exemptions Have Defined Expiry and Owner
    severity: low
    for_each: security_advisor.advisor_baselines
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_baselines
      response'
  - check_id: ibm.security_advisor.advisor_baseline.vuln_baseline_required_controls_present
    title: Ensure Vulnerability Baseline Controls are Implemented in IBM Cloud
    severity: low
    for_each: security_advisor.advisor_baselines
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_baselines
      response'
  - check_id: ibm.security_advisor.advisor_breach_detection.privacy_breach_detection_alert_destinations_configured
    title: Ensure Privacy Breach Detection Alerts Are Properly Configured
    severity: medium
    for_each: security_advisor.advisor_breach_detections
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_breach_detections
      response'
  - check_id: ibm.security_advisor.advisor_breach_detection.privacy_breach_detection_integrations_authenticated
    title: Ensure Privacy Breach Detection Integrations Are Authenticated
    severity: medium
    for_each: security_advisor.advisor_breach_detections
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_breach_detections
      response'
  - check_id: ibm.security_advisor.advisor_centrally_managed.advisor_centrally_managed_enabled
    title: Ensure Advisor Centrally Managed is Enabled for Enhanced Security Monitoring
    severity: low
    for_each: security_advisor.advisor_centrally_manageds
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_centrally_manageds
      response'
  - check_id: ibm.security_advisor.advisor_custom_identifier.threat_custom_identifier_source_trust_verified
    title: Ensuring Trust in Threat Custom Identifier Sources
    severity: low
    for_each: security_advisor.advisor_custom_identifiers
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_custom_identifiers
      response'
  - check_id: ibm.security_advisor.advisor_custom_identifier.threat_custom_identifier_storage_encrypted
    title: Ensure Encryption of Threat Custom Identifier Storage
    severity: medium
    for_each: security_advisor.advisor_custom_identifiers
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in security_advisor.advisor_custom_identifiers
      response'
  - check_id: ibm.security_advisor.advisor_detector.threat_detector_enabled_in_all_regions
    title: Ensure Threat Detector is Active in All IBM Cloud Regions
    severity: low
    for_each: security_advisor.advisor_detectors
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_detectors
      response'
  - check_id: ibm.security_advisor.advisor_detector.threat_detector_finding_export_encrypted_destination
    title: Ensure Threat Detector Findings are Exported to Encrypted Destinations
    severity: medium
    for_each: security_advisor.advisor_detectors
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in security_advisor.advisor_detectors
      response'
  - check_id: ibm.security_advisor.advisor_finding.threat_finding_alert_destinations_configured
    title: Ensure Threat Finding Alert Destinations are Configured in IBM Cloud
    severity: low
    for_each: security_advisor.advisor_findings
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_findings
      response'
  - check_id: ibm.security_advisor.advisor_finding.threat_finding_archival_export_encrypted
    title: Encrypted Export of Threat Finding Archival in Security Advisor
    severity: medium
    for_each: security_advisor.advisor_findings
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in security_advisor.advisor_findings
      response'
  - check_id: ibm.security_advisor.advisor_finding.threat_finding_suppression_rules_documented_and_scoped
    title: Ensure Threat Finding Suppression Rules Are Documented and Scoped
    severity: low
    for_each: security_advisor.advisor_findings
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_findings
      response'
  - check_id: ibm.security_advisor.resource.advisor_guardduty_enabled
    title: Ensure IBM Cloud Advisor Guardduty is Enabled for Resource Monitoring
    severity: low
    for_each: security_advisor.resources
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.resources
      response'
  - check_id: ibm.security_advisor.advisor_hub.threat_hub_auto_enroll_new_accounts
    title: Auto Enrollment of New Accounts into Threat Hub for Enhanced Security Monitoring
    severity: low
    for_each: security_advisor.advisor_hubs
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_hubs
      response'
  - check_id: ibm.security_advisor.advisor_hub.threat_hub_master_member_configured
    title: Ensure Threat Hub Master Member is Properly Configured in IBM Cloud
    severity: low
    for_each: security_advisor.advisor_hubs
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_hubs
      response'
  - check_id: ibm.security_advisor.advisor_ip_set.threat_ip_set_sources_trust_verified
    title: Verification of Trust for Threat IP Set Sources in IBM Security Advisor
    severity: low
    for_each: security_advisor.advisor_ip_sets
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_ip_sets
      response'
  - check_id: ibm.security_advisor.advisor_ip_set.threat_ip_set_storage_encrypted
    title: Ensure Encryption of Threat IP Set Storage in IBM Security Advisor
    severity: medium
    for_each: security_advisor.advisor_ip_sets
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in security_advisor.advisor_ip_sets
      response'
  - check_id: ibm.security_advisor.advisor_ip_set.threat_ip_set_used_by_detectors
    title: Utilization of Threat IP Sets by Security Detectors
    severity: low
    for_each: security_advisor.advisor_ip_sets
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_ip_sets
      response'
  - check_id: ibm.security_advisor.advisor_maintenance.vuln_maintenance_execution_roles_least_privilege
    title: Enforce Least Privilege for Vulnerability Maintenance Roles
    severity: high
    for_each: security_advisor.advisor_maintenances
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_maintenances
      response'
  - check_id: ibm.security_advisor.advisor_maintenance.vuln_maintenance_window_defined
    title: Ensuring Defined Vulnerability Maintenance Windows in IBM Cloud
    severity: low
    for_each: security_advisor.advisor_maintenances
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_maintenances
      response'
  - check_id: ibm.security_advisor.advisor_patch.vuln_patch_approval_rules_defined
    title: Ensure Vulnerability Patch Approval Rules are Defined
    severity: medium
    for_each: security_advisor.advisor_patchs
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_patchs
      response'
  - check_id: ibm.security_advisor.advisor_patch.vuln_patch_baseline_defined_for_os_families
    title: Ensure Vulnerability Patch Baseline is Defined for All OS Families
    severity: medium
    for_each: security_advisor.advisor_patchs
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_patchs
      response'
  - check_id: ibm.security_advisor.advisor_patch.vuln_patch_maintenance_windows_configured
    title: Ensure Vulnerability Patch Maintenance Windows Are Properly Configured
    severity: medium
    for_each: security_advisor.advisor_patchs
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_patchs
      response'
  - check_id: ibm.security_advisor.advisor_response.incident_response_access_rbac_least_privilege
    title: Enforce Least Privilege in Incident Response Role-Based Access Control
    severity: high
    for_each: security_advisor.advisor_responses
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_responses
      response'
  - check_id: ibm.security_advisor.advisor_response.incident_response_storage_encrypted_and_private
    title: Ensure Incident Response Storage is Encrypted and Private
    severity: medium
    for_each: security_advisor.advisor_responses
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in security_advisor.advisor_responses
      response'
  - check_id: ibm.security_advisor.advisor_response.incident_response_versioning_and_immutability_enabled
    title: Ensure Incident Response Data Versioning and Immutability in IBM Cloud
    severity: low
    for_each: security_advisor.advisor_responses
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_responses
      response'
  - check_id: ibm.security_advisor.advisor_scan.vuln_scan_agents_or_scanners_deployed
    title: Ensuring Deployment of Vulnerability Scanners in IBM Cloud
    severity: low
    for_each: security_advisor.advisor_scans
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_scans
      response'
  - check_id: ibm.security_advisor.advisor_scan.vuln_scan_results_export_destination_encrypted
    title: Ensure Vuln Scan Results Export Destination is Encrypted
    severity: medium
    for_each: security_advisor.advisor_scans
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in security_advisor.advisor_scans
      response'
  - check_id: ibm.security_advisor.advisor_scan.vuln_scan_scope_includes_all_asset_groups
    title: Comprehensive Vulnerability Scanning Across All Asset Groups
    severity: low
    for_each: security_advisor.advisor_scans
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_scans
      response'
  - check_id: ibm.security_advisor.resource.advisor_security_center_enabled
    title: Ensure IBM Security Advisor Security Center is Enabled
    severity: low
    for_each: security_advisor.resources
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.resources
      response'
  - check_id: ibm.security_advisor.resource.advisor_vulnerability_assessment_enabled
    title: Ensure IBM Security Advisor Vulnerability Assessment is Enabled
    severity: medium
    for_each: security_advisor.resources
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.resources
      response'
  - check_id: ibm.security_advisor.advisor_workflow.incident_workflow_approval_steps_req_for_destructive_actions
    title: Mandatory Approval Steps for Destructive Actions in Incident Workflows
    severity: low
    for_each: security_advisor.advisor_workflows
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_workflows
      response'
  - check_id: ibm.security_advisor.advisor_workflow.incident_workflow_integrations_least_privilege
    title: Enforce Least Privilege for Incident Workflow Integrations
    severity: high
    for_each: security_advisor.advisor_workflows
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.advisor_workflows
      response'
  - check_id: ibm.security_advisor.advisor_workflow.incident_workflow_kms_encryption_enabled
    title: Ensure KMS Encryption for Incident Workflow in IBM Security Advisor
    severity: high
    for_each: security_advisor.advisor_workflows
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: encryption.kms_key_crn
        operator: exists
        expected: true
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption.kms_key_crn" exists in security_advisor.advisor_workflows
      response'
  - check_id: ibm.security_advisor.groups_access_control.network_access_control_allow_blockedpermit_all
    title: Enforce Strict Network Access Control Policies in IBM Cloud
    severity: medium
    for_each: security_advisor.groups_access_controls
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: locked
        operator: equals
        expected: false
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "locked" exists in security_advisor.groups_access_controls
      response'
  - check_id: ibm.security_advisor.groups_access_control.network_access_control_policies_present
    title: Ensure Network Access Control Policies Are Implemented
    severity: medium
    for_each: security_advisor.groups_access_controls
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_access_controls
      response'
  - check_id: ibm.security_advisor.groups_access_control.network_access_control_policy_store_encrypted
    title: Ensure Network Access Control Policy Data is Encrypted at Rest
    severity: medium
    for_each: security_advisor.groups_access_controls
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in security_advisor.groups_access_controls
      response'
  - check_id: ibm.security_advisor.groups_anomaly_detection.network_anomaly_destinations_encrypted
    title: Ensure Network Anomaly Destinations are Encrypted in IBM Cloud
    severity: medium
    for_each: security_advisor.groups_anomaly_detections
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in security_advisor.groups_anomaly_detections
      response'
  - check_id: ibm.security_advisor.groups_anomaly_detection.network_anomaly_detectors_enabled
    title: Ensure Network Anomaly Detectors are Enabled for Enhanced Security
    severity: medium
    for_each: security_advisor.groups_anomaly_detections
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_anomaly_detections
      response'
  - check_id: ibm.security_advisor.groups_automation.network_automation_change_audit_logging_enabled
    title: Ensure Network Automation Change Audit Logging is Enabled
    severity: medium
    for_each: security_advisor.groups_automations
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in security_advisor.groups_automations
      response'
  - check_id: ibm.security_advisor.groups_automation.network_automation_remediation_roles_least_privilege
    title: Enforce Least Privilege on Network Automation Remediation Roles
    severity: high
    for_each: security_advisor.groups_automations
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_automations
      response'
  - check_id: ibm.security_advisor.groups_egress_rule.data_warehouse_sg_egress_restricted
    title: Restrict Egress Traffic for Data Warehouse Security Groups
    severity: medium
    for_each: security_advisor.groups_egress_rules
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_egress_rules
      response'
  - check_id: ibm.security_advisor.groups_encryption.mtls_required
    title: Enforce mTLS for Enhanced Encryption in IBM Cloud Security Advisor
    severity: medium
    for_each: security_advisor.groups_encryptions
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in security_advisor.groups_encryptions
      response'
  - check_id: ibm.security_advisor.groups_encryption.tls_min_1_2_enforced
    title: Enforce TLS 1.2 for Secure Data Encryption in IBM Cloud Security Advisor
    severity: medium
    for_each: security_advisor.groups_encryptions
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in security_advisor.groups_encryptions
      response'
  - check_id: ibm.security_advisor.groups_group.data_warehouse_sg_egress_restricted
    title: Restrict Egress Traffic for Data Warehouse Security Groups
    severity: medium
    for_each: security_advisor.groups_groups
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_groups
      response'
  - check_id: ibm.security_advisor.groups_group.data_warehouse_sg_no_0_ingress
    title: Restrict Ingress Traffic to Data Warehouse Security Groups
    severity: medium
    for_each: security_advisor.groups_groups
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_groups
      response'
  - check_id: ibm.security_advisor.groups_group.data_warehouse_sg_only_required_ports_open
    title: Ensure Data Warehouse Security Groups Have Only Necessary Ports Open
    severity: medium
    for_each: security_advisor.groups_groups
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_groups
      response'
  - check_id: ibm.security_advisor.groups_group.network_firewall_logging_enabled
    title: Ensure Network Firewall Logging Is Enabled for Enhanced Security Monitoring
    severity: medium
    for_each: security_advisor.groups_groups
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in security_advisor.groups_groups
      response'
  - check_id: ibm.security_advisor.groups_group.network_firewall_allow_blockedpermit_any
    title: Restrict Network Firewall Allow Any Rule in IBM Cloud
    severity: medium
    for_each: security_advisor.groups_groups
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: locked
        operator: equals
        expected: false
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "locked" exists in security_advisor.groups_groups
      response'
  - check_id: ibm.security_advisor.groups_group.network_firewall_rule_groups_attached
    title: Ensure Network Firewall Rule Groups are Properly Attached
    severity: medium
    for_each: security_advisor.groups_groups
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_groups
      response'
  - check_id: ibm.security_advisor.groups_group.network_nacl_egress_restricted
    title: Restrict Network ACL Egress for Enhanced Security Control
    severity: medium
    for_each: security_advisor.groups_groups
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_groups
      response'
  - check_id: ibm.security_advisor.groups_group.network_nacl_no_allow_blockedall_rules
    title: Ensure Network ACLs Do Not Allow Blocked-All Traffic Rules
    severity: medium
    for_each: security_advisor.groups_groups
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: locked
        operator: equals
        expected: false
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "locked" exists in security_advisor.groups_groups
      response'
  - check_id: ibm.security_advisor.groups_group.network_sg_egress_restricted
    title: Egress Traffic Restriction for Enhanced Network Security
    severity: medium
    for_each: security_advisor.groups_groups
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_groups
      response'
  - check_id: ibm.security_advisor.groups_group.network_sg_no_0_ingress
    title: Restrict Ingress Traffic in Security Groups to Enhance Network Security
    severity: medium
    for_each: security_advisor.groups_groups
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_groups
      response'
  - check_id: ibm.security_advisor.groups_group.network_sg_only_required_ports_open
    title: Ensure Only Necessary Ports Are Open in IBM Cloud Security Groups
    severity: medium
    for_each: security_advisor.groups_groups
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_groups
      response'
  - check_id: ibm.security_advisor.groups_ingress_rule.data_warehouse_sg_ingress_no_0
    title: Restrict Unnecessary Ingress to Data Warehouse Security Groups
    severity: medium
    for_each: security_advisor.groups_ingress_rules
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_ingress_rules
      response'
  - check_id: ibm.security_advisor.groups_ingress_rule.data_warehouse_sg_ingress_only_required_ports
    title: 'Secure Ingress for Data Warehouse: Restrict to Essential Ports Only'
    severity: medium
    for_each: security_advisor.groups_ingress_rules
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_ingress_rules
      response'
  - check_id: ibm.security_advisor.groups_isolation.network_isolation_automated_isolation_supported
    title: Automated Network Isolation for Enhanced Security in IBM Cloud
    severity: medium
    for_each: security_advisor.groups_isolations
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_isolations
      response'
  - check_id: ibm.security_advisor.groups_isolation.network_isolation_quarantine_network_defined
    title: Ensure Quarantine Network Is Defined for Isolated Network Groups
    severity: medium
    for_each: security_advisor.groups_isolations
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_isolations
      response'
  - check_id: ibm.security_advisor.groups_micro_segmentation.network_microseg_endpoint_policies_applied
    title: Enforce Network Microsegmentation Endpoint Policies
    severity: medium
    for_each: security_advisor.groups_micro_segmentations
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_micro_segmentations
      response'
  - check_id: ibm.security_advisor.groups_micro_segmentation.network_microseg_identity_aware_policies_enabled
    title: Enable Identity-Aware Policies for Network Microsegmentation
    severity: medium
    for_each: security_advisor.groups_micro_segmentations
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_micro_segmentations
      response'
  - check_id: ibm.security_advisor.groups_monitoring.network_monitoring_alerts_for_anomalies_configured
    title: Configure Network Monitoring Alerts for Anomalies in IBM Cloud
    severity: medium
    for_each: security_advisor.groups_monitorings
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_monitorings
      response'
  - check_id: ibm.security_advisor.groups_monitoring.network_monitoring_flow_logs_enabled
    title: Ensure Network Monitoring Flow Logs are Enabled for Security Groups
    severity: medium
    for_each: security_advisor.groups_monitorings
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in security_advisor.groups_monitorings
      response'
  - check_id: ibm.security_advisor.groups_segmentation.network_segmentation_default_deny_between_tiers
    title: Enforce Default Deny Policy Between Network Tiers
    severity: medium
    for_each: security_advisor.groups_segmentations
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_segmentations
      response'
  - check_id: ibm.security_advisor.groups_segmentation.network_segmentation_exception_approvals_required
    title: Network Segmentation Exception Approvals for Enhanced Security
    severity: medium
    for_each: security_advisor.groups_segmentations
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_segmentations
      response'
  - check_id: ibm.security_advisor.groups_segmentation.network_segmentation_tier_to_tier_policies_defined
    title: Define Network Segmentation Tier-to-Tier Policies for Secure Access
    severity: medium
    for_each: security_advisor.groups_segmentations
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_segmentations
      response'
  - check_id: ibm.security_advisor.groups_traffic_analysis.network_traffic_analysis_alert_destinations_configured
    title: Configuring Alert Destinations for Network Traffic Analysis
    severity: medium
    for_each: security_advisor.groups_traffic_analysiss
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_traffic_analysiss
      response'
  - check_id: ibm.security_advisor.groups_traffic_analysis.network_traffic_analysis_ids_ips_enabled_where_supported
    title: Ensure IDS/IPS is Enabled for Network Traffic Analysis in IBM Cloud
    severity: medium
    for_each: security_advisor.groups_traffic_analysiss
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_traffic_analysiss
      response'
  - check_id: ibm.security_advisor.groups_waf.edge_waf_block_actions_not_count_only
    title: Ensure Edge WAF Block Actions Are Configured Beyond Count Mode
    severity: low
    for_each: security_advisor.groups_wafs
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_wafs
      response'
  - check_id: ibm.security_advisor.groups_waf.edge_waf_ip_rate_limit_rules_configured_where_supported
    title: Ensure IP Rate Limiting is Configured for Edge WAF Where Supported
    severity: low
    for_each: security_advisor.groups_wafs
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_wafs
      response'
  - check_id: ibm.security_advisor.groups_waf.edge_waf_logging_enabled
    title: Ensure Edge WAF Logging is Enabled for Comprehensive Audit Trails
    severity: medium
    for_each: security_advisor.groups_wafs
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in security_advisor.groups_wafs
      response'
  - check_id: ibm.security_advisor.groups_waf.edge_waf_managed_rule_sets_enabled
    title: Ensure Edge WAF Managed Rule Sets Are Enabled for Enhanced Security
    severity: low
    for_each: security_advisor.groups_wafs
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_wafs
      response'
  - check_id: ibm.security_advisor.groups_waf.edge_waf_web_acl_attached_to_cdn
    title: Ensure Edge WAF Web ACL is Attached to IBM Cloud CDN
    severity: low
    for_each: security_advisor.groups_wafs
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.groups_wafs
      response'
  - check_id: ibm.security_advisor.resource.enabled
    title: Ensure IBM Security Advisor Resource is Enabled for Continuous Monitoring
    severity: low
    for_each: security_advisor.resources
    calls:
    - action: get_security_advisor_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM security_advisor compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in security_advisor.resources
      response'
