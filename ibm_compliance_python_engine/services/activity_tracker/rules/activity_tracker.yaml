activity_tracker:
  version: '1.0'
  provider: ibm
  service: activity_tracker
  scope: regional
  client_class: ResourceControllerV2
  discovery:
  - discovery_id: activity_tracker.events
    calls:
    - action: list_resource_instances
      params: &id001 {}
      save_as: events
  - discovery_id: activity_tracker.routes
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: routes
  - discovery_id: activity_tracker.targets
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: targets
  - discovery_id: activity_tracker.buckets
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: buckets
  - discovery_id: activity_tracker.keys
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: keys
  checks:
  - check_id: ibm.activity_tracker.event.access_logging_enabled
    title: Ensuring Access Logging is Enabled for IBM Activity Tracker Events
    severity: medium
    for_each: events
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in activity_tracker.events response'
  - check_id: ibm.activity_tracker.event.public_access_blocked
    title: Enforce Public Access Restriction on Activity Tracker Events
    severity: critical
    for_each: events
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: public_access
        operator: equals
        expected: false
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "public_access" exists in activity_tracker.events response'
  - check_id: ibm.activity_tracker.route.tracker_alerts_configured
    title: Ensure Tracker Alerts are Configured for IBM Cloud Activity Tracker
    severity: low
    for_each: routes
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in activity_tracker.routes response'
  - check_id: ibm.activity_tracker.event.tracker_cos_dataevents_read_enabled
    title: Enabling IBM COS Data Events Read in Activity Tracker
    severity: medium
    for_each: events
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in activity_tracker.events response'
  - check_id: ibm.activity_tracker.event.tracker_cos_dataevents_write_enabled
    title: Ensure COS Data Events Writing is Enabled for Activity Tracker
    severity: medium
    for_each: events
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in activity_tracker.events response'
  - check_id: ibm.activity_tracker.event.tracker_cos_read_events_enabled
    title: Enable COS Read Event Tracking in IBM Activity Tracker
    severity: low
    for_each: events
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in activity_tracker.events response'
  - check_id: ibm.activity_tracker.event.tracker_cos_write_events_enabled
    title: Enable COS Write Event Tracking in IBM Activity Tracker
    severity: low
    for_each: events
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in activity_tracker.events response'
  - check_id: ibm.activity_tracker.target.data_encryption_at_rest_enabled
    title: Ensure Data Encryption at Rest for IBM Activity Tracker Targets
    severity: high
    for_each: targets
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in activity_tracker.targets response'
  - check_id: ibm.activity_tracker.event.tracker_enabled
    title: Ensure Activity Tracker Event Logging is Enabled
    severity: low
    for_each: events
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in activity_tracker.events response'
  - check_id: ibm.activity_tracker.event.tracker_kms_encryption_enabled
    title: Ensure KMS Encryption is Enabled for Activity Tracker Events
    severity: high
    for_each: events
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: encryption.kms_key_crn
        operator: exists
        expected: true
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption.kms_key_crn" exists in activity_tracker.events response'
  - check_id: ibm.activity_tracker.event.tracker_log_file_validation_enabled
    title: Ensure Tracker Log File Validation is Enabled for Audit Integrity
    severity: low
    for_each: events
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in activity_tracker.events response'
  - check_id: ibm.activity_tracker.event.tracker_logdna_archiving_enabled
    title: Ensure LogDNA Archiving is Enabled for IBM Activity Tracker Events
    severity: low
    for_each: events
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in activity_tracker.events response'
  - check_id: ibm.activity_tracker.event.tracker_logging_enabled
    title: Ensure Activity Tracker Event Logging is Enabled
    severity: medium
    for_each: events
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in activity_tracker.events response'
  - check_id: ibm.activity_tracker.event.login_ip_restriction_enabled
    title: Ensure Login IP Restriction is Enabled in IBM Cloud Activity Tracker
    severity: low
    for_each: events
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in activity_tracker.events response'
  - check_id: ibm.activity_tracker.event.tracker_multi_region_enabled
    title: Ensure Multi-Region Enablement for Activity Tracker Events
    severity: low
    for_each: events
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in activity_tracker.events response'
  - check_id: ibm.activity_tracker.event.tracker_multi_region_enabled_logging_management_events
    title: Ensure Multi-Region Logging of Management Events in IBM Activity Tracker
    severity: medium
    for_each: events
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in activity_tracker.events response'
  - check_id: ibm.activity_tracker.event.threat_detection_enumeration_enabled
    title: Ensure Threat Detection Enumeration is Enabled in IBM Activity Tracker
    severity: low
    for_each: events
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in activity_tracker.events response'
  - check_id: ibm.activity_tracker.event.threat_detection_llm_jacking_enabled
    title: Enable Threat Detection for LLM Jacking in Activity Tracker
    severity: low
    for_each: events
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in activity_tracker.events response'
  - check_id: ibm.activity_tracker.event.threat_detection_privilege_escalation_enabled
    title: Ensure Threat Detection for Privilege Escalation is Enabled in IBM Cloud
    severity: high
    for_each: events
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in activity_tracker.events response'
  - check_id: ibm.activity_tracker.bucket.access_logging_enabled
    title: Enable Access Logging for IBM Cloud Buckets
    severity: medium
    for_each: buckets
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in activity_tracker.buckets response'
  - check_id: ibm.activity_tracker.bucket.is_not_publicly_accessible
    title: Ensure IBM Cloud Buckets Are Not Publicly Accessible
    severity: critical
    for_each: buckets
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: public_access
        operator: equals
        expected: false
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "public_access" exists in activity_tracker.buckets response'
  - check_id: ibm.activity_tracker.key.protect_encryption_enabled
    title: Ensure Encryption at Rest for IBM Activity Tracker Keys
    severity: high
    for_each: keys
    calls:
    - action: get_activity_tracker_details
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM activity_tracker compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in activity_tracker.keys response'
  sdk_package: ibm_platform_services
