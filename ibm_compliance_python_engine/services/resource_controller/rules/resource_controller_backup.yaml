resource_controller:
  version: '1.0'
  provider: ibm
  service: resource_controller
  scope: regional
  package: ibm-cloud-sdk-core
  client_class: Resource_ControllerV1
  discovery:
  - discovery_id: resource_controller.accounts
    calls:
    - action: list_resource_controller_resources
      note: IBM resource_controller service method
      save_as: accounts
  - discovery_id: resource_controller.resource_instances
    calls:
    - action: list_resource_controller_resources
      note: IBM resource_controller service method
      save_as: resource_instances
  - discovery_id: resource_controller.resource_groups
    calls:
    - action: list_resource_controller_resources
      note: IBM resource_controller service method
      save_as: resource_groups
  - discovery_id: resource_controller.portfolio_shared_within_organization_onlys
    calls:
    - action: list_resource_controller_resources
      note: IBM resource_controller service method
      save_as: portfolio_shared_within_organization_onlys
  - discovery_id: resource_controller.scopes
    calls:
    - action: list_resource_controller_resources
      note: IBM resource_controller service method
      save_as: scopes
  checks:
  - check_id: ibm.resource_controller.account.part_of_organizations
    title: Ensure IBM Cloud Account is Integrated into Organizations for Governance
    severity: low
    for_each: resource_controller.accounts
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.accounts
      response'
  - check_id: ibm.resource_controller.resource_instance.tags_policies_enabled_and_attached
    title: Enable and Attach Tags Policies for IBM Resource Instances
    severity: low
    for_each: resource_controller.resource_instances
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_instances
      response'
  - check_id: ibm.resource_controller.resource_group.aggregation_authorization_not_expired_or_revoked
    title: Ensure Active and Valid Aggregation Authorization for Resource Groups
    severity: medium
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.aggregation_authorization_target_accounts_correct
    title: Ensure Correct Aggregation Authorization for Target Accounts
    severity: medium
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.aggregation_authorization_trusts_least_privilege
    title: Enforce Least Privilege in Resource Group Aggregation Authorization
    severity: high
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.aggregation_authorization_present_and_valid
    title: Ensure Aggregation Authorization is Present and Valid for Resource Groups
    severity: medium
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.aggregator_auto_enroll_new_accounts
    title: Ensure Auto Enrollment of New Accounts for Security Monitoring
    severity: low
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.aggregator_org_aggregator_enabled
    title: Ensure Aggregator Org Aggregator is Enabled for Resource Groups
    severity: low
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.destination_access_least_privilege
    title: Enforce Least Privilege for Resource Group Access in IBM Cloud
    severity: high
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.kms_encryption_enabled
    title: Ensure KMS Encryption is Enabled for Resource Groups
    severity: high
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: encryption.kms_key_crn
        operator: exists
        expected: true
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "encryption.kms_key_crn" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.ou_auto_tag_policies_enabled_where_supported
    title: Ensure Auto Tag Policies Are Enabled for Resource Groups
    severity: low
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.ou_no_overly_permissive_exceptions
    title: Prevent Overly Permissive Exceptions in Resource Groups
    severity: low
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.ou_required_scps_attached
    title: Ensure Security Controls are Attached to Resource Groups
    severity: low
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.org_all_accounts_enrolled_in_org
    title: Ensure All Accounts Are Enrolled in Organization for Resource Groups
    severity: low
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.org_block_leave_org_by_policy
    title: Enforce Policy to Prevent Unauthorized Organization Departures
    severity: medium
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.org_restrict_region_usage_by_policy_where_required
    title: Enforce Regional Restrictions via Policy for IBM Cloud Resources
    severity: medium
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.org_scps_enabled
    title: Mandatory Activation of Organizational Security Policies (SCPs)
    severity: low
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.evidence_export_enabled
    title: Ensure Evidence Export is Enabled for IBM Cloud Resource Groups
    severity: low
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.dashboards_enabled
    title: Ensure Dashboards are Enabled for Resource Groups
    severity: low
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.config_rule_remediation_targets_bound
    title: Ensuring Remediation Targets for Resource Group Configurations
    severity: low
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.config_rule_required_rules_present
    title: Ensure Required Config Rules Exist in IBM Cloud Resource Groups
    severity: low
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.config_rule_rules_enabled
    title: Ensure Config Rule Monitoring Enabled for Resource Groups
    severity: low
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.policy_editors_rbac_least_privilege
    title: Enforce Least Privilege for Policy Editors in IBM Cloud Resource Groups
    severity: high
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.policy_no_wildcard_admin_actions
    title: Prohibit Wildcard Admin Actions in Resource Group Policies
    severity: critical
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.policy_versioning_and_change_audit_enabled
    title: Ensure Policy Versioning and Change Audit is Enabled for Resource Groups
    severity: medium
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.scp_mandatory_block_disabling_guardrail_services
    title: Enforce Guardrail Services to Strengthen Disaster Recovery
    severity: low
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.scp_mandatory_deny_iam_star_admin
    title: Enforce Mandatory Denial of IAM Star Admin Permissions in IBM Cloud
    severity: critical
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.scp_mandatory_require_mfa_for_console_where_supported
    title: Enforce MFA for IBM Cloud Console Access to Enhance Security
    severity: high
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: mfa
        operator: equals
        expected: TOTP
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "mfa" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.scp_no_allow_blockedstar_on_star_resources
    title: Enforce Granular Permissions by Restricting Wildcard Use in SCPs
    severity: low
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: locked
        operator: equals
        expected: false
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "locked" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.project_no_public_admin_roles
    title: Restrict Public Admin Roles in IBM Cloud Resource Groups
    severity: critical
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.project_required_guardrail_policies_attached
    title: Enforce Guardrail Policies for Project Resilience in IBM Cloud
    severity: low
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_group.project_security_services_mandatory_enabled
    title: Enforce Security Services in IBM Cloud Resource Groups
    severity: low
    for_each: resource_controller.resource_groups
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_groups
      response'
  - check_id: ibm.resource_controller.resource_instance.enabled
    title: Ensure IBM Cloud Resource Instances are Enabled for Security Compliance
    severity: low
    for_each: resource_controller.resource_instances
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_instances
      response'
  - check_id: ibm.resource_controller.resource_instance.global_types_tracked
    title: Ensure Global Resource Types are Tracked in IBM Cloud
    severity: low
    for_each: resource_controller.resource_instances
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_instances
      response'
  - check_id: ibm.resource_controller.resource_instance.secure_destination
    title: Enforce Secure Destination for IBM Cloud Resource Instances
    severity: low
    for_each: resource_controller.resource_instances
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.resource_instances
      response'
  - check_id: ibm.resource_controller.portfolio_shared_within_organization_only.portfolio_shared_within_organization_only_enabled
    title: Ensure Portfolios Are Shared Only Within the Organization
    severity: low
    for_each: resource_controller.portfolio_shared_within_organization_onlys
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.portfolio_shared_within_organization_onlys
      response'
  - check_id: ibm.resource_controller.scope.crypto_kms
    title: Ensure Encryption at Rest with IBM Cloud Key Management Service
    severity: medium
    for_each: resource_controller.scopes
    calls:
    - action: get_resource_controller_details
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in resource_controller.scopes
      response'
  - check_id: ibm.resource_controller.scope.crypto_kms_key
    title: Enforce Encryption at Rest with IBM Cloud KMS Keys
    severity: high
    for_each: resource_controller.scopes
    calls:
    - action: get_resource_controller_details
      fields:
      - path: encryption.kms_key_crn
        operator: exists
        expected: true
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "encryption.kms_key_crn" exists in resource_controller.scopes
      response'
  - check_id: ibm.resource_controller.scope.k8s_apiserver
    title: Ensure Secure Configuration of Kubernetes API Server in IBM Cloud
    severity: low
    for_each: resource_controller.scopes
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.scopes
      response'
  - check_id: ibm.resource_controller.scope.k8s_controllermanager
    title: Ensure Kubernetes Controller Manager Logs Are Monitored and Analyzed
    severity: low
    for_each: resource_controller.scopes
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.scopes
      response'
  - check_id: ibm.resource_controller.scope.k8s_etcd
    title: Ensure Secure Configuration of K8s Etcd in IBM Cloud
    severity: low
    for_each: resource_controller.scopes
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.scopes
      response'
  - check_id: ibm.resource_controller.scope.k8s_kubelet
    title: Ensure Secure Configuration of K8s Kubelet on IBM Cloud
    severity: low
    for_each: resource_controller.scopes
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.scopes
      response'
  - check_id: ibm.resource_controller.scope.k8s_rbac
    title: Ensure Kubernetes RBAC Policies are Configured for Resource Access
    severity: medium
    for_each: resource_controller.scopes
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.scopes
      response'
  - check_id: ibm.resource_controller.scope.k8s_scheduler
    title: Ensure Proper Configuration of Kubernetes Scheduler in IBM Cloud
    severity: low
    for_each: resource_controller.scopes
    calls:
    - action: get_resource_controller_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM resource_controller compliance
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in resource_controller.scopes
      response'
