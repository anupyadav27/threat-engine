direct_link:
  version: '1.0'
  provider: ibm
  service: direct_link
  scope: regional
  package: ibm-cloud-sdk-core
  client_class: Direct_LinkV1
  discovery:
  - discovery_id: direct_link.connection_redundancys
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for direct_link.connection_redundancys'
      save_as: connection_redundancys
  - discovery_id: direct_link.virtual_interface_redundancys
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for direct_link.virtual_interface_redundancys'
      save_as: virtual_interface_redundancys
  checks:
  - check_id: ibm.direct_link.connection_redundancy.connection_redundancy_enabled
    title: Ensure Redundancy in IBM Cloud Direct Link Connections
    severity: low
    for_each: direct_link.connection_redundancys
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in direct_link.connection_redundancys response'
  - check_id: ibm.direct_link.virtual_interface_redundancy.virtual_interface_redundancy_enabled
    title: Ensure Virtual Interface Redundancy for IBM Direct Link
    severity: low
    for_each: direct_link.virtual_interface_redundancys
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in direct_link.virtual_interface_redundancys response'
