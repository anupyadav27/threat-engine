event_streams:
  version: '1.0'
  provider: ibm
  service: event_streams
  scope: regional
  client_class: ResourceControllerV2
  discovery:
  - discovery_id: event_streams.stream_data_retention_periods
    calls:
    - action: list_resource_instances
      params: &id001 {}
      save_as: stream_data_retention_periods
  - discovery_id: event_streams.resources
    calls:
    - action: list_resource_instances
      params: {}
      save_as: resources
  - discovery_id: event_streams.queue_managers
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: queue_managers
  checks:
  - check_id: ibm.event_streams.stream_data_retention_period.stream_data_retention_period_enabled
    title: Ensure Stream Data Retention Period is Enabled for IBM Event Streams
    severity: medium
    for_each: stream_data_retention_periods
    calls:
    - action: get_event_streams_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_streams compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_streams.stream_data_retention_periods response'
  - check_id: ibm.event_streams.resource.stream_encrypted_at_rest
    title: Ensure Event Streams Data is Encrypted at Rest
    severity: medium
    for_each: resources
    calls:
    - action: get_event_streams_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM event_streams compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in event_streams.resources response'
  - check_id: ibm.event_streams.queue_manager.broker_active_deployment_mode_enabled
    title: Ensure Broker Active Deployment Mode is Enabled for Event Streams
    severity: low
    for_each: queue_managers
    calls:
    - action: get_event_streams_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_streams compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_streams.queue_managers response'
  - check_id: ibm.event_streams.queue_manager.broker_logging_enabled
    title: Ensure Broker Logging is Enabled for IBM Event Streams Queue Manager
    severity: medium
    for_each: queue_managers
    calls:
    - action: get_event_streams_resource
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM event_streams compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in event_streams.queue_managers response'
  - check_id: ibm.event_streams.queue_manager.deployment_mode
    title: Ensure Secure Deployment Mode for IBM Event Streams Queue Manager
    severity: low
    for_each: queue_managers
    calls:
    - action: get_event_streams_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM event_streams compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in event_streams.queue_managers response'
  sdk_package: ibm_platform_services
