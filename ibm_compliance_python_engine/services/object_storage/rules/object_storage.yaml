object_storage:
  version: '1.0'
  provider: ibm
  service: object_storage
  scope: regional
  package: ibm-cloud-sdk-core
  client_class: Object_StorageV1
  discovery:
  - discovery_id: object_storage.buckets
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for object_storage.buckets'
      save_as: buckets
  - discovery_id: object_storage.policies
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for object_storage.policies'
      save_as: policies
  - discovery_id: object_storage.notification_configurations
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for object_storage.notification_configurations'
      save_as: notification_configurations
  - discovery_id: object_storage.bucket_policys
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for object_storage.bucket_policys'
      save_as: bucket_policys
  checks:
  - check_id: ibm.object_storage.bucket.log_retention_policy_lock
    title: Enforce Log Retention Policy Lock on IBM Cloud Object Storage Buckets
    severity: low
    for_each: object_storage.buckets
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in object_storage.buckets response'
  - check_id: ibm.object_storage.bucket.public_access_blocked
    title: Ensure Public Access to Object Storage Buckets is Blocked
    severity: critical
    for_each: object_storage.buckets
    calls:
    - action: self
      fields:
      - path: public_access
        operator: equals
        expected: false
    note: 'MANUAL_REVIEW: Verify field path "public_access" exists in object_storage.buckets response'
  - check_id: ibm.object_storage.bucket.cross_region_replication
    title: Enforce Cross Region Replication for Object Storage Buckets
    severity: low
    for_each: object_storage.buckets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in object_storage.buckets response'
  - check_id: ibm.object_storage.bucket.lifecycle_enabled_ibm_vpc_..._cross_region_replication
    title: Ensure Lifecycle Management for Cross-Region Replication in IBM VPC Buckets
    severity: low
    for_each: object_storage.buckets
    calls:
    - action: self
      fields:
      - path: '...cross.region.replication'
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "...cross.region.replication" exists in object_storage.buckets response'
  - check_id: ibm.object_storage.bucket.lifecycle_enabled
    title: Ensure Lifecycle Policies are Enabled for IBM Cloud Object Storage Buckets
    severity: low
    for_each: object_storage.buckets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in object_storage.buckets response'
  - check_id: ibm.object_storage.bucket.server_access_logging_enabled_..._cluster_audit_logging
    title: Ensure Server Access Logging is Enabled for Object Storage Buckets
    severity: medium
    for_each: object_storage.buckets
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in object_storage.buckets response'
  - check_id: ibm.object_storage.bucket.server_access_logging_enabled_..._cross_region_replication
    title: Enable Server Access Logging and Cross-Region Replication for Buckets
    severity: medium
    for_each: object_storage.buckets
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in object_storage.buckets response'
  - check_id: ibm.object_storage.policy.public_access_blocked
    title: Enforce Private Access to Object Storage by Blocking Public Policies
    severity: critical
    for_each: object_storage.policies
    calls:
    - action: self
      fields:
      - path: public_access
        operator: equals
        expected: false
    note: 'MANUAL_REVIEW: Verify field path "public_access" exists in object_storage.policies response'
  - check_id: ibm.object_storage.bucket.encrypted_at_rest
    title: Enforce Encryption for IBM Cloud Object Storage Buckets at Rest
    severity: medium
    for_each: object_storage.buckets
    calls:
    - action: self
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in object_storage.buckets response'
  - check_id: ibm.object_storage.bucket.not_publicly_readable
    title: Ensure IBM Cloud Object Storage Buckets Are Not Publicly Readable
    severity: critical
    for_each: object_storage.buckets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in object_storage.buckets response'
  - check_id: ibm.object_storage.bucket.object_lock_or_immutability_enabled_where_supported
    title: Enable Object Lock or Immutability for IBM Cloud Buckets
    severity: low
    for_each: object_storage.buckets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in object_storage.buckets response'
  - check_id: ibm.object_storage.bucket.access_logging_enabled
    title: Ensure Access Logging is Enabled for IBM Cloud Object Storage Buckets
    severity: medium
    for_each: object_storage.buckets
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in object_storage.buckets response'
  - check_id: ibm.object_storage.bucket.block_public_access_enabled
    title: Ensure Object Storage Buckets Have Block Public Access Enabled
    severity: critical
    for_each: object_storage.buckets
    calls:
    - action: self
      fields:
      - path: public_access
        operator: equals
        expected: false
    note: 'MANUAL_REVIEW: Verify field path "public_access" exists in object_storage.buckets response'
  - check_id: ibm.object_storage.bucket.cmk_cmek_configured
    title: Ensure CMK for Object Storage Bucket Encryption is Configured
    severity: low
    for_each: object_storage.buckets
    calls:
    - action: self
      fields:
      - path: encryption.kms_key_crn
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "encryption.kms_key_crn" exists in object_storage.buckets response'
  - check_id: ibm.object_storage.bucket.encryption_at_rest_enabled
    title: Ensure Encryption at Rest for IBM Cloud Object Storage Buckets
    severity: high
    for_each: object_storage.buckets
    calls:
    - action: self
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in object_storage.buckets response'
  - check_id: ibm.object_storage.bucket.policy_denies_public_and_insecure
    title: Enforce Secure and Private Access to IBM Object Storage Buckets
    severity: critical
    for_each: object_storage.buckets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in object_storage.buckets response'
  - check_id: ibm.object_storage.bucket.require_tls_in_transit
    title: Enforce TLS for Secure Data Transmission in Object Storage Buckets
    severity: low
    for_each: object_storage.buckets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in object_storage.buckets response'
  - check_id: ibm.object_storage.bucket.versioning_enabled
    title: Ensure Versioning is Enabled for IBM Cloud Object Storage Buckets
    severity: low
    for_each: object_storage.buckets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in object_storage.buckets response'
  - check_id: ibm.object_storage.notification_configuration.notification_cross_account_restricted
    title: Restrict Cross-Account Notifications in IBM Object Storage
    severity: low
    for_each: object_storage.notification_configurations
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in object_storage.notification_configurations response'
  - check_id: ibm.object_storage.notification_configuration.notification_destination_encrypted
    title: Ensure Encryption of Notification Destinations in IBM Object Storage
    severity: medium
    for_each: object_storage.notification_configurations
    calls:
    - action: self
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in object_storage.notification_configurations response'
  - check_id: ibm.object_storage.notification_configuration.notification_destination_least_privilege
    title: Enforce Least Privilege for Object Storage Notification Destinations
    severity: high
    for_each: object_storage.notification_configurations
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in object_storage.notification_configurations response'
  - check_id: ibm.object_storage.bucket_policy.policy_deny_insecure_transport
    title: Enforce Secure Transport for IBM Cloud Object Storage Access
    severity: low
    for_each: object_storage.bucket_policys
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in object_storage.bucket_policys response'
  - check_id: ibm.object_storage.bucket_policy.policy_deny_unencrypted_puts
    title: Enforce Encryption for Object Storage Bucket Policies
    severity: medium
    for_each: object_storage.bucket_policys
    calls:
    - action: self
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in object_storage.bucket_policys response'
  - check_id: ibm.object_storage.bucket_policy.policy_no_public_principals
    title: Enforce No Public Access in IBM Object Storage Bucket Policies
    severity: critical
    for_each: object_storage.bucket_policys
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in object_storage.bucket_policys response'
  - check_id: ibm.object_storage.bucket_policy.policy_no_wildcards
    title: Ensure No Wildcards in IBM Cloud Object Storage Bucket Policies
    severity: low
    for_each: object_storage.bucket_policys
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in object_storage.bucket_policys response'
  - check_id: ibm.object_storage.bucket.metrics_enabled
    title: Ensure Metrics are Enabled for IBM Cloud Object Storage Buckets
    severity: low
    for_each: object_storage.buckets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in object_storage.buckets response'
  - check_id: ibm.object_storage.bucket.replication_enabled
    title: Ensure Replication Enabled for IBM Cloud Object Storage Buckets
    severity: low
    for_each: object_storage.buckets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in object_storage.buckets response'
  - check_id: ibm.object_storage.bucket.accounts
    title: Ensure Encryption for IBM Cloud Object Storage Buckets
    severity: low
    for_each: object_storage.buckets
    calls:
    - action: self
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in object_storage.buckets response'
