watson_discovery:
  version: '1.0'
  provider: ibm
  service: watson_discovery
  scope: regional
  client_class: ResourceControllerV2
  discovery:
  - discovery_id: watson_discovery.services
    calls:
    - action: list_resource_instances
      params: {}
      save_as: services
  checks:
  - check_id: ibm.watson_discovery.service.public_access_blocked
    title: Ensure Public Access is Blocked for IBM Watson Discovery Service
    severity: critical
    for_each: services
    calls:
    - action: get_watson_discovery_resource
      fields:
      - path: public_access
        operator: equals
        expected: false
      note: IBM watson_discovery compliance check
    note: 'MANUAL_REVIEW: Verify field path "public_access" exists in watson_discovery.services response'
  sdk_package: ibm_platform_services
