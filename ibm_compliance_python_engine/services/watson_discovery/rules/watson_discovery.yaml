watson_discovery:
  version: '1.0'
  provider: ibm
  service: watson_discovery
  scope: regional
  package: ibm-cloud-sdk-core
  client_class: Watson_DiscoveryV1
  discovery:
  - discovery_id: watson_discovery.services
    calls:
    - action: list_watson_discovery_resources
      note: IBM watson_discovery SDK method
      save_as: services
  checks:
  - check_id: ibm.watson_discovery.service.public_access_blocked
    title: Ensure Public Access is Blocked for IBM Watson Discovery Service
    severity: critical
    for_each: watson_discovery.services
    calls:
    - action: get_watson_discovery_resource
      fields:
      - path: public_access
        operator: equals
        expected: false
      note: IBM watson_discovery compliance check
    note: 'MANUAL_REVIEW: Verify field path "public_access" exists in watson_discovery.services
      response'
