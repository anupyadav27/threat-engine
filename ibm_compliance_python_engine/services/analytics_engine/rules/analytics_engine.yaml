analytics_engine:
  version: '1.0'
  provider: ibm
  service: analytics_engine
  scope: regional
  package: ibm-cloud-sdk-core
  client_class: Analytics_EngineV1
  discovery:
  - discovery_id: analytics_engine.resources
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for analytics_engine.resources'
      save_as: resources
  - discovery_id: analytics_engine.clusters
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for analytics_engine.clusters'
      save_as: clusters
  checks:
  - check_id: ibm.analytics_engine.resource.encrypted_with_cmks_disabled
    title: Enforce Customer-Managed Key Encryption for Analytics Engine
    severity: medium
    for_each: analytics_engine.resources
    calls:
    - action: self
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in analytics_engine.resources response'
  - check_id: ibm.analytics_engine.cluster.account_public_block_enabled
    title: Ensure Public Access Block is Enabled for IBM Analytics Engine Clusters
    severity: critical
    for_each: analytics_engine.clusters
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in analytics_engine.clusters response'
  - check_id: ibm.analytics_engine.cluster.master_nodes_no_public_ip
    title: Ensure Master Nodes in IBM Analytics Engine Lack Public IP Addresses
    severity: critical
    for_each: analytics_engine.clusters
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in analytics_engine.clusters response'
  - check_id: ibm.analytics_engine.cluster.publicly_accesible
    title: Prevent Public Access to IBM Analytics Engine Clusters
    severity: critical
    for_each: analytics_engine.clusters
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in analytics_engine.clusters response'
