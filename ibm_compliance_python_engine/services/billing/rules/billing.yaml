billing:
  version: '1.0'
  provider: ibm
  service: billing
  scope: account
  package: ibm-cloud-sdk-core
  client_class: BillingV1
  discovery:
  - discovery_id: billing.management_allocations
    calls:
    - action: list_billing_resources
      note: IBM billing service list method
      save_as: management_allocations
  - discovery_id: billing.management_anomalys
    calls:
    - action: list_billing_resources
      note: IBM billing service list method
      save_as: management_anomalys
  - discovery_id: billing.management_budgets
    calls:
    - action: list_billing_resources
      note: IBM billing service list method
      save_as: management_budgets
  - discovery_id: billing.management_categorys
    calls:
    - action: list_billing_resources
      note: IBM billing service list method
      save_as: management_categorys
  - discovery_id: billing.management_commitments
    calls:
    - action: list_billing_resources
      note: IBM billing service list method
      save_as: management_commitments
  checks:
  - check_id: ibm.billing.management_allocation.allocation_cost_tag_policy_enforced
    title: Enforce Allocation Cost Tag Policy for Cost Management
    severity: medium
    for_each: billing.management_allocations
    calls:
    - action: get_billing_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM billing compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in billing.management_allocations
      response'
  - check_id: ibm.billing.management_allocation.allocation_required_cost_tags_present
    title: Ensure Allocation Required Cost Tags Are Present for Billing Management
    severity: low
    for_each: billing.management_allocations
    calls:
    - action: get_billing_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM billing compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in billing.management_allocations
      response'
  - check_id: ibm.billing.management_allocation.allocation_untagged_resource_alerts_enabled
    title: Ensure Alerts for Untagged Resource Allocation in IBM Billing
    severity: low
    for_each: billing.management_allocations
    calls:
    - action: get_billing_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM billing compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in billing.management_allocations
      response'
  - check_id: ibm.billing.management_anomaly.anomaly_alert_destinations_configured
    title: Ensure Configuration of Anomaly Alert Destinations in Billing
    severity: low
    for_each: billing.management_anomalys
    calls:
    - action: get_billing_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM billing compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in billing.management_anomalys
      response'
  - check_id: ibm.billing.management_anomaly.anomaly_detectors_enabled
    title: Ensure Anomaly Detectors are Enabled for Billing Management
    severity: low
    for_each: billing.management_anomalys
    calls:
    - action: get_billing_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM billing compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in billing.management_anomalys
      response'
  - check_id: ibm.billing.management_anomaly.anomaly_severity_thresholds_configured
    title: Ensure Anomaly Severity Thresholds Are Configured for Billing Management
    severity: low
    for_each: billing.management_anomalys
    calls:
    - action: get_billing_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM billing compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in billing.management_anomalys
      response'
  - check_id: ibm.billing.management_budget.budget_alert_destinations_configured
    title: Ensure Budget Alert Destinations are Configured for Cost Management
    severity: low
    for_each: billing.management_budgets
    calls:
    - action: get_billing_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM billing compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in billing.management_budgets
      response'
  - check_id: ibm.billing.management_budget.budget_alert_thresholds_configured
    title: Ensure Budget Alert Thresholds are Configured in IBM Cloud Billing
    severity: low
    for_each: billing.management_budgets
    calls:
    - action: get_billing_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM billing compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in billing.management_budgets
      response'
  - check_id: ibm.billing.management_budget.budget_budgets_defined_for_accounts_or_projects
    title: Ensure Budgets Are Defined for Accounts or Projects in IBM Cloud
    severity: low
    for_each: billing.management_budgets
    calls:
    - action: get_billing_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM billing compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in billing.management_budgets
      response'
  - check_id: ibm.billing.management_budget.budget_modify_permissions_restricted
    title: Restrict Permissions for Modifying Billing Management Budgets
    severity: low
    for_each: billing.management_budgets
    calls:
    - action: get_billing_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM billing compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in billing.management_budgets
      response'
  - check_id: ibm.billing.management_category.access_billing_admins_mfa_required
    title: Enforce MFA for Billing Admins to Protect Financial Data
    severity: critical
    for_each: billing.management_categorys
    calls:
    - action: get_billing_details
      fields:
      - path: mfa
        operator: equals
        expected: TOTP
      note: IBM billing compliance check
    note: 'MANUAL_REVIEW: Verify field path "mfa" exists in billing.management_categorys
      response'
  - check_id: ibm.billing.management_category.access_billing_console_rbac_least_privilege
    title: Enforce Least Privilege for Billing Console Access via RBAC
    severity: high
    for_each: billing.management_categorys
    calls:
    - action: get_billing_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM billing compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in billing.management_categorys
      response'
  - check_id: ibm.billing.management_category.access_cost_data_exports_private_and_encrypted
    title: Ensure Billing Cost Data Exports are Private and Encrypted
    severity: medium
    for_each: billing.management_categorys
    calls:
    - action: get_billing_details
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM billing compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in billing.management_categorys
      response'
  - check_id: ibm.billing.management_category.access_cost_export_destinations_least_privilege
    title: Enforce Least Privilege for Cost Export Destinations in Billing
    severity: high
    for_each: billing.management_categorys
    calls:
    - action: get_billing_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM billing compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in billing.management_categorys
      response'
  - check_id: ibm.billing.management_commitment.savings_plan_approval_workflow_required
    title: Mandatory Approval Workflow for Savings Plan Commitments
    severity: low
    for_each: billing.management_commitments
    calls:
    - action: get_billing_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM billing compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in billing.management_commitments
      response'
  - check_id: ibm.billing.management_commitment.savings_plan_billing_admins_mfa_required
    title: Enforce MFA for Savings Plan Billing Admins to Secure Billing Access
    severity: critical
    for_each: billing.management_commitments
    calls:
    - action: get_billing_details
      fields:
      - path: mfa
        operator: equals
        expected: TOTP
      note: IBM billing compliance check
    note: 'MANUAL_REVIEW: Verify field path "mfa" exists in billing.management_commitments
      response'
  - check_id: ibm.billing.management_commitment.savings_plan_purchase_permissions_restricted
    title: Restrict Savings Plan Purchase Permissions for Enhanced Governance
    severity: low
    for_each: billing.management_commitments
    calls:
    - action: get_billing_details
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM billing compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in billing.management_commitments
      response'
