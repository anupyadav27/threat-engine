internet_services:
  version: '1.0'
  provider: ibm
  service: internet_services
  scope: regional
  package: ibm-cloud-sdk-core
  client_class: Internet_ServicesV1
  discovery:
  - discovery_id: internet_services.zones
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for internet_services.zones'
      save_as: zones
  - discovery_id: internet_services.advanced_protection_in_internet_facing_load_balancerss
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for internet_services.advanced_protection_in_internet_facing_load_balancerss'
      save_as: advanced_protection_in_internet_facing_load_balancerss
  - discovery_id: internet_services.resources
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for internet_services.resources'
      save_as: resources
  checks:
  - check_id: ibm.internet_services.zone.ddos_protection_proxied_status_enabled
    title: Ensure DDoS Protection Proxied Status is Enabled for Internet Services
    severity: low
    for_each: internet_services.zones
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in internet_services.zones response'
  - check_id: ibm.internet_services.zone.waf_enabled_status_enabled
    title: Enforce WAF Enabled Status for Enhanced Zone Security
    severity: low
    for_each: internet_services.zones
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in internet_services.zones response'
  - check_id: ibm.internet_services.advanced_protection_in_internet_facing_load_balancers.advanced_protection_in_internet_facing_load_balancers_en
    title: Ensure Advanced Protection for Internet-Facing Load Balancers
    severity: low
    for_each: internet_services.advanced_protection_in_internet_facing_load_balancerss
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in internet_services.advanced_protection_in_internet_facing_load_balancerss
      response'
  - check_id: ibm.internet_services.resource.global_webacl_logging_enabled
    title: Ensure Global Web ACL Logging is Enabled for IBM Internet Services
    severity: medium
    for_each: internet_services.resources
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in internet_services.resources response'
  - check_id: ibm.internet_services.resource.webacl_logging_enabled
    title: Ensure WebACL Logging is Enabled for IBM Internet Services
    severity: medium
    for_each: internet_services.resources
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in internet_services.resources response'
  - check_id: ibm.internet_services.resource.webacl_rule_logging_enabled
    title: Ensure WebACL Rule Logging is Enabled for IBM Internet Services
    severity: medium
    for_each: internet_services.resources
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in internet_services.resources response'
