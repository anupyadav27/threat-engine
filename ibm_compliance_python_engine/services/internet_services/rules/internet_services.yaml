internet_services:
  version: '1.0'
  provider: ibm
  service: internet_services
  scope: regional
  client_class: ResourceControllerV2
  discovery:
  - discovery_id: internet_services.zones
    calls:
    - action: list_resource_instances
      params: &id001 {}
      save_as: zones
  - discovery_id: internet_services.advanced_protection_in_internet_facing_load_balancerss
    calls:
    - action: list_resource_instances
      params: *id001
      save_as: advanced_protection_in_internet_facing_load_balancerss
  - discovery_id: internet_services.resources
    calls:
    - action: list_resource_instances
      params: {}
      save_as: resources
  checks:
  - check_id: ibm.internet_services.zone.ddos_protection_proxied_status_enabled
    title: Ensure DDoS Protection Proxied Status is Enabled for Internet Services
    severity: low
    for_each: zones
    calls:
    - action: get_internet_services_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM internet_services compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in internet_services.zones response'
  - check_id: ibm.internet_services.zone.waf_enabled_status_enabled
    title: Enforce WAF Enabled Status for Enhanced Zone Security
    severity: low
    for_each: zones
    calls:
    - action: get_internet_services_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM internet_services compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in internet_services.zones response'
  - check_id: ibm.internet_services.advanced_protection_in_internet_facing_load_balancers.advanced_protection_in_internet_facing_load_balancers_en
    title: Ensure Advanced Protection for Internet-Facing Load Balancers
    severity: low
    for_each: advanced_protection_in_internet_facing_load_balancerss
    calls:
    - action: get_internet_services_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM internet_services compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in internet_services.advanced_protection_in_internet_facing_load_balancerss
      response'
  - check_id: ibm.internet_services.resource.global_webacl_logging_enabled
    title: Ensure Global Web ACL Logging is Enabled for IBM Internet Services
    severity: medium
    for_each: resources
    calls:
    - action: get_internet_services_resource
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM internet_services compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in internet_services.resources response'
  - check_id: ibm.internet_services.resource.webacl_logging_enabled
    title: Ensure WebACL Logging is Enabled for IBM Internet Services
    severity: medium
    for_each: resources
    calls:
    - action: get_internet_services_resource
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM internet_services compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in internet_services.resources response'
  - check_id: ibm.internet_services.resource.webacl_rule_logging_enabled
    title: Ensure WebACL Rule Logging is Enabled for IBM Internet Services
    severity: medium
    for_each: resources
    calls:
    - action: get_internet_services_resource
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM internet_services compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in internet_services.resources response'
  sdk_package: ibm_platform_services
