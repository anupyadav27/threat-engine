api_gateway:
  version: '1.0'
  provider: ibm
  service: api_gateway
  scope: regional
  package: ibm-cloud-sdk-core
  client_class: Api_GatewayV1
  discovery:
  - discovery_id: api_gateway.apis
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for api_gateway.apis'
      save_as: apis
  - discovery_id: api_gateway.authorizers
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for api_gateway.authorizers'
      save_as: authorizers
  - discovery_id: api_gateway.api_keys
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for api_gateway.api_keys'
      save_as: api_keys
  - discovery_id: api_gateway.rate_limits
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for api_gateway.rate_limits'
      save_as: rate_limits
  - discovery_id: api_gateway.deployments
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for api_gateway.deployments'
      save_as: deployments
  - discovery_id: api_gateway.usage_plans
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for api_gateway.usage_plans'
      save_as: usage_plans
  - discovery_id: api_gateway.request_validators
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for api_gateway.request_validators'
      save_as: request_validators
  checks:
  - check_id: ibm.api_gateway.api.platform_endpoint_authn_required
    title: Enforce Authentication for API Platform Endpoints
    severity: low
    for_each: api_gateway.apis
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.apis response'
  - check_id: ibm.api_gateway.api.platform_endpoint_authz_policies_enforced
    title: Enforce Authorization Policies on IBM Cloud API Gateway Endpoints
    severity: low
    for_each: api_gateway.apis
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.apis response'
  - check_id: ibm.api_gateway.api.platform_endpoint_private_networking_enforced
    title: Enforce Private Networking for IBM Cloud API Gateway Endpoints
    severity: medium
    for_each: api_gateway.apis
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.apis response'
  - check_id: ibm.api_gateway.api.platform_endpoint_waf_attached
    title: Ensure WAF is Attached to API Gateway Platform Endpoints
    severity: low
    for_each: api_gateway.apis
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.apis response'
  - check_id: ibm.api_gateway.authorizer.platform_authorizer_cache_ttl_reasonable
    title: Ensure Reasonable Cache TTL for API Gateway Authorizer
    severity: low
    for_each: api_gateway.authorizers
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.authorizers response'
  - check_id: ibm.api_gateway.authorizer.platform_authorizer_tls_min_1_2_enforced
    title: Enforce TLS 1.2 for Secure API Gateway Authorizer Communications
    severity: medium
    for_each: api_gateway.authorizers
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.authorizers response'
  - check_id: ibm.api_gateway.authorizer.platform_authorizer_token_audience_restricted
    title: Ensure API Gateway Authorizer Token Audience is Restricted
    severity: low
    for_each: api_gateway.authorizers
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.authorizers response'
  - check_id: ibm.api_gateway.api_key.platform_key_expiration_required
    title: Enforce Expiration on API Gateway Platform API Keys
    severity: high
    for_each: api_gateway.api_keys
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.api_keys response'
  - check_id: ibm.api_gateway.api_key.platform_key_rotation_policy_defined
    title: Enforce API Key Rotation Policy for IBM API Gateway
    severity: high
    for_each: api_gateway.api_keys
    calls:
    - action: self
      fields:
      - path: last_rotation
        operator: age_days
        expected: 90
    note: 'MANUAL_REVIEW: Verify field path "last_rotation" exists in api_gateway.api_keys response'
  - check_id: ibm.api_gateway.api_key.platform_key_scopes_least_privilege
    title: Enforce Least Privilege on IBM Cloud API Gateway Key Scopes
    severity: high
    for_each: api_gateway.api_keys
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.api_keys response'
  - check_id: ibm.api_gateway.rate_limit.rate_limiting_api_quota_limit_configured
    title: Ensure API Gateway Rate Limiting Quota is Configured
    severity: low
    for_each: api_gateway.rate_limits
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.rate_limits response'
  - check_id: ibm.api_gateway.rate_limit.rate_limiting_api_stage_burst_limit_configured
    title: Ensure Burst Limit Configured for API Gateway Rate Limiting
    severity: low
    for_each: api_gateway.rate_limits
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.rate_limits response'
  - check_id: ibm.api_gateway.rate_limit.rate_limiting_api_stage_rate_limit_configured
    title: Ensure Rate Limiting Configured for API Gateway Stages
    severity: low
    for_each: api_gateway.rate_limits
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.rate_limits response'
  - check_id: ibm.api_gateway.rate_limit.rate_limiting_api_stage_throttle_overrides_not_unbounded
    title: Enforce Bounded Rate Limiting for API Stage Throttle Overrides
    severity: low
    for_each: api_gateway.rate_limits
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.rate_limits response'
  - check_id: ibm.api_gateway.rate_limit.rate_limiting_api_usage_plan_required_for_api_keys
    title: Enforce Rate Limiting Usage Plans for API Keys in IBM API Gateway
    severity: high
    for_each: api_gateway.rate_limits
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.rate_limits response'
  - check_id: ibm.api_gateway.api.waf_acl_attached
    title: Ensure WAF ACL is Attached to API Gateway for Enhanced Security
    severity: low
    for_each: api_gateway.apis
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.apis response'
  - check_id: ibm.api_gateway.deployment.platform_stage_logging_enabled
    title: Ensure Platform Stage Logging is Enabled for API Gateway Deployments
    severity: medium
    for_each: api_gateway.deployments
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in api_gateway.deployments response'
  - check_id: ibm.api_gateway.deployment.platform_stage_require_usage_plan_for_keys
    title: Enforce Usage Plans for API Gateway Keys at Platform Stage
    severity: high
    for_each: api_gateway.deployments
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.deployments response'
  - check_id: ibm.api_gateway.deployment.platform_stage_throttling_enabled
    title: Enforce Throttling on IBM API Gateway Platform Stage Deployments
    severity: low
    for_each: api_gateway.deployments
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.deployments response'
  - check_id: ibm.api_gateway.usage_plan.platform_usage_plan_quota_limits_configured
    title: Ensure Quota Limits Configured for API Gateway Usage Plans
    severity: low
    for_each: api_gateway.usage_plans
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.usage_plans response'
  - check_id: ibm.api_gateway.usage_plan.platform_usage_plan_rate_limits_configured
    title: Ensure Rate Limits Configured for API Gateway Usage Plans
    severity: low
    for_each: api_gateway.usage_plans
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.usage_plans response'
  - check_id: ibm.api_gateway.request_validator.validation_api_content_type_whitelist_enforced
    title: Enforce Whitelist Validation for API Content Types in IBM Cloud
    severity: low
    for_each: api_gateway.request_validators
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.request_validators response'
  - check_id: ibm.api_gateway.request_validator.validation_api_parameters_validation_enabled
    title: Ensure API Gateway Request Parameter Validation is Enabled
    severity: low
    for_each: api_gateway.request_validators
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.request_validators response'
  - check_id: ibm.api_gateway.request_validator.validation_api_request_body_size_limit_configured
    title: Enforce API Request Body Size Limits for Improved Security
    severity: low
    for_each: api_gateway.request_validators
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.request_validators response'
  - check_id: ibm.api_gateway.request_validator.validation_api_request_schema_validation_enabled
    title: Enforce API Request Schema Validation in IBM API Gateway
    severity: low
    for_each: api_gateway.request_validators
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.request_validators response'
  - check_id: ibm.api_gateway.request_validator.validation_api_required_security_headers_enforced
    title: Enforcement of Required Security Headers in API Gateway Requests
    severity: low
    for_each: api_gateway.request_validators
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.request_validators response'
  - check_id: ibm.api_gateway.request_validator.validation_api_response_schema_validation_enabled
    title: Ensure API Response Schema Validation is Enabled for Security Compliance
    severity: low
    for_each: api_gateway.request_validators
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in api_gateway.request_validators response'
  - check_id: ibm.api_gateway.api.monitoring_api_access_log_fields_identity_present
    title: Ensure API Gateway Access Logs Include Identity Fields
    severity: medium
    for_each: api_gateway.apis
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in api_gateway.apis response'
  - check_id: ibm.api_gateway.api.monitoring_api_access_log_sink_configured
    title: Ensure API Gateway Access Log Sink is Configured for Monitoring
    severity: medium
    for_each: api_gateway.apis
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in api_gateway.apis response'
  - check_id: ibm.api_gateway.api.monitoring_api_access_logging_enabled
    title: Ensure API Gateway Access Logging is Enabled for Monitoring
    severity: medium
    for_each: api_gateway.apis
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in api_gateway.apis response'
  - check_id: ibm.api_gateway.api.monitoring_api_execution_logging_level_minimum_error
    title: Ensure Minimum Error Level for API Execution Logging in IBM API Gateway
    severity: medium
    for_each: api_gateway.apis
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in api_gateway.apis response'
  - check_id: ibm.api_gateway.api.monitoring_api_logs_retention_days_minimum_configured
    title: Ensure Minimum Retention Days for API Gateway Monitoring Logs
    severity: medium
    for_each: api_gateway.apis
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in api_gateway.apis response'
