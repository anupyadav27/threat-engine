code_engine:
  version: '1.0'
  provider: ibm
  service: code_engine
  scope: regional
  package: ibm-cloud-sdk-core
  client_class: Code_EngineV1
  discovery:
  - discovery_id: code_engine.functions
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for code_engine.functions'
      save_as: functions
  - discovery_id: code_engine.applications
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for code_engine.applications'
      save_as: applications
  - discovery_id: code_engine.resources
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for code_engine.resources'
      save_as: resources
  checks:
  - check_id: ibm.code_engine.function.access_keys_configured
    title: Ensure Access Keys are Configured for IBM Code Engine Functions
    severity: high
    for_each: code_engine.functions
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in code_engine.functions response'
  - check_id: ibm.code_engine.function.identity_requiredadmin_privileges
    title: Enforce Admin Privileges for Code Engine Function Identities
    severity: critical
    for_each: code_engine.functions
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in code_engine.functions response'
  - check_id: ibm.code_engine.function.public_access_blocked
    title: Enforce Code Engine Function Public Access Restrictions
    severity: critical
    for_each: code_engine.functions
    calls:
    - action: self
      fields:
      - path: public_access
        operator: equals
        expected: false
    note: 'MANUAL_REVIEW: Verify field path "public_access" exists in code_engine.functions response'
  - check_id: ibm.code_engine.application.http_logs_enabled
    title: Ensure HTTP Logging is Enabled for IBM Code Engine Applications
    severity: low
    for_each: code_engine.applications
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in code_engine.applications response'
  - check_id: ibm.code_engine.application.tls_version_1_2_minimum_required
    title: Enforce Minimum TLS 1.2 for Secure IBM Code Engine Applications
    severity: medium
    for_each: code_engine.applications
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in code_engine.applications response'
  - check_id: ibm.code_engine.resource.fleet_default_internet_access_disabled
    title: Ensure Fleet Default Internet Access is Disabled in IBM Code Engine
    severity: medium
    for_each: code_engine.resources
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in code_engine.resources response'
  - check_id: ibm.code_engine.function.inside_vpc
    title: Ensure Code Engine Functions Reside Within a VPC for Enhanced Security
    severity: low
    for_each: code_engine.functions
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in code_engine.functions response'
  - check_id: ibm.code_engine.function.vpc_multi_az
    title: Ensure Code Engine Functions Utilize VPC Multi-AZ Deployment
    severity: low
    for_each: code_engine.functions
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in code_engine.functions response'
  - check_id: ibm.code_engine.application.engine_managed_updates_enabled
    title: Ensure Engine Managed Updates are Enabled for Code Engine Applications
    severity: low
    for_each: code_engine.applications
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in code_engine.applications response'
  - check_id: ibm.code_engine.application.engine_task_definition_logging_enabled
    title: Ensure Logging is Enabled for IBM Code Engine Task Definitions
    severity: medium
    for_each: code_engine.applications
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in code_engine.applications response'
  - check_id: ibm.code_engine.resource.environment_cloudwatch_logging_enabled
    title: Ensure Cloudwatch Logging is Enabled for IBM Code Engine Environments
    severity: medium
    for_each: code_engine.resources
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in code_engine.resources response'
  - check_id: ibm.code_engine.resource.environment_monitoring_logging_enabled
    title: Ensure Environment Monitoring Logging is Enabled for Code Engine
    severity: medium
    for_each: code_engine.resources
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in code_engine.resources response'
  - check_id: ibm.code_engine.function.reserved_concurrency
    title: Ensuring Reserved Concurrency for IBM Code Engine Functions
    severity: low
    for_each: code_engine.functions
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in code_engine.functions response'
  - check_id: ibm.code_engine.resource.statemachine_logging_enabled
    title: Ensure Logging is Enabled for IBM Code Engine State Machines
    severity: medium
    for_each: code_engine.resources
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in code_engine.resources response'
