backup:
  version: '1.0'
  provider: ibm
  service: backup
  scope: regional
  package: ibm-cloud-sdk-core
  client_class: BackupV1
  discovery:
  - discovery_id: backup.backup_automations
    calls:
    - action: list_backup_plans
      note: IBM Backup Service list_backup_plans method
      save_as: backup_automations
  - discovery_id: backup.backup_backup_jobs
    calls:
    - action: list_backup_jobs
      note: IBM Backup Service list_backup_jobs method
      save_as: backup_backup_jobs
  - discovery_id: backup.backup_backup_plans
    calls:
    - action: list_backup_plans
      note: IBM Backup Service list_backup_plans method
      save_as: backup_backup_plans
  - discovery_id: backup.backup_backup_vaults
    calls:
    - action: list_backup_plans
      note: IBM Backup Service list_backup_plans method
      save_as: backup_backup_vaults
  - discovery_id: backup.backup_jobs
    calls:
    - action: list_backup_jobs
      note: IBM Backup Service list_backup_jobs method
      save_as: backup_jobs
  - discovery_id: backup.backup_notifications
    calls:
    - action: list_backup_plans
      note: IBM Backup Service list_backup_plans method
      save_as: backup_notifications
  - discovery_id: backup.backup_plans
    calls:
    - action: list_backup_plans
      note: IBM Backup Service list_backup_plans method
      save_as: backup_plans
  - discovery_id: backup.backup_recovery_instances
    calls:
    - action: list_backup_plans
      note: IBM Backup Service list_backup_plans method
      save_as: backup_recovery_instances
  - discovery_id: backup.backup_recovery_plans
    calls:
    - action: list_backup_plans
      note: IBM Backup Service list_backup_plans method
      save_as: backup_recovery_plans
  - discovery_id: backup.backup_replications
    calls:
    - action: list_backup_plans
      note: IBM Backup Service list_backup_plans method
      save_as: backup_replications
  - discovery_id: backup.backup_restore_jobs
    calls:
    - action: list_backup_jobs
      note: IBM Backup Service list_backup_jobs method
      save_as: backup_restore_jobs
  - discovery_id: backup.backup_runbooks
    calls:
    - action: list_backup_plans
      note: IBM Backup Service list_backup_plans method
      save_as: backup_runbooks
  - discovery_id: backup.backup_source_servers
    calls:
    - action: list_backup_plans
      note: IBM Backup Service list_backup_plans method
      save_as: backup_source_servers
  - discovery_id: backup.backup_test_restores
    calls:
    - action: list_restore_jobs
      note: IBM Backup Service list_restore_jobs method
      save_as: backup_test_restores
  - discovery_id: backup.functions
    calls:
    - action: list_backup_plans
      note: IBM Backup Service list_backup_plans method
      save_as: functions
  - discovery_id: backup.functions_event_sources
    calls:
    - action: list_backup_plans
      note: IBM Backup Service list_backup_plans method
      save_as: functions_event_sources
  - discovery_id: backup.functions_functions
    calls:
    - action: list_backup_plans
      note: IBM Backup Service list_backup_plans method
      save_as: functions_functions
  - discovery_id: backup.functions_function_versions
    calls:
    - action: list_backup_plans
      note: IBM Backup Service list_backup_plans method
      save_as: functions_function_versions
  - discovery_id: backup.functions_layers
    calls:
    - action: list_backup_plans
      note: IBM Backup Service list_backup_plans method
      save_as: functions_layers
  - discovery_id: backup.functions_provisioned_concurrencys
    calls:
    - action: list_backup_plans
      note: IBM Backup Service list_backup_plans method
      save_as: functions_provisioned_concurrencys
  - discovery_id: backup.functions_versions
    calls:
    - action: list_backup_plans
      note: IBM Backup Service list_backup_plans method
      save_as: functions_versions
  - discovery_id: backup.resources
    calls:
    - action: list_backup_plans
      note: IBM Backup Service list_backup_plans method
      save_as: resources
  checks:
  - check_id: ibm.backup.backup_automation.dr_automation_artifacts_encrypted_and_private
    title: Ensure DR Artifacts are Encrypted and Access Controlled
    severity: medium
    for_each: backup.backup_automations
    calls:
    - action: get_backup_plan
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in backup.backup_automations
      response'
  - check_id: ibm.backup.backup_automation.dr_automation_change_audit_logging_enabled
    title: Ensure DR Automation Change Audit Logging is Enabled in IBM Cloud Backup
    severity: medium
    for_each: backup.backup_automations
    calls:
    - action: get_backup_plan
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in backup.backup_automations
      response'
  - check_id: ibm.backup.backup_automation.dr_automation_execution_roles_least_privilege
    title: Enforce Least Privilege for DR Automation Execution Roles in IBM Cloud
      Backup
    severity: high
    for_each: backup.backup_automations
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_automations
      response'
  - check_id: ibm.backup.backup_backup_job.backup_monitoring_alert_destinations_configured
    title: Ensure Backup Job Alert Destinations Are Configured
    severity: medium
    for_each: backup.backup_backup_jobs
    calls:
    - action: get_backup_job
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_backup_jobs
      response'
  - check_id: ibm.backup.backup_backup_job.backup_monitoring_alert_rules_for_job_failures_configured
    title: Configure Alerts for Backup Job Failures in IBM Cloud
    severity: medium
    for_each: backup.backup_backup_jobs
    calls:
    - action: get_backup_job
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_backup_jobs
      response'
  - check_id: ibm.backup.backup_backup_job.backup_monitoring_alert_rules_for_sla_breach_configured
    title: Ensure SLA Breach Alert Rules for Backup Jobs Are Configured
    severity: medium
    for_each: backup.backup_backup_jobs
    calls:
    - action: get_backup_job
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_backup_jobs
      response'
  - check_id: ibm.backup.backup_backup_job.backup_monitoring_metrics_export_enabled
    title: Ensure Backup Monitoring Metrics Export is Enabled for IBM Cloud Backups
    severity: medium
    for_each: backup.backup_backup_jobs
    calls:
    - action: get_backup_job
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_backup_jobs
      response'
  - check_id: ibm.backup.backup_backup_plan.backup_access_backup_admins_mfa_required
    title: Enforce MFA for Backup Admins on IBM Cloud Backup Plans
    severity: critical
    for_each: backup.backup_backup_plans
    calls:
    - action: get_backup_plan
      fields:
      - path: mfa
        operator: equals
        expected: TOTP
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "mfa" exists in backup.backup_backup_plans
      response'
  - check_id: ibm.backup.backup_backup_plan.backup_access_backup_keys_access_least_privilege
    title: Enforce Least Privilege on Backup Key Access in IBM Cloud
    severity: high
    for_each: backup.backup_backup_plans
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_backup_plans
      response'
  - check_id: ibm.backup.backup_backup_plan.backup_access_backup_vault_rbac_least_privilege
    title: Enforce Least Privilege on Backup Vault Access with RBAC
    severity: high
    for_each: backup.backup_backup_plans
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_backup_plans
      response'
  - check_id: ibm.backup.backup_backup_plan.backup_access_no_public_access_to_backup_vault
    title: Ensure No Public Access to Backup Vault in IBM Cloud Backup Plans
    severity: critical
    for_each: backup.backup_backup_plans
    calls:
    - action: get_backup_plan
      fields:
      - path: public_access
        operator: equals
        expected: false
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "public_access" exists in backup.backup_backup_plans
      response'
  - check_id: ibm.backup.backup_backup_plan.dr_backup_destination_private_only
    title: Ensure DR Backup Destinations Are Private for Enhanced Security
    severity: medium
    for_each: backup.backup_backup_plans
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_backup_plans
      response'
  - check_id: ibm.backup.backup_backup_plan.dr_backup_encrypted_at_rest_cmek
    title: Ensure DR Backups Use CMEK for Encryption at Rest
    severity: medium
    for_each: backup.backup_backup_plans
    calls:
    - action: get_backup_plan
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in backup.backup_backup_plans
      response'
  - check_id: ibm.backup.backup_backup_plan.dr_backup_immutable_or_worm_enabled_where_supported
    title: Ensure DR Backups Are Immutable or WORM-Enabled Where Supported
    severity: medium
    for_each: backup.backup_backup_plans
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_backup_plans
      response'
  - check_id: ibm.backup.backup_backup_plan.dr_backup_schedule_defined_min_frequency
    title: Ensure Minimum Frequency for DR Backup Schedules in IBM Cloud
    severity: medium
    for_each: backup.backup_backup_plans
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_backup_plans
      response'
  - check_id: ibm.backup.backup_backup_plan.policy_assignment_complete
    title: Ensuring Complete Backup Plan Policy Assignment on IBM Cloud
    severity: medium
    for_each: backup.backup_backup_plans
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_backup_plans
      response'
  - check_id: ibm.backup.backup_backup_plan.unprotected_assets_alert
    title: Alert on Unprotected Assets in IBM Cloud Backup Plans
    severity: low
    for_each: backup.backup_backup_plans
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_backup_plans
      response'
  - check_id: ibm.backup.backup_backup_plan.backup_health_failed_jobs_alerting_enabled
    title: Ensure Backup Health Failed Jobs Alerting is Enabled
    severity: medium
    for_each: backup.backup_backup_plans
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_backup_plans
      response'
  - check_id: ibm.backup.backup_backup_plan.backup_health_job_success_rate_minimum
    title: Ensure Minimum Success Rate for Backup Health Jobs
    severity: medium
    for_each: backup.backup_backup_plans
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_backup_plans
      response'
  - check_id: ibm.backup.backup_backup_plan.backup_health_last_backup_recency_within_days
    title: Ensure Timely Backups for Effective Disaster Recovery
    severity: medium
    for_each: backup.backup_backup_plans
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_backup_plans
      response'
  - check_id: ibm.backup.backup_backup_plan.backup_inventory_resource_discovery_synced
    title: Ensure Backup Inventory Resource Discovery is Synced
    severity: medium
    for_each: backup.backup_backup_plans
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_backup_plans
      response'
  - check_id: ibm.backup.backup_backup_vault.backup_encryption_backup_storage_immutability_enabled
    title: Ensure Backup Vault Encryption and Immutability are Enabled
    severity: high
    for_each: backup.backup_backup_vaults
    calls:
    - action: get_backup_plan
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in backup.backup_backup_vaults
      response'
  - check_id: ibm.backup.backup_backup_vault.backup_encryption_cmk_cmek_key_configured
    title: Ensure Backup Vault Encryption with Customer-Managed Keys (CMK)
    severity: high
    for_each: backup.backup_backup_vaults
    calls:
    - action: get_backup_plan
      fields:
      - path: encryption.kms_key_crn
        operator: exists
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption.kms_key_crn" exists in backup.backup_backup_vaults
      response'
  - check_id: ibm.backup.backup_backup_vault.backup_encryption_at_rest_enabled
    title: Ensure Backup Vault Encryption at Rest is Enabled
    severity: high
    for_each: backup.backup_backup_vaults
    calls:
    - action: get_backup_plan
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in backup.backup_backup_vaults
      response'
  - check_id: ibm.backup.backup_backup_vault.backup_encryption_in_transit_tls_min_1_2
    title: Enforce TLS 1.2+ for Backup Vault Encryption in Transit
    severity: high
    for_each: backup.backup_backup_vaults
    calls:
    - action: get_backup_plan
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in backup.backup_backup_vaults
      response'
  - check_id: ibm.backup.backup_backup_vault.backup_encryption_key_policy_least_privilege
    title: Enforce Least Privilege for Backup Encryption Key Policies
    severity: high
    for_each: backup.backup_backup_vaults
    calls:
    - action: get_backup_policy
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in backup.backup_backup_vaults
      response'
  - check_id: ibm.backup.backup_backup_vault.backup_encryption_key_rotation_enabled
    title: Ensure Backup Vault Encryption Key Rotation is Enabled
    severity: high
    for_each: backup.backup_backup_vaults
    calls:
    - action: get_backup_plan
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in backup.backup_backup_vaults
      response'
  - check_id: ibm.backup.backup_job.job_logs_enabled
    title: Ensure Backup Job Logs are Enabled for Audit and Monitoring
    severity: low
    for_each: backup.backup_jobs
    calls:
    - action: get_backup_job
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in backup.backup_jobs
      response'
  - check_id: ibm.backup.backup_job.job_network_private_only
    title: Enforce Private Network Access for Backup Jobs
    severity: medium
    for_each: backup.backup_jobs
    calls:
    - action: get_backup_job
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_jobs
      response'
  - check_id: ibm.backup.backup_job.job_roles_least_privilege
    title: Ensure Backup Job Roles Adhere to Least Privilege Principle
    severity: high
    for_each: backup.backup_jobs
    calls:
    - action: get_backup_job
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_jobs
      response'
  - check_id: ibm.backup.backup_notification.dr_communication_channels_configured
    title: Ensure DR Communication Channels Are Configured for Backup Notifications
    severity: low
    for_each: backup.backup_notifications
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_notifications
      response'
  - check_id: ibm.backup.backup_notification.dr_communication_destinations_access_least_privilege
    title: Ensure Least Privilege for DR Communication Destinations in Backup Notifications
    severity: high
    for_each: backup.backup_notifications
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_notifications
      response'
  - check_id: ibm.backup.backup_notification.dr_communication_no_public_webhooks_requiredauth
    title: Enforce Authentication for Backup Notifications to Mitigate DR Risks
    severity: critical
    for_each: backup.backup_notifications
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_notifications
      response'
  - check_id: ibm.backup.backup_plan.plan_approvals_required_for_changes
    title: Mandatory Approval for Backup Plan Modifications
    severity: low
    for_each: backup.backup_plans
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_plans
      response'
  - check_id: ibm.backup.backup_plan.plan_change_audit_logging_enabled
    title: Ensure Audit Logging for Backup Plan Changes is Enabled
    severity: medium
    for_each: backup.backup_plans
    calls:
    - action: get_backup_plan
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in backup.backup_plans
      response'
  - check_id: ibm.backup.backup_plan.plan_storage_encrypted_and_private
    title: Ensure Backup Plan Storage is Encrypted and Access Restricted
    severity: medium
    for_each: backup.backup_plans
    calls:
    - action: get_backup_plan
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in backup.backup_plans
      response'
  - check_id: ibm.backup.backup_recovery_instance.instance_private_network_only
    title: Ensure Backup Instances Use Private Networks for Enhanced Security
    severity: medium
    for_each: backup.backup_recovery_instances
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_recovery_instances
      response'
  - check_id: ibm.backup.backup_recovery_instance.instance_security_groups_restrictive
    title: Restrict Instance Security Groups for Backup Recovery Instances
    severity: low
    for_each: backup.backup_recovery_instances
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_recovery_instances
      response'
  - check_id: ibm.backup.backup_recovery_instance.instance_volumes_encrypted
    title: Ensure Backup Instance Volumes are Encrypted at Rest
    severity: medium
    for_each: backup.backup_recovery_instances
    calls:
    - action: get_backup_plan
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in backup.backup_recovery_instances
      response'
  - check_id: ibm.backup.backup_recovery_plan.dr_documentation_access_rbac_least_privilege
    title: Ensure Least Privilege Access to DR Documentation via RBAC
    severity: high
    for_each: backup.backup_recovery_plans
    calls:
    - action: get_backup_plan
      fields:
      - path: state
        operator: exists
        expected: enabled
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in backup.backup_recovery_plans
      response'
  - check_id: ibm.backup.backup_recovery_plan.dr_documentation_storage_encrypted_and_private
    title: Ensure DR Documentation Storage is Encrypted and Access-Controlled
    severity: low
    for_each: backup.backup_recovery_plans
    calls:
    - action: get_backup_plan
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in backup.backup_recovery_plans
      response'
  - check_id: ibm.backup.backup_replication.dr_replication_auth_roles_least_privilege
    title: Enforce Least Privilege for DR Replication Auth Roles in Backup Services
    severity: high
    for_each: backup.backup_replications
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_replications
      response'
  - check_id: ibm.backup.backup_replication.dr_replication_cross_region_encrypted
    title: Ensuring Encrypted Cross-Region DR Replication for Backups
    severity: low
    for_each: backup.backup_replications
    calls:
    - action: get_backup_plan
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in backup.backup_replications
      response'
  - check_id: ibm.backup.backup_replication.dr_replication_encryption_in_transit_tls_required
    title: Ensure TLS Encryption for Backup DR Replication In Transit
    severity: high
    for_each: backup.backup_replications
    calls:
    - action: get_backup_plan
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in backup.backup_replications
      response'
  - check_id: ibm.backup.backup_replication.dr_replication_lag_monitoring_alerts_enabled
    title: Enable Alerts for DR Replication Lag in IBM Cloud Backup Services
    severity: medium
    for_each: backup.backup_replications
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_replications
      response'
  - check_id: ibm.backup.backup_restore_job.dr_restore_cross_account_restore_blocked_by_policy
    title: Restrict Cross-Account DR Restore to Enhance Policy Compliance
    severity: low
    for_each: backup.backup_restore_jobs
    calls:
    - action: get_backup_job
      fields:
      - path: locked
        operator: equals
        expected: false
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "locked" exists in backup.backup_restore_jobs
      response'
  - check_id: ibm.backup.backup_restore_job.dr_restore_from_encrypted_backups_only
    title: Ensure Disaster Recovery Restores Utilize Encrypted Backups Only
    severity: medium
    for_each: backup.backup_restore_jobs
    calls:
    - action: get_backup_job
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in backup.backup_restore_jobs
      response'
  - check_id: ibm.backup.backup_restore_job.dr_restore_logs_and_artifacts_encrypted
    title: Ensure Encryption of DR Restore Logs and Artifacts at Rest
    severity: medium
    for_each: backup.backup_restore_jobs
    calls:
    - action: get_backup_job
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in backup.backup_restore_jobs
      response'
  - check_id: ibm.backup.backup_restore_job.dr_restore_roles_least_privilege
    title: Enforce Least Privilege for Disaster Recovery Restore Roles
    severity: high
    for_each: backup.backup_restore_jobs
    calls:
    - action: get_backup_job
      fields:
      - path: state
        operator: exists
        expected: enabled
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in backup.backup_restore_jobs
      response'
  - check_id: ibm.backup.backup_runbook.dr_runbook_access_rbac_least_privilege
    title: Ensure Least Privilege RBAC for DR Runbook Access in IBM Cloud Backup
    severity: high
    for_each: backup.backup_runbooks
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_runbooks
      response'
  - check_id: ibm.backup.backup_runbook.dr_runbook_change_audit_logging_enabled
    title: Ensure Audit Logging for DR Runbook Changes is Enabled
    severity: medium
    for_each: backup.backup_runbooks
    calls:
    - action: get_backup_plan
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in backup.backup_runbooks
      response'
  - check_id: ibm.backup.backup_runbook.dr_runbook_storage_encrypted_and_private
    title: Ensure DR Runbook Storage is Encrypted and Private
    severity: medium
    for_each: backup.backup_runbooks
    calls:
    - action: get_backup_plan
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in backup.backup_runbooks
      response'
  - check_id: ibm.backup.backup_source_server.source_agent_to_service_tls_required
    title: Enforce TLS for Secure Backup Source to Service Communication
    severity: medium
    for_each: backup.backup_source_servers
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_source_servers
      response'
  - check_id: ibm.backup.backup_source_server.source_encryption_at_rest_cmek_where_supported
    title: Ensure Source Encryption At Rest with CMEK for Backup Servers
    severity: high
    for_each: backup.backup_source_servers
    calls:
    - action: get_backup_plan
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in backup.backup_source_servers
      response'
  - check_id: ibm.backup.backup_source_server.source_min_telemtry_required_no_pii
    title: Ensure Minimal Telemetry Without PII for Backup Source Servers
    severity: low
    for_each: backup.backup_source_servers
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_source_servers
      response'
  - check_id: ibm.backup.backup_test_restore.dr_testing_execution_roles_least_privilege
    title: Enforce Least Privilege for DR Testing Execution Roles in IBM Cloud Backup
    severity: high
    for_each: backup.backup_test_restores
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.backup_test_restores
      response'
  - check_id: ibm.backup.backup_test_restore.dr_testing_logs_enabled
    title: Ensuring DR Testing Logs Are Enabled for IBM Backup Services
    severity: low
    for_each: backup.backup_test_restores
    calls:
    - action: get_backup_plan
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in backup.backup_test_restores
      response'
  - check_id: ibm.backup.backup_test_restore.dr_testing_results_storage_encrypted_and_private
    title: Ensure DR Testing Results are Encrypted and Private in IBM Cloud Backup
    severity: medium
    for_each: backup.backup_test_restores
    calls:
    - action: get_backup_plan
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in backup.backup_test_restores
      response'
  - check_id: ibm.backup.function.url_authentication
    title: Enforce URL Authentication for Backup Function Access
    severity: high
    for_each: backup.functions
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.functions
      response'
  - check_id: ibm.backup.functions_event_source.serverless_event_source_permissions_least_privilege
    title: Enforce Least Privilege for Serverless Event Source Permissions
    severity: high
    for_each: backup.functions_event_sources
    calls:
    - action: get_backup_plan
      fields:
      - path: state
        operator: exists
        expected: enabled
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in backup.functions_event_sources
      response'
  - check_id: ibm.backup.functions_event_source.serverless_event_source_authenticated
    title: Ensure Authentication for Serverless Event Source in IBM Backup
    severity: low
    for_each: backup.functions_event_sources
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.functions_event_sources
      response'
  - check_id: ibm.backup.functions_function.paas_app_env_secrets_from_vault_only
    title: Enforce Vault-Only Secrets for PaaS App Environment in IBM Cloud
    severity: high
    for_each: backup.functions_functions
    calls:
    - action: get_backup_plan
      fields:
      - path: state
        operator: exists
        expected: enabled
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in backup.functions_functions
      response'
  - check_id: ibm.backup.functions_function.paas_app_logging_enabled
    title: Enable Logging for PaaS Applications Using IBM Cloud Functions
    severity: medium
    for_each: backup.functions_functions
    calls:
    - action: get_backup_plan
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in backup.functions_functions
      response'
  - check_id: ibm.backup.functions_function.paas_app_private_networking_enforced
    title: Enforce Private Networking for IBM Cloud Functions Backup Services
    severity: medium
    for_each: backup.functions_functions
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.functions_functions
      response'
  - check_id: ibm.backup.functions_function.paas_app_tls_min_1_2_enforced
    title: Enforce TLS 1.2+ for PaaS App Backup Function Security
    severity: medium
    for_each: backup.functions_functions
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.functions_functions
      response'
  - check_id: ibm.backup.functions_function.serverless_function_dead_letter_queue_configured
    title: Ensure Dead Letter Queue is Configured for Serverless Functions
    severity: low
    for_each: backup.functions_functions
    calls:
    - action: get_backup_plan
      fields:
      - path: state
        operator: exists
        expected: enabled
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in backup.functions_functions
      response'
  - check_id: ibm.backup.functions_function.serverless_function_env_no_plaintext_secrets
    title: Prevent Plaintext Secrets in Serverless Function Environments
    severity: high
    for_each: backup.functions_functions
    calls:
    - action: get_backup_plan
      fields:
      - path: state
        operator: exists
        expected: enabled
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in backup.functions_functions
      response'
  - check_id: ibm.backup.functions_function.serverless_function_logging_and_tracing_enabled
    title: Ensure Serverless Function Logging and Tracing for Enhanced Security
    severity: medium
    for_each: backup.functions_functions
    calls:
    - action: get_backup_plan
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in backup.functions_functions
      response'
  - check_id: ibm.backup.functions_function.serverless_function_role_least_privilege
    title: Enforce Least Privilege for Serverless Function Roles
    severity: high
    for_each: backup.functions_functions
    calls:
    - action: get_backup_plan
      fields:
      - path: state
        operator: exists
        expected: enabled
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in backup.functions_functions
      response'
  - check_id: ibm.backup.functions_function.serverless_function_vpc_private_networking_enabled
    title: Ensure VPC Private Networking for Serverless Functions
    severity: medium
    for_each: backup.functions_functions
    calls:
    - action: get_backup_plan
      fields:
      - path: state
        operator: exists
        expected: enabled
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in backup.functions_functions
      response'
  - check_id: ibm.backup.functions_function_version.paas_app_version_artifact_encrypted
    title: Enforce Encryption for PaaS App Version Artifacts in IBM Backup
    severity: medium
    for_each: backup.functions_function_versions
    calls:
    - action: get_backup_plan
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in backup.functions_function_versions
      response'
  - check_id: ibm.backup.functions_function_version.paas_app_version_immutable
    title: Ensure IBM Cloud Functions Version Immutability for Backup Security
    severity: low
    for_each: backup.functions_function_versions
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.functions_function_versions
      response'
  - check_id: ibm.backup.functions_layer.serverless_layer_source_trust_verified
    title: Ensure Trust Verification of Serverless Layer Sources for Backup
    severity: low
    for_each: backup.functions_layers
    calls:
    - action: get_backup_plan
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in backup.functions_layers
      response'
  - check_id: ibm.backup.functions_layer.serverless_layer_version_immutable
    title: Enforce Immutability on Serverless Layer Versions for Enhanced Security
    severity: low
    for_each: backup.functions_layers
    calls:
    - action: get_backup_plan
      fields:
      - path: state
        operator: exists
        expected: enabled
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in backup.functions_layers
      response'
  - check_id: ibm.backup.functions_provisioned_concurrency.serverless_prov_conc_execution_role_least_privilege
    title: Enforce Least Privilege for Serverless Provisioned Concurrency Roles
    severity: high
    for_each: backup.functions_provisioned_concurrencys
    calls:
    - action: get_backup_plan
      fields:
      - path: state
        operator: exists
        expected: enabled
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in backup.functions_provisioned_concurrencys
      response'
  - check_id: ibm.backup.functions_version.serverless_version_published_and_immutable
    title: Ensure Serverless Function Versions are Published and Immutable
    severity: low
    for_each: backup.functions_versions
    calls:
    - action: get_backup_plan
      fields:
      - path: state
        operator: exists
        expected: enabled
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in backup.functions_versions
      response'
  - check_id: ibm.backup.functions_version.serverless_version_rollforward_rollback_controls_present
    title: Ensure Control Mechanisms for Serverless Version Rollforward/Rollback
    severity: low
    for_each: backup.functions_versions
    calls:
    - action: get_backup_plan
      fields:
      - path: state
        operator: exists
        expected: enabled
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in backup.functions_versions
      response'
  - check_id: ibm.backup.resource.task_logging_enabled
    title: Ensure Task Logging is Enabled for IBM Cloud Backup Resources
    severity: medium
    for_each: backup.resources
    calls:
    - action: get_backup_plan
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in backup.resources
      response'
  - check_id: ibm.backup.resource.fileshare_encryption_enabled
    title: Ensure Encryption for Fileshare Backup Resources in IBM Cloud
    severity: high
    for_each: backup.resources
    calls:
    - action: get_backup_plan
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in backup.resources
      response'
  - check_id: ibm.backup.resource.server_in_transit_encryption_enabled
    title: Ensure Server In Transit Encryption for IBM Cloud Backup Resources
    severity: high
    for_each: backup.resources
    calls:
    - action: get_backup_plan
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Backup Service compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in backup.resources
      response'
