databases:
  version: '1.0'
  provider: ibm
  service: databases
  scope: regional
  client_class: CloudDatabasesV5
  discovery:
  - discovery_id: databases.workgroup_encryptions
    calls:
    - action: list_resource_instances
      params: {}
      save_as: workgroup_encryptions
  - discovery_id: databases.resources
    calls:
    - action: list_resource_instances
      params: {}
      save_as: resources
  - discovery_id: databases.dataset_cmk_encryptions
    calls:
    - action: list_resource_instances
      params: {}
      save_as: dataset_cmk_encryptions
  - discovery_id: databases.dataset_public_accesss
    calls:
    - action: list_resource_instances
      params: {}
      save_as: dataset_public_accesss
  - discovery_id: databases.table_cmk_encryptions
    calls:
    - action: list_resource_instances
      params: {}
      save_as: table_cmk_encryptions
  - discovery_id: databases.instances
    calls:
    - action: list_resource_instances
      params: {}
      save_as: instances
  - discovery_id: databases.accounts
    calls:
    - action: list_resource_instances
      params: {}
      save_as: accounts
  - discovery_id: databases.auto_minor_version_upgrades
    calls:
    - action: list_resource_instances
      params: {}
      save_as: auto_minor_version_upgrades
  - discovery_id: databases.deployments
    calls:
    - action: list_deployables
      params: {}
      save_as: deployments
  - discovery_id: databases.configurations
    calls:
    - action: list_resource_instances
      params: {}
      save_as: configurations
  - discovery_id: databases.whitelists
    calls:
    - action: list_resource_instances
      params: {}
      save_as: whitelists
  - discovery_id: databases.backups
    calls:
    - action: list_deployment_backups
      params: {}
      save_as: backups
  - discovery_id: databases.users
    calls:
    - action: list_resource_instances
      params: {}
      save_as: users
  - discovery_id: databases.connections
    calls:
    - action: list_resource_instances
      params: {}
      save_as: connections
  - discovery_id: databases.clusters
    calls:
    - action: list_resource_instances
      params: {}
      save_as: clusters
  - discovery_id: databases.backup_retentions
    calls:
    - action: list_resource_instances
      params: {}
      save_as: backup_retentions
  - discovery_id: databases.flexible_server_audit_log_connection_activateds
    calls:
    - action: list_resource_instances
      params: {}
      save_as: flexible_server_audit_log_connection_activateds
  - discovery_id: databases.flexible_server_minimum_tls_version_12s
    calls:
    - action: list_resource_instances
      params: {}
      save_as: flexible_server_minimum_tls_version_12s
  - discovery_id: databases.services
    calls:
    - action: list_resource_instances
      params: {}
      save_as: services
  - discovery_id: databases.query_workgroup_encryptions
    calls:
    - action: list_resource_instances
      params: {}
      save_as: query_workgroup_encryptions
  - discovery_id: databases.auditing_retention_90_dayss
    calls:
    - action: list_resource_instances
      params: {}
      save_as: auditing_retention_90_dayss
  - discovery_id: databases.recommended_minimal_tls_versions
    calls:
    - action: list_resource_instances
      params: {}
      save_as: recommended_minimal_tls_versions
  - discovery_id: databases.unrestricted_inbound_accesss
    calls:
    - action: list_resource_instances
      params: {}
      save_as: unrestricted_inbound_accesss
  checks:
  - check_id: ibm.databases.workgroup_encryption.workgroup_encryption_enabled
    title: Ensure Workgroup Encryption is Enabled for IBM Cloud Databases
    severity: high
    for_each: workgroup_encryptions
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in databases.workgroup_encryptions response'
  - check_id: ibm.databases.resource.workgroup_logging_enabled
    title: Ensure Workgroup Logging is Enabled for IBM Cloud Databases
    severity: medium
    for_each: resources
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in databases.resources response'
  - check_id: ibm.databases.dataset_cmk_encryption.dataset_cmk_encryption_enabled
    title: Ensure Dataset CMK Encryption is Enabled for IBM Cloud Databases
    severity: high
    for_each: dataset_cmk_encryptions
    calls:
    - action: get_deployment
      fields:
      - path: encryption.kms_key_crn
        operator: exists
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption.kms_key_crn" exists in databases.dataset_cmk_encryptions response'
  - check_id: ibm.databases.dataset_public_access.dataset_public_access_blocked
    title: Block Public Access to IBM Cloud Database Datasets
    severity: critical
    for_each: dataset_public_accesss
    calls:
    - action: get_deployment
      fields:
      - path: public_access
        operator: equals
        expected: false
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "public_access" exists in databases.dataset_public_accesss response'
  - check_id: ibm.databases.table_cmk_encryption.table_cmk_encryption_enabled
    title: Ensure Table CMK Encryption is Enabled for IBM Cloud Databases
    severity: high
    for_each: table_cmk_encryptions
    calls:
    - action: get_deployment
      fields:
      - path: encryption.kms_key_crn
        operator: exists
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption.kms_key_crn" exists in databases.table_cmk_encryptions response'
  - check_id: ibm.databases.instance.automated_backups
    title: Enforce Automated Backups for IBM Cloud Databases
    severity: medium
    for_each: instances
    calls:
    - action: get_deployment
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in databases.instances response'
  - check_id: ibm.databases.instance.postgres_log_connections_flag
    title: Ensure PostgreSQL Log Connections Flag is Enabled for Audit Logging
    severity: low
    for_each: instances
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in databases.instances response'
  - check_id: ibm.databases.instance.postgres_log_disconnections_flag
    title: Enforce Postgres Log Disconnections for Enhanced Audit Logging
    severity: low
    for_each: instances
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in databases.instances response'
  - check_id: ibm.databases.instance.postgres_log_error_verbosity_flag
    title: Ensure Postgres Error Verbosity is Set for Detailed Audit Logs
    severity: low
    for_each: instances
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in databases.instances response'
  - check_id: ibm.databases.instance.postgres_log_min_duration_statement_flag
    title: Ensure Postgres Log Min Duration Statement is Configured
    severity: low
    for_each: instances
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in databases.instances response'
  - check_id: ibm.databases.instance.postgres_log_min_error_statement_flag
    title: Ensure Postgres Log Min Error Statement Flag is Configured
    severity: low
    for_each: instances
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in databases.instances response'
  - check_id: ibm.databases.instance.postgres_log_min_messages_flag
    title: Configure Postgres Log Min Messages for Enhanced Audit Logging
    severity: low
    for_each: instances
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in databases.instances response'
  - check_id: ibm.databases.instance.postgres_log_statement_flag
    title: Enforce Logging of SQL Statements in IBM Cloud PostgreSQL Instances
    severity: low
    for_each: instances
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in databases.instances response'
  - check_id: ibm.databases.instance.public_access_blocked
    title: Enforce No Public Access to IBM Cloud Database Instances
    severity: critical
    for_each: instances
    calls:
    - action: get_deployment
      fields:
      - path: public_access
        operator: equals
        expected: false
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "public_access" exists in databases.instances response'
  - check_id: ibm.databases.instance.public_ip
    title: Restrict Public IP Access for IBM Cloud Databases
    severity: critical
    for_each: instances
    calls:
    - action: get_deployment
      fields:
      - path: deployment.endpoints.public
        operator: exists
        expected: null
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.instances response'
  - check_id: ibm.databases.instance.ssl_connections
    title: Enforce SSL Connections for IBM Cloud Databases Instances
    severity: medium
    for_each: instances
    calls:
    - action: get_deployment
      fields:
      - path: deployment.connection.https.composed
        operator: exists
        expected: null
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.instances response'
  - check_id: ibm.databases.account.firewall_use_selected_networks
    title: Ensure Firewall Configured to Allow Only Selected Networks
    severity: medium
    for_each: accounts
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.accounts response'
  - check_id: ibm.databases.account.use_private_endpoints
    title: Enforce Private Endpoints for IBM Databases Network Security
    severity: low
    for_each: accounts
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.accounts response'
  - check_id: ibm.databases.auto_minor_version_upgrade.auto_minor_version_upgrade_required
    title: Enforce Auto Minor Version Upgrade for Database Security
    severity: medium
    for_each: auto_minor_version_upgrades
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.auto_minor_version_upgrades response'
  - check_id: ibm.databases.instance.vpc_deployment_required
    title: Enforce VPC Deployment for IBM Cloud Databases Instances
    severity: medium
    for_each: instances
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.instances response'
  - check_id: ibm.databases.deployment.default_admin_ibm_databases_instance_default_admin
    title: Ensure Default Admin Credentials Are Not Used in IBM Databases Instances
    severity: critical
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.deployment.db_cluster_audit_logging_enabled
    title: Ensure Db Cluster Audit Logging is Enabled for Enhanced Security
    severity: medium
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.deployment.db_cluster_deletion_protection_enabled
    title: Ensure Db Cluster Deletion Protection is Enabled for Enhanced Security
    severity: medium
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.deployment.db_cluster_encryption_at_rest_cmek
    title: Db Cluster Encryption at Rest using Customer Managed Encryption Keys (CMEK)
    severity: high
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.deployment.db_cluster_minor_version_auto_upgrade_enabled
    title: Ensure Auto Upgrade for Db Cluster Minor Version is Enabled
    severity: medium
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.deployment.db_cluster_private_networking_enforced
    title: Enforce Private Networking for IBM Cloud Database Clusters
    severity: medium
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.deployment.db_instance_deletion_protection_enabled
    title: Ensure Db Instance Deletion Protection is Enabled for Secure Data Retention
    severity: medium
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.deployment.db_instance_encryption_at_rest_enabled
    title: Ensure Encryption at Rest for IBM Cloud Database Deployments
    severity: high
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.deployment.db_instance_iam_or_managed_identity_auth_en_where_supported
    title: Enforce IAM or Managed Identity Authentication for Database Instances
    severity: medium
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.deployment.db_instance_public_access_disabled
    title: Ensure IBM Cloud Database Instances Have Public Access Disabled
    severity: critical
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: public_access
        operator: equals
        expected: false
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.deployment.db_instance_require_tls_in_transit
    title: Enforce TLS for Secure In-Transit Database Communications
    severity: medium
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: deployment.connection.https.composed
        operator: exists
        expected: null
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.deployment.paas_db_encryption_at_rest_enabled
    title: Ensure Encryption at Rest for IBM Cloud Databases Deployments
    severity: high
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.deployment.paas_db_public_access_disabled
    title: Disable Public Access to IBM Cloud PaaS Databases for Enhanced Security
    severity: critical
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: public_access
        operator: equals
        expected: false
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.deployment.paas_db_require_tls_in_transit
    title: Ensure TLS for In-Transit Data Encryption in IBM Cloud Databases
    severity: medium
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.deployment.db_option_group_insecure_extensions_not_enabled
    title: Ensure Insecure Extensions Are Disabled in Database Option Groups
    severity: medium
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.deployment.db_option_group_only_approved_extensions_enabled
    title: Enforce Approved Extensions in IBM Cloud Database Option Groups
    severity: medium
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.configuration.db_parameter_group_audit_logging_enabled_where_supported
    title: Ensure Database Audit Logging is Enabled Where Supported
    severity: medium
    for_each: configurations
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in databases.configurations response'
  - check_id: ibm.databases.configuration.db_parameter_group_insecure_features_disabled_where_applicable
    title: Enforce Secure Database Parameter Configurations to Mitigate Risks
    severity: medium
    for_each: configurations
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.configurations response'
  - check_id: ibm.databases.configuration.db_parameter_group_require_ssl
    title: Enforce SSL for Database Parameter Group to Enhance Data Security
    severity: medium
    for_each: configurations
    calls:
    - action: get_deployment
      fields:
      - path: deployment.connection.https.composed
        operator: exists
        expected: null
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.configurations response'
  - check_id: ibm.databases.whitelist.db_sg_egress_restricted
    title: Enforce Egress Restriction on Database Security Group Whitelisting
    severity: medium
    for_each: whitelists
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.whitelists response'
  - check_id: ibm.databases.whitelist.db_sg_no_0_ingress_on_db_ports
    title: Restrict Ingress Traffic on Database Ports to Authorized IPs
    severity: medium
    for_each: whitelists
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.whitelists response'
  - check_id: ibm.databases.whitelist.db_sg_only_required_ports_open
    title: Ensure Only Required Ports Are Open for Database Security Groups
    severity: medium
    for_each: whitelists
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.whitelists response'
  - check_id: ibm.databases.backup.db_cluster_snapshot_cross_account_sharing_restricted
    title: Restrict Cross-Account Sharing of DB Cluster Snapshots
    severity: low
    for_each: backups
    calls:
    - action: get_deployment
      fields:
      - path: deployment.backup.enabled
        operator: exists
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.backups response'
  - check_id: ibm.databases.backup.db_cluster_snapshot_cross_region_copy_encrypted
    title: Ensure Encrypted Cross-Region Backup for DB Cluster Snapshots
    severity: medium
    for_each: backups
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in databases.backups response'
  - check_id: ibm.databases.backup.db_cluster_snapshot_encrypted
    title: Ensure Encryption of Database Cluster Snapshots for Enhanced Data Security
    severity: medium
    for_each: backups
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in databases.backups response'
  - check_id: ibm.databases.backup.db_cluster_snapshot_not_publicly_shared
    title: Ensure Database Cluster Snapshots Are Not Publicly Shared
    severity: critical
    for_each: backups
    calls:
    - action: get_deployment
      fields:
      - path: deployment.backup.enabled
        operator: exists
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.backups response'
  - check_id: ibm.databases.backup.db_snapshot_cross_account_sharing_restricted
    title: Restrict Cross-Account Sharing of Database Backup Snapshots
    severity: low
    for_each: backups
    calls:
    - action: get_deployment
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in databases.backups response'
  - check_id: ibm.databases.backup.db_snapshot_cross_region_copy_encrypted
    title: Enforce Encryption for Cross-Region Db Snapshot Copies
    severity: medium
    for_each: backups
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in databases.backups response'
  - check_id: ibm.databases.backup.db_snapshot_encrypted
    title: Ensure Encryption of IBM Cloud Database Snapshot Backups
    severity: medium
    for_each: backups
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in databases.backups response'
  - check_id: ibm.databases.backup.db_snapshot_not_publicly_shared
    title: Ensure Database Snapshots Are Not Publicly Accessible
    severity: critical
    for_each: backups
    calls:
    - action: get_deployment
      fields:
      - path: deployment.backup.enabled
        operator: exists
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.backups response'
  - check_id: ibm.databases.deployment.db_subnet_group_private_subnets_only
    title: Ensure Database Deployments Use Private Subnets Only
    severity: low
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.user.db_user_approved_list_of_superusers_only
    title: Restrict Database Superuser Access to Approved List Only
    severity: medium
    for_each: users
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.users response'
  - check_id: ibm.databases.user.db_user_no_unused_or_default_superusers
    title: Ensure No Unused or Default Superuser Accounts in Databases
    severity: medium
    for_each: users
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.users response'
  - check_id: ibm.databases.user.db_user_password_..._where_supported
    title: Enforce Strong Passwords for IBM Cloud Database Users
    severity: medium
    for_each: users
    calls:
    - action: get_deployment
      fields:
      - path: '...where.supported'
        operator: exists
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "...where.supported" exists in databases.users response'
  - check_id: ibm.databases.deployment.public_access_blocked
    title: Enforce Public Access Restrictions on IBM Cloud Databases Deployments
    severity: critical
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: public_access
        operator: equals
        expected: false
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.deployment.maintenance_settings
    title: Enforce Encryption for Database Maintenance Settings
    severity: medium
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.user.data_warehouse_endpoint_authz_no_anonymous_access
    title: Ensure No Anonymous Access to Data Warehouse Endpoints
    severity: medium
    for_each: users
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.users response'
  - check_id: ibm.databases.user.data_warehouse_endpoint_authz_rbac_least_privilege
    title: Enforce RBAC Least Privilege for Data Warehouse Endpoint Authorization
    severity: high
    for_each: users
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.users response'
  - check_id: ibm.databases.deployment.data_admin_access_least_privilege
    title: Enforce Least Privilege for Data Admin Access in IBM Cloud Databases
    severity: critical
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.deployment.data_audit_logging_enabled
    title: Ensuring Data Audit Logging is Enabled for IBM Cloud Databases
    severity: medium
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.deployment.data_encryption_at_rest_cmek
    title: Enforce CMEK for Data Encryption at Rest in IBM Cloud Databases
    severity: high
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.deployment.data_private_networking_enforced
    title: Enforce Private Networking for Database Deployments
    severity: medium
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.deployment.data_tls_min_1_2_enforced
    title: Enforce Minimum TLS 1.2 for Secure Database Deployments
    severity: medium
    for_each: deployments
    calls:
    - action: get_deployment
      fields:
      - path: deployment.connection.https.composed
        operator: exists
        expected: null
      note: IBM Databases compliance check using real API fields
  - check_id: ibm.databases.connection.data_access_allowed_cidrs_minimized
    title: Restrict Data Access CIDRs for Enhanced Database Security
    severity: medium
    for_each: connections
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.connections response'
  - check_id: ibm.databases.connection.data_access_private_only
    title: Ensure Database Connections Use Private Networking Only
    severity: low
    for_each: connections
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.connections response'
  - check_id: ibm.databases.connection.data_access_tls_required
    title: Enforce TLS for Secure Database Connection Data Access
    severity: medium
    for_each: connections
    calls:
    - action: get_deployment
      fields:
      - path: deployment.connection.https.composed
        operator: exists
        expected: null
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.connections response'
  - check_id: ibm.databases.configuration.data_logging_enabled_where_supported
    title: Ensure Data Logging is Enabled for Supported IBM Cloud Databases
    severity: medium
    for_each: configurations
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in databases.configurations response'
  - check_id: ibm.databases.configuration.data_require_ssl
    title: Enforce SSL for Data Encryption in IBM Cloud Databases
    severity: medium
    for_each: configurations
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in databases.configurations response'
  - check_id: ibm.databases.backup.data_cross_region_copy_encrypted
    title: Ensure Cross-Region Backup Data Encryption for IBM Cloud Databases
    severity: medium
    for_each: backups
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in databases.backups response'
  - check_id: ibm.databases.backup.data_encrypted_at_rest_cmek
    title: Ensure Database Backups Are Encrypted with Customer-Managed Keys
    severity: medium
    for_each: backups
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in databases.backups response'
  - check_id: ibm.databases.backup.data_not_publicly_shared
    title: Ensure Backups of Database Data Are Not Publicly Accessible
    severity: critical
    for_each: backups
    calls:
    - action: get_deployment
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in databases.backups response'
  - check_id: ibm.databases.resource.endpoint_redis_in_transit_encryption_enabled
    title: Ensure Redis In-Transit Encryption is Enabled for Enhanced Data Security
    severity: high
    for_each: resources
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in databases.resources response'
  - check_id: ibm.databases.instance.multi_az_enabled
    title: Ensure Multi-AZ Deployment for IBM Cloud Databases Instances
    severity: medium
    for_each: instances
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.instances response'
  - check_id: ibm.databases.resource.replication_task_source_logging_enabled
    title: Ensure Replication Task Source Logging is Enabled for Databases
    severity: medium
    for_each: resources
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in databases.resources response'
  - check_id: ibm.databases.resource.replication_task_target_logging_enabled
    title: Ensure Replication Task Target Logging is Enabled for IBM Databases
    severity: medium
    for_each: resources
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in databases.resources response'
  - check_id: ibm.databases.cluster.monitoring_log_export
    title: Enforce Monitoring Log Export for IBM Cloud Databases Clusters
    severity: medium
    for_each: clusters
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in databases.clusters response'
  - check_id: ibm.databases.cluster.multi_az_enabled
    title: Ensure Multi-AZ Deployment for IBM Cloud Databases Clusters
    severity: medium
    for_each: clusters
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.clusters response'
  - check_id: ibm.databases.cluster.storage_encrypted
    title: Ensure Database Cluster Storage is Encrypted at Rest
    severity: medium
    for_each: clusters
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in databases.clusters response'
  - check_id: ibm.databases.backup_retention.backup_retention_enabled
    title: Ensure Backup Retention is Enabled for IBM Cloud Databases
    severity: medium
    for_each: backup_retentions
    calls:
    - action: get_deployment
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in databases.backup_retentions response'
  - check_id: ibm.databases.cluster.automatic_failover_enabled
    title: Ensure Automatic Failover is Enabled for IBM Cloud Databases Clusters
    severity: medium
    for_each: clusters
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.clusters response'
  - check_id: ibm.databases.cluster.in_transit_encryption_enabled
    title: Ensure In-Transit Encryption is Enabled for IBM Cloud Databases
    severity: high
    for_each: clusters
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in databases.clusters response'
  - check_id: ibm.databases.cluster.rest_encryption_enabled
    title: Ensure Encryption at Rest is Enabled for IBM Cloud Databases Clusters
    severity: high
    for_each: clusters
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in databases.clusters response'
  - check_id: ibm.databases.flexible_server_audit_log_connection_activated.flexible_server_audit_log_connection_activated_enabled
    title: Ensure Audit Log Connection Activation for Flexible Server
    severity: medium
    for_each: flexible_server_audit_log_connection_activateds
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in databases.flexible_server_audit_log_connection_activateds
      response'
  - check_id: ibm.databases.resource.flexible_server_audit_log_enabled
    title: Ensure Flexible Server Audit Logs are Enabled for IBM Databases
    severity: medium
    for_each: resources
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in databases.resources response'
  - check_id: ibm.databases.flexible_server_minimum_tls_version_12.flexible_server_minimum_tls_version_12_required
    title: Enforce Minimum TLS 1.2 for IBM Cloud Flexible Databases
    severity: medium
    for_each: flexible_server_minimum_tls_version_12s
    calls:
    - action: get_deployment
      fields:
      - path: deployment.connection.https.composed
        operator: exists
        expected: null
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.flexible_server_minimum_tls_version_12s response'
  - check_id: ibm.databases.resource.flexible_server_ssl_connection_enabled
    title: Ensure SSL Connection is Enabled for Flexible Server Databases
    severity: medium
    for_each: resources
    calls:
    - action: get_deployment
      fields:
      - path: deployment.connection.https.composed
        operator: exists
        expected: null
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.resources response'
  - check_id: ibm.databases.cluster.copy_tags_to_snapshots_enabled
    title: Ensure Tags are Copied to Database Snapshots for Enhanced Traceability
    severity: low
    for_each: clusters
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.clusters response'
  - check_id: ibm.databases.cluster.integration_monitoring_logs
    title: Ensure Integration Monitoring Logs for IBM Databases Clusters
    severity: medium
    for_each: clusters
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in databases.clusters response'
  - check_id: ibm.databases.cluster.multi_az_deployment_enabled
    title: Ensure Multi-AZ Deployment for IBM Cloud Databases Clusters
    severity: medium
    for_each: clusters
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.clusters response'
  - check_id: ibm.databases.cluster.snapshot_encrypted
    title: Ensure Database Cluster Snapshots Are Encrypted
    severity: medium
    for_each: clusters
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in databases.clusters response'
  - check_id: ibm.databases.service.domains_audit_logging_enabled
    title: Ensure Audit Logging is Enabled for IBM Cloud Databases Services
    severity: medium
    for_each: services
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in databases.services response'
  - check_id: ibm.databases.service.domains_cloudwatch_logging_enabled
    title: Ensure Domains Cloudwatch Logging is Enabled for IBM Cloud Databases
    severity: medium
    for_each: services
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in databases.services response'
  - check_id: ibm.databases.service.domains_encryption_at_rest_enabled
    title: Ensure Encryption at Rest is Enabled for IBM Cloud Databases
    severity: high
    for_each: services
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in databases.services response'
  - check_id: ibm.databases.service.domains_fault_tolerant_data_nodes
    title: Ensure Fault Tolerant Data Nodes for Database Services
    severity: medium
    for_each: services
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.services response'
  - check_id: ibm.databases.service.domains_fault_tolerant_master_nodes
    title: Ensuring Fault Tolerance for Master Nodes in IBM Databases
    severity: medium
    for_each: services
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.services response'
  - check_id: ibm.databases.service.domains_internal_user_database_enabled
    title: Enforce Internal User Database for Enhanced Domain Security
    severity: medium
    for_each: services
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.services response'
  - check_id: ibm.databases.service.domains_monitoring_logging_enabled
    title: Ensure Domains Monitoring Logging is Enabled for IBM Cloud Databases
    severity: medium
    for_each: services
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in databases.services response'
  - check_id: ibm.databases.service.domains_node_to_node_encryption_enabled
    title: Ensure Node-to-Node Encryption is Enabled for IBM Cloud Databases
    severity: high
    for_each: services
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in databases.services response'
  - check_id: ibm.databases.service.domains_not_publicly_accessible
    title: Ensure Database Service Domains Are Not Publicly Accessible
    severity: critical
    for_each: services
    calls:
    - action: get_deployment
      fields:
      - path: public_access
        operator: equals
        expected: false
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "public_access" exists in databases.services response'
  - check_id: ibm.databases.instance.backup_enabled
    title: Ensure Backups are Enabled for IBM Cloud Database Instances
    severity: medium
    for_each: instances
    calls:
    - action: get_deployment
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in databases.instances response'
  - check_id: ibm.databases.instance.copy_tags_to_snapshots_enabled
    title: Ensure Tags Are Copied to Database Snapshots
    severity: low
    for_each: instances
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.instances response'
  - check_id: ibm.databases.instance.deletion_protection
    title: Enable Deletion Protection for IBM Cloud Database Instances
    severity: medium
    for_each: instances
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.instances response'
  - check_id: ibm.databases.instance.integration_cloudwatch_logs
    title: Ensure Database Instances Integrate with Cloudwatch Logs
    severity: low
    for_each: instances
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in databases.instances response'
  - check_id: ibm.databases.instance.no_public_access
    title: Enforce No Public Access for IBM Cloud Database Instances
    severity: critical
    for_each: instances
    calls:
    - action: get_deployment
      fields:
      - path: public_access
        operator: equals
        expected: false
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "public_access" exists in databases.instances response'
  - check_id: ibm.databases.instance.performance_insights_enabled
    title: Enforce Performance Insights for Enhanced Database Security
    severity: medium
    for_each: instances
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.instances response'
  - check_id: ibm.databases.resource.multi_az_enabled
    title: Ensure Multi-AZ Deployment for Enhanced Database Resilience
    severity: medium
    for_each: resources
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.resources response'
  - check_id: ibm.databases.resource.backup_enabled
    title: Ensure Backups Are Enabled for IBM Cloud Databases
    severity: medium
    for_each: resources
    calls:
    - action: get_deployment
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in databases.resources response'
  - check_id: ibm.databases.cluster.audit_logging
    title: Enforce Audit Logging for IBM Cloud Databases Clusters
    severity: medium
    for_each: clusters
    calls:
    - action: get_deployment
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in databases.clusters response'
  - check_id: ibm.databases.cluster.automated_snapshot
    title: Enforce Automated Snapshots for Database Clusters
    severity: low
    for_each: clusters
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.clusters response'
  - check_id: ibm.databases.cluster.encrypted_at_rest
    title: Ensure IBM Cloud Databases Clusters Are Encrypted At Rest
    severity: medium
    for_each: clusters
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in databases.clusters response'
  - check_id: ibm.databases.cluster.enhanced_vpc_routing
    title: Enforce Enhanced VPC Routing for Secure IBM Cloud Databases
    severity: medium
    for_each: clusters
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.clusters response'
  - check_id: ibm.databases.cluster.public_access_blocked
    title: Enforce Blocked Public Access for IBM Cloud Database Clusters
    severity: critical
    for_each: clusters
    calls:
    - action: get_deployment
      fields:
      - path: public_access
        operator: equals
        expected: false
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "public_access" exists in databases.clusters response'
  - check_id: ibm.databases.query_workgroup_encryption.query_workgroup_encryption_enabled
    title: Ensure Encryption is Enabled for Query Workgroups in IBM Databases
    severity: high
    for_each: query_workgroup_encryptions
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in databases.query_workgroup_encryptions response'
  - check_id: ibm.databases.auditing_retention_90_days.auditing_retention_90_days_enabled
    title: Ensure 90-Day Retention of Database Audit Logs
    severity: medium
    for_each: auditing_retention_90_dayss
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.auditing_retention_90_dayss response'
  - check_id: ibm.databases.resource.microsoft_defender_enabled
    title: Ensure Microsoft Defender is Enabled for Database Resources
    severity: medium
    for_each: resources
    calls:
    - action: get_deployment
      fields:
      - path: deployment.status
        operator: exists
        expected: active
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.resources response'
  - check_id: ibm.databases.recommended_minimal_tls_version.recommended_minimal_tls_version_required
    title: Enforce Minimal TLS Version for Database Security
    severity: medium
    for_each: recommended_minimal_tls_versions
    calls:
    - action: get_deployment
      fields:
      - path: deployment.connection.https.composed
        operator: exists
        expected: null
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in databases.recommended_minimal_tls_versions response'
  - check_id: ibm.databases.resource.tde_encrypted_with_cmk
    title: Ensure Databases Use TDE with Customer-Managed Keys
    severity: medium
    for_each: resources
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in databases.resources response'
  - check_id: ibm.databases.resource.tde_encryption_enabled
    title: Ensure TDE Encryption is Enabled for Databases on IBM Cloud
    severity: high
    for_each: resources
    calls:
    - action: get_deployment
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in databases.resources response'
  - check_id: ibm.databases.unrestricted_inbound_access.unrestricted_inbound_access_blocked
    title: Restrict Inbound Access to IBM Cloud Databases for Enhanced Security
    severity: critical
    for_each: unrestricted_inbound_accesss
    calls:
    - action: get_deployment
      fields:
      - path: locked
        operator: equals
        expected: false
      note: IBM Databases compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "locked" exists in databases.unrestricted_inbound_accesss response'
  sdk_package: ibm_cloud_databases
