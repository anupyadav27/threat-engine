account:
  version: '1.0'
  provider: ibm
  service: account
  scope: account
  package: ibm-cloud-sdk-core
  client_class: AccountV1
  discovery:
  - discovery_id: account.maintain_current_contact_detailss
    calls:
    - action: list_account_resources
      note: IBM account SDK method
      save_as: maintain_current_contact_detailss
  - discovery_id: account.maintain_different_contact_details_to_security_billing_and_operationss
    calls:
    - action: list_account_resources
      note: IBM account SDK method
      save_as: maintain_different_contact_details_to_security_billing_and_operationss
  checks:
  - check_id: ibm.account.maintain_current_contact_details.current_contact_details_maintained
    title: Ensure Accuracy of Account Contact Information for Security
    severity: low
    for_each: account.maintain_current_contact_detailss
    calls:
    - action: get_account_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM account compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in account.maintain_current_contact_detailss
      response'
  - check_id: ibm.account.maintain_different_contact_details_to_security_billing_and_operations.separate_security_billing_ops_contacts_configured
    title: Ensure Distinct Contacts for Security, Billing, and Operations
    severity: low
    for_each: account.maintain_different_contact_details_to_security_billing_and_operationss
    calls:
    - action: get_account_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM account compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in account.maintain_different_contact_details_to_security_billing_and_operationss
      response'
