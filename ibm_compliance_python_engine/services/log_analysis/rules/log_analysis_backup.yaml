log_analysis:
  version: '1.0'
  provider: ibm
  service: log_analysis
  scope: regional
  package: ibm-cloud-sdk-core
  client_class: Log_AnalysisV1
  discovery:
  - discovery_id: log_analysis.targets
    calls:
    - action: list_log_analysis_resources
      note: IBM log_analysis SDK method
      save_as: targets
  - discovery_id: log_analysis.views
    calls:
    - action: list_log_analysis_resources
      note: IBM log_analysis SDK method
      save_as: views
  - discovery_id: log_analysis.instances
    calls:
    - action: list_log_analysis_resources
      note: IBM log_analysis SDK method
      save_as: instances
  checks:
  - check_id: ibm.log_analysis.target.destination_endpoint_private_networking
    title: Ensure Private Networking for Log Analysis Destination Endpoint
    severity: medium
    for_each: log_analysis.targets
    calls:
    - action: get_log_analysis_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM log_analysis compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in log_analysis.targets
      response'
  - check_id: ibm.log_analysis.target.destination_iam_policy_least_privilege
    title: Ensure Least Privilege for Log Analysis Destination IAM Policies
    severity: high
    for_each: log_analysis.targets
    calls:
    - action: get_log_analysis_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM log_analysis compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in log_analysis.targets
      response'
  - check_id: ibm.log_analysis.target.destination_tls_min_1_2_enforced
    title: Enforce TLS 1.2+ for Secure Log Destination in IBM Log Analysis
    severity: medium
    for_each: log_analysis.targets
    calls:
    - action: get_log_analysis_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM log_analysis compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in log_analysis.targets
      response'
  - check_id: ibm.log_analysis.view.stream_encryption_at_rest_enabled
    title: Ensure Stream Encryption at Rest is Enabled for Log Analysis Views
    severity: high
    for_each: log_analysis.views
    calls:
    - action: get_log_analysis_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM log_analysis compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in log_analysis.views
      response'
  - check_id: ibm.log_analysis.view.stream_ingestion_auth_required
    title: Mandatory Authentication for Stream Ingestion in Log Analysis
    severity: low
    for_each: log_analysis.views
    calls:
    - action: get_log_analysis_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM log_analysis compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in log_analysis.views
      response'
  - check_id: ibm.log_analysis.view.stream_retention_days_minimum_configured
    title: Ensure Minimum Stream Retention Days Configured for Log Analysis
    severity: low
    for_each: log_analysis.views
    calls:
    - action: get_log_analysis_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM log_analysis compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in log_analysis.views
      response'
  - check_id: ibm.log_analysis.view.rbac_least_privilege
    title: Enforce RBAC Least Privilege for IBM Log Analysis View Access
    severity: high
    for_each: log_analysis.views
    calls:
    - action: get_log_analysis_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM log_analysis compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in log_analysis.views
      response'
  - check_id: ibm.log_analysis.view.storage_encrypted
    title: Ensure Storage Encryption for Log Analysis Views
    severity: medium
    for_each: log_analysis.views
    calls:
    - action: get_log_analysis_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM log_analysis compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in log_analysis.views
      response'
  - check_id: ibm.log_analysis.target.cross_account_restricted
    title: Restrict Cross-Account Access in IBM Cloud Log Analysis
    severity: low
    for_each: log_analysis.targets
    calls:
    - action: get_log_analysis_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM log_analysis compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in log_analysis.targets
      response'
  - check_id: ibm.log_analysis.target.destination_encrypted
    title: Ensure Encryption of Log Analysis Target Destinations
    severity: medium
    for_each: log_analysis.targets
    calls:
    - action: get_log_analysis_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM log_analysis compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in log_analysis.targets
      response'
  - check_id: ibm.log_analysis.target.destination_least_privilege
    title: Ensure Least Privilege for Log Analysis Destination Access
    severity: high
    for_each: log_analysis.targets
    calls:
    - action: get_log_analysis_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM log_analysis compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in log_analysis.targets
      response'
  - check_id: ibm.log_analysis.instance.rbac_least_privilege
    title: Enforce Least Privilege in IBM Log Analysis RBAC Configurations
    severity: high
    for_each: log_analysis.instances
    calls:
    - action: get_log_analysis_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM log_analysis compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in log_analysis.instances
      response'
  - check_id: ibm.log_analysis.instance.encryption_at_rest_cmek
    title: Log Analysis Instance Encryption at Rest with CMEK
    severity: high
    for_each: log_analysis.instances
    calls:
    - action: get_log_analysis_resource
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM log_analysis compliance check
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in log_analysis.instances
      response'
  - check_id: ibm.log_analysis.instance.immutability_or_object_lock_where_supported
    title: Enforce Immutability or Object Lock for Log Analysis Instances
    severity: low
    for_each: log_analysis.instances
    calls:
    - action: get_log_analysis_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM log_analysis compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in log_analysis.instances
      response'
  - check_id: ibm.log_analysis.instance.retention_days_minimum_configured
    title: Ensure Minimum Retention Days for Log Analysis Instances
    severity: low
    for_each: log_analysis.instances
    calls:
    - action: get_log_analysis_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM log_analysis compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in log_analysis.instances
      response'
