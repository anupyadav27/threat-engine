block_storage:
  version: '1.0'
  provider: ibm
  service: block_storage
  scope: regional
  package: ibm-cloud-sdk-core
  client_class: Block_StorageV1
  discovery:
  - discovery_id: block_storage.snapshots
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for block_storage.snapshots'
      save_as: snapshots
  - discovery_id: block_storage.volumes
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for block_storage.volumes'
      save_as: volumes
  - discovery_id: block_storage.snapshot_encryptions
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for block_storage.snapshot_encryptions'
      save_as: snapshot_encryptions
  checks:
  - check_id: ibm.block_storage.snapshot.cross_region_copy_encrypted
    title: Enforce Encryption for Cross-Region Block Storage Snapshot Transfers
    severity: medium
    for_each: block_storage.snapshots
    calls:
    - action: self
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in block_storage.snapshots response'
  - check_id: ibm.block_storage.snapshot.encrypted
    title: Ensure Encryption of IBM Cloud Block Storage Snapshots at Rest
    severity: medium
    for_each: block_storage.snapshots
    calls:
    - action: self
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in block_storage.snapshots response'
  - check_id: ibm.block_storage.snapshot.not_public
    title: Ensure Block Storage Snapshots Are Not Publicly Accessible
    severity: critical
    for_each: block_storage.snapshots
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in block_storage.snapshots response'
  - check_id: ibm.block_storage.volume.cmk_cmek_configured
    title: Ensure CMK-Based Encryption Configured for Block Storage Volumes
    severity: medium
    for_each: block_storage.volumes
    calls:
    - action: self
      fields:
      - path: encryption.kms_key_crn
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "encryption.kms_key_crn" exists in block_storage.volumes response'
  - check_id: ibm.block_storage.volume.encryption_at_rest_enabled
    title: Ensure Encryption at Rest is Enabled for IBM Block Storage Volumes
    severity: high
    for_each: block_storage.volumes
    calls:
    - action: self
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in block_storage.volumes response'
  - check_id: ibm.block_storage.volume.snapshots_encrypted
    title: Ensure Encryption of Snapshots for IBM Block Storage Volumes
    severity: medium
    for_each: block_storage.volumes
    calls:
    - action: self
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in block_storage.volumes response'
  - check_id: ibm.block_storage.snapshot_encryption.snapshot_encryption_enabled
    title: Ensure Snapshot Encryption is Enabled for Block Storage
    severity: high
    for_each: block_storage.snapshot_encryptions
    calls:
    - action: self
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in block_storage.snapshot_encryptions response'
  - check_id: ibm.block_storage.volume.backup_configured
    title: Ensure Backup Configurations for IBM Cloud Block Storage Volumes
    severity: medium
    for_each: block_storage.volumes
    calls:
    - action: self
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in block_storage.volumes response'
