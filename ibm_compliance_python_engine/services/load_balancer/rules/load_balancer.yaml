load_balancer:
  version: '1.0'
  provider: ibm
  service: load_balancer
  scope: regional
  package: ibm-cloud-sdk-core
  client_class: Load_BalancerV1
  discovery:
  - discovery_id: load_balancer.insecure_ssl_cipherss
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for load_balancer.insecure_ssl_cipherss'
      save_as: insecure_ssl_cipherss
  - discovery_id: load_balancer.internet_facings
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for load_balancer.internet_facings'
      save_as: internet_facings
  - discovery_id: load_balancer.is_in_multiple_azs
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for load_balancer.is_in_multiple_azs'
      save_as: is_in_multiple_azs
  - discovery_id: load_balancer.resources
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for load_balancer.resources'
      save_as: resources
  - discovery_id: load_balancer.ssl_listenerss
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for load_balancer.ssl_listenerss'
      save_as: ssl_listenerss
  - discovery_id: load_balancer.deletion_protections
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for load_balancer.deletion_protections'
      save_as: deletion_protections
  - discovery_id: load_balancer.groups
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for load_balancer.groups'
      save_as: groups
  - discovery_id: load_balancer.waf_acl_attacheds
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for load_balancer.waf_acl_attacheds'
      save_as: waf_acl_attacheds
  checks:
  - check_id: ibm.load_balancer.insecure_ssl_ciphers.insecure_ssl_ciphers_enabled
    title: Disable Insecure SSL Ciphers on IBM Cloud Load Balancers
    severity: medium
    for_each: load_balancer.insecure_ssl_cipherss
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in load_balancer.insecure_ssl_cipherss response'
  - check_id: ibm.load_balancer.internet_facing.internet_facing_enabled
    title: Ensure Internet-Facing Load Balancers are Appropriately Configured
    severity: low
    for_each: load_balancer.internet_facings
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in load_balancer.internet_facings response'
  - check_id: ibm.load_balancer.is_in_multiple_az.is_in_multiple_az_enabled
    title: Ensure Load Balancer is Configured Across Multiple Availability Zones
    severity: low
    for_each: load_balancer.is_in_multiple_azs
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in load_balancer.is_in_multiple_azs response'
  - check_id: ibm.load_balancer.resource.logging_enabled
    title: Ensure Logging is Enabled for IBM Cloud Load Balancers
    severity: medium
    for_each: load_balancer.resources
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in load_balancer.resources response'
  - check_id: ibm.load_balancer.ssl_listeners.ssl_listeners_enabled
    title: Ensure SSL Listeners are Enabled on IBM Cloud Load Balancers
    severity: medium
    for_each: load_balancer.ssl_listenerss
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in load_balancer.ssl_listenerss response'
  - check_id: ibm.load_balancer.deletion_protection.deletion_protection_enabled
    title: Enable Deletion Protection for IBM Cloud Load Balancers
    severity: low
    for_each: load_balancer.deletion_protections
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in load_balancer.deletion_protections response'
  - check_id: ibm.load_balancer.group.health_check_enabled
    title: Ensure Health Check is Enabled for IBM Cloud Load Balancer Groups
    severity: low
    for_each: load_balancer.groups
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in load_balancer.groups response'
  - check_id: ibm.load_balancer.waf_acl_attached.waf_acl_attached_enabled
    title: Ensure WAF ACL is Attached and Enabled on IBM Cloud Load Balancers
    severity: low
    for_each: load_balancer.waf_acl_attacheds
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in load_balancer.waf_acl_attacheds response'
