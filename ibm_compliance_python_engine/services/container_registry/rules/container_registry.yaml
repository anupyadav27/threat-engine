container_registry:
  version: '1.0'
  provider: ibm
  service: container_registry
  scope: regional
  package: ibm-cloud-sdk-core
  client_class: Container_RegistryV1
  discovery:
  - discovery_id: container_registry.namespaces
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for container_registry.namespaces'
      save_as: namespaces
  - discovery_id: container_registry.retention_policys
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for container_registry.retention_policys'
      save_as: retention_policys
  - discovery_id: container_registry.repositories_not_publicly_accessibles
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for container_registry.repositories_not_publicly_accessibles'
      save_as: repositories_not_publicly_accessibles
  - discovery_id: container_registry.resources
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for container_registry.resources'
      save_as: resources
  checks:
  - check_id: ibm.container_registry.namespace.container_analysis_enabled
    title: Ensure Container Analysis is Enabled for IBM Container Registry Namespaces
    severity: low
    for_each: container_registry.namespaces
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in container_registry.namespaces response'
  - check_id: ibm.container_registry.namespace.registry_image_scan_on_push_enabled
    title: Enable Image Scanning on Push for IBM Container Registry
    severity: low
    for_each: container_registry.namespaces
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in container_registry.namespaces response'
  - check_id: ibm.container_registry.retention_policy.lifecycle_policy_storage_encrypted
    title: Enforce Encrypted Lifecycle Policy Storage in IBM Container Registry
    severity: medium
    for_each: container_registry.retention_policys
    calls:
    - action: self
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in container_registry.retention_policys response'
  - check_id: ibm.container_registry.retention_policy.lifecycle_policy_unused_or_old_tags_expire
    title: Enforce Expiration of Unused or Old Tags in IBM Container Registry
    severity: low
    for_each: container_registry.retention_policys
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in container_registry.retention_policys response'
  - check_id: ibm.container_registry.namespace.no_public_pull_push
    title: Restrict Public Pull/Push Access to IBM Cloud Container Registry Namespaces
    severity: critical
    for_each: container_registry.namespaces
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in container_registry.namespaces response'
  - check_id: ibm.container_registry.namespace.no_wildcard_admin
    title: Enforce No Wildcard Admin in IBM Cloud Container Registry Namespace
    severity: critical
    for_each: container_registry.namespaces
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in container_registry.namespaces response'
  - check_id: ibm.container_registry.namespace.cross_region_encrypted
    title: Enforce Cross-Region Encryption for Container Registry Namespaces
    severity: medium
    for_each: container_registry.namespaces
    calls:
    - action: self
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in container_registry.namespaces response'
  - check_id: ibm.container_registry.namespace.destinations_least_privilege
    title: Enforce Least Privilege for Container Registry Namespace Destinations
    severity: high
    for_each: container_registry.namespaces
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in container_registry.namespaces response'
  - check_id: ibm.container_registry.namespace.registry_image_scanning_enabled
    title: Ensure Image Scanning is Enabled for Container Registry Namespaces
    severity: low
    for_each: container_registry.namespaces
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in container_registry.namespaces response'
  - check_id: ibm.container_registry.namespace.registry_immutable_tags_or_signing_enforced
    title: Ensure Immutable Tags or Image Signing is Enforced in IBM Container Registry
    severity: low
    for_each: container_registry.namespaces
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in container_registry.namespaces response'
  - check_id: ibm.container_registry.namespace.registry_repo_private_or_access_restricted
    title: Ensure Container Registry Repositories Are Private or Access Restricted
    severity: low
    for_each: container_registry.namespaces
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in container_registry.namespaces response'
  - check_id: ibm.container_registry.namespace.registry_vulnerability_alerts_critical_high_medium_enabled
    title: Enable Critical, High, and Medium Vulnerability Alerts in IBM Container Registry
    severity: medium
    for_each: container_registry.namespaces
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in container_registry.namespaces response'
  - check_id: ibm.container_registry.repositories_not_publicly_accessible.repositories_not_publicly_accessible_blocked
    title: Restrict Public Access to Container Registry Repositories
    severity: critical
    for_each: container_registry.repositories_not_publicly_accessibles
    calls:
    - action: self
      fields:
      - path: public_access
        operator: equals
        expected: false
    note: 'MANUAL_REVIEW: Verify field path "public_access" exists in container_registry.repositories_not_publicly_accessibles
      response'
  - check_id: ibm.container_registry.resource.container_scanning_enabled
    title: Enforce Container Scanning for Enhanced Security in IBM Cloud Registry
    severity: low
    for_each: container_registry.resources
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in container_registry.resources response'
