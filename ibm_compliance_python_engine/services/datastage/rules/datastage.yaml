datastage:
  version: '1.0'
  provider: ibm
  service: datastage
  scope: regional
  package: ibm-cloud-sdk-core
  client_class: DatastageV1
  discovery:
  - discovery_id: datastage.flows
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for datastage.flows'
      save_as: flows
  - discovery_id: datastage.parameter_sets
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for datastage.parameter_sets'
      save_as: parameter_sets
  - discovery_id: datastage.jobs
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for datastage.jobs'
      save_as: jobs
  checks:
  - check_id: ibm.datastage.flow.data_pipeline_environment_no_plaintext_secrets
    title: Ensure DataStage Pipeline Environments Do Not Contain Plaintext Secrets
    severity: high
    for_each: datastage.flows
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.flows response'
  - check_id: ibm.datastage.flow.data_pipeline_execution_role_least_privilege
    title: Enforce Least Privilege for Data Pipeline Execution Roles
    severity: high
    for_each: datastage.flows
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.flows response'
  - check_id: ibm.datastage.flow.data_pipeline_logging_enabled
    title: Ensure Data Pipeline Logging is Enabled in IBM DataStage
    severity: medium
    for_each: datastage.flows
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in datastage.flows response'
  - check_id: ibm.datastage.flow.data_pipeline_network_private_only
    title: Enforce Private Network for DataStage Data Pipelines Only
    severity: medium
    for_each: datastage.flows
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.flows response'
  - check_id: ibm.datastage.parameter_set.data_pipeline_allowed_values_defined_where_applicable
    title: Ensure Data Pipeline Parameters Have Defined Allowed Values
    severity: medium
    for_each: datastage.parameter_sets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.parameter_sets response'
  - check_id: ibm.datastage.parameter_set.data_pipeline_attributes_no_plaintext_secrets
    title: Secure Parameter Handling in DataStage Pipelines
    severity: high
    for_each: datastage.parameter_sets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.parameter_sets response'
  - check_id: ibm.datastage.parameter_set.data_pipeline_binding_only_expected_params_bound
    title: Ensure DataStage Pipelines Bind Only Expected Parameters
    severity: medium
    for_each: datastage.parameter_sets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.parameter_sets response'
  - check_id: ibm.datastage.parameter_set.data_pipeline_binding_secret_refs_resolved_at_runtime
    title: Ensure Runtime Resolution of Data Pipeline Binding Secrets in IBM DataStage
    severity: high
    for_each: datastage.parameter_sets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.parameter_sets response'
  - check_id: ibm.datastage.parameter_set.data_pipeline_binding_sensitive_params_not_logged
    title: Ensure Sensitive Parameters in Data Pipelines Are Not Logged
    severity: low
    for_each: datastage.parameter_sets
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in datastage.parameter_sets response'
  - check_id: ibm.datastage.parameter_set.data_pipeline_constraint_allowlist_defined_when_applicable
    title: Ensure Allowlist for Data Pipeline Constraints in IBM DataStage
    severity: medium
    for_each: datastage.parameter_sets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.parameter_sets response'
  - check_id: ibm.datastage.parameter_set.data_pipeline_constraint_max_length_defined_when_applicable
    title: Ensure Data Pipeline Constraint Max Length is Defined in IBM DataStage
    severity: medium
    for_each: datastage.parameter_sets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.parameter_sets response'
  - check_id: ibm.datastage.parameter_set.data_pipeline_constraint_min_length_defined_when_applicable
    title: Enforce Min Length for Data Pipeline Constraints in IBM DataStage
    severity: medium
    for_each: datastage.parameter_sets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.parameter_sets response'
  - check_id: ibm.datastage.parameter_set.data_pipeline_constraint_pattern_defined_when_applicable
    title: Enforce Data Pipeline Constraint Patterns for Enhanced Security
    severity: medium
    for_each: datastage.parameter_sets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.parameter_sets response'
  - check_id: ibm.datastage.parameter_set.data_pipeline_default_not_sensitive
    title: Ensure DataStage Parameter Sets Default to Non-Sensitive Data Configuration
    severity: medium
    for_each: datastage.parameter_sets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.parameter_sets response'
  - check_id: ibm.datastage.parameter_set.data_pipeline_max_length_defined_where_applicable
    title: Enforce Data Pipeline Max Length for Secure Parameter Sets in DataStage
    severity: medium
    for_each: datastage.parameter_sets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.parameter_sets response'
  - check_id: ibm.datastage.parameter_set.data_pipeline_metadata_disallowed_attribute_keys_blocked
    title: Secure Data Pipeline Metadata by Blocking Disallowed Attribute Keys
    severity: high
    for_each: datastage.parameter_sets
    calls:
    - action: self
      fields:
      - path: locked
        operator: equals
        expected: false
    note: 'MANUAL_REVIEW: Verify field path "locked" exists in datastage.parameter_sets response'
  - check_id: ibm.datastage.parameter_set.data_pipeline_metadata_sensitive_keys_require_secret_type
    title: Enforce Secret Type for Sensitive Keys in DataStage Metadata
    severity: high
    for_each: datastage.parameter_sets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.parameter_sets response'
  - check_id: ibm.datastage.parameter_set.data_pipeline_metadata_values_not_plaintext_secret
    title: Protect Data Pipeline Metadata from Plaintext Secrets in IBM DataStage
    severity: high
    for_each: datastage.parameter_sets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.parameter_sets response'
  - check_id: ibm.datastage.parameter_set.data_pipeline_min_length_defined_where_applicable
    title: Ensure Data Pipeline Min Length Defined for Enhanced Security
    severity: medium
    for_each: datastage.parameter_sets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.parameter_sets response'
  - check_id: ibm.datastage.parameter_set.data_pipeline_pattern_defined_where_applicable
    title: Ensure Data Pipeline Patterns Are Defined for Parameter Sets
    severity: medium
    for_each: datastage.parameter_sets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.parameter_sets response'
  - check_id: ibm.datastage.parameter_set.data_pipeline_type_set
    title: Ensure Data Pipeline Type is Configured for DataStage Parameter Sets
    severity: medium
    for_each: datastage.parameter_sets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.parameter_sets response'
  - check_id: ibm.datastage.parameter_set.data_pipeline_value_from_secrets_manager_when_sensitive
    title: Secure Sensitive Data with Secrets Manager in IBM DataStage Pipelines
    severity: high
    for_each: datastage.parameter_sets
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.parameter_sets response'
  - check_id: ibm.datastage.job.data_definition_signed_and_verified
    title: Ensuring Data Definition Integrity in IBM DataStage Jobs
    severity: medium
    for_each: datastage.jobs
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.jobs response'
  - check_id: ibm.datastage.job.data_definition_storage_encrypted
    title: Enforce Encryption for DataStage Job Data Definition Storage
    severity: medium
    for_each: datastage.jobs
    calls:
    - action: self
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in datastage.jobs response'
  - check_id: ibm.datastage.job.data_definition_storage_private
    title: Ensure DataStage Job Data Definition Storage is Private
    severity: low
    for_each: datastage.jobs
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.jobs response'
  - check_id: ibm.datastage.job.data_definition_version_immutability_enforced
    title: Enforce Immutability of Data Definition Versions in DataStage Jobs
    severity: medium
    for_each: datastage.jobs
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.jobs response'
  - check_id: ibm.datastage.job.data_pipeline_artifacts_private_and_encrypted
    title: Ensure DataStage Job Artifacts Are Private and Encrypted at Rest
    severity: medium
    for_each: datastage.jobs
    calls:
    - action: self
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in datastage.jobs response'
  - check_id: ibm.datastage.job.data_pipeline_execution_roles_least_privilege
    title: Enforce Least Privilege for DataStage Pipeline Execution Roles
    severity: high
    for_each: datastage.jobs
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.jobs response'
  - check_id: ibm.datastage.job.data_pipeline_kms_encryption_enabled
    title: Ensure DataStage Job Pipeline Uses KMS Encryption for Data Protection
    severity: high
    for_each: datastage.jobs
    calls:
    - action: self
      fields:
      - path: encryption.kms_key_crn
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "encryption.kms_key_crn" exists in datastage.jobs response'
  - check_id: ibm.datastage.job.data_pipeline_logs_and_metrics_enabled
    title: Ensure Data Pipeline Logs and Metrics Are Enabled for IBM DataStage Jobs
    severity: low
    for_each: datastage.jobs
    calls:
    - action: self
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in datastage.jobs response'
  - check_id: ibm.datastage.job.data_pipeline_private_networking_enforced
    title: Enforce Private Networking for IBM DataStage Data Pipelines
    severity: medium
    for_each: datastage.jobs
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in datastage.jobs response'
