file_storage:
  version: '1.0'
  provider: ibm
  service: file_storage
  scope: regional
  package: ibm-cloud-sdk-core
  client_class: File_StorageV1
  discovery:
  - discovery_id: file_storage.resources
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for file_storage.resources'
      save_as: resources
  - discovery_id: file_storage.not_publicly_accessibles
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for file_storage.not_publicly_accessibles'
      save_as: not_publicly_accessibles
  - discovery_id: file_storage.shares
    calls:
    - action: self
      note: 'MANUAL_REVIEW_REQUIRED: Add real SDK method for file_storage.shares'
      save_as: shares
  checks:
  - check_id: ibm.file_storage.resource.backup_enabled
    title: Ensuring Backup for IBM Cloud File Storage Resources
    severity: medium
    for_each: file_storage.resources
    calls:
    - action: self
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in file_storage.resources response'
  - check_id: ibm.file_storage.resource.encryption_at_rest_enabled
    title: Ensure Encryption at Rest is Enabled for IBM Cloud File Storage
    severity: high
    for_each: file_storage.resources
    calls:
    - action: self
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in file_storage.resources response'
  - check_id: ibm.file_storage.resource.have_backup_enabled
    title: Ensure Backup is Enabled for IBM Cloud File Storage Resources
    severity: medium
    for_each: file_storage.resources
    calls:
    - action: self
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in file_storage.resources response'
  - check_id: ibm.file_storage.resource.multi_az_enabled
    title: Ensure Multi-AZ Configuration for IBM Cloud File Storage
    severity: low
    for_each: file_storage.resources
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in file_storage.resources response'
  - check_id: ibm.file_storage.not_publicly_accessible.not_publicly_accessible_blocked
    title: Prevent Public Accessibility of IBM Cloud File Storage
    severity: critical
    for_each: file_storage.not_publicly_accessibles
    calls:
    - action: self
      fields:
      - path: public_access
        operator: equals
        expected: false
    note: 'MANUAL_REVIEW: Verify field path "public_access" exists in file_storage.not_publicly_accessibles response'
  - check_id: ibm.file_storage.share.encryption_at_rest_enabled
    title: Ensure Encryption at Rest is Enabled for IBM Cloud File Storage Shares
    severity: high
    for_each: file_storage.shares
    calls:
    - action: self
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in file_storage.shares response'
  - check_id: ibm.file_storage.share.kms_key_policy_least_privilege
    title: Enforce Least Privilege for KMS Key Policy in IBM File Storage
    severity: high
    for_each: file_storage.shares
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in file_storage.shares response'
  - check_id: ibm.file_storage.share.private_network_only
    title: Enforce Private Network Access for IBM Cloud File Storage Shares
    severity: medium
    for_each: file_storage.shares
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in file_storage.shares response'
  - check_id: ibm.file_storage.share.snapshots_enabled
    title: Ensure Snapshots Are Enabled for IBM Cloud File Storage Shares
    severity: low
    for_each: file_storage.shares
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in file_storage.shares response'
  - check_id: ibm.file_storage.resource.file_system_copy_tags_to_backups_enabled
    title: Ensure Tags on File System Copies Are Propagated to Backups
    severity: medium
    for_each: file_storage.resources
    calls:
    - action: self
      fields:
      - path: backup_enabled
        operator: equals
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "backup_enabled" exists in file_storage.resources response'
  - check_id: ibm.file_storage.resource.file_system_copy_tags_to_volumes_enabled
    title: Ensure File System Tags are Copied to Volumes for Enhanced Traceability
    severity: low
    for_each: file_storage.resources
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in file_storage.resources response'
  - check_id: ibm.file_storage.resource.windows_file_system_multi_az_enabled
    title: Ensure Multi-AZ Enabled for Windows File System in IBM Cloud
    severity: low
    for_each: file_storage.resources
    calls:
    - action: self
      fields:
      - path: enabled
        operator: exists
        expected: true
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in file_storage.resources response'
