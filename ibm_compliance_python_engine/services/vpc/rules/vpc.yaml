vpc:
  version: '1.0'
  provider: ibm
  service: vpc
  scope: regional
  package: ibm-vpc
  client_class: VpcV1
  discovery:
  - discovery_id: vpc.groups
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: groups
  - discovery_id: vpc.instances
    calls:
    - action: list_instances
      params: {}
      response_path: instances
      save_as: instances
  - discovery_id: vpc.networks
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: networks
  - discovery_id: vpc.attacheds
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: attacheds
  - discovery_id: vpc.ip_attacheds
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: ip_attacheds
  - discovery_id: vpc.balancers
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: balancers
  - discovery_id: vpc.bastion_host_existss
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: bastion_host_existss
  - discovery_id: vpc.resources
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: resources
  - discovery_id: vpc.in_all_vpcs
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: in_all_vpcs
  - discovery_id: vpc.multi_azs
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: multi_azs
  - discovery_id: vpc.private_cloud_block_storages
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: private_cloud_block_storages
  - discovery_id: vpc.private_cloud_customer_gateways
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: private_cloud_customer_gateways
  - discovery_id: vpc.private_cloud_dedicated_hosts
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: private_cloud_dedicated_hosts
  - discovery_id: vpc.private_cloud_endpoints
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: private_cloud_endpoints
  - discovery_id: vpc.private_cloud_images
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: private_cloud_images
  - discovery_id: vpc.private_cloud_instance_groups
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: private_cloud_instance_groups
  - discovery_id: vpc.private_cloud_instance_templates
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: private_cloud_instance_templates
  - discovery_id: vpc.private_cloud_interfaces
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: private_cloud_interfaces
  - discovery_id: vpc.private_cloud_listeners
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: private_cloud_listeners
  - discovery_id: vpc.private_cloud_load_balancers
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: private_cloud_load_balancers
  - discovery_id: vpc.private_cloud_reserved_instances
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: private_cloud_reserved_instances
  - discovery_id: vpc.private_cloud_route_tables
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: private_cloud_route_tables
  - discovery_id: vpc.private_cloud_servers
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: private_cloud_servers
  - discovery_id: vpc.private_cloud_spot_instances
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: private_cloud_spot_instances
  - discovery_id: vpc.private_cloud_ssh_keys
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: private_cloud_ssh_keys
  - discovery_id: vpc.private_cloud_subnets
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: private_cloud_subnets
  - discovery_id: vpc.private_cloud_target_groups
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: private_cloud_target_groups
  - discovery_id: vpc.private_cloud_vpcs
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: private_cloud_vpcs
  - discovery_id: vpc.private_cloud_vpn_connections
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: private_cloud_vpn_connections
  - discovery_id: vpc.ensure_using_managed_diskss
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: ensure_using_managed_diskss
  - discovery_id: vpc.vpcs
    calls:
    - action: list_vpcs
      params: {}
      response_path: vpcs
      save_as: vpcs
  - discovery_id: vpc.volumes
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: volumes
  - discovery_id: vpc.endpoint_gateways
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: endpoint_gateways
  - discovery_id: vpc.security_groups
    calls:
    - action: list_security_groups
      params: {}
      response_path: security_groups
      save_as: security_groups
  - discovery_id: vpc.network_acls
    calls:
    - action: list_network_acls
      params: {}
      response_path: network_acls
      save_as: network_acls
  - discovery_id: vpc.subnets
    calls:
    - action: list_subnets
      params: {}
      response_path: subnets
      save_as: subnets
  - discovery_id: vpc.vpn_connection_tunnels_ups
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: vpn_connection_tunnels_ups
  - discovery_id: vpc.floating_ips
    calls:
    - action: list_floating_ips
      params: {}
      response_path: floating_ips
      save_as: floating_ips
  - discovery_id: vpc.instance_templates
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: instance_templates
  - discovery_id: vpc.securitygroup_default_restrict_traffics
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: securitygroup_default_restrict_traffics
  - discovery_id: vpc.securitygroup_from_launch_wizards
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: securitygroup_from_launch_wizards
  - discovery_id: vpc.securitygroup_not_useds
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: securitygroup_not_useds
  - discovery_id: vpc.securitygroup_with_many_ingress_egress_ruless
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: securitygroup_with_many_ingress_egress_ruless
  - discovery_id: vpc.stopped_instances
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: stopped_instances
  - discovery_id: vpc.transitgateway_auto_accept_vpc_attachmentss
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: transitgateway_auto_accept_vpc_attachmentss
  - discovery_id: vpc.vpc_2private_1public_subnets_nats
    calls:
    - action: list_vpcs
      note: IBM VPC list_vpcs method
      save_as: vpc_2private_1public_subnets_nats
  checks:
  - check_id: ibm.vpc.group.capacity_rebalance_enabled
    title: Ensure Capacity Rebalance is Enabled for VPC Security Groups
    severity: low
    for_each: vpc.groups
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.groups response'
  - check_id: ibm.vpc.group.feature_configured
    title: Ensure VPC Security Groups Have Required Features Configured
    severity: low
    for_each: vpc.groups
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.groups response'
  - check_id: ibm.vpc.group.health_check_enabled
    title: Enable Health Checks for VPC Security Group Configurations
    severity: low
    for_each: vpc.groups
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.groups response'
  - check_id: ibm.vpc.group.multi_az_deployment_enabled
    title: Ensure Multi-AZ Deployment is Enabled for VPC Security Groups
    severity: low
    for_each: vpc.groups
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.groups response'
  - check_id: ibm.vpc.instance.confidential_computing_enabled
    title: Enforce Confidential Computing on IBM VPC Instances
    severity: low
    for_each: vpc.instances
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.network.not_legacy
    title: Enforce Modern Network Configurations in IBM VPC
    severity: low
    for_each: vpc.networks
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.networks response'
  - check_id: ibm.vpc.instance.detailed_monitoring_enabled
    title: Ensure Detailed Monitoring is Enabled for VPC Instances
    severity: medium
    for_each: vpc.instances
    calls:
    - action: get_vpc
      fields:
      - path: monitoring.enabled
        operator: exists
        expected: true
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.attached.attached
    title: Ensure VPC Resources Are Properly Attached for Network Security
    severity: low
    for_each: vpc.attacheds
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.attacheds response'
  - check_id: ibm.vpc.ip_attached.ip_attached
    title: Ensure IPs are Attached to IBM VPC Resources
    severity: low
    for_each: vpc.ip_attacheds
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.ip_attacheds response'
  - check_id: ibm.vpc.balancer.logging_enabled_ibm_cos_..._cluster_audit_logging
    title: Ensure VPC Load Balancer Logging to IBM COS for Audit Compliance
    severity: medium
    for_each: vpc.balancers
    calls:
    - action: get_vpc
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in vpc.balancers
      response'
  - check_id: ibm.vpc.bastion_host_exists.bastion_host_exists_enabled
    title: Ensure Bastion Host is Enabled for Secure VPC Access
    severity: low
    for_each: vpc.bastion_host_existss
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.bastion_host_existss
      response'
  - check_id: ibm.vpc.resource.watcher_enabled
    title: Ensure IBM VPC Resource Watcher is Enabled for Enhanced Monitoring
    severity: low
    for_each: vpc.resources
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.resources response'
  - check_id: ibm.vpc.in_all_vpc.in_all_vpc_enabled
    title: Ensuring 'In All VPC' Configuration is Enabled for IBM Cloud VPCs
    severity: low
    for_each: vpc.in_all_vpcs
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.in_all_vpcs response'
  - check_id: ibm.vpc.resource.logging_enabled
    title: Ensure Logging is Enabled for IBM Cloud VPC Resources
    severity: medium
    for_each: vpc.resources
    calls:
    - action: get_vpc
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in vpc.resources
      response'
  - check_id: ibm.vpc.multi_az.multi_az_enabled
    title: Ensure Multi-AZ Deployment for Enhanced Resilience in IBM VPC
    severity: low
    for_each: vpc.multi_azs
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.multi_azs response'
  - check_id: ibm.vpc.private_cloud_block_storage.compute_disk_cmk_cmek_configured
    title: Ensure CMK Configured for Compute Disk in IBM VPC Block Storage
    severity: low
    for_each: vpc.private_cloud_block_storages
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_block_storages
      response'
  - check_id: ibm.vpc.private_cloud_block_storage.compute_disk_encryption_at_rest_enabled
    title: Ensure VPC Block Storage Disk Encryption at Rest is Enabled
    severity: high
    for_each: vpc.private_cloud_block_storages
    calls:
    - action: get_vpc
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in vpc.private_cloud_block_storages
      response'
  - check_id: ibm.vpc.private_cloud_block_storage.compute_disk_snapshots_encrypted
    title: Encryption of Compute Disk Snapshots in IBM Cloud VPC
    severity: low
    for_each: vpc.private_cloud_block_storages
    calls:
    - action: get_vpc
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in vpc.private_cloud_block_storages
      response'
  - check_id: ibm.vpc.private_cloud_block_storage.compute_disk_snapshots_not_public
    title: Ensure VPC Block Storage Snapshots are Not Publicly Accessible
    severity: critical
    for_each: vpc.private_cloud_block_storages
    calls:
    - action: get_vpc
      fields:
      - path: is_public
        operator: exists
        expected: false
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_block_storages
      response'
  - check_id: ibm.vpc.private_cloud_customer_gateway.network_cgw_ip_addresses_valid_and_owned
    title: Validate and Own IP Addresses for Private Cloud Customer Gateways
    severity: medium
    for_each: vpc.private_cloud_customer_gateways
    calls:
    - action: get_public_gateway
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_customer_gateways
      response'
  - check_id: ibm.vpc.private_cloud_customer_gateway.network_cgw_no_public_management_interfaces_exposed
    title: 'Secure Network Gateways: No Public Management Interface Exposure'
    severity: critical
    for_each: vpc.private_cloud_customer_gateways
    calls:
    - action: get_public_gateway
      fields:
      - path: is_public
        operator: exists
        expected: false
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_customer_gateways
      response'
  - check_id: ibm.vpc.private_cloud_dedicated_host.compute_dedicated_host_sharing_restricted
    title: Restrict Sharing on IBM Cloud VPC Dedicated Hosts
    severity: low
    for_each: vpc.private_cloud_dedicated_hosts
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_dedicated_hosts
      response'
  - check_id: ibm.vpc.private_cloud_dedicated_host.compute_dedicated_host_instance_auto_placement_controlled
    title: Control Auto Placement for Dedicated Host Instances in IBM VPC
    severity: low
    for_each: vpc.private_cloud_dedicated_hosts
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_dedicated_hosts
      response'
  - check_id: ibm.vpc.private_cloud_endpoint.network_endpoint_policy_least_privilege
    title: Enforce Least Privilege on IBM VPC Private Cloud Endpoint Policies
    severity: high
    for_each: vpc.private_cloud_endpoints
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_endpoints
      response'
  - check_id: ibm.vpc.private_cloud_endpoint.network_endpoint_private_dns_enabled_where_supported
    title: Ensure Private DNS is Enabled for VPC Private Cloud Endpoints
    severity: medium
    for_each: vpc.private_cloud_endpoints
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_endpoints
      response'
  - check_id: ibm.vpc.private_cloud_image.compute_image_approved_image_allowlist_enforced
    title: Enforce Allowlist for Approved Private Cloud Images in VPC
    severity: low
    for_each: vpc.private_cloud_images
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_images
      response'
  - check_id: ibm.vpc.private_cloud_image.compute_image_encrypted_cmek
    title: Enforce CMEK Encryption for VPC Private Cloud Images
    severity: medium
    for_each: vpc.private_cloud_images
    calls:
    - action: get_vpc
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in vpc.private_cloud_images
      response'
  - check_id: ibm.vpc.private_cloud_image.compute_image_signed_and_verified
    title: Ensure Compute Images Are Signed and Verified in IBM VPC
    severity: low
    for_each: vpc.private_cloud_images
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_images
      response'
  - check_id: ibm.vpc.private_cloud_image.compute_image_not_publicly_shared
    title: Restrict Public Sharing of VPC Private Cloud Images for Enhanced Security
    severity: critical
    for_each: vpc.private_cloud_images
    calls:
    - action: get_vpc
      fields:
      - path: is_public
        operator: exists
        expected: false
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_images
      response'
  - check_id: ibm.vpc.private_cloud_image.compute_image_vuln_scanned_no_critical
    title: Ensure Critical Vulnerabilities Are Absent in Private Cloud Images
    severity: low
    for_each: vpc.private_cloud_images
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_images
      response'
  - check_id: ibm.vpc.private_cloud_instance_group.compute_instance_group_instance_profile_least_privilege
    title: Ensure Least Privilege for VPC Instance Group Profiles
    severity: high
    for_each: vpc.private_cloud_instance_groups
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_instance_groups
      response'
  - check_id: ibm.vpc.private_cloud_instance_group.compute_instance_group_no_public_ip_assigned
    title: Restrict Public IP Assignment to Private Cloud Instance Groups
    severity: critical
    for_each: vpc.private_cloud_instance_groups
    calls:
    - action: get_vpc
      fields:
      - path: is_public
        operator: exists
        expected: false
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_instance_groups
      response'
  - check_id: ibm.vpc.private_cloud_instance_group.compute_instance_group_uses_approved_launch_template
    title: Ensure Compute Instance Groups Use Approved Launch Templates
    severity: low
    for_each: vpc.private_cloud_instance_groups
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_instance_groups
      response'
  - check_id: ibm.vpc.private_cloud_instance_group.compute_instance_group_volumes_encrypted
    title: Ensure Encryption of Volumes in Private Cloud Instance Groups
    severity: medium
    for_each: vpc.private_cloud_instance_groups
    calls:
    - action: get_vpc
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in vpc.private_cloud_instance_groups
      response'
  - check_id: ibm.vpc.private_cloud_instance_template.compute_launch_template_imds_hardened
    title: Harden IMDS Access in IBM VPC Private Cloud Instance Templates
    severity: low
    for_each: vpc.private_cloud_instance_templates
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_instance_templates
      response'
  - check_id: ibm.vpc.private_cloud_instance_template.compute_launch_template_instance_profile_least_privilege
    title: Ensure Least Privilege for VPC Compute Launch Template Profiles
    severity: high
    for_each: vpc.private_cloud_instance_templates
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_instance_templates
      response'
  - check_id: ibm.vpc.private_cloud_instance_template.compute_launch_template_no_public_ip_default
    title: Enforce Private Cloud Instance Templates Without Public IPs
    severity: critical
    for_each: vpc.private_cloud_instance_templates
    calls:
    - action: get_vpc
      fields:
      - path: is_public
        operator: exists
        expected: false
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_instance_templates
      response'
  - check_id: ibm.vpc.private_cloud_instance_template.compute_launch_template_root_volume_encrypted_by_default
    title: Ensure Default Encryption for VPC Compute Launch Template Root Volumes
    severity: critical
    for_each: vpc.private_cloud_instance_templates
    calls:
    - action: get_vpc
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in vpc.private_cloud_instance_templates
      response'
  - check_id: ibm.vpc.private_cloud_instance_template.compute_launch_template_security_groups_restrictive
    title: Restrictive Security Groups for VPC Compute Launch Templates
    severity: low
    for_each: vpc.private_cloud_instance_templates
    calls:
    - action: get_security_group
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_instance_templates
      response'
  - check_id: ibm.vpc.private_cloud_instance_template.compute_launch_template_user_data_no_secrets
    title: Ensure No Secrets in Compute Launch Template User Data for VPC
    severity: high
    for_each: vpc.private_cloud_instance_templates
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_instance_templates
      response'
  - check_id: ibm.vpc.private_cloud_interface.network_eni_security_groups_present
    title: Ensure Security Groups Attached to VPC Private Cloud Interfaces
    severity: medium
    for_each: vpc.private_cloud_interfaces
    calls:
    - action: get_security_group
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_interfaces
      response'
  - check_id: ibm.vpc.private_cloud_interface.network_eni_security_groups_restrictive
    title: Enforce Restrictive Security Groups for VPC Private Cloud Interfaces
    severity: medium
    for_each: vpc.private_cloud_interfaces
    calls:
    - action: get_security_group
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_interfaces
      response'
  - check_id: ibm.vpc.private_cloud_listener.network_listener_cipher_policy_secure
    title: Ensure Secure Cipher Policy for VPC Private Cloud Listener
    severity: medium
    for_each: vpc.private_cloud_listeners
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_listeners
      response'
  - check_id: ibm.vpc.private_cloud_listener.network_listener_tls_min_1_2
    title: Enforce TLS 1.2 or Higher for VPC Network Listeners
    severity: medium
    for_each: vpc.private_cloud_listeners
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_listeners
      response'
  - check_id: ibm.vpc.private_cloud_load_balancer.network_lb_access_logs_enabled
    title: Ensure Network Load Balancer Access Logs are Enabled in IBM VPC
    severity: medium
    for_each: vpc.private_cloud_load_balancers
    calls:
    - action: get_load_balancer
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in vpc.private_cloud_load_balancers
      response'
  - check_id: ibm.vpc.private_cloud_load_balancer.network_lb_listener_tls_min_1_2
    title: Enforce TLS 1.2+ for Network Load Balancer Listeners in VPC
    severity: medium
    for_each: vpc.private_cloud_load_balancers
    calls:
    - action: get_load_balancer
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_load_balancers
      response'
  - check_id: ibm.vpc.private_cloud_load_balancer.network_lb_valid_certificate_attached
    title: Ensure Valid TLS Certificates for Private Cloud Load Balancers
    severity: medium
    for_each: vpc.private_cloud_load_balancers
    calls:
    - action: get_load_balancer
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_load_balancers
      response'
  - check_id: ibm.vpc.private_cloud_load_balancer.network_lb_waf_attached_where_supported
    title: Ensure WAF is Attached to Network Load Balancers for Enhanced Security
    severity: medium
    for_each: vpc.private_cloud_load_balancers
    calls:
    - action: get_load_balancer
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_load_balancers
      response'
  - check_id: ibm.vpc.private_cloud_reserved_instance.cost_reservation_approval_workflow_required
    title: Enforce Cost Reservation Approval Workflow for Enhanced Network Security
    severity: low
    for_each: vpc.private_cloud_reserved_instances
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_reserved_instances
      response'
  - check_id: ibm.vpc.private_cloud_reserved_instance.cost_reservation_billing_admins_mfa_required
    title: Enforce MFA for Cost Reservation Billing Admins in Private Cloud
    severity: critical
    for_each: vpc.private_cloud_reserved_instances
    calls:
    - action: get_vpc
      fields:
      - path: mfa
        operator: equals
        expected: TOTP
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "mfa" exists in vpc.private_cloud_reserved_instances
      response'
  - check_id: ibm.vpc.private_cloud_reserved_instance.cost_reservation_purchase_permissions_restricted
    title: Restrict Permissions for Cost Reservation Purchases in VPC
    severity: low
    for_each: vpc.private_cloud_reserved_instances
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_reserved_instances
      response'
  - check_id: ibm.vpc.private_cloud_route_table.network_route_table_no_0_from_private_subnets
    title: Restrict Default Route Table Entries from Private Subnets
    severity: medium
    for_each: vpc.private_cloud_route_tables
    calls:
    - action: get_subnet
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_route_tables
      response'
  - check_id: ibm.vpc.private_cloud_route_table.network_route_table_..._where_supported
    title: Ensure Private Cloud Route Tables Are Configured Correctly
    severity: medium
    for_each: vpc.private_cloud_route_tables
    calls:
    - action: get_vpc
      fields:
      - path: '...where.supported'
        operator: exists
        expected: true
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "...where.supported" exists in vpc.private_cloud_route_tables
      response'
  - check_id: ibm.vpc.private_cloud_server.compute_vm_data_volumes_encrypted_cmek
    title: Ensure Encryption of Compute VM Data Volumes with CMEK in VPC
    severity: medium
    for_each: vpc.private_cloud_servers
    calls:
    - action: get_vpc
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in vpc.private_cloud_servers
      response'
  - check_id: ibm.vpc.private_cloud_server.compute_vm_imds_hardened
    title: Harden VM Instance Metadata Service for Enhanced Security
    severity: low
    for_each: vpc.private_cloud_servers
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_servers
      response'
  - check_id: ibm.vpc.private_cloud_server.compute_vm_no_public_ip_assigned
    title: Enforce Private IP Usage for VPC Compute Instances
    severity: critical
    for_each: vpc.private_cloud_servers
    calls:
    - action: get_vpc
      fields:
      - path: is_public
        operator: exists
        expected: false
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_servers
      response'
  - check_id: ibm.vpc.private_cloud_server.compute_vm_root_volume_encrypted_cmek
    title: Ensure VM Root Volume Encryption with Customer-Managed Keys
    severity: critical
    for_each: vpc.private_cloud_servers
    calls:
    - action: get_vpc
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in vpc.private_cloud_servers
      response'
  - check_id: ibm.vpc.private_cloud_server.compute_vm_secure_boot_enabled
    title: Ensure Secure Boot is Enabled for VPC Private Cloud Server VMs
    severity: low
    for_each: vpc.private_cloud_servers
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_servers
      response'
  - check_id: ibm.vpc.private_cloud_server.compute_vm_security_group_inbound_restricted
    title: Restrict Inbound Traffic to VPC Compute VM Security Groups
    severity: low
    for_each: vpc.private_cloud_servers
    calls:
    - action: get_security_group
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_servers
      response'
  - check_id: ibm.vpc.private_cloud_server.compute_vm_serial_console_access_restricted
    title: Restrict Serial Console Access on IBM Cloud VPC Servers
    severity: low
    for_each: vpc.private_cloud_servers
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_servers
      response'
  - check_id: ibm.vpc.private_cloud_server.compute_vm_ssh_key_based_auth_required
    title: Enforce SSH Key-Based Authentication for VPC Private Cloud Servers
    severity: high
    for_each: vpc.private_cloud_servers
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_servers
      response'
  - check_id: ibm.vpc.private_cloud_server.compute_vm_ssh_password_auth_disabled
    title: Disable SSH Password Authentication for VPC Private Cloud Servers
    severity: low
    for_each: vpc.private_cloud_servers
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_servers
      response'
  - check_id: ibm.vpc.private_cloud_server.compute_vm_user_data_no_secrets
    title: Enforce No Secrets in Compute VM User Data for Enhanced Security
    severity: high
    for_each: vpc.private_cloud_servers
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_servers
      response'
  - check_id: ibm.vpc.private_cloud_server.compute_vm_vtpm_enabled
    title: Ensure Vtpm is Enabled for Private Cloud Server VMs in IBM VPC
    severity: low
    for_each: vpc.private_cloud_servers
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_servers
      response'
  - check_id: ibm.vpc.private_cloud_server.paas_instance_disk_encrypted
    title: Enforce Encryption for IBM Cloud PaaS Instance Disks in VPC
    severity: medium
    for_each: vpc.private_cloud_servers
    calls:
    - action: get_vpc
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in vpc.private_cloud_servers
      response'
  - check_id: ibm.vpc.private_cloud_server.paas_instance_no_public_ip_unless_required
    title: Restrict Public IP for PaaS Instances in Private Cloud Servers
    severity: critical
    for_each: vpc.private_cloud_servers
    calls:
    - action: get_vpc
      fields:
      - path: is_public
        operator: exists
        expected: false
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_servers
      response'
  - check_id: ibm.vpc.private_cloud_server.paas_instance_ssh_password_auth_disabled
    title: Ensure SSH Password Authentication is Disabled for Paas Instances
    severity: low
    for_each: vpc.private_cloud_servers
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_servers
      response'
  - check_id: ibm.vpc.private_cloud_spot_instance.compute_spot_instance_profile_least_privilege
    title: Enforce Least Privilege for VPC Spot Instance Profiles
    severity: high
    for_each: vpc.private_cloud_spot_instances
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_spot_instances
      response'
  - check_id: ibm.vpc.private_cloud_spot_instance.compute_spot_instance_no_public_ip_assigned
    title: Restrict Public IP for VPC Private Cloud Spot Instances
    severity: critical
    for_each: vpc.private_cloud_spot_instances
    calls:
    - action: get_vpc
      fields:
      - path: is_public
        operator: exists
        expected: false
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_spot_instances
      response'
  - check_id: ibm.vpc.private_cloud_spot_instance.compute_spot_instance_uses_approved_launch_template
    title: Enforce Approved Launch Templates for VPC Spot Instances
    severity: low
    for_each: vpc.private_cloud_spot_instances
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_spot_instances
      response'
  - check_id: ibm.vpc.private_cloud_ssh_key.compute_key_pair_disable_unused_keys
    title: Disable Unused SSH Keys for Enhanced VPC Security
    severity: high
    for_each: vpc.private_cloud_ssh_keys
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_ssh_keys
      response'
  - check_id: ibm.vpc.private_cloud_ssh_key.compute_key_pair_max_age_days
    title: Enforce Maximum Age for Private Cloud SSH Key Pairs in IBM VPC
    severity: high
    for_each: vpc.private_cloud_ssh_keys
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_ssh_keys
      response'
  - check_id: ibm.vpc.private_cloud_subnet.data_warehouse_subnet_group_private_subnets_only
    title: Ensure Data Warehouse Subnet Groups Use Private Subnets Only
    severity: low
    for_each: vpc.private_cloud_subnets
    calls:
    - action: get_subnet
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_subnets
      response'
  - check_id: ibm.vpc.private_cloud_subnet.network_subnet_private_subnets_no_igw_route
    title: Enforce No IGW Route for Private Subnets in IBM VPC
    severity: medium
    for_each: vpc.private_cloud_subnets
    calls:
    - action: get_subnet
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_subnets
      response'
  - check_id: ibm.vpc.private_cloud_subnet.network_subnet_public_subnets_use_nacl_restrictions
    title: Enforce NACL Restrictions on Public Subnets in IBM Cloud VPC
    severity: critical
    for_each: vpc.private_cloud_subnets
    calls:
    - action: get_subnet
      fields:
      - path: is_public
        operator: exists
        expected: false
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_subnets
      response'
  - check_id: ibm.vpc.private_cloud_subnet.network_subnet_route_table_association_present
    title: Ensure Route Table Association for Private Cloud Subnets in VPC
    severity: medium
    for_each: vpc.private_cloud_subnets
    calls:
    - action: get_subnet
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_subnets
      response'
  - check_id: ibm.vpc.private_cloud_target_group.network_tg_health_checks_tls_where_supported
    title: Ensure TLS for Network Target Group Health Checks Where Supported
    severity: medium
    for_each: vpc.private_cloud_target_groups
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_target_groups
      response'
  - check_id: ibm.vpc.private_cloud_target_group.network_tg_targets_in_private_subnets
    title: Ensure Network Target Group Targets Reside in Private Subnets for VPC
    severity: medium
    for_each: vpc.private_cloud_target_groups
    calls:
    - action: get_subnet
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_target_groups
      response'
  - check_id: ibm.vpc.private_cloud_vpc.network_vpc_dns_hostnames_and_support_configured
    title: Ensure DNS Hostnames and Support Configured in Private Cloud VPC
    severity: medium
    for_each: vpc.private_cloud_vpcs
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_vpcs
      response'
  - check_id: ibm.vpc.private_cloud_vpc.network_vpc_flow_logs_enabled
    title: Ensure VPC Flow Logs are Enabled for Private Cloud VPCs
    severity: medium
    for_each: vpc.private_cloud_vpcs
    calls:
    - action: get_vpc
      fields:
      - path: logging_enabled
        operator: equals
        expected: true
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "logging_enabled" exists in vpc.private_cloud_vpcs
      response'
  - check_id: ibm.vpc.private_cloud_vpc.network_vpc_route_tables_no_unintended_internet_paths
    title: Ensure No Unintended Internet Paths in Private Cloud VPC Route Tables
    severity: medium
    for_each: vpc.private_cloud_vpcs
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_vpcs
      response'
  - check_id: ibm.vpc.private_cloud_vpn_connection.network_vpn_ike_phase_encryption_strong
    title: Enforce Strong Encryption for VPN IKE Phase in IBM VPC
    severity: high
    for_each: vpc.private_cloud_vpn_connections
    calls:
    - action: get_vpc
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in vpc.private_cloud_vpn_connections
      response'
  - check_id: ibm.vpc.private_cloud_vpn_connection.network_vpn_pre_shared_keys_rotation_policy_defined
    title: Ensure VPN Pre-Shared Keys Rotation Policy is Defined for VPCs
    severity: high
    for_each: vpc.private_cloud_vpn_connections
    calls:
    - action: get_vpc
      fields:
      - path: last_rotation
        operator: age_days
        expected: 90
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "last_rotation" exists in vpc.private_cloud_vpn_connections
      response'
  - check_id: ibm.vpc.private_cloud_vpn_connection.network_vpn_tunnel_health_monitoring_enabled
    title: Ensure VPN Tunnel Health Monitoring is Enabled for Private Cloud Connections
    severity: medium
    for_each: vpc.private_cloud_vpn_connections
    calls:
    - action: get_vpc
      fields:
      - path: monitoring.enabled
        operator: exists
        expected: true
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.private_cloud_vpn_connections
      response'
  - check_id: ibm.vpc.ensure_using_managed_disks.using_managed_disks_enabled
    title: Ensure Managed Disks are Enabled for IBM VPC Resources
    severity: low
    for_each: vpc.ensure_using_managed_diskss
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.ensure_using_managed_diskss
      response'
  - check_id: ibm.vpc.resource.trusted_launch_enabled
    title: Ensure Trusted Launch is Enabled for VPC Resources
    severity: low
    for_each: vpc.resources
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.resources response'
  - check_id: ibm.vpc.vpc.different_regions_enabled
    title: Ensure VPCs Span Multiple Regions for Enhanced Resilience
    severity: low
    for_each: vpc.vpcs
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.volume.public_access_blocked
    title: Block Public Access to IBM VPC Volumes for Enhanced Security
    severity: critical
    for_each: vpc.volumes
    calls:
    - action: get_vpc
      fields:
      - path: public_access
        operator: equals
        expected: false
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "public_access" exists in vpc.volumes
      response'
  - check_id: ibm.vpc.endpoint_gateway.endpoint_connections_trust_boundaries_enabled
    title: Enable Trust Boundaries for Endpoint Connections in VPC
    severity: low
    for_each: vpc.endpoint_gateways
    calls:
    - action: get_public_gateway
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.endpoint_gateways
      response'
  - check_id: ibm.vpc.endpoint_gateway.endpoint_services_allowed_principals_trust_boundaries_en
    title: Ensure Trust Boundaries for Allowed Principals on VPC Endpoint Services
    severity: low
    for_each: vpc.endpoint_gateways
    calls:
    - action: get_public_gateway
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.endpoint_gateways
      response'
  - check_id: ibm.vpc.security_group.closed
    title: Enforce Closed Security Groups for Enhanced VPC Isolation
    severity: low
    for_each: vpc.security_groups
    calls:
    - action: get_security_group
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.security_group.default_ingress_restriction
    title: Enforce Default Ingress Restrictions for Security Groups in VPC
    severity: low
    for_each: vpc.security_groups
    calls:
    - action: get_security_group
      fields:
      - path: is_default
        operator: exists
        expected: true
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.security_group.ingress_check_port_22_open
    title: Secure Ingress on Port 22 in IBM Cloud VPC Security Groups
    severity: low
    for_each: vpc.security_groups
    calls:
    - action: get_security_group
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.security_group.ingress_port_3389_enabled
    title: Restrict Ingress Traffic on Port 3389 in VPC Security Groups
    severity: low
    for_each: vpc.security_groups
    calls:
    - action: get_security_group
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.vpc.acl_unused
    title: Detect and Mitigate Unused ACLs in IBM Cloud VPC Environments
    severity: low
    for_each: vpc.vpcs
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.network_acl.allow_ingress_tcp_port_..._internet_access_configured
    title: Secure Ingress TCP Port Access in Network ACL for IBM Cloud VPC
    severity: low
    for_each: vpc.network_acls
    calls:
    - action: get_vpc
      fields:
      - path: '...internet.access.configured'
        operator: exists
        expected: true
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.security_group.allow_ingress_from_internet_..._waf_acl_attached
    title: Ensure WAF ACL is Attached to Security Groups Allowing Internet Ingress
    severity: low
    for_each: vpc.security_groups
    calls:
    - action: get_security_group
      fields:
      - path: '...waf.acl.attached'
        operator: exists
        expected: true
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.security_group.default_security_group_traffic_restricted
    title: Restrict Default Security Group Traffic in IBM VPC
    severity: low
    for_each: vpc.security_groups
    calls:
    - action: get_security_group
      fields:
      - path: is_default
        operator: exists
        expected: true
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.subnet.subnet_different_az_enabled
    title: Ensure Subnets Span Multiple Availability Zones for Resilience
    severity: low
    for_each: vpc.subnets
    calls:
    - action: get_subnet
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.vpn_connection_tunnels_up.vpn_connection_tunnels_up_enabled
    title: Ensure VPN Connection Tunnels are Actively Monitored and Enabled
    severity: low
    for_each: vpc.vpn_connection_tunnels_ups
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.vpn_connection_tunnels_ups
      response'
  - check_id: ibm.vpc.floating_ip.ip_unassigned
    title: Unassigned Floating IPs in IBM VPC Should Be Monitored
    severity: low
    for_each: vpc.floating_ips
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.floating_ip.elastic_ip_shodan_enabled
    title: Ensure Elastic IP Shodan Visibility is Disabled for Enhanced Security
    severity: low
    for_each: vpc.floating_ips
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.floating_ip.elastic_ip_unassigned_enabled
    title: Ensure Unassigned Elastic IPs are Disabled in VPC
    severity: low
    for_each: vpc.floating_ips
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.instance.account_imdsv2_enabled
    title: Enforce IMDSv2 for Enhanced Metadata Access Security in IBM VPC Instances
    severity: low
    for_each: vpc.instances
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.instance.imdsv2_enabled
    title: Ensure IMDSv2 is Enabled for IBM Cloud VPC Instances
    severity: low
    for_each: vpc.instances
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.instance.managed_by_ssm
    title: Ensuring VPC Instances Are Managed by IBM Secure Service Management (SSM)
    severity: low
    for_each: vpc.instances
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.instance.older_than_specific_days
    title: Audit VPC Instances Older Than Specified Duration
    severity: low
    for_each: vpc.instances
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.instance.paravirtual_type
    title: Enforce Paravirtual Type for VPC Instances for Enhanced Security
    severity: low
    for_each: vpc.instances
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.instance.secrets_user_data
    title: Secure User Data Handling for VPC Instances
    severity: high
    for_each: vpc.instances
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.instance.ssh_key_authentication
    title: Enforce SSH Key Authentication for IBM VPC Instances
    severity: high
    for_each: vpc.instances
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.instance.uses_single_eni
    title: Enforce Single ENI Usage for Enhanced VPC Instance Security
    severity: low
    for_each: vpc.instances
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.instance.launch_template_imdsv2_required
    title: Enforce IMDSv2 for Enhanced Instance Metadata Security in IBM VPC
    severity: low
    for_each: vpc.instances
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.instance_template.launch_template_no_secrets_enabled
    title: Prevent Secrets in IBM VPC Instance Launch Templates
    severity: high
    for_each: vpc.instance_templates
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.instance_templates
      response'
  - check_id: ibm.vpc.instance.management_compliance_enabled
    title: Ensure Management Compliance is Enabled for VPC Instances
    severity: low
    for_each: vpc.instances
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.network_acl.networkacl_unused_enabled
    title: Ensure Unused Network ACLs Are Disabled in IBM VPC
    severity: medium
    for_each: vpc.network_acls
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.instance.patch_compliance_enabled
    title: Ensure Patch Compliance Enabled for IBM VPC Instances
    severity: medium
    for_each: vpc.instances
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.security_group.securitygroup_common_ports_restricted_enabled
    title: Restrict Common Ports in IBM VPC Security Groups for Enhanced Security
    severity: low
    for_each: vpc.security_groups
    calls:
    - action: get_security_group
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.securitygroup_default_restrict_traffic.default_security_group_traffic_restricted
    title: Enforce Restrictions on Default Security Group Traffic in IBM VPC
    severity: low
    for_each: vpc.securitygroup_default_restrict_traffics
    calls:
    - action: get_security_group
      fields:
      - path: is_default
        operator: exists
        expected: true
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.securitygroup_default_restrict_traffics
      response'
  - check_id: ibm.vpc.securitygroup_from_launch_wizard.securitygroup_from_launch_wizard_enabled
    title: Ensure Default Security Group from Launch Wizard is Enabled
    severity: low
    for_each: vpc.securitygroup_from_launch_wizards
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.securitygroup_from_launch_wizards
      response'
  - check_id: ibm.vpc.securitygroup_not_used.securitygroup_not_used_enabled
    title: Ensure Unused Security Groups are Disabled in IBM VPC
    severity: low
    for_each: vpc.securitygroup_not_useds
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.securitygroup_not_useds
      response'
  - check_id: ibm.vpc.securitygroup_with_many_ingress_egress_rules.securitygroup_with_many_ingress_egress_rules_enabled
    title: Limit Ingress and Egress Rules in IBM VPC Security Groups
    severity: low
    for_each: vpc.securitygroup_with_many_ingress_egress_ruless
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.securitygroup_with_many_ingress_egress_ruless
      response'
  - check_id: ibm.vpc.stopped_instance.stopped_instance_enabled
    title: Ensure VPC Stopped Instances Are Properly Managed
    severity: low
    for_each: vpc.stopped_instances
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.stopped_instances
      response'
  - check_id: ibm.vpc.transitgateway_auto_accept_vpc_attachments.transitgateway_auto_accept_vpc_attachments_enabled
    title: Ensure Auto Acceptance of VPC Attachments on Transit Gateway is Enabled
    severity: low
    for_each: vpc.transitgateway_auto_accept_vpc_attachmentss
    calls:
    - action: get_public_gateway
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.transitgateway_auto_accept_vpc_attachmentss
      response'
  - check_id: ibm.vpc.volume.in_use
    title: Ensure VPC Volumes Are Actively In Use
    severity: low
    for_each: vpc.volumes
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.volumes response'
  - check_id: ibm.vpc.volume.snapshots_exists
    title: Ensure Existence of Snapshots for VPC Volumes
    severity: low
    for_each: vpc.volumes
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in vpc.volumes response'
  - check_id: ibm.vpc.instance.vulnerability_scan_enabled
    title: Ensure Vulnerability Scanning is Enabled for VPC Instances
    severity: medium
    for_each: vpc.instances
    calls:
    - action: get_vpc
      fields:
      - path: status
        operator: exists
        expected: available
      note: IBM VPC compliance check using real API fields
  - check_id: ibm.vpc.volume.encryption_enabled
    title: Ensure Encryption is Enabled for VPC Volumes
    severity: high
    for_each: vpc.volumes
    calls:
    - action: get_vpc
      fields:
      - path: encryption_at_rest
        operator: equals
        expected: true
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "encryption_at_rest" exists in vpc.volumes
      response'
  - check_id: ibm.vpc.vpc_2private_1public_subnets_nat.vpc_2private_1public_subnets_nat_blocked
    title: Enforce NAT Blocking for Public Subnets in VPC for Enhanced Security
    severity: critical
    for_each: vpc.vpc_2private_1public_subnets_nats
    calls:
    - action: get_subnet
      fields:
      - path: locked
        operator: equals
        expected: false
      note: IBM VPC compliance check using real API fields
    note: 'MANUAL_REVIEW: Verify field path "locked" exists in vpc.vpc_2private_1public_subnets_nats
      response'
