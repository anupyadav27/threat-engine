cognos_dashboard:
  version: '1.0'
  provider: ibm
  service: cognos_dashboard
  scope: regional
  client_class: ResourceControllerV2
  discovery:
  - discovery_id: cognos_dashboard.analytics_dashboards
    calls:
    - action: list_resource_instances
      params: {}
      save_as: analytics_dashboards
  checks:
  - check_id: ibm.cognos_dashboard.analytics_dashboard.data_export_controls_enabled
    title: Enforce Data Export Controls in Cognos Analytics Dashboards
    severity: medium
    for_each: analytics_dashboards
    calls:
    - action: get_cognos_dashboard_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cognos_dashboard compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cognos_dashboard.analytics_dashboards response'
  - check_id: ibm.cognos_dashboard.analytics_dashboard.data_public_embeds_disabled
    title: Disable Public Embeds on Cognos Analytics Dashboards
    severity: critical
    for_each: analytics_dashboards
    calls:
    - action: get_cognos_dashboard_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cognos_dashboard compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cognos_dashboard.analytics_dashboards response'
  - check_id: ibm.cognos_dashboard.analytics_dashboard.data_sharing_restricted_to_org
    title: Restrict Data Sharing in Analytics Dashboard to Organization
    severity: medium
    for_each: analytics_dashboards
    calls:
    - action: get_cognos_dashboard_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cognos_dashboard compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cognos_dashboard.analytics_dashboards response'
  - check_id: ibm.cognos_dashboard.analytics_dashboard.data_sso_required
    title: Enforce SSO for Enhanced Data Security in Cognos Analytics Dashboard
    severity: medium
    for_each: analytics_dashboards
    calls:
    - action: get_cognos_dashboard_resource
      fields:
      - path: status
        operator: exists
        expected: active
      note: IBM cognos_dashboard compliance check
    note: 'MANUAL_REVIEW: Verify field path "enabled" exists in cognos_dashboard.analytics_dashboards response'
  sdk_package: ibm_platform_services
